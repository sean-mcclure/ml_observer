{"doc5":["\n\narXiv:2103.13466v1","","[stat.ML]","","24","Mar","2021\nAsymptotic","Freeness","of","Layerwise","Jacobians\nCaused","by","Invariance","of","Multilayer","Perceptron:\nThe","Haar","Orthogonal","Case\nBenoît","Collins,","Tomohiro","Hayase\nMarch","26,","2021\nAbstract\nFree","Probability","Theory","(FPT)","provides","rich","knowledge","for","handling","math-\nematical","difficulties","caused","by","random","matrices","that","appear","in","researches","of\ndeep","neural","networks","(DNNs),","such","as","the","dynamical","isometry,","Fisher","informa-\ntion","matrix,","and","training","dynamics.","","FPT","suits","these","researches","because","the\nDNN’s","parameter-Jacobian","","and","","input-Jacobian","","are","polynomials","of","layerwise\nJacobians.","","However,","the","critical","assumption,","that","is,","the","layerwise","Jacobian’s\nasymptotic","freeness,","has","not","been","proven","completely","so","far.The","asymptotic\nfreeness","assumption","has","foundamental","roles","in","these","researches","to","propagate\nspectral","distributions","through","the","layers.","","In","the","present","work,","we","prove","the\nasymptotic","freeness","of","layerwise","Jacobian","of","multilayer","perceptrons","with","Haar\ndistributed","orthogonal","","matrices,","","which","are","essential","for","achieving","","dynamical\nisometry.\nContents\n1","","Introduction\n2\n1.1","","Main","results",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".4\n1.2","","Related","Works",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".4\n1.3","","Constitution",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".5\n2","","Preliminaries5\n2.1","","Setting","of","MLP",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".5\n2.2","","Notations","",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".8\n2.3","","Asymptotic","Freeness","",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".9\n2.4","","Haar","Distributed","Orthogonal","Random","Matrices","",".",".",".",".",".",".",".",".","..",".",".11\n1\n\n3","","Key","to","Asymptotic","Freeness13\n3.1","","Invariance",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".13\n3.2","","Cutoff","",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".15\n4","","Asymptotic","Freeness","of","Layerwise","Jacobians17\n5","","Application20\n5.1","","Jacobian","and","Dynamical","Isometry",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".20\n5.2","","Fisher","Information","Matrix","and","Training","Dynamics",".",".",".",".",".","..",".",".",".",".21\n6","","Discussion23\nA","Review","on","Probability","Theory26\nB","Signal","Propagation","through","Network","with","Orthogonal","Weights28\nB.1","","Action","of","Haar","Orthogonal","Matrices",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","..28\nB.2","","Convergence","of","Empirical","Distribution","",".",".",".",".",".",".",".",".",".",".",".",".",".","..",".",".30\nC","Review","on","Free","Multiplicative","Convolution30\n1","","Introduction\nFree","Probability","Theory","(FPT)","provides","fruitful","knowledgefor","handling","mathemat-\nical","difficulties","caused","by","random","matrices","that","appear","in","deep","neural","networks\n(DNNs)","[\nPSG18,HN19,HK21].","The","DNNs","have","been","successfully","used","to","achieve\nempirically","high","performance","in","various","machine","learning","tasks","[\nLBH15,GBC16].\nHowever,","their","theoretical","understanding","is","limited,","and","their","success","relies","heavily\non","heuristic","search","settings","such","as","architecture","and","hyperparameters.","To","under-\nstand","and","improve","the","training","of","DNNs,","researchers","have","developed","several","theories\nto","investigate,","for","example,","the","vanishing/exploding","gradient","problem","[\nSGGSD17],\nthe","shape","of","the","loss","landscape","[\nPW18,KAA19b],","and","the","global","convergence","of\ntraining","and","generalization","[JGH18].","","We","face","mathematical","difficulties","in","ana-\nlyzing","them","due","to","the","nonlinearity","of","activation","functions,","the","depth","of","DNNs,\nand","non-commuting","random","matrices.","","Therefore,","FPT,","invented","by","Voiculescu\n[\nVoi85,Voi87,Voi91],","with","its","rich","knowledge","of","non-commuting","random","matrices,\nis","well","suited","for","their","analysis","of","them.\nFPT","essentially","appears","in","the","analysis","of","the","dynamical","isometry","[\nPSG17,PSG18].\nIt","is","well","known","that","it","is","difficult","to","reduce","the","training","error","in","very","deep","mod-\nels","without","carefully","preventing","the","gradient’s","vanishing/exploding.","Naive","settings\n(i.e.,","activation","function","and","initialization)","cause","vanishing/exploding","gradients,","as\nlong","as","the","network","is","relatively","deep.","The","dynamical","isometry","[\nSMG14,PSG18]\n2\n\nwas","proposed","to","solve","this","problem.","The","dynamical","isometry","can","facilitate","train-\ning","by","setting","the","input-output","Jacobian’s","singular","valuesto","be","one,","where","the\ninput-output","Jacobian","is","the","Jacobian","matrix","of","the","DNN","at","a","given","input.","Ex-\nperiments","have","shown","that","with","initial","values","and","models","satisfying","dynamical\nisometry,","very","deep","models","can","be","trained","without","gradient","vanishing/exploding;\n[\nPSG18,XBSD\n+\n18,SP20]","have","found","that","DNNs","achieve","approximately","dynamical\nisometry","over","random","orthogonal","weights,","but","they","do","not","do","so","over","random","Gaus-\nsian","weights.","For","the","sake","of","the","prospect","of","the","theory,","letJbe","the","Jacobian","of","the\nmultilayer","perceptron","(MLP),","which","is","the","fundamental","model","of","DNNs.","In","fact,\nthe","JacobianJis","given","by","the","product","of","layerwise","Jacobians:\nJ=D\nL\nW\nL\n...D\n1\nW\n1\n,\nwhere","eachW\nℓ\nisℓ-th","weight","matrix,","eachD\nℓ\nis","Jacobian","ofℓ-th","activation","function,\nandLis","the","number","of","layers.","Under","an","assumption","of","asymptotic","freeness,","the\nlimit","spectral","distribution","is","given","by","[\nPSG18].\nTo","examine","the","training","dynamics","of","MLP","achieving","the","dynamical","isometry,\n[\nHK21]","introduced","a","spectral","analysis","of","the","Fisher","information","matrix","per","sample\nof","MLP.","The","Fisher","information","matrix","(FIM)","has","been","a","fundamental","quantity\nfor","such","theoretical","understandings.","The","FIM","describes","thelocal","metric","of","the","loss\nsurface","concerning","the","KL-divergence","function","[\nAma16].","The","neural","tangent","kernel\n[JGH18],","which","has","the","same","eigenvalue","spectrum","except","for","trivialzero","as","FIM,\nalso","describes","the","learning","dynamics","of","DNNs","when","the","dimension","of","the","last","layer\nis","relatively","smaller","than","the","hidden","layer.","In","particular,the","FIM’s","eigenvalue","spec-\ntrum","describes","the","efficiency","of","optimization","methods.","For","instance,","the","maximum\neigenvalue","determines","an","appropriate","size","of","the","learning","rate","of","the","first-order","gra-\ndient","method","for","convergence","[\nLKS91,KAA19b,WME18].","Despite","its","importance\nin","neural","networks,","the","FIM","spectrum","has","been","the","object","of","only","very","little","study\nfrom","a","theoretical","perspective.","The","reason","is","that","it","has","been","limited","to","random","ma-\ntrix","theory","for","shallow","networks","[\nPW18]","or","mean-field","theory","for","eigenvalue","bounds,\nwhich","may","be","loose","in","general","[\nKAA19a].","Thus,","[HK21]","focused","on","the","FIM","per\nsample","and","found","an","alternative","approach","applicable","to","DNNs.","The","FIM","per","sam-\nple","is","equal","toJ\n⊤\nθ\nJ\nθ\n,","whereJ\nθ\nis","the","parameter-Jacobian.","Also,","the","eigenvalues","of\nthe","FIM","per","sample","are","equal","to","the","eigenvalues","of","theH\nL\ndefined","recursively","as\nfollows,","except","for","the","trivial","zero","eigenvalues","and","normalization:\nH\nℓ+1\n=","ˆq\nℓ\nI+W\nℓ+1\nD\nℓ\nH\nℓ\nD\nℓ\nW\n⊤\nℓ+1\n,","ℓ=","1,...,L−1,\nwhereIis","the","identity","matrix,","andˆq\nℓ\nis","the","empirical","variane","ofℓ-th","hidden","unit.\nUnder","an","asymptotic","freeness","assumption,","[\nHK21]","gave","some","limit","spectral","distribu-\ntions","ofH\nL\n.\nThe","asymptotic","freeness","assumptions","have","a","critical","role","inthese","researches\n[\nPSG18,HK21]","to","obtain","the","propagation","of","spectral","distributions","through","the","lay-\ners.","However,","the","proof","of","the","asymptotic","freeness","was","not","completed.","We","prove\n3\n\nthe","asymptotic","freeness","of","layerwise","Jacobian","of","multilayer","perceptrons","with","Haar\northogonal","weights","in","the","present","work.\n1.1","","Main","results\nOur","results","are","as","follows.","Firstly,","the","followingL+","1tuple","of","families","are","asymp-\ntotically","free","almost","surely","(see","Theorem\n4.1):\n((W\n1\n,W\n∗\n1\n),...,(W\nL\n,W\n∗\nL\n),(D\n1\n,...,D\nL\n)).\nSecondly,","for","eachℓ=","1,...,L−1,","the","following","pair","is","almost","surely","asymptotically\nfree","(see","Proposition\n4.2):\nW\nℓ+1\nJ\nℓ\nJ\n∗\nℓ\nW\nℓ+1\n,D\n2\nℓ\n.\nThe","asymptotic","freeness","is","at","the","heart","of","the","spectral","analysis","of","the","Jacobian.\nLastly,","for","eachℓ=","1,...,L−1,","the","following","pair","is","almost","surely","asymptotically\nfree","(see","Proposition\n4.3):\nH\nℓ\n,D\n2\nℓ\n.\nThe","asymptotic","freeness","of","the","pair","is","the","key","to","the","analysisof","the","conditional\nFisher","information","matrix.\nA","key","of","the","proof","is","the","invariance","of","MLP","described","in","Lemma\n3.1.","First,","we\nconsider","the","orthogonal","matrices","that","fix","the","hidden","units","ineach","layer.","Second,\nwe","replace","each","layer’s","parameter","matrix","with","itself","multiplied","by","the","orthogonal\nmatrix,","and","then","the","MLP","does","not","change.","Furthermore,","if","theoriginal","weights","are\nHaar","orthogonal,","the","Jacobian","is","also","unchanged","by","this","replacement.","Lastly,","we\ncan","replace","each","weight","with","a","Haar","orthogonal","random","matrixindependent","of","the\nJacobian","of","the","activation","function","using","this","key","fact.","Then","asymptotic","freeness\nfollows,","using","the","well-known","properties","of","the","Haar","orthogonal","random","matrix.\n1.2","","Related","Works\nThe","asymptotic","freeness","is","weaker","than","the","assumption","of","theforward-backward","inde-\npendence","that","researches","of","dynamical","isometry","assumed","[\nPSG17,PSG18,KAA19b].\nAlthough","studies","of","mean-field","theory","[SMG14,LBH15,GCC\n+\n19]","succeeded","in","ex-\nplaining","many","experimental","results","of","deep","learning,","they","use","an","artificial","assump-\ntion","(gradient","independence","[\nYan19]),","which","is","not","rigorously","true.","","Asymptotic\nfreeness","is","weaker","than","this","artificial","assumption.","Our","workclarifies","that","asymp-\ntotic","free","independence","is","just","the","right","property","that","is","useful","and","strictly","valid","for\nanalysis.\n4\n\nSeveral","works","prove","or","treat","the","asymptotic","freeness","with","Gaussian","initialization\n[HN19,Yan19,Yan20,Pas20].","However,","asymptotic","freeness","had","not","been","proven\nfor","the","orthogonal","initialization.","","As","dynamical","isometry","can","be","achieved","under\northogonal","initialization","but","cannot","be","done","under","Gaussian","initialization","[\nPSG18],\nproof","of","the","asymptotic","freeness","in","orthogonal","initialization","is","essential.","Since","our\nproof","uses","the","Haar","distributed","random","matrix","properties","inan","essential","manner,\nthe","proof","is","clear","because","we","only","need","to","aim","to","replace","the","weights","with","Haar\northogonal,","which","is","independent","of","the","other","Jacobians.","While","[\nHN19]","restricts","the\nactivation","function","to","ReLU,","our","proof","covers","a","comprehensive","class","of","activation\nfunctions,","including","smooth","functions.\n1.3","","Constitution\nSection\n2is","devoted","to","preliminaries.","It","contains","settings","of","MLP","andnotations\nabout","random","matrices,","spectral","distribution,","and","free","probability","theory.","Section\n3\nconsists","of","two","keys","to","prove","main","results.","A","key","is","the","invariance","of","MLP,","and","the\nother","is","to","cut","off","a","dimension.","Section\n4is","devoted","to","proving","the","main","results\non","the","asymptotic","freeness.","In","Section\n5,","we","show","applications","of","the","asymptotic\nfreeness","to","spectral","analysis","of","random","matrices,","which","appear","in","the","theory","of\ndynamical","isometry","and","training","dynamics","of","DNNs.","Section\n6is","devoted","to","the\ndiscussion","and","future","works.\n2","","Preliminaries\n2.1","","Setting","of","MLP\nWe","consider","multilayer","perceptron","settings,","as","usual","in","thestudies","of","FIM","[\nPW18,\nKAA19b]","and","dynamical","isometry","[SMG14,PSG18,HK21].","FixL,M∈N.","We\nconsider","anL-layer","multilayer","perceptron","as","a","paramtrized","mapf=","(f\nθ\n|θ=\n(W\n1\n,...,W\nL\n))with","weight","matricesW\n1\n,W\n2\n,...,W\nL\n∈M\nM\n(R)as","follows.","Firstly,\nconsider","functionsφ\n1\n,...φ\nL−1\nonR.","Besides,","we","assume","thatφ\nℓ\nis","continuous","and\ndifferentiable","except","for","finite","points.","Secondly,","for","a","single","inputx∈R\nM\nand","set\nx\n0\n=x.","In","addition,","forℓ=","1,...,L,","set","inductively\nh\nℓ\n=W\nℓ\nx\nℓ−1\n+b\nℓ\n,","x\nℓ\n=φ\nℓ\n(h\nℓ\n),\nwhereφ\nℓ\nacts","onR\nM\nas","the","entrywise","operation.","Note","that","we","omit","bias","parameters\nto","simplify","the","analysis.","","Writef\nθ\n(x)","=x\nL\n.","","Denote","byD\nℓ\nthe","Jacobian","of","the\nactivationφ\nℓ\ngiven","by\nD\nℓ\n=\n∂x\nℓ\n∂h\nℓ\n=","diag((φ\nℓ\n)\n′\n(h\nℓ\n1\n),...,(φ\nℓ\n)\n′\n(h\nℓ\nM\n)).\n5\n\nLastly,","we","assume","that","eachW\nℓ\n(ℓ=","1,...,L)","be","independent","Haar","orthogonal\nrandom","matrices,","and","further","assume","the","following","condition","(d1),",".",".",".",",","(d4)","on\ndistributions.","Fig.\n1show","the","dependency","of","the","random","variables.\nx\n0\nh\n1\nW\n1\nD\n1\nx\n1\nh\n2\nW\n2\nD\n2\n···\nx\nL−1\nh\nL\nW\nL\nD\nL\nx\nL\ndiag◦(φ\n1\n)\n′\nφ\n1\ndiag◦(φ\n2\n)\n′\nφ\n2\ndiag◦(φ\nL\n)\n′\nφ\nL\nFigure","1:","A","graphical","model","of","random","matrices","and","random","vectors.","Two","nodes","in\nthe","graph","are","independent","if","they","do","not","share","any","parent","nodes.","A","node’s","boundary\nis","drawn","as","a","square","if","it","contains","a","random","matrix.\n(d1)","For","eachM∈N,","the","input","vectorx\n0\nisR\nM\n-valued","random","variable","such","that\nthere","isr",">0with\nlim\nM→∞\n||x\n0\n||\n2\n/\n√\nM=r\nalmost","surely.\n(d2)","Each","weight","matrixW\nℓ\n(ℓ=","1,...,L)","satisfies\nW\nℓ\n=σ\nw,ℓ\nO\nℓ\n,\nwhereO\nℓ\n(ℓ=","1,...,L)are","independent","orthogonal","matrices","distributed","with\nthe","Haar","probability","measure","andσ\nw,ℓ\n>0.\n(d3)","The","bias","vectorsb\nℓ\n(ℓ=","1,...,L)","have","independent","entries","distributed","with\nN(0,σ\n2\nb,ℓ\n),","whereσ\nb,ℓ\n>0.\n(d4)","For","fixedM,","the","family\n(x\n0\n,W\n1\n,...,W\nL\n,b\n1\n,...,b\nL\n)\nis","independent.\n6\n\nLet","us","definer\nℓ\n>0andq\nℓ\n>0by","the","following","recurrence","relations:\nr\n0\n=r,\n(r\nℓ\n)\n2\n=E\nh∼N(0,q\nℓ\n)\n\u0002\nφ\nℓ\n(h)\n2\n\u0003\n(l=","1,...,L),\nq\nℓ\n=","(σ\nw,ℓ\n)\n2\n(r\nℓ−1\n)\n2\n+","(σ\nb,ℓ\n)\n2\n(l=","1,...,L).\nIt","holds","thatr\nℓ\n<∞by","the","assumption\n(a2)of","activation","functions.\nWe","further","assume","that","each","activation","function","satisfies","the","following","conditions\n(a1),",".",".",".",",","(a5).\n(a1)","It","is","a","continuous","function","onRand","is","not","the","identically","zero","function.\n(a2)","For","anyq",">0,\nZ\nR\nφ\nℓ\n(x)\n2\nexp(−x\n2\n/q)dx","<∞.\n(a3)","It","is","differentiable","almost","everywhere","concerning","Lebesgue","measure.","We","denote\nbyφ\n′\nℓ\nthe","derivative","defined","almost","everywhere.\n(a4)","The","derivativeφ\n′\nℓ\nis","continuous","almost","everywhere","concerning","the","Lebesgue\nmeasure.\n(a5)","The","derivativeφ\n′\nℓ\nis","bounded.\nThese","conditions","(d1),",".",".",".",",","(d4)\nExample","2.1(Activation","Functions).The","following","well-known","activation","func-\ntions","are","used","to","[\nPSG17,PSG18,HK21]","satisfy","the","above","conditions.\n1.","(Rectified","linear","unit)\nReLU(x)","=\n(\nx;x≥0,\n0;x","<0.\n2.","(Shifted","ReLU)\nshifted-ReLU\nα\n(x)","=\n(\nx;x≥α,\nα;x","<","α.\n7\n\n3.","(Hard","hyperbolic","tangent)\nhtanh(x)","=\n\n\n\n\n\n−1;x≤−1,\nx;−1<","x","<1,\n1;","","","","1≤x.\n4.","(Hyperbolic","tangent)\ntanh(x)","=\ne\nx\n−e\n−x\ne\nx\n+e\n−x\n.\n5.","(Sigmoid","function)\nσ(x)","=\n1\ne\n−x\n+","1\n.\n6.","(Smoothed","ReLU)\nSiLU(x)","=xσ(x).\n7.","(Error","function)\nerf(x)","=\n2\n√\nπ\nZ\nx\n0\ne\n−t\n2\ndt.\n2.2","","Notations\nLinear","AlgebraWe","denote","byM\nM\n(K)the","algebra","ofM×Mmatrices","with","entries\nin","a","fieldK.","Write","unnormalized","and","normalized","traces","ofA∈M\nM\n(K)as","follows:\nTr(A)","=\nM\nX\ni=1\nA\nii\n,\ntr(A)","=\n1\nM\nTr(A).\nIn","this","work,","a","random","matrix","is","aM\nM\n(R)valued","Borel","measurable","map","from","a\nfixed","probability","space","for","anM∈N.","We","denote","byO\nM\nthe","group","ofM×M\northogonal","matrices.","It","is","well-known","thatO\nM\nis","equipped","with","a","unique","left","and\nright","translation","invariant","probability","measure,","called","the","Haar","measure.\nSpectral","DistributionRecall","that","the","spectral","distributionμof","a","linear","operator\nAis","a","probability","distributionμonRsuch","thattr(A\nm\n)","=\nR\nt\nm\nμ(dt)for","anym∈N,\nwheretris","the","normalized","trace.","IfAis","anM×Msymmetric","matrix","withM∈N,\nits","spectral","distribution","is","given","byM\n−1\nP\nM\nk=1\nδ\nλ\nk\n,","whereλ\nk\n(k=","1,...,M)are\neigenvalues","ofA,","andδ\nλ\nis","the","discrete","probability","distribution","whose","support","is\n{λ}⊂R.\n8\n\nJoint","Distribution","of","All","EntriesFor","random","matricesX\n1\n,...,X\nL\n,Y\n1\n,...,Y\nL\nand","random","vectorsx\n1\n,...,x\nL\n,y\n1\n,...,y\nL\n,","we","write\n(X\n1\n,...,X\nL\n,x\n1\n,...,x\nL\n)∼\nentries\n(Y\n1\n,...,Y\nL\n,y\n1\n,...,y\nL\n)\nif","joint","distributions","of","all","entries","of","matrices","and","vectors","in","the","families","match.\n2.3","","Asymptotic","Freeness\nIn","this","section,","we","summarize","required","topics","of","random","matrices","and","free","probability\ntheory.\nDefinition","2.2.AnoncommutativeC\n∗\n-probability","space(NCPS,","for","short)","is","a","pair\n(A,τ)of","a","unital","C\n∗\n-algebraAand","a","faithful","tracial","stateτonA,","which","are","defined\nas","follows.","A","linear","spaceAoverCis","said","to","beunital","C\n∗\n-algebraif","it","is","unital\nC-algebra","equipped","with","an","antilinear","map∗:A→Aand","an","norm||·||such","that\n(ab)\n∗\n=b\n∗\na\n∗\n(a,b∈A),\na\n∗∗\n=a(a∈A),\n||ab||≤||a||||b||,(a,b∈A)\n||a\n∗\na||=||a||\n2\n(a∈A),\nand(Ais","complete","with","respect","to","the","norm||·||.","A","linear","mapτonAis","said","to\nbe","atracial","stateif","for","anya∈A,\nτ(a\n∗\n)","=\nτ(a),\nτ(a\n∗\na)≥0,\nand","for","anya,b∈A,\nτ(ab)","=τ(ba).\nWe","say","thatτisfaithfulifτ(a\n∗\na)","=","0impliesa=","0.\nA","trivial","example","of","an","NCPS","is","the","pair","of","the","algebraM\nM\n(C)ofM×M\nmatrices","of","complex","entires","and","the","normalized","tracetr.","Consider","the","algebra","of\nM\nM\n(R)ofM×Mmatrices","of","real","entries","and","the","normalized","tracetr.","The","pair\nitself","is","not","a","NCPS","in","the","sence","of","Definition\n2.2since","it","is","notC-linear","space.\nHowever,M\nM\n(C)containsM\nM\n(R)and","preserves∗by","setting∗forA∈M\nM\n(R)as\nfollows:\nA\n∗\n=A\n⊤\n.\nAlso,","the","inclusionM\nM\n(R)⊂M\nM\n(C)preserves","the","trace.","Therefore,","we","consider\nthe","joint","distributions","of","matirces","inM\nM\n(R)as","that","of","elements","in","the","NCPS\n(M\nM\n(C)","tr).\n9\n\nDefinition","2.3.(Joint","Distribution","in","NCPS)","Leta\n1\n,...,a\nk\n∈Aand","letChX\n1\n,...,X\nk\ni\nbe","the","free","algebra","of","non-commutative","polynomials","onCgenerated","bykindetermi-\nnatesX\n1\n,...,X\nk\n.","Then","thejoint","distirubtionof","thek-tuple(a\n1\n,...,a\nk\n)is","the","linear\nformμ\na\n1\n,...,a\nk\n:ChX\n1\n,...,X\nk\nidefined","by\nμ\na\n1\n,...,a\nk\n(P)","=P(a\n1\n,...,a\nk\n),\nwhereP∈ChX\n1\n,...,X\nk\ni.\nDefinition","2.4.Leta\n1\n,...,a\nk\n∈A.","LetA\n1\n(M),...,A\nk\n(M)","(M∈N)be","sequences\nofM×Mmatrices.","Then","we","say","that","they","converge","in","distribution","to(a\n1\n,...,a\nk\n)\nif\nlim\nM→∞\ntr[P(A\n1\n(M),...,A\nk\n(M))]","=τ[P(a\n1\n,...,a\nk\n)]\nfor","anyP∈ChX\n1\n,...,X\nk\ni.\nDefinition","2.5.(Freeness)","Let(A,τ)be","a","NCPS.","LetA\n1\n,...,A\nk\nbe","subalgebras\nhaving","the","same","unit","asA.","They","are","said","to","befreeif","the","following","holds:","for","any\nn∈N,","any","sequencej\n1\n,...,j\nn\n∈[k],","and","anya\ni\n∈A(i=","1,...,k)","with\nτ[a\ni\n]","=","0","(i=","1,...,n),\nj\n1\n6=j\n2\n,j\n2\n6=j\n3\n,...,j\nn−1\n6=j\nn\n,\nit","holds","that\nτ[a\nj\n1\na\nj\n2\n...a\nj\nn\n]","=","0.\nBesides,","elements","inAare","said","to","befreeiff","the","unital","subalgebras","that","they","generate\nare","free.\nHere","we","show","an","example","related","to","our","results.\nExample","2.6.Letw\n1\n,w\n2\n,...,w\nL\n∈Aandd\n1\n,...,d\nL\n∈A.","","Then","the","faimilis\n(w\n1\n,w\n∗\n1\n),(w\n2\n,w\n∗\n2\n),...,(d\n1\n,...,d\nL\n)are","free","if","and","only","if","the","followingL+","1unital\nsubalgebras","ofAare","free:\n{P(w\n1\n,w\n∗\n1\n)|P∈ChX,Yi},...,{P(w\nL\n,w\n∗\nL\n)|P∈ChX,Yi},\n{Q(d\n1\n,...,d\nL\n)|Q∈ChX\n1\n,...,X\nL\ni}.\nHere","we","introduce","asymptotic","freeness","of","random","matrices","with","compact","support\nlimit","spectral","distributions.","Since","we","consider","a","family","ofa","finite","number","of","random\nmatrices,","we","restrict","it","to","a","finite","index","set.","Note","that","the","finite","index","is","not","required\nfor","a","general","definition","of","freeness.\n10\n\nDefinition","2.7(Asymptotic","Freeness","of","Random","Matrices).Consider","a","nonempty\nfinite","index","setIand","a","partition{I\n1\n,...,I\nk\n}ofI.","Consider","a","sequence","ofk-tuples\n(A\ni\n(M)|i∈I\n1\n),...,(A\ni\n(M)|i∈I\nk\n)\nofM×Mrandom","matrices","whereM∈N.","The","sequence","is","then","said","to","beasymptotic\nfreeasM→∞almost","surely","if","the","following","two","conditions","are","satisfied.\n1.","There","exist","a","family(a\ni\n)\ni∈I\nof","elements","inAsuch","that","the","followingktuple","is\nfree:\n(a\ni\n|i∈I\n1\n),...,(a\ni\n|i∈I\nk\n).\n2.","For","everyP∈ChX\n1\n,...,X\n|I|\ni,\nlim\nM→∞\ntr\n\u0002\nP\n\u0000\nA\n1\n(M),...,A\n|I|\n\u0001\u0003\n=τ\n\u0002\nP\n\u0000\na\n1\n,...,a\n|I|\n\u0001\u0003\n,\nalmost","surely,","where|I|is","the","number","of","elements","ofI.\n2.4","","Haar","Distributed","Orthogonal","Random","Matrices\nProposition","2.8.[\nCŚ06,","Theorem","5.1]","For","anyM∈N,","letV\n1\n(M),...,V\nL\n(M)be\nindependentO\nM\nHaar","random","matrices,","andA\n1\n(M),...,A\nL\n(M)be","random","matri-\nces,","which","have","the","almost-sure-limit","joint","distribution.Assume","that","all","entries","of\n(V\nℓ\n(M))\nL\nℓ=1\nare","independent","of","that","of\n(A\n1\n(M),...,A\nL\n(M)),\nfor","eachM.","Then","the","families\n(V\n1\n(M),V\n1\n(M)\n⊤\n),...,(V\nL\n(M),V\nL\n(M)\n⊤\n),(A\n1\n(M),...,A\nL\n(M)).\nare","asympotically","free","asM→∞.\nThe","following","proposition","is","a","direct","consequence","of","Proposition\n2.8.\nProposition","2.9.ForM∈N,","letA(M)andB(M)beM×Msymmetric","random\nmatrices,","and","letV(M)be","aM×MHaar-distributed","orthogonal","random","matrix.\nAssume","that\n1.","The","random","matrixV(M)is","independent","ofA(M),B(M)for","everyM∈N.\n2.","The","spectral","distribution","ofA(M)(resp.B(M))","converges","in","distribution","to","a\ncompactly","supported","probability","measureμ(resp.ν),","almost","surely.\n11\n\nThen","the","following","pair","is","asymptotic","free","asM→∞,\nA(M),V(M)B(M)V(M)\n⊤\n,\nalmost","surely.\nNote","that","we","donotrequire","independence","betweenA(M)andB(M)in","Propo-\nsition\n2.9.","Here","we","recall","that","the","following","result,","which","is","a","direct","consequence","of\nthe","translation","invariance","of","Haar","random","matrices.\nLemma","2.10.FixM∈N.","LetV\n1\n,...,V\nL\nbe","independentO\nM\nHaar","random","ma-\ntrices.","LetT\n1\n,...,T\nL\nbeO\nM\nvalued","random","matrices.","LetS\n1\n,...,S\nL\nbeO\nM\nvalued\nrandom","matrices.","","LetA\n1\n,...,A\nL\nbeM×Mrandom","matrices.","","Assume","that","all\nentries","of(V\nℓ\n)\nL\nℓ=1\nare","independent","of\n(T\n1\n,...,T\nL\n,S\n1\n,...,S\nL\n,A\n1\n,...,A\nL\n).\nThen,\n(T\n1\nV\n1\nS\n1\n,...,T\nL\nV\nL\nS\nL\n,A\n1\n,...,A\nL\n)∼\nentries\n(V\n1\n,...,V\nL\n,A\n1\n,...,A\nL\n).(2.1)\nProof.For","the","readers’","convenience,","we","show","the","proof.","The","characteristic","function\nof","(\n2.1)","is","given","by\nE[exp[−iTr[\nL\nX\nℓ=1\nX\n⊤\nℓ\nT\nℓ\nV\nℓ\nS\nℓ\n+Y\n⊤\nℓ\nA\nℓ\n]]](2.2)\nwhereX\n1\n,...,X\nL\n∈M\nM\n(R)andY\n1\n,...,Y\nL\n∈M\nM\n(R).","By","using","conditional","expec-\ntation,","(\n2.2)","is","equal","to\nE\n\"\nE\n\"\nexp\n\"\n−iTr\n","\nL\nX\nℓ=1\nX\n⊤\nℓ\nT\nℓ\nV\nℓ\nS\nℓ\n!\n|T\nℓ\n,S\nℓ\n,A\nℓ\n(ℓ=","1,...,L)\n#\nexp\n\u0002\n−iTr\n\u0000\nY\n⊤\nℓ\nA\nℓ\n\u0001\u0003\n##\n.\n(2.3)\nBy","the","property","of","the","Haar","measure","and","the","independence,","theconditional","expec-\ntation","in","(\n2.3)","is","equal","to\nE\n\"\nexp\n\"\n−iTr\n","\nL\nX\nℓ=1\nX\n⊤\nℓ\nV\nℓ\n!#\n|T\nℓ\n,S\nℓ\n,A\nℓ\n(ℓ=","1,...,L)\n#\n.\nThus","the","assertion","holds.\n12\n\n3","","Key","to","Asymptotic","Freeness\n3.1","","Invariance\nSince","random","matrices’","universality","leads","to","asymptotic","freeness","Proposition\n2.8,","it\nis","essential","to","investigate","the","network’s","invariance.","The","following","invariance","is","the\nkey","to","the","main","theorem.\nLemma","3.1.LetW\n1\n,...,W\nL\nbe","independent","Haar","random","matrices","onO\nM\n.","Let\nx\n0\nbe","anR\nM\nvalued","random","variable.","For","eachℓ=","0,1,...,L−1,","letU\nℓ\nbe","anO\nM\nvalued","random","matrix","such","that\nU\nℓ\nx\nℓ\n=x\nℓ\n.(3.1)\nFurther","assume","that","all","entries","of(U\n0\n,...,U\nℓ−1\n)are","independent","from","that","of(W\nℓ\n,...,W\nL\n)\nfor","eachℓ=","0,1,...,L−1.","Then","the","following","holds,","in","joint","distributions","of","all\nentries:\n(W\n1\nU\n0\n,...,W\nL\nU\nL−1\n,h\n1\n,...,h\nL\n)∼\nentries\n(W\n1\n,...,W\nL\n,h\n1\n,...,h\nL\n).\nBefore","proving","Lemma\n3.1,","we","prepare","some","notations","to","treat","characteris-\ntic","functions","of","the","joint","distributions","of","entries.","","FixT\n1\n,...,T\nL\n∈M\nM\n(R)and\nξ\n1\n,...,ξ\nL\n∈ER\nM\n.","For","eachℓ=","1,...,L,","define","a","mapψ\nℓ\nby\nψ\nℓ\n(x,W)","=","exp\n\u0002\n−iTr(T\n⊤\nℓ\nW)−ihξ\nℓ\n,Wxi\n\u0003\n,\nwhereW∈M\nM\n(R)andx∈R\nM\n.","Write\nα\nℓ\n=ψ\nℓ\n(x\nℓ−1\n,W\nℓ\n),\nβ\nℓ\n=ψ\nℓ\n(x\nℓ−1\n,W\nℓ\nU\nℓ−1\n).\nBy","(\n3.1)","and","byW\nℓ\nx\nℓ−1\n=h\nℓ\n,","the","values","of","characteretic","functions","of","the","joint","distri-\nbutions","at","the","point(T\n1\n,...,T\nL\n,ξ\n1\n,...ξ\nL\n)is","given","byE[β\n1\n...β\nL\n]andE[α\n1\n...α\nL\n],\nrespectively.","In","addition,","we","visualize","the","dependency","of","the","random","variables","in\nFig.\n2.\nproof","of","Lemma3.1.We","prove","the","corresponding","characteristic","functions","of","thejoint\ndistributions","match.","We","only","need","to","show\nE[β\n1\n...β\nL\n]","=E[α\n1\n...α\nL\n].(3.2)\nFirstly,","we","claim","the","following:\nE[β\nℓ\nα\nℓ+1\n...α\nL\n|x\nℓ−1\n]","=E[α\nℓ\nα\nℓ+1\n...α\nL\n|x\nℓ−1\n],(3.3)\n13\n\nx\n0\nW\n1\n,...,W\nℓ−1\nx\nℓ−1\nα\nℓ\nβ\nℓ\nW\nℓ\nU\nℓ−1\nFigure","2:","A","graphical","model","of","random","variables","for","computing","characteristic","func-\ntions.","Two","nodes","in","the","graph","are","independnet","if","there","is","no","common","parent","node.\nfor","eachℓ=","1,...,L.","To","show","(\n3.3),","fixℓand","write","for","a","random","variablex,\nJ(x)","=E[α\nℓ+1\n...α\nL\n|x].\nBy","the","tower","property","of","conditional","expectations,","we","have\nE[β\nℓ\nα\nℓ+1\n...α\nL\n|x\nℓ−1\n]","=E[β\nℓ\nJ(x\nℓ\n)|x\nℓ−1\n]","=E[E[β\nℓ\nJ(x\nℓ\n)|x\nℓ−1\n,U\nℓ−1\n]|x\nℓ−1\n].(3.4)\nLetμbe","the","Haar","measure.","Then","by","the","invariance","of","the","Haar","measure,","we","have\nE[β\nℓ\nJ(x\nℓ\n)|x\nℓ−1\n,U\nℓ−1\n]","=\nZ\nψ\nℓ\n(x\nℓ−1\n,WU\nℓ−1\n)J(φ\nℓ\n(WU\nℓ−1\nx\nℓ−1\n))μ(dW)\n=\nZ\nψ\nℓ\n(x\nℓ−1\n,V)J(φ\nℓ\n(V","x\nℓ−1\n))μ(dV)\n=\nZ\nα\nℓ\nJ(x\nℓ\n)μ(dV)\n=E[α\nℓ\nE[α\nℓ+1\n...α\nL\n|x\nℓ\n]|x\nℓ−1\n]\n=E[α\nℓ\nα\nℓ+1\n...α\nL\n|x\nℓ−1\n].\nIn","particular,E[β\nℓ\nJ(x\nℓ\n)|x\nℓ−1\n,U\nℓ−1\n]isG(x\nℓ−1\n)-measurable,","whereG(X)is","theσ-\nalgebra","generated","by","a","random","variableX.","By","(\n3.4),","we","have","(3.3).\nSecondly,","we","claim","that","for","eachℓ=","1,...,L,\nE[β\n1\n...β\nℓ−1\nβ\nℓ\nα\nℓ+1\n...α\nL\n]","=E[β\n1\n...β\nℓ−1\nα\nℓ\nα\nℓ+1\n...α\nL\n].(3.5)\nDenote","byG\nℓ\ntheσ-algebra","generated","byx\n0\n,W\n1\n,...,W\nℓ\n,U\n0\n,...,U\nℓ−1\n.","Now,","for","each\nℓ,β\n1\n,...,β\nℓ−1\nareG\nℓ−1\n-measurable.","Therefore,\nE[β\n1\n...β\nℓ−1\nβ\nℓ\nα\nℓ+1\n...α\nL\n]","=E[β\n1\n...β\nℓ−1\nE[β\nℓ\nα\nℓ+1\n...α\nL\n|G\nℓ−1\n]].\n14\n\nNow","we","have\nE[β\nℓ\nα\nℓ+1\n...α\nL\n|G\nℓ−1\n]","=E[β\nℓ\nα\nℓ+1\n...α\nL\n|x\nℓ−1\n],\nsinceβ\nℓ\n,α\nℓ+1\n,...,α\nL\ndepend","only","onx\nℓ−1\n.","Therefore,","by","(3.3),","we","have\nE[β\n1\n...β\nℓ−1\nE[β\nℓ\nα\nℓ+1\n...α\nL\n|G\nℓ−1\n]]","=E[β\n1\n...β\nℓ−1\nE[α\nℓ\nα\nℓ+1\n...α\nL\n|G\nℓ−1\n]]\n=E[β\n1\n...β\nℓ−1\nα\nℓ\nα\nℓ+1\n...α\nL\n].\nTherefore,","we","have","proven","(\n3.5).","Lastly,","we","have","(3.2)","by","applying","(3.5)L-times.\n3.2","","Cutoff\nEach","invariance","described","in","Lemma\n2.10fixes","the","vectorx\nℓ−1\n,","and","there","are","no\nrestrictions","on","the","remainingM−1dimensions.","This","section","quantifies","the","fact\nthat","cutting","off","this","fixed","dimension","causes","no","significant","effect","when","taking","the\nlarge-dimensional","limit.\nLetP(M)be","theM×Mdiagonal","matrix","given","by\nP(M)","=","diag(1,1,...,1,0).(3.6)\nIf","there","is","no","confusion,","we","omit","the","indexMand","simply","write","itP.","Forp≥1,","we\ndenote","by||X||\np\ntheL\np\n-norm","ofX∈M\nM\n(R)defined","by\n||X||\np\n=","(tr|X|\np\n)\n1/p\n=\nh\ntr\nh\u0010\n√\nX\n⊤\nX\n\u0011\np\nii\n1/p\n.\nRecall","that","the","following","non-commutative","Hölder’s","inequality","holds:\n||XY||\nr\n≤||X||\np\n||Y||\nq\n,(3.7)\nfor","anyr,p,q≥1with1/r=","1/p+","1/q.\nLemma","3.2.Fixn∈N.","LetX\n1\n(M),...,X\nn\n(M)beM×Mrandom","matrices","for\neachM∈N.","Assume","that","there","is","a","constantC",">0such","that","almost","surely\nsup\nM∈N\nsup\nj=1,...,n\n||X\nj\n(M)||\nn\n≤C.\nLetP(M)be","the","orthogonal","projection","defined","in","Eq.(\n3.6).","Then","we","have","almost\nsurely\ntr[P(M)X\n1\n(M)P(M)...P(M)X\nn\n(M)P(M)]−tr[X\n1\n(M)...X\nn\n(M)]→0,(3.8)\nasM→∞.\n15\n\nProof.We","omit","the","indexMif","there","is","no","confusion.","","Let","us","denote","byTthe\nleft-hand","side","of","(3.8).","Then\nT=\nn−1\nX\nj=0\nPX\n1\n...PX\nk−j−1\n(P−1)X\nn−j\nX\nn−j+1\n...X\nn\n.\nBy","Hölder’s","inequality","(\n3.7),\n|trT|≤||T||\n1\n≤\nn−1\nX\nj=0\n||P||\nn−j−1\nn\n||X\n1\n||\nn\n...||X\nn\n||\nn\n||P−1||\nn\n.\nNow\n||P−1||\nn\n=","(\n1\nn\nM\n)\n1/n\n=\n1\nM\n1/n\n.\nThen","by","the","assumption,","we","have|trT|","≤nC\nn\n/M\n1/n\nalmost","surely.","","Then","the\nassertion","follows.\nNext,","we","check","that","a","cutoff","of","any","orthogonal","matrix","is","approximated","by","an\northogonal","matrix.\nLemma","3.3.For","anyO\nM\nvalued","random","matrixW,","there","isO\nM−1\nvalued","random\nmatrixUsatisfying\n||PWP−\n\u0012\nU0\n0","","0\n\u0013\n||\nn\n≤\n1\n(M−1)\n1/n\n,\nfor","anyn∈N,","almost","surely.\nProof.Consider","the","singular","value","decomposition(U\n1\n,D,U\n2\n)ofPWPin","theM−1\ndimensional","subspacePR\nM\n,","whereU\n1\n,U\n2\nbelong","toO\nM−1\n,D=","diag(λ\n1\n,...,λ\nM−1\n),\nandλ\n1\n≥","···","≥λ\nM−1\nare","singular","values","ofPWPexcept","for","the","trivial","singular\nvalue","zero.","Now\nPWP=\n\u0012\nU\n1\nDU\n2\n0\n00\n\u0013\n.\nSetU=U\n1\nU\n2\n.","NowUis","measurable","sinceU\n1\nandU\n2\nare","determined","by","the","singular\nvalue","decomposition.","We","claim","thatUis","the","desired","random","matrix.\nWe","only","need","to","show","thatTr[(1−D)\nn\n]≤1,","whereTris","the","unnormalized","trace.\nWrite\nR=P−(PWP)\n⊤\nPWP=PW\n⊤\n(1−P)WP.\nThenrankR≤1andTrR≤","||WPW\n⊤\n||Tr(1−P)≤1.","Therefore,R’s","nontrivial\nsingular","value","belongs","to[0,1].","We","write","itλ.","Then(PWP)\n⊤\nPW=P−Rhas\nnontrivial","eigenvalue1−λand","eigenvalue1of","multiplicityM−2.","Therefore,\nD\n2\n=","diag(1,...,1,1−λ).\nThusTr[(1−D)\nn\n]","=","(1−\n√\n1−λ)\nn\n≤1.","We","have","completed","the","proof.\n16\n\n4","","Asymptotic","Freeness","of","Layerwise","Jacobians\nThis","section","contains","some","of","our","main","results.","The","first","one","is","the","most","general\nform,","but","it","relies","on","the","existence","of","the","limit","joint","moments","of(D\nℓ\n)\nℓ\n.","The","second\none","is","required","for","the","analysis","of","the","dynamical","isometry.","The","last","one","is","needed\nfor","the","analysis","of","the","Fisher","information","matrix.","The","second","and","the","third","ones","do\nnot","assume","the","existence","of","the","limit","joint","moments","of(D\nℓ\n)\nℓ\n.\nIn","the","sequel,","for","eachℓ,M∈N,","letY\nℓ\nbe","aO\nM\nvalued","random","matrix","such","that\nY\nℓ\nx\nℓ\n=||x\nℓ\n||\n2\ne\nM\n,\nwheree\nM\nis","theM-th","vector","of","the","standard","basis","ofR\nM\n.","LetV\n1\n,...,V\nL\nbe","inde-\npendent","Haar","random","matrices","such","that","all","entries","of","them","are","independent","of","that\nof\n(W\n1\n,...,W\nL\n,x\n0\n).\nSet\nU\nℓ\n=Y\n⊤\nℓ\n\u0012\nV\nℓ\n0\n0","","1\n\u0013\nY\nℓ\n.\nThen\nU\nℓ\nx\nℓ\n=x\nℓ\n.\nFurther,","for","anyℓ=","0,...,ℓ−1,","all","entries","of(U\n0\n,...,U\nℓ−1\n)are","independent","from\nthat","of(W\nℓ\n,...,W\nL\n).","By","Lemma\n3.1,\n(W\n1\nU\n0\n,...,W\nL\nU\nL−1\n,D\n1\n,...,D\nL\n)∼\nentries\n(W\n1\n,...,W\nL\n,D\n1\n,...,D\nL\n).\nIn","addition,","for","anyn∈Nand","almost","surely","we","have\nmax\nℓ=1,...,L\nsup\nM∈N\n||D\nℓ\n||\nn\n<∞,(4.1)\nsince","eachD\nℓ\nhas","the","limit","spectral","distribution","by","Corollary\nB.4.\nWe","are","now","prepared","to","prove","our","main","theorem.\nTheorem","4.1.Assume","that(D\n1\n,...,D\nL\n)has","the","limit","joint","distribution","a.s..","Then\nthe","families(W\n1\n,W\n⊤\n1\n),...(W\nL\n,W\n⊤\nL\n),","and(D\n1\n,...,D\nL\n)are","asymptotically","free","as\nM→∞almost","surely.\nProof.By","Lemma\n3.2and","Eq.","(4.1),","we","only","need","to","show","the","asymptotic","freeness\nof","the","families\n(PW\nℓ\nPY\n⊤\nℓ−1\nP\n\u0012\nV\nℓ\n0\n0","","1\n\u0013\nPY\nℓ−1\nP)\nL\nℓ=1\n,(PD\n1\nP,...,PD\nL\nP).\n17\n\nNow\nP\n\u0012\nV\nℓ\n0\n0","","1\n\u0013\nP=\n\u0012\nV\nℓ\n0\n0","","0\n\u0013\n.\nIn","addition,","let\n`\nD\nℓ\nbe","theM−1×M−1matrix","determined","by\nPD\nℓ\nP=\n\u0012\n`\nD\nℓ\n0\n0","","0\n\u0013\n.(4.2)\nBy","Lemma\n3.3,","there","areO\nM−1\nvalued","radnom","matrices\n`\nW\nℓ\nand\n`\nY\nℓ−1\nsatisfying\n||PW\nℓ\nP−\n\u0012\n`\nW\nℓ\n0\n0","","0\n\u0013\n||\nn\n≤\n1\n(M−1)\n1/n\n,(4.3)\n||PY\nℓ\nP−\n\u0012\n`\nY\nℓ\n0\n0","","0\n\u0013\n||\nn\n≤\n1\n(M−1)\n1/n\n,\nfor","anyn∈N.","Therefore,","we","only","need","to","show","asymptotic","freeness","of","the","following\nL+","1families:\n\u0012\n`\nW\nℓ\n`\nY\n⊤\nℓ−1\nV\nℓ\n`\nY\nℓ−1\n,\n\u0010\n`\nW\nℓ\n`\nY\n⊤\nℓ−1\nV\nℓ\n`\nY\nℓ−1\n\u0011\n⊤\n\u0013\nL\nℓ=1\n,\n\u0010\n`\nD\n1\n,...,\n`\nD\nL\n\u0011\n.(4.4)\nNow","all","entries","of","Haar","random","matrices(V\nℓ\n)\nℓ\nare","independent","of","those","of(\n`\nW\nℓ\n,\n`\nY\nℓ−1\n,\n`\nD\nℓ\n)\nℓ\n.\nThus","by","Lemma\n2.10and","Proposition2.8,","the","asymptotic","freeness","of","Eq.","(4.4)","holds\nasM→∞almost","surely.","We","have","completed","the","proof.\nThe","following","result","is","useful","in","the","study","of","dynamical","isometry","and","spectral\nanalysis","of","Jacobian","of","DNNs.","It","follows","directly","from","Theorem\n4.1if","we","assume\nthe","existence","of","the","limit","joint","moments","of(D\nℓ\n)\nL\nℓ=1\n.","Note","that","the","following","result\ndoesnotassume","the","existence","of","the","limit","joint","moments.\nProposition","4.2.For","eachℓ=","1,...,L−1,","write\nJ\nℓ\n=D\nℓ\nW\nℓ\n...D\n1\nW\n1\n.\nThenJ\nℓ\nJ\n⊤\nℓ\nhas","the","limit","distribution","and","the","pair\nW\nℓ+1\nJ\nℓ\nJ\n⊤\nℓ\nW\n⊤\nℓ+1\n,D\n2\nℓ+1\n(4.5)\nis","asymptotically","free","asM→∞almost","surely.\n18\n\nProof.We","proceed","by","induction","overℓ.\nLetℓ=","1.","ThenJ\n1\nJ\n⊤\n1\n=D\n1\nD\n⊤\n1\nhas","the","limit","spectral","distribution","by","Proposi-\ntion\nB.3.","Eq.","(4.5)","is","equal","toW\n2\nD\n1\nD\n⊤\n1\nW\n⊤\n2\n.","LetV\n2\nbe","ad×dHaar","random","matrix\nindependent","fromW\n1\n,W\n2\n,x\n0\n.","Then","we","only","need","to","show","that(W\n2\nU\n1\nD\n2\n1\nU\n2\nW\n⊤\n2\n)is\nasymptotically","free","fromD\n2\n2\n.","By","Lemma\n3.2and","Eq.","(4.1),","we","only","need","to","show\nthat\nPW\n2\nPY\n⊤\n1\nP\n\u0012\nV\nℓ\n0\n0","","1\n\u0013\nPD\n2\n1\nP\n\u0012\nV\n⊤\nℓ\n0\n0","","","1\n\u0013\nPY\n1\nPW\n⊤\n2\nP\nandPD\n2\n2\nP.","By","Lemma\n3.3,","there","are\n`\nW\nℓ\n∈O\nM−1\nand\n`\nY\nℓ−1\n∈O\nM−1\nwhich","approxi-\nmatePW\nℓ\nPandPY\nℓ−1\nPin","the","sence","of","Eq.","(\n4.3).","Let\n`\nD\nℓ\nbe","theM−1×M−1\nrandom","matrix","given","by","Eq.","(4.2).","Therefore,","we","only","need","to","show","the","asymptotical\nfreeness","of","the","following","pair:\n`\nW\n2\n`\nY\n⊤\n1\nV\n2\n`\nD\n2\n1\nV\n⊤\n2\nY\n1\n`\nW\n⊤\n2\n,\n`\nD\n2\n2\n.\nBy","the","independence","and","Lemma\n2.10,","the","asymptotic","freeness","holds","almost","surely.\nNext,","fixℓ∈[1,L−1]and","assume","that","the","limit","spectral","distribution","ofJ\nℓ\nJ\n⊤\nℓ\nexists","and","the","asymptotic","freeness","holds","for","theℓ.","There","exists\n`\nJ\nℓ\n∈M\nM−1\n(R)so\nthat\nPJ\nℓ\nP=\n\u0012\n`\nJ\nℓ\n0\n0","","0\n\u0013\n.\nThen","for","the","case","ofℓ+","1,","by","the","same","argument","as","above,","we","only","need","to","show\nthe","asymptotic","freeness","of\n`\nW\nℓ+1\n`\nY\n⊤\nℓ\nV\nℓ+1\n`\nJ\nℓ\n`\nJ\n⊤\nℓ\nV\n⊤\nℓ+1\nY\nℓ\n`\nW\n⊤\nℓ+1\n,\n`\nD\n2\nℓ+1\n.\nNow,","all","enties","ofV\nℓ+1\nand","their","adjoint","are","independent","from","those","of(\n`\nJ\nℓ\n,\n`\nW\nℓ+1\n,\n`\nY\nℓ\n,\n`\nD\nℓ+1\n).\nBy","the","independence","and","Lemma\n2.10,","we","only","need","to","show","the","asymptotic","freeness\nof\nV\nℓ+1\n`\nJ\nℓ\n`\nJ\n⊤\nℓ\nV\n⊤\nℓ+1\n,\n`\nD\n2\nℓ+1\n.\nThe","asymptotic","freeness","of","the","pair","follows","from","Proposition2.9.","","The","assertion\nfollows","by","induction.\nProposition","4.3.DefineH\nℓ\ninductively","byH\n1\n=I\nM\nand\nH\nℓ+1\n=","ˆq\nℓ\nI+W\nℓ+1\nD\nℓ\nH\nℓ\nD\nℓ\nW\n⊤\nℓ+1\n,\nwhereˆq\nℓ\n=\nP\nM\nj=1\n|x\nℓ\nj\n|\n2\n/Mandℓ=","1,...,L−1.","Then","for","eachℓ=","1,2,...,L,H\nℓ\nhas","a","limit","spectral","distribution","and","the","pair\nH\nℓ\n,D\nℓ\nis","asymptotically","free","asM→∞,","almost","surely.\n19\n\nProof.We","proceed","by","induction","overℓ.","The","caseℓ=","1is","trivial.","Assume","that","the\nassertion","holds","for","anℓ≥1and","consider","the","caseℓ+1.","Let\n`\nH\nℓ\nbe","theM−1×M−1\nmatrix","determined","by\nPH\nℓ\nP=\n\u0012\n`\nH\nℓ\n0\n0","","0\n\u0013\n.\nBy","the","same","arguments","as","above,","we","only","need","to","prove","the","asymptotic","freeness","of\nthe","following","pair:\n`\nW\nℓ+1\n`\nY\nℓ\nV\nℓ\n`\nY\n⊤\nℓ\n`\nD\nℓ\n`\nH\nℓ\n`\nD\nℓ\n(W\nℓ+1\n`\nY\nℓ\nV\nℓ\n`\nY\n⊤\nℓ\n)\n⊤\n,\n`\nD\nℓ+1\n.\nBy","Lemma\n2.10,","considering","the","joint","distributions","of","all","entries,","we","only","need","to\nshow","the","asymptotic","freeness","of","the","following","pair:\nV\nℓ\n`\nD\nℓ\n`\nH\nℓ\n`\nD\nℓ\nV\n⊤\nℓ\n,\n`\nD\nℓ+1\n.\nBy","the","assumption,\n`\nD\nℓ\n`\nH\nℓ\n`\nD\nℓ\nhas","the","limit","spectral","distribution.","Then","by","Proposi-\ntion\n2.9,","the","assertion","holds","forℓ+","1.","The","assertion","follows","by","induction.\n5","","Application\nLetν\nℓ\nbe","the","limit","spectral","distribution","eachD\n2\nℓ\nfor","eachℓ.","We","introduce","applications\nof","the","main","results.\n5.1","","Jacobian","and","Dynamical","Isometry\nFor","the","sake","of","the","theory’s","framework","letJbe","the","Jacobian","of","the","network.","We\nsay","that","the","a","DNN","achieves","dynamical","isometry","if","all","eigenvalues","ofJJ\n⊤\nareO(1)\nasL→","∞[\nSMG14,PSG17,PSG18].","To","examine","the","dynamical","isometry","as","the\nwide","limitM→∞and","the","the","deep","limitL→∞,","[\nPSG17,PSG18,HK21]","consider\nS-transform","of","the","spectral","distribution.","","(See","AppendixCfor","the","definition","of\nS-transform).","Now\nJ=J\nL\n=D\nL\nW\nL\n...D\n1\nW\n1\n.\nRecall","that","the","existence","of","the","limit","spectral","distribution","of","eachJ\nℓ\n(ℓ=","1,...,L)\nis","supported","by","Proposition\n4.2.\nCorollary","5.1.Letξ\nℓ\nbe","the","limit","spectral","distribution","asM→","∞ofJ\nℓ\nJ\n⊤\nℓ\n.","Then\nfor","eachℓ=","1,...,L,","it","holds","that\nS\nξ\nℓ\n(z)","=\n1\nσ\n2\nw,1\n...σ\n2\nw,ℓ\nS\nν\n1\n(z)···S\nν\nℓ\n(z).(5.1)\n20\n\nProof.Consider","the","caseℓ=","1.","","ThenJ\n1\nJ\n⊤\n1\n=D\n1\nW\n1\nW\n⊤\n1\nD\n1\n=σ\n2\nw,1\nD\n2\n1\n.","","Then\nS\nξ\nℓ\n(z)","=σ\n−2\nw,1\nS\nν\n1\n(z).\nAssume","that","Eq.","(5.1)","holds","for","anℓ≥1.","Consider","the","caseℓ+","1.","By","Proposi-\ntion\n4.2,W\n⊤\nℓ+1\nW\nℓ+1\n=σ\n2\nw,ℓ+1\nIand","the","tracial","condition,\nS\nξ\nℓ+1\n(z)","=\n1\nσ\n2\nw,ℓ+1\nS\nξ\nℓ\n(z)S\nν\nℓ+1\n(z).\nThe","assertion","holds","by","induction.\nCorollary5.1gives","the","rigorous","statement","and","proof","for","[PSG18],","and","it","enable\nus","to","compute","the","deep","limitS\nξ\nL\n(z)asL→∞.\n5.2","","Fisher","Information","Matrix","and","Training","Dynamics\nWe","focus","on","thethe","Fisher","information","matrix(FIM)","for","supervised","learning","with\na","mean","squared","error","(MSE)","loss","[\nPB14,PW18,KAA19a].","Let","us","summarize","its\ndefinition","and","basic","properties.","","Givenx∈R\nM\nandθ,","we","consider","a","Gaussian\nprobability","model\np\nθ\n(y|x)","=\n1\n√\n2π\nexp","(−L(f\nθ\n(x)−y))","(y∈R\nM\n).\nNow,","the","normalized","MSE","lossLis","given","byL(u)","=\n||u||\n2\n2\n2M\n,","foru∈R\nM\n,","and||·||\n2\nis\nthe","Euclidean","norm.","In","addition,","consider","a","probability","density","functionp(x)and\na","joint","densityp\nθ\n(x,y)","=p\nθ\n(y|x)p(x).","Then,","the","FIM","is","defined","by\nI(θ)","=\nZ\n[∇\nθ\nlogp\nθ\n(x,y)\n⊤\n∇\nθ\nlogp\nθ\n(x,y)]p\nθ\n(x,y)dxdy,\nwhich","is","anLM\n2\n×LM\n2\nmatrix.","As","it","is","known","in","information","geometry","[\nAma16],\nthe","FIM","works","as","a","degenerate","metric","on","the","parameter","space:","the","Kullback-Leibler\ndivergence","between","the","statistical","model","and","itself","perturbed","by","an","infinitesimal\nshiftdθis","given","byD\nKL\n(p\nθ\n||p\nθ+dθ\n)","=dθ\n⊤\nI(θ)dθ.More","intuitive","understanding","is\nthat","we","can","write","the","Hessian","of","the","loss","as\n∂\n∂θ\n2\nE\nx,y\n[L(f\nθ\n(x)−y)]","=I(θ)","+E\nx,y\n[(f\nθ\n(x)−y)\n⊤\n∂\n∂θ\n2\nf\nθ\n(x)].\nHence","the","FIM","also","characterizes","the","local","geometry","of","the","loss","surface","around\na","global","minimum","with","a","zero","training","error.","","In","addition,","we","regardp(x)as","an\nempirical","distribution","of","input","samples","and","then","the","FIM","is","usually","referred","to","as\nthe","empirical","FIM","[\nKBH19,PW18,KAA19a].\n21\n\nThe","conditional","FIM","is","used","in","[HK21]","for","the","analysis","of","training","dynamicsl\nof","DNNs","achieving","dynamical","isometry.","Now,","we","denote","byI(θ|x)theconditional\nFIM(or","FIM","per","sample)","given","a","single","inputxdefined","by\nI(θ|x)","=\nZ\n[∇\nθ\nlogp\nθ\n(y|x)\n⊤\n∇\nθ\nlogp\nθ\n(y|x)]p\nθ\n(y|x)dy.\nClearly,\nR\nI(θ|x)p(x)dx=I(θ).","Sincep\nθ\n(y|x)is","Gaussian,","we","have\nI(θ|x)","=\n1\nM\nJ\n⊤\nθ\nJ\nθ\n.\nNow,","in","order","to","ignoreI(θ|x)’s","trivial","eigenvalue","zero,","consider","a","dual","ofI(θ|x)\ngiven","by\nJ(x,θ)","=\n1\nM\nJ\nθ\nJ\n⊤\nθ\n,\nwhich","is","anM×Mmatrix.","Except","for","trivial","zero","eigenvalues,I(θ|x)andJ(x,θ)\nshare","the","same","eigenvalues","as","follows:\nμ\nI(θ|x)\n=\nLM\n2\n−M\nLM\n2\nδ\n0\n+\n1\nL\nμ\nJ(x,θ)\n,\nwhereμ\nA\nis","the","spectral","distribution","for","a","matrixA.","Now,","for","simplicity,","consider\nthe","case","bias","parameters","are","zero.","Then","it","holds","that\nJ(x,θ)","=D\nL\nH\nL\nD\nL\n,\nwhere\nH\nL\n=\nL\nX\nℓ=1\nˆq\nℓ−1\nδ\nL→ℓ\nδ\n⊤\nL→ℓ\n,\nδ\nL→ℓ\n=\n∂h\nL\n∂h\nℓ\n.\nSinceδ\nL→ℓ\n=W\nL\nD\nL−1\nδ\nL−1→ℓ\n(ℓ","<","L),","it","holds","that\nH\nℓ+1\n=","ˆq\nℓ\nI+W\nℓ+1\nD\nℓ\nH\nℓ\nD\nℓ\nW\n⊤\nℓ+1\n,\nwhereIis","the","identity","matrix.\nCorollary","5.2.Letμ\nℓ\nbe","the","limit","spectral","distribution","asM→","∞ofH\nℓ\n(ℓ=\n1,...,L).","Setq\nℓ\n=","lim\nM→∞\nˆq\nℓ\n.","Then","for","eachℓ=","1,...,Lit","holds","that\nμ\nℓ+1\n=","(q\nℓ\n+σ\n2\nℓ+1\n·)\n∗\n(μ\nℓ\n⊠ν\nℓ\n),(5.2)\nwheref\n∗\nμis","the","pushforward","of","a","measureμby","a","meaurable","mapf.\nProof.The","assertion","directly","follows","from","Proposition\n4.3and","by","induction.\n[HK21]","uses","the","recursive","equation","Eq.","(5.2)","to","compute","the","maximum","value","of\nthe","limit","spectrum","ofH\nL\n.\n22\n\n6","","Discussion\nWe","have","proved","the","asymptotic","freeness","of","MLPs","with","Haar","orthogonal","initialization\nby","focusing","on","the","invariance","of","the","MLP.","[\nHN19]","shows","the","asymptotic","freeness","of\nMLP","with","Gaussian","initialization","and","ReLU","activation.","","The","proof","is","based","on\nthe","observation","that","each","ReLU’s","derivation","is","replaced","with","independent","Bernoulli\nfrom","weight","matrices.","On","the","contrary,","our","proof","is","based","on","the","observation","that\nweight","matrices","are","replaced","with","independent","random","matrices","from","activations’\nJacobians","based","on","Haar","orthogonal","random","matrices’","invariance.","In","addition,","the\nasymptotic","freeness","of","MLP","with","Gaussian","initialization","isproved","in","[\nYan19,Yan20],\nwhich","relies","on","Gaussianity.","Since","our","proof","is","based","on","the","orthogonal","invariance\nof","weight","matrices,","we","expect","that","our","proof","will","cover","the","GOE.\nIt","is","straightforward","to","extend","our","results","including","Theorem\n4.1to","MLPs","with\nHaar","unitary","weights","since","the","proof","basely","relies","on","the","invariance","of","weight","matri-\nces","(see","Lemma\n3.1)","and","the","cut","off","(see","Lemma3.3).","We","expect","that","our","theorem\ncan","be","extended","to","Haar","permutation","weights","since","Haar","distributed","random","per-\nmutation","matrices","and","independent","random","matrices","are","asymptotic","free","[\nCŚ06].\nMoreover,","we","expect","that","the","main","results","will","be","extended","tocover","MLPs","with\northogonal/unitary/permutation","invariant","random","weights","since","each","proof","is","based\non","the","invariance","of","MLP.\nThe","neural","tangent","kernel","theory","[\nJGH18]","describes","the","learning","dynamics","of\nDNNs","when","the","dimension","of","the","last","layer","is","relatively","smaller","than","the","hidden\nlayers.","In","our","analysis,","we","do","not","consider","such","a","case","and","instead","consider","the","case\nwhere","the","last","layer","has","the","same","dimension","as","the","hidden","layers.\nAcknowledgement\nBC","was","supported","by","JSPS","KAKENHI","17K18734","and","17H04823.","The","research","of\nTH","was","supprted","by","JST","JPM-JAX190N,","Japan.\nReferences\n[Ama16]","","","","Shun-ichi","Amari.Information","geometry","and","its","applications.","Springer,\n2016.\n[CŚ06]Benoît","Collins","and","Piotr","Śniady.","Integration","with","respect","to","the","haar\nmeasure","on","unitary,","orthogonal","and","symplectic","group.Communications\nin","Mathematical","Physics,","264(3):773–795,","2006.\n[Dur10]R.","Durret.Probability",":","theory","and","examples,","fourth","edition.","Cambridge\nUniversity","Press,","2010.\n23\n\n[GBC16]","","","Ian","Goodfellow,","Yoshua","Bengio,","and","Aaron","Courville.Deep","Learning.\nMIT","Press,","2016.\n[GCC\n+\n19]","","Dar","Gilboa,","Bo","Chang,","Minmin","Chen,","Greg","Yang,","Samuel","S","Schoenholz,\nEd","H","Chi,","and","Jeffrey","Pennington.","Dynamical","isometry","and","a","mean\nfield","theory","of","lstms","and","grus.arXiv","preprint","arXiv:1901.08987,","2019.\n[HK21]Tomohiro","Hayase","and","Ryo","Karakida.","The","spectrum","of","Fisher","informa-\ntion","of","deep","networks","achieving","dynamical","isometry.","InProceedings","of\nInternational","Conference","on","Artificial","Intelligence","and","Statistics","(AIS-\nTATS)","(arXiv:2006.07814),","2021.\n[HN19]Boris","Hanin","and","Mihai","Nica.","Products","of","many","large","random","matrices\nand","gradients","in","deep","neural","networks.Communications","in","Mathemat-\nical","Physics,","376:1–36,","2019.\n[JGH18]","","","","Arthur","Jacot,","Franck","Gabriel,","and","Clément","Hongler.Neural","tangent\nkernel:","Convergence","and","generalization","in","neural","networks.","InAdvances\nin","neural","information","processing","systems","(NeurIPS),","pages","8571–8580,\n2018.\n[KAA19a]","","Ryo","Karakida,","Shotaro","Akaho,","and","Shun-ichi","Amari.The","normalization\nmethod","for","alleviating","pathological","sharpness","in","wide","neural","networks.\nInAdvances","in","neural","information","processing","systems","(NeurIPS),","2019.\n[KAA19b]","","Ryo","Karakida,","Shotaro","Akaho,","and","Shun-ichi","Amari.Universal","statis-\ntics","of","Fisher","information","in","deep","neural","networks:","Mean","field","approach.\nInProceedings","of","International","Conference","on","Artificial","Intelligence","and\nStatistics","(AISTATS);","(arXiv1806.01316),","pages","1032–1041,","2019.\n[KBH19]","","","Frederik","Kunstner,","Lukas","Balles,","and","Philipp","Hennig.","Limitations","of\nthe","empirical","Fisher","approximation.","InAdvances","in","neural","information\nprocessing","systems,","2019.\n[LBH15]","","","","Yann","LeCun,","Yoshua","Bengio,","and","Geoffrey","Hinton.","Deeplearning.Na-\nture,","521(7553):436–444,","2015.\n[LKS91]","","","","Yann","LeCun,","Ido","Kanter,","and","Sara","A.","Solla.","Eigenvalues","of","covariance\nmatrices:","Application","to","neural-network","learning.Physical","Review","Let-\nters,","66(18):2396–2399,","1991.\n[Pas20]Leonid","Pastur.","On","random","matrices","arising","in","deep","neural","networks:\nGaussian","case.","arXiv","preprint,","arXiv:2001.06188,","2020.\n24\n\n[PB14]Razvan","Pascanu","and","Yoshua","Bengio.","Revisiting","natural","gradient","for\ndeep","networks.ICLR","2014,","arXiv:1301.3584,","2014.\n[PSG17]","","","","Jeffrey","Pennington,","Samuel","Schoenholz,","and","Surya","Ganguli.","Resurrect-\ning","the","sigmoid","in","deep","learning","through","dynamical","isometry:","theory\nand","practice.","","InAdvances","in","neural","information","processing","systems\n(NeurIPS),","pages","4785–4795,","2017.\n[PSG18]","","","","Jeffrey","Pennington,","Samuel","Schoenholz,","and","Surya","Ganguli.","The","emer-\ngence","of","spectral","universality","in","deep","networks.","InProceedings","of","Inter-\nnational","Conference","on","Artificial","Intelligence","and","Statistics","(AISTATS),\npages","1924–1932,","2018.\n[PW18]Jeffrey","Pennington","and","Pratik","Worah.","The","spectrum","of","the","Fisher","infor-\nmation","matrix","of","a","single-hidden-layer","neural","network.","InProceedings","of\nAdvances","in","Neural","Information","Processing","Systems","(NeurIPS),","pages\n5410–5419,","2018.\n[RS\n+\n07]","","","","N","Raj","Rao,","Roland","Speicher,","et","al.","Multiplication","of","freerandom","vari-\nables","and","the","S-transform:","The","case","of","vanishing","mean.Electron.","Com-\nmun.","Probab.,","12:248–258,","2007.\n[SGGSD17]","Samuel","S","Schoenholz,","Justin","Gilmer,","Surya","Ganguli,","and","Jascha\nSohl-Dickstein.Deep","","information","","propagation.ICLR","","2017,\narXiv:1611.01232,","2017.\n[SMG14]","","","Andrew","M","Saxe,","James","L","McClelland,","and","Surya","Ganguli.","Exact","so-\nlutions","to","the","nonlinear","dynamics","of","learning","in","deep","linearneural","net-\nworks.ICLR","2014,","arXiv:1312.6120,","2014.\n[SP20]Piotr","A","Sokol","and","Il","Memming","Park.","Information","geometry","of","orthog-\nonal","initializations","and","training.ICLR","2020,","arXiv:1810.03785,","2020.\n[Voi85]Dan","V","Voiculescu.","","Symmetries","of","some","reduced","free","product","C*-\nalgebras.","","InOperator","Algebras","and","their","Connections","with","Topology\nand","Ergodic","Theory,","volume","1132","ofLecture","Notes","in","Math.,","pages","556–\n588.","Springer,","Berlin,","1985.\n[Voi87]Dan","V","Voiculescu.","","Multiplication","of","certain","non-commuting","random\nvariables.J.","Operator","Theory,","18:223–235,","1987.\n[Voi91]Dan","V","Voiculescu.","Limit","laws","for","random","matrices","andfree","products.\nInvention","Math.,","104:201–220,","1991.\n25\n\n[WME18]","","","Lei","Wu,","Chao","Ma,","and","Weinan","E.","How","sgd","selects","the","global","minima\nin","over-parameterized","learning:","A","dynamical","stability","perspective.","In\nS.","Bengio,","H.","Wallach,","H.","Larochelle,","K.","Grauman,","N.","Cesa-Bianchi,\nand","R.","Garnett,","editors,Advances","in","Neural","Information","Processing\nSystems","31,","pages","8279–8288.","Curran","Associates,","Inc.,","2018.\n[XBSD\n+\n18]","Lechao","Xiao,","Yasaman","Bahri,","Jascha","Sohl-Dickstein,","Samuel","S","Schoen-\nholz,","and","Jeffrey","Pennington.","","Dynamical","isometry","and","a","mean","field\ntheory","of","CNNs:","How","to","train","10,000-layer","vanilla","convolutional","neu-\nral","networks.","InProceedings","of","International","Conference","on","Machine\nLearning","(ICML),","pages","5393–5402,","2018.\n[Yan19]Greg","Yang.","Scaling","limits","of","wide","neural","networks","with","weight","sharing:\nGaussian","process","behavior,","gradient","independence,","and","neural","tangent\nkernel","derivation.arXiv:1902.04760,","2019.\n[Yan20]Greg","Yang.","Tensor","programs","III:","Neural","matrix","laws.arXiv","preprint\narXiv:2009.10685,","2020.\nA","","Review","on","Probability","Theory\nTheorem","A.1(Continuous","Mapping","Theorem).[\nDur10,","Theorem","3.2.4]","Letgbe\na","measurable","function","and\nN\ng\n={x∈R|gis","discontinuous","atx}.\nIfX\nn\n⇒X\n∞\nandP(X\n∞\n∈N\ng\n)","=","0then\ng(X\nn\n)⇒g(X\n∞\n).\nIf","besidesgis","bounded,","then\nE[g(X\nn\n)]→E[g(X\n∞\n)].\nTheorem","A.2.(Lindeberg-Feller","Central","Limit","Theorem","for","Triangular","Array)[\nDur10,\nTheorem","3.4.10]\nFor","eachn,","letX\nn,m\n,1≤m≤n,","be","independent","random","variables","withE[X\nn,m\n]","=\n0.","Suppose\n1.","forn∈N,\nP\nn\nm=1\nE[X\n2\nn,m\n]→σ\n2\n>0,\n2.","for","allε",">0,lim\nn→∞\nP\nn\nm=1\nE[X\n2\nn,m\n;|X\nn,m\n|>","ε]","=","0.\nThenS\nn\n:=X\nn,1\n+...X\nn,n\n⇒N(0,σ\n2\n)asn→∞.\n26\n\nLemma","A.3.LetX\nn,m\n(m=","1,...,n)be","i.i.d.","random","variables","for","eachn.","As-\nsume","that\nX\nn,1\n⇒μ,\nasn→∞for","a","probability","measureμ.","Then","we","have\n1\nn\nn\nX\nm=1\nδ\nX\nn,m\n⇒μ,\nasd→∞almost","surely.\nProof.It","suffices","to","show∀f∈C\nb\n(R),\n1\nn\nn\nX\nk=1\nf(X\nn,m\n)→\nZ\nf(x)μ(dx).\nasn→∞almost","surely.","Setα\nn\n:=E[f(X\nn,m\n)]andS\nn\n:=\nP\nn\nk=1\n(f(X\nn,m\n)−α\nn\n).","By\nthe","assumption,","we","have\nlim\nn→∞\nα\nn\n=\nZ\nf(x)μ(dx).\nWe","claim","that\nlim\nn→∞\n|S\nn\n/n|=","0\nalmost","surely.","To","show","this,","by","Borel-Canteli’s","lemma,","we","only","need","to","show","that\n∀ǫ",">0,\n∞\nX\nn=1\nP(|S\nn\n/n|>","ǫ)<∞.\nSetY\nn\n:=f(X\nn,m\n)−α\nn\n.","Then\nE[S\n4\nn\n]","=E[Y\n4\nn\n]−3(n\n2\n−n)E[Y\n2\nn\n]\n2\n<","Cn\n2\nfor","a","constantC",">0,","becausefis","bounded.","Hence","we","have\nP(|S\n4\nn\n/n\n4\n|>","ǫ\n4\n)≤\n1\nn\n4\nǫ\n4\nE[S\n4\nn\n]","=\nC\nn\n2\nǫ\n4\n.\nThus","we","have","proven","the","assertion.\n27\n\nB","","Signal","Propagation","through","Network","with","Or-\nthogonal","Weights\nB.1","","Action","of","Haar","Orthogonal","Matrices\nFirstly","we","consider","action","of","Haar","orthogonal","to","a","random","vector","with","finite","second\nmoment.","Forp-dimensional","random","vectorx,","we","denote","its","empirical","distribution\nby\nν\nx\n:=\n1\nM\nM\nX\ni=1\nδ\nx\ni\n,\nwhereδ\nx\nis","the","delta","probability","measure","at","the","pointx∈R.\nNote","that","we","donotassume","that","entries","ofx(M)are","independent","in","the","following\nLemma.\nLemma","B.1.Let(Ω,F,P)be","a","probability","space","and(x(M))\nM\nbe","a","sequence","of\nR\nM\n-valued","random","variables.","Assume","that","there","existsr",">0such","that\nv\nu\nu\nt\n1\nM\nM\nX\ni=1\n(x(M)\ni\n)\n2\n→r\nasM→∞almost","surely.","LetO(M)be","a","Haar","distributedM-dimensional","orthogo-\nnal","matrix.","Set\nh(M)","=O(M)x(M).\nFurthermore","we","assume","thatx(M)andO(M)are","independent.","Then\nν\nh(M)\n=>N(0,r\n2\n)\nasM→∞almost","surely.\nProof.Lete\n1\n=","(1,0,...,0)∈R\nM\n.","Then","there","is","a","orthogonal","random","matrixU\nsuch","thatx(M)","=||x(M)||\n2\nUe\n1\n,","where||·||\n2\nis","the","Euclid","norm.","Writer(M)",":=\n||x(M)||\n2\n/\n√\nMandu(M)be","unit","vector","uniformly","distributed","on","the","unit","sphere,\nindependent","ofr(M).","SinceO(M)is","a","Haar","orthogonal","and","sinceO(M)andUare\nindependent,","it","holds","thatO(M)U∼\ndist.\nO(M).","Then\nh(M)","=O(M)x(M)","=","(||x(M)||\n2\n/\n√\nM)(\n√\nMO(M)Ue\n1\n)\ndist.\nr(M)(\n√\nMu(M)).\nFirstly,","by","the","assumption,\nr(M)","=\nv\nu\nu\nt\n1\nM\nM\nX\ni=1\n(x\ni\n)\n2\n→rasM→∞,","almost","surely.\n28\n\nSecondly,","let(Z\ni\n)\n∞\ni=1\nbe","i.i.d.","standard","Gaussian","random","variables.","Then\nu(M)∼\ndist\n\n\nZ\ni\nq\nP\nM\ni=1\nZ\n2\ni\n\n\nM\ni=1\n.\nFork∈N,\nm\nk\n(ν\n√\nM","u(M)\n)","=\n1\nM\nM\nX\ni=1\nM\nk/2\n(u(M))\nk\n=\nM\n−1\nP\nM\ni=1\nZ\nk\ni\n[M\n−1\nP\nM\ni=1\nZ\n2\ni\n]\nk/2\n→\nm\nk\n(N(0,1))\nm\n2\n(N(0,1))\nk/2\n=m\nk\n(N(0,1))asM→∞,","a.s.\nNow","convergence","in","moments","to","Gaussian","distribution","implies","convergence","in","law.\nTherefore,\nν\n√\nM","u(M)\n=>N(0,1),\nalmost","surely.","This","completes","the","proof.\nLemma","B.2.Letgbe","a","measurable","function","andN\ng\n:={x∈R|gis","discontinuous","atx}.\nLetZ∼N(0,1).","","Assume","thatP(Z∈N\ng\n)","=","0.","","Then","under","the","setting","of\nLemma\nB.1,","it","holds","that\nν\ng(h(M))\n=>","g(Z)\nasM→∞almost","surely.\nProof.LetN={ω∈Ω|ν\ng(h(M)(ω))\n=>","g(Z)asM→","∞}.","","By","Lemma\nB.1,\nP(N)","=","0.","Fixω∈Ω\\N.","ForM∈N,","letX\nM\nbe","a","real","random","variable","on","the\nprobability","space(Ω,P)with\nX\nM\n∼ν\nh(M)(ω)\n.\nBy","the","assumption,","we","haveP(Z∈N\ng\n)","=","0.","Then","Theorem\nA.1implies","that\ng(X\nM\n)⇒g(Z).\nThus","for","any","bounded","continuous","functionψ,\nZ\nψ(t)ν\ng◦h\nM\n(ω)\n(dt)","=\n1\nM\nM\nX\ni=1\nψ◦g\n\u0000\nh\ni\n(ω)\n\u0001\n=E[ψ◦g(X\nM\n)]→E[ψ◦g(Z)].\nHenceν\ng(h(ω))\n=>","g(Z).","Since","we","took","arbitraryω∈Ω\\NandP(Ω\\N)","=","1,","the\nassertion","follows.\n29\n\nB.2","","Convergence","of","Empirical","Distribution\nFurthermore,","for","any","measurable","functiongonRand","probability","measureμ,","we\ndenote","byg\n∗\n(μ)the","push-forward","ofμ.","","That","is,","if","a","real","random","variableXis\ndistributed","withμ,","theng\n∗\n(μ)is","the","distribution","ofg(X).\nProposition","B.3.For","allℓ=","1,...,L,","it","holds","that\n1.ν\nh\nℓ\n⇒N(0,q\nℓ\n),\n2.ν\nφ\nℓ\n(h\nℓ\n)\n⇒φ\nℓ,∗\n(N(0,q\nℓ\n)),\n3.ν\nφ\n′\nℓ\n(h\nℓ\n)\n⇒φ\n′\nℓ,∗\n(N(0,q\nℓ\n)),\nasM→∞almost","surely.\nProof.The","proof","is","by","induction","onℓ.","Letℓ=","1.","Thenq\n1\n=σ\n2\nw,1\nr\n2\n+σ\n2\nb,1\n.","By\nLemma\nB.1,Prop.","B.3","(1)follows.","Sinceφ\n1\nis","continuous,Prop.","B.3","(2)follows.","Since\nφ\n′\n1\nis","continuous","almost","everywhere","by","the","assumption","((a4)),Prop.","B.3","(3)follows","by\nLemma\nB.1.","Now","we","have||x\n1\n||\n2\n/\n√\nM=\np\nm\n2\n(ν\nφ\n1\n(h\n1\n)\n)⇒\np\nm\n2\n(φ\n1,∗\n(N(0,q\n1\n)))","=r\n1\n.\nThe","same","conclusion","can","be","drawn","for","the","rest","of","induction.\nCorollary","B.4.For","eachℓ=","1,...,L,D\nℓ\nhas","the","compactly","supported","limit","spectral\ndistributionφ\n′\nℓ,∗\n(N(0,q\nℓ\n))asM→∞.\nProof.The","assertion","follows","directly","from","Item\nProp.","B.3","(3)and(a5).\nC","","Review","on","Free","Multiplicative","Convolution\nLet(A,τ)be","a","NCPS.","Fora∈Awithτ(a)6=","0,","theS-transformofais","defined","as\nthe","formal","power","series\nS\na\n(z)",":=\n1","+z\nz\nM\n<−1>\na\n(z),\nwhere\nM\na\n(z)",":=\n∞\nX\nn=1\nτ(a\nn\n)z\nn\n.\nFor","example,","given","discrete","distributionν=αδ\n0\n+","(1−α)δ\nγ\nwith0≤α≤1and\nγ",">0,","we","haveS\nν\n(z)","=γ\n−1\n(z+α)\n−1\n(z+","1).\nThe","relevance","of","S-transform","in","FPT","is","due","to","the","following","theorem","of","Voiculescu\n[\nVoi87]:","if(a,b)is","free","withτ(a),τ(b)6=","0then\nS\nab\n(z)","=S\na\n(z)S\nb\n(z).\n30\n\nFurther","we","assume","thata,bare","self-adjoint","andb≥0.","we","define","the","multiplicative\nconvolution\nμ\na\n⊠μ\nb\n:=μ\n√\nba\n√\nb\n.\nabwill","not","self-adjoint.","","But","sinceτis","tracial,","the","distribution","ofabis","equal","to\n√\nba\n√\nb.","Hence\nS\n√\nba\n√\nb\n=S\nab\n=S\na\nS\nb\n.\nNot","that","the","S-transform","can","be","defined","in","a","more","general","situation","[\nRS\n+\n07].\n31"],"doc15":["\n\nWhy","Do","Local","Methods","Solve","Nonconvex","Problems?\nTengyu","Ma\nStanford","University\nMarch","26,","2021\nAbstract\nNon-convex","optimization","is","ubiquitous","in","modern","machine","learning.","","Researchers","devise","non-convex\nobjective","functions","and","optimize","them","using","off-the-shelf","optimizers","such","as","stochastic","gradient","descent\nand","its","variants,","","which","leverage","the","local","geometry","and","update","iteratively.","","","Even","though","solving","non-\nconvex","functions","is","NP-hard","in","the","worst","case,","the","optimization","quality","in","practice","is","often","not","an","issue—\noptimizers","are","largely","believed","to","find","approximate","global","minima.","","Researchers","hypothesize","a","unified\nexplanation","for","this","intriguing","phenomenon:","","most","of","the","local","minima","of","the","practically-used","objectives\nare","approximately","global","minima.","","We","rigorously","formalize","it","for","concrete","instances","of","machine","learning\nproblems.\n1\nContents\n1","","","","Introduction2\n2","","","","Analysis","Technique:","Characterization","of","the","Landscape2\n2.1Convergence","to","a","local","minimum","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".2\n2.2Local","optimality","vs","global","optimality.","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".3\n2.3Landscape","for","manifold-constrained","optimization","","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".4\n3","","","","Generalized","Linear","Models4\n3.1Analysis","of","the","population","risk","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".5\n3.2Concentration","of","the","empirical","risk","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".6\n4","","","","Matrix","Factorization","Problems6\n4.1Principal","Component","Analysis","","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".6\n4.2Matrix","completion","","","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".7\n4.2.1Rank-1","case","of","matrix","completion","","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".8\n5","","","","Landscape","of","Tensor","Decomposition11\n5.1Non-convex","optimization","for","orthogonal","tensor","decomposition","and","global","optimality","","","",".","",".","",".","",".","",".","",".","",".","",".","",".11\n5.2All","local","optima","are","global","","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".","",".12\n6","","","","Survey","and","Outlook:","Optimization","of","Neural","Networks13\n7","","","","Notes15\n1\nThis","is","the","Chapter","21","of","the","book","Beyond","the","Worst-Case","Analysis","of","Algorithms","[Roughgarden,","2020].\n1\narXiv:2103.13462v1","","[cs.LG]","","24","Mar","2021\n\n1","","","","Introduction\nOptimizing","non-convex","functions","has","become","the","standard","algorithmic","technique","in","modern","machine","learning","and\nartificial","intelligence.","","It","is","increasingly","important","to","understand","the","working","of","the","existing","heuristics","for","optimizing\nnon-convex","functions,","so","that","we","can","design","more","efficient","optimizers","with","guarantees.","","The","worst-case","intractability\nresult","says","that","finding","a","global","minimizer","of","a","non-convex","optimization","problem","—","or","even","just","a","degree-4","polynomial\n—","is","NP-hard.","","Therefore,","theoretical","analysis","with","global","guarantees","has","to","depend","on","the","special","properties","of","the\ntarget","functions","that","we","optimize.","To","characterize","the","properties","of","the","real-world","objective","functions,","researchers","have\nhypothesized","that","many","objective","functions","for","machine","learning","problems","have","the","property","that\nall","or","most","local","minima","are","approximately","global","minima.(1.1)\nOptimizers","based","on","local","derivatives","can","solve","this","family","of","functions","in","polynomial","time","(under","some","additional\ntechnical","assumptions","that","will","discussed","below).","Empirical","evidences","also","suggest","practical","objective","functions","from\nmachine","learning","and","deep","learning","may","have","such","a","property.","In","this","chapter,","we","formally","state","the","algorithmic","result\nthat","local","methods","can","solve","objective","with","property","(1.1)","in","Section","2,","and","then","rigorously","prove","that","this","property\nholds","for","a","few","objectives","arising","from","several","key","machine","learning","problems:","generalized","linear","models","(Section","3),\nprincipal","component","analysis","(Section","4.1),","matrix","completion","(Section","4),","and","tensor","decompositions","(Section","5).","We\nwill","also","briefly","touch","on","recent","works","on","neural","networks","(Section","6).\n2","","","","Analysis","Technique:","Characterization","of","the","Landscape\nIn","this","section,","we","will","show","that","a","technical","and","stronger","version","of","the","property","(1.1)","implies","that","many","optimizers\ncan","converge","to","a","global","minimum","of","the","objective","function.\n2.1","","","","Convergence","to","a","local","minimum\nWe","consider","a","objective","functionf,","which","is","assumed","to","be","twice-differentiable","fromR\nd\ntoR.","","Recall","thatxis","a\nlocal","minimumoff(·)if","there","exists","an","open","neighborhoodNofxin","which","the","function","value","is","at","leastf(x):\n∀z∈N,f(z)≥f(x).","","A","pointxis","astationary","pointif","it","satisfies∇f(x)","=","0.","","Asaddle","pointis","a","stationary","point\nthat","is","not","a","local","minimum","or","maximum.","We","use∇f(x)to","denote","the","gradient","of","the","function,","and∇\n2\nf(x)to","denote\nthe","Hessian","of","the","function","(∇\n2\nf(x)is","and×dmatrix","where[∇\n2\nf(x)]\ni,j\n=\n∂\n2\n∂x\ni\n∂x\nj\nf(x)).","A","local","minimumxmust\nsatisfy","the","first","order","necessary","condition","for","optimality,","that","is,∇f(x)","=","0,","and","the","second","order","necessary","condition\nfor","optimality,","that","is,∇\n2\nf(x)\u00170.","","(HereA\u00170denotes","thatAis","a","positive","semi-definite","matrix.)","","Thus,","A","local\nminimum","is","a","stationary","point,","so","is","a","global","minimum.\nHowever,∇f(x)","","=","","0and∇\n2\nf(x)\u00170is","not","a","sufficient","condition","for","being","a","local","minimum.","","For","example,","the\noriginal","is","not","a","local","minimum","of","the","functionf(x\n1\n,x\n2\n)","","=x\n2\n1\n+x\n3\n2\neven","though∇f(0)","","=","","0and∇\n3\nf(0)\u00170.\nGenerally","speaking,","along","those","directionvwhere","the","Hessian","vanishes","(that","is,v\n>\n∇\n2\nf(x)v=","0),","the","higher-order\nderivatives","start","to","matter","to","the","local","optimality.","In","fact,","finding","a","local","minimum","of","a","function","is","NP-hard","[Hillar","and\nLim,","2013].\nFortunately,","with","the","following","strict-saddle","assumption,","we","can","efficiently","find","a","local","minimum","of","the","functionf.\nA","strict-saddle","function","satisfies","that","every","saddle","point","must","have","a","strictly","negative","curvature","in","some","direction.","","It\nassumes","away","the","difficult","situation","in","the","example","above","where","higher-order","derivatives","are","needed","to","decide","if","a\npoint","is","a","local","minimum.\nDefinition","2.1.Forα,β,γ≥0,","we","sayfis(α,β,γ)-strict","saddle","if","everyx∈R\nd\nsatisfies","at","least","one","of","the","following\nthree","conditions:\n1.‖∇f(x)‖\n2\n≥α.\n2.λ\nmin\n(∇\n2\nf)≤−β.\n3.","There","exists","a","local","minimumx\n?\nthat","isγ-close","toxin","Euclidean","distance.\n2\n\nFigure","","1:","","A","","two-dimensional","","function","","with","","the","","property\nthat","all","local","minima","are","global","minima.","It","also","satisfies","the\nstrict-saddle","condition","because","all","the","saddle","points","have","a\ntrictly","negative","curvature","in","some","direction.\nThis","condition","is","conjectured","to","hold","for","many","real-world","functions,","and","will","be","proved","to","hold","for","various","problems\nconcretely.","","However,","in","general,","verifying","it","mathematically","or","empirically","may","be","difficult.","","Under","this","condition,\nmany","algorithms","can","converge","to","a","local","minimum","offin","polynomial","time","as","stated","below.\n2\nTheorem","2.2.Supposefis","a","twice","differentiable(α,β,γ)-strict","saddle","function","fromR\nd\n→R.","","Then,","various","opti-\nmization","algorithms","(such","as","stochastic","gradient","descent)","can","converge","to","a","local","minimum","withεerror","in","Euclidean\ndistance","in","time","poly(d,1/α,1/β,1/γ,1/ε).\n2.2","","","","Local","optimality","vs","global","optimality\nIf","a","functionfsatisfies","the","property","that","“all","local","minima","are","global”","and","the","strict","saddle","property,","we","can","provably\nfind","one","of","its","global","minima.","(See","Figure","1","for","an","example","of","functions","with","this","property.",")\nTheorem","2.3.Supposefsatisfies","“all","local","minima","are","global”","and","the","strict","saddle","property","in","a","sense","that","all\npoints","satisfying","approximately","the","necessary","first","order","and","second","order","optimality","condition","should","be","close","to","a\nglobal","minimum:\nthere","existε\n0\n,τ\n0\n>0and","a","universal","constantc",">0such","that","if","a","pointxsatisfies‖∇f(x)‖\n2\n≤ε≤ε\n0\nand\n∇\n2\nf(x)\u0017−τ\n0\n·I,","thenxisε\nc\n-close","to","a","global","minimum","off.\nThen,","many","optimization","algorithms","(including","stochastic","gradient","descent","and","cubic","regularization)","can","find","a","global\nminimum","offup","toδerror","in`\n2\nnorm","in","domain","in","time","poly(1/δ,1/τ\n0\n,d).\nThe","technical","condition","of","the","theorem","is","often","succinctly","referred","to","as","“all","local","minima","are","global”,","but","its","precise\nform,","which","is","a","combination","of","“all","local","minima","are","global”","and","the","strict","saddle","condition,","is","crucial.","","There","are\nfunctions","that","satisfy","“all","local","minima","are","global”","but","cannot","be","optimized","efficiently.","","","Ignoring","the","strict","saddle\ncondition","may","lead","to","misleadingly","strong","statements.\nThe","condition","of","Theorem","2.3","can","be","replaced","by","stronger","ones","which","may","occasionally","be","easier","to","verify,","if","they","are\nindeed","true","for","the","functions","of","interests.","","One","of","such","conditions","is","that","“any","stationary","point","is","a","global","minimum.\"\nThe","gradient","descent","is","known","to","converge","to","a","global","minimum","linearly,","","as","stated","below.","","","However,","","because","this\ncondition","effectively","rules","out","the","existence","of","multiple","disconnected","local","minima,","it","can’t","hold","for","many","objective\nfunctions","related","to","neural","networks,","which","guarantees","to","have","multiple","local","minima","and","stationary","points","due","to","a\ncertain","symmetry.\nTheorem","2.4.Suppose","a","functionfhasL-Lipschitz","continuous","gradients","and","satisfies","the","Polyak-Lojasiewicz","condi-\ntion:∃μ",">0andx\n∗\nsuch","that","for","everyx,\n‖∇f(x)‖\n2\n2\n≥μ(f(x)−f(x\n∗\n))≥0.(2.1)\nThen,","the","errors","of","the","gradient","descent","with","step","size","less","than1/(2L)decays","geometrically.\n2\nNote","that","in","this","chapter,","we","only","require","polynomial","time","algorithm","to","be","polynomial","in1/εwhenεis","the","error.","","This","makes","sense","for","the\ndownstream","machine","learning","applications","because","very","high","accuracy","solutions","are","not","necessary","due","to","intrinsic","statistical","errors.\n3\n\nIt","can","be","challenging","to","verify","the","Polyak-Lojasiewicz","condition","because","the","quantity‖∇f(x)‖\n2\n2\nis","often","a","complex\nfunction","ofx.","An","easier-to-verify","but","stronger","condition","is","the","quasi-convexity.","Intuitively","speaking,","quasi-convexity\nsays","that","at","any","pointxthe","gradient","should","be","negatively","correlated","with","the","directionx\n∗\n−xpointing","towards","the\noptimum.\nDefinition","2.5(Weak","quasi-convexity).We","say","an","objective","functionfisτ-weakly-quasi-convex","over","a","domainB\nwith","respect","to","the","global","minimumx\n∗\nif","there","is","a","positive","constantτ",">0such","that","for","allx∈B,\n∇f(x)\n>\n(x−x\n∗\n)≥τ(f(x)−f(x\n∗\n)).(2.2)\nThe","following","one","is","another","related","condition,","which","is","sometimes","referred","to","as","the","restricted","secant","inequality","(RSI):\n∇f(x)\n>\n(x−x\n∗\n)≥τ‖x−x\n∗\n‖\n2\n2\n.(2.3)\nWe","note","that","convex","functions","satisfy","(2.2)","withτ=","","1.","","Condition","(2.3)","is","stronger","than","(2.2)","because","for","smooth\nfunction,","we","have‖x−x\n∗\n‖\n2\n2\n≥L(f(x)−f(x\n∗\n))for","some","constantL.\n3\nConditions","(2.1),","(2.2),","and","(2.3)","all","imply\nthat","all","stationary","points","are","global","minimum","because∇f(x)","=","0implies","thatf(x)","=f(x\n∗\n)orx=x\n∗\n.\n2.3","","","","Landscape","for","manifold-constrained","optimization\nWe","can","extend","many","of","the","results","in","the","previous","section","to","the","setting","of","constrained","optimization","over","a","smooth\nmanifold.","This","section","is","only","useful","for","problems","in","Section","5","and","casual","readers","can","feel","free","to","skip","it.\nLetMbe","a","Riemannian","manifold.","","LetT\nx\nMbe","the","tangent","space","toMatx,","and","letP\nx\nbe","the","projection","operator\nto","the","tangent","spaceT\nx\nM.","Let","gradf(x)∈T\nx\nMbe","the","gradient","offatxonMand","Hessf(x)be","the","Riemannian\nHessian.","Note","that","Hessf(x)is","a","linear","mapping","fromT\nx\nMonto","itself.\nTheorem","2.6(Informally","stated).Consider","the","constrained","optimization","problemmin\nx∼M\nf(x).","Under","proper","reg-\nularity","","conditions,","","Theorem","","2.2","","and","","Theorem","","2.3","","still","","hold","","when","","replacing∇fand∇\n2\nfbygradfandHessf,\nrespectively.\nBackgrounds","on","manifold","gradient","and","Hessian.Later","in","Section","5,","the","unit","sphere","ind-dimensional","space","will","be\nour","","constraint","","set,","","that","","is,M=S\nd−1\n.","","","We","","provide","","some","","further","","backgrounds","","on","","how","","to","","compute","","the","","manifold\ngradients","and","Hessian","here.","","We","viewfas","the","restriction","of","a","smooth","function\n","̄\nfto","the","manifoldM.","","In","this","case,\nwe","","haveT\nx\nM={z∈R\nd\n:z\n>\nx=","","0},","","andP\nx\n=I−xx\n>\n.","","","We","","derive","","the","","manifold","","gradient","","offonM:\ngradf(x)","=P\nx\n∇\n","̄\nf(x),where∇is","the","usual","gradient","in","the","ambient","spaceR\nd\n.","Moreover,","we","derive","the","Riemannian\nHessian","as","Hessf(x)","=P\nx\n∇\n2\n","̄\nf(x)P\nx\n−(x\n>\n∇\n","̄\nf(x))P\nx\n.\n3","","","","Generalized","Linear","Models\nWe","consider","the","problem","of","learning","ageneralized","linear","modeland","we","will","show","that","the","loss","function","for","it","will","be\nnon-convex,","but","all","of","its","local","minima","are","global.","","Suppose","we","observendata","points{(x\ni\n,y\ni\n)}\nn\ni=1\n,","wherex\ni\n’s","are\nsampled","i.i.d.","","from","some","distributionD\nx\noverR\nd\n.","","In","the","generalized","linear","model,","we","assume","the","labely\ni\n∈Ris\ngenerated","from\ny\ni\n=σ(w\n>\n?\nx\ni\n)","+ε\ni\n,\nwhereσ:R→Ris","a","known","monotone","activation","function,ε\ni\n∈Rare","i.i.d.","mean-zero","noise","(independent","withx\ni\n),\nandw\n?\n∈R\nd\nis","a","fixed","unknown","ground","truth","coefficient","vector.","We","denote","the","joint","distribution","of(x\ni\n,y\ni\n)byD.\nOur","goal","is","to","recover","approximatelyw\n?\nfrom","the","data.","We","minimize","the","empirical","squared","risk:\n̂\nL(w)","=\n1\n2n\n∑\nn\ni=1\n(y\ni\n−\nσ(w\n>\nx\ni\n))\n2\n.LetL(w)be","the","corresponding","population","risk:L(w)","=\n1\n2\nE\n(x,y)∼D\n[\n(y−σ(w\n>\nx))\n2\n]\n.\nWe","will","analyze","the","optimization","of\n̂\nLvia","characterizing","the","property","of","its","landscape.","Our","road","map","consists","of","two\nparts:","a)","all","the","local","minima","of","the","population","risk","are","global","minima;","b)","the","empirical","risk\n̂\nLhas","the","same","property.\n3\nReaders","who","are","familiar","with","convex","optimization","may","realize","that","condition","(2.3)","is","an","extension","of","the","strong","convexity.\n4\n\nWhenσis","the","identity","function,","","that","is,σ(t)","","=t,","","we","have","the","linear","regression","problem","and","the","loss","function","is\nconvex.","In","practice,","people","have","takenσ,","e.g.,","to","be","the","sigmoid","function","and","then","the","objective\n̂\nLis","no","longer","convex.\nThroughout","the","rest","of","the","section,","we","make","the","following","regularity","assumptions","on","the","problem.","These","assumptions\nare","stronger","than","what’s","necessary,","for","the","ease","of","exposition.","","However,","we","note","that","some","assumptions","on","the","data\nare","necessary","because","in","the","worst-case,","the","problem","is","intractable.","","(E.g.,","the","generative","assumption","(3)","ony\ni\n’s","is","a\nkey","one.)\nAssumption","3.1.We","assume","the","distributionD\nx\nand","activationσsatisfy","that\n1.","","The","vectorsx\ni\nare","bounded","and","non-degenerate:D\nx\nis","supported","in{x:‖x‖\n2\n≤B},","andE\nx∼D\nx\n[xx\n>\n]\u0017λI\nfor","someλ",">0,","whereIis","the","identity.\n2.","","The","ground","truth","coefficient","vector","satisfies‖w\n?\n‖\n2\n≤R,","andBR≥1.\n3.","","The","activation","functionσis","strictly","increasing","and","twice","differentiable.","Furthermore,","it","satisfies","the","bounds\nσ(t)∈[0,1],sup\nt∈R\n{|σ\n′\n(t)|,|σ\n′′\n(t)|}≤1,andinf\nt∈[−BR,BR]\nσ\n′\n(t)≥γ",">0.\n4.","","The","noiseε\ni\n’s","are","mean","zero","and","bounded:","with","probability","1,","we","have|ε\ni\n|≤1.\n3.1","","","","Analysis","of","the","population","risk\nIn","this","section,","we","show","that","all","the","local","minima","of","the","population","riskL(w)are","global","minima.","In","fact,L(w)has","a\nunique","local","minimum","which","is","also","global.","(But","still,L(w)may","likely","be","not","convex","for","many","choices","ofσ.)\nTheorem","3.2.The","objectiveL(·)has","a","unique","local","minimum,","which","is","equal","tow\n?\nand","is","also","a","global","minimum.","In\nparticular,L(·)is","weakly-quasi-convex.\nThe","proof","follows","from","directly","checking","the","definition","of","the","quasi-convexity.","The","intuition","is","that","generalized","linear\nmodels","behave","very","similarly","to","linear","models","from","the","lens","of","quasi-convexity:","many","steps","of","the","inequalities","of","the\nproof","involves","replacingσbe","an","identity","function","effectively","(or","replacingσ\n′\nbe","1.)\nProof","Sketch.Using","the","property","thatE[y|x]","=σ(w\n>\n?\nx),","we","have","the","following","bias-variance","decomposition","(which\ncan","be","derived","by","elementary","manipulation)\nL(w)","=\n1\n2\nE[(y−σ(w\n>\nx))\n2\n]","=\n1\n2\nE[(y−σ(w\n>\n?\nx))\n2\n]","+\n1\n2\nE[(σ(w\n>\n?\nx)−σ(w\n>\nx))\n2\n].(3.1)\nThe","first","term","is","independent","ofw,","and","the","second","term","is","non-negative","and","equals","zero","atw=w\n?\n.","Therefore,","we","see\nthatw\n?\nis","a","global","minimum","ofL(w).\nTowards","proving","thatL(·)is","quasi-convex,","we","first","compute∇L(w):\n∇L(w)","=E[(σ(w\n>\nx)−y)σ\n′\n(w\n>\nx)x]","=E[(σ(w\n>\nx)−σ(w\n>\n?\nx))σ\n′\n(w\n>\nx)x],\nwhere","the","last","equality","used","the","fact","thatE[y|x]","=σ(w\n>\n?\nx).","It","follows","that\n〈∇L(w),w−w\n?\n〉=E[(σ(w\n>\nx)−σ(w\n>\n?\nx))σ\n′\n(w\n>\nx)〈w−w\n?\n,x〉].\nNow,","by","the","mean","value","theorem,","and","bullet","3","of","Assumption","3.1,","we","have","that\n(σ(w\n>\nx)−σ(w\n>\n?\nx))〈w−w\n?\n,x〉≥γ(w\n>\nx−w\n>\n?\nx)\n2\n.\nUsing|σ\n′\n(t)|≥γand|σ\n′\n(t)|≤1for","every|t|≤BR,","and","the","monotonicity","ofσ,\n〈∇L(w),w−w\n?\n〉=E[(σ(w\n>\nx)−σ(w\n>\n?\nx))σ\n′\n(w\n>\nx)〈w−w\n?\n,x〉]\n≥γE(σ(w\n>\nx)−σ(w\n>\n?\nx))(w\n>\nx−w\n>\n?\nx)](3.2)\n≥γE[(σ(w\n>\nx)−σ(w\n>\n?\nx))\n2\n]≥2γ(L(w)−L(w\n?\n))\nwhere","the","last","step","uses","the","decomposition","(3.1)","of","the","riskL(w).\n5\n\n3.2","","","","Concentration","of","the","empirical","risk\nWe","next","analyze","the","empirical","risk\n̂\nL(w).","We","will","show","that","with","sufficiently","many","examples,","the","empirical","risk\n̂\nLis\nclose","enough","to","the","population","riskLso","that\n̂\nLalso","satisfies","that","all","local","minima","are","global.\nTheorem","3.3(The","empirical","risk","has","no","bad","local","minimum).Under","the","problem","assumptions,","with","probability","at\nleast1−δ,","for","allwwith‖w‖\n2\n≤R,","the","empirical","risk","has","no","local","minima","outside","a","small","neighborhood","ofw\n?\n:","for\nanywsuch","that‖w‖\n2\n≤R,","if∇\n̂\nL(w)","=","0,","then\n‖w−w\n?\n‖\n2\n≤\nC\n1\nB\nγ\n2\nλ\n√\nd(C\n2\n+","log(nBR))","+","log\n1\nδ\nn\n.\nwhereC\n1\n,C\n2\n>0are","universal","constants","that","do","not","depend","on(B,R,d,n,δ).\nTheorem","3.3","shows","that","all","stationary","points","of\n̂\nL(w)have","to","be","within","a","small","neighborhood","ofw\n?\n.","Stronger","landscape\nproperty","can","also","be","proved","though:","there","is","a","unique","local","minimum","in","the","neighborhood","ofw\n?\n.\nThe","main","intuition","is","that","to","verify","quasi-convexity","or","restricted","secant","inequality","for\n̂\nL,","it","suffices","to","show","that","with\nhigh","probability","over","the","randomness","of","the","data,∀wwith‖w‖\n2\n≤R\n〈∇L(w),w−w\n?\n〉≈〈∇\n̂\nL(w),w−w\n?\n〉.(3.3)\nVarious","tools","to","prove","such","concentration","inequalities","have","been","developed","in","statistical","learning","theory","and","probability\ntheory","community,","and","a","thorough","exposition","of","them","is","beyond","the","scope","of","this","chapter.\n4","","","","Matrix","Factorization","Problems\nIn","this","section,","we","will","discuss","the","optimization","landscape","of","two","problems","based","on","matrix","factorization:","","principal\ncomponent","analysis","(PCA)","and","matrix","completion.","","The","fundamental","difference","between","them","and","the","generalized\nlinear","models","is","that","their","objective","functions","have","saddle","points","that","arenotlocal","minima","or","global","minima.","It","means\nthat","the","quasi-convexity","condition","or","Polyak-Lojasiewicz","condition","does","not","hold","for","these","objectives.","Thus,","we","need\nmore","sophisticated","techniques","that","can","distinguish","saddle","points","from","local","minima.\n4.1","","","","Principal","Component","Analysis\nOne","interpretation","of","PCA","is","approximating","a","matrix","by","its","best","low-rank","approximation.","Given","a","matrixM∈R\nd\n1\n×d\n2\n,\nwe","aim","to","find","its","best","rank-rapproximation","(in","either","Frobenius","norm","or","spectral","norm).","","For","the","ease","of","exposition,\nwe","taker=","1and","assumeMto","be","symmetric","positive","semi-definite","with","dimensiondbyd.","","In","this","case,","the","best\nrank-1","approximation","has","the","formxx\n>\nwherex∈R\nd\n.\nThere","are","many","well-known","algorithms","for","finding","the","low-rank","factorx.","We","are","particularly","interested","in","the","following\nnon-convex","program","that","directly","minimizes","the","approximation","error","in","Frobenius","norm.\nmin\nx\ng(x)",":=\n1\n2\n·‖M−xx\n>\n‖\n2\nF\n.(4.1)\nWe","will","prove","that","even","thoughgis","not","convex,","all","the","local","minima","ofgare","global.","","It","also","satisfies","the","strict","saddle\nproperty","(which","we","will","not","prove","formally","here).","","Therefore,","local","search","algorithms","can","solve","(4.1)","in","polynomial\ntime.\n4\nTheorem","4.1.In","the","setting","above,","all","the","local","minima","of","the","objective","functiong(x)are","global","minima.\n5\n4\nIn","fact,","local","methods","can","solve","it","very","fast.","See,","e.g.,","Li","et","al.","[2017,","Thereom","1.2]\n5\nThe","functiongalso","satisfies","the(α,β,γ)-strict-saddle","property","(Definition","2.1)","with","someα,β,γ",">0(that","may","depend","onM)","so","that","it\nsatisfies","the","condition","of","Theorem","2.3.","We","skip","the","proof","of","this","result","for","simplicity.\n6\n\nOur","analysis","consists","of","two","main","steps:","a)","to","characterize","all","the","stationary","points","of","the","functiong,","which","turn","out","to\nbe","the","eigenvectors","ofM;","b)","to","examine","each","of","the","stationary","points","and","show","that","the","only","the","top","eigenvector(s)","of\ngcan","be","a","local","minimum.","Step","b)","implies","the","theorem","because","the","top","eigenvectors","are","also","global","minima","ofg.","We\nstart","with","step","a)","with","the","following","lemma.\nLemma","4.2.In","the","setting","of","Theorem","4.1,","all","the","stationary","points","of","the","objectiveg()are","the","eigenvectors","ofM.\nMoreover,","ifxis","a","stationary","point,","then‖x‖\n2\n2\nis","the","eigenvalue","corresponding","tox.\nProof.By","elementary","calculus,","we","have","that\n∇g(x)","=−(M−xx\n>\n)x=‖x‖\n2\n2\n·x−Mx(4.2)\nTherefore,","ifxis","a","stationary","point","ofg,","thenMx=‖x‖\n2\n2\n·x,","which","implies","thatxis","an","eigenvector","ofMwith\neigenvalue","equal","to‖x‖\n2\n2\n.\nNow","we","are","ready","to","prove","b)","and","the","theorem.","","The","key","intuition","is","the","following.","","Suppose","we","are","at","a","pointxthat\nis","an","eigenvector","but","not","the","top","eigenvector,","moving","in","either","the","top","eigenvector","directionv\n1\nor","the","direction","of−v\n1\nwill","result","in","a","second-order","local","improvement","of","the","objective","function.","","Therefore,xcannot","be","a","local","minimum\nunlessxis","a","top","eigenvector.\nProof","of","Theorem","4.1.By","Lemma","4.2,","we","know","that","a","local","minimumxis","an","eigenvector","ofM.","","Ifxis","a","top","eigen-\nvector","ofMwith","the","largest","eigenvalue,","thenxis","a","global","minimum.","","For","the","sake","of","contradiction,","we","assume","that\nxis","an","eigenvector","with","eigenvalueλthat","is","strictly","less","thanλ\n1\n.","","By","Lemma","4.2","we","haveλ=‖x‖\n2\n2\n.","","By","elementary\ncalculation,","we","have","that\n∇\n2\ng(x)","=","2xx\n>\n−M+‖x‖\n2\n2\n·I",".(4.3)\nLetv\n1\nbe","the","top","eigenvector","ofMwith","eigenvalueλ\n1\nand","with`\n2\nnorm","1.","Then,","because∇\n2\ng(x)\u00170,","we","have","that\nv\n>\n1\n∇\n2\ng(x)v≥0(4.4)\nIt’s","a","basic","property","of","eigenvectors","of","positive","semidefinite","matrix","that","any","pairs","of","eigenvectors","with","different","eigen-\nvalues","are","orthogonal","to","each","other.","Thus","we","have〈x,v\n1\n〉=","0.","It","follows","equation","(4.4)","and","(4.3)","that\n0≤v\n>\n1\n(2xx\n>\n−M+‖x‖\n2\n2\n·I)v\n1\n=‖x‖\n2\n2\n−v\n>\n1\nMv\n1\n(by〈x,v\n1\n〉=","0)\n=λ−λ\n1\n(by","thatv\n1\nhas","eigenvalueλ\n1\nand","thatλ=‖x‖\n2\n2\n)\n<0(by","the","assumption)\nwhich","is","a","contradiction.\n4.2","","","","Matrix","completion\nMatrix","completion","is","the","problem","of","recovering","a","low-rank","matrix","from","partially","observed","entries,","which","has","been\nwidely","used","in","collaborative","filtering","and","recommender","systems,","dimension","reduction,","and","multi-class","learning.","","De-\nspite","the","existence","of","elegant","convex","relaxation","solutions,","stochastic","gradient","descent","on","non-convex","objectives","are\nwidely","adopted","in","practice","for","scalability.","","We","will","focus","on","the","rank-1","symmetric","matrix","completion","in","this","chapter,\nwhich","demonstrates","the","essence","of","the","analysis.\n7\n\n4.2.1","","","","Rank-1","case","of","matrix","completion\nLetM=zz\n>\nbe","a","rank-1","symmetric","matrix","with","factorz∈R\nd\nthat","we","aim","to","recover.","","We","assume","that","we","observe\neach","entry","ofMwith","probabilitypindependently.\n6\nLetΩ⊂[d]×[d]be","the","set","of","entries","observed.\nOur","goal","is","to","recover","from","the","observed","entries","ofMthe","vectorzup","to","sign","flip","(which","is","equivalent","to","recovering\nM).\nA","known","issue","with","matrix","completion","is","that","ifMis","“aligned”","with","standard","basis,","then","it’s","impossible","to","recover","it.\nE.g.,","whenM=e\nj\ne\n>\nj\nwheree\nj\nis","thej-th","standard","basis,","we","will","very","likely","observe","only","entries","with","value","zero,\nbecauseMis","sparse.","Such","scenarios","do","not","happen","in","practice","very","often","though.","The","following","standard","assumption\nwill","rule","out","these","difficult","and","pathological","cases:\nAssumption","4.3(Incoherence).W.L.O.G,","we","assume","that‖z‖\n2\n=","1.","In","addition,","we","assume","thatzsatisfies‖z‖\n∞\n≤\nμ\n√\nd\n.We","will","think","ofμas","a","small","constant","or","logarithmic","ind,","and","the","sample","complexity","will","depend","polynomially\non","it.\nIn","this","setting,","the","vectorzcan","be","recovered","exactly","up","to","a","sign","flip","provided\n","̃\nΩ(d)samples.","However,","for","simplicity,\nin","this","subsection","we","only","aim","to","recoverzwith","an`\n2\nnorm","errorε\u001c1.","","We","assume","thatp=poly(μ,logd)/(dε\n2\n)\nwhich","means","that","the","expected","number","of","observations","is","on","the","order","ofd/ε·polylogd.","","We","analyze","the","following\nobjective","that","minimizes","the","total","squared","errors","on","the","observed","entries:\nargmin\nx\nf(x)",":=\n1\n2\n∑\n(i,j)∈Ω\n(M\nij\n−x\ni\nx\nj\n)\n2\n=\n1\n2\n·‖P\nΩ\n(M−xx\n>\n)‖\n2\nF\n.(4.5)\nHereP\nΩ\n(A)denotes","the","matrix","obtained","by","zeroing","out","all","the","entries","ofAthat","are","not","inΩ.","For","simplicity,","we","only\nfocus","on","characterizing","the","landscape","of","the","objective","in","the","following","domainBof","incoherent","vectors","that","contain","the\nground-truth","vectorz(with","a","buffer","of","factor","of","2)\nB=\n{\nx:‖x‖\n∞\n<\n2μ\n√\nd\n}\n.(4.6)\nWe","note","that","the","analyzing","the","landscape","insideBdoes","not","suffice","because","the","iterates","of","the","algorithms","may","leave","the\nsetB.","We","refer","the","readers","to","the","original","paper","[Ge","et","al.,","2016]","for","an","analysis","of","the","landscape","over","the","entire","space,\nor","to","the","recent","work","[Ma","et","al.,","2018]","for","an","analysis","that","shows","that","the","iterates","won’t","leave","the","set","of","incoherent\nvectors","if","the","initialization","is","random","and","incoherent.\nThe","global","minima","off(·)arezand−zwith","function","value","0.","","In","the","rest","of","the","section,","we","prove","that","all","the","local\nminima","off(·)areO(\n√\nε)-close","to±z.\nTheorem","4.4.In","the","setting","above,","all","the","local","minima","off(·)inside","the","setBareO(\n√\nε)-close","to","eitherzor−z.\n7\nIt’s","insightful","to","compare","with","the","full","observation","case","whenΩ","=","[d]×[d].","","The","corresponding","objective","is","exactly\nthe","PCA","objectiveg(x)","=\n1\n2\n·‖M−xx\n>\n‖\n2\nF\ndefined","in","equation","(4.1).","Observe","thatf(x)is","a","sampled","version","of","the\ng(x),","and","therefore","we","expect","that","they","share","the","same","geometric","properties.","","In","particular,","recall","thatg(x)does","not\nhave","spurious","local","minima","and","thus","we","expect","neither","doesf(x).\nHowever,","it‘s","non-trivial","to","extend","the","proof","of","Theorem","4.1","to","the","case","of","partial","observation,","because","it","uses","the\nproperties","of","eigenvectorsheavily.","","Indeed,","suppose","we","imitate","the","proof","of","Theorem","4.1,","we","will","first","compute","the\ngradient","off(·):\n∇f(x)","=P\nΩ\n(zz\n>\n−xx\n>\n)x.(4.7)\n6\nTechnically,","becauseMis","symmetric,","the","entries","at(i,j)and(j,i)are","the","same.","","Thus,","we","assume","that,","with","probabilitypwe","observe","both\nentries","and","otherwise","we","observe","neither.\n7\nIt’s","also","true","that","the","only","local","minima","are","exactly±z,","and","thatfhas","strict","saddle","property.","","However,","their","proofs","are","involved","and","beyond\nthe","scope","of","this","chapter.\n8\n\nThen,","we","run","into","an","immediate","difficulty","—","how","shall","we","solve","the","equation","for","stationary","pointsf(x)","=P\nΩ\n(M−\nxx\n>\n)x=","0.","Moreover,","even","if","we","could","have","a","reasonable","approximation","for","the","stationary","points,","it","would","be","difficult\nto","examine","their","Hessians","without","using","the","exact","orthogonality","of","the","eigenvectors.\nThe","lesson","from","the","trial","above","is","that","we","may","need","to","have","an","alternative","proof","for","the","PCA","objective","(full","observation)\nthat","relies","less","on","solving","the","stationary","points","exactly.","","Then","more","likely","the","proof","can","be","extended","to","the","matrix\ncompletion","(partial","observation)","case.","","In","the","sequel,","we","follow","this","plan","by","first","providing","an","alternative","proof","for\nTheorem","4.1,","which","does","not","require","solving","the","equation∇g(x)","=","0,","and","then","extend","it","via","concentration","inequality\nto","a","proof","of","Theorem","4.4.","The","key","intuition","will","be","is","the","following:\nProofs","that","consist","of","inequalities","that","are","linear","in1\nΩ\nare","often","easily","generalizable","to","partial","observation","case.\nHere","statements","that","are","linear","in1\nΩ\nmean","the","statements","of","the","form\n∑\nij\n1\n(i,j)∈Ω\nT\nij\n≤a.","","We","will","call","these","kinds\nof","proofs","“simple”","proofs","in","this","section.","","Indeed,","by","the","law","of","large","numbers,","when","the","sampling","probabilitypis\nsufficiently","large,","we","have","that\n∑\n(i,j)∈Ω\nT\nij\n︸\n︷︷︸\npartial","observation\n=\n∑\ni,j\n1\n(i,j)∈Ω\nT\nij\n≈p\n∑\ni,j\nT\nij\n︸\n︷︷︸\nfull","observation\n(4.8)\nThen,","the","mathematical","implications","ofp\n∑\nT\nij\n≤aare","expected","to","be","similar","to","the","implications","of\n∑\n(i,j)∈Ω\nT\nij\n≤\na/p,","up","to","some","small","error","introduced","by","the","approximation.\nWhat","natural","quantities","aboutfare","of","the","form\n∑\n(i,j)∈Ω\nT\nij\n?","First,","quantities","of","the","form〈P\nΩ\n(A),B〉can","be","written\nas\n∑\n(i,j)∈Ω\nA\nij\nB\nij\n.","Moreover,","both","the","projection","of∇fand∇\n2\nfare","of","the","form〈P\nΩ\n(A),B〉:\n〈v,∇f(x)〉=〈v,P\nΩ\n(zz\n>\n−xx\n>\n)x〉=〈P\nΩ\n(zz\n>\n−xx\n>\n),vx\n>\n〉\n〈v,∇\n2\nf(x)v〉=〈P\nΩ\n(vx\n>\n+xv\n>\n),vx\n>\n+xv\n>\n〉\n2\nF\n−2〈P\nΩ\n(vv\n>\n−xx\n>\n),vv\n>\n〉\nThe","concentration","of","these","quantities","can","all","be","captured","by","the","following","theorem","below:\nTheorem","4.5.Letε",">0andp=poly(μ,logd)/(dε\n2\n).","Then,","with","high","probability","of","the","randomness","ofΩ,","we","have\nthat","for","allA=uu\n>\n,B=vv\n>\n∈R\nd×d\n,","where‖u‖\n2\n≤1,‖v‖2≤1and‖u‖\n∞\n,‖v‖\n∞\n≤2μ/\n√\nd.\n|〈P\nΩ\n(A),B〉/p−〈A,B〉|≤ε.(4.9)\nWe","will","provide","two","claims","below,","combination","of","which","proves","Theorem","4.1.","","In","the","proofs","of","these","two","claims,\nall","the","inequalities","are","of","the","form","of","LHS","of","equation","(4.8).","","Following","each","claim,","we","will","immediately","provide","its\nextension","to","the","partial","observation","case.\nClaim","1f.Supposex∈Bsatisfies∇g(x)","=","0,","then〈x,z〉\n2\n=‖x‖\n4\n2\n.\nProof.By","elementary","calculation\n∇g(x)","=","(zz\n>\n−xx\n>\n)x=","0\n⇒","〈x,∇g(x)〉=〈x,(zz\n>\n−xx\n>\n)x〉=","0(4.10)\n⇒","〈x,z〉\n2\n=‖x‖\n4\n2\nIntuitively,","a","stationary","pointx’s","norm","is","governed","by","its","correlation","withz.\nThe","following","claim","is","the","counterpart","of","Claim","1f","in","the","partial","observation","case.\nClaim","1p.Supposex∈Bsatisfies∇f(x)","=","0,","then〈x,z〉\n2\n≥‖x‖\n4\n−ε.\n9\n\nProof.Imitating","the","proof","of","Claim","1f,\n∇f(x)","=P\nΩ\n(zz\n>\n−xx\n>\n)x=","0\n⇒","〈x,∇f(x)〉=〈x,P\nΩ\n(zz\n>\n−xx\n>\n)x〉=","0(4.11)\n⇒","〈x,∇g(x)〉=|〈x,(zz\n>\n−xx\n>\n)x〉|≤ε(4.12)\n⇒","〈x,z〉\n2\n≥‖x‖\n4\n2\n−ε\nwhere","derivation","from","line","(4.11)","to","","(4.12)","follows","the","fact","that","line","(4.11)","is","a","sampled","version","of","(4.12).","Technically,\nwe","can","obtain","it","by","applying","Theorem","3.3","twice","withA=B=xx\n>\nandA=xx\n>\nandB=zz\n>\nrespectively.\nClaim","2f.Ifx∈Bhas","positive","Hessian∇\n2\ng(x)\u00170,","then‖x‖\n2\n2\n≥1/3.\nProof.By","the","assumption","onx,","we","have","that〈z,∇\n2\ng(x)z〉≥0.","Calculating","the","quadratic","form","of","the","Hessian","(which\ncan","be","done","by","elementary","calculus","and","is","skipped","for","simplicity),","we","have\n〈z,∇\n2\ng(x)z〉=‖zx\n>\n+xz\n>\n‖\n2\nF\n−2z\n>\n(zz\n>\n−xx\n>\n)z≥0(4.13)\nThis","implies","that\n⇒‖x‖\n2\n2\n+","2〈z,x〉\n2\n≥1\n⇒‖x‖\n2\n2\n≥1/3(since〈z,x〉\n2\n≤‖x‖\n2\n2\n)\nClaim","2p.Ifx∈Bhas","positive","Hessian∇\n2\nf(x)\u00170,","then‖x‖\n2\n2\n≥1/3−ε/3.\nProof.Imitating","the","proof","of","Claim","2f,","calculating","the","quadratic","form","over","the","Hessian","atz,","we","have\n〈z,∇\n2\nf(x)z〉=‖P\nΩ\n(zx\n>\n+xz\n>\n)‖\n2\nF\n−2z\n>\nP\nΩ\n(zz\n>\n−xx\n>\n)z≥0(4.14)\nNote","that","equation","above","is","just","a","sampled","version","of","equation","(4.13),","applying","Theorem","4.5","for","various","times","(and\nnote","that〈P\nOmega\n(A),P\nΩ\n(B)〉=〈P\nΩ\n(A),B〉,","we","can","obtain","that\n‖P\nΩ\n(zx\n>\n+xz\n>\n)‖\n2\nF\n−2z\n>\nP\nΩ\n(zz\n>\n−xx\n>\n)z\n=p·\n(\n‖zx\n>\n+xz\n>\n‖\n2\nF\n−2z\n>\n(zz\n>\n−xx\n>\n)z±ε\n)\nThen","following","the","derivation","in","the","proof","of","Claim","2f,","we","achieve","the","same","conclusion","of","Claim","2f","up","to","approxima-\ntion:‖x‖\n2\n≥1/3−ε/3.\nWith","these","claims,","we","are","ready","to","prove","Theorem","4.1","(again)","and","Theorem","4.4.\nProof","of","Theorem","4.1","(again)","and","Theorem","4.4.By","","Claim","","1f","","and","","2f,","","we","","havexsatisfies〈x,z〉\n2\n≥","‖x‖\n4\n2\n≥1/9.\nMoreover,","we","have","that∇g(x)","=","0implies\n〈z,∇g(x)〉=〈z,(zz\n>\n−xx\n>\n)x〉=","0(4.15)\n⇒","〈x,z〉(1−‖x‖\n2\n2\n)","=","0\n⇒","‖x‖\n2\n2\n=","1(by〈x,z〉\n2\n≥1/9)\nThen","by","Claim","1f","again","we","obtain〈x,z〉\n2\n=","1,","and","thereforex=±z.\n10\n\nThe","proof","of","Theorem","4.4","are","analogous","(and","note","that","such","analogy","was","by","design).","Whenε≤1/12,","we","by","Claim","1p\nand","2p,","we","have","whenε≤1/16,\n〈x,z〉\n2\n≥‖x‖\n4\n2\n−ε≥\n(\n1−ε\n3\n)\n2\n−ε≥\n1\n32\n(4.16)\nBecause|〈z,∇g(x)〉−〈z,∇f(x)〉/p|≤ε,","we","have","that\n|〈z,∇g(x)〉|=|〈z,(zz\n>\n−xx\n>\n)x〉|=O(ε)\n⇒","|〈x,z〉(1−‖x‖\n2\n2\n)|=O(ε)\n⇒","‖x‖\n2\n2\n=","1±O(ε)(by〈x,z〉\n2\n≥1/32)\nThen","","by","","Claim","","1p","","again,","","we","","have〈x,z〉\n2\n≥1−O(ε)which","","implies","","that|〈x,z〉|","≥1−O(ε).","","","Now","","suppose\n〈x,z〉≥1−O(ε),","then","we","have\n‖x−z‖\n2\n2\n=‖x‖\n2\n2\n+‖z‖\n2\n2\n−2〈x,z〉≤1","+O(ε)","+","1−(1−O(ε)≤O(ε)\nThereforexisO(\n√\nε)close","toz.","","On","the","other","hand,","if〈x,z〉","≤","−(1−O(ε)),","we","can","similarly","conclude","thatxis\nO(\n√\nε)-close","to−z.\n5","","","","Landscape","of","Tensor","Decomposition\nIn","this","section,","we","analyze","the","optimization","landscape","for","another","machine","learning","problem,","tensor","decomposition.\nThe","fundamental","difference","of","tensor","decomposition","from","matrix","factorization","problems","or","generalized","linear","models\nis","that","the","non-convex","objective","function","here","has","multiple","isolated","local","minima,","and","therefore","the","set","of","local","minima\ndoes","not","have","rotational","invariance","(whereas","in","matrix","completion","or","PCA,","the","set","of","local","minima","are","rotational\ninvariant.).","This","essentially","prevents","us","to","only","use","linear","algebraic","techniques,","because","they","are","intrinsically","rotational\ninvariant.\n5.1","","","","Non-convex","optimization","for","orthogonal","tensor","decomposition","and","global","optimality\nWe","focus","on","one","of","the","simplest","tensor","decomposition","problems,","orthogonal","4-th","order","tensor","decomposition.","Suppose\nwe","are","given","the","entries","of","a","symmetric","4-th","order","tensorT∈R\nd×d×d×d\nwhich","has","a","low","rank","structure","in","the","sense\nthat:\nT=\nn\n∑\ni=1\na\ni\n⊗a\ni\n⊗a\ni\n⊗a\ni\n(5.1)\nwherea\n1\n,...,a\nn\n∈R\nd\n.","Our","goal","is","to","recover","the","underlying","componentsa\n1\n,...,a\nn\n.","We","assume","in","this","subsection\nthata\n1\n,...,a\nn\nare","orthogonal","vectors","inR\nd\nwith","unit","norm","(and","thus","implicitly","we","assumen≤d.)","","Consider","the\nobjective","function\nargmaxf(x)",":=〈T,x\n⊗4\n〉(5.2)\ns.t.‖x‖\n2\n2\n=","1\nThe","optimal","value","function","for","the","objective","is","the","(symmetric)","injective","norm","of","a","tensorT.","","In","our","case,","the","global\nmaximizers","of","the","objective","above","are","exactly","the","set","of","components","that","we","are","looking","for.\nTheorem","5.1.SupposeTsatisfies","equation(5.1)with","orthonormal","componentsa\n1\n,...,a\nn\n.","","Then,","the","global","maxi-\nmizers","of","the","objective","function(5.2)are","exactly±a\n1\n,...,±a\nn\n.\n11\n\n5.2","","","","All","local","optima","are","global\nWe","next","show","that","all","the","local","maxima","of","the","objective","(5.2)","are","also","global","maxima.","","In","other","words,","we","will","show\nthat±a\n1\n,...,±a\nn\nare","the","only","local","maxima.","We","note","that","all","the","geometry","properties","here","are","defined","with","respect","to\nthe","manifold","of","the","unit","sphereM=S\nd−1\n.","(Please","see","Section","2.3","for","a","brief","introduction","of","the","notions","of","manifold\ngradient,","manifold","local","maxima,","etc.)\nTheorem","5.2.In","the","same","setting","of","Theorem","5.1,","all","the","local","maxima","(w.r.t","the","manifoldS\nd−1\n)","of","the","objective(5.2)\nare","global","maxima.\n8\nTowards","proving","the","Theorem,","we","first","note","that","the","landscape","property","of","a","function","is","invariant","to","the","coordinate\nsystem","that","we","use","to","represent","it.","It’s","natural","for","us","to","use","the","directions","ofa\n1\n,...,a\nn\ntogether","with","an","arbitrary","basis\nin","the","complement","subspace","ofa\n1\n,...,a\nn\nas","the","coordinate","system.","A","more","convenient","viewpoint","is","that","this","choice\nof","coordinate","system","is","equivalent","to","assuminga\n1\n,...,a\nn\nare","the","natural","standard","basise\n1\n,...,e\nn\n.","","Moreover,","one\ncan","verify","that","the","remaining","directionse\nn+1\n,...,e\nd\nare","irrelevant","for","the","objective","because","it’s","not","economical","to","put\nany","mass","in","those","directions.","","Therefore,","for","simplicity","of","the","proof,","we","make","the","assumption","below","without","loss","of\ngenerality:\nn=d,anda\ni\n=e\ni\n,∀i∈[n].(5.3)\nThen","we","have","thatf(x)","","=‖x‖\n4\n4\n.","","We","compute","the","manifold","gradient","and","manifold","Hessian","using","the","formulae","of\ngradf(x)and","Hessf(x)in","Section","2.3,\ngradf(x)","=","4P\nx\n∇\n","̄\nf(x)","=","4(I\nd×d\n−xx\n>\n)\n\n\n\nx\n3\n1\n.\n.\n.\nx\n3\nd\n\n\n\n=","4\n\n\n\nx\n3\n1\n.\n.\n.\nx\n3\nd\n\n\n\n−4‖x‖\n4\n4\n·\n\n\n\nx\n1\n.\n.\n.\nx\nd\n\n\n\n.(5.4)\nHessf(x)","=P\nx\n∇\n2\n","̄\nf(x)P\nx\n−(x\n>\n∇\n","̄\nf(x))P\nx\n=P\nx\n(\n12","diag(x\n2\n1\n,...,x\n2\nd\n)−4‖x‖\n4\n4\n·I\nd×d\n)\nP\nx\n(5.5)\nwherediag(v)for","a","vectorv∈R\nd\ndenotes","the","diagonal","matrix","withv\n1\n,...,v\nd\non","the","diagonal.","","Now","we","are","ready\nto","prove","Theorem","5.2.","","In","the","proof,","we","will","first","compute","all","the","stationary","points","of","the","objective,","and","then","examine\neach","of","them","and","show","that","only±a\n1\n,...,±a\nn\ncan","be","local","maxima.\nProof","of","Theorem","5.2.We","work","under","the","assumptions","and","simplifications","above.","We","first","compute","all","the","stationary\npoints","of","the","objective","(5.2)","by","solving","gradf=","0.","","Using","equation","(5.4),","we","have","that","the","stationary","points","satisfy\nthat\nx\n3\ni\n=‖x‖\n4\n4\n·x\ni\n,∀i(5.6)\nIt","follows","thatx\ni\n=","0orx\ni\n=±‖x‖\n1/2\n4\n.","","Assume","thatsof","thex\ni\n’s","are","non-zero","and","thus","take","the","second","choice,","we\nhave","that\n1","=‖x‖\n2\n2\n=s·‖x‖\n4\n4\n(5.7)\nThis","implies","that‖x‖\n4\n4\n=","1/s,","andx\ni\n=","0or±1/s\n1/2\n.","","In","other","words,","all","the","stationary","points","offare","of","the","form\n(±1/s\n1/2\n,···,±1/s\n1/2\n,0,···,0)(where","there","aresnon-zeros)","for","somes∈[d]and","all","their","permutations","(over\nindices).\nNext,","we","examine","which","of","these","stationary","points","are","local","maxima.","Letτ=","1/s\n1/2\nfor","simplicity.","This","implies","that\n‖x‖\n4\n4\n=τ\n2\n.","Consider","a","stationary","pointx=","(σ\n1\nτ,···,σ\ns\nτ,0,...,0)whereσ\ni\n∈{−1,1}.","Letxbe","a","local","maximum.\n8\nThe","function","also","satisfies","the","strict","saddle","property","so","that","we","can","rigorously","invoke","Theorem","2.6.","","However,","we","skip","the","proof","of","that","for\nsimplicity.\n12\n\nThus","Hessf(X)\u00160.","","We","will","prove","that","this","impliess=","1.","","For","the","sake","of","contradiction,","we","assumes≥2.","","We\nwill","show","that","the","Hessian","cannot","be","negative","semi-definite","by","finding","a","particular","direction","in","which","the","Hessian","has\npositive","quadratic","form.\nThe","form","of","equation(5.5)","implies","that","for","allvsuch","that〈v,x〉=","0(which","indicates","thatP\nx\nv=v),","we","have\nv\n>\n(\n(12","diag(x\n2\n1\n,...,x\n2\nd\n)−4‖x‖\n4\n4\nI\n)\nv≤0(5.8)\nWe","takev=","(1/2,−1/2)to","be","our","test","direction.","Then","LHS","of","the","formula","above","simplifies","to\n3x\n2\n1\n−3x\n2\n2\n−2‖x‖\n4\n4\n=","6τ\n2\n−2‖x‖\n4\n4\n=","4τ\n2\n>0(5.9)\nwhich","contradicts","to","equation","(5.8).","","Therefore,s=","1,","and","we","conclude","that","all","the","local","maxima","are±e\n1\n....,±e\nd\n.\n6","","","","Survey","and","Outlook:","Optimization","of","Neural","Networks\nTheoretical","analysis","of","algorithms","for","learning","neural","networks","is","highly","challenging.","We","still","lack","handy","mathematical\ntools.","We","will","articulate","a","few","technical","challenges","and","summarize","the","attempts","and","progresses.\nWe","follow","the","standard","setup","in","supervised","learning.","Letf\nθ\nbe","a","neural","network","parameterized","by","parametersθ.\n9\nLet\n`be","the","loss","function,","and{(x\n(i)\n,y\n(i)\n)}\nn\ni=1\nbe","a","set","of","i.i.d","examples","drawn","from","distributionD.","The","empirical","risk","is\n̂\nL(θ)","=\n1\nn\n∑\nn\ni=1\n`(f\nθ\n(x\n(i)\n),y\n(i)\n),and","the","population","risk","isL(θ)","=\nE\n(x,y)∼D\n[`(f\nθ\n(x),y)].\nThe","major","challenge","of","analyzing","the","landscape","property","of\n̂\nLorLstems","from","the","non-linearity","of","neural","networks—\nf\nθ\n(x)is","neither","linear","inx,","nor","inθ.","","As","a","consequence,\n̂\nLandLare","not","convex","inθ.","","Linear","algebra","is","at","odds","with\nneural","networks—neural","networks","do","not","have","good","invariance","property","with","respect","to","rotations","of","parameters","or","data\npoints.\nLinearized","neural","networks.Early","works","for","optimization","in","deep","learning","simplify","the","problem","by","considering\nlinearized","neural","networks:f\nθ\nis","assumed","to","be","a","neural","networks","without","any","activations","functions.","","","E.g.,f\nθ\n=\nW\n1\nW\n2\nW\n3\nxwithθ=","(W\n1\n,W\n2\n,W\n3\n)would","be","a","three-layer","feedforward","linearized","neural","network.","","Now,","the","model\nf\nθ\nis","still","not","linear","inθ,","but","it","is","linear","inx.","This","simplification","maintains","the","property","that\n̂\nLorLare","still","nonconvex\nfunctions","inθ,","but","allows","the","use","of","linear","algebraic","tools","to","analyze","the","optimization","landscapes","of\n̂\nLorL.\nBaldi","and","Hornik","[1989],","Kawaguchi","[2016]","show","that","all","the","local","minima","ofL(θ)are","global","minima","when`is\nthe","squared","loss","andf\nθ\nis","a","linearized","feed-forward","neural","network","(butL(θ)does","have","degenerate","saddle","points","so\nthat","it","does","not","satisfy","the","strict","saddle","property).","","","Hardt","et","al.","[2016],","Hardt","and","Ma","[2017]","analyze","the","landscape\nof","learning","linearized","residual","and","recurrent","neural","networks","and","show","that","all","the","stationary","points","(in","a","region)","are\nglobal","minima.","We","refer","the","readers","to","Arora","et","al.","[2018]","and","references","therein","for","some","recent","works","along","this","line.\nThere","are","various","results","on","another","simplification:","two-layer","neural","networks","with","quadratic","activations.","In","this","case,\nthe","modelf\nθ\n(x)is","linear","inx⊗xand","quadratic","in","the","parameters,","and","linear","algebraic","techniques","allow","us","to","obtain\nrelatively","strong","theory.","See","Li","et","al.","[2017],","Soltanolkotabi","et","al.","[2018],","Du","and","Lee","[2018]","and","references","therein.\nWe","remark","that","the","line","of","results","above","typically","applies","to","the","landscape","of","the","population","losses","as","well","as","the\nempirical","losses","when","there","are","sufficient","number","of","examples.\n10\nChanging","the","landscape,","by,","e.g.,","over-parameterization","or","residual","connection.Somewhat","in","contrast","to","the","clean\ncase","covered","in","earlier","sections","of","this","chapter,","people","have","empirically","found","that","the","landscape","properties","of","neural\n9\nE.g.,","a","two","layer","neural","network","would","bef\nθ\n(x)","=W\n1\nσ(W\n2\nx)whereθ=","(W\n1\n,W\n2\n)andσare","some","activation","functions.\n10\nNote","that","the","former","implies","the","latter","when","there","are","sufficient","number","of","data","points","compared","to","the","number","of","parameters,","because","in","this\ncase,","the","empirical","loss","has","a","similar","landscape","to","that","of","the","population","loss","due","to","concentration","properties","[Mei","et","al.,","2017].\n13\n\nnetworks","depend","on","various","factors","including","the","loss","function,","the","model","parameterization,","and","the","data","distribution.\nIn","particular,","changing","the","model","parameterization","and","the","loss","functions","properly","could","ease","the","optimization.\nAn","effective","approach","to","changing","the","landscape","is","to","over-parameterize","the","neural","networks","—","using","a","large","number\nof","parameters","by","enlarging","the","width,","","often","not","necessary","for","expressivity","and","often","bigger","than","the","total","number\nof","","training","","samples.","","","It","","has","","been","","empirically","","found","","that","","wider","","neural","","networks","","may","","alleviate","","the","","problem","","of","","bad\nlocal","minima","that","may","occur","in","training","narrower","nets","[Livni","et","al.,","2014].","","This","motivates","a","lot","of","studies","of","on","the\noptimization","landscape","of","over-parameterized","neural","networks.","","Please","see","Safran","and","Shamir","[2016],","Venturi","et","al.\n[2018],","Soudry","and","Carmon","[2016],","Haeffele","and","Vidal","[2015]","and","the","references","therein.\nWe","note","that","there","is","an","important","distinction","between","two","type","of","overparameterizations:","","(a)","more","parameters","than\nwhat’s","needed","for","sufficient","expressivity","but","still","fewer","parameters","than","the","number","of","training","examples,","and","(b)","more\nparameters","than","the","number","of","training","examples.","","Under","the","latter","setting,","analyzing","the","landscape","of","empirical","loss\nno","longer","suffices","because","even","if","the","optimization","works,","the","generalization","gap","might","be","too","large","or","in","other","words\nthe","model","overfits","(which","is","an","issue","that","is","manifested","clearly","in","the","NTK","discussion","below.)","","In","the","former","setting,\nthough","the","generalization","is","less","of","a","concern,","analyzing","the","landscape","is","more","difficult","because","it","has","to","involve","the\ncomplexity","of","the","ground-truth","function.\nTwo","extremely","empirically","successful","approaches","in","deep","learning,","","residual","neural","networks","[He","et","al.,","2015]","and\nbatch","normalization","[Ioffe","and","Szegedy,","2015]","are","both","conjectured","to","be","able","to","change","the","landscape","of","the","train-\ning","objectives","and","lead","to","easier","optimization.","","This","is","an","interesting","and","promising","direction","with","the","potential","of\ncircumventing","certain","mathematical","difficulties,","but","existing","works","often","suffers","from","the","strong","assumptions","such","as\nlinearized","assumption","in","","Hardt","and","Ma","[2017]","and","the","Gaussian","data","distribution","assumption","in","","Ge","et","al.","[2018].\nConnection","between","over-parametrized","model","and","Kernel","method:","","the","Neural","Tangent","Kernel","(NTK)","view.\nAnother","","recent","","line","","of","","work","","studies","","the","","optimization","","dynamics","","of","","learning","","over-parameterized","","neural","","networks","","at\na","","special","","type","","of","","initialization","","with","","a","","particular","","learning","","rate","","scheme","","[Li","","and","","Liang,","","2018,","","Du","","et","","al.,","","2018,","","Jacot\net","al.,","2018,","Allen-Zhu","et","al.,","2018],","instead","of","characterizing","the","full","landscape","of","the","objective","function.","","The","main\nconclusion","is","of","the","following","form:when","using","overparameterization","(with","more","parameters","than","training","examples),\nunder","a","special","type","of","initialization,","optimizing","with","gradient","descent","can","converge","to","a","zero","training","error","solution.\nThe","results","can","also","be","viewed/interpreted","as","a","combination","of","landscape","results","and","a","convergence","result:","","(i)","the\nlandscape","in","a","small","neighborhood","around","the","initialization","is","sufficiently","close","to","be","convex,","(ii)","in","the","neighborhood\na","zero-error","global","minimum","exists,","and","(iii)","gradient","descent","from","the","initialization","will","not","leave","the","neighborhood\nand","will","converge","to","the","zero-error","solution.","","","Consider","a","non-linear","modelf\nθ\n(·)and","an","initializationθ\n0\n.","","","We","can\napproximate","the","model","by","a","linear","model","by","Taylor","expansion","atθ\n0\n:\nf\nθ\n(x)≈g\nθ\n(x),〈θ−θ\n0\n,∇f\nθ\n0\n(x)〉+f\nθ\n0\n(x)","=〈θ,∇f\nθ\n0\n(x)〉+c(x)(6.1)\nwherec(x)only","depends","onxbut","notθ.","","","Ignoring","the","non-essential","shiftc(x),","","the","modelg\nθ\ncan","be","viewed","as","a\nlinear","function","over","the","feature","vector∇f\nθ\n0\n(x).","Suppose","the","approximation","in","(6.1)","is","accurate","enough","throughout","the\ntraining,","then","we","are","essentially","optimizing","the","linear","modelg\nθ\n(x),","which","leads","to","the","part","(i).For","certain","settings","of\ninitialization,","it","turns","out","that","(ii)","and","(iii)","can","also","be","shown","with","some","proper","definition","of","the","neighborhood.\nLimitation","of","NTK","and","beyond.A","common","limitation","of","analyses","based","on","NTK","is","that","they","analyze","directly","the","em-\npirical","risk","whereas","they","do","not","necessarily","provide","good","enough","generalization","guarantees.","This","is","partially","because\nthe","approach","cannot","handle","regularized","neural","networks","and","the","particular","learning","rate","and","level","of","stochasticity","used\nin","practice.","In","practice,","typically","the","parameterθdoes","not","stay","close","to","the","initialization","either","because","of","a","large","initial\nlearning","rate","or","small","batch","size.","","When","the","number","of","parameters","inθis","bigger","thann,","without","any","regularization,\nwe","cannot","expect","that\n̂\nLuniformly","concentrates","around","the","population","risk.","","This","raises","the","question","of","whether","the\nobtained","solution","simply","memorizes","the","training","data","and","does","not","generalize","to","the","test","data.","A","generalization","bound\ncan","be","obtained","by","the","NTK","approach,","by","bounding","the","norm","of","the","difference","between","the","final","solution","and","the","ini-\ntialization.","However,","such","a","generalization","bound","can","only","be","effectively","as","good","as","what","a","kernel","method","can","provide.\nIn","fact,","Wei","et","al.","[2019]","show","that,","for","a","simple","distribution,","NTK","has","fundamentally","worse","sample","complexity","than\n14\n\na","regularized","objective","for","neural","networks.","","This","result","demonstrates","that","the","NTK","regime","of","neural","nets","is","statisti-\ncally","not","as","powerful","as","regularized","neural","nets,","but","it","does","not","show","that","the","regularized","neural","net","can","be","optimized\nefficiently.","","Many","recent","works","aim","to","separate","training","neural","net","and","its","NTK","regime","in","a","computationally-efficient\nsense,","that","is,","to","present","a","polynomial","time","algorithm","of","training","neural","networks","that","enjoys","a","better","generalization\nguarantee","than","what","the","NTK","result","can","offer.","E.g.,","","Li","et","al.","[2020]","show","that","gradient","descent","can","learn","a","two-layer\nneural","net","with","orthonormal","weights","on","a","Gaussian","data","distribution","from","small","but","random","initialization","with","a","sample\ncomplexity","better","than","the","NTK","approach.","","Allen-Zhu","and","Li","[2019]","present","a","family","of","functions","that","can","be","learn\nefficiently","by","three-layer","neural","networks","but","not","by","NTK.","These","results","are","still","largely","demonstrating","the","possibility\nof","stronger","results","for","neural","networks","than","NTK","on","some","special","cases,","and","it","remains","a","major","open","question","to","have\nmore","general","analysis","for","neural","networks","optimization","beyond","NTK.\nRegularized","neural","networks.Analyzing","the","landscape","or","optimization","of","a","regularized","objective","is","more","challenging\nthan","analyzing","the","un-regularized","ones.","","In","the","latter","case,","we","know","that","achieving","zero","training","loss","implies","that","we\nreach","a","global","minimum,","whereas","in","the","former","case,","we","know","little","about","the","function","value","of","the","global","minima.\nSome","progresses","had","been","made","for","infinite-width","two-layer","neural","networks","[Chizat","and","Bach,","2018,","Mei","et","al.,\n2018,","Wei","et","al.,","2019,","Sirignano","and","Spiliopoulos,","2018,","Rotskoff","and","Vanden-Eijnden,","2018].","","For","example,","Wei\net","al.","[2019]","show","that","polynomial","number","of","iterations","of","perturbed","gradient","descent","can","find","a","global","minimum\nof","an`\n2\nregularized","objective","function","for","infinite-width","two-layer","neural","networks","with","homogeneous","activations.\nHowever,","likely","the","same","general","result","won’t","hold","for","polynomial-width","neural","networks,","if","we","make","no","additional\nassumptions","on","the","data.\nAlgorithmic","or","implicit","regularization.Empirical","findings","suggest,","somewhat","surprisingly,","that","even","unregularized\nneural","networks","with","over-parameterization","can","generalize","[Zhang","et","al.,","2016].","","Moreover,","different","algorithms","ap-\nparently","converge","to","essentially","differently","global","minima","of","the","objective","function,","and","these","global","minima","have\ndifferentgeneralization","performance!","","This","means","that","the","algorithms","have","a","regularization","effect,","and","fundamentally\nthere","is","a","possibility","to","delicately","analyze","the","dynamics","of","the","iterates","of","the","optimization","algorithm","to","reason","about\nexactly","which","global","minimum","it","converges","to.","","Such","types","of","results","are","particular","challenging","because","it","requires\nfine-grained","control","of","the","optimization","dynamics,","and","rigorous","theory","can","often","be","obtained","only","for","relatively","simple\nmodels","such","as","linear","models","[Soudry","et","al.,","2018]","or","matrix","sensing","[Gunasekar","et","al.,","2017],","quadratic","neural","net-\nworks","[Li","et","al.,","2017],","a","quadratically-parameterized","linear","model","[Woodworth","et","al.,","2020,","Vaskevicius","et","al.,","2019,\nHaoChen","et","al.,","2020],","and","special","cases","of","two-layer","neural","nets","with","relu","activations","[Li","et","al.,","2019].\nAssumptions","","on","","data","","distributions.The","","author","","of","","the","","chapter","","and","","many","","others","","suspect","","that","","in","","the","","worst","","case,\nobtaining","the","best","generalization","performance","of","neural","networks","may","be","computationally","intractable.","","Beyond","the\nworst","case","analysis,","people","have","made","stronger","assumptions","on","the","data","distribution","such","as","Gaussian","inputs","[Brutzkus\nand","Globerson,","2017,","Ge","et","al.,","2018],","mixture","of","Gaussians","or","linearly","separable","data","[Brutzkus","et","al.,","2017].","","The\nlimitations","of","making","Gaussian","assumptions","on","the","inputs","are","two-fold:","","a)","it’s","not","a","realistic","assumption;","b)","it","may\nboth","over-estimate","and","under-estimate","the","difficulties","of","learning","real-world","data","in","different","aspects.","It","is","probably","not\nsurprising","that","Gaussian","assumption","can","over-simplify","the","problem,","but","there","could","be","other","non-Gaussian","assumptions\nthat","may","make","the","problem","even","easier","than","Gaussians","(e.g.","","see","the","early","work","in","deep","learning","theory","[Arora","et","al.,\n2014]).\n7","","","","Notes\nHillar","and","Lim","[2013]","show","that","a","degree","four","polynomial","is","NP-hard","to","optimize","and","","Murty","and","Kabadi","[1987]","show\nthat","it’s","also","NP-hard","to","check","whether","a","point","is","not","a","local","minimum.","","Our","quantitative","definition","quasi-convexity\n(Definition","2.5)","is","from","Hardt","et","al.","[2016].","Polyak-Lojasiewicz","condition","was","introduced","by","Polyak","[1963],","and","see","a\nrecent","work","of","","Karimi","et","al.","[2016]","for","a","proof","of","Theorem","2.4",".","The","RSI","condition","was","originally","introduced","in","Zhang\nand","Yin","[2013].\nThe","strict","saddle","condition","was","originally","defined","in","[Ge","et","al.,","2015],","and","we","use","a","variant","of","the","definition","formalized\nin","the","work","of","Lee","et","al.","[2016],","Agarwal","et","al.","[2016].","Formal","versions","of","Theorem","2.3","and","Theorem","2.2","for","various\n15\n\nconcrete","algorithms","can","be","found","in","e.g.,","","Nesterov","and","Polyak","[2006],","Ge","et","al.","[2015],","Agarwal","et","al.","[2017],","Carmon\net","al.","[2016],","Sun","et","al.","[2015]","and","their","follow-up","works.\nTheorem","2.6","is","due","to","Boumal","et","al.","[2016,","Theorem","12].","","We","refer","the","readers","to","the","book","Absil","et","al.","[2007]","for","the\ndefinition","of","gradient","and","Hessian","on","the","manifolds","and","for","the","derivation","of","equation","(2.3)","and","(2.3).\n11\nThe","results","covered","in","Section","3","was","due","to","Kakade","et","al.","[2011],","Hazan","et","al.","[2015].","","The","particular","exposition","was\nfirst","written","by","Yu","Bai","for","the","statistical","learning","theory","course","at","Stanford.\nThe","analysis","of","the","landscape","of","the","PCA","objective","was","derived","in","Baldi","and","Hornik","[1989],","Srebro","and","Jaakkola\n[2013].","The","main","result","covered","in","Section","4.2","is","based","on","the","work","[Ge","et","al.,","2016].","Please","see","Ge","et","al.","[2016]","for\nmore","references","on","the","matrix","completion","problem.\nNonconvex","optimization","has","also","been","used","for","speeding","up","convex","problems,","e.g.,","the","Burer-Monteiro","approach","[Bu-\nrer","and","Monteiro,","2005]","was","theoretically","analyzed","by","the","work","of","Boumal","et","al.","[2016],","Bandeira","et","al.","[2016].\nSection","5","is","based","on","the","work","of","Ge","et","al.","[2015].","","Recently,","there","have","been","work","on","analyzing","more","sophisticated\ncases","of","tensor","decomposition,","e.g.,","using","Kac-Rice","formula","[Ge","and","Ma,","2017]","for","random","over-complete","tensors.\nPlease","see","the","reference","in","Ge","and","Ma","[2017]","for","more","references","regarding","the","tensor","problems.\nReferences\nP.A.","Absil,","R.","Mahony,","and","R.","Sepulchre.Optimization","Algorithms","on","Matrix","Manifolds.","Princeton","University","Press,\n2007.","ISBN","9780691132983.","URLhttps://books.google.com/books?id=gyaKmAEACAAJ.\nNaman","Agarwal,","Zeyuan","Allen-Zhu,","Brian","Bullins,","Elad","Hazan,","and","Tengyu","Ma.","","Finding","approximate","local","minima\nfor","nonconvex","optimization","in","linear","time.arXiv","preprint","arXiv:1611.01146,","2016.\nNaman","Agarwal,","Zeyuan","Allen-Zhu,","Brian","Bullins,","Elad","Hazan,","and","Tengyu","Ma.","","Finding","approximate","local","minima\nfaster","than","gradient","descent,","2017.\nZeyuan","","Allen-Zhu","","and","","Yuanzhi","","Li.","","","","What","","can","","resnet","","learn","","efficiently,","","going","","beyond","","kernels?arXiv","","preprint\narXiv:1905.10337,","2019.\nZeyuan","Allen-Zhu,","Yuanzhi","Li,","and","Zhao","Song.","On","the","convergence","rate","of","training","recurrent","neural","networks.arXiv\npreprint","arXiv:1810.12065,","2018.\nSanjeev","Arora,","Aditya","Bhaskara,","Rong","Ge,","and","Tengyu","Ma.","Provable","bounds","for","learning","some","deep","representations.\nInInternational","Conference","on","Machine","Learning,","pages","584–592,","2014.\nSanjeev","","Arora,","","Nadav","","Cohen,","","and","","Elad","","Hazan.","","","On","","the","","optimization","","of","","deep","","networks:","","Implicit","","acceleration","","by\noverparameterization.arXiv","preprint","arXiv:1802.06509,","2018.\nPierre","Baldi","and","Kurt","Hornik.","","Neural","networks","and","principal","component","analysis:","","Learning","from","examples","without\nlocal","minima.Neural","networks,","2(1):53–58,","1989.\nAfonso","S","Bandeira,","Nicolas","Boumal,","and","Vladislav","Voroninski.","","On","the","low-rank","approach","for","semidefinite","programs\narising","in","synchronization","and","community","detection.","","InConference","on","learning","theory,","pages","361–382.","PMLR,\n2016.\nN.","Boumal,","P.-A.","Absil,","and","C.","Cartis.","","Global","rates","of","convergence","for","nonconvex","optimization","on","manifolds.ArXiv\ne-prints,","May","2016.\nNicolas","Boumal,","Vladislav","Voroninski,","and","Afonso","S","Bandeira.","","The","non-convex","burer-monteiro","approach","works","on\nsmooth","semidefinite","programs.","InNIPS,","2016.\n11\nFor","example,","the","gradient","is","defined","in","Absil","et","al.","[2007,","Section3.6,","Equation","(3.31)],","and","the","Hessian","is","defined","in","Absil","et","al.","[2007,","Section\n5.5,","Definition","5.5.1].","","","Absil","et","al.","[2007,","Example","5.4.1]","gives","the","Riemannian","connection","of","the","sphereS\nd−1\nwhich","can","be","used","to","compute","the\nHessian.\n16\n\nAlon","Brutzkus","and","Amir","Globerson.","","","Globally","optimal","gradient","descent","for","a","convnet","with","gaussian","inputs.arXiv\npreprint","arXiv:1702.07966,","2017.\nAlon","Brutzkus,","Amir","Globerson,","Eran","Malach,","and","Shai","Shalev-Shwartz.","","","Sgd","learns","over-parameterized","networks\nthat","provably","generalize","on","linearly","separable","data.arXiv","preprint","arXiv:1710.10174,","2017.\nSamuel","","Burer","","and","","Renato","","DC","","Monteiro.","","","Local","","minima","","and","","convergence","","in","","low-rank","","semidefinite","","programming.\nMathematical","Programming,","103(3):427–444,","2005.\nYair","Carmon,","John","C","Duchi,","Oliver","Hinder,","and","Aaron","Sidford.","","Accelerated","methods","for","non-convex","optimization.\narXiv","preprint","arXiv:1611.00756,","2016.\nLenaic","Chizat","and","Francis","Bach.","","On","the","global","convergence","of","gradient","descent","for","over-parameterized","models","using\noptimal","transport.arXiv","preprint","arXiv:1805.09545,","2018.\nSimon","S","Du","and","Jason","D","Lee.","","On","the","power","of","over-parametrization","in","neural","networks","with","quadratic","activation.\narXiv","preprint","arXiv:1803.01206,","2018.\nSimon","S","Du,","Xiyu","Zhai,","Barnabas","Poczos,","and","Aarti","Singh.","","Gradient","descent","provably","optimizes","over-parameterized\nneural","networks.arXiv","preprint","arXiv:1810.02054,","2018.\nRong","Ge","and","Tengyu","Ma.","On","the","optimization","landscape","of","tensor","decompositions.","InAdvances","in","Neural","Information\nProcessing","Systems,","pages","3653–3663,","2017.\nRong","Ge,","Furong","Huang,","Chi","Jin,","and","Yang","Yuan.","Escaping","from","saddle","points—online","stochastic","gradient","for","tensor\ndecomposition.arXiv:1503.02101,","2015.\nRong","Ge,","Jason","D","Lee,","and","Tengyu","Ma.","","Matrix","completion","has","no","spurious","local","minimum.","","InAdvances","in","Neural\nInformation","Processing","Systems,","pages","2973–2981,","2016.\nRong","","Ge,","","Jason","","D","","Lee,","","and","","Tengyu","","Ma.","","","Learning","","one-hidden-layer","","neural","","networks","","with","","landscape","","design.","","","In\nInternational","Conference","on","Learning","Representations,","2018.\nSuriya","Gunasekar,","Blake","E","Woodworth,","Srinadh","Bhojanapalli,","Behnam","Neyshabur,","and","Nati","Srebro.","Implicit","regular-\nization","in","matrix","factorization.","InAdvances","in","Neural","Information","Processing","Systems,","pages","6151–6159,","2017.\nBenjamin","D","Haeffele","and","René","Vidal.","","Global","optimality","in","tensor","factorization,","deep","learning,","and","beyond.arXiv\npreprint","arXiv:1506.07540,","2015.\nJeff","Z","HaoChen,","Colin","Wei,","Jason","D","Lee,","and","Tengyu","Ma.","Shape","matters:","Understanding","the","implicit","bias","of","the","noise\ncovariance.arXiv","preprint","arXiv:2006.08680,","2020.\nMoritz","Hardt","and","Tengyu","Ma.","","Identity","matters","in","deep","learning.","","In5th","International","Conference","on","Learning","Repre-\nsentations","(ICLR","2017),","2017.\nMoritz","","Hardt,","","Tengyu","","Ma,","","and","","Benjamin","","Recht.Gradient","","descent","","learns","","linear","","dynamical","","systems.CoRR,\nabs/1609.05191,","2016.","URLhttp://arxiv.org/abs/1609.05191.\nElad","Hazan,","Kfir","Levy,","and","Shai","Shalev-Shwartz.","","Beyond","convexity:","","Stochastic","quasi-convex","optimization.","","InAd-\nvances","in","Neural","Information","Processing","Systems,","pages","1594–1602,","2015.\nKaiming","He,","Xiangyu","Zhang,","Shaoqing","Ren,","and","Jian","Sun.","","Deep","residual","learning","for","image","recognition.","","InarXiv\nprepring","arXiv:1506.01497,","2015.\nChristopher","J.","Hillar","and","Lek-Heng","Lim.","","Most","tensor","problems","are","np-hard.J.","ACM,","60(6):45,","2013.","","doi:","10.1145/\n2512329.","URLhttp://doi.acm.org/10.1145/2512329.\nSergey","Ioffe","and","Christian","Szegedy.","","Batch","normalization:","","Accelerating","deep","network","training","by","reducing","internal\ncovariate","shift.arXiv","preprint","arXiv:1502.03167,","2015.\n17\n\nArthur","Jacot,","Franck","Gabriel,","and","Clément","Hongler.","Neural","tangent","kernel:","Convergence","and","generalization","in","neural\nnetworks.arXiv","preprint","arXiv:1806.07572,","2018.\nSham","M","Kakade,","Varun","Kanade,","Ohad","Shamir,","and","Adam","Kalai.","","Efficient","learning","of","generalized","linear","and","single\nindex","models","with","isotonic","regression.","","","InAdvances","in","Neural","Information","Processing","Systems,","pages","927–935,\n2011.\nHamed","Karimi,","Julie","Nutini,","and","Mark","Schmidt.","Linear","convergence","of","gradient","and","proximal-gradient","methods","under\nthe","polyak-łojasiewicz","condition.","","InJoint","European","Conference","on","Machine","Learning","and","Knowledge","Discovery\nin","Databases,","pages","795–811.","Springer,","2016.\nKenji","Kawaguchi.","Deep","learning","without","poor","local","minima.arXiv","preprint","arXiv:1605.07110,","2016.\nJason","D","Lee,","Max","Simchowitz,","Michael","I","Jordan,","and","Benjamin","Recht.","","Gradient","descent","converges","to","minimizers.\nUniversity","of","California,","Berkeley,","1050:16,","2016.\nYuanzhi","Li","and","Yingyu","Liang.","","Learning","overparameterized","neural","networks","via","stochastic","gradient","descent","on","struc-\ntured","data.","InAdvances","in","Neural","Information","Processing","Systems,","pages","8157–8166,","2018.\nYuanzhi","Li,","Tengyu","Ma,","and","Hongyang","Zhang.","","Algorithmic","regularization","in","over-parameterized","matrix","sensing","and\nneural","networks","with","quadratic","activations.arXiv","preprint","arXiv:1712.09203,","2017.\nYuanzhi","Li,","Colin","Wei,","and","Tengyu","Ma.","","Towards","explaining","the","regularization","effect","of","initial","large","learning","rate","in\ntraining","neural","networks.","InAdvances","in","Neural","Information","Processing","Systems,","pages","11674–11685,","2019.\nYuanzhi","Li,","Tengyu","Ma,","and","Hongyang","R","Zhang.","Learning","over-parametrized","two-layer","relu","neural","networks","beyond\nntk.arXiv","preprint","arXiv:2007.04596,","2020.\nRoi","Livni,","Shai","Shalev-Shwartz,","and","Ohad","Shamir.","","On","the","computational","efficiency","of","training","neural","networks.","","In\nAdvances","in","Neural","Information","Processing","Systems,","pages","855–863,","2014.\nCong","Ma,","Kaizheng","Wang,","Yuejie","Chi,","and","Yuxin","Chen.","","Implicit","regularization","in","nonconvex","statistical","estimation:\nGradient","descent","converges","linearly","for","phase","retrieval","and","matrix","completion.","","","InInternational","Conference","on\nMachine","Learning,","pages","3345–3354.","PMLR,","2018.\nSong","Mei,","Yu","Bai,","and","Andrea","Montanari.","The","landscape","of","empirical","risk","for","non-convex","losses,","2017.\nSong","Mei,","","Andrea","Montanari,","","and","Phan-Minh","Nguyen.","","","A","mean","field","view","of","the","landscape","of","two-layers","neural\nnetworks.Proceedings","of","the","National","Academy","of","Sciences,","pages","E7665–E7671,","2018.\nKatta","G","Murty","and","Santosh","N","Kabadi.","Some","np-complete","problems","in","quadratic","and","nonlinear","programming.Mathe-\nmatical","programming,","39(2):117–129,","1987.\nYurii","Nesterov","and","Boris","T","Polyak.","Cubic","regularization","of","newton","method","and","its","global","performance.Mathematical\nProgramming,","108(1):177–205,","2006.\nBoris","Teodorovich","Polyak.","Gradient","methods","for","minimizing","functionals.Zhurnal","Vychislitel’noi","Matematiki","i","Matem-\naticheskoi","Fiziki,","3(4):643–653,","1963.\nGrant","M","Rotskoff","and","Eric","Vanden-Eijnden.","","Neural","networks","as","interacting","particle","systems:","","Asymptotic","convexity\nof","the","loss","landscape","and","universal","scaling","of","the","approximation","error.arXiv","preprint","arXiv:1805.00915,","2018.\nTim","Roughgarden.Beyond","the","Worst-Case","Analysis","of","Algorithms.","Cambridge","University","Press,","2020.\nItay","Safran","and","Ohad","Shamir.","","On","the","quality","of","the","initial","basin","in","overspecified","neural","networks.","","InInternational\nConference","on","Machine","Learning,","pages","774–782,","2016.\nJustin","","Sirignano","","and","","Konstantinos","","Spiliopoulos.Mean","","field","","analysis","","of","","neural","","networks.arXiv","","preprint\narXiv:1805.01053,","2018.\n18\n\nMahdi","Soltanolkotabi,","","Adel","Javanmard,","","and","Jason","D","Lee.","","","Theoretical","insights","into","the","optimization","landscape","of\nover-parameterized","shallow","neural","networks.IEEE","Transactions","on","Information","Theory,","65(2):742–769,","2018.\nDaniel","Soudry","and","Yair","Carmon.","","","No","bad","local","minima:","","Data","independent","training","error","guarantees","for","multilayer\nneural","networks.arXiv","preprint","arXiv:1605.08361,","2016.\nDaniel","Soudry,","Elad","Hoffer,","Mor","Shpigel","Nacson,","Suriya","Gunasekar,","and","Nathan","Srebro.","The","implicit","bias","of","gradient\ndescent","on","separable","data.The","Journal","of","Machine","Learning","Research,","19(1):2822–2878,","2018.\nNathan","Srebro","and","Tommi","Jaakkola.","Weighted","low-rank","approximations.","InICML,","2013.\nJu","Sun,","Qing","Qu,","and","John","Wright.","","","When","are","nonconvex","problems","not","scary?arXiv","preprint","arXiv:1510.06096,\n2015.\nTomas","Vaskevicius,","Varun","Kanade,","and","Patrick","Rebeschini.","","Implicit","regularization","for","optimal","sparse","recovery.","","In\nAdvances","in","Neural","Information","Processing","Systems,","pages","2968–2979,","2019.\nLuca","Venturi,","Afonso","Bandeira,","and","Joan","Bruna.","","Neural","networks","with","finite","intrinsic","dimension","have","no","spurious\nvalleys.arXiv","preprint","arXiv:1802.06384,","2018.\nColin","Wei,","","Jason","D","Lee,","","Qiang","Liu,","and","Tengyu","Ma.","","","Regularization","matters:","","Generalization","and","optimization","of\nneural","nets","vs","their","induced","kernel.","","","InAdvances","in","Neural","Information","Processing","Systems,","","pages","9709–9721,\n2019.\nBlake","Woodworth,","Suriya","Gunasekar,","Jason","D.","Lee,","Edward","Moroshko,","Pedro","Savarese,","Itay","Golan,","Daniel","Soudry,\nand","Nathan","Srebro.","Kernel","and","rich","regimes","in","overparametrized","models,","2020.\nChiyuan","","Zhang,","","Samy","","Bengio,","","Moritz","","Hardt,","","Benjamin","","Recht,","","and","","Oriol","","Vinyals.","","","Understanding","","deep","","learning\nrequires","rethinking","generalization.arXiv","preprint","arXiv:1611.03530,","2016.\nHui","Zhang","and","Wotao","Yin.","","Gradient","methods","for","convex","minimization:","","better","rates","under","weaker","conditions.arXiv\npreprint","arXiv:1303.4645,","2013.\n19"],"doc2":["\n\narXiv:2103.13787v1","","[stat.ML]","","25","Mar","2021\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL\nDATA\nDANIEL","POTTS\n∗\nANDMICHAEL","SCHMISCHKE\n†\nAbstract.In","this","paper","we","apply","the","previously","introduced","approximation","method","based","on\nthe","ANOVA","(analysis","of","variance)","decomposition","and","GroupedTransformations","to","synthetic","and\nreal","data.","The","advantage","of","this","method","is","the","interpretability","of","the","approximation,","i.e.,","the","ability\nto","rank","the","importance","of","the","attribute","interactions","or","the","variable","couplings.","Moreover,","we","are","able\nto","generate","an","attribute","ranking","to","identify","unimportant","variables","and","reduce","the","dimensionality","of\nthe","problem.","We","compare","the","method","to","other","approaches","on","publicly","available","benchmark","datasets.\nKey","words.ANOVA,","high-dimensional,","approximation,","intrepretability,","fast","Fourier","methods\nAMS","subject","classifications.65T,","42B05,","62-07,","65D15\n1.","Introduction.Building","models","for","creating","predictions","based","on","empirical\ndata","is","a","current","and","active","research","topic","with","numerous","applications.","The","amount\nof","data","being","collected","is","ever-increasing","resulting","in","high-dimensional","datasets","with\ncorresponding","regression","or","classification","problems.","There","is","a","number","of","classical\nmachine","learning","methods","like","support","vector","machines,","neural","networks,","and","decision\ntrees,","see","e.g.","[\n19,1,6],","to","deal","with","these","problems.","However,","we","simultaneously","have\nthe","ever","more","important","issue","of","interpretability","of","the","models","and","therefore","finding\nhow","the","predictions","come","to","pass.","With","this","information","one","can","e.g.","decide","to","not\nmeasure","a","certain","value","if","it","has","little","influence,","in","the","case","the","measuring","would","be\nexpensive,","or","use","it","to","tune","certain","variables","in","order","to","achieve","a","desired","outcome.\nWhile","there","is","new","research","in","the","area","of","interpretability","of","the","classical","methods,","see\ne.g.","[\n38,29],","those","models","do","not","intrinsically","allow","for","it.","The","method","we","apply","in","this\npaper","does","not","only","provide","an","alternative","to","classical","machine","learning","methods,","but\nalso","comes","with","a","natural","way","to","identify","the","importance","and","influence","of","attributes\non","the","outcome.\nIn","this","paper","we","apply","the","approximation","method","presented","in","[\n33,34]","and\npropose","ways","in","which","to","use","them","to","analyze","data","and","create","predictions.","","The\nmethod","is","based","on","the","idea","of","the","analysis","of","variance","(ANOVA)","decomposition,\ncf.","[\n7,35,27,25,20,17],","which","allows","us","to","approximate","high-dimensional","functions\nof","a","grouped","structure","when","paired","with","the","Grouped","Transformations","idea","in","[\n2].","The\nANOVA","decomposition","uniquely","decomposes","a","function","into","terms","that","correspond","to\nvariable","couplings","or","variable","interactions.","The","basis","is","the","LebesgueHilbert","space","L\n2\nfor","periodic","functions","or","non-periodic","functions","defined","over","[0,1]","since","here","we","have\na","complete","orthonormal","systems","of","functions","and","fast","algorithmsfor","multiplication\nin","the","Grouped","Transformations,","see","[\n32,2].\nTherefore,","the","only","a-priori","assumptions","that","we","need","are","that","the","function","we\nwish","to","approximate","is","either","periodic","or","defined","over","a","finite","intervalwhere","it","square-\nintegrable","as","well","as","that","the","function","can","be","well","explained","by","limiting","the","variable\ninteractions.","This","means","that","the","significant","part","of","the","function","isexplained","by","let-\nting","only","up","to","a","number","of","variables","interact","simultaneously,","see","e.g.[\n7,25,11,18],\nrelating","to","the","concept","of","the","superposition","dimension,","see","[\n7,30].","These","assumptions\n∗\nChemnitz","","University","","of","","Technology,","","Germany","","(\npotts@math.tu-chemnitz.de,http://www.\ntu-chemnitz.de/\n∼\npotts/\n).\n†\nChemnitz","","University","","of","","Technology,","","Germany","","(\nmichael.schmischke@math.tu-chemnitz.de,\nhttp://www.tu-chemnitz.de/\n∼\nmischmi/\n).\n1\n\n2D.","POTTS,","AND","M.","SCHMISCHKE\nare","in","general","not","very","restricting","and","allows","for","a","broad","range","of","functions.","More-\nover,","it","has","been","theorized","that","most","real","word","applications","consist","only","of","low-order\ninteractions","relating","to","sparsity-of-effects,","cf.","[\n43],","or","the","Pareto","principle.\nSince","the","method","gives","us","importance","information","on","the","variable","couplings","by\nusing","global","sensitivity","indices,","cf.","[40,41,27],","and","sensitivity","analysis,","see","[37],","we\ncan","not","only","interpret","this","information,","but","moreover","use","it","to","improve","the","model","by","a\nnumber","of","techniques.","Using","attribute","rankings","we","can","remove","an","unimportant","vari-\nable","entirely","and","reduce","the","dimensionality","of","the","problem.","It","is","also","possible","to","find\nthat","the","representation","of","the","data","in","the","groups","is","sparse,","i.e.,","some","specific","variable\ninteractions","does","not","influence","the","approximation","(significantly)","and","can","therefore","be\ndiscarded.","","These","techniques","allow","us","to","build","anactive","","setof","couplings","that","will\nin","the","end","represent","the","model","we","use","for","predictions.","This","simultaneously","gives","us\na","control","mechanism","for","the","complexity","of","the","model","and","combat","overfitting.","This\ntechnique","is","also","related","to","low-dimensional","structures","and","active","subspace","methods\n[\n13,9,10]","as","well","as","random","features","[36,8,44,26,18].","The","main","difference","to","random\nfeatures","is","that","it","draws","weights","or","in","our","language","indices/frequencies","at","random","and\nuses","a","different","optimization","problem.\nWe","apply","the","proposed","approach","to","the","Friedman","functions,","see","[\n28,4,5],","as","an\nexample","of","how","it","performs","on","synthetic","data","with","Gaussian","noise","andcompare","our\nfindings","to","previously","obtained","benchmark","results","in","the","same","setting.","Moreover,","we\ntest","the","method","on","real","datasets","for","regression","problems","from","the","UCI","database","[\n12]\nand","other","sources.","Each","datasets","provides","a","different","challenge","and","we","compare","our\nresults","to","previously","obtained","classical","machine","learning","techniques.","We","observe","very\npromising","results","and","in","many","cases","outperform","previous","benchmark","experiments.\nThe","paper","is","organizes","as","follows.","In\nSection","2we","reiterate","on","the","previously\nin","[33,34,2]","introduced","approximation","method","and","how","to","use","it","for","regression\nproblems.","Here,","we","discuss","the","required","functional","analytic","foundations","and","introduce\nrelevant","complete","orthonormal","systems","of","functions.","The","procedure","is","explained","in\nSubsection","2.1and","we","also","propose","multiple","techniques","for","model","refinement","and\nactive","set","detection","in\nSubsection","2.2that","includes","the","computation","of","an","attribute\nranking.Section","3contains","numerical","experiments","with","synthetic","data","namely","the\nFriedman","functions.","","We","recreate","the","setting","from","benchmark","results","and","test","our\nmethod","under","the","same","conditions.","Moreover,","in\nSection","4we","test","the","method","on\ndatasets","from","[12,42]","and","compare","results","to","previous","experiments.","All","numerical\nexperiments","are","performed","with","the","Julia","package","[\n3]","and","the","code","is","available","as","a\nrepository","[39].\n2.","Interpretable","ANOVA","Approximation.In","this","section","we","summarize\non","the","interpretable","ANOVA","(Analysis","of","Variance)","approximation","method","and","the\nassociated","idea","of","grouped","transformations,","see","[\n33,2].","The","approach","was","considered\nfor","periodic","functions,","but","has","since","been","expended","to","non-periodic","functions","in","[34].\nTherefore,","we","are","able","to","utilize","both","types","of","approximations","whichbrings","advantages\nespecially","for","real","data.\nWe","consider","functions\nf∈L\n2\n(D\nd\n)\n:\n=\n(\nf:","D\nd\n→K:kfk\nL\n2\n(D\nd\n)\n:\n=\ns\nZ\nD\nd\n|f(x)|\n2\ndx<∞\n)\nwith","spatial","dimensiond∈Nwhere","D","is","the","torusTfor","1-periodic","functions","and\nD=","[0,1]","if","we","are","non-periodic.","We","identify","the","torus","with","an","interval","of","unit","length\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA3\nspecificallyT\n∼\n=\n[−0.5,0.5).","The","function","maps","to","the","real","numbers,","i.e.,K=R,","in\nthe","non-periodic","case","whileK=Cis","possible","for","the","periodic","case.","Furthermore,","we\nhave","the","scalar","product\nhf,","gi\n:\n=\nZ\nD\nd\nf(x)g(x)","dx.\nNow,","let{φ\nk\n}\nk∈Z\ndbe","a","complete","orthonormal","system","in","the","space","L\n2\n(D\nd\n)","with\ntensor","product","structure,","i.e.,","we","have","a","complete","orthonormal","system{η\nk\n}\nk∈Z\nin\nL\n2\n(D)","andφ\nk\n(x)","=\nQ\nd\ni=1\nη\nk\ni\n(x\ni\n).","Then\n(2.1)f(x)","=\nX\nk∈Z\nd\nc\nk\n(f)φ\nk\n(x),c\nk\n(f)","=hf,","φ\nk\ni,\nand","through","Parseval’s","identitykfk\n2\nL\n2\n(D\nd\n)\n=\nP\nk∈Z\nd\n|c\nk\n(f)|\n2\n.\nThe","classical","ANOVA","decomposition,","cf.","[\n7,35,27,20],","provides","us","with","a","unique\ndecomposition","in","the","frequency","domain","as","shown","in","[33].","We","denote","the","coordinate\nindices","withD={1,2,",".",".",".",",","d}and","subsets","as","bold","small","letters,","e.g.,u⊆","D.","","An\nANOVA","term","is","defined","as\nf\nu\n(x)","=f\nu\n(x\nu\n)\n:\n=\nX\nk∈Z\nd\nsuppk=u\nc\nk\n(f)φ\nk\n(x)\nwith","suppk\n:\n={s∈D:k\ns\n6=","0}The","function","can","then","be","uniquely","decomposed","as\nf(x)","=\nX\nu⊆D\nf\nu\n(x)\ninto|P(D)|=","2\nd\nANOVA","terms","whereP(D)","is","the","potency","set","ofD.","Here,","the","expo-\nnentially","growing","number","of","terms","shows","an","expression","of","the","curseof","dimensionality\nin","the","decompositon.\nCrucial","information","to","later","achieve","attribute","rankings","is","the","relative","importance\nof","an","ANOVA","termsf\nu\nwith","respect","to","the","function.","In","order","to","measure","this","we\ndefine","the","variance","of","a","functionfas\nσ\n2\n(f)\n:\n=kfk\n2\nL\n2\n(D\nd\n)\n−|c\n0\n(f)|\n2\n=\nX\nk∈Z\nd\n\\{0}\n|c\nk\n(f)|\n2\n.\nNote","thatσ\n2\n(f\nu\n)","=kf\nu\nk\n2\nL\n2\n(D\nd\n)\n,u⊆","D.","The","relative","importance","is","now","measured\ntrough","global","sensitivity","indices","(GSI),","see","[\n40,41,27],","defined","as\n(2.2)̺(u,","f)\n:\n=\nσ\n2\n(f\nu\n)\nσ\n2\n(f)\n.\nThis","motivates","the","concept","of","effective","dimensions.","We","focus","specifically","on","the","mod-\nified","version","of","the","superposition","dimension","as","one","notion","of","effectivedimension.","For\na","givenα∈[0,1]","it","is","defined","as\n(2.3)d\n(sp)\n:\n=","min\n\n\n\ns∈D:","","","","sup\nkfk\nH(D\nd\n)\n≤1\nX\n|u|>s\nkf\nu\nk\n2\nL\n2\n(D\nd\n)\n≤1−α\n\n\n\n\n4D.","POTTS,","AND","M.","SCHMISCHKE\nfor","a","functionf∈H(D\nd\n)⊆L\n2\n(D\nd\n).","Here,H(D\nd\n)","is","L\n2\n(D\nd\n)","or","might","be","a","Hilbert\nspace","that","e.g.","characterizes","smoothness","trough","the","decay","of","the","basis","coefficients\nc\nk\n(f),","cf.","[\n33,30].\nNow,","we","still","have","the","curse","of","dimensionality","and","need","to","find","a","way","around","it\nfor","efficient","approximation.","For","this","we","take","subsets","of","ANOVA","termsU⊆P(D)","into\naccount.","These","sets","have","to","be","downward","closed,","i.e.,","for","everyu∈Uit","holds","that\nall","subsetsv⊆uare","also","elements","ofU.","We","are","then","able","to","consider","the","truncated\nANOVA","decomposition\nT\nU\nf(x)","=\nX\nu∈U\nf\nu\n(x).\nA","specific","idea","for","the","truncation","comes","from","the","superposition","dimension","d\n(sp)\nin\n(\n2.3).","One","might","only","take","variable","interactions","into","account","that","containd\ns\nor","less\nvariables,","i.e.,","the","subset","of","ANOVA","terms","is\nU\nd\ns\n={u⊆D:|u|≤d\ns\n}.\nSinced\ns\ncan","be","any","integer","inDwe","call","it","superposition","threshold.","Note","thatd\ns\ncan\nbe","equal","to","the","superposition","dimension,","but","this","does","not","need","to","be","the","case.","A\nwell-known","fact","from","learning","theory","is","that","the","number","of","terms","inU\nd\ns\ngrows","only\npolynomially","indfor","fixedd\ns\n<","dwhich","has","reduced","the","curse","of","dimensionality.\nWhy","is","the","truncation","through","a","superposition","thresholdd\ns\na","good\nidea?Let","us","start","this","argument","with","the","approximations","of","smooth","functions","that\nbelong","to","some","smoothness","spaceH(D\nd\n)⊆L\n2\n(D\nd\n).","If","the","function","has","a","low","super-\nposition","dimension","d\n(sp)\nforα∈[0,1]","the","truncation","by","a","low","superposition","threshold\nwill","be","effective","(in","relation","toα).","It","is","possible","to","characterize","smoothness","by","the\ndecay","of","the","basis","coefficients","c\nk\n(f)","and","show","upper","bounds","for","the","superposition","di-\nmension","d\n(sp)\nas","in","[\n33].","In","fact","there","are","types","of","smoothness","that","are","proven","to","yield\na","low","upper","bound","for","the","superposition","dimension","specifically","dominating-mixed\nsmoothness","with","POD","(product","and","order-dependent)","weights,","cf.","[24,15,23,16,33].\nIn","terms","of","real","data,","the","situation","is","much","different.","One","thing","in","advance:","For\nthe","complete","generality","of","problems","one","cannot","make","the","assumption","that","we","have\na","low","superposition","dimension.","However,","there","are","many","application","scenarios","where\nnumerical","experiments","successfully","showed","that","this","is","indeed","the","case,","see","e.g.","[\n7].\nSince","we","generally","do","not","have","a-priori","information","we","work","with","low","superposition\nthresholdsd\ns\nfor","truncation","and","validate","on","a","set","of","testdata.\n2.1.","Approximation","Procedure.We","briefly","discuss","how","an","approximation","is\nnumerically","obtained","in","a","multiple","step","procedure","and","how","we","can","interprete","the","re-\nsults","as","well","as","create","attribute","rankings.","In","this","section,","we","assume","a","given","subset\nof","ANOVA","termsU⊆","P(D).","How","to","obtain","such","a","set","will","be","discussed","inSubsec-\ntion","2.2.","Moreover,","we","always","assume","that","we","have","given","scattered","data","inthe","form\nof","a","node","setX={x\n1\n,x\n2\n,",".",".",".",",x\nM\n}","⊆D\nd\nand","valuesy∈K\nM\n,M∈N.","We","assume\nnow","that","there","is","an","L\n2\n(D\nd\n)","functionfof","form","(\n2.1)","withf(x\ni\n)≈y\ni\nwhich","we","want\nto","approximate.\nThe","approximation","procedure","works","as","follows:","We","truncatefto","the","terms","in\nthe","setUsuch","thatf≈T\nU\nf.","Since","there","are","still","infinitely","many","coefficients,","we\nperform","a","truncation","to","partial","sums","with","a","finite","support","index","setI\nu\n⊆(Z\\{0})\n|u|\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA5\nfor","every","ANOVA","termf\nu\n,u∈U,","such","that\nf\nu\n(x)≈\nX\nk∈P\nu\nI\nu\nc\nk\n(f)φ\nk\n(x)\nandP\nu\nI\nu\n={k∈Z\nd\n:k\nu\n∈I\nu\n,k\nu\nc\n=0}.","Taking","the","unionI(U)","=\nS\nu∈U\nI\nu\n,","we\nhavef(x)≈\nP\nk∈I(U)\nc\nk\n(f)φ\nk\n(x).","","The","unknown","coefficients","c\nk\n(f)","are","now","to","be\ndetermined.\nWe","aim","to","achieve","this","by","solving","the","least-squares","problem\n(2.4)\nˆ\nf=","(\nˆ\nf\nk\n)\nk∈I(U)\n=","arg","min\nˆ\ng∈K\n|I(U)|\nky−F(X,","I(U))\nˆ\ngk\n2\nwith","the","matrixF(X,","I(U))","=","(φ\nk\n(x))\nk∈I(U),x∈X\n.","IfF(X,","I(U))","has","full","rank","the\nproblem","has","a","unique","solution","and\nˆ\nf\nk\n≈c\nk\n(f).","Then","our","approximation","is\nf(x)≈S(X,","I(U))f(x)","=\nX\nk∈I(U)\nˆ\nf\nk\nφ\nk\n(x).\nIn","general,","if","the","oversamplingM/|I(U)|>1,","i.e.,","is","large","enough","and","the","nodes","are\nindependent,","one","may","assume","full","rank","forF(X,","I(U)).\nHow","can(\n2.4)be","efficiently","solved?In","order","to","solve","the","minimization","we\nemploy","the","iterative","LSQR","solver","[31]","which","needs","a","method","for","efficient","multiplica-\ntion","withF(X,","I(U))","and","its","adjointF\n∗\n(X,","I(U))","in","the","periodic","case,","otherwise","its\ntransposed","matrix.","This","is","realized","by","the","Grouped","Transformationidea","in","[\n2]","based\non","the","NFFT","or","the","NFCT,","see","[21,32].","We","consider","three","distinct","function","systems\nin","this","paper","for","which","we","have","a","fast","Grouped","Transform.","In","the","periodic","case","we\nuse","the","Fourier","system","with\n(2.5)φ\nexp\nk\n(x)","=","e\n2πik·x\n.\nFor","non-periodic","functions","we","focus","on","the","cosine","system\n(2.6)φ\ncos\nk\n(x)","=\n√\n2\n|suppk|\nY\ns∈suppk\ncos(πk\ns\nx\ns\n)\nand","the","Chebyshev","system\n(2.7)φ\ncheb\nk\n(x)","=\n√\n2\n|suppk|\nY\ns∈suppk\ncos(k\ni\narccos(2x\ns\n−1)).\nRemark2.1.","The","Chebyshev","system","was","considered","in","[\n34]:","Although","the","the-\noretical","approximation","properties","of","this","system","are","better,","thenodesXoptimally\nneed","to","be","distributed","according","to","the","Chebyshev","probability","measure","and","our","exper-\niments","showed","that","this","did","not","work","well","for","problems","with","scattered","data","from","real\napplications.","In","[\n34]","we","propose","a","way","to","circumvent","this,","by","minimizing","a","weighted\nnorm.","However,","this","has","negative","effects","on","the","condition","of","the","system","and","results\nin","the","need","for","more","data","and/or","iterations.","","Therefore,","we","opt","touse","the","cosine\nsystem","for","scattered","data.","However,","the","situation","is","quite","different","if","the","nodes","can\nbe","generated","according","a","probability","measure,","e.g.,","in","uncertainty","quantification","with\nPDE","applications.\n\n6D.","POTTS,","AND","M.","SCHMISCHKE\nWe","also","restrict","ourselves","to","the","usage","of","full-grid","index","sets,","i.e.,","weuse\nI\nper\nu\n={−N\nu\n/2,",".",".",".",",−1,1,",".",".",".",",","N\nu\n/2−1}\nin","the","periodic","case","and\n(2.8)I\nnon-per\nu\n={1,2,",".",".",".",",","N\nu\n−1}\nfor","the","non-periodic","case","with","the","even","parameterN\nu\n∈2N.","","Note","that","the","sets\ncontainN\nu\n−1","elements","in","both","cases.\nIt","is","possible","to","add","different","types","of","regularization","to","the","problem","(\n2.4)","which\nalso","allows","to","incorporate","a-priori","smoothness","information.","For","details","we","refer","to","[2].\nFor","our","numerical","experiments,","we","addℓ\n2\nregularization,","i.e.,","solving\n(2.9)arg","min\nˆ\ng∈K\n|I(U)|\nky−F(X,","I(U))\nˆ\ngk\n2\n+λk\nˆ\ngk\n2\nwith","regularization","parameterλ",">0.\nHow","can","an","attribute","ranking","be","computed?We","use","the","global","sensi-\ntivity","indices̺(u,","S(X,","I(U))f),u∈U,","from","the","approximationS(X,","I(U))f(x)","to\ncompute","approximations","for","the","global","sensitivity","indices̺(u,","f)","of","the","functionf.\nHere,","we","do","not","consider","the","index","to","be","a","good","approximation","if","the","values","are","close\ntogether,","but","rather","if","there","order","is","identical,","i.e.,","we","have\n̺(u\n1\n,","f)≤̺(u\n2\n,","f)","=⇒̺(u\n1\n,","S(X,","I(U))f)≤̺(u\n2\n,","S(X,","I(U))f)\nfor","any","pairu\n1\n,u\n2\n∈U.\nIf","we","are","interested","in","how","much","one","variablei∈","Dadds","to","the","variance","of","the\nfunction,","i.e.,","how","important","it","is,","we","can","compute","the","ranking","score\n(2.10)r(i)","=\nP\nu∈U\ni∈u\n|{v∈U:|u|=|v|,","i∈v}|\n−1\n̺(u,","S(X,","I(U))f)\nP\nu∈U\n\u0010\nP\ni∈u\n|{v∈U:|u|=|v|,","i∈v}|\n−1\n\u0011\n̺(u,","S(X,","I(U))f)\n.\nThe","score","attributes","the","contribution","of","every","global","sensitivity","index","to","its","variables\nweighted","by","the","number","of","sets","in","that","dimension","and","adds","normalization","such","that\nP\ni∈D\nr(i)","=","1.","Dividing","by","the","number","of","combinations","in","the","same","order","is","necessary\nsince","many","terms","with","a","low","sensitivity","index","may","otherwise","yield","a","high","score.\nComputing","every","scorer(i),i∈","Dprovides","an","attribute","ranking","with","respect","toU\nshowing","the","percentage","that","every","variable","adds","to","the","variance","of","the","approximation.\nThis","allows","for","the","conclusion","that","if","we","have","a","good","approximationS(X,","I(U))f,","its\nattribute","ranking","will","be","close","to","the","attribute","ranking","of","the","functionf.\n2.2.","Active","Set","Detection.In","this","section","we","describe","how","to","obtain","an","active\nset","of","ANOVA","termsUfor","approximation.","We","are","sill","working","with","scattered","data\nX={x\n1\n,x\n2\n,",".",".",".",",x\nM\n}","⊆D\nd\nandy∈K\nM\n,M∈N.","The","valuesymay","also","contain\nnoise.\nWhy","does","it","make","sense","to","reduce","the","number","of","ANOVA","terms?\nThe","first","step","is","to","limit","the","variable","interactions","by","a","superposition","threshold\nd\ns\n∈Dwhich","may","have","been","estimated","by","known","smoothness","properties","(or","different\na-priori","information)","or","set","to","a","sensible","value","if","nothing","is","known.","Ofcourse","it","is\nalso","possible","to","test","and","validate","different","values.","We","use","the","procedure","described","in\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA7\nSubsection","2.1to","obtain","the","approximationS(X,","I(U\nd\ns\n))f.","For","that","we","choose","index\nsetsI\nu\nin","an","order-dependent","way","since","there","is","no","additional","information","available,\ni.e.,N\nu\n1\n=N\nu\n2\nfor|u\n1\n|=|u\n2\n|.","","In","order","to","get","more","consistence","in","the","global\nsensitivity","indices","it","is","advisable","to","choose","the","index","sets","roughly","of","the","same","size,\ni.e.,","(N\nu\n1\n−1)\n|u\n1\n|\n≈(N\nu\n2\n−1)\n|u\n2\n|\nforu\n1\n,u\n2\n∈U\nd\ns\n.\nFrom","the","approximationS(X,","I(U\nd\ns\n))fwe","obtain","the","global","sensitivity","indices\n̺(u,","S(X,","I(U\nd\ns\n))f),u∈U,","and","an","attribute","rankingr(i),i∈","D,","see","(\n2.10).","There\nare","multiple","ways","to","proceed","from","this","point","which","we","explain","in","the","following.\nRemoval","of","unimportant","variables:If","the","attribute","rankingr(i)","shows","vari-\nables","that","have","very","little","to","no","influence","on","the","variance","of","the","function,","then","those\nvariables","may","be","removed","entirely.","Removing","them","leads","to","a","reduction","in","the","di-\nmensionality","of","the","problem","and","greatly","simplifies","the","model","function.\nActive","Set","Thresholding:Here,","one","chooses","a","threshold","vectorε∈(0,1)\nd\ns\nand","reduces","the","ANOVA","terms","to","the","set\nU(ε)\n:\n=\n\b\nu∈U\nd\ns\n:̺(u,","S(X,","I(U\nd\ns\n))f)>","ε\n|u|\n\t\n.\nThis","set","is","not","downward","closed","by","definition,","but","if","we","set","for","all","subsetsvof","the\nsetsu∈U(ε)","withv/∈U(ε)","thatf\nv\n≡0","the","condition","is","fulfilled.","The","parameter\nvectorε∈(0,1)\nd\ns\nallows","control","over","how","much","of","the","variance","may","be","sacrificed","in\norder","to","simplify","the","model","function.\nIncremental","Expansion:This","method","is","advantageous","if","the","model","function","is\nalready","very","complex","with","a","small","superposition","thresholdd\ns\nwhich","may","occur","if","we\nare","dealing","with","an","especially","large","spatial","dimensiond.","Here,","we","start","with","a","small\nd\ns\n,","e.g.,d\ns\n=","1","ord\ns\n=","2.","A","reduction","in","the","ANOVA","terms","can","be","performed","by\neither","of","the","two","previous","approaches.","Now,","one","chooses","aθ∈(0,1)","and","determines\nthe","subset\nv\n:\n={i∈D:r(i)>","θ}.\nIf","we","assume","that","additional","interactions","of","the","important","variables","might","also","be\nsignificant","to","the","variance,","we","may","add","interactions","of","size","up","ton\nv\n∈N,d\ns\n<","n\nv\n<","d.\nThis","translates","to","adding","the","set","of","terms\nU(v,","n\nv\n)\n:\n={u∈P(v):d\ns\n<|u|≤n\nv\n}.\nThis","will","be","a","beneficial","way","to","improve","the","accuracy","of","the","model","if","higher-order\ninteractions","play","a","role.","However,","if","this","method","is","used","without","reducing","the","com-\nplexity","with","any","of","the","previous","approaches,","the","overall","complexityof","the","model","will\nbe","higher.\nIn","summary,","one","has","to","interpret","the","information","obtained","from","the","approxi-\nmationS(X,","I(U\nd\ns\n))fand","choose","the","best","performing","methods","based","on","this.","Any\ncombination","of","the","previously","mentioned","approaches","may","lead","to","theoptimal","ap-\nproximation","as","we","will","see","in","the","numerical","experiments.","","Moreover,","itis","possible\nand","advisable","to","iterate","this","procedure","multiple","times,","i.e.,","cross-validate","it","with","the\nproposed","active","set","detection","steps","in","order","to","obtain","the","best","result.\n3.","Numerical","Experiments","with","Synthetic","Data.In","this","section","we","test\nour","approximation","and","attribute","ranking","idea","on","synthetic","data,","i.e.,we","have","a","func-\ntionf:","D\nd\n→Rand","approximate","it","from","artificially","generated","scattered","data.","Here,\nwe","focus","on","the","non-periodic","setting,","i.e.,","D","=","[0,1]","andK=R,","and","the","cosine\n\n8D.","POTTS,","AND","M.","SCHMISCHKE\nbasisφ\ncos\nk\n(x),","see","(\n2.6).","Note","that","extensive","tests","for","the","periodic","setting","with","the\nFourier","system","(2.5)","and","the","non-periodic","Chebyshev","system","(2.7)","have","been","con-\nducted","in","[\n33,34,2].","For","a","fixed","number","of","nodesM∈Nwe","create","the","node","set\nX={x\n1\n,x\n2\n,",".",".",".",",x\nM\n}","⊆[0,1]\nd\nby","drawing","uniform","i.i.d.","nodes","and","evaluate","the\nfunctiony=","(f(x\ni\n)","+η)\nM\ni=1\n.","Moreover,","the","evaluationsymay","also","contain","noiseη.\nWe","are","using","the","Friedmann","functions,","cf.","[\n28,4,5]","for","our","experiments.","Our\ngoal","is","to","achieve","the","most","accurate","approximation","which","we","will","compare","to","the\nquality","of","different","approaches","known","from","the","literature.","In","order","to","measure","the\nquality","of","the","approximation","we","take","a","second","set","of","uniformly","distributed","i.i.d.","nodes\nX\ntest\n⊆[0,1]\nd\n,|X\ntest\n|","∈N,","and","choose","the","mean","square","error","(MSE)","as","a","measure","of\nquality","which","is","defined","as\n(3.1)MSE(f,\n","̃\nf)","=\n1\n|X\ntest\n|\nX\nx∈X\ntest\n\f\n\f\n\f\nf(x)−\n","̃\nf(x)\n\f\n\f\n\f\n2\n.\nHere,\n","̃\nfis","the","approximation","or","model","forfwhose","quality","is","to","be","measured.\nIn","our","experiments","we","will","make","us","of","regularization","when","solving","problem","(\n2.4),\ni.e.,","solving","the","modified","problem","(2.9)","which","is","described","in","more","detail","in","[2].","Note\nthat","we","rely","solely","on","theℓ\n2\nvariant","of","the","regularization","and","the","parameter","will","be\ndenoted","withλ",">0.","The","experiments","have","been","conducted","using","the","Julia","package\n[\n3]","and","the","code","examples","can","be","found","online","in","[39].\n3.1.","Friedmann","Functions.The","Friedmann","functions","were","used","as","benchmark\nexamples","in","[\n28]","and","have","since","become","an","often","used","example","in","the","approximation\nof","functions","with","scattered","data,","see","e.g.","[4,5].","We","start","by","defining","the","three","non-\nperiodic","Friedmann","functions","over","[0,1]\nd\n.\nThe","first","function\nf\n1\n:","[0,1]\n10\n→R,","f\n1\n(x)","=","10","sin(πx\n1\nx\n2\n)","+","20(x\n3\n−0.5)\n2\n+","10x\n4\n+","5x\n5\nhas","spatial","dimension","10.","However,","only","five","of","the","ten","variables","have","any","influence","on\nthe","function","which","is","the","most","important","information","we","aim","to","find","withour","attribute\nranking.","Additionally,","no","more","than","two","variables","interact","simultaneously,","i.e.,","there\nwill","not","be","an","error","because","of","the","ANOVA","trunction","withU\nd\ns\nfor","a","superposition\nthresholdd\ns\n=","2.","In","other","words,","settingα=","1","yields","d\n(sp)\n=","2","in","(\n2.3).\nThe","second","function\nf\n2\n:","[0,1]\n4\n→R,","f\n2\n(x)","=\ns\ns\n2\n1\n(x\n1\n)","+\n\u0012\ns\n2\n(x\n2\n)·x\n3\n−\n1\ns\n2\n(x\n2\n)·s\n4\n(x\n4\n)\n\u0013\n2\nhas","spatial","dimension","4","and","contains","the","variable","scalingss\n1\n(x\n1\n)","=","100x\n1\n,s\n2\n(x\n2\n)","=\n520πx\n2\n+","40π,","ands\n4\n(x\n4\n)","=","10x\n4\n+","1.","The","scalings","are","necessary","since","we","want","to\nstay","in","the","interval","[0,1]","with","each","variable.","As","for","the","Friedmann","1","function,","there\nare","at","most","two","variables","interacting","simultaneously,","i.e.,α=","1","yields","d\n(sp)\n=","2","in\n(\n2.3)","again.\nThe","third","and","last","Friedmann","function","is","given","by\nf\n3\n:","[0,1]\n4\n→R,","f\n3\n(x)","=","arctan\n\u0012\ns\n2\n(x\n2\n)·x\n3\n−(s\n2\n(x\n2\n)·s\n4\n(x\n4\n))\n−1\ns\n1\n(x\n1\n)\n\u0013\nagain","with","spatial","dimensiond=","4","and","the","same","scalingss\n1\n,s\n2\n,","ands\n4\nas","before.\nHere,","every","term","is","(analytically)","nonzero","which","means","that","entire","function","(without\nerror)","can","only","be","reconstructed","for","a","superposition","thresholdd\ns\n=","4.\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA9\nIn","order","to","compare","our","results","to","the","experiments","in","[\n28],","we","choose","to","replicate\nthe","setting","exactly:","We","use","randomly","generated","setsX\n(i)\n⊆[0,1]\nd\nfor","each","of","the\nFriedman","functionsi=","1,2,3","with","uniformly","distributed","i.i.d.","nodes","such","thatM=\n\f\n\f\nX\n(i)\n\f\n\f\n=","200","for","the","model","training.","The","dimensions","ared=","10","for","Friedman","1,","and\nd=","4","for","Friedman","2","and","3.","Moreover,","we","add","Gaussian","noiseη\ni\n,i=","1,2,3,","to","the\nfunction","evaluations","with","a","mean","of","zero","and","a","variance","ofσ\n1\n=","1","for","Friedman","1,\nσ\n2\n=","125","for","Friedman","2,","andσ\n3\n=","0.1","for","Friedman","3,","i.e.,y\n(i)\n=","(f\ni\n(x)","+η\ni\n)\nx∈X\n(i)\n.\nIn","order","to","validate","the","accuracy","of","the","model,","we","use","test","sets","ofrandomly","drawn\nuniformly","distributed","i.i.d.","nodesX\n(i)\ntest\n⊆[0,1]\nd\nfor","each","of","the","Friedman","functions\ni=","1,2,3","withM\ntest\n=\n\f\n\f\n\f\nX\n(i)\ntest\n\f\n\f\n\f\n=","1000.","The","function","values","are","again","evaluations\nwith","Gaussian","noise","such","thaty\n(i)\ntest\n=","(f\ni\n(x)","+η\ni\n)\nx∈X\n(i)\ntest\n.\nTable","1contains","the","benchmark","data","from","[28]","with","a","support","vector","machine\n(SVM),","a","linear","model","(lm),","a","neural","network","(mnet)","and","a","random","forest","(rForst)\nas","well","as","the","results","with","our","method","(ANOVAapprox).","In","the","following","sections","we\ndiscuss","the","detailed","procedure","on","how","to","obtain","the","models","for","ANOVAapprox.","Note\nthat","we","have","used","the","non-periodic","cosine","basis","(\n2.6).\nsvmlm","","","","mnet","","","rForst","","ANOVAapprox\nFriedman","14.36","","","7.71","","","","9.216.021.43\nFriedman","2","(·10\n3\n)","","","18.13","","36.15","","","19.61","","","21.5017.21\nFriedman","3","(·10\n−3\n)","","23.15","","45.4218.1222.2120.69\nTable","1\nMean","squared","errors","(MSE)","for","different","methods","when","approximating","Friedman","functions","in\n[\n28]","compared","to","ANOVAapprox.","The","value","for","ANOVAapprox","was","obtained","by","training","the","model","on\n100","randomly","generated","training","sets","and","validating","them","on100","randomly","generated","test","sets.","All\nvalues","are","the","medians","of","the","experiment","MSEs","and","the","best","value","for","every","function","is","highlighted.\nThe","results","show","that","the","ANOVA","approximation","method","is","competitive","to","the\nother","approaches","and","delivers","the","best","MSE","for","Friedman","1","and","2","aswell","as","a","close\nsecond","best","MSE","for","Friedman","3.","Note","that","a","set","with","200","datapoints","is","rather","small\nand","other","experiments","used","significantly","more","data,","but","we","aimed","tostay","in","the","exact\nsetting","of","[\n28].\n3.1.1.","Friedman","1.The","first","Friedman","functionf\n1\nprovides","a","good","challenge\nfor","attribute","ranking","since","it","is","a","10-dimensional","function","with","only","5","variables","that\ninfluence","its","value.","Moreover,","we","only","have","as","few","as","200","nodes","available","for","approx-\nimation.","The","only","known","information","is","the","node","setX\n(1)\nand","the","noisy","evaluations\ny\n(1)\n.","The","noise","is","Gaussian","with","zero","mean","and","varianceσ\n1\n=","1.\nWe","begin","by","setting","the","superposition","threshold","tod\ns\n=","2.","Moreover,","we","choose\nfor","index","setsI\n∅\n={0},I\nu\n={1,",".",".",".",",","N\n1\n−1},N\n1\n∈N,","for|u|=","1,","andI\nu\n=\n{1,",".",".",".",",","N\n2\n−1}\n2\n,N\n2\n∈N,","for|u|=","2.","","In\nFigure","1we","have","computed","an","attri-\nbute","ranking,","see","(2.10),","forf\n1\nwhich","clearly","shows","that","the","variablesx\n6\ntox\n10\nare\nsignificantly","less","important","than","the","others","and","indicate","that","we","mayremove","them\ncompletely,","i.e.,","the","active","set","for","approximation","changes","to\nU\n(r)\n={u⊆{1,2,3,4,5}:|u|≤2}.\nNote","that","we","have","computed","multiple","attribute","rankings","and","displayed","the","one","where\nthe","corresponding","approximationS(X\n(1)\n,","I(U\n2\n))f\n1\n,|I(U\n2\n)|=","76,","achieved","the","best\n\n10D.","POTTS,","AND","M.","SCHMISCHKE\nMSE","on","the","test","setX\n(1)\ntest\nof","4.99,","i.e.,","the","closest","model","to","the","original","functionf\n1\n.\n1","","","2","","","3","","","4","","","5","","","6","","","7","","","8","","","9","","10\n0\n0.1\n0.2\n0.3\nr\n(\ni\n)\nFig.","1.Attribute","ranking","of","the","Friedman","1","function","using","200","nodesX\n(1)\nand","noisy","evaluations\ny\n(1)\nwithN\n1\n=","4,N\n2\n=","2,","regularization","paramterλ=","3,","and","superposition","thresholdd\ns\n=","2.\nWe","repeat","our","approximation","process","withU\n(r)\nas","active","set","of","terms","and","consider\nthe","approximationS(X\n(1)\n,","I(U\n(r)\n))f\n1\n,","still","with","the","parametersN\n1\n,","andN\n2\n.","Since\n1+\n\u0000\n5\n1\n\u0001\n+\n\u0000\n5\n2\n\u0001\n=","16,","we","have\n\f\n\f\nU\n(r)\n\f\n\f\n=","16","and","therefore","as","many","global","sensitivity","indices\n̺(u,","S(X\n(1)\n,","I(U\n(r)\n))f\n1\n)","to","consider.\nFigure","2shows","the","global","sensitivity","indices","for\nthe","parameter","constellation","that","yielded","the","best","MSE","of","2.50","on","the","test","setX\n(1)\ntest\n.\nThe","important","sets","are\nU\n∗\n(1)\n={∅}∪{{1},{2},{3},{4},{5},{1,2}}.\nwhile","the","sets","inU\n(r)\n\\U\n∗\n(1)\nhave","a","smaller","global","sensitivity","index","by","a","large","margin\nand","will","be","removed","from","the","active","set","in","the","next","step.\nWe","conclude","the","consideration","of","the","Friedman","1","function","with","the","final","approx-\nimationS(X\n(1)\n,","I(U\n∗\n(1)\n))f\n1\n.","","The","results","for","differentN\n1\n,","andN\n2\nare","displayed","in\nTable","2.","The","best","MSEon","the","test","setX\n(1)\ntest\nwe","were","able","to","obtain","is","1.36.","As","dis-\nplayed","in\nTable","1,","the","best","MSE","achieved","by","different","methods","using","the","same","number\nof","nodes","and","the","same","noise","was","4.36","by","a","support","vector","machine.","Validating","the\nmodel","with","100","randomly","generated","training","and","test","datasets","yielded","a","median","MSE\nof","1.43.\n3.1.2.","Friedman","2.The","second","Friedman","functionf\n2\nis","only","four-dimensional\nwith","every","dimension","playing","a","role","in","the","function.","Therefore,","we","skipthe","attribute\nranking","and","straightforward","try","to","identify","an","active","set","of","terms.","For","that","we","rely\non","the","200","nodesX\n(2)\nand","the","evaluationsy\n(2)\nwith","Gaussian","noise","that","has","a","mean\nof","zero","and","a","variance","ofσ\n2\n=","125.\nAs","for","the","Friedman","1","function,","we","set","the","superposition","thresholdtod\ns\n=","2.","We\nalso","use","full","grid","index","setsI\n∅\n={0},I\nu\n={1,",".",".",".",",","N\n1\n−1},N\n1\n∈N,","for|u|=","1,","and\nI\nu\n={1,",".",".",".",",","N\n2\n−1}\n2\n,N\n2\n∈N,","for|u|=","2","again.","In\nFigure","3we","have","visualized","the\nglobal","sensitivity","indices̺(u,","S(X\n(2)\n,","I(U\n2\n))f\n2\n),u∈U\n2\n,","for","whichS(X\n(2)\n,","I(U\n2\n))f\n2\nyielded","the","best","MSE","of","17.37·10\n3\non","the","test","setX\n(2)\ntest\n.","We","are","able","to","clearly","identify\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA11\n0","","","","2","","","","4","","","","6","","","","8","","","10","","","12","","","14","","","16\n0\n0.1\n0.2\n0.3\n{1}\n{2}\n{3}\n{4}\n{5}\n{1,2}\n̺\n(\nu\n,","S\n(\nX\n1\n,","I\n(\nU\n(r)\n))\nf\n1\n)\nFig.","2.Global","sensitivity","indices̺(u,","S(X\n(1)\n,","I(U\n(r)\n))f\n1\n),u∈U\n(r)\n,","with","parametersN\n1\n=","6,\nN\n2\n=","4,","andλ=","1.U\n∗\n(1)\nwith","circles","and","complement","with","rectangles.\nN\n1\nN\n2\n\f\n\f\n\f\nI(U\n∗\n(1)\n)\n\f\n\f\n\f\nMSE\n4","","","","2173.48\n6","","","","2273.50\n8","","","","2373.58\n4","","","","4251.53\n6","","","","4351.36\n8","","","","4451.36\nTable","2\nNumerical","experiments","with","the","Friedman","1","function","using","200","nodesX\n(1)\nand","noisy","eval-\nuationsy\n(1)\nwith","regularization","paramterλ=","1and","superposition","thresholdd\ns\n=","2.","","The\nMSE\n:\n=","MSE(f\n1\n,","S(X\n(1)\n,","I(U\n∗\n(1)\n))f\n1\n)was","computed","on","the","test","setX\n(1)\ntest\nwith1000nodes.\nthe","highlighted","sets","as","important","and","use\nU\n∗\n(2)\n={∅}∪{{2},{3},{2,3}}.\nas","active","set","going","forward.\nWe","proceed","to","approximate","and","show","the","results","for","different","parameters","in\nTa-\nble","3\n.","The","best","MSE","achieved","on","the","test","setX\n(2)\ntest\nis","16.84·10\n3\ncompared","to","18.13·10\n3\nby","a","support","vector","machine,","seeTable","1.","Validating","the","model","with","100","randomly\ngenerated","training","and","test","datasets","yielded","a","median","MSE","of","17.21·10\n3\n.\n3.1.3.","Friedman","3.The","third","Friedman","functionf\n3\nprovides","a","challenge","since\nall","termsf\nu\n,u⊆D,","are","nonzero.","Therefore,","we","are","making","a","truncation","error","if","the\nthresholdd\ns\nis","smaller","thand=","4.","As","before,","we","use","only","the","200","nodes","inX\n(3)\nand\nthe","evaluationsy\n(3)\nwith","Gaussian","noise","that","has","mean","zero","and","varianceσ\n3\n=","0.1.\nAt","first","we","will","use","a","superposition","threshold","ofd\ns\n=","3","to","identify","which","ANOVA\ntermsf\nu\nwith|u|","≤3","are","important","to","the","function.","As","before","we","rely","on","full","grid\nindex","setsI\n∅\n={0},I\nu\n={1,",".",".",".",",","N\n1\n−1},N\n1\n∈N,","for|u|=","1,I\nu\n={1,",".",".",".",",","N\n2\n−1}\n2\n,\n\n12D.","POTTS,","AND","M.","SCHMISCHKE\n246810\n0\n0.1\n0.2\n0.3\n0.4\n0.5\n{2}\n{3}\n{1,2}\n̺\n(\nu\n,","S\n(\nX\n2\n,","I\n(\nU\n2\n))\nf\n2\n)\nFig.","3.Global","sensitivity","indices̺(u,","S(X\n(2)\n,","I(U\n2\n))f\n2\n),u∈U\n2\n,","with","parametersN\n1\n=","4,\nN\n2\n=","2,","andλ=","0.U\n∗\n(2)\nwith","circles","and","complement","with","rectangles.\nN\n1\nN\n2\n\f\n\f\n\f\nI(U\n∗\n(2)\n)\n\f\n\f\n\f\nMSE\n2","","","","2418.15·10\n3\n4","","","","2816.84·10\n3\n6","","","","21216.98·10\n3\n8","","","","21617.16·10\n3\n4","","","","41617.41·10\n3\n6","","","","42017.64·10\n3\n8","","","","42417.89·10\n3\nTable","3\nNumerical","experiments","with","the","Friedman","2","function","using","200","nodesX\n(2)\nand","noisy","eval-\nuationsy\n(2)\nwith","superposition","thresholdd\ns\n=","2.","TheMSE\n:\n=","MSE(f\n2\n,","S(X\n(2)\n,","I(U\n∗\n(2)\n))f\n2\n)was\ncomputed","on","the","test","setX\n(2)\ntest\nof1000nodes.\nN\n2\n∈N,","for|u|=","2,","andI\nu\n={1,",".",".",".",",","N\n3\n−1}\n3\n,N\n3\n∈N,","for|u|=","3.","","We","have\nvisualized","the","attribute","ranking","for","the","parameter","choice","that","yielded","the","best","MSE\n2.18·10\n−2\non","the","test","setX\n(3)\ntest\nin\nFigure","4.\nThe","ranking","shows","that","the","variablex\n4\nhas","very","little","influence","on","the","approxi-\nmation","compared","to","the","other","3","variables.","This","suggests","that","we","are","able","to","use\nU\n(r)\nd\ns\n={u⊆{1,2,3}:|u|≤d\ns\n}\nas","active","set.\nTable","4shows","the","results","for","approximation","off\n3\nbyS(X\n(3)\n,","I(U\n(r)\n2\n))f\n3\nsuch","that","the","superposition","thresholdd\ns\n=","2","andS(X\n(3)\n,","I(U\n(r)\n3\n))f\n3\nwithd\ns\n=","3.\nWe","achieve","a","best","MSE","of","19.3·10\n−3\non","the","test","setX\n(3)\ntest\nwith","active","setU\n(r)\n2\n,","i.e.,\nwe","set","the","superposition","threshold","tod\ns\n=","2","and","do","not","need","the","three-dimensional\nterm{1,2,3}.","For","comparison","we","find","an","MSE","of","18.12·10\n−3\nas","the","best","result","in\n[\n28],","cf.Table","1.","Validating","the","model","with","100","randomly","generated","training","and","test\ndatasets","yielded","a","median","MSE","of","18.12·10\n−3\n.\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA13\n1234\n0\n0.2\n0.4\n0.6\nr\n(\ni\n)\nFig.","4.Attribute","ranking","of","the","Friedman","3","function","using","200","nodesX\n(3)\nand","noisy","evaluations\ny\n(3)\nwithN\n1\n=","10,N\n2\n=","2,N\n3\n=","2,regularization","paramterλ=","2,","and","superposition","threshold\nd\ns\n=","3.\nN\n1\nN\n2\nN\n3\n\f\n\f\n\f\nI(U\n(r)\n2\n)\n\f\n\f\n\f\n\f\n\f\n\f\nI(U\n(r)\n3\n)\n\f\n\f\n\f\nMSE\nMSE\n10","","","2","","","","2313119.96·10\n−3\n20.25·10\n−3\n12","","","2","","","","2373819.30·10\n−3\n19.63·10\n−3\n14","","","2","","","","2434419.68·10\n−3\n20.06·10\n−3\n10","","","4","","","","2555622.74·10\n−3\n23.11·10\n−3\n12","","","4","","","","2616222.12·10\n−3\n22.26·10\n−3\n14","","","4","","","","2676824.26·10\n−3\n24.33·10\n−3\nTable","4\nNumerical","experiments","with","the","Friedman","3","function","using","200","nodesX\n(3)\nand","noisy","evalu-\nationsy\n(3)\n.","TheMSE\n:\n=","MSE(f\n3\n,","S(X\n3\n,","I(U\n(r)\n2\n))f\n3\n)and\nMSE\n:\n=","MSE(f\n3\n,","S(X\n3\n,","I(U\n(r)\n3\n))f\n3\n)were\ncomputed","on","the","test","setX\n(3)\ntest\nof1000nodes.\n4.","Numerical","Experiments","with","Real","Data.In","this","section","we","test","the\nANOVAapprox","method","on","datasets","from","real","applications,","i.e.,","we","get","a","set","of","nodes\nX","⊆[0,1]\nd\nwith|X|=M∈Nand","noisy","evaluationsy∈R\nM\n.","Note","that","the","data\nis","not","in","[0,1]","in","general,","but","we","can","achieve","this","trough","min-max-normalization","in\na","pre-processing","step.","Moreover,","we","have","to","decide","how","to","splitXinto","two","parts,\nX\ntrain\nwhich","we","use","for","solving","the","optimization","problem,","i.e.,","training","our","model","and\nobtaining","the","basis","coefficients,","andX\ntest\nfor","validating","our","method","and","computing\nthe","error.","Moreover,","we","focus","on","using","the","non-periodic","cosine","basis","(\n2.6)","and","cor-\nresponding","index","setsI\nnon-per\nu\n,","see","(\n2.8),","for","the","ANOVA","termsf\nu\n.","Here,N\nu\n∈2N\nis","the","associated","bandwidth","parameter","that","we","always","choose","order-dependent,","i.e.,\nN\nu\n1\n=N\nu\n2\n=N\n|u\n1\n|\nfor|u\n1\n|=|u\n2\n|.","As","for","the","synthetic","data,","we","make","use","of","theℓ\n2\nregularization","proposed","in","[\n2],","cf.","(2.9).","The","experiments","have","been","conducted","using\nthe","Julia","package","[3]","and","the","code","examples","can","be","found","online","in","[39].\nTable","5provides","an","overview","of","the","data","we","use","and","where","we","obtained","it.","The\ndatasets","are","all","well-known","and","have","been","used","for","regression","benchmarking","in","the\npast.","We","will","not","provide","an","in-depth","description","of","the","precise","approximation","steps\n\n14D.","POTTS,","AND","M.","SCHMISCHKE\nfor","every","dataset,","but","rather","give","a","summary","and","compare","the","results","in","the","end.\nNote","that","we","use","the","root","mean","square","error","as","a","quality","measure","which","describes","the\nsquare","root","of","the","MSE","(\n3.1),","i.e.,\nRMSE(f,\n","̃\nf)\n:\n=\nq\nMSE(f,\n","̃\nf).\nMoreover,","for","theAirfoil","Self-Noiseproblem","we","use","the","relative","error\nv\nu\nu\nu\nt\nP\nx∈X\ntest\n\f\n\f\n\f\nf(x)−\n","̃\nf(x)\n\f\n\f\n\f\n2\nP\nx∈X\ntest\n|f(x)|\n2\nin","order","to","compare","our","results","to","[\n18].\nNamedimension","","datapoints","","references\nENC8768[14,12]\nENH8768[\n14,12]\nAirfoil","Self-Noise","(ASN)51503[18,12]\nCalifornia","Housing","(CH)820640[22,42]\nAilerons4013750[\n22,42]\nTable","5\nReal","datasets","for","benchmarking","the","ANOVAapprox","method","withsources.\nTable","6shows","the","results","we","obtained","with","the","ANOVA","approximation","approach\ncompared","to","other","methods.","For","the","energy","efficiency","problemsENCandENHwe\ncompare","our","results","to","[\n14]","where","different","classical","machine","learning","and","ensemble\nmethods","were","tested","on","the","same","data.","Our","results","outperform","even","the","ensemble\nmethods","when","comparing","the","RMSE.","The","problem","ofAirfoil","Self-Noisewas","consid-\nered","as","an","example","in","[\n18]","for","the","newly","proposed","method","of","sparse","random","features.\nOur","obtained","model","was","able","to","achieve","a","slightly","better","result","by","roughly","one","percent,\nsee\nTable","6.","The","remaining","problemsCalifornia","HousingandAileronswere","consid-\nered","as","benchmark","examples","for","multithreaded","local","learning","regularization","networks\nin","[\n14]","where","we","are","also","able","to","achieve","a","lower","RMSE.","Note","that","we","have","tried","to\nreplicate","the","setting","for","every","dataset,","i.e.,","using","the","same","percentages","for","training\nand","testing","as","well","as","validating","our","model","on","100","random","splits.","Moreover,Figure","5\ncontains","the","attribute","rankings","for","each","of","the","5","models","showing","the","importance","of\nthe","different","attributes","for","the","datasets.\n4.1.","Energy","Efficiency.The","dataset","describes","the","energy","efficiency","of","houses\nby","8","attributes","and","two","values","to","predict,","the","cooling","load","and","the","heating","load.\nTherefore,","we","have","two","problems","ENC","(8","attributes,","1","continuousvalue","to","predict)\nfor","the","cooling","load","and","ENH","(8","attributes,","1","continuous","value","to","predict)","for","the\nheating","load.","The","dataset","contains","768","samples","which","we","split","70%","forthe","training\nsetX\ntrain\nand","30%","for","the","test","setX\ntest\n.","The","nodesXare","normalized","into","[0,1].\nFirst,","we","consider","the","ENC","problem","and","start","by","setting","the","superposition","thresh-\noldd\ns\n=","2","and","analyze","the","global","sensitivity","indices","in","order","to","remove","unimportant\nsets.","Experiments","showed","that","removing","sets","or","terms","with","a","global","sensitivity","in-\ndex","(GSI)","of","less","than","0.002","yielded","the","best","result.","","This","leads","to","an","active","set\nU\n∗\nENC\n⊆","P(D)","with","22","terms.","The","resulting","model","gives","a","median","RMSE","of","1.49","for\n100","random","splits","into","training","and","test","set.\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA15\ndataseterror","(type)method","(reference)ANOVAapprox\nENC1.79","(RMSE)","","","","Gradient","Boosting","Machine","([14])1.49\nENH0.48","(RMSE)Random","Forest","([14])0.44\nASN0.0277","(relative)","","","","Sparse","Random","Features","([\n18])0.0161\nCH0.11450","(RMSE)","","","","Local","Learning","Reg.","NN","([22])0.10899\nAilerons","","0.04601","(RMSE)","","","","Local","Learning","Reg.","NN","([\n22])0.04569\nTable","6\nResult","comparison","for","different","datasets","and","approaches.","The","models","for","ANOVAapprox","where\nvalidated","using","100","random","splits","of","training","and","test","set.","More","details","are","discussed","in","the","corre-\nsponding","subsection","of\nSection4.","The","ANOVAapprox","error","is","compared","to","the","best","error","found","in\nthe","mentioned","source","together","with","the","method","used","therein.\nFor","the","ENH","problem","we","proceed","in","a","similar","fashion.","We","set","the","superposition\nthreshold","tod\ns\n=","2","and","then","analyze","the","GSI","of","our","model.","Here,","we","choose","the\nactive","setU\n∗\nENH\n⊆P(D)","consisting","of","all","ANOVA","terms","with","a","GSI","larger","than","0.001\nsuch","that|U\n∗\nENH\n|=","28.","As","a","result","we","obtain","a","model","with","a","median","RMSE","of","0.44\nfor","100","random","splits","into","training","and","test","set.\nThe","optimal","order-dependent","bandwidths","parametersN\n1\n,","N\n2\n∈Nfor","both","prob-\nlems","were","computed","using","cross-validation.\nFigure","5aandFigure","5bshow","attribute\nrankings","for","our","obtained","models.","We","notice","that","the","attribute","5,","i.e.,","the","overall\nheight","of","the","building,","is","especially","important","for","the","prediction","in","bothproblems.\n4.2.","Airfoil","Self-Noise.This","datasets","originates","from","the","NASA","and","contains\ndata","about","NACA","airfoils","for","different","wind","tunnel","speeds","and","anglesof","attack.","We\naim","to","find","a","model","that","is","able","to","predict","the","scaled","sound","pressure","level","of","the\nself-noise","in","decibels","(continuous),","see","[\n12].","The","data","contains","5","attributes","and","1503\nnodes.","We","perform","a","random","split","with","80%","for","the","training","setX\ntrain\nand","20%","for\nthe","test","setX\ntest\n.","Since","this","dataset","has","recently","been","used","in","[\n18]","for","experiments\nwith","sparse","random","features,","we","choose","the","same","split","to","comparethe","results.","Note\nthat","the","nodes","were","normalized","into","[0,1].\nAn","analysis","of","the","global","sensitivity","indices","for","the","superposition","thresholdd\ns\n=","2\nshows","that","there","is","only","one","unimportant","term","with","a","GSI","less","than","0.001","that","is","to","be\nremoved.","Therefore,","we","have","an","active","setU\n∗\nASN\n⊆P(D)","with|U\n∗\nASN\n|=","14","and","need\nto","use","cross-validation","in","order","to","determine","the","optimal","order-dependent","bandwidths\nparametersN\n1\n,","N\n2\n∈N.","The","obtained","model","was","validated","on","100","random","80/20","splits\ninto","training","and","test","data","yielding","a","median","relative","error","of","1.61%.","In\nFigure","5c\nwe","have","visualized","the","attribute","ranking","for","our","model.","It","shows","that","attributes","3\nand","4,","i.e.,","the","chord","length","and","the","free-stream","velocity","have","a","large","influence","on","the\npredictions.\n4.3.","California","Housing.The","datasets","describes","the","prices","for","houses","in","Cali-\nfornia","using","data","about","the","block","groups","from","the","1990","census.","Using","8","attributes","and\na","set","of","20460","cases,","we","aim","to","predict","the","median","house","price","for","the","area.","Since","we\nwant","to","compare","our","results","to","[\n22],","we","have","split","the","data","in","50%","for","the","training","set\nX\ntrain\nand","another","50%","for","the","test","setX\ntest\n.","The","nodesas","well","as","the","evaluations\nwere","normalized","into","[0,1].","The","normalization","of","the","evaluations","is","replicated","from\n[\n22].\nWe","used","a","superposition","threshold","ofd\ns\n=","2","and","analyzed","the","GSIs","of","the","ANOVA\nterms.","This","lead","to","an","active","setU\n∗\nCH\n⊆P(D)","with|U\n∗\nCH\n|=","21","terms.","The","bandwidth\n\n16D.","POTTS,","AND","M.","SCHMISCHKE\n1","","","","2","","","","3","","","","4","","","","5","","","","6","","","","7","","","","8\n0.1\n0.2\n0.3\n0.4\nr\n(\ni\n)\n(a)","ENC\n1","","","","2","","","","3","","","","4","","","","5","","","","6","","","","7","","","","8\n0.1\n0.2\n0.3\n0.4\nr\n(\ni\n)\n(b)","ENH\n12345\n0.1\n0.2\n0.3\n0.4\nr\n(\ni\n)\n(c)","Airfoil","Self-Noise\n1","","","","2","","","","3","","","","4","","","","5","","","","6","","","","7","","","","8\n0.1\n0.2\nr\n(\ni\n)\n(d)","California","Housing\n1357911\n0.1\n0.15\n0.2\n5·10\n−2\nr\n(\ni\n)\n(e)","Ailerons\nFig.","5.Attribute","ranking","for","the","datasets","from\nTable5.\nparametersN\n1\n,","N\n2\n∈Nwere","then","computed","using","cross-validation.","The","model","was\nsubsequently","validated","on","100","random","50/50","splits","of","the","training","and","test","data","which\nyielded","a","median","RMSE","of","0.10899.\nFigure","5dshows","the","attribute","ranking","for","the\nobtained","model","hinting","that","the","variables","1,","2,","and","6,","i.e.,","the","geographical","location\nand","the","population","count,","are","most","important","for","the","prediction.","","It","also","evident\nfrom","the","GSI","that","the","ANOVA","termf\n{1,2}\nhas","significant","importance","which","makes\nsense","since","variable","1","is","the","longitude","and","variable","2","the","latitude","and","together","they\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA17\nrepresent","the","geographical","location.\n4.4.","Ailerons.The","Ailerons","dataset","describes","the","control","problem","of","flying","a\nF16","aircraft.","The","attributes","describe","the","status","of","the","aircraftwhile","we","aim","to","predict\nthe","control","action","on","its","ailerons.","We","have","40","attributes","and","13750samples.","In","order\nto","replicate","the","setting","in","[\n22],","we","have","split","the","data","in","50%","for","the","training","setX\ntrain\nand","another","50%","for","the","test","setX\ntest\n.","The","nodesas","well","as","the","evaluationswere\nnormalized","into","[0,1].","The","normalization","of","the","evaluations","is","replicated","from","[\n22].\nWe","started","to","consider","an","attribute","ranking","for","superposition","thresholdd\ns\n=","1","in\norder","to","check","if","some","variables","have","little","influence","and","can","be","omitted","for","the","model.\nThis","lead","us","to","eliminate","29","variables","with","a","small","contribution.","","We","determined\nthis","number","through","cross-validation.","Afterwards,","we","proceeded","with","the","11","active\nvariables","andd\ns\n=","2.","A","sensitivity","analysis","leads","to","the","elimination","of","more","terms\nleading","to","an","active","setU\n∗\nAil\n⊆P(D)","with|U\n∗\nAil\n|=","43","terms.","A","validation","of","our","model\non","100","random","50/50","splits","into","training","and","test","data","has","yielded","a","median","RMSE\nof","0.04569.","In\n5ewe","have","visualized","the","attribute","ranking","for","our","model","showing","that\nvariables","1,2,","and","8","are","important.","They","correspond","to","the","variables","7,","3,","and","30","of\nthe","original","problem.\n5.","Conclusion.Numerical","experiments","with","synthetic","and","real","data","showed\nthat","the","proposed","approach","for","approximation","using","ANOVA","and","Grouped","Trans-\nformations,","see","[33,34,2],","is","a","competitive","method","in","the","approximation","of","high-\ndimensional","data","outperforming","even","ensemble","machine","learning","methods","in","our","ex-\nperiments.","Moreover,","it","delivers","additional","evidence","for","the","fact","that","in","applications\nwe","are","able","to","assume","that","functions","consist","of","(mostly)","low-orderinteractions","or","are\nat","least","explained","well","by","them.","Since","the","method","allows","intrinsically","forinterpre-\ntation,","we","are","able","to","produce","an","attribute","ranking","that","shows","howmuch","different\nattributes","influence","the","predictions.","This","can","also","be","used","to","improve","the","model","by\nremoving","unimportant","variables","or","variable","interactions","entirely.","","Finally,","we","have\nproposed","and","applied","multiple","methods","for","the","detection","of","an","activeset","of","ANOVA\nterms.\nAcknowledgments.We","thank","our","colleagues","in","the","research","group","SAlE","for\nvaluable","discussions","on","the","contents","of","this","paper.","Daniel","Potts","acknowledges","fund-\ning","by","Deutsche","Forschungsgemeinschaft","(German","Research","Foundation)","–","Project–\nID","416228727","–","SFB","1410.","Michael","Schmischke","is","supported","by","the","BMBF","grant\n01|S20053A.\nREFERENCES\n[1]C.","C.","Aggarwal,Data","Classification:","Algorithms","and","Applications,","Chapman","&","Hall/CRC,\n1st","ed.,","2014.\n[2]F.","Bartel,","D.","Potts,","and","M.","Schmischke,Grouped","transformations","in","high-dimensional\nexplainable","ANOVA","approximation,","ArXiv","e-prints","2010.10199,","(2020).\n[3]F.","Bartel","and","M.","Schmischke,ANOVAapprox","Julia","package.\nhttps://github.com/NFFT/\nANOVAapprox/\n,","2020.\n[4]G.","Beylkin,","J.","Garcke,","and","M.","Mohlenkamp,Multivariate","regression","and","machine","learning\nwith","sums","of","separable","functions,","SIAM","J.","Scientific","Computing,","31","(2009),","pp.","1840–1857,\nhttps://doi.org/10.1137/070710524.\n[5]P.","Binev,","W.","Dahmen,","and","P.","Lamby,Fast","high-dimensional","approximation","with","sparse\noccupancy","trees,","J.","Comput.","Appl.","Math.,","235","(2011),","pp.","2063","–","2076,\nhttps://doi.org/10.\n1016/j.cam.2010.10.005\n.\n[6]C.","M.","Bishop,Pattern","Recognition","and","Machine","Learning,","Springer","New","York,","Berlin-\nHeidelberg,","2016.\n\n18D.","POTTS,","AND","M.","SCHMISCHKE\n[7]R.","Caflisch,","W.","Morokoff,","and","A.","Owen,Valuation","of","mortgage-backed","securities","using\nBrownian","bridges","to","reduce","effective","dimension,","J.","Comput.","Finance,","1","(1997),","pp.","27–46,\nhttps://doi.org/10.21314/jcf.1997.005.\n[8]R.","Chitta,","R.","Jin,","and","A.","K.","Jain,Efficient","kernel","clustering","using","random","Fourier","features,\nin","2012","IEEE","12th","International","Conference","on","Data","Mining,","IEEE,","2012,\nhttps://doi.org/\n10.1109/icdm.2012.61\n.\n[9]P.","G.","Constantine,","E.","Dow,","and","Q.","Wang,Active","subspace","methods","in","theory","and","practice:\nApplications","to","kriging","surfaces,","SIAM","J.","Sci.","Comput.,","36","(2014),","pp.","A1500–A1524,\nhttps://doi.org/10.1137/130916138.\n[10]P.","G.","Constantine,","A.","Eftekhari,","J.","Hokanson,","and","R.","A.","Ward,A","near-stationary","sub-\nspace","for","ridge","approximation,","Comput.","Methods","Appl.","Mech.","Engrg.,","326","(2017),","pp.","402–\n421,\nhttps://doi.org/10.1016/j.cma.2017.07.038.\n[11]R.","DeVore,","G.","Petrova,","and","P.","Wojtaszczyk,Approximation","of","functions","of","few","variables\nin","high","dimensions,","Constr.","Approx.,","33","(2010),","pp.","125–143,\nhttps://doi.org/10.1007/\ns00365-010-9105-8\n.\n[12]D.","Dua","and","C.","Graff,UCI","machine","learning","repository,","2017,\nhttp://archive.ics.uci.edu/ml.\n[13]M.","Fornasier,","K.","Schnass,","and","J.","Vybiral,Learning","functions","of","few","arbitrary","linear","pa-\nrameters","in","high","dimensions,","Found.","Comput.","Math.,","12","(2012),","pp.","229–262,\nhttps://doi.\norg/10.1007/s10208-012-9115-y\n.\n[14]M.","Goyal,","M.","Pandey,","and","R.","Thakur,Exploratory","analysis","of","machine","learning","techniques\nto","predict","energy","efficiency","in","buildings,","in","2020","8th","International","Conference","on","Reliability,\nInfocom","Technologies","and","Optimization","(Trends","and","Future","Directions)","(ICRITO),","IEEE,\n2020,\nhttps://doi.org/10.1109/icrito48877.2020.9197976.\n[15]I.","G.","Graham,","F.","Y.","Kuo,","J.","A.","Nichols,","R.","Scheichl,","C.","Schwab,","andI.","H.","Sloan,Quasi-\nMonte","Carlo","finite","element","methods","for","elliptic","PDEs","with","lognormal","random","coefficients,\nNumer.","Math.,","131","(2014),","pp.","329–368,\nhttps://doi.org/10.1007/s00211-014-0689-y.\n[16]I.","G.","Graham,","F.","Y.","Kuo,","D.","Nuyens,","R.","Scheichl,","and","I.","H.","Sloan,Circulant","embed-\nding","with","QMC:","analysis","for","elliptic","PDE","with","lognormal","coefficients,","Numer.","Math.,","140\n(2018),","pp.","479–511,\nhttps://doi.org/10.1007/s00211-018-0968-0.\n[17]C.","Gu,Smoothing","Spline","ANOVA","Models,","Springer","New","York,","2013,\nhttps://doi.org/10.1007/\n978-1-4614-5369-7\n.\n[18]A.","Hashemi,","H.","Schaeffer,","R.","Shi,","U.","Topcu,","G.","Tran,","and","R.","Ward,Function","approxi-\nmation","via","sparse","random","features,","ArXiv","e-prints","2103.03191,","(2021).\n[19]T.","Hastie,","R.","Tibshirani,","and","J.","Friedman,The","Elements","of","Statistical","Learning","-","Data\nMining,","Inference,","and","Prediction,","Springer","Science","&","Business","Media,","Berlin","Heidelberg,\n2013.\n[20]M.","Holtz,Sparse","grid","quadrature","in","high","dimensions","with","applications","in","finance","and","insur-\nance,","vol.","77","of","Lecture","Notes","in","Computational","Science","and","Engineering,","Springer-Verlag,\nBerlin,","2011,\nhttps://doi.org/10.1007/978-3-642-16004-2.\n[21]J.","Keiner,","S.","Kunis,","and","D.","Potts,Using","NFFT3","-","a","software","library","for","various","noneq-\nuispaced","fast","Fourier","transforms,","ACM","Trans.","Math.","Software,","36","(2009),","pp.","Article","19,\n1–30,\nhttps://doi.org/10.1145/1555386.1555388.\n[22]Y.","Kokkinos","and","K.","G.","Margaritis,Multithreaded","local","learning","regularization","neural","net-\nworks","for","regression","tasks,","in","Engineering","Applications","of","Neural","Networks,","SpringerIn-\nternational","Publishing,","2015,","pp.","129–138,\nhttps://doi.org/10.1007/978-3-319-23983-513.\n[23]F.","Y.","Kuo","and","D.","Nuyens,Application","of","Quasi-Monte","Carlo","Methods","to","Elliptic","PDEs","with\nRandom","Diffusion","Coefficients:","A","Survey","of","Analysis","and","Implementation,","Found.","Com-\nput.","Math,","16","(2016),","pp.","1631–1696,\nhttps://doi.org/10.1007/s10208-016-9329-5,https://\ndoi.org/10.1007/s10208-016-9329-5\n.\n[24]F.","Y.","Kuo,","C.","Schwab,","and","I.","H.","Sloan,Quasi-Monte","Carlo","finite","element","methods","for","a\nclass","of","elliptic","partial","differential","equations","with","random","coefficients,","SIAM","J.","Numer.\nAnal.,","50","(2012),","pp.","3351","–","3374,\nhttps://doi.org/10.1137/110845537.\n[25]F.","Y.","Kuo,","I.","H.","Sloan,","G.","W.","Wasilkowski,","and","H.","Wo\n","́\nzniakowski,On","decompositions\nof","multivariate","functions,","Math.","Comp.,","79","(2009),","pp.","953–966,\nhttps://doi.org/10.1090/\ns0025-5718-09-02319-9\n.\n[26]Z.","Li,","J.-F.","Ton,","D.","Oglic,","and","D.","Sejdinovic,Towards","a","unified","analysis","of","random\nFourier","features,","in","Proceedings","of","the","36th","International","Conference","on","Machine","Learn-\ning,","K.","Chaudhuri","and","R.","Salakhutdinov,","eds.,","vol.","97","of","Proceedings","of","Machine","Learning\nResearch,","PMLR,","09–15","Jun","2019,","pp.","3905–3914,\nhttp://proceedings.mlr.press/v97/li19k.\nhtml\n.\n[27]R.","Liu","and","A.","B.","Owen,Estimating","mean","dimensionality","of","analysis","of","variance","decom-\npositions,","J.","Amer.","Statist.","Assoc.,","101","(2006),","pp.","712–721,\nhttps://doi.org/10.1198/\n\nINTERPRETABLE","APPROXIMATION","OF","HIGH-DIMENSIONAL","DATA19\n016214505000001410.\n[28]D.","Meyer,","F.","Leisch,","and","K.","Hornik,The","support","vector","machine","under","test,","Neurocomput-\ning,","55","(2003),","pp.","169","–","186,\nhttps://doi.org/10.1016/S0925-2312(03)00431-4.","","Support\nVector","Machines.\n[29]G.","Montavon,","W.","Samek,","and","K.-R.","M\n","̈\nuller,Methods","for","interpreting","and","understanding\ndeep","neural","networks,","Digit.","Signal","Process.,","73","(2018),","pp.","1–15,\nhttps://doi.org/10.1016/\nj.dsp.2017.10.011\n.\n[30]A.","Owen,Effective","dimension","of","some","weighted","pre-Sobolev","spaces","with","dominating","mixed\npartial","derivatives,","SIAM","J.","Numer.","Anal.,","57","(2019),","pp.","547–562,\nhttps://doi.org/10.\n1137/17m1158975\n.\n[31]C.","C.","Paige","and","M.","A.","Saunders,LSQR:","An","algorithm","for","sparse","linear","equations","and","sparse\nleast","squares,","ACM","Trans.","Math.","Software,","8","(1982),","pp.","43–71,\nhttps://doi.org/10.1145/\n355984.355989\n.\n[32]G.","Plonka,","D.","Potts,","G.","Steidl,","and","M.","Tasche,Numerical","Fourier","Analysis,","Ap-\nplied","and","Numerical","Harmonic","Analysis,","Birkh","̈auser,","2018,\nhttps://doi.org/10.1007/\n978-3-030-04306-3\n.\n[33]D.","Potts","and","M.","Schmischke,Approximation","of","high-dimensional","periodic","functions","with\nFourier-based","methods,","ArXiv","e-prints","1907.11412,","(2019).\n[34]D.","Potts","and","M.","Schmischke,Learning","multivariate","functions","with","low-dimensional","struc-\ntures","using","polynomial","bases,","ArXiv","e-prints","1912.03195,","(2019).\n[35]H.","Rabitz","and","O.","F.","Alis,General","foundations","of","high","dimensional","model","representations,","J.\nMath.","Chem.,","25","(1999),","pp.","197–233,\nhttps://doi.org/10.1023/A:1019188517934.\n[36]A.","Rahimi","and","B.","Recht,Random","features","for","large-scale","kernel","machines,","in","Advances","in\nNeural","Information","Processing","Systems,","J.","Platt,","D.","Koller,","Y.","Singer,","and","S.","Roweis,\neds.,","vol.","20,","Curran","Associates,","Inc.,","2008,\nhttps://proceedings.neurips.cc/paper/2007/\nfile/013a006f03dbc5392effeb8f18fda755-Paper.pdf\n.\n[37]A.","Saltelli,","M.","Ratto,","T.","Andres,","F.","Campolongo,","J.","Cariboni,","D.","Gatelli,","M.","Saisana,\nand","S.","Tarantola,Global","sensitivity","analysis:","the","primer,","John","Wiley","&","Sons,","Ltd.,","2008.\n[38]W.","Samek,","T.","Wiegand,","and","K.-R.","M\n","̈\nuller,Explainable","artificial","intelligence:","Understand-\ning,","visualizing","and","interpreting","deep","learning","models,","ArXiv","e-prints","1708.08296,","(2017).\n[39]M.","","Schmischke,ANOVAapprox","","numerical","","experiments.\nhttps://github.com/NFFT/\nAttributeRankingExamples\n,","2021.\n[40]I.","M.","Sobol,On","sensitivity","estimation","for","nonlinear","mathematical","models,","Keldysh","Applied-\nMathematics","Institute,","1","(1990),","pp.","112–118.\n[41]I.","M.","Sobol,Global","sensitivity","indices","for","nonlinear","mathematical","models","and","their","Monte\nCarlo","estimates,","Math.","Comput.","Simulation,","55","(2001),","pp.","271–280,\nhttps://doi.org/10.\n1016/s0378-4754(00)00270-6\n.\n[42]L.","Torgo,Regression","datasets.\nhttps://www.dcc.fc.up.pt/\n∼\nltorgo/Regression/DataSets.html.\n[43]C.","F.","J.","Wu","and","M.","S.","Hamada,Experiments","-","Planning,","Analysis,","and","Optimization,","John\nWiley","&","Sons,","New","York,","2011.\n[44]T.","Yang,","Y.-F.","Li,","M.","Mahdavi,","R.","Jin,","and","Z.-H.","Zhou,Nystr","̈om","method","vs","random","Fourier\nfeatures:","A","theoretical","and","empirical","comparison,","in","Proceedings","of","the","25th","International\nConference","on","Neural","Information","Processing","Systems","-","Volume","1,","NIPS’12,","Red","Hook,\nNY,","USA,","2012,","Curran","Associates","Inc.,","p.","476–484."],"doc21":["\n\nClosed-form","geodesics","and","trust-region","method\nto","calculate","Riemannian","logarithms","on","Stiefel","and\nits","quotient","manifolds\nDu","Nguyen\nMarch","25,","2021\nAbstract\nWe","","provide","","two","","closed-form","","geodesic","","formulas","","for","","a","","family","","of","","metrics","","on\nStiefel","","manifold,","","parameterized","","by","","two","","positive","","numbers,","","having","","both","","the","","em-\nbedded","and","canonical","metrics","as","special","cases.","","The","closed-form","formulas","allow\nus","to","compute","geodesics","by","matrix","exponential","in","reduced","dimension","for","low-rank\nmanifolds.","Combining","with","the","use","of","Fr\n","́\nechet","derivatives","to","compute","the","gradient\nof","the","square","Frobenius","distance","between","a","geodesic","ending","point","to","a","given","point\non","the","manifold,","we","show","the","logarithm","map","and","geodesic","distance","between","two\nendpoints","on","the","manifold","could","be","computed","byminimizingthis","square","distance\nby","atrust-regionsolver.","","This","leads","to","a","new","framework","to","compute","the","geodesic\ndistance","for","manifolds","with","known","geodesic","formula","but","no","closed-form","logarithm\nmap.","We","show","the","approach","works","well","for","Stiefel","as","well","as","flag","manifolds.","The\nlogarithm","map","could","be","used","to","compute","the","Riemannian","center","of","mass","for","these\nmanifolds","equipped","with","the","above","metrics.","We","also","deduce","simple","trigonometric\nformulas","for","the","Riemannian","exponential","and","logarithm","maps","on","the","Grassmann\nmanifold.\nKeywordsStiefel","manifold·Geodesic·Computer","Vision·Flag","manifold·\nLogarithm","map·Riemannian","center","of","mass·Fr\n","́\nechet","derivative\nMathematics","Subject","Classification","(2000)65K10·58C05·49Q12·53C25·\n57Z20·57Z25·68T05·68T45\n1\narXiv:2103.13327v1","","[math.DG]","","12","Mar","2021\n\n1","","","","Introduction\nThe","Stiefel","manifold,","the","manifold","of","orthogonal","matrices","of","a","given","number","of","rows\nand","columns,","is","important","in","various","applications,","including","computer","vision","[1],","neu-\nral","networks","[2],","statistics","[3].","","It","has","two","well-known","metrics,","the","embedded","metric\nand","canonical","metric","defined","in","[4],","which","were","treated","separately","in","that","foundational\npaper.","","While","both","have","known","exponential","maps,","allowing","one","to","compute","geodesic\nending","point","when","an","initial","position","and","velocity","is","given,","they","have","no","known","closed-\nform","logarithm","map,","which","gives","us","a","velocity","vector","with","the","minimum","length","that\nproduces","a","geodesic","connecting","the","initial","point","with","an","ending","point.","","","To","compute\nstatistics","on","Stiefel","manifolds,","","for","example,","","the","Riemannian","center","of","mass","[5],","","ap-\nproximated","geodesics","are","often","used","[3].","","There","have","been","several","research","efforts","to\ncompute","the","logarithm","map","numerically,","with","[6,","7]","treating","the","case","of","the","canonical\nmetric","while","[8,","9]","treated","the","embedded","metric.","","To","our","best","knowledge,","a","common\ntreatment","of","the","logarithm","map","for","both","metrics","is","not","yet","available.\nRecently,","[10]","introduced","a","family","of","metrics","on","the","Stiefel","manifold,","parameter-\nized","by","a","real","number","that","contains","both","the","canonical","and","embedded","metrics","as","special\ncases,","with","a","closed-form","geodesic","formula.","","That","geodesic","formula","requires","calculat-\ning","exponentials","of","matrices","of","dimension","the","longer","size","of","a","Stiefel","matrix.","","Later,\nignorance","of","[10],","in","[11]","we","introduced","essentially","the","same","family","of","metrics,","with","a\ndifferent","parameterization.","","In","this","paper,","we","provide","two","new","geodesics","formulas","for\nthese","metrics,","generalizing","both","geodesics","formulas","in","[4].","","In","particular,","the","efficient\nformula","for","geodesics","in","Theorem","2.1","of","[4]","generalizes","to","the","whole","family,","includ-\ning","the","embedded","metric.","","The","matrix","exponentials","required","by","our","formulas","depend\non","the","shorter","size","of","a","Stiefel","matrix,","","hence","are","efficient","for","low-rank","matrices.","","","A\nquick","application","of","these","formulas","gives","us","new,","trigonometric-like","formulas","for","the\nexponential","map","and","logarithm","map","of","Grassmann","manifolds","(considered","as","a","quotient\nmanifold","of","Stiefel","manifold),","similar","to","those","of","the","sphere.\nFor","the","Stiefel","manifold,","our","generalized","formulas","for","geodesics","imply","the","search\nspace","for","the","logarithm","map","between","given","points","could","be","identified","with","a","Euclidean\nspace","with","a","substantially","smaller","dimension","than","the","dimension","of","the","manifold","when\nmatrices","in","the","manifold","are","of","low","rank.","We","propose","an","approach","to","compute","the","loga-\nrithm","map","byminimizing","the","square","of","the","Frobenius","distance","between","the","ending","point\nof","a","geodesic","to","a","target","point.","","Thus,","we","treat","the","computation","of","the","logarithm","map\nas","anoptimization","problem","with","efficiently","computed","gradients.","In","spirit,","our","approach\nis","close","to","the","shooting","method","of","[8,","12,","9].","","The","efficient","evaluation","of","the","gradient\nmakes","use","of","Fr\n","́\nechet","derivatives,","(introduced","with","efficient","computational","procedures\n2\n\nin","[13,","14,","15]),","bypassing","the","requirement","for","a","partition","of","the","time","interval.","The","over-\nall","optimization","problem","is","solved","using","a","trust-region","solver,","with","numerical","Hessian\n(an","L-BFGS-B","solver","is","also","likely","to","work).\nThe","approach","works","well","for","all","metrics","in","the","family","when","the","ending","point","of\nthe","geodesic","is","sufficiently","close","to","the","initial","point,","making","this","approach","competitive\nfor","statistical","problems,","","in","particular","the","Riemannian","center","of","mass","[5].","","","For","target\npoints","","further","","from","","the","","initial","","point,","","the","","method","","is","","also","","robust,","","most","","of","","the","","time","","it\nreturns","a","reasonable","candidate","for","the","logarithm","map,","generating","a","geodesic","reaching\nthe","target","point","and","has","good","potential","for","being","length-minimizing.","","","The","objective\nfunction","and","its","gradient","for","the","canonical","metric","are","simpler","than","those","of","other","metrics\nin","the","family.\nThe","application","of","Fr\n","́\nechet","derivatives","to","compute","the","gradient","of","the","distance","func-\ntion","could","be","generalized","to","other","manifolds.","To","illustrate,","we","apply","it","to","flag","manifolds,\nintroduced","in","the","optimization","literature","in","[16,","17,","18].","","From","[16],","a","flag","manifold\ncould","be","considered","as","the","manifold","of","symmetric","matrices","with","specified","eigenvalues\nof","given","multiplicities","(anisospectral","manifold)","and","could","be","identified","with","a","quo-\ntient","","space","","of","","a","","Stiefel","","manifold","","by","","a","","group","","of","","block-diagonal","","orthogonal","","matrices\n(the","Grassmann","manifold","is","a","flag","manifold","with","two","eigenvalue","blocks).","","Equipping\na","flag","manifold","with","the","quotient","metric","of","a","Stiefel","metric","in","the","family","above,","the\nflag","manifold","will","have","known","geodesics","but","except","for","the","Grassmann","case,","has","no\nknown","logarithm","map.","Studying","geodesics","on","a","flag","manifold","is","equivalent","to","studying\ngeodesics","","on","","a","","Stiefel","","manifold,","","where","","the","","initial","","tangent","","direction","","satisfies","","ahori-\nzontal","condition,","while","the","ending","point","is","required","to","reach","not","a","target","point","but","an\nelement","in","its","orbit.","","Our","approach,","minimizing","the","Euclidean","distance","in","the","symmet-\nric","matrix","realization,","with","the","help","of","Fr\n","́\nechet","derivatives,","also","works","well","in","this","case.\nFor","Grassmann","manifolds,","our","numerical","algorithm","for","the","logarithm","map","matches","the\nclosed-form","formula.","For","other","flag","manifolds,","it","also","returns","a","reasonable","candidate.\nWe","will","review","basic","notations","in","section","2,","prove","the","geodesic","formulas","for","Stiefel\nmanifolds","","in","","section","","3,","","for","","Grassmann","","manifolds","","in","","section","","4.","","","We","","review","","Fr\n","́\nechet\nderivatives","in","section","5","and","present","our","algorithm","for","the","logarithm","map","for","Stiefel\nmanifolds","in","section","6.","","We","review","flag","manifolds","and","report","the","results","in","section","7.\nWe","finish","with","a","calculation","of","the","Riemannian","center","of","mass,","some","notes","on","imple-\nmentation,","and","a","final","discussion.\n3\n\n2","","","","Notations","and","background\nMost","","of","","the","","results","","here","","are","","valid","","for","","both","","base","","fieldsK=RandK=C,","","thus","","we\ndenoteKto","be","either","field","if","the","results","hold","for","both.","We","will","denoteK\nn×p\nthe","space\nof","matrices","ofn-rows","andp-columns","inK.","","We","will","denote","the","transposetto","be","the\nreal","transposeTif","the","base","fieldKis","real,","and","the","hermitian","transposeHif","the","base\nfieldKis","complex.","","If","the","base","field","isR,","the","notation","Tr\nR\nAdenotes","the","usual","trace\nTrAof","","a","","matrixA.","","","If","","the","","base","","field","","isC,","","Tr\nR\nAdenotes","","Re","TrA.","","","The","","(real)","","inner\nproduct","on","a","matrix","space","is","Trab\nT\nif","the","base","field","is","real,","and","Tr\nR\nab\nH\nif","the","base\nfield","is","complex.","","We","denote","by‖‖the","usual","Euclidean","norm.","","We","call","a","matrixAt-\nantisymmetric","ifA\nt\n+A=0,t-symmetric","ifA\nt\n=A.","","Define","Skew\nt,p\nto","be","the","space\nof","allp×pt-antisymmetric","matrices,","skew\nt\nA=\n1\n2\n(A−A\nt\n)to","be","the","anti-symmetrize\noperator.","","We","denote","thet-orthogonal","group","U\nt,p\nto","be","the","group","of","matrices","inK\np×p\nsuch","thatU\nt\nU=I\np\n,","thus","U\nT,p\nis","O(p),","the","real","orthogonal","group","and","U\nH,p\nis","the","unitary\ngroup","U(p).\nOn","a","Riemannian","manifold","M,","a","geodesicY(t)has","the","distance","minimizing","prop-\nerty","and","satisfies","the","geodesic","equation","of","the","form\n","̈\nY(t)+Γ(\n","̇\nY(t),\n","̇\nY(t))","=0,","whereΓ\ncould","be","defined","locally","(by","Christoffel","symbols)","or","globally","(by","a","Christoffel","function,\nsee","[4]).","If\n","̃\nYis","a","point","on","M","andηis","a","tangent","vector","at\n","̃\nY,","ifY(t)is","a","geodesic","on","M\nwithY(0)","=\n","̃\nYand\n","̇\nY(0)","=η,","we","denoteY(1)by","Exp\n","̃\nY\nη.","","Its","inverse","Log\n","̃\nY\nZdenotes\na","vectorηof","minimal","length","such","that","Exp\n","̃\nY\nη=Z.","","In","general,","Log","may","not","exist,\nand","may","not","be","unique.","","However,","as","Stiefel","and","its","quotient","manifolds","are","compact,\nthey","arecomplete,","and","there","is","at","least","one","geodesic","connecting","two","points","(the","Hopf-\nRinow","theorem","[19],","Theorem","16.17).","We","use","the","notation","Exp\nM\nto","make","explicit","the\nmanifold","M","under","consideration.","Thus","Exp\nSt\n,Exp\nGr\nand","Exp\nFg\ndenote","the","exponential\nmaps","on","the","Stiefel,","Grassmann,","and","flag","manifolds","(see","below).","Similarly,","we","use","the\nnotation","Log\nM\nfor","the","logarithm","map.\nWe","will","denote","by","St\nK,p,n\nthe","Stiefel","manifold","over","the","fieldK,","which","consists","of\nmatricesYinK\nn×p\nsatisfying","the","relationY\nt\nY=I.","","","Forn=p,","","St\nR,n,n\nis","O(n),","","but\nwe","will","focus","on","the","component","SO(n).","","The","corresponding","Grassmann","manifold","is\ndenoted","by","Gr\nK,p,n\n.","Flag","manifolds","will","be","reviewed","in","section","7.","We","use","the","notation\nJYKto","denote","the","equivalent","class","ofY(usually","an","element","of","the","Stiefel","manifold)","in\nthe","quotient","structure","on","the","Grassmann","or","flag","manifolds.\nFr\n","́\nechet","derivatives,","the","directional","derivatives","of","a","matrix","functionfat","pointAin\ndirectionEwill","be","denoted","by","L\nf\n(A,E).","From","the","works","[14,","15]","and","especially","[13],\nit","could","be","computed","very","effectively.","","From","our","perspective,","a","calculation","involving\nFr\n","́\nechet","derivatives","is","as","effective","computationally","as","a","closed-form","solution,","thus","we\n4\n\ncan","consider","the","gradient","of","the","objective","function","discussed","here","computable","in","closed-\nform.\nWe","will","denote","by","csr(x)the","entire","function","corresponding","to","cosx\n1/2\n,","and","ssr(x)\nthe","entire","function","corresponding","tox\n−1/2\nsinx\n1/2\n.","These","entire","functions","exist,","as","seen\nfrom","their","Taylor","series","expansions.","","They","will","be","used","to","give","analytic","formulas","for\ngeodesics","on","Grassmann","manifolds.","We","will","denote","by","I\nh,d\ntheR\nh×d\nmatrix\n[\nI\nd×d\n0\n(h−d)×d\n]\nwhenh≥d.\n3","","","","Geodesics","for","Stiefel","manifolds\nAs","noted,","we","will","be","working","with","matrix","manifolds","over","a","base","fieldK=RorC.","Let\nSt\nK,p,n\n⊂K\nn×p\nbe","the","Stiefel","manifold","of","matrices","satisfyingY\nt\nY=I\np\n,","letα\n0\n,α\n1\nbe\ntwo","positive","real","numbers","andY∈St\nK,p,n\n.","We","define","the","operator-valued","function\ngω=g\nY\nω:=α\n0\nω+(α\n1\n−α\n0\n)Y","Y\nt\nω(3.1)\nThis","gives","us","an","inner","product","Tr\nR\nω\nt\n1\n(g\nY\nω\n2\n)forω\n1\n,ω\n2\nin","the","ambient","spaceK\nn×p\n,\nparametrized","byY∈St\nK,p,n\n.","","A","tangent","vector","atYcould","be","considered","as","a","matrix\nη∈K\nn×p\nsuch","thatY\nt\nηist-antisymmetric.","","The","inner","product","induces","a","Riemannian\nmetric","on","St\nK,p,n\n.","","","The","caseα\n1\n=α\n0\ncorresponds","to","the","embedded","metric,","","the","case\nα\n1\n=\n1\n2\nα\n0\ncorresponds","to","the","canonical","metric,","both","defined","in","[4]","forK=R.","Matrices\nof","the","formω−Y","Y\nt\nωandY","Y\nt\nωare","eigenvectors","ofgwith","eigenvaluesα\n0\nandα\n1\n,\nrespectively.","Thusgis","positive","definite.","The","paper","[4]","provided","closed-form","geodesics\nfor","the","embedded","and","canonical","metrics","in","separate","formats.","We","generalize","both","results\nbelow:\nTheorem","1Letηbe","a","tangent","vector","toSt\nK,p,n\nat","a","point\n","̃\nY",".","","Let","A=\n","̃\nY\nt\nη.","","Let","Q","be\nan","orthogonal","basis","of","the","column","span","ofη−\n","̃\nY\n","̃\nY\nt\nη.","","Expressingη−\n","̃\nY\n","̃\nY\nt\nη=QR","in\nthis","basis.","Let","S\n0\n:=η\nt\nη=−A\n2\n+R\nt\nR","andα=α\n1\n/α\n0\n,","the","geodesic","equation","for","the\nmetricgω=α\n0\nω+(α\n1\n−α\n0\n)Y","Y\nt\nωin","eq.(3.1)is\n","̈\nY+Y\n","̇\nY\nt\n","̇\nY+2(1−α)(I\nn\n−Y","Y\nt\n)(\n","̇\nY\n","̇\nY\nt\n)Y=0(3.2)\nEach","equation","below","describes","the","geodesic","Y(t)with","Y(0)","=\n","̃\nY,\n","̇\nY(0)","=η:\nY(t)","=\n[\n","̃\nYη\n]\n{expt\n[\n(2α−1)A2(α−1)A\n2\n−S\n0\nI\np\nA\n]\n}\n[\nexp((1−2α)tA)\n0\n]\n(3.3)\n5\n\nY(t)","=","(\n","̃\nY","M(t)+QN(t))exp((1−2α)tA)with\n[\nM(t)\nN(t)\n]\n=expt\n[\n2αA−R\nt\nR0\n][\nI\np\n0\n]\n(3.4)\nProof:The","metric","defined","in","equations","(43)","of","[10]","corresponds","toα\n0\n=2,α\n1\n=\n1\nα+1\n,\nwhereαdefined","in","that","paper","corresponds","to\n1\n2α\n−1","in","our","notations.","Since","geodesics\nare","unchanged","by","metric","scaling,","eq.","(3.2)","follows","from","the","geodesic","equation","(64)","of\n[10].","","","(The","proof","in","[10]","extends","to","the","complex","case).","","","We","provided","an","alternative\nderivation","in","[11].\nSection","2.2.2","of","[4]","shows","a","derivation","of","eq.","(3.3)","for","the","caseα=1","(on","ideas","of\nRoss","Lippert).","We","show","it","extends","with","little","change","for","allα.","FromQR=","(I−\n","̃\nY\n","̃\nY\nt\n)η,\nwe","haveR\nt\nR=R\nt\nQ\nt\nQR=η\nt\n(I−\n","̃\nY\n","̃\nY\nt\n)η=S\n0\n−(−A)(A),","from","hereS\n0\n=−A\n2\n+R\nt\nR.\nFollowing","[4],","putA(t):=Y(t)\nt\n","̇\nY(t)(we","should","use","a","different","symbol","forA(t)to","be\nclear,","but","we","will","show","it","is","constant","shortly),","andS(t):=\n","̇\nY\nt\n","̇\nY,","henceS(0)","=S\n0\n.","Then,\n","̇\nA(t)","=\n","̇\nY(t)\nt\n","̇\nY(t)+Y(t)\nt\n","̈\nY(t)expands","to","(droppingt)\n","̇\nA(t)","=\n","̇\nY\nt\n","̇\nY−Y\nt\nY\n","̇\nY\nt\n","̇\nY−2(1−α)Y\nt\n(I\nn\n−Y","Y\nt\n)(\n","̇\nY\n","̇\nY\nt\n)Y=0\nwhere","we","have","used","the","geodesic","equation","to","expand\n","̈\nY,","","and","useY\nt\nY=I","to","reduce\nY\nt\n(I\nn\n−Y","Y\nt\n)to","","zero","","in","","the","","last","","equality.","","","Thus,A(t)is","","constant,","","and","","by","","the","","initial\nconditionA(t)","=Y\nt\nη=Aist-antisymmetric,\n","̇\nY\nt\n(t)Y(t)","=−Y\nt\n(t)\n","̇\nY(t)","=−A.","","Next,\nexpand\n","̇\nS(t)","=\n","̈\nY(t)\nt\n","̇\nY(t)+\n","̇\nY(t)\nt\n","̈\nY(t).","We","simplify\n","̈\nY(t)\nt\n","̇\nY(t)using","eq.","(3.2):\n","̇\nY(t)\nt\n","̈\nY(t)","=−\n","̇\nY(t)\nt\nY(t)\n","̇\nY(t)\nt\n","̇\nY(t)−2(1−α)\n","̇\nY(t)\nt\n(I\nn\n−Y","Y\nt\n(t))(\n","̇\nY(t)\n","̇\nY(t)\nt\n)Y(t)\n=AS+2(1−α)SA+2(1−α)(−A)A(−A)","=AS+2(1−α)SA+2(1−α)A\n3\nThus\n","̇\nS(t)","=\n","̇\nY(t)\nt\n","̈\nY(t)","+","(\n","̇\nY(t)\nt\n","̈\nY(t))\nt\n=","(2α−1)(AS−SA),","where","we","have","used","the\nfact","that(A\n3\n)\nt\n+A\n3\n=0.","ThereforeS(t)","=e\n(2α−1)tA\nS\n0\ne\n(1−2α)tA\n.","Equation","3.2","becomes:\n","̈\nY+Ye\n(2α−1)tA\nS\n0\ne\n(1−2α)tA\n+2(1−α)(−\n","̇\nY","A+Y","A\n2\n)","=0\n","̈\nY","e\n(2α−1)tA\n+Ye\n(2α−1)tA\nS\n0\n+2(1−α)(−\n","̇\nY","A+Y","A\n2\n)e\n(2α−1)tA\n=0(3.5)\nThe","last","equation","implies:\nd\ndt\n(Ye\n(2α−1)At\n,\n","̇\nY","e\n(2α−1)tA\n)","=\n(Ye\n(2α−1)tA\n,\n","̇\nY","e\n(2α−1)tA\n)\n[\n(2α−1)A−S\n0\n+(2α−2)A\n2\nIA\n]\n6\n\nFrom","here,","eq.","(3.3)","follows.","Theorem","2.1","of","[4]","is","a","special","case","of","eq.","(3.4)","forα=\n1\n2\n.\nTo","prove","it,","setZ(t)","=Y(t)e\nt(2α−1)A\n,","then","take","time","derivatives:\n","̇\nY(t)exp(2α−1)tA=\n","̇\nZ(t)−(2α−1)Z(t)A\n","̈\nY(t)exp(2α−1)tA=\n","̈\nZ(t)−2(2α−1)\n","̇\nZ(t)A+(2α−1)\n2\nZA\n2\nWithS\n0\n=η\nt\nη=−A\n2\n+R\nt\nR,","the","left-hand-side","of","eq.","(3.5)","becomes:\n","̈\nZ−2(2α−1)\n","̇\nZ(t)A+Z(2α−1)\n2\nA\n2\n+Z(−A\n2\n+R\nt\nR)+\n2(1−α)(−(\n","̇\nZ(t)−Z(t)(2α−1)A)A+ZA\n2\n)","=0\nWe","collect","the","coefficients","for\n","̇\nZas−2(2α−1)−2(1−α)","=−4α+2−2+2α=−2α\nand","forZas(2α−1)\n2\nA\n2\n+(−A\n2\n+R\nt\nR)+2(1−α)(2α)A\n2\n=R\nt\nR,","hence","the","equation\nforZis\n","̈\nZ−2α\n","̇\nZ+R\nt\nR=0\nFrom","eq.","(3.3),Z(t)","=\n","̃\nY","M\n1\n(t)+ηM\n2\n(t)for","some","functionM\n1\n,M\n2\n,","so\nZ(t)","=\n","̃\nY(M\n1\n(t)+\n","̃\nY\nt\nηM\n2\n)+(I−\n","̃\nY\n","̃\nY\nt\n)ηM\n2\n(t)","=\n","̃\nY","M(t)+QRM\n2\n=\n","̃\nY","M(t)+QN(t)\nBy","linearity,","bothM(t)","=\n","̃\nY\nt\nZ(t)andN(t)","=Q\nt\nZ(t)satisfy","the","same","equation","asZ.\nThe","initial","conditions","areM(0)","=I\np\n,N(0)","=0,\n","̇\nM(0)","=A,\n","̇\nN(0)","=R,","so","eq.","(3.4)","gives\nus","the","solution.","","Ifη−\n","̃\nY\n","̃\nY\nt\nηis","of","full","rank,","the","thinQRdecomposition","satisfies","the\ncondition","of","the","theorem","asQ=","(η−\n","̃\nY\n","̃\nY\nt\nη)R\n−1\n.","","In","the","degenerate","case,","we","use","an\nSVD","decomposition","to","determine","the","rank,","andQhas","fewer","columns","thanYdoes.ut\nIn","our","notations,","the","geodesic","formula","in","equation","(75)","of","[10]","could","be","written","as\nY(t)","=exp(t((2α−2)\n","̃\nY\n","̃\nY\nT\nη\n","̃\nY\nt\n−\n","̃\nYη\nt\n+η\n","̃\nY\nt\n))exp(t(1−2α)\n","̃\nY\n","̃\nY\nt\nη\n","̃\nY\nt\n)\n","̃\nY(3.6)\nWithout","the","help","of","the","geodesic","equation,","it","is","not","apparent","that","this","formula","is","equiv-\nalent","to","eq.","(3.3)","and","eq.","(3.4).","","As","noted,","it","requires","computing","exponentials","of","two\nn×nmatrices.\n4","","","","Grassmann","manifolds","and","geodesics\nOn","the","unit","sphereS\nn\n⊂R\nn+1\n,","the","exponential","map","Exp\n","̃x\nηat","","","̃x∈S\nn\nis","given","by","the\nsimple","formulax\n1\n=cos‖η‖","̃x+\nsin‖η‖\n‖η‖\nη(which","reflects","the","fact","that","the","angle","between\nx\n1\nand","","","̃xis‖η‖).","This","formula","could","be","written","asx\n1\n=csr(η\nT\nη)","̃x+ssr(η\nT\nη)η,","with\n7\n\ncsrz=cosz\n1/2\nand","ssrz=z\n−1/2\nsinz\n1/2\n,","understood","as","entire","functions","as","mentioned\nin","section","2.","This","formula","implies","cos‖η‖=","̃x\nt\nx\n1\n,","from","here","the","logarithm","map","for","the\nsphere","is","given","by","Log\n","̃x\nx\n1\n=","(x\n1\n−","̃x(","̃x\nt\nx\n1\n))(1−(","̃x\nt\nx\n1\n)\n2\n)\n−1/2\narccos(","̃x\nt\nx\n1\n).\nAs","a","corollary","of","theorem","1,","we","provide","similar","formulas","for","horizontal","geodesics\nand","logarithm","on","the","Grassmann","manifold","Gr\nK,p,n\n,","considered","as","a","quotient","of","St\nK,p,n\n.\nFor","other","approaches","to","Grassmann","geodesics,","see","[20,","21].\nRecall","from","[4],","the","Grassmann","manifold","Gr\nK,p,n\ncould","be","considered","as","a","quotient\nof","the","Stiefel","manifold","St\nK,p,n\nunder","the","action","of","thet-orthogonal","group","U\nt,p\nby","right\nmultiplication(Y,U)7→Y","UforY∈St\nK,p,n\n,U∈U\nt,p\n.","We","represent","the","equivalent","class\nofYbyJYK,","and","the","image","of","a","tangent","vectorηunder","this","quotient","asJηK.","A","tangent\nvectorηon","the","Stiefel","manifold","is","horizontal","with","respect","to","this","action","ifY\nt\nη=0.\nSince","","csrzand","","ssrzare","","entire","","functions,","","csrXand","","ssrXare","","defined","","for","","any","","square\nmatrixX.","","Also,","if","we","define(1−x\n2\n)\n−1/2\narccosxto","be","1","atx=1,","we","can","addx=1\nto","its","domain","to","get","a","function","on","the","interval[0,1],","","which","is","right-continuous","at","1.\nWith","this","convention,","we","can","define(I\np\n−Σ\n2\n)\n−1/2\narccosΣfor","a","diagonal","matrixΣwith\ndiagonal","entries","in[0,1].\nProposition","1Letcsrz","andssrz","be","the","analytic","continuations","ofcosz\n1/2\nand","z\n−1/2\nsinz\n1/2\n.\nAt","a","point\n","̃\nY","","on","the","Stiefel","manifoldSt\nK,p,n\n,","for","a","tangent","vectorηsuch","that\n","̃\nY\nt\nη=0,\nthe","Stiefel","exponential","map","is","given","by\nExp\nSt\n","̃\nY\nη=\n","̃\nYcsrη\nt\nη+ηssrη\nt\nη=\n","̃\nYcos(η\nt\nη)\n1/2\n+η{(η\nt\nη)\n−1/2\nsin(η\nt\nη)\n1/2\n}(4.1)\nThe","classJExp\nSt\n","̃\nY\nηKrepresents","the","Grassmann","exponentialExp\nGr\nJ\n","̃\nYK\nJηK.","Conversely,","for\n","̃\nY","","and","Z","inSt\nK,p,n\n,","let\n","̃\nY\nt\nZ=UΣV","","be","an","SVD","decomposition","of\n","̃\nY\nt\nZ∈K\np×p\n.","Set\nη=","(Z−\n","̃\nY\n","̃\nY\nt\nZ)V\nt\n(I\np\n−Σ\n2\n)\n−1/2\narccosΣU\nt\n(4.2)\nthenηis","","a","","horizontal","","vector","","on","","the","","Stiefel","","manifold","","andExp\nSt\n","̃\nY\nη=ZV\nt\nU\nt\n.","","","Thus,\nExp\nSt\n","̃\nY\nηand","Z","","represent","the","same","element","in","the","Grassmann","manifoldGr\nK,p,n\n.","","The\nlength","ofηis(α\n0\nTr\nR\narccos\n2\nΣ)\n1/2\n,","which","is","the","geodesic","distance","between","the","equiv-\nalent","","classesJ\n","̃\nYKandJZKof\n","̃\nY","","and","","Z,","","henceηis","","the","","lift","","of","","a","","geodesic","","logarithm\nLog\nGr\nJ\n","̃\nYK\nJZKofGr\nK,p,n\nto\n","̃\nY",".\n8\n\nProof:For","a","horizontal","vector,A=\n","̃\nY\nt\nη=0,","and","expand","expt\n[\n0−S\nI0\n]\nin","eq.","(3.3)\nY(t)","=\n[\n","̃\nYη\n]\n{\n∞\n∑\nn=0\n(−1)\nn\n(2n)!\nt\n2n\n[\nS\nn\n0\n0S\nn\n]\n+\n∞\n∑\nn=0\n(−1)\nn\n(2n+1)!\nt\n2n+1\n[\n0−S\nn+1\nS\nn\n0\n]\n}\n[\nI\np\n0\n]\n=\n[\n","̃\nYη\n]\n{\n∞\n∑\nn=0\n(−1)\nn\n(2n)!\nt\n2n\n[\nS\nn\n0\n]\n+\n∞\n∑\nn=0\n(−1)\nn\n(2n+1)!\nt\n2n+1\n[\n0\nS\nn\n]\n}=\n","̃\nY\n∞\n∑\nn=0\n(−1)\nn\n(2n)!\nt\n2n\nS\nn\n+η\n∞\n∑\nn=0\n(−1)\nn\n(2n+1)!\nt\n2n+1\nS\nn\nwhereS=η\nt\nη,","which","gives","us","eq.","(4.1).","","Now,","assumingη\n1\nis","horizontal","such","that\nExp\nSt\n","̃\nY\nη\n1\n=ZWwithW\nt\nW=I\np\n,","","(Exp\nSt\n","̃\nY\nη\n1\nconnects\n","̃\nYwith","","an","","element","","in","","the","","orbit\nofZ).","","","Multiply","","both","","sides","","of","","eq.","","(4.1)","","by\n","̃\nY\nt\nand","","use","","the","","horizontal","","condition,","","we\nhave","","cos(η\nt\n1\nη\n1\n)\n1/2\n=\n","̃\nY\nt\nZW,","","thus\n","̃\nY\nt\nZ=cos(η\nt\n1\nη\n1\n)\n1/2\nW\nt\nis","","a","","polar","","decomposition.\nThis","implies","cos\n2\n{(η\nt\n1\nη\n1\n)\n1/2\n}=\n","̃\nY\nt\nZZ\nt\n","̃\nY=UΣ\n2\nU\nt\nif\n","̃\nY\nt\nZ=UΣVis","an","SVD","decom-\nposition.","","","From","here,","","eigenvalues","of(η\nt\n1\nη\n1\n)\n1/2\nmust","be","diagonal","entries","of","arccosΣ\nor","2π−arccosΣ,","plus","multiples","of","2π,","with","arccosΣis","the","smallest","possible","choice.\nHence,(α\n0\nTr\nR\narccos\n2\nΣ)\n1/2\nis","a","lower-bound","of","geodesic","lengths","which","we","will","show\nis","attainable.","The","analysis","also","shows","if\n","̃\nY\nt\nZis","of","full","rank,","the","polar","decomposition","is\nunique,","thus","both","the","alignment","matrixWand","csrη\nt\nηare","unique.","","In","that","case,","if","the\nminimal","length(α\n0\nTr\nR\narccos\n2\nΣ)\n1/2\nis","attainable,","all","entries","of","arccosΣare","in(0,π/2),\nso","ssrη\nt\nηis","invertible","and","we","can","solve","for","at","most","oneηfrom","eq.","(4.1),","thus,","length-\nminimizing","geodesics","between\n","̃\nYandZ,","if","exist,","must","be","unique.","","If","an","eigenvalue","of\narccosΣisπ/2","we","may","have","more","than","one","length-minimizing","geodesics.\nLet","us","prove","eq.","(4.2)","gives","us","a","length","minimizing","geodesic.","","Direct","substitution\nshows\n","̃\nY\nt\nη=0.","","SinceΣis","diagonal,","elementwise","functions","ofΣcommute,","together\nwith(Z−\n","̃\nY\n","̃\nY\nt\nZ)\nt\n(Z−\n","̃\nY\n","̃\nY\nt\nZ)","=I\np\n−Z\nt\n","̃\nY\n","̃\nY\nt\nZ,","eq.","(4.2)","implies\nη\nt\nη=U(I\np\n−Σ\n2\n)\n−1/2\narccosΣV(I\np\n−Z\nt\n","̃\nY\n","̃\nY\nt\nZ)V\nt\n(I\np\n−Σ\n2\n)\n−1/2\narccosΣU\nt\n=U(I\np\n−Σ\n2\n)\n−1\narccos\n2\nΣU\nt\n−U(I\np\n−Σ\n2\n)\n−1/2\narccosΣV","Z\nt\n","̃\nY\n","̃\nY\nt\nZV\nt\n(I\np\n−Σ\n2\n)\n−1/2\narccosΣU\nt\nUsing\n","̃\nY\nt\nZ=UΣV,","henceZ\nt\n","̃\nY\n","̃\nY\nt\nZ=V\nt\nΣ\n2\nV,","the","second","term","is\nU(I\np\n−Σ\n2\n)\n−1/2\n(arccosΣ)V","V\nt\nΣ\n2\nV","V\nt\n(I\np\n−Σ\n2\n)\n−1/2\n(arccosΣ)U\nt\n=U(I\np\n−Σ\n2\n)\n−1\nΣ\n2\narccos\n2\nΣU\nt\nThusη\nt\nη=U(I\np\n−Σ\n2\n)\n−1\n(I\np\n−Σ\n2\n)arccos\n2\nΣU\nt\n=Uarccos\n2\nΣU\nt\n,","so","arccosΣ=U\nt\n(η\nt\nη)\n1/2\nU\nand(I\np\n−Σ\n2\n)\n1/2\n=U\nt\nsin(η\nt\nη)\n1/2\nU.","Substitute","these","expressions","to","eq.","(4.1)","to","evalu-\n9\n\nate:\nY(1)","=\n","̃\nY","UΣU\nt\n+(Z−\n","̃\nY\n","̃\nY\nt\nZ)V\nt\n(I\np\n−Σ\n2\n)\n−1/2\narccosΣU\nt\n(η\nt\nη)\n−1/2\nsin(η\nt\nη)\n1/2\n=\n","̃\nY","UΣU\nt\n+(Z−\n","̃\nY\n","̃\nY\nt\nZ)V\nt\nU\nt\n(sin(η\nt\nη)\n1/2\n)\n−1\nUarccosΣU\nt\n(η\nt\nη)\n−1/2\nsin(η\nt\nη)\n1/2\n=\n","̃\nY","UΣV","V\nt\nU\nt\n+(Z−\n","̃\nY\n","̃\nY\nt\nZ)V\nt\nU\nt\nThe","last","expression","is","reduced","to\n","̃\nY\n","̃\nY\nt\nZV\nt\nU\nt\n+(Z−\n","̃\nY\n","̃\nY\nt\nZ)V\nt\nU\nt\n=ZV\nt\nU\nt\n.","ThusY(1)","=\nZV\nt\nU\nt\n,","representing","the","same","Grassmann","element","asZ.","The","length","ofηis(α\n0\nTr\nR\nη\nt\nη)\n1/2\n=\n(α\n0\nTr\nR\narccos\n2\nΣ)\n1/2\n.ut\nWe","note","for","the","casep=1,","St\nR,p,n\nis","the","real","sphere,","the","Grassmann","manifold","is","the\nprojective","space,Σ=|\n","̃\nY\nt\nZ|.","The","geodesic","above","connects\n","̃\nYto","sgn(\n","̃\nY\nt\nZ)Z.","In","this","case,\neq.","(4.2)","is(Z−\n","̃\nY\n","̃\nY\nt\nZ)sgn(\n","̃\nY\nt\nZ)(1−Σ\n2\n)\n−1/2\narccos|\n","̃\nY\nt\nZ|,","versus","the","logarithm","map","of\nthe","sphere(Z−\n","̃\nY\n","̃\nY\nt\nZ)(1−Σ\n2\n)\n−1/2\narccos(\n","̃\nY\nt\nZ).","Numerically,","to","evaluate","eq.","(4.1)","we\ncan","evaluate","the","entire","functions","on","the","eigenvalues","of","the","symmetric","matrixη\nt\nη.","","To\nevaluate","eq.","(4.2)","we","only","need","one","SVD","decomposition","of\n","̃\nY\nt\nZ.","","We","benefited","from\nreading","[21].\n5","","","","Fr\n","́\nechet","derivatives\nRecall","[13,","14,","15]","iff(A)","=\n∑\n∞\ni=0\nf\ni\nA\ni\nis","a","power","series","with","scalar","coefficient","andA\nis","a","square","matrix,","then","the","Fr\n","́\nechet","derivative","L\nf\n(A,E)","=lim\nh→0\n1\nh\n(f(A+hE)−f(A))\nin","directionEcould","be","expressed","as\nL\nf\n(A,E)","=\n∞\n∑\ni=0\nf\ni\n∑\na+b=i−1\nA\na\nEA\nb\nunder","standard","convergence","conditions,","","thus","for","entire","functions","it","always","exists.","","It\nis","known","that","L\nf\n(A,E)andf(A)could","be","computed","together","with","a","computational\ncomplexity","","of","","around","","three","","times","","the","","complexity","","off(A).","","","There","","exist","","routines","","to\ncompute","Fr\n","́\nechet","derivatives","of","the","exponential","function","in","open","source","or","commer-\ncial","package,","for","example,","the","functionexpm\nfrechetin","SciPy","[22].","","To","explain","why\nwe","","prefer","","Fr\n","́\nechet","","derivatives,","","consider","","the","","simple","","case","","of","","the","","directional","","derivative\nof","","the","","exponential","","function.","","","For","","a","","matrix","","functionX(t),","","the","","well-known","","formula\nd\ndt\nexpX(t)","=expX(t)\n1−exp(−ad\nX(t)\n)\nad\nX(t)\ndX(t)\ndt\n(Section","3.2","of","[19])","implies,","forX(t)","=A+\ntE,","","L\nexp\n(A,E)","=expA\n∑\n∞\nn=0\n(−1)\nn\n(n+1)!\nad\nn\nA\nE(where","ad\nA\nE=AE−EA).","","It","is","difficult","to\nevaluate","this","formula","directly.","","On","the","other","hand,","the","library","functionexpmfrechetis\neffective","computationally.","","The","computational","cost","will","beO(p\n3\n),","wherepis","the","size\n10\n\nofA(it","is","also","dependent","on","the","logarithm","of","the","eigenvalues","ofA).","","In","the","cases","of\nsymmetric","and","antisymmetric","matrices,","an","eigenvalue","decomposition","or","a","Schur","de-\ncomposition","may","improve","the","sparsity","of","the","operations.\nThe","following","lemma","(which","is","likely","known,","but","we","could","not","find","a","reference)\nshows","Fr\n","́\nechet","derivatives","are","useful","to","compute","matrix","gradient","of","power","series,\nLemma","1Let","","f","","be","an","analytic","function","near","A","andTr(CL\nf\n(A,E)D)is","well-formed\nfor","some","matrices","C,E,D.","Then\nTr{CL\nf\n(A,E)D}=Tr{L\nf\n(A,DC)E}(5.1)\nProof:From","the","analytic","assumption","we","only","need","to","prove","this","forf(A)","=A\nn\n.","This\nfollows","from\n∑\na+b=n−1\nTr(CA\na\nEA\nb\nD)","=\n∑\nb+a=n−1\nTr(A\nb\nDCA\na\nE).ut\n6","","","","Computing","the","logarithm","map","for","the","Stiefel","mani-\nfold\n6.1","","","","Main","algorithm\nWe","now","turn","to","the","problem","of","computing","the","logarithm","map","on","the","Stiefel","manifold.\nFrom","this","section","on","we","will","work","with","the","base","fieldK=R.","","We","expect","the","complex\ncase","could","be","tackled","similarly.","","We","benefited","from","reading","[7,","6,","8]","while","preparing\nthis","section.\nFor","two","elements\n","̃\nY,Z∈St\nR,p,n\n,","our","approach","is","to","solve","eq.","(3.4)","for","the","tangent\nvectorη,","expressed","asη=\n","̃\nY","A+QRin","terms","of","the","matricesA=\n","̃\nY\nT\nηandR=Q\nT\nη.\nLet\nˆ\nA=\n[\n2αA−R\nT\nR0\n]\n.","Equation","(3.4)","could","be","written","in","the","following","form\nY(t)","=","[\n","̃\nY","Q](expt\nˆ\nA)I\np+k,d\nexp((1−2α)tA)(6.1)\nWe","seeY(1)is","in","the","column","span","of\n","̃\nYandQ.","Here,k≤pis","the","number","of","columns","of\nQ.","On","the","other","hand,","for","any(Q,A,R)with","compatible","dimension","such","that\n","̃\nY\nt\nQ=0\nwithA\nt\n+A=0","","andQ\nt\nQ=I\nk\nfor","","an","","integerk,","","then\n","̃\nY","A+QRis","","a","","tangent","","vector\nand","eq.","(6.1)","describes","a","geodesic","with\n","̇\nY(0)","=\n","̃\nY","A+QR.","","We","note","the","length","ofηis\n(α\n0\nTr\nR\nR\nt\nR−α\n1\nTr\nR\nA\n2\n)\n1/2\n.\nWe","now","show","that,","given\n","̃\nYandZ,","ifQis","such","thatW=","(\n","̃\nY|Q)is","an","orthogonal\nbasis","","of","","the","","column","","span","","of\n","̃\nYandZ,","","then","","there","","is","","a","","geodesic","","connecting\n","̃\nYandZ\n11\n\nsuch","that\n","̇\nY(0)","=ηis","in","the","span","ofW.","","IfYis","in","the","intersection","of","the","span","ofW\nand","St\nR,p,n\n,","thenY=WVforV∈R\n(k+p)×p\n.","","Next,Y\nT\nY=I\np\nimpliesV\nT\nV=I\np\n,","thus,\nthis","intersection","is","itself","a","Stiefel","manifold.","","The","tangent","vectors","of","this","small","Stiefel\nmanifold","are","of","the","formη=Wφ,","withV\nT\nφis","antisymmetric,","and","the","induced","metric\nisα\n0\nTrη\nT\nη+(α\n1\n−α\n0\n)Trη\nT\nY","Y\nT\nη=α\n0\nTrφ\nT\nφ+(α\n1\n−α\n0\n)Trφ\nT\nV","V\nT\nφ.","Since","the\nintersection","Stiefel","manifold","is","complete,","there","is","a","geodesic","in","it,","in","the","induced","metric,\nconnecting\n","̃\nYandZ.","","From","the","expression","of","the","induced","metric,","the","geodesic","in","the\nsmall","manifold","is","a","geodesic","in","the","full","Stiefel","manifold.\nAs","","the","","exponential","","map","","is","","injective","","near","","0,","","forZclose","","enough","","to\n","̃\nY,","","the","","above\nanalysis","shows","we","can","assumeQis","a","complement","basis","of\n","̃\nYin","the","column","span","of\n","̃\nY\nandZ.","Therefore,","we","will","fix","an","orthogonal","basisQof","the","column","span","ofZ−\n","̃\nY\n","̃\nY\nT\nZ.\nWe","solve","forAandRby","minimizing","the","functionF(A,R)","=1/2‖Y\n(A,R)\n−Z‖\n2\nF\n−pwith\nY\n(A,R)\n=Y(1)given","by","eq.","(3.4),","and‖‖\nF\nis","the","Frobenius","norm.","","Since","the","manifold\nis","complete,","there","is","always","a","geodesic","connecting\n","̃\nYandZ,","thus","a","minimum","always\nexists","with","(global)","minimal","value−p.","Our","algorithm","will","be","local,","so","it","may","return","a\nvalue","greater","than−p,","and","even","if","the","minimum","value","is−p,","the","geodesic","found","may\nnot","be","of","minimal","length.","","However,","ifZis","close","enough","to\n","̃\nY(within","its","injectivity\nradius),","the","Riemannian","logarithm","is","unique,","and","theηfrom","this","approach","gives","us\nthe","logarithm","map","and","geodesic","distance.","As","we","will","see","in","section","6.2,","this","objective\nfunction","works","quite","adequately","for","our","purpose.","","The","main","idea","is","the","gradient","ofF\ncould","be","computed","by","Fr\n","́\nechet","derivatives.\nTheorem","2Let\n","̃\nY","","and","Z","be","two","points","on","the","Stiefel","manifoldSt\nR,p,n\nand","Q∈R\nn×k\nis\nan","orthogonal","basis","of","the","column","span","of","Z−\n","̃\nY\n","̃\nY\nT\nZ","(k≤p","is","its","rank).","","For(A,R)∈\nSkew\nT,p\n×R\np×k\n,","let","Y(t)be","the","geodesic","starting","at\n","̃\nY","","with\n","̇\nY(0)","=η:=\n","̃\nY","A+QR","as\nin","theorem","1.","Define","the","functionF=F(A,R):=","(1/2)Tr((Y(1)−Z)\nT\n(Y(1)−Z)−p.\nWithα:=\nα\n1\nα\n0\n,\nˆ\nA:=\n[\n2αA−R\nT\nR0\n]\n∈R\n(p+k)×(p+k)\n,I\np+k,p\n:=\n[\nI\np\n0\nk×p\n]\n,","we","have\nF(A,R)","=−TrZ\nT\nY(1)","=−TrZ\nT\n[\n","̃\nY","Q]exp\nˆ\nAI\np+k,p\nexp(1−2α)A(6.2)\nSet\n","̊\nL:=L\nexp\n((1−2α)A,Z\nT\n[\n","̃\nY","Q](exp\nˆ\nA)I\np+k,p\n),\nˆ\nL=\n[\nˆ\nL\n11\nˆ\nL\n12\nˆ\nL\n21\nˆ\nL\n22\n]\n:=L\nexp\n(\nˆ\nA,I\np+k,p\nexp(1−\n2α)A[\n","̃\nY","Q])where","the","block","structure","of\nˆ\nL","is","defined","mirroring","that","of\nˆ\nA,","then","the","gra-\ndient∇F(A,R)","=","(∇\nA\nF(A,R),∇\nR\nF(A,R))ofFis","given","by\n∇\nA\nF=","(1−2α)skew\nT\n","̊\nL+2αskew\nT\n(\nˆ\nL\n11\n)\n∇\nR\nF=\nˆ\nL\n21\n−\nˆ\nL\nT\n12\n(6.3)\n12\n\nProof:Expanding","the","formula","forF(A,R),","using","the","fact","thatY(1)\nT\nY(1)","=I\np\n,Z\nT\nZ=\nI\np\nwe","haveF(A,R)","=−TrZ\nT\nY(1),","then","we","can","apply","eq.","(6.1)","to","expandF(A,R).","The\ndirectional","derivative","ofFin","the","direction(∆A,∆R)at(A,R),","with∆A∈Skew\nT\npand\n∆R∈R\np×k\nis\n−Tr\n[\nZ\nT\n","̃\nYZ\nT\nQ\n]\nL\nexp\n(\nˆ\nA,\n[\n2α∆A−∆R\nT\n∆R0\n]\n)\n[\nexp(1−2α)A\n0\nk×p\n]\n−\n(1−2α)TrZ\nT\n[\n","̃\nY","Q](exp\nˆ\nA)I\np+k,p\nL\nexp\n(A,∆A)","=\n−Tr","L\nexp\n(\nˆ\nA,\n[\nexp(1−2α)A\n0\nk×p\n]\n[\nZ\nT\n","̃\nYZ\nT\nQ\n]\n)\n[\n2α∆A−∆R\nT\n∆R0\n]\n−\n(1−2α)Tr","L\nexp\n(A,Z\nT\n[\n","̃\nY","Q](exp\nˆ\nA)I\np+k,p\n)∆A\nHere,","we","applied","matrix","derivative","rules","and","lemma","1.","","The","last","expression","simplifies\nto−Tr{2α\nˆ\nL\n11\n∆A+\nˆ\nL\n12\n∆R}+Tr\nˆ\nL\n21\n∆R\nT\n−(1−2α)Tr\n","̊\nL∆A.","","As∆Ais","antisymmetric,\nwe","need","to","anti-symmetrize","the","corresponding","terms","for","the","gradient,","which","gives","us\neq.","(6.3).ut\nNote","that","for","the","case","of","the","canonical","metricα=\n1\n2\n,","we","do","not","need","to","compute","the\nexp(1−2α)Ain","the","expression","forF(A,R)and\n","̊\nLdoes","not","appear","in","the","gradient.\nˆ\nLhas\nthe","simpler","form","of","L\nexp\n(\nˆ\nA,I\np+k,p\n[\n","̃\nY","Q])and","is","the","only","matrix","needed","for","the","gradient.\nWe","","can","","identify","","the","","search","","space","","ofAandRwithR\np(p−1)/2+pk\n.","","","To","","minimize\nF(A,R),","we","call","a","trust-region","solver,","specifically","SciPy","[22]trust-krylovsolver","in","the\nscipy.optimize","module,","with","the","objective","set","toFdefined","by","eq.","(6.2),","the","Jacobian","set\nto∇F(A,R)in","eq.","(6.3)","and","an","approximate","the","Hessian","product","by\n1\nh\n(∇F(A+hξ\nA\n,R+\nhξ\nR\n)−∇F(A,R)),","where","we","useh=10\n−8\n.","Since","the","solver","expects","a","vector,","we","wrap\nthe","initial","guess,","the","variables","for","the","objective","function,","the","Jacobian,","the","Hessian","as\nvectors,","then","unwrap","these","vectors","inside","the","functions","into","pairs","of","matrices(A,R)’s\nto","evaluate.","","Finally,","we","unwrap","the","solution","vector","to","recover","the","optimal","pair(A,R)\nand","the","optimal","vectorη=\n","̃\nY","A+QR.\nThe","initial","tangent","direction","is","the","projectionZ−\n1\n2\n(\n","̃\nY","Z\nT\n","̃\nY+\n","̃\nY\n","̃\nY\nT\nZ).","","From","here,\nthe","corresponding","values","forAandRareA\n0\n=\n1\n2\n(\n","̃\nY\nT\nZ−Z\nT\n","̃\nY)andR\n0\n=Q\nT\nZ.","","With\nthese","initial","values,","the","geodesic","logarithm","on","the","Stiefel","manifold","with","metrics","param-\neterized","by(α\n0\n,α\n1\n)could","be","computed","quite","effectively.\nFor","testing","purposes,","we","will","setα\n0\n=1and","setα\n1\n=α>0.","We","have","tested","the\nroutine","for","different","values","ofα,nandpand","find","the","routine","is","quite","robust.","","While\nwe","have","not","enforced","the","length","minimizing","condition,","we","find","the","logarithm,","if","found,\nmostly","matches","the","generating","tangent.","","","ForZclose","enough","(for","example","0.5π,","","for\n13\n\ndist","(π)α#Iteration#Evals%Succ%Improve%Not","worse\n0.500.104.24/3.4871.42/65.94100/1000/0100/100\n0.500.504.40/3.1270.36/55.32100/1000/0100/100\n0.501.003.98/2.8061.02/50.36100/1000/0100/100\n0.501.204.00/2.9862.28/56.42100/1000/0100/100\n0.990.1012.48/12.20266.64/260.0696/9013/1196/96\n0.990.5013.26/12.86308.86/315.2072/720/042/40\n0.991.007.16/7.16151.02/153.0698/940/0100/98\n0.991.209.24/8.02191.44/164.4692/940/096/94\n1.300.109.42/7.98183.90/165.4098/9644/4498/98\n1.300.506.58/5.60122.72/102.4498/10041/41100/100\n1.301.007.40/7.30152.90/156.0494/9419/1994/98\n1.301.208.66/8.56177.74/184.7294/9215/1590/90\nTable","1:","Logarithm","calculation","for","differentαand","distance","for","St\nR,2,4\n.","The","table","com-\npares","two","initializing","schemes,A\n0\n=0,R\n0\n=0","(left)","andA\n0\n,R\n0\nare","from","the","projection\nofZ−\n","̃\nYto","the","tangent","space","of\n","̃\nY(right).","","Distance","to","the","initial","point","is","expressed","in\na","multiple","ofπ.","Number","of","calculations","in","the","trust-region","algorithm","is","weighted,","with\nweights","for","function,","jacobian","and","Hessian","evaluations","are","1,","2,","4","respectively.","The","last\ntwo","columns","show","if","the","length","of","the","logarithm","vector","found","is","improved","versus","the\ngenerating","length","(a","positive","number","on","the","%Improve","column),","or","worse","(less","than\n100%","on","the","%Not","worse","column).\nα\n0\n=1)","to","the","original\n","̃\nY,","we","almost","always","have","convergence.","","Even","with","points","as\nfar","as","1.5πwe","still","often","get","convergence.","","The","rate","of","convergence","is","dependent","on\nthe","distance","between\n","̃\nYandZ.","","We","will","summarize","the","numerical","results","to","show","the\nmethod","is","robust","for","different","values","ofα,","as","well","as","dimensions","of","Stiefel","manifold,\nthen","will","analyze","the","Hessian","in","several","scenarios","to","show","the","method","is","consistent","with\nproperties","of","the","logarithm","map.\n6.2","","","","Numerical","results","of","the","Logarithm","map","for","Stiefel","manifolds\nand","discussion\nWe","present","in","table","1","and","table","2","the","results","for","St\nR,2,4\nand","St\nR,40,1000\n.","","For","each","dis-\ntance","in","the","ladder(0.5π,0.99π,1.3π),","we","pickα\n0\n=1","and","four","values","ofα=α\n1\n/α\n0\nat(0.1,0.5,1.0,1.2).","","From","a","given","initial","point,","we","generate","50","tangent","vectors","with\nlength","equal","to","the","distance","and","apply","the","exponential","map","to","create","50","ending","points\nfor","each","distance","and","eachα,","then","call","our","logarithm","routine","implementing","the","algo-\nrithm","in","section","6.1.","","Thus,","we","can","compare","the","logarithm","to","the","generating","tangent\nvector.","","From","the","second","column","on,","the","tables","tabulate","the","results","of","two","choices","of\ninitial","values,","atη\n0\n=0,","and","atη\n0\nequal","to","the","projection","ofZ−\n","̃\nYto","the","tangent","space\n14\n\ndist","(π)α#Iteration#Evals%Succ%Improve%Not","worse\n0.500.103.92/1.96154.22/36.26100/1000/0100/100\n0.500.503.00/2.0040.00/38.52100/1000/0100/100\n0.501.003.00/1.0036.00/14.00100/1000/0100/100\n0.501.203.00/1.0040.00/18.00100/1000/0100/100\n0.990.105.00/3.007638.56/686.96100/1000/0100/100\n0.990.504.00/3.0055.00/52.00100/1000/0100/100\n0.991.003.00/1.0036.00/14.00100/1000/0100/100\n0.991.204.00/2.0051.00/29.00100/1000/0100/100\n1.300.105.00/3.0086.00/56.00100/1000/0100/100\n1.300.505.00/3.0074.00/52.00100/1000/0100/100\n1.301.004.00/2.0047.00/48.04100/1000/0100/100\n1.301.205.00/2.0019102.00/29.00100/1000/0100/100\nTable","2:","","Logarithm","calculation","for","different","alpha","and","distance","for","St\nR,40,1000\non","two\ninitialization","schemes\nof\n","̃\nY.","The","reported","data","include","the","number","of","trust-region","iterations,","a","weighted","num-\nber","of","evaluations,","with","function,","jacobian","and","Hessian","evaluations","are","weighted","by\n1,2,4,","respectively.","We","keep","track","of","the","percentage","of","success.","Success","indicates","the\nsolver","returnsuccess,","and","the","exponential","map","of","the","tangent","vector","found","matches","the\ntarget","data","point","(note","that","in","theory,","the","solver","could","return","a","local","minimum","of","the\nobjective","function","but","the","geodesic","ending","point","may","not","match","the","target","point,","we","do\nnot","count","it","as","a","success).","We","also","report","the","number","of","times","the","length","of","the","geodesic\nfound","is","shorter","than","the","length","of","the","geodesic","used","to","generate","the","ending","point","in","the\n%Improvecolumn.","The","last","column","counts","the","percentage","of","the","time","when","the","length\nof","the","proposed","geodesic","exceeds","the","length","of","the","generating","vector.","","Except","for","one\ncase","of","St\nR,2,4\n,","there","is","a","high","percentage","of","the","times","we","find","a","geodesic","of","comparable\nlength","to","the","generating","tangent,","and","we","could","find","geodesics","with","shorter","lengths","than\nthe","generating","ones","at","further","generating","distance","for","St\nR,2,4\n.\nOne","observation","is","the","method","seems","to","work","better","for","thinner","manifolds,","where\np/nis","smaller.","","","For","example,","","we","could","find","at","least","a","geodesic","connecting","the","end-\ning","points","at","a","distance","of","1.3πfor","St\nR,40,1000\n,","while","for","St\nR,2,4\n,","we","have","a","failure","to\nconverge","even","though","the","manifold","is","much","smaller.","","The","analysis","in","the","next","section\nindicates","the","difficulty","may","be","with","points","whereη\nT\nηhas","more","concentrated","spectra,\nand","whenηis","generated","randomly","on","a","larger","manifold,","it","has","less","chance","of","having\nconcentrated","spectra.\nConvergence","is","slower","for","largerp,","sometimes","significantly","slower.","","This","may","be\nbecause","of","the","existence","of","highly","non-convex","regions.","","Besides,","the","dimension","of","the\nsearch","","space","","increases","","quadratically","","withp,","","which","","affects","","the","","number","","of","","CG","","steps\n15\n\nin","","solving","","the","","trust-region","","subproblem,","","and","","matrix","","operations","","are","","of","","costO(p\n3\n)or\nO(n","p\n2\n).\n6.3","","","","Injectivity","radius","the","spectra","of","the","Hessian\nWe","now","analyze","the","nonuniqueness","of","the","Riemannian","logarithm","and","the","behavior","of\nthe","Hessian","of","the","objective","function,","which","affects","the","rate","of","convergence.\nThe","relevant","Riemannian","geometry","concepts","are","cut-value","and","injectivity","radius.\nWithout","going","into","details,","we","recall","(Proposition","16.5,","[19])","the","exponential","map","for\ntangent","vectors","is","injective","within","a","certain","radius","near","zero.","","For","a","unit","tangent","vector\nη,","","there","","may","","be","","acut","","value","t\nc\n(η)∈R\n+\nbeyond","","it","","the","","distance","","from\n","̃\nYto","","Exp\n","̃\nY\ntη\nis","smaller","thant.","","","The","point","Exp\n","̃\nY\nt\nc\n(η)ηis","then","called","acut","point.","","","The","injectivity\nradius","at\n","̃\nYis","the","least","upper","bound","of","the","radius","where","Exp\n","̃\nY\nis","a","diffeomorphism,","or\nequivalently,","the","infimum","of‖t\nc\n(η)η‖\n","̃\nY\nover","all","directions.\nFor","the","case","of","the","sphere","(p=1),","the","cut","value","ist\nc\n(η)","=π\n√\nα\n0\nfor","a","unit","tan-\ngent","vectorη,","which","expresses","the","simple","fact","that","there","are","infinitely","many","geodesics\nconnecting\n","̃\nYto","its","antipodal","point,","while","for","any","other","point","there","is","a","unique","length-\nminimizing","geodesic,","the","shorter","of","two","great","circle","arcs","connecting","the","points.\nForn>p≥2,","we","now","show","the","injectivity","radius","does","not","exceedπmin(\n√\n2α\n1\n,\n√\nα\n0\n).\nThis","follows","from","the","fact","that","there","exist","closed","geodesics","(geodesics","returning","to","the\noriginal","point)","of","lengths","2π\n√\n2α\n1\nand","2π\n√\nα\n0\nfrom","any","point\n","̃\nY.","Using","eq.","(3.4),","such\ngeodesics","could","be","constructed","withA=0,Q∈R\nn×1\n,R∈R\n1×p\nsatisfies(R\nT\nR)\n1/2\n=\n2π,","andη=QR.","","We","have","Exp\n","̃\nY\ntη=\n","̃\nYcost(R\nT\nR)\n1/2\n+QR(R\nT\nR)\n−1/2\nsint(R\nT\nR)\n1/2\nis","a","closed","geodesic,","with","lengtht(α\n0\nR\nT\nR)\n1/2\n=2tπ\n√\nα\n0\n,","which","makes","a","closed","cir-\ncle","att=1","and","a","half","circle","att=1/2,","","thus","the","exponential","map","cannot","be","a","dif-\nfeomorphism","for","a","radius","greater","thanπ\n√\nα\n0\n,","","as−η/2","andη/2","are","mapped","to","the\nsame","","point.","","","Similarly,","","takeQ=0","","andη=\n","̃\nY","AwithAis","","an","","antisymmetric","","matrix\nwith","","the","","top-left","","2×2","","block","","isA\n0\n:=\n[\n0−2π\n2π0\n]\nand","","other","","entries","","are","","zero.","","","We\nhaveY(t)","=\n","̃\nYexptAis","","a","","geodesic,","","andY(1)","=\n","̃\nY.","","","The","","length","","of","","this","","geodesic","","is\n‖η‖\n","̃\nY\n=","(α\n1\nTr(−A\n2\n))\n1/2\n=","(α\n1\n8π\n2\n)\n1/2\n=2π\n√\n2α\n1\n.","","There","are","two","distinct","geodesics\nconnecting\n","̃\nYto\n","̃\nYexp(1/2A)(which","areY\n1\n(t)","=\n","̃\nYexp(tA)andY\n2\n(t)","=\n","̃\nYexp(−tA)).\nThus","the","exponential","map","is","not","a","diffeomorphism","for","a","radius","greater","than","or","equal","to\nπ\n√\n2α\n1\nat","any","point.","We","note","whenp=2,Y\nt\nηis","always","proportional","toA\n0\n,","and","thus\nwe","have","a","higher","chance","of","being","near","a","closed","geodesic,","especially","whennis","small.\nFor","the","casen=p,","the","injectivity","radius","is","bounded","byπ\n√\n2α\n1\n.\nAnother","","estimate","","of","","the","","injectivity","","radius,","","from","","theorem","","17.33","","in","","[19],","","uses","","an\n16\n\nupper","bound","for","sectional","curvature","of","the","Stiefel","manifold,","which","is","not","yet","available\nfor","allα.","For","the","canonical","metric,","[6]","showed","the","injectivity","radius","is","bounded","below\nby\n√\n4/5π.\nFor","the","objective","function,","sinceFreaches","a","minimum","when","the","geodesic","ending\npoint","reaches","the","target,","the","Hessian","operator","product","ofFis","a","positive","semidefinite\noperator","at","the","corresponding","optimal","pair(A,R).","","Empirically,","we","find","its","minimum\neigenvalue","eventually","decreases","whenZmoves","away","from\n","̃\nY.","Denote","byF(\n","̃\nY,Z,Q;A,R)\nthe","objective","function","corresponding","to\n","̃\nY,ZandQ(\n","̃\nY\nT\nQ=0,Q\nT\nQ=I\nk\n).(A,R)will\nbe","the","variables","to","minimize","while(\n","̃\nY,Z,Q)are","parameters.","","Ifη\n∗\nis","a","tangent","vector\nandtis","a","nonnegative","number","then","the","pair(tA\n∗\n,tR\n∗\n)corresponding","totη\n∗\nis","a","min-\nimum","ofF(\n","̃\nY,Exp\n","̃\nY\ntη\n∗\n,Q;A,R),","so","the","Hessian","at(tA\n∗\n,tR\n∗\n)is","positive-semidefinite.\nWe","will","show","in","section","6.4","that","the","Hessian","is","the","identity","map","fort=0,","and","thus","for\nsmalltit","will","be","positive-definite.","","Astincreases,","we","find","the","Hessian","has","decreasing\neigenvalues","and","may","be","singular.","Note","that","ifZis","a","cut","point","in","the","differential","geomet-\nric","sense,","there","are","at","least","two","tangent","directions","from","the\n","̃\nYending","atZ,","they","are","both\nminima","ofF,","but","they","could","be","isolated","minima,","hence","their","Hessian","may","still","be","non\ndegenerated.","","However,","we","use","the","term(empirical)","approximate","cut","valueto","indicate\nthe","valuetwhere","the","smallest","Hessian","value","at","a","minimum","point","is","under","a","threshold,\n(e.g.","","","10\n−8\n).","","","Consider","St\nR,5,10\n,","","using","our","formula","for∇F,","","we","compute","numerically\nthe","Hessian","matrix","Hess\nF\n(\n","̃\nY,Z,Q;A,R)by","vectorizing","increments∆\nA\n,∆\nR\nover","a","basis\nof","Skew\nT\np×R\np×k\n.","","We","then","run","a","search","for","the","time","where","the","smallest","eigenvalue\nis","under","the","threshold.","","The","search","stops","when","a","time","is","found,","within","the","time","upper\nbound","of","1.4π.","","The","graph","on","the","left","of","fig.","1","plots","maximal","and","minimal","time,","over\n100","samples","of(η\n∗\n,Q)for","eachα.","The","right-hand","side","shows","the","time","evolution","of","the\neigenvalues","corresponding","to","one","tangent","vector.","Numerically,","we","observe","the","Hessian\ndegeneration","typically","happens","beyondπ/2,","with","higherαlikely","to","result","in","higher\n(empirical","approximate)","cut","values.","","Since","the","rate","of","convergence","depends","on","the","in-\nverse","of","the","Hessian","eigenvalues,","this","also","explains","why","convergence","is","slower","forZ\nfurther","from\n","̃\nY.\n6.4","","","","The","Hessian","atA=0andR=0\nConsider","","a","","pair","","of","","matrices(∆A,∆R)∈Skew\nT,p\n×R\nk×p\n.","","","ExpandingF(∆A,∆R)","=\nF(\n","̃\nY,Z,Q;∆A,∆R)to","power","series","in∆A,∆Rusing","eq.","(6.1),","","the","second-order","terms\n17\n\nFigure","1:","","Left,","","max","and","min","approximate","cut","value,","","measured","by","the","first","time","the\nHessian","becomes","degenerated","over","100","sample","directions","(cutoff","at","1.4π)","for","St\nR,5,10\n.\nRight,","the","largest","and","smallest","eigenvalues","of","the","Hessian","ofFalong","a","randomly","picked\ntangent","direction","at","increasing","distances.\nare\n−TrZ\nT\n[\n","̃\nYQ\n]\n{\n1\n2\n[\n2α∆A−∆R\nT\n∆R0\nk×k\n]\n2\n+\n1\n2\nI\np+k,p\n{(1−2α)∆A}\n2\nI\nT\np+k,p\n+\n(1−2α)\n[\n2α∆A−∆R\nT\n∆R0\nk×k\n]\nI\np+k,p\n∆AI\nT\np+k,p\n}I\np+k,p\n=\n−\n1\n2\nTrZ\nT\n[\n","̃\nYQ\n]\n[\n4α\n2\n∆A\n2\n−∆R\nT\n∆R+(1−2α)\n2\n∆A\n2\n+4α(1−2α)∆A\n2\n2α∆R∆A+2(1−2α)∆R∆A\n]\n=−\n1\n2\nTr{Z\nT\n","̃\nY(∆A\n2\n−∆R\nT\n∆R)+(2−2α)Z\nt\nQ∆R∆A}\nIfZ=Exp\n","̃\nY\nηwith‖η‖small,","","thenZ\nT\n","̃\nYis","close","to","I\np\nwhileZ\nT\nQis","close","to","zero,\nand","Hessian","bilinear","form","at(A=\n","̃\nY\nT\nη,R=Q\nT\nη)is","close","to","Tr{−∆A\n2\n+∆R\nT\n∆R},\nimplying","the","Hessian","operator","is","close","to","the","identity","operator.","","Thus,","whenZis","close\nto\n","̃\nY,","the","Hessian","at(A,R)corresponding","to","a","critical","point","will","be","close","to","the","identity\nmap,","as","discussed.\n7","","","","Geodesics","and","logarithm","for","Flag","manifolds\nFor","our","purpose,","we","will","consider","a","flag","manifold","as","a","quotient","of","a","Stiefel","manifold\nby","a","group","of","block-diagonal","orthogonal","matrices.","We","compute","the","Euclidean","distance\n18\n\nbetween","two","flag","elements","using","the","realization","in","chapter","2","of","[16],","as","the","manifold","of\nmatrices","of","fixed","eigenvalues","and","multiplicities,","reviewed","below.","A","flag","manifold","is","in\na","sense","an","intermediate","object","between","a","Stiefel","manifold","and","its","associated","Grassmann\nmanifold.\nAgain,","we","will","assumeK=R.","","Letnbe","a","positive","integer","and","assume","we","have","a\npartition\n∑\nq\ni=0\nd\ni\n=nwithd\n0\n≥0","andd\ni\n>0","ifi>0.","This","partition","definesq+1","column\nblocks","on","ann×nmatrix\n","̊\nY,","with","thei-th","column","block","having","sized\ni\n.","It","also","defines\nqcolumn","blocks","on","ann×n\nq\nmatrixY,","withn\nq\n=n−d\n0\n,","with","thei-th","column","block\n(1≤i≤q)","also","having","sized\ni\n.","","Consider","a","tuple\n","̊\nλ=","(λ\n0\n,λ\n1\n,···,λ\nq\n)of","distinct","real\nnumbers","and","define","the","block","diagonal","matrix\n","̊\nΛ=diag(λ\n0\nI\nd\n0\n,λ\n1\nI\nd\n1\n,···,λ\nq\nI\nd\nq\n).","","The\nset","of","matrices","of","the","form\n","̊\nY\n","̊\nΛ\n","̊\nY\nT\n,","with\n","̊\nY∈O(n)is","a","submanifold","ofR\nn×n\n.","From","[16],\nit","could","be","identified","with","the","quotient","manifold","O(n)/(O(d\n0\n)×O(d\n1\n)×···O(d\nq\n)),\ncalled","the","flag","manifold","Flag(n\n1\n,···,n\nq\n;n),","wheren\ni\n=\n∑\ni\nj=1\nd\ni\n.","The","idea","of","the","identi-\nfication","of","a","flag","manifold","with","a","quotient","of","Stiefel","manifold","is","the","fact","that","when","an\neigenvalue","of","a","symmetric","matrix","has","multiplicities,","the","(normalized)","eigenvectors","are\ndefined","up","to","an","orthonormal","change","of","basis,","as","follow\nLemma","2If\n","̊\nΛ=diag(λ\n0\nI\nd\n0\n,λ\n1\nI\nd\n1\n,···,λ\nq\nI\nd\nq\n)withλ\ni\n6=λ\nj\nif","i6=j,\n","̊\nY","","and\n","̊\nZ","are","two\northogonal","matrices","inO(n)such","that\n","̊\nY\n","̊\nΛ\n","̊\nY\nT\n=\n","̊\nZ\n","̊\nΛ\n","̊\nZ\nT\n,","where\n","̊\nY","and\n","̊\nZ","are","expressed","in\nblock","form\n","̊\nY=","[Y\n0\n,Y\n1\n,···,Y\nq\n]","=","[Y\n0\nY],\n","̊\nZ=","[Z\n0\n,Z\n1\n,···,Z\nq\n]","=","[Z\n0\nZ]with","Y\ni\n∈R\nn×d\ni\n,Z\ni\n∈\nR\nn×d\ni\n,0≤i≤q,thenY\nT\ni\nZ\nj\n=0if","i6=j;","each","U\ni\n=Y\nT\ni\nZ\ni\n∈R\nn\ni\n×n\ni\nis","an","orthogonal\nmatrix","and","Z\ni\n=Y\ni\nU\ni\n.\nThus,","we","have\n","̊\nZ=\n","̊\nYdiag(U\n0\n,U\n1\n···,U\nq\n).","Conversely,","if\n","̊\nZ=\n","̊\nYdiag(U\n0\n,U\n1\n,···,U\nq\n)\nwhere","each","U\ni\n∈O(d\ni\n)is","an","orthogonal","matrix,","then\n","̊\nY\n","̊\nΛ\n","̊\nY\nT\n=\n","̊\nZ\n","̊\nΛ\n","̊\nZ\nT\n.\nIf","in","the","above,λ\n0\n=0andΛ=diag(λ\n1\nI\nd\n1\n,···,λ\nq\nI\nd\nq\n)for","distinct","and","non-zeroλ\ni\n’s,\n1≤i≤q,","set","Y=","[Y\n1\n,···,Y\nq\n],","then","we","have\n","̊\nY\n","̊\nΛ\n","̊\nY\nT\n=YΛY\nT\n.","We","have","YΛY\nT\n=ZΛZ\nT\nfor","","Z=","[Z\n1\n,···,Z\nq\n]if","","and","","only","","if","","Z=Ydiag(U\n1\n···U\nq\n),","","and","","in","","that","","case,","","we","","have\nU\ni\n=Y\nT\ni\nZ\ni\n.\nProof:From\n","̊\nY\n","̊\nΛ\n","̊\nY\nT\n=\n","̊\nZ\n","̊\nΛ\n","̊\nZ\nT\n,","","multiply","","by\n","̊\nZ\nT\non","","the","","left","","and\n","̊\nYon","","the","","right,","","we\nhave\n","̊\nZ\nT\n","̊\nY\n","̊\nΛ=\n","̊\nΛ\n","̊\nZ\nT\n","̊\nYby","the","orthogonal","assumption,","which","impliesλ\nj\nZ\nT\ni\nY\nj\n=λ\ni\nZ\nT\ni\nY\nj\n,\nsoZ\nT\ni\nY\nj\n=0","","fori6=j.","","","SinceZ\ni\nis","","orthogonal","","to","","allY\nj\nforj6=i,","","expressingZ\ni\nin\nthe","","basis\n","̊\nY,","","we","","haveZ\ni\n=Y\ni\nU\ni\nforU\ni\n∈R\nd\ni\n×d\ni\n,","","thusU\ni\n=Y\nT\ni\nZ\ni\n.","","","FromZ\nT\ni\nZ\ni\n=I\nd\ni\nwe","","have","","I\nd\ni\n=U\nT\ni\nY\nT\ni\nY\ni\nU\ni\n=U\nT\ni\nU\ni\n.","","","Conversely","","if","","eachU\ni\nis","","orthogonal,\n","̊\nZ\n","̊\nΛ\n","̊\nZ\nT\n=\n","̊\nYdiag(U\n0\n,U\n1\n,···,U\nq\n)\n","̊\nΛdiag(U\nT\n0\n,U\nT\n1\n,···,U\nT\nq\n)\n","̊\nY\nT\n=\n","̊\nY\n","̊\nΛ\n","̊\nY\nT\n.","The","remaining","part","is","just\nthe","special","case","whenλ\n0\n=0.ut\nWe","will","pickλ\n0\n=0","in","theisospectral","description,","where","a","flag","manifold","is","a","subman-\n19\n\nifold","ofR\nn×n\nconsisting","of","symmetric","matrices","of","the","formYΛY\nT\nwithY\nT\nY=I\nn\nq\n.\nThere","is","little","restriction","on","the","choice","ofΛ,","except","we","do","not","want","the","eigenvalues\nto","be","too","close","or","too","different","in","magnitude.","","Different","choices","ofΛgive","us","the","same\nmanifold","topologically.","We","will","use","this","description","only","to","compare","elements","in","a","flag\nmanifold","in","proposition","2.\nOur","main","approach","is","to","consider","a","flag","manifold","as","a","quotient","manifold","of","St\nR,n\nq\n,n\nby","the","group","of","orthogonal","diagonal","block","matrices","O(d\n1\n)×···×O(d\nq\n),","via","the","identi-\nficationJYK7→YΛY\nT\n,","whereJKdenotes","the","equivalent","class","in","the","quotient","structure,","as\nabove.","The","action","of","this","group","on","the","Stiefel","manifold","by","right","multiplication","induces\nvertical","vectors","of","the","formYdiag(u\n1\n,···,u\nq\n)with","u\nT\ni\n+u\ni\n=0.","","With","the","Stiefel","met-\nricα\n0\nTrω\nT\nω+","(α\n1\n−α\n0\n)Trω\nT\nY","Y\nT\nωonR\nn×n\nq\n,","a","horizontal","vectorηmust","satisfy\n−α\n1\nTr","diag(u\n1\n,···,u\nq\n)Y\nT\nη=0","for","all","anti-symmetric","matrices","u\n1\n,···,u\nq\n.","","As","each\nY\nT\ni\nη\ni\nis","already","antisymmetric,","this","impliesY\nT\ni\nη\ni\n=0.","","Since","bothYandηare","block\nmatrices,A:=Y\nT\nηis","also","a","block","matrix,","with","block","byA\n[i","j]\n:=Y\nT\ni\nη\nj\n(1≤i,j≤p).\nThus,","for","a","horizontal","vectorη,","besidesAbeing","antisymmetric,","the","diagonal","blocksA\n[ii]\nmust","be","zero.","Fix","a","matrixQas","an","orthogonal","basis","of","the","column","space","ofη−Y","Y\nT\nη,\nwe","define","a","block","structure","onR=Q\nT\nηby","settingR\n[i]\n=Q\nT\nη\ni\n.","Forp=2,","the","expres-\nsionη=Y","A+QRhas","the","following","block","structure\nη=","[η\n1\n|η\n2\n]","=","[Y\n1\n|Y\n2\n|Q]\n\n\n\nA\n[11]\nA\n[12]\nA\n[21]\nA\n[22]\nR\n[1]\nR\n[2]\n\n\n\nwithA\n[11]\n=0,A\n[22]\n=0,A\n[21]\n=−A\nT\n[12]\n.","","To","compare,","the","tangent","space","of","the","Stiefel\nmanifold","only","requiresA=\n","̃\nY\nT\nηto","be","antisymmetric,","while","a","Grassmann","horizontal\nvector","requiresA=\n","̃\nY\nT\nη=0.","","For","a","flag","manifold,","only","the","diagonal","blocksA\n[ii]\nof\nA=\n","̃\nY\nT\nηare","required","to","be","zero.\nFrom","the","proof","of","theorem","1,A=Y\nT\n(t)\n","̇\nY(t)is","constant","along","any","geodesic.","Thus,\nifY(0)","=\n","̃\nYand\n","̇\nY(0)","=η,","the","horizontal","condition","that","the","diagonal","blocks","ofY\nT\n(t)\n","̇\nY(t)\nvanish","is","satisfied","if\n","̃\nY\nT\nηhas","vanishing","diagonal","blocks.","Any","such","horizontal","geodesic\non","St\nR,n\nq\n,n\nprojects","to","a","geodesic","onF:=Flag(n\n1\n,···,n\nq\n;n),","and","we","will","represent\nthe","exponential","map","onFby","the","equivalent","class","of","the","exponential","map","on","St\nR,n\nq\n,n\n.\nThe","Riemannian","logarithm","between","two","pointsJ\n","̃\nYKandJZKinFcould","be","com-\nputed","by","solving","for","a","horizontal","tangent","vectorηat\n","̃\nYsuch","that","Exp\nSt\n","̃\nY\nη=ZU,","for\nU∈O(d\n1\n)×···×O(d\nq\n),","such","thatηhas","minimal","length.","BothηandUare","unknown\nso","this","direct","approach","is","difficult.","","To","get","an","algorithm","similar","to","the","Stiefel","case,","we\npropose","minimizing\n1\n2\n||Y(1)ΛY(1)\nT\n−ZΛZ\nT\n||\n2\nF\n−TrΛ\n2\n,","as","a","function","of","the","matrices\n20\n\nAandRdefined","in","eq.","(3.4).","","Letd=","(d\n0\n,d\n1\n,···,d\nq\n)be","the","vector","of","the","dimension\nof","the","blocks,","and","recalln\ni\n=\n∑\ni\nj=1\nd\ni\nfori=1,···,q,","set","Skew\nT,d\nto","be","the","space","of\nantisymmetric","matricesAwith","zero","diagonal","blocks","(A\n[ii]\n=0)","and","skew\nT,d\nto","be","the\nprojection","fromR\nn\nq\n×n\nq\nto","Skew\nT,d\nby","sending","a","matrixBto\n1\n2\n(B−B\nT\n),","then","set","the\ndiagonal","blocks","to","zero.","We","have\nProposition","2If\n","̃\nY","","and","Z","are","two","points","on","the","Stiefel","manifoldSt\nK,n\nq\n,n\nand","let","Q∈\nR\nn×k\nbe","an","orthogonal","basis","of","Z−Y","Y\nT\nZ","(k","is","its","rank).","Let(A,R)∈Skew\nT,d\n×R\nn\nq\n×k\n,\nand","Y(t)","=Y(A,R;t)denotes","the","geodesic","from\n","̃\nY","with\n","̇\nY(0)","=η=\n","̃\nY","A+QR","defined","by\n(A,R).","Fix","an","arbitrary","diagonal","matrixΛ=diag(λ\n1\nI\nd\n1\n,···,λ\nq\nI\nd\nq\n)for","a","sequence","of\ndistinct,","non-zero","real","numbersλ\n1\n,···,λ\nq\nas","in","lemma","2.","Then","a","pair(A,R)such","that\nthe","quotient","imageJηK=J\n","̃\nY","A+QRKsatisfiesExp\nF\nJ\n","̃\nYK\nJηK=JZKfor","the","corresponding\nequivalent","classesJ\n","̃\nYK,JZK∈F=Flag(n\n1\n,···,n\nq\n;n)is","a","minimum","of","the","function:\nF\nFg\n(A,R):=\n1\n2\n||Y(1)ΛY(1)\nT\n−ZΛZ\nT\n||\n2\nF\n−TrΛ\n2\n=−TrZ\nT\nY(1)ΛY(1)\nT\nZΛ(7.1)\nIts","gradient","could","be","evaluated","by","Fr\n","́\nechet","derivatives:\n∇F\nFg\n(A,R)","=","(∇\nA\nF\nFg\n,∇\nR\nF\nFg\n)","=","((1−2α)skew\nd,T\n","̊\nL\nFg\n+2αskew\nd,T\n(\nˆ\nL\nFg,11\n),\nˆ\nL\nFg,21\n−\nˆ\nL\nT\nFg,12\n)\n(7.2)\nwhere","we","define","K:=","[\n","̃\nY","Q];","","H:=K\nT\nZΛZ\nT\nK;\nˆ\nA:=\n[\n2αA−R\nt\nR0\n]\n;\n[\nU\n11\nU\n12\nU\n21\nU\n22\n]\n:=\nexp\nˆ\nA","and\n","̊\nL\nFg\n:=L\nexp\n(A,2Λ(exp(1−2α)A)\nT\n(U\nT\n11\nHU\n11\n+U\nT\n21\nHU\n21\n))\nˆ\nL\nFg\n=\n[\nˆ\nL\nFg,11\nˆ\nL\nFg,12\nˆ\nL\nFg,21\nˆ\nL\nFg,22\n]\n:=L\nexp\n(\nˆ\nA,2{exp(1−2α)A}Λ{exp(2α−1)A}H[U\nT\n11\nU\nT\n21\n])\nwhere","the","blocks","forexp\nˆ\nA","and\nˆ\nL\nFg\nhave","the","same","shapes","as","those","of\nˆ\nA.\nFor","the","canonical","metric,","only\nˆ\nL\nFg\n=L\nexp\n(\nˆ\nA,2ΛH[U\nT\n11\nU\nT\n21\n])needs","to","be","evaluated.\nProof:It","is","clearF\nFg\n+TrΛ\n2\nis","bounded","below","by","zero,","and","from","the","completeness\nof","flag","manifolds,","zero","is","its","minimum","value.","","Expanding","the","first","expression","forF\nFg\nin","eq.","(7.1)","then","useZ\nT\nZ=I\nn\nq\nandY(1)\nT\nY(1)","=I\nn\nq\n,","we","get","the","second","expression.\nExpandingY(1)using","eq.","(6.1)","we","have\nF\nFg\n=−TrZ\nT\nKexp\nˆ\nAI\nn\nq\n+k,n\nq\nexp{(1−2α)A}Λexp{(1−2α)A}\nT\nI\nT\nn\nq\n+k,n\nq\n(exp\nˆ\nA)\nT\nK\nT\nZΛ\n(7.3)\n21\n\nand","the","expressionK\nT\nZΛfrom","the","end","could","be","moved","to","the","front","to","becomeH.","From\nhere,","matrix","derivative","rules","imply","the","directional","derivatives","ofF\nFg\nin","the","direction\n(∆\nA\n,∆\nR\n)is\n−TrHL\nexp\n(\nˆ\nA,∆\nA\n)I\nn\nq\n+k,n\nq\nexp{(1−2α)A}Λexp{(1−2α)A}\nT\nI\nT\nn\nq\n+k,n\nq\n(exp\nˆ\nA)\nT\n−TrHexp\nˆ\nAI\nn\nq\n+k,n\nq\nD\n1\nI\nT\nn\nq\n+k,n\nq\n(exp\nˆ\nA)\nT\n−TrHexp\nˆ\nAI\nn\nq\n+k,n\nq\nexp{(1−2α)A}Λexp{(1−2α)A}\nT\nI\nT\nn\nq\n+k,n\nq\n(L\nexp\n(\nˆ\nA,\nˆ\n∆\nA\n)\nT\n(7.4)\nwithD\n1\n:=D\n2\n+D\nT\n2\nwhereD\n2\n:=L\nexp\n((1−2α)A,(1−2α)∆\nA\n)Λexp{(1−2α)A}\nT\nand∆\nˆ\nA\n=\n[\n2α∆A−∆R\nt\n∆R0\n]\n.","The","expression","on","the","third","line","of","eq.","(7.4)","is","the","same","as\nthe","first","line","using","transpose-invariance","of","trace","then","rearranging","the","terms.","","Grouping\nthem","then","move","all","factors","after","L\nexp\n(\nˆ\nA,∆\nA\n)of","the","first","line","to","the","front","of","the","trace\nexpression","gives","us","one","part","of","the","directional","derivative","to","be\n−2","Tr","I\nn\nq\n+k,n\nq\nexp{(1−2α)A}Λexp{(1−2α)A}\nT\nI\nT\nn\nq\n+k,n\nq\nexp(\nˆ\nA)\nT\nHL\nexp\n(\nˆ\nA,∆\nˆ\nA)\nwhich,","after","expressing","exp\nˆ\nAin","block","form","and","multiplying,","then","applying","lemma","1,\nsimplifies","to−Tr\nˆ\nL∆\nˆ\nA\n.","The","middle","line","of","eq.","(7.4)","could","be","expressed","as\n−TrHexp\nˆ\nAI\nn\nq\n+k,n\nq\nD\n1\nI\nT\nn\nq\n+k,n\nq\nexp\nˆ\nA\nT\n=−TrH\n[\nU\n11\nU\n21\n]\nD\n1\n[U\nT\n11\nU\nT\n21\n]\nwhich","simplifies","","to−Tr(U\nT\n11\nHU\n11\n+U\nT\n21\nHU\n21\n)D\n1\n.","","","ExpandingD\n1\nthen","using","","trans-\npose","invariance","of","trace,","the","middle","part","becomes−(1−2α)Tr\n","̊\nL∆A.","","Expressing","the\nmatrices","","in","","block","","form","","and","","multiply,","","we","","are","","left","","with","","the","","trace−Tr((1−2α)\n","̊\nL+\n2α\nˆ\nL\nFg,11\n)∆A−Tr\nˆ\nL\nFg,12\n∆R+Tr\nˆ\nL\nFg,21\n∆R\nT\n.","The","gradient","formula","follows","from","the","fact\nthat","forA∈Skew\nT,d\nandB∈R\nn\nq\n×n\nq\n,","we","have","TrA\nT\nB=TrA\nT\nskew\nT\nB=TrA\nT\nskew\nT,d\nB,\nthe","last","equality","is","because","the","diagonal","blocks","ofAare","zeros.ut\n7.1","","","","Numerical","results","for","flag","manifolds\nAs","before,","we","minimizeF\nFg\n(A,R)with","a","trust-region","method","with","numerical","Hessian\nproduct","","calculated","","from∇F\nFg\n.","","","As","","the","","solver","","expects","","an","","input","","vector,","","we","","vectorize\n(A,R),","then","undo","vectorization","inside","the","objective","function,","the","gradient,","and","the","Hes-\nsian.\nInitialization","","proves","","to","","be","","important","","when","","applying","","the","","algorithm","","to","","flag","","mani-\nfolds.","","As","discussed,","we","do","not","optimize","for","geodesic","distance,","only","for","target","march-\n22\n\ndist","(π)α#Iteration#Evals%Succ%Improve%Not","worse\n0.500.105.90136.781002100\n0.500.505.54109.301000100\n0.501.005.4297.421000100\n0.501.205.48105.201000100\n0.990.1010.96382.329632100\n0.990.509.24275.2810028100\n0.991.007.30195.0610025100\n0.991.207.32182.2410023100\n1.300.109.14257.3810055100\n1.300.507.92206.0410050100\n1.301.007.58180.8610048100\n1.301.207.26174.4610047100\nTable","3:","Logarithm","map","result","for","different","alpha","and","distance","for","Flag(3,4;","9)\ning","geodesics,","relying","on","the","injectivity","of","the","exponential","map","near","the","starting","point.\nEmpirically,","we","find","the","initial","point(A,R)","=","(0,0)produces","minimal","length","geodesics\nmore","consistently.","Therefore,","we","will","only","use","theA=0,R=0","initialization.\nFirst,","we","confirm","that","for","Grassmann","manifolds,","which","are","flag","manifolds","with","two\nblocks","(q=1),","our","numerical","algorithm","closely","matches","with","closed-form","formulas,","as\nin","proposition","1.","","Testing","for","various","dimensions,","each","with","1000","randomly","generated\npoints","","we","","only","","find","","less","","than","","1%","","of","","convergence","","failures,","","and","","when","","we","","have","","con-\nvergence,","the","geodesic","distance","found","matches","the","distance","given","by","the","closed-form\nformula.\nSimilar","to","the","Stiefel","case,","we","present","the","results","for","two","flag","manifolds,","Flag(3,4;","9)\nand","Flag(20,35,40;","1000).","","As","before,","for","each","radius","andα(each","in","its","own","ladder),\nwe","generate","a","random","point\n","̃\nY,","then","a","random","vectorη\n∗\nof","length","equal","to","the","radius","and\nthe","corresponding","ending","point","Exp\n","̃\nY\nη\n∗\n.","","We","compute","the","logarithm","by","the","proposed\nmethod,","then","compare","the","length","of","the","output","logarithm","vector","with","the","generating\nvectorη\n∗\n.","We","find","the","logarithm","vector","could","be","of","shorter","length","than","the","generating\nη\n∗\nin","the","case","Flag(3,4;","9),","and","in","general,","does","not","produce","a","vector","of","worse","length\nthan","the","generating","vector.","","We","observe","logarithm","for","flag","manifolds","requires","more","it-\nerations.","However,","results","show","convergence","is","achieved","consistently.","We","analyze","the\nHessian","cut","value","numerically","and","confirm","it","behaves","similarly","to","the","Stiefel","case.\n7.2","","","","Estimating","the","Hessian","forA=0andR=0\nThe","role","of","the","eigen","matrixΛis","revealed","below","in","the","Hessian","ofF\nFg\natA=0,R=0.\n23\n\ndist","(π)α#Iteration#Evals%Succ%Improve%Not","worse\n0.500.105.12182.521000100\n0.500.505.00102.001000100\n0.501.005.00113.361000100\n0.501.205.00127.921000100\n0.990.106.00140.681000100\n0.990.505.00106.001000100\n0.991.005.0096.161000100\n0.991.205.0098.001000100\n1.300.107.00164.001000100\n1.300.506.70289.581000100\n1.301.006.00131.641000100\n1.301.206.00128.041000100\nTable","","","","4:Logarithm","","","","map","","","","result","","","","for","","","","different","","","","alpha","","","","and","","","","distance","","","","for\nFlag(20,35,40;","1000)\nLemma","3If","Q","satisfies\n","̃\nY\nT\nQ=0,","let","H\n11\n=\n","̃\nY\nT\nZΛZ\nT\nY","","be","the","top","left","block","of","H","","in\nproposition","2.","","The","Hessian","bilinear","form","ofF\nFg\nfor","A=0,R=0at(∆\nA\n,∆\nR\n)is","given\nby\n−TrH{∆\n2\nˆ\nA\nI\nn\nq\n+k,n\nq\nΛI\nT\nn\nq\n+k,n\nq\n+I\nn\nq\n+k,n\nq\nΛI\nT\nn\nq\n+k,n\nq\n∆\n2\nˆ\nA\n−2∆\nˆ\nA\nI\nn\nq\n+k,n\nq\nΛI\nT\nn\nq\n+k,n\nq\n∆\nˆ\nA\n}\n−2(1−2α)TrH{∆\nˆ\nA\nI\nn\nq\n+k,n\nq\n(∆\nA\nΛ−Λ∆\nA\n)I\nT\nn\nq\n+k,n\nq\n+I\nn\nq\n+k,n\nq\n(Λ∆\nA\n−∆\nA\nΛ)I\nT\nn\nq\n+k,n\nq\n∆\nˆ\nA\n}\n−(1−2α)\n2\nTrH\n11\n{(∆\n2\nA\nΛ+Λ∆\n2\nA\n−2∆\nA\nΛ∆\nA\n)}\n(7.5)\nAt","Z=\n","̃\nY","","and","A=0,R=0,","with\n","̃\nY\nT\nQ=0,","the","Hessian","bilinear","form","is","reduced","to\n2","Tr(∆\nT\nR\n∆\nR\nΛ\n2\n−∆\nT\nA\nΛ∆\nA\nΛ+∆\nT\nA\n∆\nA\nΛ\n2\n)(7.6)\nThe","associated","Hessian","product","operator","is(∆\nA\n,∆\nR\n)7→(∆\nA\nΛ\n2\n+Λ\n2\n∆A−2Λ∆\nA\nΛ,2∆\nR\nΛ\n2\n),\nwhich","has","eigenvalues(λ\ni\n−λ\nj\n)\n2\n,","with","the","eigenspaces","consisting","of","matrices","A","with\nA\n[i","j]\n=−A\nT\n[ji]\n6=0,","and","the","remaining","blocks","of","A","are","zeros,","and2λ\n2\ni\n,","corresponding","to\nblock","R\n[i]\n.\nIn","practice,","we","choose","the","sequenceλ\ni\nas","consecutive","integers","centered","around","0,","to\nmake","the","eigenvalues","of","the","Hessian","less","spread","out,","and","not","too","small.\n24\n\nProof:The","Hessian","is","twice","the","second-order","terms","of","the","Taylor","series","expansion","of\nF\nFg\n(A+∆\nA\n,R+∆\nR\n)at(A,R)","=","(0,0)from","eq.","(7.3)","and","is","equal","to\n−TrH{∆\n2\nˆ\nA\nI\nn\nq\n+k,n\nq\nΛI\nT\nn\nq\n+k,n\nq\n+I\nn\nq\n+k,n\nq\nΛI\nT\nn\nq\n+k,n\nq\n∆\n2\nˆ\nA\n−2∆\nˆ\nA\nI\nn\nq\n+k,n\nq\nΛI\nT\nn\nq\n+k,n\nq\n∆\nˆ\nA\n}\n−2(1−2α)TrH{∆\nˆ\nA\nI\nn\nq\n+k,n\nq\n(∆\nA\nΛ−Λ∆\nA\n)I\nT\nn\nq\n+k,n\nq\n+I\nn\nq\n+k,n\nq\n(Λ∆\nA\n−∆\nA\nΛ)I\nT\nn\nq\n+k,n\nq\n∆\nˆ\nA\n}\n−(1−2α)\n2\nTrH{I\nn\nq\n+k,n\nq\n(∆\n2\nA\nΛ+Λ∆\n2\nA\n−2∆\nA\nΛ∆\nA\n)I\nT\nn\nq\n+k,n\nq\n}\nUsing","the","permutation","property","of","trace","we","can","rewrite","the","last","line","of","the","above","as(1−\n2α)\n2\nTrH\n11\n(∆\n2\nA\nΛ+Λ∆\n2\nA\n−2∆\nA\nΛ∆\nA\n).","","Together","with","the","other","terms","we","get","eq.","(7.5).\nWhenZ=\n","̃\nY,A=0,R=0,","with\n","̃\nY\nT\nQ=0,Hreduces","to","diag(Λ,0\nk,k\n),","and","the","Hessian\nbecomes\n−TrΛ{(4α\n2\n∆\n2\nA\n−∆\nT\nR\n∆\nR\n)Λ+Λ(4α\n2\n∆\n2\nA\n−Λ∆\nT\nR\n∆\nR\n)−8α\n2\n∆\nA\nΛ∆\nA\n}\n−2(1−2α)TrΛ{2α∆\nA\n(∆\nA\nΛ−Λ∆\nA\n)+2α(Λ∆\nA\n−∆\nA\nΛ)∆\nA\n}\n−(1−2α)\n2\nTrΛ{2∆\n2\nA\nΛ−2∆\nA\nΛ∆\nA\n}\n=Tr{−8α\n2\n−8α(1−2α)−2(1−2α)\n2\n}Λ\n2\n∆\n2\nA\n+Tr{8α\n2\n+8α(1−2α)+2(1−2α)\n2\n}∆\nA\nΛ∆\nA\nΛ\n+2","TrΛ∆\nT\nR\n∆\nR\nΛ\nwhich","reduces","to","eq.","(7.6).","The","operator","form","and","the","eigenvalue","results","follow.ut\n8","","","","Calculation","of","the","Riemannian","center","of","mass\nWe","apply","our","proposed","logarithm","map","to","compute","the","Riemannian","center","of","mass","[5,\n23].","","The","objective","is","to","minimize\n1\nN\n∑\nN\ni=1\nd(X,Q\ni\n)\n2\nin","the","variableXin","a","manifold","M\nwhereQ\ni\n’s","are","given","points","in","M","(ddenotes","the","geodesic","distance).","","We","will","assume\ndata","is","in","a","sufficiently","small","cluster","and","deal","with","local","minima","only.\nHere,","we","use","the","gradient","algorithm","as","considered","in","[23].","","In","our","experiment,","the\ndata","are","generated","randomly","at","a","distance","between","0.4πand","0.5πaround","a","center","point.\nThe","center","of","mass","ofN=50","pointsQ\n1\n,···,Q\nN\nis","computed","by","the","iterationX\ni+1\n=\nExp\nX\ni\n1\nN\nLog\nX\ni\nQ\ni\n.","After","four","iterations,","the","gradient\n1\nN\nLog\nX\ni\nQ\ni\nis","less","than","5E\n−5\n.","The\nresult","is","summarized","in","table","5.","","Each","gradient","iteration","performsNcomputations","of\nRiemannian","logarithms","by","our","algorithm.","","The","mean","square","distance","is","reduced","from\n4.0","to","1.9","after","four","iterations","for","the","Stiefel","manifold","St\nR,50,100\n,","and","3.9","to","2.0","for","the\ncomparable","flag","manifold","Flag(30,45,50;","1000).","","The","whole","calculation","finishes","after\na","few","minutes","for","each","manifold","on","a","quad-core","Xeon(R)","E3-1225","@3.20GHz.\n25\n\nStiefel","St\nR,50,100\nFlag(30,45,50;","1000)\niter\nα\n0.100.501.000.100.501.00\n00.1570.1600.1630.1340.1350.137\n1-1.729-1.740-1.743-1.728-1.733-1.735\n2-3.614-3.639-3.650-3.587-3.600-3.606\n3-5.493-5.535-5.556-5.441-5.462-5.474\nTable","5:","","Riemannian","center","of","mass.","","Log\n10\nof","the","gradient","of","mean","square","distance\nfunction","for","four","iterations","on","50","data","points.\n9","","","","Implementation\nThe","exponential","maps","are","implemented","in","theex","pmethod","of","classesRealStiefel,","Com-\nplexStiefel,","RealFlag,","ComplexFlagin","moduleManNullRange.manifoldsin","[24].","","The\nlogarithm","","maps","","are","","implemented","","by","","thelogmethod","","inRealStiefel,","","RealFlag.","","","The\nnotebooksStiefelLogarithm,","FlagLogarithmin","foldercolabin","[24]","contain","the","basic\nframework","for","the","calculations","discussed","here.\n10","","","","Conclusion\nIn","","this","","article,","","we","","provide","","efficient,","","closed-form","","geodesics","","formulas","","of","","a","","family","","of\nmetrics","on","the","Stiefel","manifold,","extending","previously","known","geodesic","formulas","often\nused","in","optimization.","","","We","introduce","a","novel","method","to","compute","a","candidate","for","the\nlogarithm","map","and","show","that","the","method","is","robust","for","both","Stiefel","and","flag","manifolds.\nWe","expect","the","method,","using","Fr\n","́\nechet","derivatives","to","compute","the","gradient","of","the","distance\nfunction","to","apply","to","other","manifolds.","","The","method","is","effective","for","different","parameter\nvalues","of","the","metric,","thus","allowing","one","to","adjust","the","metric","to","the","problem","of","interest.\nWe","showed","it","could","be","used","to","compute","the","Riemannian","center","of","mass","instead","of","an\napproximate","geodesic","logarithm.\nThe","injectivity","radii","of","Stiefel","and","flag","manifolds","are","not","known","for","the","full","family\nof","metrics,","although","we","have","provided","an","analysis","based","on","closed","geodesics","in","the\nStiefel","","case.","","","A","","more","","precise","","estimate","","of","","the","","radii","","will","","require","","an","","estimate","","of","","their\nsectional","curvatures","and","will","be","a","topic","of","future","research.","We","hope","further","works","will\nlead","to","refinements","of","the","proposed","algorithms","for","the","logarithm","map.","","We","expect","the\nmetrics","studied","here","will","find","further","applications","in","computer","vision,","statistics,","and\nother","practical","problems.\n26\n\nReferences\n[1]","","Turaga,","P.,","Veeraraghavan,","A.,","Chellappa,","R.:","","Statistical","analysis","on","Stiefel","and\nGrassmann","","manifolds","","with","","applications","","in","","computer","","vision.","","","","In:","","","Proc.","","IEEE\nConf.","Comput.","Vis.","Pattern","Recognit.,","pp.","1–8","(2008).","DOI","10.1109/CVPR.2008.\n4587733\n[2]","","Nishimori,","Y.,","Akaho,","S.:","Learning","algorithms","utilizing","quasi-geodesics","flows","on\nStiefel","manifold.","","","Neurocomput.67,","","106–135","(2005).","","","DOI","10.1016/j.neucom.\n2004.11.035\n[3]","","Chakraborty,","","R.,","","Vemuri,","","B.C.:","","Statistics","on","the","Stiefel","manifold:","","Theory","and\napplications.","Ann.","Statist.47(1),","415–438","(2019).","DOI","10.1214/18-AOS1692\n[4]","","Edelman,","A.,","Arias,","T.A.,","Smith,","S.T.:","The","geometry","of","algorithms","with","orthog-\nonality","constraints.","","SIAM","J.","Matrix","Anal.","Appl.20(2),","303–353","(1999).","","DOI\n10.1137/S0895479895290954\n[5]","","Karcher,","H.:","","Riemannian","center","of","mass","and","mollifier","smoothing.","","Comm.","Pure\nand","Applied","Math.","pp.","509–541","(1977).","DOI","10.1002/cpa.3160300502\n[6]","","Rentmeesters,","","Q.:","","Algorithms","for","data","fitting","on","some","common","homogeneous\nspaces.Ph.D.","","thesis,","","Universit\n","́\ne","","Catholique","","de","","Louvain,","","Louvain,","","Belgium\n(2013).","URLhttp://hdl.handle.net/2078.1/132587\n[7]","","Zimmermann,","","R.:","","A","matrix-algebraic","algorithm","for","the","Riemannian","logarithm\non","the","Stiefel","manifold","under","the","canonical","metric.","","SIAM","J.","Matrix","Anal.","Appl.\n38(2),","322–342","(2017).","DOI","10.1137/16M1074485\n[8]","","Bryner,","D.:","","Endpoint","geodesics","on","the","Stiefel","manifold","embedded","in","Euclidean\nspace.","","","SIAM","J.","Matrix","Anal.","Appl.38(4),","","1139–1159","(2017).","","","DOI","10.1137/\n16M1103099\n[9]","","Sundaramoorthi,","","G.,","","Mennucci,","","A.,","","Soatto,","","S.,","","Yezzi,","","A.:","","","A","","new","","geometric\nmetric","","in","","the","","space","","of","","curves,","","and","","applications","","to","","tracking","","deforming","","objects\nby","","prediction","","and","","filtering.","","","SIAM","","J.","","Imaging","","Sci.4,","","109–145","","(2011).","","","DOI\ndoi.org/10.1137/090781139\n[10]","","H\n","̈\nuper,","K.,","Markina,","I.,","Silva","Leite,","F.:","A","Lagrangian","approach","to","extremal","curves\non","Stiefel","manifolds.","Journal","of","Geometric","Mechanics","(2020).","DOI","10.3934/jgm.\n2020031\n27\n\n[11]","","Nguyen,","","","D.:","","","","Operator-valued","","formulas","","for","","Riemannian","","gradient","","and","","Hes-\nsian","","and","","families","","of","","tractable","","metrics","","in","","optimization","","and","","machine","","learning.\narXiv:2009.10159\n[12]","","Srivastava,","A.,","Klassen,","E.:","Functional","and","Shape","Data","Analysis.","Springer","(2016)\n[13]","","Al-Mohy,","A.H.,","Higham,","N.J.:","","Computing","the","Fr\n","́\nechet","derivative","of","the","matrix\nexponential,","with","an","application","to","condition","number","estimation.","SIAM","J.","Matrix\nAnal.","Appl.30(4),","1639–1657","(2009).","DOI","10.1137/080716426\n[14]","","Mathias,","R.:","A","chain","rule","for","matrix","functions","and","applications.","","SIAM","J.","Matrix\nAnal.","Appl.17,","610–620","(1996).","DOI","10.1137/S0895479895283409\n[15]","","Najfeld,","I.,","Havel,","T.F.:","Derivatives","of","the","matrix","exponential","and","their","computa-\ntion.","Adv.","Appl.","Math.16,","321—-375","(1995).","DOI","10.1006/aama.1995.1017\n[16]","","Helmke,","U.,","Moore,","J.:","Optimization","and","Dynamical","Systems.","Springer,","London,\nUK.","(1994)\n[17]","","Nishimori,","","Y.,","","Akaho,","","S.,","","Plumbley,","","M.D.:","","","Riemannian","","optimization","","method\non","","the","","flag","","manifold","","for","","independent","","subspace","","analysis.","","","In:","","J.","","Rosca,","","D.","","Er-\ndogmus,","","J.C.","Pr\n","́\nıncipe,","","S.","Haykin","(eds.)","Independent","Component","Analysis","and\nBlind","Signal","Separation,","pp.","295–302.","Springer","Berlin","Heidelberg","(2006).","","DOI\n10.1007/11679363\n37\n[18]","","Ye,","","","K.,","","","Wong,","","","K.,","","","Lim,","","","L.:Optimization","","","on","","","flag","","","manifolds","","","(2019).\narXiv:1907.00949\n[19]","","Gallier,","","J.,","","Quaintance,","","J.:","","Differential","Geometry","and","Lie","Groups,","","a","computa-\ntional","perspective.","Springer","International","Publishing","(2020)\n[20]","","Batzies,","","E.,","","H\n","̈\nuper,","","K.,","","Machado,","","L.,","","Silva","","Leite,","","F.:","","","Geometric","","mean","","and\ngeodesic","regression","on","Grassmannians.","Linear","Algebra","and","its","Applications466,\n83–101","(2015).","DOI","10.1016/j.laa.2014.10.003\n[21]","","Bendokat,","T.,","Zimmermann,","R.,","Absil,","P.A.:","","A","grassmann","manifold","handbook:\nBasic","geometry","and","computational","aspects","(2020).","arXiv:2011.13699\n[22]","","Virtanen,","","P.,","","Gommers,","","R.,","","Oliphant,","","T.E.,","","Haberland,","","M.,","","Reddy,","","T.,","","Courna-\npeau,","D.,","Burovski,","E.,","Peterson,","P.,","Weckesser,","W.,","Bright,","J.,","van","der","Walt,","S.J.,\nBrett,","","M.,","","Wilson,","","J.,","","Millman,","","K.J.,","","Mayorov,","","N.,","","Nelson,","","A.R.J.,","","Jones,","","E.,\nKern,","R.,","Larson,","E.,","Carey,","C.J.,","Polat,\n","̇\nI.,","Feng,","Y.,","Moore,","E.W.,","VanderPlas,\n28\n\nJ.,","","Laxalde,","","D.,","","Perktold,","","J.,","","Cimrman,","","R.,","","Henriksen,","","I.,","","Quintero,","","E.A.,","","Har-\nris,","C.R.,","Archibald,","A.M.,","Ribeiro,","A.H.,","Pedregosa,","F.,","van","Mulbregt,","P.,","SciPy\n1.0","Contributors:","Scipy","1.0:","Fundamental","algorithms","for","scientific","computing","in\nPython.","(2020)\n[23]","","Pennec,","X.:","","Statistical","computing","on","manifolds:","","from","Riemannian","geometry","to\ncomputational","anatomy,LNCS,","vol.","5416,","pp.","347–386.","Springer","(2008)\n[24]","","Nguyen,","","","D.:","","","","Project","","ManNullRange.https://github.com/dnguyend/\nManNullRange(2021)\n29"],"doc18":["\n\nPAC-Bayesian","theory","for","stochastic","LTI","systems\nDeividas","Eringis","and","John","Leth","and","Zheng-Hua","Tan","and","Rafal","Wisniewski","and","Mihaly","Petreczky\nAbstract—In","","","this","","","paper","","","we","","","derive","","","a","","","PAC-Bayesian","","","error\nbound","","for","","autonomous","","stochastic","","LTI","","state-space","","models.","","The\nmotivation","","for","","deriving","","such","","error","","bounds","","is","","that","","they","","will\nallow","deriving","similar","error","bounds","for","more","general","dynamical\nsystems,","","including","","recurrent","","neural","","networks.","","In","","turn,","","PAC-\nBayesian","","error","","bounds","","are","","known","","to","","be","","useful","","for","","analyzing\nmachine","","learning","","algorithms","","and","","for","","deriving","","new","","ones.\nI.","","INTRODUCTION\nThe","","goal","","of","","this","","paper","","to","","present","","a","","PAC-Bayesian","","er-\nror","","bound","","for","","learning","","autonomous","","stochastic","","linear","","time-\ninvariant","","(LTI)","","state-space","","representations","","(\nLTIsystems","","for\nshort).","Autonomous","stochastic","LTI","systems","are","widely","used","to\nmodel","","time","","series,","","they","","correspond","","to","","ARMA","","models.","","They\nrepresent","","one","","of","","the","","simplest","","classes","","of","","dynamical","","systems,\nand","their","learning","theory","has","a","rich","history.","In","particular,","the\nlearning","","of","","stochastic","","LTI","","systems","","has","","been","","the","","subject","","of\nsystem","identification","[14].","Despite","the","large","body","of","literature\nfor","","learning","","LTI","","models,","","there","","has","","been","","no","","result","","on","","PAC-\nBayesian","error","bounds","for","LTI","models.\nIn","","order","","to","","explain","","what","","PAC-Bayesian","","framework","","is,","","it\nis","","useful","","to","","recall","","from","","[14]","","the","","learning","","problem","","for","","LTI\nsystems.","","Recall","","from","","[14]","","that","","stochastic","","LTI","","models","","can","","be\nviewed","bot","as","generators","of","an","output","process","(its","distribution),\nand","","","as","","","predictors","","","which","","","predict","","","the","","","current","","","value","","","of","","","an\noutput","process","based","on","its","past","values.","These","two","views","are\nequivalent.","","In","","this","","paper","","we","","will","","view","","dynamical","","systems","","as\npredictors,","","which","","use","","past","","outputs","","to","","predict","","future","","outputs.\nInformally,","following","[14]","the","learning","problem","for","autonomus\nstochastic","LTI","models","can","be","formulated","as","follows.","Consider","a\nprocessywhich","is","generated","by","a","black-box","system.","The","goal\nis","","to","","find","","an","","LTI","","model","","which","","uses","","the","","past","","of","","the","","observed\nprocessyto","predict","the","current","value","ofy,","and","such","that","the\nprediction","error","is","the","smallest","possible.","The","prediction","error\nis","measured","by","using","a","so","called","loss","function.","There","are","two\ntypes","of","prediction","error","to","consider:","the\ngeneralizationerror\nand","the\nempiricalloss","The","generalization","error","is","mathematical\nexpectation","","of","","the","","difference","","between","","the","","current","","values","","of\nyand","","the","","one","","predicted","","by","","the","","model,","","if","","the","","model","","can\nuse","","all","","the","","past","","observations","","ofyto","","predict","","future","","ones.\nThe","","generalization","","error","","is","","a","","number","","which","","tells","","us","","how\nwell","","the","","model","","performs","","in","","average.","","In","","contrast,","","the","","average\nempirical","error","is","a","random","variable,","each","realization","of","which\ncorresponds","to","the","actual","prediction","error","for","a","finite","number\nof","observations","sampled","fromy.\nDeividas","","Eringis,","","Johns","","Leth,","","Zheng-Hua","","Tan","","and","","Rafal","","Wisnieswski\nare","","","with","","","Dept.","","","of","","","Electronic","","","Systems,","","","Aalborg","","","University,","","","Denmark,\n{der,jjl,zt,raf}@es.aau.dk.\nMihaly","","Petreczky","","is","","with","","Laboratoire","","Signal","","et","","Automatique","","de","","Lille\n(CRIStAL)","Lille,","France,","mihaly.petreczky@centralelille.fr\nAs","a","rule,","algorithms","for","learning","LTI","models","[14]","chose","the\nmodel","","parameters","","in","","such","","a","","manner","","that","","the","","empirical","","error\nis","","small,","","when","","evaluated","","for","","the","","data","","available","","for","","learning.\nHowever,","","the","","fact","","that","","a","","certain","","model","","renders","","the","","empirical\nerror","small","does","not","necessarily","mean","that","the","generalization\nerror","","will","","be","","small","","too.","","In","","fact,","","one","","of","","the","","main","","theoretical\nchallenge","","is","","to","","prove","","this","","implication","","for","","certain","","classes","","of\nlearning","problems","and","algorithms.\nInformally,","the","immediate","goal","of","PAC-Bayesian","framework\n[9],","","[15],","","[16]","","is","","to","","derive","","an","","upper","","bound","","on","","the","","average\ngeneralization","","error,","","which","","involves","","the","","average","","empirical\nerror","","of","","models","","and","","a","","number","","of","","tuning","","parameters.","","The\naveraging","","is","","done","","on","","the","","space","","of","","all","","possible","","models,","","using\na","","probability","","distribution","","on","","the","","space","","of","","models.","","On","","of","","the\ntuning","","parameters","","is","","the","","prior","","distribution","","on","","the","","space","","of\ninputs,","which","represents","our","hypothesis","on","the","model","structure;\nWe","will","refer","to","this","inequality","as","the\nPAC-Bayesianinequality.\nOnce","","a","","PAC-Bayesian","","inequality","","has","","be","","derived,","","learning\nalgorithms","can","be","formulate","as","follows.\n1)","","Choose","","the","","value","","of","","the","","prior","","distribution","","and","","other\ntuning","parameters.\n2)","","Find","probability","distribution","which","minimizes","the","PAC-\nBayesian","","upper","","bound","","for","","the","","average","","generalization\nerror.","","Since","","this","","upper","","bound","","involves","","the","","empirical\nloss,","we","will","tend","to","assign","higher","probability","to","models\nwhich","","fit","","well","","the","","training","","data.","","However,","","this","","will","","be\ntempered","","by","","the","","need","","to","","take","","into","","account","","the","","prior\ndistribution","","and","","the","","tuning","","parameters.","","This","","step","","can\nbe","","performed","","using","","sampled","","data.","","The","","thus","","obtained\nprobability","","distribution","","is","","analogous","","to","","the","","posterior\ndistribution","in","the","Bayesian","setting.\n3)","","The","","final","","model","","can","","be","","obtained","","by","","either","","sampling\nrandomly","","from","","the","","posterior","","distribution,","","choosing","","the\nelement","with","the","maximal","density","(if","the","posterior","distri-\nbution","is","absolutely","continuous),","or","by","taking","the","mean\nof","the","posterior","distribution.\nVarious","choices","of","the","prior","distribution","on","the","space","of","model\nand","","of","","the","","tuning","","parameters","","which","","enter","","the","","PAC-Bayesian\ninequality","will","lead","to","different","learning","algorithms.","In","fact,","it\ncan","be","shown","[7],","[9]","that","known","learning","algorithms","can","be\nderived","from","PAC-Bayesian","inequality.","The","thus","derived","algo-\nrithms","will","automatically","be","equipped","with","an","upper","bound","on\nthe","generalization","error.","In","turn,","we","can","use","this","upper","bound\nfor","a","systematic","analysis","of","corresponding","learning","algorithm.\nThe","PAC-Bayesian","learning","theory","[15],","[16])","is","one","of","the\nseveral","","approaches","","for","","studying","","theoretical","","properties","","of","","ma-\nchine","learning","algorithms.","This","approach","is","subject","of","intensive\nresearch,","","see","","[9]","","for","","a","","recent","","survey.","","It","","has","","demonstrated","","its\narXiv:2103.12866v1","","[stat.ML]","","23","Mar","2021\n\nability","to","provide","computable","generalization","bounds","on","popu-\nlar","machine","learning","algorithms,","such","as","neural","networks","[6]\nand","SVMs","[3].","Moreover,","as","its","name","suggests,","PAC-Bayesian\nframework","","combines","","the","","classical","","Probably","","Approximately\nCorrect","","theory","","based","","on","","a","","frequentist","","view","","with","","Bayesian\ninference,","","see","","[2],","","[7],","","[8],","","[19],","","[20]","","for","","a","","more","","detailed\ndiscussion","on","the","topic.\nThe","motivation","for","studying","PAC-Bayesian","error","bounds","for\nLTI","models","is","as","follows.","Autonomous","stochastic","LTI","models\nare","a","special","case","of","stochastic","LTI","models","with","inputs.","In","fact,\nit","is","known","[11],","[13],","[14]","that","learning","stochastic","LTI","models\nwith","","inputs","","can","","be","","decomposed","","into","","learning","","autonomous\nstochastic","LTI","models","and","learning","deterministic","LTI","models\nwith","","inputs.","","Hence,","","in","","order","","to","","derive","","PAC-Bayesian","","error\nbounds","","for","","stochastic","","LTI","","models","","with","","inputs","","the","","first","","step\nis","to","derive","such","error","bounds","for","autonomous","stochastic","LTI\nmodels.","In","turn,","stochastic","LTI","models","with","inputs","are","special\ncases","","of","","recurrent","","neural","","networks","","(RNN)","","and","","their","","various\nmodifications,","such","as","LSTM","networks.","Hence,","deriving","PAC-\nBayesian","error","bounds","for","autonomous","stochastic","LTI","models\nis","","the","","first","","step","","towards","","deriving","","PAC-Bayesian","","error","","bounds\nfor","stochastic","LTI","models","with","inputs,","and","then","for","RNNs","and\nLSTMs.","","In","","turn,","","this","","will","","allow","","to","","understand","","the","","theoretical\nlimitations","of","learning","algorithms","for","RNNs.\nDespite","","an","","impressive","","body","","of","","literature,","","PAC-Bayesian\nerror","bounds","are","not","available","for","learning","LTI","systems.","One","of\nthe","reasons","for","this","is","that","most","of","the","existing","literature","dealt\nwith","bounded","and","Lipschitz","loss","functions","[1],","[6],","[18],","which\nis","","typical","","for","","classification","","problem,","","but","","not","","for","","regression\nproblems.","","In","","[7]","","PAC-Bayesian","","bounds","","for","","linear","","regression\nwith","a","quadratic","loss","function","was","developed,","later","this","bound\nwas","improved","and","extended","to","non","i.i.d.","data","in","[17].","In","par-\nticular,","in","[17]","the","derived","PAC-Bayesian","error","bound","for","non\ni.i.d","","linear","","regression","","problem","","was","","applied","","to","","learning","","ARX\nmodels.","Note","that","in","[17]","control","inputs","were","allowed,","while\nin","","the","","current","","paper","","we","","consider","","only","","autonomous","","systems.\nSince","ARX","models","without","inputs","correspond","to","AR","models,\nand","","the","","latter","","class","","represents","","a","","special","","case","","of","","autonomous\nstochastic","","LTI","","state-space","","representations,","","the","","present","","paper\ncan","be","viewed","as","an","extension","of","[17]","to","stochastic","LTI","state-\nspace","representations.\nThe","structure","of","the","paper","is","as","follows.","In","Section","II-A","we\npresent","","the","","formal","","framework","","for","","PAC-Bayesian","","learning","","of\nlinear","dynamical","systems.","In","Section","III","we","present","the","main\nresult","","of","","the","","paper","","which","","is","","an","","analytic","","PAC-Bayesian","","error\nbound","","for","","stochastic","","LTI","","models.","","In","","Section","","IV","","we","","present\na","numerical","example","for","illustrating","the","theoretical","results.","In\nSection","V","we","present","the","conclusions","and","directions","for","future\nresearch.\nII.","","PAC-BAYESIAN","LEARNING","","FOR","LINEAR","DYNAMICAL\nSYSTEMS\nThe","","purpose","","of","","this","","section","","is","","to","","formulate","","the","","learning\nproblem","","for","","stochastic","","dynamical","","systems","","and","","to","","present","","a\nbrief","overview","of","PAC-Bayesian","framework.\nA.","","The","learning","problem\nIn","order","to","formalize","the","problem,","let","us","denote","byY=R\np\nthe","set","of","output","values.","Moreover,","we","fix","a","probability","space\n(Ω,P,F),","whereFis","aσ-algebra","onΩandPis","a","probability\nmeasure","onF,","see","for","example","[12]","for","the","terminology.","We\nuseEto","denote","the","mathematical","expectation","with","respect","to\nthe","probability","measureP.","Consider","a","stochastic","processyon\nthis","probability","space,","taking","values","inY,","and","with","time","axis\nZ.","","That","","is,","","for","","anyt∈Z,y(t)",":","Ω→","Y;ω7→y(t)(ω)","=y\nis","a","random","variable","on(Ω,P,F).","For","technical","reasons,","we\nassume","thatyis\n•Stationary:","its","finite","dimensional","distributions","are","invari-\nant","under","time","displacement\nP(y(t\n1\n+t)≤y\n1\n,...,y(t\nk\n+t)≤y\nk\n)\n=P(y(t\n1\n)≤y\n1\n,...,y(t\nk\n)≤y\nk\n)\nfor","anyt,t\n1\n,...,t\nk\nandk.\n•Square-integrable:E[||y(t)||\n2\n2\n]<∞for","anyt,","with||·||\n2\ndenoting","the","Euclidean","2-norm.\n•Zero","mean:E[y(t)]","=","0for","anyt.\nRecall","","that","","the","","first","","two","","assumptions","","imply","","constant","","expec-\ntation","","and","","that","","the","","covariance","","matrixCov(y(t),y(s))","","","=\nE[(y(t)−E[y(t)])(y(s)−E[y(s)])\nT\n]only","depend","ont−s.\nThe","goal","of","learning","is","to","estimate\nmodels","for","predictingy\nbase","on","a","training","set{y(t)(ω)}\nN\nt=0\nformed","by","a","finite","portion\nof","a","sample","path","ofy.\nLetY\n∗\n=\n⋃\n∞\nk=1\nY\nk\nwhere","","here\n⋃\ndenote","","disjoint","","union.\nBy","slight","abuse","of","notation","we","simply","writey=","(y\n1\n,...,y\nk\n)\nin","place","of","the","more","correct(y,k)","=","((y\n1\n,...,y\nk\n),k)for","an\nelement","","inY\n∗\n.","","Moreover,","","whenever","","necessary","","we","","associate\nwithY\nk\nthe","","topology","","generated","","by||·||\n2\n,","","and","","the","","Borelσ-\nalgebraB\nk\ngenerated","by","the","open","sets","ofY\nk\n.\nIn","","our","","setting,","","models","","will","","be","","a","","subset","","of","","measurable\nfunctions","of","the","form\nf:Y\n∗\n→Y(1)\nIn","","particular,f\n−1\n(B)∈","B\nk\nfor","","allkwheneverB∈","B\n1\n.","","For\nthe","","easy","","of","","notation,","","for","","any(y\n1\n,...,y\nk\n)∈","Y\nk\n,","","we","","denote\nf((y\n1\n,...,y\nk\n))byf(y\n1\n,...,y\nk\n).\nIn","this","paper,","we","will","restrict","attention","to","models","which","arise\nfrom","stable","transfer","functions.","More","precisely,","we","will","use","the\nfollowing","definition.\nDefinition","","II.1(Model).A","","model","","is","","a","","functionfof","","the\nform(1)such","","that","","there","","exists","","a","","sequence","","ofp×pmatrices\n{M\nk\n}\n∞\nk=1\nsuch","that","the","sequence","is","absolutely","summable,","i.e.,\n∑\n∞\nk=0\n‖M\nk\n‖\n2\n<∞,","and\nf(y\n1\n,...,y\nk\n)","=\nk\n∑\ni=1\nM\ni\ny\ni\n(2)\nIntuitively,","a","modelfsatisfying","the","conditions","of","Definition\nII.1","are","input-output","maps","of","linear","systems","defined","by","a","stable\ntransfer","functionG(z)","=\n∑\n∞\nk=1\nM\nk\nz\n−(k−1)\n.\nIntuitively,","","iffis","","applied","","to","","some","","tuple","","of","","past","","value","","of\ny,","","then","","the","","resulting","","random","","process","","will","","be","","viewed","","as","","a\n\nprediction","of","the","current","value","ofybased","on","those","past","values,\nthat","is,\nNotation1.In","the","sequel","we","use","the","following","notation:\nˆ\ny\nf\n(t|s)","=f(y(t−1),...,y(s)).\nThe","","random","","variable\nˆ\ny\nf\n(t|s)is","","interpreted","","as","","the","","pre-\ndiction","","ofy(t)generated","","byf,","","based","","on","","the","","past","","values\ny(t−1),...,y(s),s","<","t.","Clearly,\nˆ\ny\nf\n(t|s)","=\nt−s\n∑\nk=1\nM\nk\ny(t−k)(3)\nRemarkII.1.Notice","that","sinceyis","stationary,","it","follows","that\nthe","probability","distribution","of\nˆ\ny\nf\n(t|s)depends","only","ont−s\nNaturally,","","we","","would","","like","","to","","find","","models","","which","","predict","","the\noutput","process","well.","The","“quality”","of","the","predictorfis","usually\nassessed","","through","","a","","measurable\nlossfunction`:Y","×","Y","→\n[0,∞).","","The","","loss","","function","","evaluated","","at`(\nˆ\ny\nf\n(t|s),y(t))\nmeasures","how","well","the","predicted","value\nˆ\ny\nf\n(t|s)approximates\nthe","","true","","value","","ofyatt:","","the","","smaller`(\nˆ\ny\nf\n(t|s),y(t))is,\nthe","","smaller","","the","","prediction","","error","","is.","","Note","","that","","the","","use","","of","","the\nword","","smaller","","here","","needs","","to","","be","","quantified","","e.g.,","","byE,","","as\n`(\nˆ\ny\nf\n(t|s),y(t))is","","a","","random","","variable.","","Indeed,","","in","","the","","sequel\nwe","will","refer","toE[l(\nˆ\ny\nf\n(t|s),y(t))]as","the","prediction","error\nAssumption","II.1(Quadratic","loss","function).In","the","sequel,","we\nwill","assume","that","the","loss","function","is","quadratic,","i.e.`(y,y\n′\n)","=\n‖y−y\n′\n‖\n2\n2\n=","(y−y\n′\n)\nT\n(y−y\n′\n).\nSome","of","the","subsequent","discussion,","especially","Theorem","II.1\ncan","be","extended","to","other","loss","functions,","but","for","the","purposes\nof","the","paper","quadratic","loss","functions","are","sufficient.\nThen","the","quantity\nE[`(\nˆ\ny\nf\n(t|s),y(t))],(4)\nmeasures","","the","","mean","","difference","","between","","the","","actual","","process\ny(t)and","","the","","predicted","","value\nˆ\ny\nf\n(t|s)bases","","on{y(τ)}\nt−1\nτ=s\n.\nHowever,","","the","","expectation","","(4)","","is","","not","","the","","most","","convenient\nmeasure","","of","","the","","predictive","","power","","of","","a","","model,","","as","","it","","depends\non","","the","","prediction","","horizont−s.","","In","","practice,","","the","","prediction\nhorizon","","tends","","to","","increase","","with","","the","","increase","","of","","the","","number","","of\navailable","data","points.","For","this","reason,","it","is","more","convenient","to\nconsider","the","prediction","error","as","the","beginning","of","the","prediction\nhorizon","goes","to","infinity.\nIntuitively,","","we","","expect","","that","","the","","quality","","of","","the","","prediction\nwill","","increase","","with","","the","","growth","","of","","the","","horizont−sused","","for\nprediction.","In","fact,","we","can","state","the","following.\nLemma","","II.1(Infinite","horizon","prediction,","[10]).The","limit\nˆ\ny\nf\n(t)","=","","","lim\ns→−∞\nˆ\ny\nf\n(t|s)(5)\nexists","in","the","mean","square","sense","for","allt,","the","process\nˆ\ny\nf\n(t)is\nstationary,\nE[`(\nˆ\ny\nf\n(t),y(t))]","=","","","lim\ns→−∞\nE[`(\nˆ\ny\nf\n(t|s),y(t))](6)\nandE[`(\nˆ\ny\nf\n(t),y(t))]does","not","depend","ont.\nThis","prompts","us","to","introduce","the","following","definition.\nDefinition","II.2(Generalization","error","of","a","model).The","quantity\nL\n`\ny\n(f)","=E[`(\nˆ\ny\nf\n(t),y(t)]","=","","","lim\ns→−∞\nE[`(\nˆ\ny\nf\n(t|s),y(t))]\nis","called","the","generalization","error","of","the","modelfwhen","applied\nto","processy,","or","simply","generalization","error,","whenyis","clear\nfrom","the","context.\nIntuitively,\nˆ\ny\nf\n(t)can","be","interpreted","as","the","prediction","ofy(t)\ngenerated","","by","","the","","modelfbased","","on","","all","","past","","values","","ofy.","","As\nstated","in","Lemma","II.1","we","consider","the","special","case","when\nˆ\ny\nf\n(t)\nis","the","mean-square","limit","of\nˆ\ny\nf\n(t|s)ass→−∞.","Clearly,","for\nlarge","","enought−s,","","the","","prediction","","errorE[`(\nˆ\ny\nf\n(t|s),y(t))]\nis","close","to","the","generalization","error.\nThe","","goal","","of","","learning","","is","","to","","find","","a","","model","","from","","a","","set","","of\npossible","","models","","with","","the","","smallest","","possible","","prediction","","error,\nusing","","a","","finite","","portion","","of","","the","","sample","","path","","ofy.","","This","","can","","be\nachieved","","through","","minimizing","","a","","cost","","function","","which","","involves\nthe","","so","","called\nempiricalerror.","","Assume","","that","","we","","would","","like","","to\nlearn","","a","","model","","from","","the","","time","","seriesS={y(t)(ω)}\nN\nt=0\n,","","for\nsomeω∈Ω.","The","dataSrepresents","a","finite","portion","of","sample\npath{y(t)(ω)}\nt∈Z\nofy,","andN+","1represents","the","number","of\ndata","","points","","used","","for","","the","","learning","","problem.","","Let","","us","","define","","first\nthe","concept","of","empirical","(error)","loss.\nDefinition","II.3.The","empirical","loss","for","a","modelfand","process\nyis","defined","by\nˆ\nL\n`\ny,N\n(f)","=\n1\nN\nN\n∑\nt=1\n`(\nˆ\ny\nf\n(t|0),y(t)).(7)\nNote","","that\nˆ\nL\n`\ny,N\n(f)","",":","","Ω→Ris","","a","","random","","variable,","","and\nforω∈Ω,\nˆ\nL\n`\ny,N\n(f)(ω)corresponds","to","the","average","prediction\nerror","","produced","","byfwhen","","applied","","to","","the","","samplesy(t)(ω)\nfort=","0,...,Nsuccessively,","","that","","is,","","if","","the","","training","","data","","is\nS={y(t)(ω)}\nN−1\nt=0\n,","then\nˆ\nL\n`\ny,N\n(f)(ω)","=\n1\nN\nN\n∑\nt=1\n`(\nˆ\ny\nf\n(t|0)(ω),y(t)(ω))\n=\n1\nN\nN\n∑\nt=1\n`(f(y(t−1)(ω),...,y(0)(ω)),y(t)(ω))\ni.e.\nˆ\nL\n`\ny\n(f)(ω)depends","only","on","the","training","dataS.\nRemarkII.2","","(Alternatives","","for","","definining","","the","","empirical","","loss\nand","","relationship","","with","","system","","identification).Note","","that","","the\nminimization","of","the","empirical","loss","is","quite","a","common","method\nin","","system","","identification.","","However,","","for","","theoretical","","analysis\nusually","not","(7)","is","taken,","but","rather\nV\ny,N\n(f)","=\n1\nN\nN\n∑\nt=1\n`(\nˆ\ny\nf\n(t),y(t)).(8)\nThat","","","is,","","","instead","","","of","","","the","","","prediction","","","error","","","using","","","finite","","","past\n{y(s)}\nN\ns=0\nthey","","use","","the","","infinite","","past{y(s)}\nN\n=−∞\n.","","As","","it","","was\n\npointed","","out","","above,lim\ns→−∞\n(\nˆ\ny\nf\n(t|s)−\nˆ\ny\nf\n(t))","=","0,","","where\nthe","","limit","","is","","understood","","in","","the","","mean","","square","","sense.","","Using","","this\nobservation","and","a","Cesaro-mean","like","argument","it","can","be","shown\nthat\nLemmaII.2.lim\nN→∞\nˆ\nL\ny,N\n(f)−V\ny,N\n(f)","","=","","0,","","where","","the\nlimit","is","understood","in","the","mean","sense.\nIn","","particular,","","as","","mean","","convergence","","implies","","convergence","","in\nprobability,","","it","","is","","clear","","that","","for","","large","","enoughN,\nˆ\nL\ny,N\n(f),\nV\ny,N\n(f)will","","be","","close","","enough","","with","","a","","large","","probability.","","That\nis,","for","practical","purposes","minimizingV\ny,N\n(f)versus\nˆ\nL\ny,N\n(f)\nwill","not","make","a","big","difference.","The","reason","for","using\nˆ\nL\ny,N\n(f)\ninstead","ofV\ny,N\n(f)is","that","we","are","interested","in","deriving","PAC-\nBayesian","bounds,","which","are","not","asymptotic.","This","is","in","contrast\nto","the","usual","approach","of","system","identification,","which","focuses\non","","asymptotic","","results,","","i.e.,","","behavior","","of","","the","","algorithms","","as\nN→∞.\nDepending","on","various","choices","of","the","cost","function,","which","al-\nways","involves","the","empirical","loss,","different","learning","algorithms\ncan","be","derived.","The","challenge","is","to","be","able","to","characterize","the\ngeneralization","error","of","the","results","of","these","learning","algorithms,\nand","","to","","understand","","how","","the","","choice","","of","","the","","learning","","algorithm\ninfluences","this","generalization","error.\nB.","","PAC-Bayesian","framework\nTo","this","end,","in","the","machine","learning","community","the","so","called\nPAC-Bayesian","framework","was","proposed.","Next","we","present","the\nPAC-Bayesian","framework","in","detail.","LetFbe","a","set","of","models,\nsomethimes","referred","to","as","the","set","of","hypothesis.","Assume","that\nFcan","","be","","parametrized","","by","","a","","parameter","","setΘ,","","i.e.,","","there","","is\na","","bijectionΠ",":","Θ→","F.","","For","","simplicity,","","denoteΠ(θ)byf\nθ\n,\nθ∈Θ.","","That","","is,f\nθ\nis","","the","","model","","which","","corresponds","","to","","the\nparameterθ.","","Assume","","that(Θ,B\nθ\n,m)is","","a","","measure","","space,\nwhereB\nΘ\nis","","aσ-algebra","","onΘandmis","","a","","measure","","on\n(Θ,B\nθ\n).","","Furthermore,","","assume","","that","","the","","functionθ7→","L\n`\ny\n(f\nθ\n)\nis","","","measurable","","","and","","","integrable","","","with","","","respect","","","to(Θ,B\nθ\n,m).\nAssume","","that","","the","","functionΘ×Ω3(θ,ω)7→\nˆ\nL\n`\ny,N\n(f\nθ\n)is\nmeasurable","","and","","integrable","","with","","respect","","to","","the","","joint","","product\nmeasurem×P.","","Letρbe","","a","","probability","","density","","function","","on\nthe","measure","space(Θ,B\nθ\n,m),","andg:F","→Rbe","a","map","such\nthatΘ3θ7→g(f\nθ\n)is","measurable","and","absolutely","integrable.\nWe","then","denote","byE\nf∼ρ\ng(f)the","integral\nE\nf∼ρ\ng(f)","=\n∫\nθ∈Θ\nρ(θ)g(f\nθ\n)dm(θ)(9)\nMoreover,","","by","","a","","slight","","abuse","","of","","notation","","and","","terminology","","we\nsometimes","writeρ(f)for","the","valueρ(θ)wheneverf=f\nθ\nfor\nθ∈Θ,","","and","","say","","thatρis","","a","","density","","onF.","","With","","this","","notation\nand","terminology","in","mind,","we","can","state","the","following","theorem.\nTheorem","","II.1.(","[2]","and","[7])","For","any","two","densitiesπandˆρ\nonF,","anyδ∈(0,1],","and","a","real","numberλ",">0,\nP\n({\nω∈Ω|E\nf∼ˆρ\nL\n`\ny\n(f)≤E\nf∼ˆρ\nˆ\nL\n`\ny,N\n(f)(ω)(10)\n+\n1\nλ\n[\nKL(","ˆρ‖π)","+","ln\n1\nδ\n+","Ψ\n`,π\n(λ,n)\n]\n})\n>1−δ",",\nwhereKL(","ˆρ|π)is","the","Kullback-Leibler","divergence:\nKL(","ˆρ‖π)","=E\nf∼ˆρ\nln\nˆρ(f)\nπ(f)\n.\nand\nΨ\n`,π\n(λ,N)","=","lnE\nf∼π\nE[e\nλ(L\n`\ny\n(f)−\nˆ\nL\n`\ny,N\n(f))\n]\nIntuitively,","","in","","Theorem","","II.1,πplays","","the","","role","","of","","prior\ndistribution","","density","","function","","andˆρplays","","the","","role","","of","","any\ncandidate","","to","","posterior","","distribution","","on","","the","","space","","of","","models.\nThe","","Kullback-Leibler","","divergence","","measures","","the","","distance","","be-\ntween","","the","","prior","","and","","posterior","","densities.","","We","","expect","","the","","term\nΨ\n`,π\n(λ,N)to","","converge","","to","","zero,","","asN→","∞.","","In","","fact,","","under\nsuitable","assumptions","ony,","this","will","indeed","be","the","case.\nThe","numbersλandδare","tuning","parameters.","The","parameter\nδregulates","","the","","magnitude","","of","","the","","probability","","via1−δand\ninfluence","the","upper","bound","on","the","generalization","error","through\na","term","inversely","proportional","toδ.","This","means","that","the","smaller\nwe","","would","","like","","to","","get","","the","","probability","","that","","the","","error","","bound\nholds","","higher,","","the","","error","","bound","","increases","","too.","","Finally,λis","","a\ntuning","parameter","which","tells","us","how","much","we","care","about","the\nempirical","loss","being","small,","for","details","see","below.\nThe","","way","","to","","use","","Theorem","","II.1","","is","","as","","follows.","","Consider\nthe","","sampled","","training","","dataS={y(t)(ω)}\nN\nt=0\n.","","Then,","","with\nprobability","at","least1−δ,","the","inequality\nE\nf∼ˆρ\nL\n`\ny\n(f)≤E\nf∼ˆρ\nˆ\nL\n`\ny,N\n(f)(ω)(11)\n+\n1\nλ\n[\nKL(","ˆρ‖π)","+","ln\n1\nδ\n+","Ψ\n`,π\n(λ,N)\n]\nholds.","","Ifδis","","small","","enough,","","it","","means","","that","","we","","should","","be\nunlucky","","for","","(11)","","not","","to","","hold.","","Our","","goal","","should","","be","","to","","find\nposterior","","distributionˆρsuch","","that","","the","","right-hand","","side","","of","","(11)\nis","small.","For","such","a","densityˆρthe","average","generalization","error\nE\nf∼ˆρ\nL\n`\ny\n(f)will","","be","","small.","","This","","means","","that","","under","","suitable\nstatistical","hypothesis,","if","we","either\n•randomly","sample","a","modelf\n∗\nfrom","the","probability","distri-\nbution","determined","byˆρ,","or\n•we","choose","the","most","likely","modelf\n∗\n=","argmax\nf∈F\nˆρ(f),\nor\n•we","choosef\n∗\nto","be","the","mean","or","median","of","the","probability\ndistribution","with","the","densityˆρ\nThenL\n`\ny\n(f\n∗\n)will","be","small","too","(at","least","with","a","high","probabil-\nity).","That","is,","we","have","found","a","model","with","a","small","generaliza-\ntion","error.\nSince","the","terms","ofΨ\n`,π\n(λ,n)andln\n1\nδ\nin","(11)","do","not","depend\non","the","the","posterior","densityˆρ,","choosing","a","densityˆρfor","which\n\nthe","right-hand","side","of","(11)","is","small","is","equivalent","to","choosing\nˆρso","that\nE\nf∼ˆρ\nˆ\nL\n`\ny,N\n(f)(ω)","+\n1\nλ\nKL(","ˆρ||π)(12)\nis","small.\nBy","tuning","the","parametersλand","the","priorπthe","cost","function\n(12)","","will","","be","","different,","","leading","","to","","different","","choices","","ofˆρand\nmodelf\n∗\n,","","i.e.,","","to","","different","","learning","","algorithms.","","The","","priorπ\nencodes","our","hypothesis","on","the","model","structure.","The","parameter\nλregulates","the","extent","we","care","about","fitting","training","data.","For\ninstance,","smallλmean","that","we","would","like","the","posteriorˆρto\nbe","","close","","to","","the","","prior","","(we","","insist","","on","","a","","certain","","model","","structure)\nand","","we","","care","","less","","about","","how","","well","","the","","models","","fit","","the","","training\ndata.","","In","","contrast,","","largeλmeans","","that","","we","","care","","less","","about","","the\nmodel","having","a","certain","structure,","and","more","about","it","fitting","the\ntraining","data.\nThe","","parameterδallows","","us","","to","","regulate","","the","","probability","","that\nthe","","inequality","","(11)","","is","","not","","true,","","and","","hence","","the","","found","","model\nwill","","have","","a","","potentially","","arbitrary","","generalization","","error.","","Clearly,\nthe","price","we","pay","for","making","sure","that","(11)","is","true","with","a","high\nprobability","is","that","the","upper","bound","on","the","generalization","error\nis","large.","Finally,","the","error","termΨ\n`,π\n(λ,N)depends","onλ,","the\npriorπandN,","for","large","enoughNwe","expect","it","to","be","small.\nIn","fact,","we","can","present","an","explicit","formula","for","the","densityˆρ\nwhich","minimizes","(12):","the","unique","densityˆρ\n∗\nwhich","achieves\nthe","minimum","of","(12)","is","the","Gibbs","posterior","[2]:\nˆρ\n∗\n(f)","=\n1\nZ\ny\n(ω)\nπ(f)e\n−λ\nˆ\nL\n`\ny,N\n(f)(ω)\n,(13)\nwhere\nZ\ny\n(ω)","=E\nf∼π\ne\n−λ\nˆ\nL\n`\ny,N\n(f)(ω)\n(14)\nis","","the","","normalization","","term.","","Note","","thatˆρ\n∗\n(f)is","","a","","function","","of\nthe","","empirical","","loss\nˆ\nL\n`\ny\n(f)(ω)evaluated","","for","","the","","training","","data\nS={y(t)(ω)}\nN\nt=0\n.\nIf","","we","","choosef\n∗\nas","","the","","most","","likely","","model,","","i.e.,f\n∗\n=\nargmax\nf∈F\nˆρ\n∗\n(f),","then","we","are","solving","the","optimization","prob-\nlem:\nmin\nf∈F\n(\nλ\nˆ\nL\n`\ny,N\n(f)(ω)−lnπ(f)\n)\n,(15)\nThat","","is,","","we","","choosef\n∗\nby","","minimizing","","a","","cost","","function","","which\nincludes","","the","","empirical","","loss","","and","","a","","regularization","","term.","","The\nlatter","","is","","just","","the","","prior","","distribution","","density.","","This","","is","","a","","further\nindication","that","a","large","variety","of","seemingly","different","learning\nalgorithms","can","be","viewed","as","special","cases","of","the","PAC-Bayesian\nframework.\nRemarkII.3","(Using","infinite","past","filters).Theorem","II.1","and","the\ndiscussion","above","remains","true,","if","we","replace\nˆ\nL\ny,N\n(f)by","the\nalternative","definitionV\ny,N\n(f)from","(8).\nIII.","","PAC-BAYESIAN","FRAMEWORK","FOR","","STOCHASTICLTI\nSYSTEMS\nIn","","this","","paper","","we","","will","","derive","","a","","PAC-Bayesian","","bound","","for\nlearning","stochastic","LTI","systems","without","inputs.","More","precisely,\nwe","will","assume","that","data","generating","processyis","the","output","of\na","","stochastic","","LTI","","system,","","and","","that","","the","","class","","of","","models","","is","","that\nof","the","class","of","stochastic","LTI","systems","without","inputs.\nThis","","latter","","point","","necessitates","","some","","explanation.","","As","","it","","was\npointed","out","in","the","beginning","of","the","paper,","stochastic","dynamical\nsystems","","can","","be","","interpreted","","as","","generators","","of","","stochastic","","pro-\ncesses,","parametrizations","of","distributions","and","predictors,","and","in\na","sense","these","three","points","of","view","are","equivalent.\nIn","system","identification,","the","objective","of","learning","is","formu-\nlated","","as","","finding","","a","","model","","which","","approximately","","generates","","the\nsame","","observed","","behavior","","as","","the","","underlying","","physical","","system.\nIn","","Section","","II","","we","","formulate","","the","","learning","","problem","","as","","that","","of\nfinding","","the","","best","","possible","","predictor","","fory.","","In","","fact,","","it","","turns\nout","","that","","for","","the","","case","","of","","stochastic","","LTI","","systems,","","these","","two\nobjectives","are","essentially","equivalent,","in","the","sense","that","there","is\na","","correspondence","","between","","best","","predictor","","ofyand","","stochastic\nLTI","","systems","","whose","","output","","isy.","","We","","will","","come","","back","","to","","this\npoint","after","having","set","up","the","formal","mathematical","framework.\nA","stochastic","LTI","is","a","system","of","the","form\nx(t+","1)","=Ax(t)","+Bv(t)\n","̃\ny(t)","=Cx(t)","+Dv(t)\n(16)\nwhereA∈R\nn×n\n,B∈R\nn×m\n,C∈R\np×n\n,D∈R\np×m\nfor\nn≥0,m,p",">0andx,\n","̃\nyandvare","","zero-mean","","square-\nintegrable","stationary","stochastic","process","with","values","inR\nn\n,R\np\n,\nandR\nm\nrespectively.","","The","","processesx,yandvare","","called\nstate,","","output","","and","","noise","","process,","","respectively.","","Furthermore,\nwe","","require","","thatAis","","stable","","(all","","its","","eigenvalues","","are","","inside\nthe","","open","","unit","","circle)","","and","","that","","for","","anyt,k∈Z,k≥0,\nE[v(t)v\nT\n(t−k−1)]","","=","","0,E[v(t)x\nT\n(t−k)]","","=","","0,","","i.e.,v(t)\nis","","white","","noise","","and","","uncorrelated","","withx(t−k).","","We","","identify\nthe","","system","","(16)","","with","","the","","tuple(A,B,C,D,v);","","note","","that\nthe","","state","","processxis","","uniquely","","defined","","by","","the","","infinite","","sum\nx(t)","=\n∑\n∞\nk=1\nA\nk−1\nBv(t−k).","We","say","that","the","the","stochastic\nLTI","","system","","is","","a\nrealization","","of","","the","","processy,","","if","","its","","output\n","̃\ny\ncoincides","withy,","i.e.,y(t)","=\n","̃\ny(t)","=Cx(t)","+Dv(t).\nIt","","is","","well-known","","[13],","","that","","ifyhas","","a","","realization","","by","","a","","LTI\nsystem,","then","it","has","a","realization","by","a","minimal","LTI","system","in\nforward","innovation","form,","i.e.,","and","LTI","system(A,K,C,I,e)\nsuch","","thatIis","","the","","identity","","matrix,(A,K)is","","controllable,\n(C,A)is","observable,","andeis","the\ninnovationprocess","ofy.\nTo","","recall","","the","","notion","","of","","an","","innovation","","process,","","we","","need\nthe","","following.","","Denote","","byHthe","","Hilbert","","space","","of","","zero-mean\nsquare-integrable","","real","","valued","","random","","variables,","","where","","the\ninner","product","between","two","random","variablesy,zisE[yz].","The\nHilbert","space","generated","by","a","setU⊂His","the","smallest","(w.r.t.\nset","","inclusion)","","closed","","subspace","","ofHwhich","","containsU.","","We\ndenote","byE\nl\n[z|U]the","orthogonal","projection","ofzontoU,","see\n[13]","","for","","details.","","For","","a","","zero-mean","","square-integrable","","stocastic\nprocessz(t)∈R\np\n,","","we","","letE\nl\n[z(t)|U]","=","[\nˆ\nz\n1\n(t),...,\nˆ\nz\nk\n(t)]\nT\n,\nwhere\nˆ\nz\ni\n(t)","=E\nl\n[z\ni\n(t)|U],i=","1,...,k.","That","is,E\nl\n[z(t)|U]is\nthe","random","variable","with","values","inR\np\nobtained","by","projecting\nthe","coordinates","ofz(t)ontoU.","Accordingly,","the","orthogonality\nof","","a","","multidimensional","","random","","variable","","to","","a","","closed","","subspace\ninHis","meant","element-wise.\n\nFor","","the","","stochastic","","processydenote","","byH\ny\nt−\nthe","","closed\nsubspace","","ofHgenerated","","by","","the","","set{`\nT\ny(s)|s∈Z,s","<\nt,`∈R\np\n}formed","by","the","past","values","ofy.","We","call","the","process\ne(t)",":=y(t)−E\nl\n[y(t)|H\ny\nt−\n],∀t∈Z\nthe(forward)innovationprocess","ofy,","that","is,","the","innovation\nprocess","is","the","difference","betweenyand","its","orthogonal","projec-\ntion","to","its","past.","The","varianceE[e\nT\n(t)e(t)]gives","us","the","minimal\nprediction","","error","","which","","is","","attainable","","by","","trying","","to","","predicty(t)\nas","a","linear","function","of","the","past","values{y(s)}\ns<t\n.\nMinimal","","realizations","","in","","forward","","innovation","","form","","of","","a","","pro-\ncess","","are","","unique","","up","","to","","a","","linear","","isomoprhism.","","We","","will","","say\nthat","the","processyis\ncoercive,","if","it","has","a","minimal","realization\n(A,K,C,I,e)in","forward","innovation","form","such","thatA−KCis\nstable.","Since","all","minimal","realization","ofyin","forward","innovation\nform","","are","","isomorphic,","","the","","stability","","ofA−KCwill","","hold","","for\nany","minimal","realization","ofy.\nAssumption","","III.1.In","","the","","sequel","","we","","assume","","thatycan","","be\nrealized","by","a","stochastic","LTI","system","andyis","coercive.\nCoercivity","","","ofyimplies","","","that","","","any","","","minimal","","","realization\n(A,K,C,I,e)ofyin","","forward","","innovation","","form,","","defines","","a\nlinear","map{y(s)}\nt−1\ns=−∞\n7→\nˆ\ny(t)as","follows:\nx(t+","1)","=","(A−KC)x(t)","+Ky(t),\nˆ\ny(t)","=Cx(t).(17)\nIn","","fact,\nˆ\ny(t)is","","the","","projection","","ofy(t)onto","","the","","Hilbert-space\ngenerated","","by","","the","","past","","values{y(s)}\nt−1\ns=−∞\nofy,","","i.e.,\nˆ\ny(t)","=\nE\nl\n[y(t)|H\ny\nt−\n].","Note","thaty(t)−\nˆ\ny(t)","=e(t),","i.e.,E[‖y(t)−\nˆ\ny(t)‖\n2\n2\n]is","minimal","among","all","linear","mappings{y(s)}\nt−1\ns=−∞\n7→\nˆ\ny(t),","","or","","all","","such","","mappings,","","ifyis","","Gaussian.","","That","","is,","","any\nminimal","realization","ofyin","forward","innovation","form","yields","an\noptimal","predictor.\nThe","discussion","above","prompts","us","to","define","the","set","of","models\nas","follows.","LetΣ","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)be","a","tuple","of","matrices","such","that\nˆ\nAand\nˆ\nA−\nˆ\nK\nˆ\nCare","","stable.","","Define","","the","","mapf\nΣ\n:Y\n∗\n→","Yas\nfollows:\nf\nΣ\n(y\n1\n,...,y\nk\n)","=\nk\n∑\nt=1\nˆ\nC(\nˆ\nA−\nˆ\nK\nˆ\nC)\nk−t\nˆ\nKy\nt\n(18)\nIn","","other","","words,\nˆ\ny\nf\nΣ\n(t|s)is","","the","","output","","at","","timetof","","the\nfollowing","dynamical","system:\nx\nΣ\n(t+","1|s)","=","(\nˆ\nA−\nˆ\nK\nˆ\nC)x\nΣ\n(t|s)","+\nˆ\nKy(t),x\nΣ\n(s|s)","=","0\nˆ\ny\nf\nΣ\n(t|s)","=\nˆ\nCx\nΣ\n(t|s)\n(19)\nThat","","isf\nΣ\nis","","the","","input-output","","map","","of","","the","","deterministic","","LTI\nsystem(\nˆ\nA−\nˆ\nK\nˆ\nC,\nˆ\nK,\nˆ\nC).\nIt","","is","","clear","","that","","the","","functionf\nΣ\nis","","a","","model","","in","","the","","sense\nof","","Definition","","II.1,","","sincef\nΣ\nis","","generated","","by","","matricesM\nk\n=\nˆ\nC(\nˆ\nA−\nˆ\nK\nˆ\nC)\nk−1\nˆ\nKwhich","are","Markov","parameters","of","the","stable\ndeterministic","","LTI","","system((\nˆ\nA−\nˆ\nK\nˆ\nC),\nˆ\nK,\nˆ\nC),","","and","","hence","","the\nsequence{M\nk\n}\n∞\nk=1\nis","absolutely","summable.\nIn","particular,","the","limit\nˆ\ny\nf\nΣ\n(t)","=","lim\ns→−∞\nˆ\ny\nf\nΣ\n(t|s)exists\nin","the","mean","square","sense","uniformly","int,","and\nˆ\ny\nf\nΣ\n(t)","=\n∞\n∑\nt=1\nˆ\nC(\nˆ\nA−\nˆ\nK\nˆ\nC)\nk−1\nˆ\nKy(t−k),(20)\nin","other","words,\nˆ\ny\nf\nΣ\n(t)is","the","output","of","the","following","dynamical\nsystem\nx\nΣ\n(t+","1)","=","(\nˆ\nA−\nˆ\nK\nˆ\nC)x\nΣ\n(t)","+\nˆ\nKy(t)\nˆ\ny\nf\nΣ\n(t)","=\nˆ\nCx\nΣ\n(t)\n(21)\nRecall","","from","","Section","","II","","that","","for","","the","","formulation","","of","","PAC-\nBayesian","framework","we","need","to","define","a","parametrized","set","of\nmodels.","In","order","to","do","so,","we","remark","that","two","different","tuples\nΣandΣ\n′\nmay","yield","the","same","modelf\nΣ\n=f\nΣ\n′\n.","However,","this\nsource","of","non-uniqueness","can","be","eliminated","by","using","minimal\ntuple.","Let","us","call","the","tupleΣ","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)\nminimal,","if(\nˆ\nA,\nˆ\nK)\nis","","a","","controllable","","pair,(\nˆ\nA,\nˆ\nC)is","","an","","observable","","pair,","","and\nˆ\nA,\nˆ\nA−\nˆ\nK\nˆ\nCare","stable.","From","standard","realization","theory","we","can\nderive","the","following","simple","result:\nLemma","","III.1.\n•IfΣ","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)is","","a","","tuple","","such","","that\nˆ\nAand\nˆ\nA−\nˆ\nK\nˆ\nC\nare","stable,","then","there","exists","a","minimal","tupleΣ\nm\nsuch","that\nf\nΣ\n=f\nΣ\nm\n.\n•IfΣ","","","=","","","(\nˆ\nA,\nˆ\nK,\nˆ\nC)andΣ\n′\n=","","","(\nˆ\nA\n′\n,\nˆ\nK\n′\n,\nˆ\nC\n′\n)are","","two\nminimal","","tuples,","","thenf\nΣ\n=f\nΣ\n′\nimplies","","thatΣandΣ\n′\nare","isomorphic,","i.e.","there","exists","a","nonsingular","matrixT,\nsuch","that\nˆ\nA\n′\n=T\nˆ\nAT\n−1\n,\nˆ\nK\n′\n=T\nˆ\nK,","and\nˆ\nC\n′\n=\nˆ\nCT\n−1\n.\nThat","","is,","","it","","is","","enough","","to","","consider","","models","","which","","arise","","from\nminimal","","tuples.","","Moreover,","","we","","will","","consider","","parametrizations\nof","","models","","which","","arise","","via","","parametrizing","","minimal","","tuples","","and\nin","which","there","are","no","two","isomorphic","minimal","tuples.\nMore","","precisely,","","we","","consider","","a","","family","","of","","modelsFwhich\nsatisfies","the","following","assumption.\nAssumption","","III.2.There","","exists","","a","","measure","","space(Θ,B,m)\nand","a","map\nΣ",":","Π→(R\nn×n\n×R\nn×p\n×R\np×n\n)\nsuch","that","the","set","of","models","is","defined","by\nF={f\nΣ(θ)\n|θ∈Θ},\nand","the","following","holds.\n•For","anyθ∈Θ,Σ(θ)is","a","minimal","tuple,\n•For","anyθ\n1\n,θ\n2\n∈Θ,","the","tuplesΣ(θ\n1\n)andΣ(θ\n2\n)are","not\nisomorphic,","i.e.,","the","mapΘ3θ7→f\nΣ(θ)\n∈","Fis","a","one-\nto-one","function.\n•There","","existsθ\n0\nsuch","","thatΣ(θ\n0\n)","","=","","(A\n0\n,K\n0\n,C\n0\n)and\n(A\n0\n,K\n0\n,C\n0\n,I,e)is","","a","","minimal","","realization","","ofyin","","for-\nward","innovation","form\nThe","","intuition","","behind","","these","","assumptions","","is","","as","","follows.","","The\nsetFof","","models","","under","","consideration","","arises","","by","","parametrizing\na","","subset","","of","","tuples","","which","","then","","give","","rise","","to","","models","","as","","defined\nin","","(18).","","The","","first","","assumption","","says","","that","","we","","parametrizeFin\nsuch","","a","","manner","","that","","each","","parameter","","value","","corresponds","","to","","a\nminimal","","tuple.","","This","","is","","not","","a","","real","","constraints,","","as","","if","","for","","some\nparameter","","values","","the","","corresponding","","tuple","","of","","matrices","","is","","not\na","","minimal","","tuple,","","then","","by","","Lemma","","III.1","","we","","can","","replace","","it","","by\na","","minimal","","tuple","","which","","gives","","rise","","to","","the","","same","","model.","","Hence,\nsuch","a","replacement","will","not","change","the","set","of","modelsF.","The\n\nsecond","condition","means","that","there","are","no","two","parameter","values\nwhich","","give","","rise","","to","","the","","same","","input-output","","map.","","Finally,","","the\nthird","","assumption","","says","","thatFcontains","","a","","model","","arising","","from\na","realization","ofy.","The","latter","point","is","quite","useful","in","terms","of\nrelating","the","learning","problem","formulated","in","Section","II","with","the\nusual","formulation","of","the","system","identification","problem.\nThat","is,","the\nmodelwhicharisesfromtherealizationofyis\nthemodelwiththeleastgeneralizationerror.","In","fact,\nLemma","","III.2.If\nθ\n∗\n=","argmin\nθ∈Θ\nL\n`\ny\n(f\nθ\n),\nthen(A\n0\n,K\n0\n,C\n0\n,I,e)is","","a","","minimal","","realizaion","","ofy,","","where\nΣ(θ\n∗\n)","=","(A\n0\n,K\n0\n,C\n0\n).\nLemma","III.2","means","that","trying","to","find","a","modelFbased","on\nsampled","data","is","equivalent","to","finding","the","element","ofFwhich\ncorresponds","","to","","a","","realization","","ofy.","","In","","fact,","","even","","if","","we","","cannot\nfind","the","model","with","the","smallest","generalization","error","exactly,\nthis","can","still","be","interpreted","as","finding","a","stochastic","LTI","system\noutput","of","which","is","close","toy.","More","precisely,","if","the","parameter\nsetΘis","a","topological","space","and","ifΣ(θ)is","continuous","inθand\nif","we","findθ∈Θsuch","thatθis","close","toθ\n0\n,","then","the","matrices\nofΣ(θ)","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)will","be","close","toΣ(θ\n0\n)","=","(A\n0\n,K\n0\n,C\n0\n).\nIt","","then","","follows","","that","","the","","output","","of","","the","","stochastic","","LTI","","system\n(\nˆ\nA,\nˆ\nK,\nˆ\nC,e)will","be","close","toy.\nNow","we","are","able","to","state","the","main","result","on","PAC-Bayesian\nerror","bound","for","stochastic","LTI","systems.\nTheorem","","III.1.Assume","","thatyandFsatisfy","","Assumption\nIII.1–III.2","and","thatyis","jointly","Gaussian.","For","any","two","densities\nπandˆρonF,δ∈(0,1],","and","a","real","numberλ",">0,(10)holds,\nwhere\nΨ\n`,π\n(λ,N)≤u\n`,π\n(λ,N)(22)\nwith\nu\n`,π\n(λ,N)","=","lnE\nθ∼π\n[\nexp","(λv(θ))\n(\n1+\nλρ\nN\n(θ)\nN\n2\n)\npN\n2\n]\n,(23)\nand","the","numberv(θ)andρ\nN\n(θ)are","defined","as","follows:\nv(θ)","=L\n`\ny\n(f\nθ\n)(24)\nand\nρ\nN\n(θ)","=min(eig(E\n[\nz\n1:N\n(f\nθ\n)z\nT\n1:N\n(f\nθ\n)\n]\n))(25)\nwith\nz\n1:N\n(f\nθ\n)","=\n\n\n\n(y(1)−\nˆ\ny\nf\nθ\n(1|0))\n.\n.\n.\n(y(N)−\nˆ\ny\nf\nθ\n(N|0))\n\n\n\n(26)\nProof","Theorem","III.1.The","proof","follows","the","same","lines","as","that\nof","","[17,","","Theorem","","2],","","for","","the","","sake","","of","","completeness","","we","","repeat\nthe","basic","steps.","From","Theorem","II.1","it","follows","that","(11)","holds\nwith","","probability","","at","","least1−δ.","","Consider","","a","","random","","variable\nz\ni\n(f\nθ\n)","","=y(i)−ˆy\nf\nθ\n(i|0).","","Just","","like","","in","","the","","proof","","of","","[17,\nTheorem","2],\nΨ\n`,π\n(λ,N)","=","lnE\nf∼π\nE[e\nλ(L\n`\ny\n(f)−\nˆ\nL\n`\ny,N\n(f)\n]","=\n=","lnE\nf∼π\ne\nλL\n`\ny\n(f)\nE\n[\ne\n−λ\nˆ\nL\n`\ny,N\n(f)\n]\n=\n=","lnE\nf∼π\ne\nλL\n`\ny\n(f)\nE\n[\ne\n−\nλ\nN\n∑\nN\ni=1\nz\nT\ni\n(f\nθ\n)z\ni\n(f\nθ\n)\n]\n(27)\nSincez\ni\n(f\nθ\n)is","","a","","linear","","combination","","of{y(s)}\ni\ns=0\n,","","andyis\nzero","","mean","","Gaussian","","process,","","it","","follows","","thatz\ni\n(f\nθ\n)is","","zero\nmean","","Gaussian","","with","","covarianceQ\nz\ni\n(f\nθ\n)\n=E[z\ni\n(f\nθ\n)z\nT\ni\n(f\nθ\n)].\nNotice","","that","","the","","variablez\n1:N\n(f\nθ\n)from","","(26)","","is","","of","","the","","form\nz\n1:N\n(f\nθ\n)","=\n\n\n\nz\n1\n(f\nθ\n)\n.\n.\n.\nz\nN\n(f\nθ\n)\n\n\n\n.","Define\nS(f\nθ\n)","=Q\n−1/2\nz\n1:N\n(f\nθ\n)\nz\n1:N\n(f\nθ\n)\nwhereQ\nz\n1:N\n(f\nθ\n)\n=E[z\n1:N\n(f\nθ\n)z\nT\n1:N\n(f\nθ\n)]and","letS\ni\nbe","theith\nentry","","ofS,","","i.e.,S=\n[\nS\n1\n...","","S\npN\n]\nT\n.","","Then","","from","","(27)","","it\nfollows","that\nN\n∑\ni=1\nz\nT\ni\n(f\nθ\n)z\ni\n(f\nθ\n)","=z\n1:N\n(f\nθ\n)\nT\nz\n1:N\n(f\nθ\n)","=\n=z\n1:N\n(f\nθ\n)\nT\nQ\n−1/2\nz\n1:N\n(f\nθ\n)\nQ\nz\n1:N\n(f\nθ\n)\nQ\n−1/2\nz\n1:N\n(f\nθ\n)\nz\n1:N\n(f\nθ\n)","=\nS\nT\n(f\nθ\n)Q\nz\n1:N\n(f\nθ\n)S(f\nθ\n)≥S\nT\n(f\nθ\n)S(f\nθ\n)ρ\nN\n(θ)","=\n(\npN\n∑\ni=1\nS\ni\n(f\nθ\n)\n2\n)ρ\nN\n(θ)\n(28)\nIt","then","follows","that\ne\n−\nλ\nN\n∑\nN\ni=1\nz\nT\ni\n(f\nθ\n)z\ni\n(f\nθ\n)\n=e\n−\nλ\nN\nz\nT\n1:N\n(f\nθ\n)z\n1:N\n(f\nθ\n)\n≤\ne\n−\nλ\nN\nρ\nN\n(θ)(\n∑\nNp\ni=1\nS\n2\ni\n(f\nθ\n))\n(29)\nNotice","","now","","thatS(f\nθ\n)is","","Gaussian","","and","","zero","","mean,","","with\ncovariance\nE[S(f\nθ\n)S\nT\n(f\nθ\n)]","=Q\n−1/2\nz\n1:N\n(f\nθ\nE[z\n1:N\n(f\nθ\n)z\nT\n1:N\n(f\nθ\n)]Q\n−1/2\nz\n1:N\n(f\nθ\n)\n=\n=Q\n−1/2\nz\n1:N\n(f\nθ\n)\nQ\nz\n1:N\n(f\nθ\n)\nQ\n−1/2\nz\n1:N\n(f\nθ\n)\n=I\nThat","","","is,the","","","random","","","variablesS\ni\n(f\nθ\n)are","","","normally","","","dis-\ntributed","","andS\ni\n(f\nθ\n),S\nj\n(f\nθ\n)are","","independent,","","and","","therefore\n∑\nNp\ni=1\nS\n2\ni\n(f\nθ\n)hasχ\n2\ndistribution.","Hence,\nE[e\n−\nλρ\nN\n(θ)\nN\n(\n∑\nNp\ni=1\nS\n2\ni\n(f\nθ\n)\n]","=\n1\n(1","+\nλρ\nN\n(θ)\nN\n2\n)\npN\n2\nCombining","","this","","with","","(29)","","and","","(27)","","implies","","the","","statement","","of\nthe","theorem.\nA.","","Discussion","of","the","error","bound\nBelow","","we","","will","","make","","a","","number","","of","","remarks","","concerning","","the\nerror","bound","(22).\n\na)","","Asymptotic","convergence","ofΨ\n`,π\n(λ,N):\nLemma","III.3.For","some","subsequenceN\nk\n,lim\nk→∞\nN\nk\n=∞,\nlim\nk→∞\nΨ\n`,π\n(λ,N\nk\n)","=","0.\nThis","","result","","indicates","","thatΨ\n`,π\n(λ,N)cannot","","converge","","to\ninfinity","","or","","to","","a","","non-zero","","constant.","","This","","also","","indicates","","the\npossibility","thatΨ\n`,π\n(λ,N)might","converge","to","zero","asN→∞.\nb)","","Behavior","","of","","the","","upper","","bound","","asN→","∞,","","conserva-\ntivity","of","the","result:Lemma","(III.3)","also","suggests","that","the","upper\nbound","(22)","is","a","conservative","one,","as","the","upper","bound","does","not\nconverge","to0.","In","fact,","the","following","holds.\nLemma","","","III.4.The","","","sequenceρ\nN\n(θ)is","","","decreasing","","","and\nlim\nN→∞\nρ\nN\n(θ)","","=ρ\n∗\n(θ)>","μ\n∗\n>0.","","In","","particular,","","if","","the\nspectral","","density","","ofyis","","denoted","","byΦ\ny\n,","","thenμ\n∗\n>0can\nbe","","taken","","such","","thatΦ\ny\n(e\niθ\n)>","μ\n∗\nIfor","","allθ∈[−π,π].","","In\nparticular,","in","this","casev(θ)>","pμ\n∗\n.\nLemma","III.4","says","thatρ\nN\n(θ)is","bounded","from","below.\nLemma","","III.5.\nlnE\nθ∼π\n[e\nλ(v(θ)−pρ\n0\n)\n]≤lim\nN→∞\nu\n`,π\n(λ,N)≤lnE\nθ∼π\n[e\nλ(v(θ)−pμ\n∗\n)\n],\nwhereμ\n∗\nis","","as","","in","","Lemma","","III.4,","","andρ\n0\nis","","the","","smallest\neigenvalue","ofE[y(t)y\nT\n(t)]\nLemma","","III.5","","together","","with","","Lemma","","III.3","","indicates","","that","","the\nupper","","bound","","of","","Theorem","","III.1","","might","","be","","quite","","conservative:\nwhileΨ\n`,π\n(λ,N)converges","to","zero","for","a","suitable","strictly","in-\ncreasing","sequence","of","integersN\nk\n,","the","upper","boundu\n`,π\n(λ,N)\nis","bounded","from","below","in","the","limit.","Note","thaty(t)is","an","i.i.d\nprocess","","with","","varianceσI\np\n,","","thenρ\n0\n=σ=μ\n∗\nand","","the","","upper\nand","lower","bounds","of","Lemma","III.5","coincide.\nThe","problem","of","finding","a","tight","PAC-Bayesian","upper","bound\nfor","","LTI","","systems","","seems","","to","","be","","a","","challenging","","problem.","","In","","fact,\nthe","","first","","PAC-Bayesian","","upper","","bound","","for","","linear","","regression","","[7]\nwith","i.i.d.","data","had","the","same","drawback,","namely,","the","part","of","the\nupper","bound","on","the","term","which","corresponds","toΨ\n`,π\n(λ,N)did\nnot","converge","to","zero","asN→∞.","This","drawback","for","eliminated\nin","[17]","for","linear","regression","with","i.i.d","data,","but","not","for","linear\nregression","with","non","i.i.d.","data.","In","the","light","of","this","development,\nthe","conservativity","of","our","error","bound","is","not","surprising.\nUpper","","bound","","not","","involvingNand","","expectation","","over","","the\nprior:Finally,","","we","","can","","formulate","","a","","non-asymptotic","","upper\nbound","similar","to","that","of","Lemma","III.5\nLemma","","III.6.\nu\n`,π\n(λ,N)≤lnE\nθ∼π\n[e\nλ(v(θ)−\npμ\n∗\npN∗0.5\nλpμ\n∗\n+0.5pN\n)\n]≤\n≤E\nθ∼π\n[e\nλ(v(θ)\n]−\nλpμ\n∗\n0.5\nλpμ\n∗\n+","0.5\nwhereμ\n∗\nis","as","in","Lemma","III.4\nThe","","result","","of","","Lemma","","III.5","","–","","III.6","","could","","be","","used","","to","","derive\nfurther","PAC-Bayesian","error","bounds.","In","fact,\nlim\nN→∞\nlnE\nθ∼π\n[e\nλ(v(θ)−pμ\n∗\n)\n]","=","lnE\nθ∼π\n[e\nλ(v(θ))\n]−pμ\n∗\n,\nso","any","upper","bound","onlnE\nθ∼π\n[e\nλ(v(θ))\n]yields","an","upper","bound\non","the","limit","ofu\n`,π\n(λ,N).","Alternatively,","we","can","also","use","the\nnon-asymptotic","bound","from","Lemma","III.6.","In","particular,","if\nK\n1\n<","v(θ)<","K\n2\nfor","everyθ,","then\nK\n1\n−pρ\n0\n≤lim\nN→∞\nu\n`,π\n(λ,N)≤K\n2\n−pμ\n∗\n(30)\nu\n`,π\n(λ,N)≤K\n2\n−\n0.5pμ\n∗\npμ\n∗\n+0.5\n(31)\nThe","latter","bounds","do","not","depend","on","the","prior,","but","only","the\nboundsK\n1\n,K\n2\nand","","the","","constantsρ\n0\n>","μ\n∗\n,","","which,","","in","","turn,\nrepresent","","some","","mild","","assumptions","","on","","the","","distribution","","ofy.\nFurthermore,","","it","","is","","easy","","to","","see","","from","","the","","discussion","","in","","Section\nIII-B","","thatv(θ)is","","a","","continuous","","function","","ofθ,","","hence,","","for","","a\ncompact","","parameter","","setΘthe","","boundsK\n1\n,K\n2\nwill","","exist","","and\nthey","could","be","estimated","based","on","the","parametrization.","That","is,\n(30)","could","readily","be","applied","in","this","case.\nIn","","turn,","","(30)","","together","","with","","Theorem","","III.1","","and","","(10)","","yields\nbounds","","for","","the","","average","","generalization","","error","","of","","the","","posterior\nfor","a","certain","choice","ofNandλ.\nc)","","Using","","the","","alternative","","definition","","of","","empirical","","loss","","in-\nvolving","","infinite","","past","","filters:Recall","","from","","Remark","","II.2","","the\nalternative","definition","of","empirical","loss,","which","uses","the","infinite\npast","","prediction\nˆ\ny\nf\n(t),","","instead","","of","","the","","finite","","past","","prediction\nˆ\ny\nf\n(t|0).","We","could","have","stated","Theorem","II.1","withV\ny,N\n(f\nθ\n)\ninstead","of\nˆ\nL\ny,N\n(f\nθ\n)and","we","could","have","stated","Theorem","III.1\ntoo,","with","the","difference","thatz\n1:N\n(f\nθ\n)","=\n\n\n\n(y(1)−\nˆ\ny\nf\nθ\n(1))\n.\n.\n.\n(y(N)−\nˆ\ny\nf\nθ\n(N))\n\n\n\n.\nIn","","","particular,","","","with","","","these","","","changes","","","in","","","mind","","","the","","","discussion\nabove","","still","","holds,","","but","","the","","proofs","","simplify","","a","","lot.","","In","","particular,\nE[z\n1:N\n(f\nθ\n)z\n1:N\n(f\nθ\n)\nT\n]has","","the","","Toepliz-matrix","","structure,","","as\ny(t)−\nˆ\nf\nf\nθ\n(t)is","a","wide-sense","stationary","process.\nd)","","PAC-Bayesian","error","bounds","and","system","identification:\nAs","it","was","pointed","out","in","Subsection","II,","the","derived","error","bound\ntogether","","with","","the","","Gibbs","","posterior","","distribution","","(13)","","leads","","to\nlearning","algorithms.","In","particular,","choosing","a","modelfwhich\nmaximizes","","the","","likelihood","","of","","the","","Gibbs","","posterior","","amounts","","to\nminimizing","","the","","cost","","function","","(15).","","In","","particular,","","forλ=","","1\nandπbeing","","the","","uniform","","distribution,","","the","","cost","","function","","(15)\nbecomes","","the","","empirical","","loss.","","The","","algorithm","","which","","calculates\nthe","model","minimizing","(15)","then","corresponds","to","prediction","error\nminimization","[14].","Note","that","in","the","theoretical","analysis","of","the\nprediction","error","approach,","usually","the","prediction","error","(8)","using\nthe","","infinite","","past","","is","","used.","","As","","it","","was","","pointed","","out","","in","","Remark\nII.2,","","for","","large","","enoughN,","","the","","latter","","prediction","","error","","is","","close\nto","","the","","empirical","","loss","","with","","a","","high","","probability.","","In","","fact,","","in","","the\npractical","","implementation","","of","","prediction","","error","","method","","usually\nthe","","empirical","","error","","(7)","","is","","used.","","The","","various","","other","","choices","","of\nλand","","the","","priorπwhen","","minimizing","","(15)","","amount","","to","","mini-\nmizing","","the","","prediction","","error","","with","","a","","regularization","","term.","","Other\nmethods","for","sampling","from","the","posterior","will","lead","to","different\nsystem","identification","algorithms.","Investigating","the","relationship\nbetween","","the","","thus","","arising","","algorithms","","and","","the","","existing","","system\nidentification","algorithms","remains","a","topic","of","future","research.\n\nB.","","Computingu\n`,π\n(λ,N)\nThe","","value","","ofu\n`,π\n(λ,N)can","","be","","computed","","using","","sequen-\ntial","","Monte-Carlo","","[4].","","In","","details,","","sample","","a","","set","","of","","parameters\nΘ","={θ\ni\n}\nN\nf\ni=1\n,","","according","","to","","the","","prior","","distributionθ\ni\n∼π(θ).\nThen","for","large","enoughN\nf\nthe","right-hand","side","of","(22)","can","be\napproximated","by\nln\n\n\n\n1\nN\nf\nN\nf\n∑\ni=1\nexp","(λv(θ\ni\n))\n(\n1","+\nλρ\n∗\n(θ\ni\n)\nN\n2\n)\nN\n2\n\n\n\n(32)\nFor","","everyθ\ni\ndrawn","","from","","the","","prior","","distributionπ(θ),","","the\nquantitiesv(θ\ni\n)andρ\n∗\n(θ\ni\n)can","be","calculated","as","follows.","Given\nthe","","system","","in","","forward","","innovation","","form(A\n0\n,K\n0\n,C\n0\n)and","","a\npredictorf\nθ\ni\nwith\nΣ(θ\ni\n)","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)","=","(\nˆ\nA(θ\ni\n),\nˆ\nK(θ\ni\n),\nˆ\nC(θ\ni\n)).\nDefine","a","system(A\ne\n,K\ne\n,C\ne\n,I,e),","whose","output","is","the","error\nz(t)","=y(t)−\nˆ\ny\nf\nθ\ni\n(t|0),\n[\nx(t+","1)\nˆ\nx(t+","1)\n]\n︸\n︷︷︸\n","̃\nx(t+1)\n=\n[\nA\n0\n0\nˆ\nKC\n0\nˆ\nA−\nˆ\nK\nˆ\nC\n]\n︸\n︷︷︸\nA\ne\n[\nx(t)\nˆ\nx(t)\n]\n︸︷︷︸\n","̃\nx(t)\n+\n[\nK\n0\nˆ\nK\n]\n︸\n︷︷︸\nK\ne\ne(t),\nz(t)","=\n[\nC\n0\n−\nˆ\nC\n]\n︸︷︷︸\nC\ne\n[\nx(t)\nˆ\nx(t)\n]\n+e(t),\n[\nx(0)\nˆ\nx(0)\n]\n=\n[\n∑\n∞\nk=1\nA\nk−1\n0\nK\n0\ne(−k)\n0\n]\n,\nP\n0\n=\n[\nP\nx\n0\n00\nn×n\n]\n,\n(33)\nwhereP\nx\n=E[x(0)x(0)\nT\n]is","","the","","steady-state","","covariance,\nwhich","satisfies","the","Lyapunov","equation\nP\nx\n=A\n0\nP\nx\nA\nT\n0\n+K\n0\nQ\ne\nK\nT\n0\n,(34)\nwithQ\ne\n=E[e(t)e(t)\nT\n].","","In","","practice,","","the","","numerical","","value","","of\nthe","","initial","","conditionx(0)is","","chosen","","based","","on","","the","","particular\napplication.","Thenv(θ)corresponds","to","the","second","moment","of\nthe","random","variablez(t)\nv(θ)","=E\n[\n∑\nz\n2\ni\n]\n=trace(E[z(t)z(t)\nT\n]","=\n=trace(C\ne\nP\ne\nC\nT\ne\n+Q\ne\n).(35)\nThe","covariance","matrixP\ne\nis","the","solution","to","Lyapunov","equation\nP\ne\n=A\ne\nP\ne\nA\nT\ne\n+K\ne\nQ\ne\nK\nT\ne\n.(36)\nNow,","","define","","the","","joint","","covariance","","matrixQ\nz,N\nof","","the","","random\nvariablez\n1:N\n=","[z(1),...,z(N)]\nT\nas\nQ\nz,N\n=E[z\n1:N\nz\nT\n1:N\n],(37)\ni.e.,","theijthp×pblock","matrix","element(Q\nz,N\n)\nij\nofQ\nz,N\nis\nE[z(i)z(j)\nT\n].","Expanding","(37)","with\nz\n1:N\n=\n\n\n\n\n\nC\ne\nC\ne\nA\ne\n.\n.\n.\nC\ne\nA\nN\ne\n\n\n\n\n\n","̃x\ne\n(0)+\n\n\n\n\n\nI000\nC\ne\nA\n0\ne\nK\ne\nI00\n.\n.\n.\n.\n.\n.\n0\nC\ne\nA\nN−1\ne\nK\ne\n...","","C\ne\nA\n0\ne\nK\ne\nI\n\n\n\n\n\n\n\n\ne(0)\n.\n.\n.\ne(N)\n\n\n\n,\n(38)\nyields\n(Q\nz,N\n)\nij\n=\n\n\n\n\n\nC\ne\nP\ni−1\nC\nT\ne\n+Q\ne\nifi=j\n(C\ne\nP\ni−1\nA\nT\ne\n+Q\ne\nK\nT\ne\n)(A\nj−i−1\ne\n)\nT\nC\nT\ne\nifi","<","j\nC\ne\n(A\ni−j−1\ne\n)(A\ne\nP\nj−1\nC\nT\ne\n+K\ne\nQ\ne\n)ifi",">","j\n(39)\nwith\nP\ni+1\n=A\ne\nP\ni\nA\nT\ne\n+K\ne\nQ\ne\nK\nT\ne\n.(40)\nThe","state","covariancesP\ni\n,","are","computed","under","the","assumption\nthat","the","stochastic","processy(t)has","non-zero","state","and","covari-\nance","att=","0,","encoding","the","infinite","past.\nIV.","","ILLUSTRATIVEEXAMPLE\nConsider","","a","","stochastic","","processy(t),","","defined","","by","","the","","LTI\nsystem\nx(t+","1)","=\n[\n0.51\n00.5\n]\nx(t)","+\n[\n1","","","","0\n0","","","","1\n]\nv(t)\ny(t)","=\n[\n1","","","","0\n]\nx(t)","+\n[\n1","","","","0\n]\nv(t)\nv(t)∼N(0,1)\n(41)\nGiven","a","realisation","ofy(t)ofN=","100samples,","we","wish","to\nestimate","a","parameterθof","the","system\nˆ\nx(t+","1)","=\n[\n0.51\n00.5","+θ\n]\nˆ\nx(t)","+\n[\n1","","","","0\n0","","","","1\n]\nv(t)\nˆ\ny(t)","=\n[\n1","","","","0\n]\nˆ\nx(t)","+\n[\n1","","","","0\n]\nv(t)\nv(t)∼N(0,1)\n(42)\nRemarkFor","","illustration","","purposes,θrepresents","","the","","deviation\nfrom","","System","","(41),","","such","","thatθ=","0would","","yield","","the","","smallest\ngeneralisation","error.\nA","","forward","","innovation","","form","","of","","a","","known","","LTI","","system","","in","","the\nform","(16)","can","be","found","by","solving","algebraic","Riccati","equations,\ndescribed","in","[13,","Section","6.9].","Yielding","a","predictor\nx(t+","1)","=\n[\n0.51\n00.5\n]\n︸\n︷︷︸\nA\n0\nx(t)","+\n[\n1\n0.12\n]\n︸︷︷︸\nK\n0\ne(t)\ny(t)","=\n[\n1","","","","0\n]\n︸\n︷︷︸\nC\n0\nx(t)","+\n[\n1\n]\ne(t)\n(43)\nFrom","System","description","(43)","in","forward","innovation","form,\nand","","parameterisation","","described","","in","","the","","example","","description\n(42),","the","hypothesis","set","can","be","defined","as\nF=\n{\nf\nθ\n=","(A(θ),K\n0\n,C\n0\n)|A(θ)","=A\n0\n+\n[\n0","","","","0\n0θ\n]\n,\nθ∈R,","ρ(A(θ))<1,","ρ(A(θ)−K\n0\nC\n0\n)<1\ndet(\n[\nK\n0\nA(θ)K\n0\n]\n)6=","0,det\n([\nC\n0\nC\n0\nA(θ)\n])\n6=","0}\n(44)\nwhereρ(·)denotes","the","spectral","radius.\nEquipped","","with","","the","","hypothesis","","set","","(44),","","a","","realisation","","of\nstochastic","","processS={y(t)(ω)}\n100\nt=0\nofN=","","100samples\nof","","System","","(41),","","and","","a","","prior","","uniform","","distribution","","over","","the\n\n-1.5-1-0.500.5\n3\n2.2\n2.3\n2.4\n2.5\n2.6\n^\nL\nl\ny\nFig.","1.","","","Empirical","Loss","over","parameter","setθ\nhypothesis","set","asπ∼U(−1.5,0.5).","The","posterior","distribution\nˆρ(θ)and","the","upperbound","on","the","expectation","of","generalised","loss\nE\nf∼ˆρ\nL\n`\ny\n(f),","can","be","computed","via","sequential","Monte-Carlo.\nFirst","sample","a","set","of","parameters\nΘ","={θ\ni\n}\nN\nf\ni=1\n,","","θ\ni\n∼π(45)\nand","construct","a","predictorf\nθ\ni\n,∀θ\ni\n∈Θwith\nΣ(θ\ni\n)","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)","=","(A(θ\ni\n),K\n0\n,C\n0\n)\nFor","eachf\nθ\ni\ncompute","empirical","predictions","by","iterating\nˆx(t+","1)","=","(\nˆ\nA−\nˆ\nK\nˆ\nC)ˆx(t)","+\nˆ\nKy(t)(ω),\nˆy(t)","=\nˆ\nCx(t),\nˆx(0)","=","0.\n(46)\nFrom","empirical","predictions","compute","empirical","loss\nˆ\nL\n`\ny,N\n(f\nθ\ni\n)","=\n1\nN\nN\n∑\nt=1\n(y(t)(ω)−ˆy(t))\nT\n(y(t)(ω)−ˆy(t)).∀i\n(47)\nFigure","1","shows","empirical","loss","over","the","parameter","setΘ.","Note\nthatθ=","","0does","","not","","yield","","the","","smallest","","empirical","","loss,","","since\nwe","are","using","a","finite","number","of","samples.","From","(47)","and","prior\ndistributionπ,","","the","","Gibbs","","posterior","","distributionˆρ(13)","","can","","be\napproximated,","and","is","shown","in","Figure","2.","In","this","example,","the\ntrue","","system","","is","","known","","and","","thereforeλcould","","be","","chosen","","to\nmaximise","the","likelihood","ofθ=","0.","However,","in","an","application,\none","would","need","to","considerλcarefully.\nNow,","","the","","computed","","posterior","","distribution","","can","","be","","used","","to\ncalculate","the","expectation","over","empirical","losses.","Normally,","one\nwould","","have","","to","","repeat","","the","","sequential","","Monte-Carlo","","process,\nwhile","","samplingθ∼ˆρ,","","and","","take","","the","","sample-mean","","as","","an\napproximation","of","the","expectation.","In","this","simplified","example,\nthe","","expectation","","can","","be","","approximated","","by","","approximating","","an\nintegral\nE\nf∼ˆρ\nˆ\nL\n`\ny,N\n(f\nθ\n)≈\nN\nf\n−1\n∑\ni=1\nˆ\nL\n`\ny,N\n(f\nθ\ni\n)","ˆρ(θ\ni\n)(θ\ni+1\n−θ\ni\n)(48)\nThe","KL","divergence","can","similarly","be","approximated","as\nKL(","ˆρ||π)≈\nN\nf\n−1\n∑\ni=1\nln\n(\nˆρ(θ\ni\n)\nπ(θ\ni\n)\n)\nˆρ(θ\ni\n)(θ\ni+1\n−θ\ni\n)(49)\n-1.5-1-0.500.5\n3\n0\n0.5\n1\n1.5\n2\nLikelihood\nUniformPrior\nGibbs,6=1:0\nGibbs,6=10:0\nGibbs,6=100:0\nFig.","2.","","","Various","Gibbs","distributions","with","varyingλ\nLastlyu\n`,π\n(λ,N)can","be","computed","according","to","Section","III-B.\nNow","","we","","have","","everything","","necessary","","to","","compute","","the","","PAC-\nbayesian","","upper","","bound,","","the","","right","","hand","","side","","of","","(11).","","Forλ=\n100,","","the","","upper-bound","","ends","","up","","being4.48,","","whileE\nf∼ˆρ\nL\n`\ny\n≈\n2.03.","Figure","3","showcases","the","upper","bound","for","various","number\nof","","","training","","","samplesNand","","","real","","","valuesλ",">0.","","","Recall,\nthat","","in","","Gibbs","","distribution","","(13),λplays","","a","","role","","of","","weighting\nthe","","importance","","of","","data","","versus","","the","","importance","","of","","the","","prior\ndistribution,","largerλwill","minimiseE\nf∼ρ\nˆ\nL\n`\ny\n,","however","it","will\nincreaseKL(ρ‖π).","Therefore,","it","is","natural","that","there","existsλ\nthat","","compromises","","empirical","","data","","fit,","","with","","prior","","assumptions.\nFor","","this","","specific","","example,","","realisation","","and","","prior,λ=","5yields\nthe","smallest","upper","bound","for","allN.\n(a)\n10\n0\n10\n1\n10\n2\n6\n2000\n4000\n6000\n8000\nN\n4.01\n4.35\n4.69\n(b)\n10\n0\n10\n1\n10\n2\n6\n2000\n4000\n6000\n8000\nN\n2.04\n2.06\n2.07\nFig.","3.","","","(a)","shows","the","PAC-bayesian","upper","bound","(right","hand","side","of","(11))","(b)\nshows","","the","","expectation","","of","","the","","generalisation","","error","","over","","posterior","","distribution,\nwhich","depends","on(N,λ),","the","minimal","value","over","allNandλis","denoted","by\n∗\n\nV.","","CONCLUSIONS","AND","FUTURE","WORK\nIn","","this","","paper","","we","","have","","formulated","","a","","non-trivial","","error","","PAC-\nBayesian","error","bound","for","autonomous","stochastic","LTI","models.\nThis","","error","","bounds","","gives","","a","","non-asymptotic","","error","","bound","","on\nthe","generalization","error.","Future","work","will","be","directed","towards\nextending","this","bound","first","to","stochastic","LTI","models","with","inputs,\nand","then","to","more","complex","models","such","as","hybrid","models","and\nrecurrent","neural","network.","Another","research","direction","would","be\nto","understand","the","effect","of","the","choice","of","prior","and","the","constant\nλon","","the","","resulting","","learning","","algorithms","","and","","comparing","","it","","to\nvarious","existing","learning","algorithms.\nREFERENCES\n[1]","","P.","","Alquier,","","X","","Li,","","and","","O.","","Wintenberger.","","","Prediction","","of","","time","","series","","by\nstatistical","learning:","general","losses","and","fast","rates.\nDependenceModeling,\n1(2013):65–93,","2013.\n[2]","","P.","Alquier,","J.","Ridgway,","and","N.","Chopin.","","On","the","properties","of","variational\napproximations","of","Gibbs","posteriors.\nJMLR,","17(239):1–41,","2016.\n[3]","","A.","","Ambroladze,","","E.","","Parrado-Hern\n","́\nandez,","","and","","J.","","Shawe-Taylor.","","","Tighter\nPAC-Bayes","bounds.","","InNIPS,","2006.\n[4]","","A.","","Barbu","","and","","S.","","C.","","Zhu.MonteCarloMethods.","","Springer","","Singapore,\nSingapore,","1st","edition,","2020.\n[5]","","P.","E.","Caines.LinearStochasticSystems.","","John","Wiley","and","Sons,","1988.\n[6]","","G.","K.","Dziugaite","and","D.","M.","Roy.","","Computing","nonvacuous","generalization\nbounds","for","deep","(stochastic)","neural","networks","with","many","more","parameters\nthan","training","data.","","In\nUAI.","AUAI","Press,","2017.\n[7]","","P.","","Germain,","","F.","","Bach,","","A.","","Lacoste,","","and","","S.","","Lacoste-Julien.","","Pac-bayesian\ntheory","meets","bayesian","inference.","","InNIPS,","pages","1876–1884,","2016.\n[8]","","P.","","Gr\n","̈\nunwald.","","","The","","safe","","Bayesian","","-","","learning","","the","","learning","","rate","","via","","the\nmixability","gap.","","InALT,","2012.\n[9]","","B.","","Guedj.A","","Primer","","on","","PAC-Bayesian","","Learning.arXivpreprint\narXiv:1901.05353,","2019.\n[10]","","E.","J.","Hannan","and","M.","Deistler.\nThestatisticaltheoryoflinearsystems.\nSIAM,","2012.\n[11]","","T.","","Katayama.SubspaceMethodsforSystemIdentification.","","","Springer-\nVerlag,","2005.\n[12]","","A.","","Klenke.ProbabilityTheory:AComprehensiveCourse.","","","Springer\nInternational","Publishing","AG,","Cham,","2020.\n[13]","","A.","","Lindquist","","and","","G.","","Picci.LinearStochasticSystems:AGeometric\nApproachtoModeling,EstimationandIdentification.","","Springer,","2015.\n[14]","","L.","","Ljung.SystemIdentification:Theoryfortheuser(2ndEd.).","","","PTR\nPrentice","Hall.,","Upper","Saddle","River,","USA,","1999.\n[15]","","D.","","McAllester.Some","","PAC-Bayesian","","theorems.MachineLearning,\n37(3):355–363,","1999.\n[16]","","D.","","McAllester.","","","Simplified","","PAC-Bayesian","","margin","","bounds.","","","InCOLT,\npages","203–215,","2003.\n[17]","","V.","","Shalaeva,","","A.","","Fakhrizadeh","","Esfahani,","","P.","","Germain,","","and","","M.","","Petreczky.\nImproved","PAC-bayesian","bounds","for","linear","regression.Proceedingsofthe\nAAAIConferenceonArtificialIntelligence,","34:5660–5667,","Apr.","2020.\n[18]","","S.","Shalev-Shwartz","and","S.","Ben-David.\nUnderstandingmachinelearning:\nFromtheorytoalgorithms.","","Cambridge","university","press,","2014.\n[19]","","R.","Sheth","and","R.","Khardon.","","Excess","risk","bounds","for","the","bayes","risk","using\nvariational","","inference","","in","","latent","","gaussian","","models.","","In\nNIPS,","","pages","","5151–\n5161,","2017.\n[20]","","T.","","Zhang.","","Information-theoretic","","upper","","and","","lower","","bounds","","for","","statistical\nestimation.\nIEEETrans.InformationTheory,","52(4):1307–1321,","2006.\nAPPENDIX\nProof","Lemma","II.2.First","","we","","show","","thatlim\nt→∞\n(\nˆ\ny\nf\n(t|0)−\nˆ\ny\nf\n(t))","=","0in","the","mean","square","sense.","Indeed,","for","anyτ∈Z\nlim\ns→−∞\n(\nˆ\ny\nf\n(τ|s)−\nˆ\ny\nf\n(τ))","=","0in","the","mean","square","sense.\nNotice","that(\nˆ\ny\nf\n(0|s)−\nˆ\ny\nf\n(0))","=\n∑\n∞\nk=1\nM\nk−s\ny(s−k),","where\nthe","","infinite","","sum","","is","","absolutely","","convergent","","in","","the","","mean","","square\nsense.","","Define","","the","","sequenceb\nN\n=E[‖\n∑\n∞\nk=1\nM\nk+N\ny(−N−\nk)‖\n2\n2\n].","SinceE[‖(\nˆ\ny\nf\n(0|s)−\nˆ\ny\nf\n(0))‖\n2\n2\n]","=b\n−s\n,","if","follows","that\nthe","sequenceb\nN\nconverges","to","zero","asNconverges","to∞.","Since\nyis","stationary,","it","follows","that","for","anyN≥0,","anyτ∈Zb\nN\n=\nE[‖\n∑\n∞\nk=1\nM\nk+N\ny(−N−k)‖\n2\n2\n]","","=E[‖\n∑\n∞\nk=1\nM\nk+N\ny(τ−\nk−N)‖\n2\n2\n].","","In","","particular,","","by","","choosingτ=N,","","it","","follows\nthatb\nN\n=E[‖\n∑\n∞\nk=1\nM\nk+N\ny(−k)‖\n2\n2\n].","","Finally,","","notice","","that\nˆ\ny\nf\n(t|0)−\nˆ\ny\nf\n(t)","","=\n∑\nN\nk=1\nM\nk+t\ny(−k),","","and","","henceE=\n[‖\nˆ\ny\nf\n(t|0)−\nˆ\ny\nf\n(t)‖\n2\n]","=b\nt\n.","Sincelim\nt→∞\nb\nt\n=","0,","it","follows\nthatlim\nt→∞\n(\nˆ\ny\nf\n(t|0)−\nˆ\ny\nf\n(t))","=","0in","the","mean","square","sense,\nas","","claimed.","","Sincelim\nt→∞\n(\nˆ\ny\nf\n(t|0)−\nˆ\ny\nf\n(t))","","=","","0in","","the\nmean","","square","","sense,lim\nt→∞\na\nt\n=","0,","","wherea\nt\n=E[|`(\nˆ\ny\nf\n(t|\n0),y(t))−`(\nˆ\ny\nf\n(t),y(t))|]).","It","is","easy","to","see","that\nˆ\nL\ny,N\n(f)−\nV\ny,N\n(f)","=\n1\nN\n∑\nN\nt=1\n(`(\nˆ\ny\nf\n(t|0),y(t))−`(\nˆ\ny\nf\n(t),y(t))),","and\nhenceE[|\nˆ\nL\ny,N\n(f)−V\ny,N\n(f)|]≤\n1\nN\n∑\nN\nt=1\na\nt\n.","","Sincea\nt\ncon-\nverges","to0ast→∞,","by","the","well-known","property","of","Cesaro-\nmeanslim\nN→∞\n1\nN\n∑\nN\nt=1\na\nt\n=","0.\nProof","of","Lemma","III.1.Note","","that","","ifΣ","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC)is","","a","","min-\nimal","","tuple,","","then(\nˆ\nA−\nˆ\nK\nˆ\nC,\nˆ\nK,\nˆ\nC)is","","a","","minimal","","determinstic\nLTI,","since","controllability","of(\nˆ\nA,\nˆ\nK)implies","that(\nˆ\nA−\nˆ\nK\nˆ\nC,\nˆ\nK)\nis","","controllable.","","Similarly,","","ifΣ\n′\nis","","a","","minimal","","tuple,","","then\n(\nˆ\nA\n′\n−\nˆ\nK\n′\nˆ\nC\n′\n,\nˆ\nK\n′\n,\nˆ\nC\n′\n)is","","a","","minimal","","dimensional","","deterministic\nLTI","system.","Notice","thatf\nΣ\nandf\nΣ\n′\nare","the","input-output","maps\nof","","the","","deterministic","","LTI","","systemsS\n1\n=","","(\nˆ\nA−\nˆ\nK\nˆ\nC,\nˆ\nK,\nˆ\nC)\nandS\n2\n=","","(\nˆ\nA\n′\n−\nˆ\nK\n′\nˆ\nC\n′\n,\nˆ\nK\n′\n,\nˆ\nC\n′\n)respectively.","","Hence,","","from\nstandard","","realization","","theory","","it","","follows","","that","","as","","bothS\n1\nandS\n2\nare","minimal,f\nΣ\n=f\nΣ\n′\nimplies","that","there","exists","a","nonsingular\nmatrixTsuch","that\nˆ\nA\n′\n−\nˆ\nK\n′\nˆ\nC\n′\n=T(\nˆ\nA−\nˆ\nK\nˆ\nC)T\n−1\n,\nˆ\nK\n′\n=T\nˆ\nK,\nand\nˆ\nC\n′\n=\nˆ\nCT\n−1\n.","From","this","the","second","statement","of","the","lemma\nfollows.\nIn","order","to","prove","the","first","part,","consider","the","the","deterministic\nLTI","systemS\n1\n=","(\nˆ\nA−\nˆ\nK\nˆ\nC,\nˆ\nK,\nˆ\nC)and","apply","to","it","the","standard\nminimization","algorithm.","Let","the","matrices","of","the","resulting","sys-\ntem","beS\n2\n=","(\nˆ\nF\nm\n,\nˆ\nK\nm\n,\nˆ\nC\nm\n)and","define\nˆ\nA\nm\n=\nˆ\nF\nm\n+\nˆ\nK\nm\nˆ\nC\nm\n.\nNotice","","that\nˆ\nF\nm\nis","","stable,","","since\nˆ\nA−\nˆ\nK\nˆ\nCwas","","stable","","and\nminimization","","preserves","","stability.","","It","","is","","not","","difficult","","to","","see","","that\nminimization","","preserves","","stability","","of\nˆ\nAtoo,","","i.e.,\nˆ\nA\nm\nwill","","be\nstable","","too.","","Hence,","","the","","tupleΣ\nm\n=","","","(\nˆ\nA\nm\n,\nˆ\nK\nm\n,\nˆ\nC\nm\n)is","","a\nminimal","tuple.","Hence,","since","the","input-output","maps","ofS\n1\nand\nS\n2\ncoincide,","and","the","input-output","map","of","the","former","isf\nΣ\nand\nof","the","later","isf\nΣ\nm\n,","and","hencef\nΣ\n=f\nΣ\nm\n.\nProof","of","Lemma","III.2.Indeed,assumethatΣ(θ\n0\n)=\n(A\n0\n,K\n0\n,C\n0\n)is","","a","","minimal","","tuple","","such","","that(A\n0\n,K\n0\n,C\n0\n,I,e)\nis","","a","","minimal","","realization","","ofy.","","It","","is","","not","","difficult","","to","","see","","that\nin","","this","","case,\nˆ\ny\nf\nΣ\n0\n(t)","","=E\nl\n[y(t)|","H\ny\nt−\n],","","i.e.,\nˆ\ny\nf\nΣ\n0\n(t)is","","the\northogonal","","","projection","","","ofy(t)onto","","","its","","","own","","","past.","","","Hence,\ne(t)","=\nˆ\ny\nf\nΣ\n0\n(t)−y(t),`(\nˆ\ny\nf\nΣ\n0\n(t),y(t))","=‖\nˆ\ny\nf\nΣ\n0\n(t)−y(t)‖\n2\n2\n,\nand","therefore\nE[`(\nˆ\ny\nf\nΣ\n0\n(t),y(t))]","=E[[‖e(t)‖\n2\n2\n](50)\nIt","is","easy","to","see","that","for","any","other","element","off∈F,","the","entries\nof\nˆ\ny\nf\n(t|s)and\nˆ\ny\nf\n(t)belong","","to","","the","","closed","","subspaceH\ny\nt−\ngenerated","","by","","the","","past","","ofy.","","By","","the","","properties","","of","","orthogonal\nprojections,","it","then","follows","that\nL\n`\n(f)","=E[`(\nˆ\ny\nf\n(t),y(t))]","=\n=E[‖\nˆ\ny\nf\n(t)−y(t)‖\n2\n2\n]≤E[[‖e(t)‖\n2\n2\n]","=\n=E[`(\nˆ\ny\nf\nΣ(θ\n0\n)\n(t),y(t))]","=L\n`\n(f\nΣ(θ\n0\n)\n))\n(51)\n\nand","","the","","equality","","holds","","only","","if\nˆ\ny\nf\n(t)","=\nˆ\ny\nf\nΣ(θ\n0\n)\n(t).","","The","","latter\nmeans","","thaty(t)−\nˆ\ny\nf\n(t)","=e(t).","","This","","means","","that","","iff=f\nΣ\nfor","","a","","minimal","","tupleΣ","=","(\nˆ\nA,\nˆ\nK,\nˆ\nC),","","then","","by","","using","","(21)","","and\nsubstitutingy(t)−\nˆ\nCx\nΣ\n(t)","=y(t)−\nˆ\ny\nf\n(t)","=e(t)into","","the\nfirst","equation","of","(21),","it","follows","that\nx\nΣ\n(t+","1)","=\nˆ\nAx\nΣ\n(t)","+\nˆ\nKe(t)\ny(t)","=\nˆ\nCx\nΣ\n(t)","+","(y(t)−\nˆ\nCx\nΣ\n(t))","=\nˆ\nCx\nΣ\n(t)","+e(t).\nThat","","","is,(\nˆ\nA,\nˆ\nK,\nˆ\nC,I,e)is","","","a","","","realization","","","ofyin","","","forward\ninnovation","","form.","","Since(\nˆ\nA,\nˆ\nK)is","","controllable","","and(\nˆ\nC,\nˆ\nA)\nis","","","observable,(\nˆ\nA,\nˆ\nK,\nˆ\nC,I,e)is","","","a","","","minimal","","","realization","","","of\nyin","","forward","","innovation","","form.","","Hence,","","it","","is","","isomorphic","","to\n(A\n0\n,K\n0\n,C\n0\n,I,e),","","that","","is,","","there","","exists","","a","","nonsingular","","matrix\nT,","","such","","that\nˆ\nA=TA\n0\nT\n−1\n,\nˆ\nK=TK\n0\nand\nˆ\nC=C\n0\nT\n−1\n,\ni.e.,ΣandΣ(θ\n0\n)are","","isomorphic.","","SinceΣ","=","Σ(θ)for","","some\nθ∈Θ,","by","Assumption","III.2,θ=θ\n0\n.\nProof","of","Lemma","III.3.Under","","Assumption","","III.1,","","by","","[14,","","The-\norem","","2.3]","","the","","alternative","","empirical","","loss","","converges","","to","","the\ngeneralization","","error,","","i.e.lim\nN→∞\nV\ny,N\n(f)","","=L\ny\n(f)with\nprobability1.","Recall","that","by","Lemma","II.2lim\nN→∞\nV\ny,N\n(f)−\nˆ\nL\ny,N\n(f)=0in","","","the","","","mean","","","sense,","","","hence","","","there","","","ex-\nists","","","a","","","subsequenceN\nk\n,lim\nk→∞\nN\nk\n=∞such","","","that\nlim\nk→∞\nV\ny,N\nk\n(f)−\nˆ\nL\ny,N\nk\n(f)","=","0with","probability1.","Hence,\nlim\nk→∞\nˆ\nL\ny,N\nk\n(f)","=L\ny\n(f)with","","probability1.","","Using","","dom-\ninated","","convergence","","theorem","","the","","statement","","of","","the","","lemma","","fol-\nlows.\nProof","of","Lemma","III.4.ConsiderthematrixQ\nz,N\n=\nE\n[\nz\n1:N\n(f\nθ\n)z\nT\n1:N\n(f\nθ\n)\n]\n.ItiseasytoseethatQ\nz,N\nistheleft-upperblockofthematrixQ\nz,N+1\n.In\nparticular,","","","ifv6=","","","0is","","","an","","","eigenvector","","","ofQ\nz,N\nwhich\ncorresponds","","","to","","","eigenvalueρ\nN\n(θ),","","","thenˆv=","","","","(v\nT\n,0\nT\n),\nˆv\nT\nQ\nz,N+1\nˆv=v\nT\nQ\nN\nv=ρ\nN\n(θ)v\nT\nv",">","ρ\nN+1\n(θ)v\nT\nv,","","where\nwe","","used","","the","","factρ\nN+1\n(θ)w\nT\nw≤w\nT\nQ\nN+1\nw,","","due","","to","","the\nwell-known","","property","","of","","smallest","","eigenvalue","","of","","a","","symmetric\nsemi-definite","","matrix.","","Sincev6=","0,","","it","","follows","","thatv\nT\nv",">0,\nand","","henceρ\nN\n(θ)>","ρ\nN+1\n(θ).","","Sinceρ\nN\n(θ)is","","decreasing,\nit","","follows","","thatlim\nN→∞\nρ\nN\n(θ)","","","=ρ\n∗\n(θ)","","","=","","","inf\nN\nρ\nN\n(θ).\nFrom[5,Section2.2,eq.(2.1)]itfollows\nQ\nz,N\n=A\nN\nQ\ny,N\nA\nT\nN\n,","","where(Q\ny,N\n)\ni,j\n=E[y(i)y\nT\n(j)]\nandA\nN\n=\n\n\n\n\n\nI00···0\n−M\n1\nI0···0\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n−M\nN−1\nM\nN−2\n−M\nN−3\n···I\n\n\n\n\n\n,","","where\nM\ni\n=C(A−KC)\ni−1\nK,θ=","(A,K,C).","In","particular,","for","any\nv6=","0,v\nT\nQ\nz,N\nv≥μ\nN\n‖A\nN\nv‖\n2\n≥μ\nN\n‖A\n−1\nN\n‖\n2\nv\nT\nv,","whereμ\nN\nis","the","minimal","eigenvalue","ofQ\ny,N\n.","Note","thatA\nN\nis","trivially\ninvertable,","andA\n−1\nN\n=\n\n\n\n\n\nI00···0\n","̃\nM\n1\nI0···0\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n","̃\nM\nN−1\n","̃\nM\nN−2\n","̃\nM\nN−3\n···I\n\n\n\n\n\n,\nwhere\n","̃\nM\ni\n=CA\ni−1\nK.","","It","","then","","follows","","that‖A\n−1\nN\n‖\n2\n>1\nand","","hencev\nT\nQ\nz,N\nv",">","μ\nN\nv\nT\nv,","","and","","thereforeρ\nN\n(θ)>","μ\nN\n.\nFinally,","","sinceyis","","coercive,","","by","","[11,","","proof","","of","","Theorem","","7.3],\nit","","follows","","that","","there","","existsμ\n∗\n>0such","","that","","the","","spectral\ndensityΦ\ny\nofysatisfiesΦ\ny\n(e\niθ\n)>","μ\n∗\nIfor","","allθ∈[−π,π],\nandμ\nN\n>","μ\n∗\n>0.","","Finally,","","notice","","thatv(θ)","","=E[‖y(t)−\nˆy\nfθ\n(t)‖\n2\n2\n]=traceE[(y(t)−ˆy\nfθ\n(t))(y(t)−ˆy\nf\nθ(t))\nT\n],\nandy(t)−\nˆ\ny\nf\nθ\n(t)is","","","the","","","result","","","of","","","applying","","","the","","","linear\nsystem(A−KC,K,−C,I)toθ,","","whereθ=","","(A,K,C).\nIn","","","particular,","","","ifH(z)","","","=I−C(zI−A−KC)\n−1\nK\nis","","","the","","","transfer","","","function","","","of","","","that","","","system,","","","it","","","follows","","","by\n[5,","","","Theorem","","","1.2]","","","thatH(z)Φ\ny\n(z)H\n∗\n(z)is","","","the","","","spectral\ndensity","","","ofy(t)−\nˆ\ny\nf\nθ\n(t),","","","andE[(y(t)−ˆy\nf\nθ\n(t))(y(t)−\nˆy\nf\nθ\n(t))\nT\n]=\n1\n2π\n∫\nπ\n−π\nH(e\niθ\n)Φ\ny\n(e\niθ\n)H\n∗\n(e\niθ\n)dθ,hence\nv(θ)=\n1\n2π\n∫\nπ\n−π\ntraceH(e\niθ\n)Φ\ny\n(e\niθ\n)H\n∗\n(e\niθ\n)dθ=≥\nμ\n∗\n1\n2π\n∫\nπ\n−π\ntraceH(e\niθ\n)H\n∗\n(e\niθ\n)dθ≥pμ\n∗\n.Here\nweusedthefactthatbyParseval’sequality\n1\n2π\n∫\nπ\n−π\ntraceH(e\niθ\n)H\n∗\n(e\niθ\n)dθ=‖I\np\n‖\n2\nF\n+\n∑\n∞\nk=0\n‖C(A−\nKC)\nk\nK‖\n2\nF\n>","pμ,","asH(e\niθ\n)","=I\np\n+\n∑\n∞\nk=0\nC(A−KC)\nk\nKe\nikθ\nand‖.‖\nF\ndenotes","the","Frobenius","norm.\nProof","of","Lemma","III.5.For","","everyθ∈Θ,(1","+\nλρ\nN\n(θ)\nN/2\n)\nNp\n2\n≥\n(1","+\nλμ\n∗\nN/2\n)\nNp\n2\n),","","and(1","+\nλρ\nN\n(θ)\nN/2\n)\nNp\n2\n≤(1","+\nλρ\n0\nN/2\n)\nNp\n2\nwhere\nwe","","used","","the","","fact","","thatρ\n0\n=ρ\n1\n(θ)and","","that","","by","","Lemma","","III.4\nρ\nN\n(θ)is","","decreasing.","","Hence,\nexp","(λv(θ))\n(\n1+\nλρ\nN\n(θ)\nN\n2\n)\nNp\n2\n≤\nexp","(λv(θ))\n(\n1+\nλμ\n∗\nN\n2\n)\npN\n2\n,\nand\nexp","(λv(θ))\n(\n1+\nλρ\nN\n(θ)\nN\n2\n)\nNp\n2\n≥\nexp","(λv(θ))\n(\n1+\nλρ\n0\nN\n2\n)\npN\n2\nNotice","thatlim\nN→∞\n(1","+\nλμ\n∗\nN\n2\n)\npN\n2\n=","","lim\nN→∞\n(1","+\nλpμ\n∗\nNp\n2\n)\npN\n2\ne\nλpμ\n∗\nandlim\nN→∞\n(1","+\nλρ\n0\nN\n2\n)\npN\n2\n=","","lim\nN→∞\n(1","+\nλpρ\n0\nNp\n2\n)\npN\n2\ne\nλpρ\n0\nand\nexp","(λv(θ))\n(\n1+\nλpx\npN\n2\n)\npN\n2\n≤\nexp","(λv(θ))forx∈","{ρ\n0\n,μ\n∗\n,ρ\nN\n(θ)|N≥1}.","The","statement\nof","","","the","","","lemma","","","follows","","","now","","","using","","","dominated","","","convergence\ntheorem.\nProof","of","Lemma","III.6.The","first","equation","follows","by","using","the\ninequality\n(\n1","+\nx\ny\n)\ny\n>exp\n(\nxy\nx+y\n)\nforx,y",">0\nwithx=pλρ\nN\n(θ)andy=\npN\n2\n,","","","the","","","second","","","one","","","by\nnoticing","","that\nxy\nx+y\nis","","monotonically","","increasing","","iny,","","hence,\npμ\n∗\npN∗0.5\nλpμ\n∗\n+0.5pN\n>\npμ\n∗\n0.5\nλpμ\n∗\n+0.5\n."],"doc9":["\n\nActive","Structure","Learning","of","Bayesian","Networks\nin","an","Observational","Setting\nNoa","Ben-David","and","Sivan","Sabato\nDepartment","of","Computer","Science\nBen-Gurion","Univesity","of","the","Negev,","Beer","Sheva,","Israel.\nAbstract\nWe","study","active","structure","learning","of","Bayesian","networks","in","an","observational","setting,\nin","which","there","are","external","limitations","on","the","number","of","variable","values","that","can","be\nobserved","from","the","same","sample.","Random","samples","are","drawn","from","the","joint","distribution\nof","the","network","variables,","and","the","algorithm","iteratively","selects","which","variables","to","observe\nin","the","next","sample.","We","propose","a","new","active","learning","algorithm","for","this","setting,","that\nfinds","with","a","high","probability","a","structure","with","a","score","that","is\u000f-close","to","the","optimal\nscore.","We","show","that","for","a","class","of","distributions","that","we","termstable,","a","sample","complexity\nreduction","of","up","to","a","factor","of\n","̃\nΩ(d\n3\n)can","be","obtained,","wheredis","the","number","of","network\nvariables.","","We","further","show","that","in","the","worst","case,","the","sample","complexity","of","the\nactive","algorithm","is","guaranteed","to","be","almost","the","same","as","that","of","a","naive","baseline\nalgorithm.","To","supplement","the","theoretical","results,","we","report","experiments","that","compare\nthe","performance","of","the","new","active","algorithm","to","the","naive","baseline","and","demonstrate","the\nsample","complexity","improvements.","Code","for","the","algorithm","and","for","the","experiments","is\nprovided","athttps://github.com/noabdavid/activeBNSL.\n1","","Introduction\nIn","this","work,","we","study","active","structure","learning","of","Bayesian","networks","in","an","observational\n(that","is,","a","non-interventional)","setting,","in","which","there","are","external","limitations","on","the","number\nof","variable","values","that","can","be","observed","from","the","same","sample.","Bayesian","networks","are\na","popular","modeling","tool","used","in","various","applications,","such","as","medical","analysis","[19,50],\nhuman","activity","models","[32]","and","engineering","[38,10],","among","others.","A","Bayesian","network","is\na","graphical","model","that","encodes","probabilistic","relationships","among","random","variables.","The\nstructure","of","a","Bayesian","network","is","represented","by","a","Directed","Acyclic","Graph","(DAG)","whose\nnodes","are","the","random","variables,","where","the","edge","structure","represents","statistical","dependency\nrelations","between","the","variables.","Structure","learning","of","a","Bayesian","network","(see,","e.g.,","[27])\naims","to","find","the","structure","(DAG)","that","best","matches","the","joint","distribution","of","given","random\nvariables,","using","i.i.d.","samples","of","the","corresponding","random","vector.","Structure","learning","is","used,\nfor","instance,","for","uncovering","gene","interaction","[18],","cancer","prediction","[49],","and","fault","diagnosis\n[9].\nIn","the","setting","that","we","study,","a","limited","number","of","variable","measurements","can","be","observed\nfrom","each","random","sample.","The","algorithm","iteratively","selects","which","of","the","variable","values","to\nobserve","from","the","next","random","sample.","This","is","of","interest,","for","instance,","when","the","random\nvectors","represent","patients","participating","in","a","study,","and","each","measured","variable","corresponds\n1\narXiv:2103.13796v1","","[cs.LG]","","25","Mar","2021\n\nto","the","results","of","some","medical","test.","Patients","would","not","agree","to","undergo","many","different\ntests,","thus","the","number","of","tests","taken","from","each","patient","is","restricted.","Other","examples","include\nobtaining","a","synchronized","measurement","from","all","sensors","in","a","sensor","network","with","a","limited\nbandwidth","[17],","and","recording","neural","activity","with","a","limited","recording","capacity","[41,46].\nThe","goal","is","to","find","a","good","structure","based","on","the","the","restricted","observations,","using","a","small\nnumber","of","random","samples.","Learning","with","limited","observations","from","each","sample","was","first\nstudied","in","[6]","for","binary","classification,","and","has","thereafter","been","studied","for","other","settings,\nsuch","as","online","learning","[12,21]","and","linear","regression","[28].","This","work","is","the","first","to","study\nlimited","observations","in","the","context","of","structure","learning","of","Bayesian","networks.\nWe","study","the","active","structure-learning","problem","in","a","score-based","framework","[15,24],","in\nwhich","each","possible","DAG","has","a","score","that","depends","on","the","unknown","distribution,","and","the\ngoal","is","to","find","a","DAG","with","a","near-optimal","score.","We","propose","a","new","active","learning","algorithm,\nActiveBNSL,","that","finds","with","a","high","probability","a","structure","with","a","score","that","is\u000f-close","to\nthe","optimal","structure.","We","compare","the","sample","complexity","of","our","algorithm","to","that","of","a\nnaive","algorithm,","which","observes","every","possible","subset","of","the","variables","the","same","number","of\ntimes.","We","show","that","the","improvement","in","the","sample","complexity","can","be","as","large","as","a","factor\nof\n","̃\nΩ\n(d\n3\n),","wheredis","the","dimension","of","the","random","vector.","This","improvement","is","obtained","for\na","class","of","distributions","that","we","define,","which","we","termstabledistributions.","We","further","show\nthat","in","the","worst","case,","the","sample","complexity","of","the","active","algorithm","is","guaranteed","to","be\nalmost","the","same","as","that","of","the","naive","algorithm.\nA","main","challenge","in","reducing","the","number","of","samples","in","this","setting","is","the","fact","that\neach","structure","usually","has","multiple","equivalent","structures","with","the","same","quality","score.\nActiveBNSLovercomes","this","issue","by","taking","equivalence","classes","into","account","directly.","An\nadditional","challenge","that","we","address","is","characterizing","distributions","in","which","a","significant\nreduction","in","the","sample","complexity","is","possible.","Our","definition","of","stable","distributions","captures\nsuch","a","family","of","distributions,","in","which","there","is","a","large","number","of","variables","with","relationships\nthat","are","easy","to","identify,","and","a","small","number","of","variables","whose","relationships","with","other\nvariables","are","harder","to","identify.\nFinding","the","optimal","structure","for","a","Bayesian","network,","even","in","the","fully-observed","setting,\nis","computationally","hard","[13].","Nonetheless,","algorithms","based","on","relaxed","linear","programming\nare","successfully","used","in","practice","[16,4,5].ActiveBNSLuses","existing","structure-search\nprocedures","as","black","boxes.","This","makes","it","easy","to","implement","a","practical","version","ofActiveBNSL\nusing","existing","software","packages.","","We","implementActiveBNSLand","the","naive","baseline,\nand","report","experimental","results","that","demonstrate","the","sample","complexity","reduction","on\nstable","distributions.","The","code","for","the","algorithms","and","for","the","experiments","is","provided","in\nhttps://github.com/noabdavid/activeBNSL.\nPaper","structure\nWe","discuss","related","work","in","Section","2.","The","setting","and","notation","are\ndefined","in","Section","3.","In","Section","4,","a","naive","baseline","algorithm","is","presented","and","analyzed.\nThe","proposed","active","algorithm,ActiveBNSL,","is","given","in","Section","5.","Its","correctness","is","proved\nin","Section","6,","and","sample","complexity","analysis","is","given","in","Section","7,","where","we","show","that\nsignificant","savings","can","be","obtained","for","the","class","of","stable","distributions","that","we","define.","In\nSection","8,","we","describe","an","explicit","class","of","stable","distributions.","In","Section","9,","we","report\nexperiments","that","compare","the","performance","of","our","implementation","ofActiveBNSLto","that\n2\n\nof","the","naive","baseline,","on","a","family","of","stable","distributions.","We","conclude","with","a","discussion","in\nSection","10.","Some","technical","proofs","are","deferred","to","the","appendices.\n2","","Related","work\nSeveral","general","approaches","exist","for","structure","learning","of","Bayesian","networks.","In","theconstraint-\nbasedapproach","[36,42],","pairwise","statistical","tests","are","performed","to","reveal","conditional","inde-\npendence","of","pairs","of","random","variables.","This","approach","is","asymptotically","optimal,","but","less\nsuccessful","on","finite","samples","[25],","unless","additional","realizability","assumptions","are","made.","The\nscore-basedapproach","assigns","a","data-dependent","score","to","every","possible","structure,","and","searches\nfor","the","structure","that","maximizes","this","score.","One","of","the","most","popular","score","functions","for\ndiscrete","distributions","is","the","Bayesian","Dirichlet","(BD)","score","[15].","Several","flavors","of","this","score\nhave","been","proposed","[24,8].","The","BD","scores","are","well-studied","[14,45,11,16,4,5]","and","widely\nused","in","applications","(see,","e.g.,","[34,30,26]).","Finding","a","Bayesian","network","with","a","maximal\nBD","score","is","computationally","hard","under","standard","assumptions","[13].","However,","successful\nheuristic","algorithms","have","been","suggested.","Earlier","algorithms","such","as","[14,45]","integrate","greedy\nhill-climbing","with","other","methods","to","try","and","escape","local","maxima.","Other","approaches","include\ndynamic","programming","[40]","and","integer","linear","programming","[16,","4,","5].\nPrevious","works","on","active","structure","learning","of","Bayesian","networks","[44,22,29,43]","assume\na","causal","structure","between","the","random","variables,","and","consider","an","interventional","(or","experi-\nmental)","environment,","in","which","the","active","learner","can","set","the","values","of","some","of","the","variables\nand","then","measure","the","values","of","the","others.","This","is","crucially","different","from","our","model,","in\nwhich","there","is","no","causality","assumption","and","the","interaction","is","only","by","observing","variables,\nnot","setting","their","values.","Active","learning","for","undirected","graphical","models","has","been","studied\nin","[47]","and","in","[17].","More","generally,","interactive","unsupervised","learning","has","been","studied","in","a\nvariety","of","contexts,","including","clustering","[3]","and","compressive","sensing","[20,","33].\n3","","Setting","and","Notation\nFor","an","integeri,","denote[i]","",":={1,...,i}.","A","Bayesian","network","models","the","probabilistic\nrelationships","between","random","variablesX=","(X\n1\n,...,X\nd\n).","It","is","represented","by","a","DAG\nG=","(V,E)and","a","set","of","parametersΘ.V=","[d]is","the","set","of","nodes,","where","nodeirepresents\nthe","random","variableX\ni\n.Eis","the","set","of","directed","edges.","We","denote","the","set","of","parents","of\na","variableX\ni\n∈XbyΠ\ni\n(G)",":={X\nj\n|(j,i)∈E}.","We","omit","the","argumentGwhen","it","is\nclear","from","context.Θis","the","set","of","parameters","of","the","conditional","distributionP(X|G).\nIn","the","case","where","the","distributions","of","allX\ni\nare","discrete","with","a","support","of","at","mostK\nvalues,X:=","(X\n1\n,...,X\nd\n)is","a","multivariate","multinomial","random","vector","andΘdefines","the\ndistributionsP(X\ni\n|Π\ni\n).","The","generative","model","ofXunder","graphGand","parametersΘis\ngiven","by\nP(X)","=\n∏\ni∈[d]\nP(X\ni\n|Π\ni\n(G),Θ).\nWe","call","any","possible","pair","of","a","child","variable","and","parent","set","over[d]afamily,","and","denote\nit","by〈X\ni\n,Π〉,","whereX\ni\nis","the","child","random","variable","andΠ⊆{X\n1\n,...,X\nd\n}\\{X\ni\n}defines\nthe","set","of","parents","assigned","toX\ni\n.","We","refer","to","a","family","with","a","child","variableiasa","family\n3\n\nofi.","For","convenience,","we","will","useGto","denote","also","the","set","of","families","that","the","structureG\ninduces,","so","thatf∈Gif","and","only","iff=〈X\ni\n,Π\ni\n(G)〉for","somei∈[d].\nStructure","learning","is","the","task","of","finding","a","graphGwith","a","high-quality","fit","to","the","true\ndistribution","ofX.","","This","is","equivalent","to","finding","the","family","of","each","of","the","variables","in\n[d].","The","quality","of","the","fit","of","a","specific","structureGcan","be","measured","using","the","following\ninformation-criterion","score","[7]:\nS(G)",":=−\n∑\ni∈[d]\nH(X\ni\n|Π\ni\n(G))","=−\n∑\nf∈G\nH(f),\nwhereHstands","for","entropy,","andH(f),","for","a","familyf=〈X\ni\n,Π〉,","is","defined","asH(f)",":=\nH(X\ni\n|Π).","As","shown","in","[7],","for","discrete","distributions,","maximizing","the","plug-in","estimate","of\nS(G)from","data,","or","small","variants","of","it,","is","essentially","equivalent","to","maximizing","some","flavors\nof","the","BD","score.\nFor","both","statistical","and","computational","reasons,","in","structure","learning","one","commonly\nsearches","for","a","graph","in","which","each","variable","has","at","mostkparents,","for","some","small","integer\nconstantk(see,","e.g.,","[23]).","Denote","byG\nd,k\nthe","set","of","DAGs","overdrandom","variables","such\nthat","each","variable","has","at","mostkparents.","Denote","the","set","of","all","possible","families","over[d]with\nat","mostkparents","byF\nd,k\n.","Denote","byS\n∗\n:=max\nG∈G\nd,k\nS(G)the","optimal","score","of","a","graph","in\nG\nd,k\nfor","the","true","distribution","ofX.","Our","goal","is","to","find","a","structure\nˆ\nG∈G\nd,k\nsuch","that","with","a\nprobability","of","at","least1−δ,S(\nˆ\nG)≥S\n∗\n−\u000f.","Denote","byG\n∗\nthe","set","of","all","optimal","structures,\nG\n∗\n:={G∈G\nd,k\n|S(G)","=S\n∗\n}.\nWe","study","an","active","setting","in","which","the","algorithm","iteratively","selects","a","subset","of","variables\nto","observe,","and","then","draws","an","independent","random","copy","of","the","random","vectorX.","In","the\nsampled","vector,","only","the","values","of","variables","in","the","selected","subset","are","revealed.","The","goal","is\nto","find","a","good","structure","using","a","small","number","of","such","random","vector","draws.","We","study","the\ncase","where","the","maximal","number","of","variables","which","can","be","revealed","in","any","vector","sample","is\nk+","1.","This","is","the","smallest","number","that","allows","observing","the","values","of","a","variable","and","a","set","of\npotential","parents","in","the","same","random","sample.","We","leave","for","future","work","the","generalization\nof","our","approach","to","other","observation","sizes.","For","a","setA,","denote","byJAK\nk+1\nthe","set","of","subsets\nofAof","sizek+","1.","For","an","integeri,JiK\nk+1\nis","used","as","a","shorthand","forJ[i]K\nk+1\n.\n4","","A","Naive","Algorithm\nWe","first","discuss","a","naive","approach,","in","which","all","variable","subsets","of","sizek+","1are","observed","the\nsame","number","of","times,","and","these","observations","are","used","to","estimate","the","score","of","each","candidate\nstructure.","As","an","estimator","forH(f),","one","can","use","various","options,","possibly","depending","on\nproperties","of","the","distribution","ofX(see,","e.g.,","[37]).","Denoting","this","estimator","by\nˆ\nH,","the\nempirical","score","of","graphGis","defined","as\nˆ\nS(G)",":=−\n∑\nf∈G\nˆ\nH(f)","=−\n∑\ni∈[d]\nˆ\nH(X\ni\n|Π\ni\n(G)).(1)\nFor","concreteness,","assume","that{X\ni\n}\ni∈[d]\nare","discrete","random","variables","with","a","bounded\nsupport","size.","In","this","case,\nˆ\nHcan","be","set","to","the","plug-in","estimator,","obtained","by","plugging","in","the\nempirical","joint","distribution","of{X\ni\n}∪Πinto","the","definition","of","conditional","entropy,","where","the\n4\n\nempirical","joint","distribution","is","based","on","samples","in","which","all","of","these","variables","were","observed\ntogether.\nFor\u000f",">0,δ∈(0,1),","letN(\u000f,δ)be","asample-complexity","upper","boundfor\nˆ\nH.Nis","a\nfunction","such","that","for","any","fixedf=〈i,Π〉,","if\nˆ\nH(f)is","calculated","using","at","leastN(\u000f,δ)\ni.i.d.","copies","of","the","vectorXin","which","the","values","ofX\ni\nandΠare","all","observed,","then","with","a\nprobability","at","least1−δ,|\nˆ\nH(f)−H(f)|≤\u000f.","For","instance,","in","the","case","of","discrete","random\nvariables","with","the","plug-in","estimator,","the","following","lemma,","proved","in","Appendix","A,","shows\nthat","one","can","setN(\u000f,δ)","=\n","̃\nΘ(log(1/δ)/\u000f\n2\n).\nLemma","4.1.Letδ∈(0,1)and\u000f",">0.","LetA,Bbe","discrete","random","variables","with","support\ncardinalitiesM\na\nandM\nb\n,","respectively.","Let\nˆ\nH\n(A|B)be","the","plug-in","estimator","ofH(A|B),\nbased","onNi.i.d.","copies","of(A,B),","where\nN≥max\n{\n8\n\u000f\n2\nlog(\n2\nδ\n)·log\n2\n(8","log(2/δ)/\u000f\n2\n),e\n2\n,M\na\n,(M\na\n−1)M\nb\n/\u000f\n}\n.\nThenP(|\nˆ\nH(A|B)−H(A|B)|>","\u000f)≤δ.\nNow,","consider","a","naive","algorithm","which","operates","as","follows:\n1.","Observe","each","variable","subset","inJdK\nk+1\ninN(\u000f/(2d),δ/|F\nd,k\n|)of","the","random","samples;\n2.\nOutput","a","structureG∈","G\nd,k\nthat","maximizes","the","empirical","score","defined","in","Eq.","(1),\nbased","on","the","plug-in","estimates","ofH(f)for","each","family.\nApplying","a","union","bound","over","all","the","families","inF\nd,k\n,","this","guarantees","that","with","a","probability\nat","least1−δ,","we","have","that","for","each","familyf∈","F\nd,k\n,|\nˆ\nH(f)−H(f)|","≤\u000f/(2d).","Therefore,\nfor","any","graphG∈G\nd,k\n,\n|S(G)−\nˆ\nS(G)|=|−\n∑\nf∈G\nH(f)","+\n∑\nf∈G\nˆ\nH(f)|≤\n∑\nf∈G\n|\nˆ\nH(f)−H(f)|≤\u000f/2.\nLetting\nˆ\nG∈argmax\nG∈G\nd,k\nˆ\nS(G)andG\n∗\n∈G\n∗\n,","with","a","probability","at","least1−δ,\nS(\nˆ\nG)≥\nˆ\nS(\nˆ\nG)−\u000f/2≥\nˆ\nS(G\n∗\n)−\u000f/2≥S(G\n∗\n)−\u000f=S\n∗\n−\u000f,\nas","required.","The","sample","complexity","of","the","naive","algorithm","is\n|JdK\nk+1\n|·N(\u000f/(2d),δ/|F\nd,k\n|)","=\n","̃\nΘ\n(\nd\nk+3\n\u000f\n2\n·log(d\nk+1\n/δ)\n)\n,(2)\nwhere","the","right-hand","side","is","given","for","the","case","of","a","discrete","distribution","with","the","plug-in\nentropy","estimator","discussed","above.\n5","","An","Interactive","Algorithm:ActiveBNSL\nThe","naive","algorithm","observes","all","variable","subsets","the","same","number","of","times.","Thus,","it","does\nnot","make","use","of","possible","differences","in","difficulty","in","identifying","different","parts","of","the","structure.\n5\n\nWe","propose","a","new","interactive","algorithm,ActiveBNSL,","which","uses","previous","observations\nto","identify","such","differences","to","reduce","the","sample","complexity.","Our","approach","is","based","on\nincrementally","adding","families","to","the","output","structure,","until","it","is","fully","defined.","This","reduces\nthe","sample","complexity","in","cases","where","the","early","acceptance","of","families","allows","removing","some\nvariables","from","observation.\nA","challenging","property","of","Bayesian","networks","in","this","respect","isMarkov","equivalence.","Two\ngraphs","are","considered","Markov","equivalent","if","they","induce","the","same","conditional","independence\nconstraints","[1].","This","also","means","that","for","any","distribution,","the","score","of","the","two","graphs\nis","identical.","Almost","all","DAGs","inG\nd,k\nhave","other","Markov-equivalent","DAGs","inG\nd,k\n,","and\nusually","there","is","not","even","a","single","family","that","is","shared","by","all","Markov-equivalent","graphs.\nActiveBNSLaddresses","this","issue","by","directly","handling","Markov","equivalence","classes,","which","are\nthe","equivalence","classes","induced","onG\nd,k\nby","the","Markov-equivalence","relation.","Denote","the","set\nof","equivalence","classes","(ECs)","inG\nd,k\nbyE\nd,k\n.","Since","all","the","structures","in","a","given","EC","have\nthe","same","score,","we","can","discuss","the","score","of","an","EC","without","confusion.","For","an","ECE∈E\nd,k\n,\ndenote","byS(E)the","(identical)","score","of","the","graphs","inE.","Anoptimal","ECis","an","EC","that\nmaximizes","the","score","over","all","ECs","inE\nd,k\n.","Note","that","this","EC","might","not","be","unique.\nActiveBNSL\n,","listed","in","Alg.","1,","getsd(the","number","of","variables)","andk(the","maximal\nnumber","of","parents)","as","inputs,","in","addition","to","a","confidence","parameterδ,","the","required","accuracy\nlevel\u000f,","and","an","initial","accuracy","level\u000f\n1\n,","which","we","treat","as","a","constant.ActiveBNSLmaintains\na","setV","⊆[d]of","the","variables","whose","families","have","been","accepted","so","far","(that","is,","their","parent\nsets","in","the","output","structure","have","been","fixed).","The","set","of","accepted","families","is","denotedAcc\nj\n,\nwherejdenotes","an","iteration","within","the","algorithm.Acc\nj\nincludes","exactly","one","family","for","each\nv∈","V.","The","set","of","candidate","families","is","denotedCand(V).","This","is","the","set","of","families","that\nhave","not","been","precluded","so","far","from","participating","in","the","output","structure.","For","simplicity,\nwe","setCand(V)to","the","set","of","all","the","families","with","a","child","variable","not","inV.","Note","that","this\ndoes","not","preclude,","for","instance,","families","that","would","create","a","cycle","when","combined","with\nAcc\nj\n.","As","will","be","evident","below,","including","redundant","families","inCand(V)does","not","harm","the\ncorrectness","ofActiveBNSL.\nActiveBNSLworks","in","rounds.","At","each","roundt,","the","algorithm","observes","all","the","subsets","in\nJdK\nk+1\nthat","include","at","least","one","variable","not","inV.","Each","such","subset","is","observed","a","sufficient\nnumber","of","times","to","obtain","a","required","accuracy.","","Let\nˆ\nH\nt\n(f)be","the","estimator","forH(f)\nbased","on","the","samples","observed","until","roundt,","and","denote","the","empirical","score","at","roundtby\nˆ\nS\nt\n(G)",":=−\n∑\nf∈G\nˆ\nH\nt\n(f).","Iteratively","within","the","round,ActiveBNSLfinds","some","equivalence\nclass\nˆ\nEthat","maximizes","the","empirical","score\nˆ\nS(\nˆ\nE)and","is","consistent","with","the","families","accepted\nso","far.","Here,G\nj\n:={G∈","G\nd,k\n|Acc\nj\n⊆G}denotes","the","set","of","graphs","that","are","consistent\nwith","these","families","in","iterationj,","and","the","empirical","score","of","a","set","of","graphsAis","defined","as\nˆ\nS\n(A)",":=max\nG∈A\nˆ\nS(G).","Note","that","unlike","the","true","score,","the","empirical","score","of","the","graphs","in\nan","EC","might","not","be","the","same","for","all","the","graphs,","due","to","the","use","of","partial","observations.","We\nalso","denoteU(A)",":=\n⋃\nG∈A\nG,","the","set","of","all","families","in","any","of","the","graphs","inA.\nForE∈E\nd,k\n,","denoteE\n∩j\n:=E∩G\nj\n.ActiveBNSLcalculates","a","thresholdθ\nj\n,","and","searches\nfor","a","family","such","that","in","each","of","the","ECs","whose","empirical","score","isθ\nj\n-close","to","the","empirical\nscore","of\nˆ\nE,","there","exists","at","least","one","graph","which","is","consistent","withAcc\nj\nand","includes","this\nfamily.","If","such","a","family","exists,","it","can","be","guaranteed","that","it","is","a","part","of","some","optimal","structure\nalong","with","previously","accepted","families.","Therefore,","it","is","accepted,","and","its","child","variable","is\nadded","toV.","At","the","end","of","every","round,","the","required","accuracy","level\u000f\nt\nis","halved.","Iterations\n6\n\nAlgorithm","1:ActiveBNSL\nInput:Integersd,k;δ∈(0,1);\u000f,\u000f\n1\n>0.\nOutput:A","graph\nˆ\nG\n1Intialize:Acc\n1\n←∅,V","←∅,N\n0\n←0,t←1,j←1,T←dlog\n2\n(2d\u000f\n1\n/\u000f)e.\n2while\u000f\nt\n>","\u000f/(d−|V|)do\n3N\nt\n←N(\u000f\nt\n/2,δ/(T|Cand(V)|))\n4For","each","subset","inJdK\nk+1\n\\JVK\nk+1\n,","observe","it","inN\nt\n−N\nt−1\nrandom","samples.\n5repeat\n6θ\nj\n←(d−|V|)·\u000f\nt\n7\nˆ\nG\nj\n←argmax{\nˆ\nS\nt\n(G)|G∈G\nj\n}","","4Recall:G\nj\n≡{G∈G\nd,k\n|Acc\nj\n⊆G}\n8\nˆ\nE\nj\n←the","EC","inE\nd,k\nthat","includes\nˆ\nG\nj\n9L\nj\n←{E∈E\nd,k\n|(E\n∩j\n6=∅)∧(\nˆ\nS\nt\n(\nˆ\nE\n∩j\nj\n)−\nˆ\nS\nt\n(E\n∩j\n)≤θ\nj\n)}\n10if∃f∈U(\nˆ\nE\n∩j\nj\n)∩Cand(V)such","that∀E∈L\nj\n,f∈U(E\n∩j\n)then\n11Setf←〈X\nv\n,Π〉such","thatfsatisfies","the","condition","above","andv∈[d]\n12V","←V","∪{v},Acc\nj+1\n←Acc\nj\n∪{f}#","(accept","familyf)\nelse\n13Acc\nj+1\n←Acc\nj\n14j←j+","1\nuntilAcc\nj\n=","Acc\nj−1\n15If|V|=dthenset\nˆ\nG←Acc\nj\nandreturn\nˆ\nG.\n16t←t+","1\n17\u000f\nt\n←\u000f\nt−1\n/2\n18\u000f\nlast\n←\u000f/(d−|V|),N\nT\n←N(\u000f\nlast\n/2,δ/(T|Cand(V)|))\n19For","each","subset","inJdK\nk+1\n\\JVK\nk+1\n,","observe","it","inN\nT\n−N\nT−1\nrandom","samples.\n20Return\nˆ\nG←argmax{\nˆ\nS\nT\n(G)|G∈G\nj\n}.\ncontinue","until\u000f\nt\n≤\u000f/(d−|V|).","It","is","easy","to","verify","that","the","total","number","of","rounds","is","at","most\nT−1","=dlog\n2\n(d\u000f\n1\n/\u000f)e,","whereTis","defined","inActiveBNSL.","In","the","last","round,","which","occurs\noutside","of","the","main","loop,","if","any","families","are","still","active,","the","remaining","variable","subsets","are\nobserved","based","on","the","required","accuracy\u000f.ActiveBNSLthen","returns","a","structure","which\nmaximizes","the","empirical","score,","subject","to","the","constraints","set","by","the","families","accepted","so","far.\nIn","the","next","section,","we","show","thatActiveBNSLindeed","finds","an\u000f-optimal","structure","with\na","probability","at","least1−δ.\n6","","Correctness","ofActiveBNSL\nThe","following","theorem","states","the","correctness","ofActiveBNSL.\nTheorem","6.1.\nWith","a","probability","at","least1−δ,","the","graph\nˆ\nGreturned","byActiveBNSL\nsatisfiesS(\nˆ\nG)≥S\n∗\n−\u000f.\n7\n\nTo","prove","Theorem","6.1,","we","first","give","some","preliminaries.","LetV\nt\nbe","the","setVat","the\nbeginning","of","roundt.","Define","the","following","event:\nη:={∀t∈[T],∀f∈Cand(V\nt\n),|\nˆ\nH\nt\n(f)−H(f)|≤\u000f\nt\n/2}.\nNoting","that","for","any","family","inCand(V\nt\n),\nˆ\nH\nt\n(f)is","estimated","based","onN\nt\n=N(\u000f\nt\n/2,δ/(T|Cand(V\nt\n)|))\nsamples,","it","is","easy","to","see","that","by","a","(conditional)","union","bound","over","at","mostTrounds","and\n|Cand(V\nt\n)|families","in","each","round,ηholds","with","a","probability","at","least1−δ.\nLet","aniterationofActiveBNSLbe","a","single","pass","of","the","inner","loop","starting","at","line","6.","Let\nJbe","the","total","number","of","iterations","during","the","entire","run","of","the","algorithm.","Note","that","a\nsingle","roundtcan","include","several","iterationsj.","Denote","byV\n(j)\nthe","value","ofVat","the","start","of\niterationj.","Underη,","it","follows","from","above","that","at","any","iterationjin","roundt,","for","any","graph\nG∈G\nj\n,\n|S(G\\Acc\nj\n)−\nˆ\nS\nt\n(G\\Acc\nj\n)|≤\n∑\nf∈G\\Acc\nj\n|H(f)−\nˆ\nH\nt\n(f)|≤(d−|V\n(j)\n|)·\u000f\nt\n/2","=θ\nj\n/2,(3)\nwhereθ\nj\nis","defined","in","line","6","of","Alg.","1.","","We","now","give","a","bound","on","the","empirical","score\ndifference","between","equivalence","classes.","","Fori∈1,2,","letE\ni\n∈","E\nd,k\nbe","two","equivalence\nclasses","such","thatE\n∩j\ni\n6=∅,","andG\ni\n∈argmax\nG∈E\n∩j\ni\nˆ\nS\nt\n(G).","","We","haveG\ni\n∈","G\nj\n.","","Hence,\n|S(G\ni\n\\Acc\nj\n)−\nˆ\nS\nt\n(G\ni\n\\Acc\nj\n)|","≤θ\nj\n/2.","In","addition,S(G\ni\n\\Acc\nj\n)","=S(E\ni\n)−S(Acc\nj\n)and\nˆ\nS\nt\n(E\n∩j\ni\n)","=\nˆ\nS\nt\n(G\ni\n)","=\nˆ\nS\nt\n(G\ni\n\\Acc\nj\n)","+\nˆ\nS\nt\n(Acc\nj\n).Therefore,","underη,\nˆ\nS\nt\n(E\n∩j\n1\n)−\nˆ\nS\nt\n(E\n∩j\n2\n)","=\nˆ\nS\nt\n(G\n1\n\\Acc\nj\n)−\nˆ\nS\nt\n(G\n2\n\\Acc\nj\n)\n=","(\nˆ\nS\nt\n(G\n1\n\\Acc\nj\n)−S(G\n1\n\\Acc\nj\n))","+","(S(G\n1\n\\Acc\nj\n)−S(G\n2\n\\Acc\nj\n))\n+","(S(G\n2\n\\Acc\nj\n)−\nˆ\nS\nt\n(G\n2\n\\Acc\nj\n))\n≤S(G\n1\n\\Acc\nj\n)−S(G\n2\n\\Acc\nj\n)","+θ\nj\n=S(E\n1\n)−S(E\n2\n)","+θ\nj\n.(4)\nThe","following","lemma","shows","that","if","a","family","is","accepted","in","the","main","loop","of","Alg.","1,","then\nit","is","in","some","optimal","structure","which","includes","all","the","families","accepted","so","far.","Denote","the\nset","of","optimal","graphs","inG\nj\nbyG\n∗\nj\n:=G\n∗\n∩G\nj\n.\nLemma","6.2.Assume","thatηoccurs.","Then","for","allj∈[J],G\n∗\nj\n6=∅.\nProof.The","proof","is","by","induction","on","the","iterationj.","Forj=","1,","we","haveG\nj\n=G\nd,k\n,","hence\nG\n∗\n1\n=G\n∗\n6=∅.","Now,","suppose","that","the","claim","holds","for","iterationj.","ThenG\n∗\nj\n6=∅.","We","show","that\nif","any","familyfis","accepted","in","this","iteration,","it","satisfiesf∈U(G\n∗\nj\n).","This","suffices","to","prove","the\nclaim,","sinceG\n∗\nj\n⊆G\nj\nimplies","that","all","the","graphs","inG\n∗\nj\nincludeAcc\nj\n;","Combined","withf∈U(G\n∗\nj\n),\nthis","implies","that","there","is","at","least","one","graph","inG\n∗\nj\nthat","includesAcc\nj+1\n≡Acc\nj\n∪{f},","thus\nG\n∗\nj+1\n6=∅,","as","needed.\nSuppose","thatfis","accepted","at","iterationj.","LetE\n∗\n⊆","G\n∗\nbe","an","optimal","EC","such","that\nE\n∩j\n∗\n6\n=∅;","one","exists","due","to","the","induction","hypothesis.","We","show","thatf∈U(E\n∩j\n∗\n),","thus","proving\nthatf∈U(G\n∗\nj\n).","By","eventηand","Eq.","(4),","we","have\nˆ\nS\nt\n(\nˆ\nE\n∩j\nj\n)−\nˆ\nS\nt\n(E\n∩j\n∗\n)≤S(\nˆ\nE\nj\n)−S(E\n∗\n)+θ\nj\n≤θ\nj\n.\nThe","last","inequality","follows","sinceS(\nˆ\nE\nt\n)≤","S(E\n∗\n).","Therefore,","forL\nj\nas","defined","in","line","9","of\nAlg.","1,","we","haveE\n∗\n∈L\nj\n.","Sincefis","accepted,","it","satisfies","the","condition","in","line","10,","therefore\nf∈U(E\n∩j\n∗\n).","This","proves","the","claim.\n8\n\nUsing","Lemma","6.2,","the","correctness","ofActiveBNSLcan","be","shown.\nProof","of","Theorem","6.1.\nAssume","thatηholds.","As","shown","above,","this","occurs","with","a","probability\nat","least1−δ.","LetAcc:=Acc\nJ\nbe","the","set","of","accepted","families","at","the","end","of","the","main","loop","of\nAlg.","1.","For","anyG∈G\nJ\n,","we","haveAcc⊆G,","henceS(G)","=S(Acc)","+S(G\\Acc),","and","similarly\nfor\nˆ\nS\nT\n.","In","addition,","for","each","familyf∈G\\Acc,","we","havef∈Cand(V\nT\n),","and","so","by","eventη\nwe","have|\nˆ\nH\nT\n(f)−H(f)|≤\u000f\nlast\n/2,","where\u000f\nlast\nis","defined","in","line","18","of","Alg.","1.","Therefore,","as","in\nEq.","(3),","for","anyG∈G\nJ\n,\n|S(G\\Acc)−\nˆ\nS\nT\n(G\\Acc)|≤(d−|V\nT\n|)·\u000f\nlast\n/2","=\u000f/2.\nBy","Lemma","6.2,","we","have","thatG\n∗\nJ\n6=∅.","LetG\n∗\nbe","some","graph","inG\n∗\nJ\n⊆G\nJ\n.","Recall","that","also\nˆ\nG∈","G\nJ\n.","By","the","definition","of\nˆ\nG,\nˆ\nS\nT\n(\nˆ\nG)≥\nˆ\nS\nT\n(G\n∗\n).","Hence,\nˆ\nS\nT\n(\nˆ\nG\\Acc)≥\nˆ\nS\nT\n(G\n∗\n\\Acc).\nCombining","this","with","the","inequality","above,","it","follows","that\nS(\nˆ\nG\\Acc)≥\nˆ\nS\nT\n(\nˆ\nG\\Acc)−\u000f/2≥\nˆ\nS\nT\n(G\n∗\n\\Acc)−\u000f/2≥S(G\n∗\n\\Acc)−\u000f.\nTherefore,S(\nˆ\nG)≥S(G\n∗\n)−\u000f,","which","proves","the","claim.\n7","","The","Sample","Complexity","ofActiveBNSL\nWe","now","analyze","the","number","of","samples","drawn","byActiveBNSL.","We","show","that","it","is","never\nmuch","larger","than","that","of","the","naive","algorithm,","while","it","can","be","significantly","smaller","for","some\nclasses","of","distributions.","For","concreteness,","we","show","sample","complexity","calculations","using\nthe","value","ofN(\u000f,δ)given","in","Section","4","for","discrete","distributions","with","the","plug-in","entropy\nestimator.","We","assume","a","regime","with","a","small","constantkand","a","possibly","larged.\nActiveBNSLrequires","the","largest","number","of","samples","if","no","family","is","accepted","until\nroundT≡","dlog\n2\n(2d\u000f\n1\n/\u000f)e.","In","this","case,","the","algorithm","pulls","all","subsets","inJdK\nk+1\n,","each\nforN(\u000f/(2d),δ/(T|F\nd,k\n|))times.","Thus,","the","worst-case","sample","complexity","ofActiveBNSLis\n|JdK\nk+1\n|·N(\u000f/(2d),δ/(T|F\nd,k\n|))","=\n","̃\nΘ\n(\nd\nk+3\n\u000f\n2\nlog(d\nk+1\n/δ)\n)\n.\nBy","comparing","to","Eq.","(2),","it","can","be","seen","that","the","sample","complexity","ofActiveBNSLis","never\nmuch","worse","than","that","of","the","naive","algorithm;","the","only","difference","is","in","the","logarithmic","factors\ndue","to","the","value","ofT,","which","areO(log(log(d/\u000f))).\nIn","the","general","case,","the","sample","complexity","ofActiveBNSLcan","be","upper-bounded","based\non","the","round","in","which","each","variable","was","added","toV.","Lett\n1\n<","...","<","t\nn\nbe","the","rounds","in\nwhich","at","least","one","variable","was","added","toV,","and","denotet\nn+1\n:=T.","LetV\ni\nfori∈[n]be","the\ntotal","number","of","variables","added","until","the","end","of","roundt\ni\n,","and","setV\n0\n=","0,V\nn+1\n=d.","Note\nthatV\nn\nis","the","size","ofVat","the","end","ofActiveBNSL.","In","roundt\ni\n,V\ni\n−V\ni−1\nvariables","are","added\ntoV.","Denoting","byQ\ni\nthe","number","of","subsets","that","are","observed","byActiveBNSLfor","the","last\ntime","in","roundt\ni\n,","we","have\nQ\ni\n:=|JV\ni\nK\nk+1\n\\JV\ni−1\nK\nk+1\n|=\n(\nV\ni\nk+","1\n)\n−\n(\nV\ni−1\nk+","1\n)\n≤(V\ni\n−V\ni−1\n)V\nk\ni\n.\n9\n\nThe","sample","complexity","ofActiveBNSLis","at","most\n∑\ni∈[n+1]\nQ\ni\nN\nt\ni\n,","where\nN\nt\ni\n≡N(\u000f\nt\ni\n/2,δ/(T|Cand(V)|))","=\n","̃\nO\n(\n1\n\u000f\n2\nt\ni\n(log(d\nk+1\n/δ)","+","log(log(1/\u000f))\n)\n.\nThe","sample","complexity","is","thus","upper-bounded","by\n","̃\nO\n\n\n(\n∑\ni∈[n]\n(V\ni\n−V\ni−1\n)V\nk\ni\n·\n1\n\u000f\n2\nt\ni\n+d\nk\n(d−V\nn\n)\n3\n·\n1\n\u000f\n2\n)\n·log(d\nk+1\n/δ)\n\n\n.(5)\nSince\u000f\nt\nis","decreasing","int,","if","most","variables","are","added","toVearly","in","the","run","of","the","algorithm,\nconsiderable","savings","in","the","sample","complexity","are","possible.","We","next","describe","a","family\nof","distributions","for","whichActiveBNSLcan","have","a","significantly","smaller","sample","complexity\ncompared","to","the","naive","algorithm.","In","the","next","section,","we","describe","a","general","construction\nthat","satisfies","these","requirements.\nDefinition","7.1.\nLetγ",">0,","and","letV⊆X.","A(γ,V)-stable","distributionoverXis","a\ndistribution","which","satisfies","the","following","conditions.\n1.In","everyG∈G\nd,k\nsuch","thatS(G)≥S\n∗\n−γ,","the","parents","of","all","the","variables","inVare\nalso","inV.\n2.\nThere","is","a","unique","optimal","EC","for","the","marginal","distribution","onV,","and","the","difference\nin","scores","between","the","best","EC","and","the","second-best","EC","onVis","more","thanγ.\nTheorem","7.2,","stated","below,","states","that","the","sample","complexity","improvement","for","a","discrete\nstable","distribution","can","be","as","large","as","a","factor","of\n","̃\nΩ(d\n3\n).","In","Section","8,","we","give","a","specific\nconstruction","of","a","class","of","distributions","that","satisfies","the","necessary","conditions","of","Theorem","7.2.\nThis","class","is","characterized","by","the","existence","of","two","similar","variables,","one","a","noisy","version","of\nthe","other.\nTheorem","7.2.\nFix","a","constantq∈Nand","assumed",">","q.","Letγ",">0andVof","sized−q.\nLetDbe","a","discrete(γ,V)-stable","distribution.","If\u000f=O(d\n−3/2\n),","then","the","sample","complexity\nimprovement","factor","ofActiveBNSLcompared","to","the","naive","algorithm","is\n","̃\nΩ(d\n3\n).\nTo","prove","Theorem","7.2,","we","first","prove","several","lemmas.","The","following","lemma","gives","a\nsufficient","condition","for","a","family","to","be","accepted","byActiveBNSLat","a","given","iteration.\nLemma","7.3.Assume","thatηoccurs.","Letjbe","an","iteration","in","the","run","ofActiveBNSL.","For","a\nfamilyf,","define\nS\n¬\nj\n(f)",":=","max{S(E)|E∈E\nd,k\n,E\n∩j\n6=∅,f","/∈U(E\n∩j\n)}.\nThis","is","the","maximal","score","of","an","equivalence","class","which","is","consistent","with","families","accepted\nso","far","and","also","inconsistent","withf.\nSuppose","that","for","somef∈U(G\n∗\nj\n)∩Cand(V\n(j)\n),","we","haveS\n¬\nj\n(f)<S\n∗\n−2θ\nj\n.","Then,","some\nfamily","is","accepted","byActiveBNSLat","iterationj.\n10\n\nProof.LetE\n∗\n⊆G\n∗\nbe","an","optimal","EC","such","thatE\n∩j\n∗\n6=∅.","By","Lemma","6.2,","such","an","EC","exists.\nSuppose","that","the","assumption","of","the","lemma","holds.","Then,","for","somef∈U(G\n∗\nj\n)∩Cand(V\n(j)\n),","we\nhaveS\n¬\nj\n(f)<S\n∗\n−2θ\nj\n.","It","follows","that","for","anyE∈E\nd,k\nsuch","thatE\n∩j\n6=∅andf","/∈U(E\n∩j\n),\n2θ\nj\n<S(E\n∗\n)−S(E).","By","the","definition","of\nˆ\nE\nj\n(line","8","in","Alg.","1),","we","have\nˆ\nS\nt\n(\nˆ\nE\n∩j\nj\n)≥\nˆ\nS\nt\n(E\n∩j\n∗\n).\nIn","addition,","since","eventηoccurs,","Eq.","(4)","holds.","Therefore,\nˆ\nS\nt\n(\nˆ\nE\n∩j\nj\n)−\nˆ\nS\nt\n(E\n∩j\n)≥\nˆ\nS\nt\n(E\n∩j\n∗\n)−\nˆ\nS\nt\n(E\n∩j\n)≥S(E\n∗\n)−S(E)−θ\nj\n>","θ\nj\n.\nIt","follows","thatE","/∈L\nj\n,","whereL\nj\nis","as","defined","in","line","9","of","Alg.","1.","Therefore,∀E∈\nL\nj\n,f∈U(E\n∩j\n).","In","particular,f∈U(\nˆ\nE\n∩j\nj\n).","Sincef∈Cand(V\n(j)\n),","it","follows","thatf∈\nU\n(\nˆ\nE\n∩j\nj\n)∩Cand(V\n(j)\n).","Therefore,","the","condition","in","line","10","is","satisfied,","which","implies","that\nsome","family","is","accepted","during","iterationj.\nNext,","we","give","a","characterization","of","the","optimal","structures","forD.","LetG\nV\nbe","the","set","of\nDAGs","with","an","in-degree","at","mostkoverV.","Denote\n","̄\nV:=X\\V.","We","term","a","set","of","families\nF⊆F\nd,k\nalegal","family","set","for\n","̄\nVif","it","includes","exactly","one","family","for","each","variable","in\n","̄\nVand\nno","other","families,","and","has","no","cycles.","Note","ifG∈G\nV\nandFis","a","legal","family","set","for\n","̄\nV\n,","then\nG∪F∈G\nd,k\n.\nLemma","7.4.LetDbe","a(γ,V)-stable","distribution.","LetG\n∗\n∈E\n∗\n,","and","letF⊆G\n∗\nbe","set","of\nthe","families","of\n","̄\nVinG\n∗\n.","Then","the","following","hold:\n1.G\n∗\n\\F∈G\nV\n;\n2.S(G\n∗\n\\F)","=","max\nG∈G\nV\nS(G);\n3.","The","score","ofFis","maximal","among","the","legal","family","sets","for\n","̄\nV.\nProof.By","the","assumptions","on","the","distribution,","sinceG\n∗\nis","an","optimal","structure,\n","̄\nVhas","no\noutgoing","edges","intoV.","Therefore,G\n∗\n\\F∈G\nV\n.","This","proves","the","first","part","of","the","lemma.\nTo","prove","the","second","part","of","the","lemma,","letG\n∗\n1\n∈G\nV\nbe","some","DAG","overVwith","a","maximal\nscore.","Note","thatFis","a","legal","family","set","for\n","̄\nV.","LetG\n1\n:=G\n∗\n1\n∪F∈G\nd,k\n.","Then,\nS(G\n∗\n\\F)","+S(F)","=S(G\n∗\n)≥S(G\n1\n)","=S(G\n∗\n1\n)","+S(F).\nTherefore,S(G\n∗\n\\F)≥S(G\n∗\n1\n).","Hence,G\n∗\n\\Fis","also","optimal","overV.","This","proves","the","second\npart","of","the","lemma.\nTo","prove","the","third","part","of","the","lemma,","letF\n′\n6=Fbe","some","legal","family","set","for\n","̄\nV.","Then\nG\n2\n:=","(G\n∗\n\\F)∪F\n′\n∈","G\nd,k\n,","andS(G\n2\n)","=S(G\n∗\n)−S(F)","+S(F\n′\n).","SinceG\n∗\nis","an","optimal\nstructure,S(G\n2\n)≤S(G\n∗\n).","Therefore,S(F)≥S(F\n′\n).","This","holds","for","all","legal","family","sets","of\n","̄\nV\n.","Therefore,","the","score","ofFis","maximal","among","such","sets,","which","proves","the","third","part","of","the\nlemma.\nThe","next","lemma","shows","that","equivalence","classes","with","a","near-optimal","score","include","graphs\nwith","common","families.\nLemma","7.5.LetDbe","a(γ,V)-stable","distribution.","For","a","set","of","familiesA∈F\nd,k\nand","an\nequivalence","classE,","denoteE\n∩A\n:={G∈E|A⊆G}.","LetG\n∗\n∈E\n∩A\n∗\n,","and","suppose","that\nthere","is","some\n","̃\nE∈E\nd,k\nsuch","that\n","̃\nE6=E\n∗\n,S(\n","̃\nE)≥S\n∗\n−γand\n","̃\nE\n∩A\n6=∅.\nThen,","there","exists","a","graph\n","̃\nG∈\n","̃\nE\n∩A\nsuch","that","the","families","of","all","the","variables","inVare\nthe","same","in","bothG\n∗\nand\n","̃\nG.\n11\n\nTo","prove","this","lemma,","we","use","a","known","characterization","of","a","Markov","equivalence","class,\nwhich","relies","on","the","notion","of","av-structure.","In","a","DAGG,","a","v-structure","is","an","ordered","triplet\nof","nodes(X,Y,Z)such","thatGcontains","the","edges(X,Y)and(Z,Y),","and","there","is","no","edge\nin","either","direction","betweenXandZinG.\nTheorem","7.6\n([48]).Two","DAGs","are","equivalent","if","and","only","if","they","have","the","same","skeletons\n(underlying","undirected","graphs)","and","the","same","set","of","v-structures.\nof","Lemma","7.5.LetGbe","some","graph","in\n","̃\nE\n∩A\n.","LetF,F\n∗\nbe","the","families","of\n","̄\nVinGandG\n∗\nrespectively.","Note","that","bothFandF\n∗\nare","legal","family","sets","for\n","̄\nV,","since","they","are","subsets\nof","DAGs","inG\nd,k\n.","Define","the","graphG\n1\n:=G\n∗\n\\F\n∗\n,","and","set\n","̃\nG:=G\n1\n∪F.","By","Lemma","7.4,\nG\n1\n∈G\nV\n.","Thus,","we","also","have\n","̃\nG∈G\nd,k\n.","Furthermore,","the","families","of","all","the","variables","inV\nare","the","same","inG\n∗\nand\n","̃\nG.\nTo","show","that\n","̃\nGsatisfies","the","conditions","of","the","lemma,","it","is","left","to","show","that\n","̃\nG∈\n","̃\nE\n∩A\n.\nFirst,","note","thatA⊆\n","̃\nG,","since","any","family","inAis","either","inG\n1\nor","inF.","We","now","prove","that\n","̃\nG∈\n","̃\nE,","by","showing","thatGand\n","̃\nGare","Markov","equivalent.","DefineG\n2\n:=G\\F.","Since\nS(G)","=S(\n","̃\nE)≥S\n∗\n−γ,","by","assumption","1","in","Def.","7.1,","it","holds","that","inGall","the","variables","in\nVhave","parents","inV.","Thus,G\n2\n∈G\nv\n.\nWe","now","prove","thatG\n1\nandG\n2\nare","Markov","equivalent,","and","conclude","that","the","same","holds\nforGand\n","̃\nG\n.","First,","we","show","thatS(G\n2\n)","=S(G\n1\n).","We","haveG\n1\n,G\n2\n∈G\nv\n,","and","by","Lemma","7.4,\nG\n1\nis","an","optimal","graph","onV.","Therefore,S(G\n2\n)≤S(G\n1\n).","Now,","suppose","for","contradiction\nthatS(G\n2\n)<S(G\n1\n).","Then,","by","assumption","2","in","Def.","7.1,","we","haveS(G\n2\n)<S(G\n1\n)−γ.","We\nalso","have,","by","Lemma","7.4,","thatS(F)≤S(F\n∗\n).","It","follows","that\nS(G)","=S(G\n2\n)","+S(F)≤S(G\n2\n)","+S(F\n∗\n)<S(G\n1\n)−γ+S(F\n∗\n)","=S(G\n∗\n)−γ=S\n∗\n−γ.\nTherefore,S(G)<S\n∗\n−γ.","ButG∈\n","̃\nE,","and","soS(G)≥S\n∗\n−γ,","leading","to","a","contradiction.","It\nfollows","thatS(G\n2\n)","=S(G\n1\n),","implying","thatG\n2\nis","also","an","optimal","structure","onV.","Combining\nthis","with","the","uniqueness","of","the","optimal","EC","onV,","as","given","in","assumption","2","of","Def.","7.1,","we\nconclude","thatG\n1\nandG\n2\nare","Markov","equivalent.\nTo","show","thatGand\n","̃\nG\nare","Markov","equivalent,","we","first","observe","that","sinceG\n1\nandG\n2\nare","equivalent,","then","by","Theorem","7.6,","they","have","the","same","skeleton","and","the","same","set","of\nv-structures.","Therefore,G\n1\n∪FandG\n2\n∪Falso","have","the","same","skeleton.","In","addition,","they\nhave","the","same","set","of","v-structures,","as","follows:","The","v-strctures","with","a","child","inVare","inG\n1\nandG\n2\nand","so","they","are","shared;","The","v-structures","with","a","child","in\n","̄\nVare","those","with","parents","in\nFand","no","edges","between","the","parents.","Since","both","graphs","share","the","same","skeleton,","these","must\nbe","the","same","v-structures.","This","proves","thatGand\n","̃\nG\nare","Markov","equivalent,","thus\n","̃\nG∈\n","̃\nE\n,\nand","so,","as","observed","above,","also\n","̃\nG∈\n","̃\nE\n∩A\n,","which","completes","the","proof.\nThe","last","lemma","required","for","proving","Theorem","7.2","shows","that","for","a","stable","distribution,\nActiveBNSLis","guaranteed","to","accept","families","early.\nLemma","7.7.LetDbe","a(γ,V)-stable","distribution.","Consider","a","run","ofActiveBNSLin","which\nηholds.","Then,ActiveBNSLaccepts","at","least|V|families","until","the","end","of","the","first","roundt\nwhich","satisfies\u000f\nt\n≤γ/(2d).\nProof.\nSuppose","thatActiveBNSLhas","accepted","less","than|V|families","until","some","iterationj.\nThenV\\V\n(j)\n6=∅.","Letf∈U(G\n∗\nj\n)∩Cand(V\n(j)\n)be","a","family","of","some","variable","inV\\V\n(j)\nthat\n12\n\nbelongs","to","an","optimal","structure","inG\n∗\nj\n.","Note","that","such","a","family","exists,","since","by","Lemma","6.2,\nG\n∗\nj\n6\n=∅.","Let\n","̃\nE∈E\nd,k\nsuch","that\n","̃\nE\n∩j\n6=∅andS(\n","̃\nE)≥S\n∗\n−γ.","LetG\n∗\n∈G\n∗\nj\n.","By","Lemma","7.5\nwithA:=Acc\nj\n,","there","exists","a","graph\n","̃\nG∈\n","̃\nE\n∩j\nsuch","thatf∈\n","̃\nG.","Therefore,f∈U(\n","̃\nE\n∩j\n).\nSince","this","holds","for","any\n","̃\nE∈E\nd,k\nthat","satisfies","the","conditions","above,","it","follows","that","forS\n¬\nj\n(f)\nas","defined","in","Lemma","7.3,","we","have","thatS\n¬\nj\n(f)<S\n∗\n−γ.","The","conditions","of","Lemma","7.3","thus\nhold","if2θ\nj\n≤γ.","In","this","case,","some","family","will","be","accepted","at","iterationj.","In","roundt,θ\nj\n≤d\u000f\nt\n,\nand","the","round","only","ends","when","no","additional","families","are","accepted.","Therefore,","at","least|V|\nfamilies","will","be","accepted","until","the","end","of","the","first","roundtwith\u000f\nt\n≤γ/(2d).\nWe","are","now","ready","to","prove","Theorem","7.2.\nof","Theorem","7.2.SinceDis","a","discrete","distribution,","the","sample","complexity","upper","bounds\ngiven","in","Eq.","(2)","and","Eq.","(5)","can","be","used.","The","sample","complexity","of","the","naive","algorithm","is\n","̃\nΩ(\nd\nk+3\n\u000f\n2\n·log(d\nk+1\n/δ))(see","Eq.","(2)).\nTo","upper","bound","the","sample","complexity","ofActiveBNSL,","observe","that","by","Lemma","7.7,\non","the","first","roundtwith\u000f\nt\n≤γ/(2d),","at","least|V|=d−qfamilies","have","been","accepted.\nFollowing","Eq.","(5)","and","the","notation","therein,","the","sample","complexity","ofActiveBNSLcan","be\nupper","bounded","by","settingn=","1,V\n1\n=d−q,t\n1\n=t,","and","getting","an","upper","bound","of\n","̃\nO\n(\n(\n(d−q)\nk+1\n·\n1\n\u000f\n2\nt\n+d\nk\nq\n3\n·\n1\n\u000f\n2\n)\n·log(d\nk+1\n/δ)\n)\n≤\n","̃\nO\n(\n(\nd\nk+1\n\u000f\n2\nt\n+\nd\nk\n\u000f\n2\n)\n·log(d\nk+1\n/δ)\n)\n=\n","̃\nO\n(\n(\nd\nk+3\n+\nd\nk\n\u000f\n2\n)\n·log(d\nk+1\n/δ)\n)\n.\nThe","last","equality","follows","since\u000f\nt\n∈(γ/(4d),γ/(2d)].","Dividing","this","by","the","sample","complexity\nof","the","naive","algorithm,","we","get","a","sample","complexity","ratio","of\n","̃\nO(\u000f\n2\n+","1/d\n3\n).","For\u000f=O(d\n−3/2\n),\nthis","ratio","is\n","̃\nO\n(1/d\n3\n).","the","sample","complexity","ofActiveBNSLis","thus","a","factor","of\n","̃\nΩ\n(d\n3\n)smaller\nthan","that","of","the","naive","algorithm.\nTheorem","7.2","gives","a","set","of","conditions","that,","if","satisfied","by","a","distribution,","lead","to","a\nsignificant","sample","complexity","reduction","when","usingActiveBNSL.","In","the","next","section,","we\ngive","a","construction","which","satisfies","this","set","of","conditions.\n8","","A","Class","of","Stable","Distributions\nIn","this","section,","we","give","an","explicit","construction","of","a","family","of","distributions","that","are","stable\naccording","to","Def.","7.1.","The","construction","starts","with","a","distribution","with","a","unique","optimal\nEC,","and","augments","it","with","a","noisy","version","of","one","of","its","variables.","This","leads","to","a","structure\nlearning","problem","in","which","most","variable","dependencies","are","easy","to","identify,","but","it","is","difficult\nto","discern","between","the","two","versions","of","the","noisy","variable.","In","this","situation,","the","advantage\nofActiveBNSLis","manifested,","since","it","can","request","more","samples","from","the","families","that","are\nmore","difficult","to","choose","from.\nLetD\n1\nbe","a","distribution","over","a","finite","set","of","at","leastkvariablesX\n1\n,","which","satisfies","the\nfollowing","properties","for","some","valuesβ,α",">0.\n13\n\n(I)D\n1\nhas","a","unique","optimal","EC,","and","the","difference","in","scores","between","this","EC","and","the\nnext-best","EC","is","at","leastβ.\n(II)X\na\ndoes","not","have","children","in","any","of","the","structures","in","the","optimal","EC\n(III)H(X\na\n|X\n1\n\\{X\na\n})","=α.\nProperty","(II)","holds,","for","instance,","in","the","case","that","the","optimal","EC","includes","a","graph","in","which\nX\na\nhas","no","children","and","no","edges","between","any","of","its","parents.","By","Theorem","7.6,","in","this","case,\nX\na\nis","the","child","in","a","v-structure","with","each","two","of","its","parents,","and","since","v-structures","are\npreserved","within","the","optimal","EC,X\na\nhas","no","children","in","any","of","the","equivalent","structures.\nWe","now","define","a","distribution","which","is","similar","toD\n1\n,","except","thatX\na\nhas","a","slightly","noisy\ncopy,","denotedX\nb\n.","Let","the","set","of","variables","beX:=X\n1\n∪{X\nb\n},","and","setd:=|X|.","For","any\nλ∈\n(\n0,min(α,\nβ\n3d\n)\n)\n,","we","define","the","distributionD\n2\n(λ)ofXin","which","the","marginal","ofD\n2\n(λ)\noverX\n1\nisD\n1\n,","andX\nb\nis","defined","as","follows:\n(IV)X\nb\nis","an","independently","noisy","version","ofX\na\n.","Formally,","there","is","a","hidden","Bernoulli\nvariableCwhich","is","independent","ofX\n1\n,","such","thatP[X\nb\n=X\na\n|C=","","1]","","=","","1,","and\n(X\nb\n⊥X\n1\n)|C=","0.\n(V)","The","probabilityP(C=","1)is","such","thatmax(H(X\nb\n|X\na\n),H(X\na\n|X\nb\n))","=λ.\nThe","following","theorem","shows","thatD\n2\nis","stable","where","the","setVincludes","all","but","one\nvariable.","Thus,","Theorem","7.2","holds","withq=","1,","leading","to","a","sample","complexity","improvement\nfactor","as","large","as\n","̃\nΩ(d\n3\n)for","this","construction.\nTheorem","8.1.D\n2\n(λ)is","a(γ,V)-stable","distribution","forV:=X\n1\n\\X\na\nand","for","allγ≤β−3dλ.\nBefore","turning","to","the","proof","of","Theorem","8.1,","we","note","that","Theorem","7.2","assumes","a","given\nrequired","accuracy\u000f.","If","the","score","of","the","second-best","EC","is","much","smaller","thanS\n∗\n−\u000f,","and\nthis","is","known","in","advance,","then","one","could","set\u000fto","a","larger","value,","thus","potentially","voiding","the\nconclusion","of","Theorem","7.2.","The","following","theorem","shows","that","this","is","not","the","case","for","the\nconstruction","ofD\n2\n.","Its","proof","is","provided","in","Appendix","B.\nTheorem","8.2.\nFor\u000f∈\n(\n0,2·min(α,\nβ\n3d\n)\n)\n,","there","exists","a","value","ofλsuch","that","inD\n2\n(λ)there\nexists","a","non-optimal","EC","with","a","score","of","at","leastS\n∗\n−\u000f.\nWe","now","prove","Theorem","8.1","by","proving","several","lemmas.","The","first","lemma","gives","useful\ntechnical","inequalities.","Its","proof","is","provided","in","Appendix","B.\nLemma","8.3.Assume","the","distributionD\n2\n(λ)defined","above.","For","anyΠ,Π\nb\n,Π\na\n⊆X\n1\nand\nanyY∈X\n1\n,","the","following","hold:\n|H(X\nb\n|Π)−H(X\na\n|Π)|≤λ,(6)\n|H(Y|Π,X\nb\n)−H(Y|Π,X\na\n)|≤3λ.(7)\nThe","next","lemma","shows","that","any","DAG","forD\n2\ncan","be","transformed","to","a","DAG","with","a","similar\nscore","in","whichX\nb\nhas","no","children.","The","proof","of","the","lemma","is","provided","in","Appendix","B.\n14\n\nLemma","8.4.LetG∈","G\nd,k\n.","There","exists","a","graph\n","̃\nG∈","G\nd,k\nthat","satisfies","the","following\nproperties:\n1.|S(\n","̃\nG)−S(G)|<3dλ;\n2.","In\n","̃\nG,X\nb\nhas","no","children;\n3.\nIn\n","̃\nG,","the","children","ofX\na\nare","exactly","the","children","ofX\na\nandX\nb\ninG(except","forX\na\n,","if\nit","is","a","child","ofX\nb\ninG).\nNext,","we","use","Lemma","8.4","to","prove","that","property","1","in","Def.","7.1","holds","forD\n2\n.\nLemma","8.5.\nAssume","the","distributionD\n2\n(λ)as","defined","above.","LetGbe","a","structure","such\nthat","at","least","one","ofX\na\n,X\nb\nhas","children","other","thanX\na\n,X\nb\n.","Then,S(G)<S\n∗\n−β+","3dλ.\nProof.In","this","proof,","all","scores","are","calculated","for","the","joint","distribution","defined","byD\n2\n(λ).","Let\nΠ\nb\nbe","a","parent","set","of","sizekforX\nb\nthat","maximizes","the","family","score.","Formally,\nΠ\nb\n∈argmax\nΠ⊆X\n1\n:|Π|=k\nS({〈X\nb\n,Π〉}).\nLetf\n∗\nb\n=〈X\nb\n,Π\nb\n〉.","Denote","byG\nd−1,k\nthe","set","of","DAGs","with","an","in-degree","of","at","mostk\noverX\n1\n.","LetG\n1\n∈","G\nd−1,k\nbe","such","a","DAG","with","a","maximal","score,","and","denote","this","score\n","̄\nS.","","LetG\n′\n1\n=G\n1\n∪{f\n∗\nb\n}.","","This","is","a","DAG","inG\nd,k\n(overX≡X\n1\n∪{X\nb\n}),","with","a","score\nS(G\n′\n1\n)","=\n","̄\nS+S({f\n∗\nb\n}).","Therefore,S\n∗\n≥\n","̄\nS+S({f\n∗\nb\n}).\nNow,","letGbe","a","structure","such","that","at","least","one","ofX\na\n,X\nb\nhas","children","other","thanX\na\n,X\nb\n.\nWe","consider","two","cases:\n1.X\nb\nhas","no","children","inG.\n2.X\nb\nhas","children","inG.\nIn","case","1,X\na\nhas","children","inX\n1\n.","Letf\nb\nbe","the","family","ofX\nb\ninG.","The","graphG\\{f\nb\n}is","a\nDAG","overX\n1\nin","whichX\na\nhas","children.","Therefore,","by","assumption","(II)","in","the","definition","ofD\n1\n,\nG\\{f\nb\n}is","not","an","optimal","DAG,","and","so","by","assumption","(I),","it","holds","thatS(G\\{f\nb\n})≤\n","̄\nS−β.\nTherefore,","we","have\nS(G)","=S(G\\{f\nb\n})","+S({f\nb\n})≤S(G\\{f\nb\n})","+S({f\n∗\nb\n})≤\n","̄\nS−β+S({f\n∗\nb\n})≤S\n∗\n−β.\nThe","last","inequality","follows","from","the","fact","proved","above","thatS\n∗\n≥\n","̄\nS+S({f\n∗\nb\n}).","This","proves\nthe","statement","of","the","lemma","for","case","1.\nIn","case","2,X\nb\nhas","children","inG.","Denote","this","set","of","children","byW.","By","Lemma","8.4,","there\nexists","a","graph\n","̃\nG∈G\nd,k\nsuch","that|S(G)−S(\n","̃\nG\n)|<3dλ,X\nb\nhas","no","children,","and","the","children\nofX\na\nareW\\{X\na\n}as","well","as","the","children","ofX\na\ninG.","Now,","consider","two","cases.\n•W6={X\na\n}.","In","this","case,W\\{X\na\n}6=∅but","cannot","includeX\nb\n,","and","so","in\n","̃\nG,X\na\nhas\nat","least","one","child","which","is","different","fromX\nb\n.\n•W\n={X\na\n}.","In","this","case,","from","the","definition","ofG,","it","follows","thatX\na\nhas","children","other\nthanX\nb\ninG,","and","so","also","in\n","̃\nG.\n15\n\nIn","both","cases,","we","get","that","in\n","̃\nG,X\nb\nhas","no","children","andX\na\nhas","at","least","one","child","other","than\nX\nb\n.","Thus,\n","̃\nGsatisfies","the","conditions","of","case","1","discussed","above.","It","follows","thatS(\n","̃\nG)≤S\n∗\n−β.\nTherefore,S(G)<S\n∗\n−β+","3dλ.","This","proves","the","statement","of","the","lemma","for","case","2,","thus\ncompleting","the","proof.\nThe","next","lemma","shows","that","property","2","in","Def.","7.1","of","a","stable","distribution","holds","forD\n2\n,\nfor","anyγ","<","β\nLemma","8.6.Consider","the","marginal","ofD\n2\n(λ)onX\n1\n\\{X\na\n}.","There","is","a","unique","optimal","EC\nfor","this","distribution,","and","the","difference","in","scores","between","the","optimal","EC","and","the","second-best\nEC","is","at","leastβ.\nProof.\nLetE\n1\nbe","an","optimal","EC","for","the","considered","marginal","overX\n1\n\\{X\na\n}.","LetG\n1\n∈E\n1\n.\nLetΠ\na\nbe","a","parent","set","of","sizekforX\na\nthat","maximizes","the","family","score.","Formally,\nΠ\na\n∈argmax\nΠ⊆X\n1\n\\X\na\n:|Π|=k\nS({〈X\na\n,Π〉}).\nDenotef\n∗\na\n:=〈X\na\n,Π\na\n〉.","LetGbe","an","optimal","graph","overX\n1\n,","and","letf\na\nbe","the","family","ofX\na\ninG.","By","assumption","(II)","onD\n1\n,X\na\nhas","no","children","inG.","Therefore,G\\{f\na\n}is","a","DAG\nwith","an","in-degree","at","mostkoverX\n1\n\\{X\na\n}.","Thus,S(G\\{f\na\n})≤S(G\n1\n).","It","follows","that\nS(G)","=S(G\\{f\na\n})","+S({f\na\n})≤S(G\\{f\na\n})","+S({f\n∗\na\n})≤S(G\n1\n)","+S({f\n∗\na\n})","=S(G\n1\n∪{f\n∗\na\n}).\nTherefore,G\n1\n∪{f\n∗\na\n}is","also","optimal","onX\n1\n.","Now,","assume","for","contradiction","that","there","is\nanother","optimal","EC","overX\n1\n\\{X\na\n},","denotedE\n2\n,","and","letG\n2\n∈E\n2\n.","By","the","same","analysis","as\nabove,G\n2\n∪{f\n∗\na\n}is","also","optimal","onX\n1\n.","However,","by","Theorem","7.6,","sinceG\n1\nandG\n2\nare","not\nequivalent,","thenG\n1\n∪{f\n∗\na\n}andG\n2\n∪{f\n∗\na\n}are","also","not","equivalent,","contradicting","assumption\n(I)","onD\n1\n.","Therefore,E\n1\nis","the","only","optimal","EC","overX\n1\n\\{X\na\n}.\nNow,","letG\n3\nbe","non-optimal","DAG","with","an","in-degree","at","mostkoverX\n1\n\\{X\na\n},","so\nS(G\n3\n)<S(G\n1\n).","By","assumption","(I)","onD\n1\n,S(G\n3\n∪{f\n∗\na\n})≤","S(G\n1\n∪{f\n∗\na\n})−β.","Therefore,\nS(G\n3\n)≤S(G\n1\n)−β.","This","proves","the","claim.\nTheorem","8.1","is","now","an","immediate","consequence","of","the","lemmas","above,","since","both","properties\nof","Def.","7.1","hold","for","all","positiveγ≤β−3dλ,","by","Lemma","8.5","and","Lemma","8.6.\n9","","Experiments\nIn","this","section,","we","report","an","empirical","comparison","between","the","naive","algorithm,","given","in\nSection","4,","andActiveBNSL,","given","in","Section","5.","We","implemented","the","algorithms","for","the","case\nof","discrete","distributions,","using","the","plug-in","estimator","for","entropy","to","calculate","the","empirical\nscore\nˆ\nS(see","Eq.","(1)),","as","discussed","in","Section","4.","The","code","for","both","algorithms","and","for","the\nexperiments","below","is","available","athttps://github.com/noabdavid/activeBNSL.\nFirst,","we","describe","how","we","implemented","the","non-trivial","steps","in","each","algorithm.","The\nnaive","algorithm","aims","to","output","a","network","structure","inG\nd,k\nthat","maximizes","the","empirical\nscore,","as","defined","in","Eq.","(1).","Finding","a","structure","with","the","maximal","score","is","computationally\nhard","in","the","general","case,","as","discussed","in","Section","1.","We","use","the","well-established","algorithm\n16\n\nGOBNILP","[16],","as","implemented","in","the","eBNSL","package\n1\n[31],","which","attempts","to","find","such","a\nstructure","using","a","linear","programming","approach.\nWe","now","turn","to","the","implementation","ofActiveBNSL.","To","computeN\nt\n,","the","number","of\nrequired","samples","(see","line","3),","we","used","the","formula","given","in","the","bound","in","Lemma","4.1.","To\ncomputeL\nj\n,","the","set","of","possible","equivalence","classes","(see","line","9),","we","used","the","eBNSL","algorithm,\nalso","implemented","in","the","eBNSL","package.","The","input","to","eBNSL","includes","the","score","of","each\nfamily","and","a","positive","real","number\u000f.","The","algorithm","heuristically","attempts","to","output","all\nnetwork","structures","inG\nd,k\nwith","a","score","gap","of","at","most\u000ffrom","the","maximal","achievable\nscore.","To","computeL\nj\n,ActiveBNSLsets","the\u000finput","value","of","eBNSL","toθ\nj\n.","The","list","of\nstructures","provided","as","output","by","eBNSL","is","then","divided","into","equivalence","classes,","using\nthe","characterization","given","in","Theorem","7.6.","To","impose","the","constraint","thatL\nj\nshould","only\ninclude","structures","consistent","with","the","accpeted","families,","as","required","by","the","definition","of\nL\nj\n,ActiveBNSLprovides","eBNSL","with","structural","constraints","as","additional","input.","These\nconstraints","specify","sets","of","edges","that","must","or","must","not","be","included","in","the","output","structures.\nTo","find","a","a","structure","that","maximizes","the","empirical","score,ActiveBNSLuses","GOBNILP,\nproviding","it","with","constraints","that","impose","the","inclusion","of","accepted","families.\nWe","ran","experiments","using","data","generated","from","synthetically","constructed","networks","with\n6-12","nodes,","where","all","nodes","represent","Bernoulli","random","variables","taking","values","in{0,1}.","All\nthe","networks","describe","stable","distributions","of","the","type","presented","in","Section","8,","and","each","of","the\nnetwork","variables","has","at","most","two","parents.","The","nodes","in","a","network","withdnodes,","denoted\nB\nd\n,","are","denoted:X\n1\n,...,X\nd−2\n,X\na\n,X\nb\n.","Figure","1","illustrates","the","graph","structures","forB\n6\nand\nB\n7\n.","In","all","networks,X\n1\nhas","no","parents","and","is","a","Bernoulli(1-ρ)","random","variable,","where\nρ=","0.99.X\n2\nhas","onlyX\n1\nas","a","parent","and","is","equal","toX\n1\nwith","an","independent","probability","of\n1−ρ(otherwise,","it","is","equal","to1−X\n1\n).","Each","of","the","variablesX\ni\nfori∈{3,...,d−2}has\ntwo","parentsX\nj\n,X\nj\n′\nfor","somej,j\n′\n<","i.","The","value","ofX\ni\nisxor(X\nj\n,X\nj\n′\n)with","an","independent\nprobability","ofρ.","In","all","networks,X\na\nis","the","child","ofX\n3\nandX\n4\n,","and","the","value","ofX\na\nis\nxor(X\n3\n,X\n4\n)with","an","independent","probability","ofρ.X\nb\nis","a","slightly","noisy","version","ofX\na\n,","such\nthatX\na\n=X\nb\nwith","an","independent","probability","of1−5·10\n−6\n.","This","construction","satisfies\nthe","conditions","in","Section","8","withX\n1\n:={X\n1\n,...,X\nd−2\n,X\na\n}.","SinceX\nb\nis","almost","always","equal\ntoX\na\n,","it","is","hard","to","distinguish","between","them","using","samples.","In","particular,","the","structure","in\nwhichX\n3\n,X\n4\nare","the","parents","ofX\nb\nand","the","latter","is","the","parent","ofX\na\nhas","a","score","which","is\nvery","close","to","optimal.","The","advantage","of","the","active","algorithm","is","in","being","able","to","focus","on\nobservations","that","distinguish","betweenX\na\nandX\nb\n.\nIn","all","of","the","experiments,","we","setk=","2andδ=","0.05for","both","algorithms.","ForActiveBNSL,\nwe","also","fixed\u000f\n1\n=","","2\n−5\n.","In","each","experiment,","we","fixed","the","input","network","toB\nd\nford∈\n{6,...,12},","and","calculated","a","value","for\u000fas","follows:","Since\u000fis","not","normalized","by","the","number\nof","variablesd,","we","fixed","the","ratior:=d/\u000fand","calculated\u000fbased","on","this","ratio.","We","ran\nexperiments","withr:=","","2\nj\nforj∈","{7,9,11,13,15}.","","Each","experiment","configuration","was\nexecuted10times,","and","we","report","the","average","and","standard","deviation","of","the","results","for\neach","configuration.","In","all","the","experiments,","both","algorithms","found","an\u000f-optimal","structure.\nMoreover,","for","the","naive","algorithm,","all","repeated","experiments","use","the","same","sample","size,","since\nthis","size","is","pre-calculated.\n1\nhttps://github.com/alisterl/eBNSL\n17\n\nX\n1\nX\n2\nX\n3\nX\n4\nX\na\nX\nb\nX\n1\nX\n2\nX\n3\nX\n4\nX\na\nX\nb\nX\n5\nFigure","1:","Illustration","of","the","networksB\n6\nandB\n7\nused","in","the","experiments.\nDetailed","results","of","the","experiments","are","provided","in","Table","1.","The","“sample","ratio”","column\ncalculates","the","average","reduction","in","the","number","of","samples","when","usingActiveBNSLinstead\nof","the","naive","algorithm,","where","a","number","below100%indicates","a","reduction","in","the","number","of\nsamples.","The","last","column","lists","the","percentage","of","families","that","were","accepted","early","in","each\nexperiment.\nIt","can","be","seen","in","Table","1","thatActiveBNSLobtains","a","greater","reduction","for","larger","values\nofr(smaller","values","of\u000f),","and","that","this","advantage","increases","withd.","This","is","also","depicted\nvisually","in","Figure","2,","which","plots","the","sample","sizes","as","a","function","ofdfor","three","values","ofr.","It\ncan","be","seen","that","forr=","2\n9\n,","there","is","no","difference","between","the","required","sample","sizes,","while\nsome","difference","is","observed","forr=","2\n13\n,","and","a","large","difference","is","observed","forr=","2\n15\n.","In","the\nlatter","case,","the","dependence","ondis","also","apparent,","showing","that","larger","values","ofdlead","to","a\nlarger","sample","size","reduction.","In","the","most","favorable","configuration,","whenr=","2\n15\n,","andd=","12,\nActiveBNSLrequires","only","16%","of","the","number","of","samples","required","by","the","naive","algorithm.\nThe","increase","in","sample","size","reduction","when","increasingrcan","be","explained","by","observing\nin","Table","1","that","whenris","small,","only","a","small","percentage","of","the","families","are","accepted","early","by\nActiveBNSL,","leading","to","both","algorithms","requiring","about","the","same","sample","size.","In","general,\nActiveBNSLis","more","successful","when","it","accepts","a","larger","fraction","of","the","families","early.\nTo","summarize,","the","reported","experiments","demonstrate","that","despite","the","computational\nhardness","ofActiveBNSLin","the","general","case,","it","can","be","successfully","implemented","in","practice\nusing","established","approaches,","and","obtain","a","substantial","improvement","in","the","number","of\nrequired","samples.","We","note","that","the","number","of","samples","required","for","both","the","naive","algorithm\nandActiveBNSLis","quite","large","in","our","experiments.","This","is","a","consequence","of","the","specific\nestimator","and","concentration","bounds","that","we","use,","which","may","be","loose","in","some","cases.","We\nexpect","that","this","number","can","be","significantly","reduced","by","using","tighter","concentration","bounds\ntailored","to","this","task.","We","leave","this","challenge","for","future","work.\n18\n\nrd\u000f≡d/r","","","NnaiveNactivesample","ratio%","accepted\n(active/naive)families\n2\n7\n6","","","0.046882.25×10\n10\n2.45±0.00×10\n10\n109.2%±0.00%0.00%±0.00%\n7","","","0.054694.16×10\n10\n4.41±0.44×10\n10\n106.07%±10.59%","","1.43%±4.52%\n8","","","0.0625","","","6.97×10\n10\n6.81±1.07×10\n10\n97.64%±15.32%","","","5.00%±6.45%\n9","","","0.07031","","1.09×10\n11\n9.60±1.22×10\n10\n88.26%±11.21%","","","8.89%±4.68%\n10","","0.07812","","1.61×10\n11\n1.61±0.20×10\n11\n99.87%±12.43%","","","4.00%±5.16%\n11","","0.08594","","2.28×10\n11\n2.19±0.26×10\n11\n96.27%±11.36%","","","5.45%±4.69%\n12","","0.093753.12×10\n11\n3.16±0.33×10\n11\n101.31%±10.45%","","3.33%±4.30%\n2\n9\n6","","","0.011725.01×10\n11\n5.78±0.00×10\n11\n115.35%±0.00%","","","0.00%±0.00%\n7","","","0.013679.26×10\n11\n9.39±1.66×10\n11\n101.38%±17.92%","","5.71%±7.38%\n8","","","0.01562","","1.55×10\n12\n1.50±0.25×10\n12\n96.72%±15.83%","","","7.50%±6.45%\n9","","","0.01758","","2.42×10\n12\n2.38±0.34×10\n12\n98.47%±14.16%","","","6.67%±5.74%\n10","","0.01953","","3.57×10\n12\n3.57±0.46×10\n12\n99.86%±12.81%","","","6.00%±5.16%\n11","","0.02148","","5.06×10\n12\n4.90±0.70×10\n12\n96.73%±13.74%","","","7.27%±5.75%\n12","","0.023446.93×10\n12\n6.95±1.13×10\n12\n100.28%±16.32%","","5.83%±6.86%\n2\n11\n6","","","0.002931.06×10\n13\n1.27±0.00×10\n13\n119.26%±0.00%","","","0.00%±0.00%\n7","","","0.003421.97×10\n13\n2.06±0.36×10\n13\n104.82%±18.27%","","5.71%±7.38%\n8","","","0.00391","","3.29×10\n13\n3.00±0.55×10\n13\n91.09%±16.64%","","","11.25%±7.10%\n9","","","0.00439","","5.13×10\n13\n3.68±0.74×10\n13\n71.78%±14.34%","","","20.00%±7.03%\n10","","0.004887.58×10\n13\n7.99±1.01×10\n13\n105.46%±13.28%","","5.00%±5.27%\n11","","0.00537","","1.07×10\n14\n9.58±1.89×10\n13\n89.29%±17.63%","","","11.82%±7.48%\n12","","0.00586","","1.47×10\n14\n1.40±0.22×10\n14\n95.01%±14.65%","","","9.17%±6.15%\n2\n13\n6","","","0.00073","","2.19×10\n14\n2.04±0.44×10\n14\n93.14%±19.98%","","","11.67%±8.05%\n7","","","0.00085","","4.04×10\n14\n2.05±0.51×10\n14\n50.72%±12.72%","","","34.29%±12.05%\n8","","","0.00098","","6.75×10\n14\n4.35±3.30×10\n14\n64.44%±48.88%","","","30.00%±25.82%\n9","","","0.0011","","","1.05×10\n15\n3.93±2.48×10\n14\n37.37%±23.54%","","","52.22%±20.32%\n10","","0.00122","","1.55×10\n15\n1.06±0.52×10\n15\n68.57%±33.62%","","","24.00%±16.47%\n11","","0.00134","","2.20×10\n15\n1.17±0.38×10\n15\n53.27%±17.32%","","","30.91%±9.77%\n12","","0.00146","","3.01×10\n15\n2.57±0.48×10\n15\n85.63%±15.85%","","","14.17%±6.86%\n2\n15\n6","","","0.00018","","4.36×10\n15\n3.78±0.58×10\n15\n86.68%±13.22%","","","15.00%±5.27%\n7","","","0.00021","","8.05×10\n15\n3.34±1.73×10\n15\n41.45%±21.54%","","","40.00%±14.75%\n8","","","0.00024","","1.35×10\n16\n7.62±2.30×10\n15\n56.59%±17.05%","","","30.00%±10.54%\n9","","","0.00027","","2.10×10\n16\n4.30±2.15×10\n15\n20.51%±10.26%","","","54.44%±9.73%\n10","","0.00031","","3.10×10\n16\n7.29±3.83×10\n15\n23.53%±12.37%","","","52.00%±10.33%\n11","","0.00034","","4.38×10\n16\n1.45±0.60×10\n16\n33.18%±13.76%","","","44.55%±10.00%\n12","","0.00037","","5.99×10\n16\n9.84±3.67×10\n15\n16.43%±6.13%58.33%±7.86%\nTable","1:","Experiment","results.Nstands","for","the","number","of","samples","used","by","each","algorithm.\n“%","accepted","families”","is","the","fraction","of","the","families","thatActiveBNSLaccepted","before","the\nlast","stage.\n19\n\n","0\n","1×10\n12\n","2×10\n12\n","3×10\n12\n","4×10\n12\n","5×10\n12\n","6×10\n12\n","7×10\n12\n","8×10\n12\n","9×10\n12\n","6","7","8","9","10","11","12\nN\nd\nr","=","2\n9\nActiveBNSL\nnaive\n","0\n","5×10\n14\n","1×10\n15\n","1.5×10\n15\n","2×10\n15\n","2.5×10\n15\n","3×10\n15\n","3.5×10\n15\n","6","7","8","9","10","11","12\nN\nd\nr","=","2\n13\nActiveBNSL\nnaive\n","0\n","1×10\n16\n","2×10\n16\n","3×10\n16\n","4×10\n16\n","5×10\n16\n","6×10\n16\n","6","7","8","9","10","11","12\nN\nd\nr","=","2\n15\nActiveBNSL\nnaive\nFigure","2:","Number","of","samples","taken","byActiveBNSL(active)","and","the","naive","algorithm,N,","as\na","function","ofd,","the","number","of","nodes","in","the","network,","for","three","values","ofr.\n20\n\n10","","Discussion\nThis","is","the","first","work","to","study","active","structure","learning","for","Bayesian","networks","in","an\nobservational","setting.","","The","proposed","algorithm,ActiveBNSL,","can","have","a","significantly\nimproved","sample","complexity","in","applicable","cases,","and","incurs","a","negligible","sample","complexity\npenalty","in","other","cases.","We","characterized","a","family","of","distributions","in","whichActiveBNSL\ncan","obtain","a","significant","sample","complexity","reduction,","and","demonstrated","the","reduction","in\nexperiments.","A","full","characterization","of","distributions","in","which","a","sample","complexity","reduction\nis","possible","is","an","interesting","open","problem","for","future","work.\nReferences\n[1]\nSteen","A","Andersson,","David","Madigan,","and","Michael","D","Perlman.","A","characterization","of\nMarkov","equivalence","classes","for","acyclic","digraphs.The","Annals","of","Statistics,","25:505–541,\n1997.\n[2]\nAndrás","Antos","and","Ioannis","Kontoyiannis.","Convergence","properties","of","functional","estimates\nfor","discrete","distributions.Random","Structures","&","Algorithms,","19:163–193,","2001.\n[3]Pranjal","Awasthi,","Maria","Florina","Balcan,","and","Konstantin","Voevodski.","Local","algorithms\nfor","interactive","clustering.The","Journal","of","Machine","Learning","Research,","18:75–109,","2017.\n[4]Mark","Bartlett","and","James","Cussens.","Advances","in","Bayesian","network","learning","using","integer\nprogramming.","Inthe","Twenty","Ninth","Conference","on","Uncertainty","in","Artificial","Intelligence,\npages","181–191,","2013.\n[5]Mark","Bartlett","and","James","Cussens.","Integer","linear","programming","for","the","Bayesian","network\nstructure","learning","problem.Artificial","Intelligence,","244:258–271,","2017.\n[6]Shai","Ben-David","and","Eli","Dichterman.","Learning","with","restricted","focus","of","attention.Journal\nof","Computer","and","System","Sciences,","56(3):277–298,","1998.\n[7]Remco","Ronaldus","Bouckaert.Bayesian","belief","networks:","from","construction","to","inference.\nPhD","thesis,","Utrecht","University,","1995.\n[8]\nWray","Buntine.","Theory","refinement","on","Bayesian","networks.","InProceedings","of","the","Seventh\nconference","on","Uncertainty","in","Artificial","Intelligence,","pages","52–60,","1991.\n[9]Baoping","Cai,","Lei","Huang,","and","Min","Xie.","Bayesian","networks","in","fault","diagnosis.IEEE\nTransactions","on","Industrial","Informatics,","13:2227–2240,","2017.\n[10]\nBaoping","Cai,","Xiangdi","Kong,","Yonghong","Liu,","Jing","Lin,","Xiaobing","Yuan,","Hongqi","Xu,","and\nRenjie","Ji.","Application","of","Bayesian","networks","in","reliability","evaluation.IEEE","Transactions\non","Industrial","Informatics,","15:2146–2157,","2019.\n[11]Cassio","P","de","Campos","and","Qiang","Ji.","Efficient","structure","learning","of","Bayesian","networks\nusing","constraints.Journal","of","Machine","Learning","Research,","12:663–689,","2011.\n21\n\n[12]Nicolo","Cesa-Bianchi,","Shai","Shalev-Shwartz,","and","Ohad","Shamir.","Efficient","learning","with\npartially","observed","attributes.Journal","of","Machine","Learning","Research,","12(10):2857–2878,\n2011.\n[13]David","Maxwell","Chickering.","Learning","Bayesian","networks","is","NP-complete.","InLearning\nfrom","data,","pages","121–130.","Springer,","1996.\n[14]\nDavid","Maxwell","Chickering.","Optimal","structure","identification","with","greedy","search.Journal\nof","Machine","Learning","Research,","3(11):507–554,","2002.\n[15]Gregory","F","Cooper","and","Edward","Herskovits.","A","Bayesian","method","for","the","induction","of\nprobabilistic","networks","from","data.Machine","Learning,","9(4):309–347,","1992.\n[16]James","Cussens.","Bayesian","network","learning","with","cutting","planes.","Inthe","Tweny","Seventh\nConference","on","Uncertainty","in","Artificial","Intelligence,","pages","153–160,","2011.\n[17]\nGautamd","Dasarathy,","Aarti","Singh,","Maria-Florina","Balcan,","and","Jong","H","Park.","Active\nlearning","algorithms","for","graphical","model","selection.","InArtificial","Intelligence","and","Statistics,\npages","1356–1364,","2016.\n[18]Nir","Friedman,","Michal","Linial,","Iftach","Nachman,","and","Dana","Pe’er.","Using","Bayesian","networks\nto","analyze","expression","data.Journal","of","Computational","Biology,","7(3-4):601–620,","2000.\n[19]Peter","Haddawy,","AHM","Imrul","Hasan,","Rangwan","Kasantikul,","Saranath","Lawpoolsri,","Patiwat\nSa-angchai,","Jaranit","Kaewkungwal,","and","Pratap","Singhasivanon.","Spatiotemporal","Bayesian\nnetworks","for","malaria","prediction.Artificial","Intelligence","in","Medicine,","84:127–138,","2018.\n[20]Jarvis","Haupt,","Rui","Castro,","and","Robert","Nowak.","Distilled","sensing:","Selective","sampling","for\nsparse","signal","recovery.","InArtificial","Intelligence","and","Statistics,","pages","216–223,","2009.\n[21]\nElad","Hazan","and","Tomer","Koren.","Linear","regression","with","limited","observation.","InProceedings\nof","the","Twenty","Ninth","International","Conference","on","Machine","Learning,","pages","1865–1872.\nOmnipress,","2012.\n[22]Yang-Bo","He","and","Zhi","Geng.","","Active","learning","of","causal","networks","with","intervention\nexperiments","and","optimal","designs.Journal","of","Machine","Learning","Research,","9:2523–2547,\n2008.\n[23]David","Heckerman.","A","tutorial","on","learning","with","Bayesian","networks.","InLearning","in\nGraphical","Models,","pages","301–354.","Springer,","1998.\n[24]David","Heckerman,","Dan","Geiger,","and","David","M","Chickering.","Learning","Bayesian","networks:\nThe","combination","of","knowledge","and","statistical","data.Machine","Learning,","20(3):197–243,\n1995.\n[25]David","Heckerman,","Christopher","Meek,","and","Gregory","Cooper.","A","Bayesian","approach","to\ncausal","discovery.","InInnovations","in","Machine","Learning,","pages","1–28.","Springer,","2006.\n[26]\nHengyi","Hu","and","Larry","Kerschberg.","Evolving","medical","ontologies","based","on","causal","inference.\nIn2018","IEEE/ACM","International","Conference","on","Advances","in","Social","Networks","Analysis\nand","Mining,","pages","954–957,","2018.\n22\n\n[27]Daphne","Koller","and","Nir","Friedman.Probabilistic","Graphical","Models:","Principles","and\nTechniques.","MIT","press,","2009.\n[28]Doron","Kukliansky","and","Ohad","Shamir.","","Attribute","efficient","linear","regression","with\ndistribution-dependent","sampling.","InInternational","Conference","on","Machine","Learning,\npages","153–161,","2015.\n[29]Guoliang","Li","and","Tze-Yun","Leong.","Active","learning","for","causal","Bayesian","network","structure\nwith","non-symmetrical","entropy.","InPacific-Asia","Conference","on","Knowledge","Discovery","and\nData","Mining,","pages","290–301,","2009.\n[30]Yifeng","Li,","Haifen","Chen,","Jie","Zheng,","and","Alioune","Ngom.","","The","max-min","high-order\ndynamic","Bayesian","network","for","learning","gene","regulatory","networks","with","time-delayed\nregulations.IEEE/ACM","Transactions","on","Computational","Biology","and","Bioinformatics,\n13:792–803,","2016.\n[31]","Zhenyu","A","Liao,","Charupriya","Sharma,","James","Cussens,","and","Peter","van","Beek.","Finding","all\nBayesian","network","structures","within","a","factor","of","optimal.","InProceedings","of","the","AAAI\nConference","on","Artificial","Intelligence,","volume","33,","pages","7892–7899,","2019.\n[32]Li","Liu,","Shu","Wang,","Bin","Hu,","Qingyu","Qiong,","Junhao","Wen,","and","David","S","Rosenblum.\nLearning","structures","of","interval-based","Bayesian","networks","in","probabilistic","generative\nmodel","for","human","complex","activity","recognition.Pattern","Recognition,","81:545–561,","2018.\n[33]Matthew","L","Malloy","and","Robert","D","Nowak.","Near-optimal","adaptive","compressed","sensing.\nIEEE","Transactions","on","Information","Theory,","60:4001–4012,","2014.\n[34]\nSimone","Marini,","Emanuele","Trifoglio,","Nicola","Barbarini,","Francesco","Sambo,","Barbara\nDi","Camillo,","Alberto","Malovini,","Marco","Manfrini,","Claudio","Cobelli,","and","Riccardo","Bellazzi.\nA","dynamic","Bayesian","network","model","for","long-term","simulation","of","clinical","complications\nin","type","1","diabetes.Journal","of","Biomedical","Informatics,","57:369–376,","2015.\n[35]\nColin","McDiarmid.","On","the","method","of","bounded","differences.Surveys","in","Combinatorics,\n141:148–188,","1989.\n[36]Christopher","Meek.","Causal","inference","and","causal","explanation","with","background","knowledge.\nInProceedings","of","the","Eleventh","Conference","on","Uncertainty","in","Artificial","Intelligence,\npages","403–410,","1995.\n[37]Liam","Paninski.","Estimation","of","entropy","and","mutual","information.Neural","Computation,\n15:1191–1253,","2003.\n[38]Andrea","Rovinelli,","Michael","D","Sangid,","Henry","Proudhon,","Yoann","Guilhem,","Ricardo","A\nLebensohn,","and","Wolfgang","Ludwig.","Predicting","the","3d","fatigue","crack","growth","rate","of","small\ncracks","using","multimodal","data","via","Bayesian","networks:","In-situ","experiments","and","crystal\nplasticity","simulations.Journal","of","the","Mechanics","and","Physics","of","Solids,","115:208–229,\n2018.\n[39]Ohad","Shamir,","Sivan","Sabato,","and","Naftali","Tishby.","Learning","and","generalization","with","the\ninformation","bottleneck.Theoretical","Computer","Science,","411(29-30):2696–2711,","2010.\n23\n\n[40]Tomi","Silander","and","Petri","Myllymäki.","A","simple","approach","for","finding","the","globally","optimal\nBayesian","network","structure.arXiv","preprint","arXiv:1206.6875,","2012.\n[41]Daniel","Soudry,","Suraj","Keshri,","Patrick","Stinson,","Min-hwan","Oh,","Garud","Iyengar,","and\nLiam","Paninski.","A","shotgun","sampling","solution","for","the","common","input","problem","in","neural\nconnectivity","inference.arXiv","preprint","arXiv:1309.3724,","2013.\n[42]Peter","Spirtes,","Clark","N","Glymour,","Richard","Scheines,","David","Heckerman,","Christopher\nMeek,","Gregory","Cooper,","and","Thomas","Richardson.Causation,","Prediction,","and","Search.\nMIT","press,","2000.\n[43]\nChandler","Squires,","Sara","Magliacane,","Kristjan","Greenewald,","Dmitriy","Katz,","Murat","Ko-\ncaoglu,","and","Karthikeyan","Shanmugam.","Active","structure","learning","of","causal","DAGs","via\ndirected","clique","trees.Advances","in","Neural","Information","Processing","Systems,","33,","2020.\n[44]Simon","Tong","and","Daphne","Koller.","Active","learning","for","structure","in","Bayesian","networks.\nInInternational","Joint","Conference","on","Artificial","Intelligence,","volume","17,","pages","863–869,\n2001.\n[45]Ioannis","Tsamardinos,","Laura","E","Brown,","and","Constantin","F","Aliferis.","The","max-min","hill-\nclimbing","Bayesian","network","structure","learning","algorithm.Machine","Learning,","65(1):31–78,\n2006.\n[46]Srini","Turaga,","Lars","Buesing,","Adam","M","Packer,","Henry","Dalgleish,","Noah","Pettit,","Michael\nHausser,","and","Jakob","H","Macke.","Inferring","neural","population","dynamics","from","multiple\npartial","recordings","of","the","same","neural","circuit.","","InAdvances","in","Neural","Information\nProcessing","Systems,","pages","539–547,","2013.\n[47]Divyanshu","Vats,","Robert","Nowak,","and","Richard","Baraniuk.","Active","learning","for","undirected\ngraphical","model","selection.","InArtificial","Intelligence","and","Statistics,","pages","958–967,","2014.\n[48]Thomas","Verma","and","Judea","Pearl.Equivalence","and","Synthesis","of","Causal","Models.","UCLA,\nComputer","Science","Department,","1991.\n[49]\nAnnemieke","Witteveen,","Gabriela","F","Nane,","Ingrid","MH","Vliegen,","Sabine","Siesling,","and\nMaarten","J","IJzerman.","Comparison","of","logistic","regression","and","Bayesian","networks","for","risk\nprediction","of","breast","cancer","recurrence.Medical","Decision","Making,","38(7):822–833,","2018.\n[50]Selene","Xu,","Wesley","Thompson,","Sonia","Ancoli-Israel,","Lianqi","Liu,","Barton","Palmer,","and","Loki\nNatarajan.","Cognition,","quality-of-life,","and","symptom","clusters","in","breast","cancer:","Using\nBayesian","networks","to","elucidate","complex","relationships.Psycho-oncology,","27(3):802–809,\n2018.\n24\n\nA","","Convergence","of","the","conditional","entropy","plug-in","estimator\nIn","this","section,","we","prove","Lemma","4.1,","which","gives","a","bound","on","the","number","of","random","samples\nrequired","to","estimate","the","conditional","entropy","of","a","discrete","random","variable.","We","first","bound\nthe","bias","of","the","conditional-entropy","plug-in","estimator.","[37]","showed","that","the","bias","of","the\nunconditional","entropy","estimator,","for","any","random","variableAwith","support","sizeM\na\n,","satisfies\n−\nM\na\n−1\nN\n<E[\nˆ\nH(A)]−E[H(A)]<0.(8)\nThe","following","lemma","derives","an","analog","result","for","the","conditional","entropy.\nLemma","A.1.LetA,Bbe","discrete","random","variables","with","support","cardinalitiesM\na\nandM\nb\n,\nrespectively.","Let\nˆ\nH(A|B)be","the","plug-in","estimator","ofH(A|B),","based","onNi.i.d.","copies","of\n(A,B).","Then\n−\n(M\na\n−1)M\nb\nN\n≤E[\nˆ\nH(A|B)]−H(A|B)≤0.\nProof.\nLetBbe","the","support","ofB.","For","anyb∈B,","denotep\nb\n:=P(B=b)and","letN\nb\nbe","the\nnumber","of","examples","in","the","sample","withB=b.","We","have\nE[\nˆ\nH(A|B)]","=\n∑\nb∈B\nE\n[\nN\nb\nN\nˆ\nH(A|B=b)\n]\n.(9)\nBounding","a","single","term","in","the","sum,","we","have\nE\n[\nN\nb\nN\n·\nˆ\nH(A|B=b)\n]\n=\n∑\nn∈[N]\nn\nN\n·P(N\nb\n=n)·E[\nˆ\nH(A|B=b)\n∣\n∣\nN\nb\n=n]\n≥\n∑\nn∈[N]\nn\nN\n·P(N\nb\n=n)·(H(A|B=b)−(M\na\n−1)/n),(10)\n=p\nb\n·H(A|B=b)−(M\na\n−1)/N,\nwhere","the","inequality","on","line","(10)","follows","from","Eq.","(8),","and","the","last","equality","follows","since\n∑\nn∈[N]\nn\nN\nP(N\nb\n=n)","=E[N\nb\n/N]","=p\nb\n,\nand\n∑\nn∈[N]\nn\nN\nP(N\nb\n=n)(M\na\n−1)/n=","(M\na\n−1)/N.\nPlugging","this","into","Eq.","(9),","we","get\nE[\nˆ\nH(A|B)]","=\n∑\nb∈B\nE\n[\nN\nb\nN\n·\nˆ\nH(A|B=b)\n]\n≥\n∑\nb∈B\n(p\nb\n·H(A|B=b)−(M\na\n−1)/N)\n=H(A|B)−(M\na\n−1)M\nb\n/N.\nProving","that","the","bias","is","non-positive","is","done","in","a","similar","way.","This","completes","the","proof.\n25\n\nWe","now","use","the","lemma","above","to","prove","Lemma","4.1.\nProof","of","Lemma","4.1.By","McDiarmid’s","inequality","[35],","if","the","maximal","absolute","change","that\na","single","random","sample","can","induce","on","the","plug-in","estimator","isθ,","then\nP(|\nˆ\nH(A|B)−E[\nˆ\nH(A|B)]|>","\u000f)≤2","exp(−2\u000f\n2\n/(Nθ\n2\n)).\nLetBbe","the","support","ofB.","For","anyb∈B,","denotep\nb\n:=P(B=b)and","letˆp\nb\nbe","the","empirical\nfraction","of","samples","withB=b.","We","have\nˆ\nH(A|B)","=\n∑\nb∈B\nˆp\nb\n·\nˆ\nH(A|B=b),\nwhereBis","the","support","ofBand","By","[39],","the","maximal","change","that","can","be","induced","on\nˆ\nH(A|B=b)when","replacing","an","example(a,b)in","the","sample","with","an","example(a\n′\n,b)\nislog(ˆp\nb\nN)/(ˆp\nb\nN).","","Therefore,","this","type","of","replacement","induces","a","change","of","at","most\nlog(ˆp\nb\nN)/N≤log(N)/Non\nˆ\nH(A|B).","","Now,","if","an","example(a,b)is","replaced","with","an\nexample(a\n′\n,b\n′\n),","whereb6=b\n′\n,","then","the","maximal","change","it","induces","on\nˆ\nH(A|B)islog(M\na\n)/N,\nsince","for","anyb,\nˆ\nH(A|B=b)∈[0,log(M\na\n)].","Therefore,","ifN≥M\na\n,","both","types","of","sample\nreplacements","induce","a","change","of","at","mostlog(N)/Non\nˆ\nH(A|B).","It","follows","that\nP(|\nˆ\nH(A|B)−E[\nˆ\nH(A|B)]|>","\u000f)≤2","exp(−\nN\u000f\n2\n2","log\n2\n(N)\n).(11)\nInterestingly,","this","is","the","same","as","the","bound","for","the","unconditional","entropy","given","in","[2].","From\nLemma","A.1","and","Eq.","(11),","it","follows","that","If\u000f≥(M\na\n−1)M\nb\n/N,","then\nP(|\nˆ\nH(A|B)−H(A|B)|>2\u000f)≤2","exp(−\nN\u000f\n2\n2","log\n2\n(N)\n).(12)\nLastly,","we","derive","a","lower","bound","forNsuch","that","the","RHS","is","at","mostδ.","Letα≥1and","assume\nN≥e\n2\n.","We","start","by","showing","that","ifN≥αlog\n2\n(α),","thenN/log\n2\n(N)≥α/4.N/log\n2\n(N)is\nmonotonic","increasing","forN≥e\n2\n.","Therefore,","forN≥αlog\n2\n(α),\nN\nlog\n2\n(N)\n≥\nαlog\n2\n(α)\nlog\n2\n(αlog\n2\n(α))\n=\nαlog\n2\n(α)\n(log(α)","+","log(log\n2\n(α)))\n2\nSinceα≥1,","we","havelog\n2\n(α)≤α.","It","follows","thatlog(log\n2\n(α))≤log(α).","Therefore,\n(log(α)","+","log(log\n2\n(α)))\n2\n≤(log(α)","+","log(α))\n2\n=","4","log\n2\n(α).\nWe","conclude","that","forN≥αlog\n2\n(α),N/log\n2\n(N)≥α/4.Settingα:=","8log(2/δ)/\u000f\n2\n,","we\nobtain","that","ifN≥αlog\n2\nα,","thenN/log\n2\n(N)≥2log(2/δ)/\u000f\n2\n,","which","implies","that","the","RHS\nof","Eq.","(12)","is","at","mostδ.\n26\n\nB","","Proofs","for","technical","lemmas","in","Section","8\nIn","this","section,","we","provide","the","proofs","of","technical","lemmas","stated","in","Section","8.\nof","Lemma","8.3.To","prove","Eq.","(6),","note","that\nH(X\na\n,X\nb\n|Π)","=H(X\na\n,X\nb\n,Π)−H(Π)","=H(X\nb\n|X\na\n,Π)","+H(X\na\n,Π)−H(Π)\n=H(X\nb\n|X\na\n)","+H(X\na\n|Π).\nThe","last","equality","follows","since","by","assumption","(IV),Π→X\na\n→X\nb\nis","a","Markov","chain,","so\nthatH(X\nb\n|X\na\n,Π)","=H(X\nb\n|X\na\n).","From","the","above","it","we","have\nH(X\na\n|Π)","=H(X\na\n,X\nb\n|Π)−H(X\nb\n|X\na\n).\nIt","follows","that\n|H(X\nb\n|Π)−H(X\na\n|Π)|=|H(X\nb\n|Π)−H(X\na\n,X\nb\n|Π)","+H(X\nb\n|X\na\n)|\n=|H(X\nb\n,Π)−H(X\na\n,X\nb\n,Π)","+H(X\nb\n|X\na\n)|\n=|H(X\nb\n|X\na\n)−H(X\na\n|X\nb\n,Π)|\n≤max(H(X\nb\n|X\na\n),H(X\na\n|X\nb\n,Π))\n≤max(H(X\nb\n|X\na\n),H(X\na\n|X\nb\n))≤λ.\nThe","last","inequality","follows","from","the","definition","ofλ.","This","proves","Eq.","(6).\nTo","prove","Eq.","(7),","note","that\nH(Y,X\nb\n|Π,X\na\n)","=H(Y,X\nb\n,Π,X\na\n)−H(Π,X\na\n)\n=H(X\nb\n|Π,Y,X\na\n)","+H(Π,Y,X\na\n)−H(Π,X\na\n)\n=H(X\nb\n|X\na\n)","+H(Y|Π,X\na\n),\nwhere","the","last","equality","follows","since","by","assumption","(IV),(Y,Π)→X\na\n→X\nb\nis","a","Markov\nchain,","so","thatH(X\nb\n|Π,Y,X\na\n)","=H(X\nb\n|X\na\n).","The","equality","above","implies","that\nH(Y|Π,X\na\n)","=H(Y,X\nb\n|Π,X\na\n)−H(X\nb\n|X\na\n).\nIt","follows","that\n|H(Y|Π,X\nb\n)−H(Y|Π,X\na\n)|\n=|H(Y,Π,X\nb\n)−H(Π,X\nb\n)−H(Y,X\nb\n|Π,X\na\n)","+H(X\nb\n|X\na\n)|\n=|H(Y,Π,X\nb\n)−H(Π,X\nb\n)−H(Y,X\nb\n,Π,X\na\n)","+H(Π,X\na\n)","+H(X\nb\n|X\na\n)|\n=|−H(X\na\n|Y,Π,X\nb\n)−H(X\nb\n|Π)","+H(X\na\n|Π)","+H(X\nb\n|X\na\n)|\n≤H(X\na\n|Y,Π,X\nb\n)","+|H(X\nb\n|Π)−H(X\na\n|Π)|+H(X\nb\n|X\na\n)\n≤H(X\na\n|X\nb\n)","+|H(X\nb\n|Π)−H(X\na\n|Π)|+H(X\nb\n|X\na\n)≤3λ.\nThe","last","inequality","follows","from","Eq.","(6)","and","the","definition","ofλ.","This","proves","Eq.","(7).\n27\n\nof","Lemma","8.4.IfX\nb\nhas","no","children","inG,","then","set\n","̃\nG:=G.","It","is","easy","to","see","that","in","this\ncase,\n","̃\nGsatisfies","all","the","required","properties.\nOtherwise,","denote","the","set","of","children","ofX\nb\ninGbyW.","Denote","byΠ\nb\n,Π\na\nthe","parent","sets","of\nX\nb\n,X\na\ninG,","respectively,","and","byΠ\nw\nthe","parents","ofX\nw\n∈W.","Denote","byf\nv\n:=〈X\nv\n,Π\nv\n〉∈G\nthe","family","ofX\nv\ninG.","We","construct\n","̃\nG\nfromGby","replacing","the","familiesf\nv\n,","forX\na\n,X\nb\nand\nallX\nw\n∈W,","by","new","families\n","̃\nf\nv\n:=〈X\nv\n,\n","̃\nΠ\nv\n〉,","as","follows.","First,","define\n","̃\nΠ\na\nand\n","̃\nΠ\nb\n:\n1.","IfX\nb\nhas","no","directed","path","toX\na\n,","define\n","̃\nΠ\na\n:=","Π\na\nand\n","̃\nΠ\nb\n:=","Π\nb\n.\n2.Otherwise","(X\nb\nhas","a","directed","path","toX\na\n),","ifX\nb\nis","a","parent","ofX\na\n,","makeX\na\na","parent\nofX\nb\ninstead.","In","any","case,","switch","between","the","other","parents","ofX\na\nandX\nb\n.\nFormally,","set\n","̃\nΠ\na\n=","Π\nb\n.","IfX\nb\n∈Π\na\n,\n","̃\nΠ\nb\n:=","Π\na\n\\{X\nb\n}∪{X\na\n}.","Otherwise,\n","̃\nΠ\nb\n:=","Π\na\n.\nNext,","for","eachw∈W\\{X\na\n},","makeX\na\na","parent","ofwinstead","ofX\nb\n.","Formally,\n","̃\nΠ\nw\n:=\nΠ\nw\n\\{X\nb\n}∪{X\na\n}.","This","completes","the","definition","of\n","̃\nG.\nIt","is","easy","to","see","that","the","maximal","in-degree","of\n","̃\nG\nis","at","most","that","ofG,","which","is","at","most\nk,","as","required.","We","now","show","that\n","̃\nGis","a","DAG,","thus","proving","that\n","̃\nG∈G\nk,d\n.\nClaim:\n","̃\nGis","a","DAG.\nProof","of","claim:\nConsider","first","the","case","whereX\nb\ndoes","not","have","a","directed","path","toX\na\n.\nLet(A,B)be","an","edge","in\n","̃\nGthat","is","not","inG.","ThenB∈WandA=X\na\n.","InG,","there","is","no\ndirected","path","fromBtoX\na\n,","sinceBis","a","child","ofX\nb\nand","this","would","create","a","directed","path\nfromX\nb\ntoX\na\n.","But","all","paths","fromBin\n","̃\nGare","the","same","as","inG.","Thus,","there","is","no","cycle","in\n","̃\nG.\nNow,","consider","the","case","whereX\nb\nhas","a","directed","path","toX\na\n.","Let(A,B)be","an","edge","in\n","̃\nG\nthat","is","not","inG.","We","will","show","that","it","does","not","create","a","cycle","in\n","̃\nG.","Divide","into","cases:\n1.","IfB=X\nb\n,","then(A,B)is","not","an","edge","in","a","cycle","in\n","̃\nG,","sinceX\nb\nhas","no","children","in\n","̃\nG.\n2.IfB∈W,","thenA=X\na\n,","sinceX\na\nis","the","only","parent","added","toW.","Thus,(A,B)is","part\nof","a","cycle","in\n","̃\nGonly","ifBis","an","ancestor","ofX\na\nin\n","̃\nG.","Assume","in","contradiction","that","this\nis","the","case,","and","letv\n1\n,...,v\nl\nbe","the","nodes","in","a","shortest","directed","path","fromBtoX\na\n.\nv\nl\nis","a","parent","ofX\na\nin\n","̃\nG,","thus","it","is","a","parent","ofX\nb\ninG.","The","nodesv\n1\n,...,v\nl\ncannot\nbeX\na\norX\nb\n(because","it","has","no","children","in\n","̃\nG),","thus","their","parents","are","the","same","inG\nand\n","̃\nG.","It","follows","that","the","directed","pathB,v\n1\n,...,v\nl\n,X\nb\nexists","inG.","However,Bis\na","child","ofX\nb\ninG,","thus","this","implies","a","cycle","inG,","a","contradiction.","Therefore,","in","this\ncase(A,B)is","not","part","of","a","cycle.\n3.\nIfB=X\na\n,","thenA∈Π\nb\n.","Thus,(A,B)is","part","of","a","cycle","if","there","is","a","directed","path","from\nX\na\ntoAin\n","̃\nG\n.","Assume","in","contradiction","that","this","is","the","case,","and","letv\n1\n,...,v\nl\nbe","the\nnodes","in","a","shortest","directed","path","fromX\na\ntoAin\n","̃\nG.","The","nodesv\n2\n,...,v\nl\nand","their\nparents","cannot","beX\na\norX\nb\n,","thus","their","parents","are","the","same","inGand\n","̃\nG.","It","follows\nthat","the","directed","pathv\n1\n,v\n2\n,...,v\nl\n,Aexists","inG.","Now,","ifv\n1\nis","a","child","ofX\nb\ninG,\nthis","means","that","there","is","a","directed","path","inGfromX\nb\nto","its","parentA,","which","means\nthat","there","is","a","cycle","inG.","Ifv\n1\nis","a","child","ofX\na\ninG,","then,","sinceX\nb\nhas","a","directed\npath","toX\na\ninG,","this","again","means","that","there","is","a","path","fromX\nb\ntoAinG,","leading","to\na","cycle","inG.","In","both","cases,","this","contradicts","the","fact","thatGis","a","DAG.","Thus,","in","this\ncase","as","well,(A,B)is","not","part","of","a","cycle.\n28\n\nTherefore,","in","this","case","as","well,\n","̃\nGis","a","DAG.","This","completes","the","proof","of","the","claim.2\nTo","show","that\n","̃\nG\nsatisfies","the","properties","stated","in","the","lemma,","observe","first","that","properties\n(2)","and","(3)","are","immediate","from","the","construction","of\n","̃\nG.","Property","(1)","requires","a","bound","on","the\ndifference","in","scores","ofGand\n","̃\nG.","We","have\n|S(G)−S(\n","̃\nG)|≤\n∑\nw∈W\\{X\na\n}\n|H(f\nw\n)−H(\n","̃\nf\nw\n)|+|H(f\na\n)−H(\n","̃\nf\na\n)","+H(f\nb\n)−H(\n","̃\nf\nb\n)|.\nTo","bound","the","first","term,","letΠ\n′\nb\n:=","Π\nw\n\\{X\nb\n}.","Then\n|H(f\nw\n)−H(\n","̃\nf\nw\n)|=|H(w|Π\n′\nb\n,X\nb\n)−H(w|Π\n′\nb\n,X\na\n)|≤3λ,\nwhere","the","last","inequality","follows","from","Eq.","(7).","Since","there","are","at","mostd−2such","terms,","the\nfirst","term","is","at","most3(d−2)λ.\nTo","bound","the","second","term,","first","note","that","it","is","equal","to","zero","ifX\nb\nhas","no","directed","path\ntoX\na\ninG.","IfX\nb\ndoes","have","a","directed","path","toX\na\ninG,","then","letΠ\n′\na\n:=","Π\na\n\\{X\nb\n}.","IfX\nb\nis\nnot","a","direct","parent","ofX\na\n,","then\n|H(f\nb\n)−H(\n","̃\nf\nb\n)","+H(f\na\n)−H(\n","̃\nf\na\n)|\n=|H(X\na\n|Π\n′\na\n)","+H(X\nb\n|Π\nb\n)−H(X\na\n|Π\nb\n)−H(X\nb\n|Π\n′\na\n)|=:","∆.\nIfX\nb\nis","a","direct","parent","ofX\na\n,","then\n|H(f\na\n)−H(\n","̃\nf\na\n)","+H(f\nb\n)−H(\n","̃\nf\nb\n)|\n=|H(X\na\n|Π\n′\na\n,X\nb\n)","+H(X\nb\n|Π\nb\n)−H(X\na\n|Π\nb\n)−H(X\nb\n|Π\n′\na\n,X\na\n)|\n=|H(X\na\n|Π\n′\na\n,X\nb\n)","+H(X\nb\n|Π\nb\n)−H(X\na\n|Π\nb\n)−H(X\nb\n|Π\n′\na\n,X\na\n)|\n=|H(X\nb\n|Π\nb\n)−H(X\na\n|Π\nb\n)","+H(X\na\n,Π\n′\na\n)−H(X\nb\n,Π\n′\na\n)|=","∆.\nNow,∆can","be","bounded","as","follows:\n∆≤|H(X\nb\n|Π\nb\n)−H(X\na\n|Π\nb\n)|+|H(X\na\n|Π\n′\na\n)−H(X\nb\n|Π\n′\na\n)|≤2λ,\nwhere","the","last","inequality","follows","from","Eq.","(6).","Thus,","the","second","term","is","upper","bounded","by\n2λin","all","cases.","Property","(1)","is","proved","by","summing","the","bounds","of","both","terms.\nLastly,","we","prove","Theorem","8.2.\nof","Theorem","8.2.Setλ","<","\u000f/2.","We","prove","that","there","exists","a","non-optimal","EC","with","a","score","at\nleastS\n∗\n−2λ.","LetG\n∗\n∈G\nd,k\nbe","an","optimal","structure","forD\n2\n(λ).","By","Theorem","8.1,D\n2\n(λ)is\n(β−3dλ,X\n1\n\\{X\na\n})-stable.","Therefore,","by","Lemma","7.4,","the","set","of","families","of\n","̄\nV≡{X\nb\n,X\na\n}\ninG\n∗\nis","an","optimal","legal","family","set.","Denote","this","setF:={f\na\n,f\nb\n}.","First,","we","prove","thatX\na\nandX\nb\nmust","be","in","a","parent-child","relationship.\n29\n\nClaim:InF,","eitherX\na\nis","a","parent","ofX\nb\n,","or","vice","versa.\nProof","of","claim:Assume","for","contradiction","that","the","claim","does","not","hold.","We","define","a\nnew","legal","family","setF\n′\nfor\n","̄\nVand","show","that","its","score","is","larger","than","the","score","ofF,","thus\ncontradicting","the","optimality","ofF.","Denote","the","parent","set","ofX\na\ninf\na\nby\n","̄\nΠ\na\n.","Define","a","new\nfamilyf\n′\na\n:=〈X\na\n,Π\n′\na\n〉\n,","whereΠ\n′\na\nis","obtained","by","addingX\nb\nas","a","parent","to\n","̄\nΠ\na\n.","In","addition,","if\nthis","increases","the","number","of","parents","ofX\na\noverk,","then","one","of","the","other","elements","in\n","̄\nΠ\na\nis\nremoved","inΠ\n′\na\n.","LetF\n′\n={f\n′\na\n,f\nb\n}.","According","to","Property","(II)","in","the","definition","ofD\n2\n,X\na\nhas","no","children","inX\n1\n\\{X\na\n},","therefore,X\na\nhas","no","children","inG\n∗\n,","and","so","adding","the","edge\n(X\na\n,X\nb\n)cannot","create","a","cycle.","Therefore,F\n′\nis","a","legal","family","set.","We","have\nS(F\n′\n)−S(F)","=S({〈X\na\n,Π\n′\na\n〉})−S({〈X\na\n,Π\na\n〉})","=H(X\na\n|Π\na\n)−H(X\na\n|Π\n′\na\n)\n≥H(X\na\n|X\n1\n\\{X\na\n})−H(X\na\n|X\nb\n)≥α−λ,\nwhere","the","last","inequality","follows","from","assumptions","(III)","and","(V).","Now,","since","by","definition,\nλ","<","α,","it","followsS(F\n′\n)>S(F),","which","contradicts","the","optimality","ofF.","This","completes","the\nproof","of","the","claim.2\nNow,","define","a","new","graph","as","follows:","Let\n","̃\nF\na","family","set","which","is","the","same","asF,","except","that\nthe","roles","ofX\nb\nandX\na\nare","swapped.","Define\n","̃\nG:=G\n∗\n\\F∪\n","̃\nF.","Notice","that","by","Theorem","8.1,\nD\n2\nis(γ,V)-stable","forV=X\n1\n\\{X\na\n}.","Then,","by","Property","1","in","Def.","7.1,","bothX\na\nandX\nb\nhave","no","children","inV.","This","means","that","inG\n∗\n,","one","ofX\na\nandX\nb\nhas","the","other","as","a","child,\nand","the","other","has","no","children.","Thus,","swapping","them","cannot","create","a","cycle,","implying","that\n","̃\nG∈G\nd,k\nand","that\n","̃\nFis","a","legal","family","set.\nWe","now","show","thatS\n∗\n−2λ≤S(\n","̃\nG)<S\n∗\n,","thus","proving","the","theorem.","Since","we","have\nS\n∗\n−S(\n","̃\nG)","=S(F)−S(\n","̃\nF),\nit","suffices","to","show","that0<S(F)−S(\n","̃\nF\n)≤2λ.","Let\n","̄\nΠ\na\n,\n","̄\nΠ\nb\nbe","the","parent","sets","ofX\na\nandX\nb\ninF,","respectively.","LetΠ\na\n:=\n","̄\nΠ\na\n\\{X\nb\n}andΠ\nb\n:=\n","̄\nΠ\nb\n\\{X\na\n}.","IfX\na\nis","a","parent","ofX\nb\ninF,\nthen\nS(F)−S(\n","̃\nF)","=H(X\na\n|Π\nb\n,X\nb\n)","+H(X\nb\n|Π\na\n)−H(X\na\n|Π\na\n)−H(X\nb\n|Π\nb\n,X\na\n).\nSinceH(X\nb\n|Π\nb\n,X\na\n)","","=H(X\nb\n,Π\nb\n,X\na\n)−H(X\na\n|Π\nb\n)−H(Π\nb\n),","and","symmetrically","for\nH(X\na\n|Π\nb\n,X\nb\n),","it","follows","that\nH(X\na\n|Π\nb\n,X\nb\n)−H(X\nb\n|Π\nb\n,X\na\n)","=H(X\na\n|Π\nb\n)−H(X\nb\n|Π\nb\n).\nTherefore,\nS(F)−S(\n","̃\nF)","=H(X\na\n|Π\nb\n)−H(X\nb\n|Π\nb\n)","+H(X\nb\n|Π\na\n)−H(X\na\n|Π\na\n).(13)\nBy","a","symmetric","argument,","Eq.","(13)","holds","also","ifX\nb\nis","a","parent","ofX\na\ninF.","Combining\nEq.","(13)","with","Eq.","(6)","in","Lemma","8.3,","we","have","that|S(F)−S(\n","̃\nF)|","≤2λ.","We","have","left","to\nshow","thatS(F)>S(\n","̃\nF),","which","will","complete","the","proof","of","the","theorem.\nWe","have,","for","any","setΠ⊆X\n1\n,\nH(X\nb\n,X\na\n|Π)","=H(X\nb\n|X\na\n,Π)","+H(X\na\n|Π)","=H(X\nb\n|X\na\n)","+H(X\na\n|Π),\n30\n\nwhere","the","last","inequality","follows","since","by","assumption","(IV),Π→X\na\n→X\nb\nis","a","Markov","chain.\nTherefore,\nH(X\nb\n|Π)≡H(X\nb\n,X\na\n|Π)−H(X\na\n|X\nb\n,Π)","=H(X\nb\n|X\na\n)","+H(X\na\n|Π)−H(X\na\n|X\nb\n,Π).\nUsing","the","above","forΠ\na\nandΠ\nb\n,","we","get\nH(X\nb\n|Π\na\n)−H(X\nb\n|Π\nb\n)","=H(X\na\n|Π\na\n)−H(X\na\n|Π\nb\n)","+H(X\na\n|X\nb\n,Π\nb\n)−H(X\na\n|X\nb\n,Π\na\n).\nCombined","with","Eq.","(13),","it","follows","that\nS(F)−S(\n","̃\nF)","=H(X\na\n|X\nb\n,Π\nb\n)−H(X\na\n|X\nb\n,Π\na\n).(14)\nNow,","inF,","one","ofX\nb\n,X\na\nis","the","parent","of","the","other,","and","in\n","̃\nF\n,","the","other","case","holds.","We\nshow","that","in","both","cases,S(F)−S(\n","̃\nF)>0.\n1.\nSuppose","thatX\na\nis","the","parent","ofX\nb\n.","In","this","case,","we","can","assume","without","loss","of\ngenerality","thatΠ\nb\n=∅inF,","sinceH(X\nb\n|X\na\n)","=H(X\nb\n|X\na\n,Π\nb\n)for","any","setΠ\nb\n⊆X\n1\n,\ndue","to","assumption","(IV).","Therefore,","from","Eq.","(14),\nS(F)−S(\n","̃\nF)","=H(X\na\n|X\nb\n)−H(X\na\n|X\nb\n,Π\na\n)\n=H(X\na\n,X\nb\n)−H(X\nb\n)−H(X\na\n,X\nb\n,Π\na\n)","+H(X\nb\n,Π\na\n)\n=H(Π\na\n|X\nb\n)−H(Π\na\n|X\na\n,X\nb\n)","=H(Π\na\n|X\nb\n)−H(Π\na\n|X\na\n).\nThe","last","inequality","follows","sinceX\nb\n→X\na\n→Π\na\nis","a","Markov","chain","by","assumption\n(IV).","Now,","by","assumption","(IV),","we","have\nH(Π\na\n|X\nb\n)≥H(Π\na\n|X\nb\n,C)(15)\n=H(Π\na\n|X\na\n,C=","1)P[C=","1]","+H(Π\na\n|C=","0)P[C=","0]\n=H(Π\na\n|X\na\n)P[C=","1]","+H(Π\na\n)P[C=","0].(16)\nIn","addition,H(Π\na\n|X\na\n)<","H(Π\na\n).","This","is","becauseΠ\na\nis","an","optimal","parent","set","for\nX\na\nfromX\n1\n,","and","by","assumption","(I)","onD\n1\n,","it","is","unique.","Therefore,H(X\na\n|Π\na\n)>\nH(X\na\n),","which","impliesH(Π\na\n|X\na\n)<","H(Π\na\n).","Combined","with","Eq.","(16),","and","since\nP[C=","0]>0by","assumption","(IV),","we","haveH(Π\na\n|X\nb\n)>","H(Π\na\n|X\na\n).","It","follows","that\nS(F)−S(\n","̃\nF)>0,","as","required.\n2.Suppose","thatX\nb\nis","a","parent","ofX\na\ninF.","Assume","for","contradiction","thatS(F)","=S(\n","̃\nF\n).\nThen\n","̃\nFis","an","optimal","legal","family","set","in","whichX\na\nis","a","parent","ofX\nb\n.","Therefore,","by","the\nfirst","case","above,S(\n","̃\nF)>S(F),","in","contradiction","to","the","optimality","ofF.\nIt","follows","thatS(F)>S(\n","̃\nF),","which","proves","the","claim.","Thus,\n","̃\nGis","not","an","optimal","graph,\nas","required.","This","completes","the","proof","of","the","theorem.\n31"],"doc6":["\n\narXiv:2103.13989v1","","[eess.SP]","","25","Mar","2021\nAdversarial","Attacks","on","Deep","Learning","Based\nmmWave","Beam","Prediction","in","5G","and","Beyond\nBrian","Kim\n1\n,","Yalin","E.","Sagduyu\n2\n,","Tugba","Erpek\n2\n,","and","Sennur","Ulukus\n1\n1\nDepartment","of","Electrical","and","Computer","Engineering,","University","of","Maryland,","College","Park,","MD","20742,","USA\n2\nIntelligent","Automation,","Inc.,","Rockville,","MD","20855,","USA\nAbstract—Deep","learning","provides","powerful","means","to","learn\nfrom","spectrum","data","and","solve","complex","tasks","in","5G","and","beyond\nsuch","as","beam","selection","for","initial","access","(IA)","in","mmWave\ncommunications.","To","establish","the","IA","between","the","base","station\n(e.g.,","gNodeB)","and","user","equipment","(UE)","for","directional","trans-\nmissions,","a","deep","neural","network","(DNN)","can","predict","the","beam\nthat","is","best","slanted","to","each","UE","by","using","the","received","signal\nstrengths","(RSSs)","from","a","subset","of","possible","narrow","beams.","While\nimproving","the","latency","and","reliability","of","beam","selection","compared\nto","the","conventional","IA","that","sweeps","all","beams,","the","DNN","itself","is\nsusceptible","to","adversarial","attacks.","We","present","an","adversarial\nattack","by","generating","adversarial","perturbations","to","manipulate\nthe","over-the-air","captured","RSSs","as","the","input","to","the","DNN.","This\nattack","reduces","the","IA","performance","significantly","and","fools","the\nDNN","into","choosing","the","beams","with","small","RSSs","compared","to\njamming","attacks","with","Gaussian","or","uniform","noise.\nI.","INTRODUCTION\nDue","to","the","algorithmic","and","computational","advances","in\ndeep","learning","(DL),","various","applications","in","different","domains,\nsuch","as","computer","vision","[1]","and","speech","recognition","[2],","have\nbeen","empowered","by","deep","neural","networks","(DNNs)","in","solving\ncomplex","problems","by","effectively","learning","from","rich","data","repre-\nsentations.","Similarly,","DL","has","been","applied","for","various","wireless\ncommunication","tasks,","such","as","waveform","design,","signal","classi-\nfication,","spectrum","sensing,","and","interference","management","[3]\nby","capturing","the","intrinsic","characteristics","of","the","spectrumdata.\nOne","particular","application","of","DL","is","in","the","domain","of","initial\naccess","(IA),","where","user","equipments","(UEs)","need","to","establish\ntheir","initial","connection","to","an","access","point","or","base","station","when\nthey","attempt","to","join","the","communication","network","for","the","first\ntime","[4].","As","5G","and","beyond","communication","systems","rely\non","millimeter","wave","(mmWave)","and","higher","frequency","bands\nto","sustain","high","data","rates","over","large","available","bandwidths,\ntransmissions","become","more","directional","using","narrow","beams.\nThis","paradigm","makes","the","beam","alignment","in","the","IA","process\nmore","difficult","as","many","narrow","beams","need","to","be","swept","to","find\nthe","most","suitable","beam","for","each","UE","[5],","[6].","In","the","IA,","the\ntransmitter","such","as","the","5G","base","station","(gNodeB)","sequentially\ntransmits","pilot","signals","over","different","narrow","beams.","The","UE\ncalculates","the","received","signal","strength","(RSS)","for","each","beam,\ndetermines","the","beam","that","provides","the","highest","RSS,","and\ninforms","the","gNodeB","of","this","beam","selection.","Since","the","time","for\nThis","effort","is","supported","by","the","U.S.","Army","Research","Office","under","contract\nW911NF-20-C-0055.","The","content","of","the","information","does","not","necessarily\nreflect","the","position","or","the","policy","of","the","U.S.","Government,","andno","official\nendorsement","should","be","inferred.\nthe","IA","is","limited,","it","is","essential","to","reduce","the","number","of","beams\nswept","as","checking","each","beam","consumes","time","and","delays","the\nUE","to","gain","access","to","time-sensitive","services","such","as","ultra-\nreliable","low-latency","communications","(URLLC)","in","5G.","To\novercome","this","issue,","a","DL-based","approach","has","been","proposed\nin","[7],","[8]","to","reduce","the","number","of","beams","that","need","to","be","swept\nbefore","making","a","decision,","compared","to","the","conventional","beam\nsweeping","approach","that","needs","to","sweep","all","possible","beams.","In\nthis","DL-based","approach,","the","UE","predicts","the","best","beam","from\na","large","set","of","narrow","beams","by","using","only","the","RSSs","for","a\nsubset","of","these","possible","beams.\nIt","is","well","known","that","DNNs","are","highly","susceptible","to\ncarefully","crafted","adversarial","perturbations","that","induce","incor-\nrect","output","or","misclassification,","as","first","shown","in","computer\nvision","applications","[9].","Wireless","medium","is","shared","and","open\nto","jamming","attacks","that","can","also","be","launched","via","adversarial\nmachine","learning","to","target","the","underlying","DNNs.","Therefore,\nadversarial","machine","learning","has","recently","gained","attention\nas","the","emerging","attack","surface","for","wireless","security","[10].\nThe","attacks","built","upon","adversarial","machine","learning","include\nexploratory","(inference)","attacks","[11],","[12],","adversarial","(evasion)\nattacks","[13]–[26],","poisoning","(causative)","attacks","[27]–[30],\nmembership","inference","attacks","[31],","Trojan","attacks","[32],","and\nspoofing","attacks","[33],","[34].","These","attacks","are","stealthier","(harder\nto","detect)","than","conventional","jamming","schemes","[35],","[36].\nIn","this","paper,","we","consider","an","adversarial","attack","that","aims\nto","manipulate","the","input","to","a","DNN","in","test","time.","Most","of\nthe","applications","of","adversarial","attacks","to","the","wireless","domain\nhave","focused","on","wireless","signal","classifiers","such","as","modulation\nclassifiers","[13]–[25]","and","spectrum","sensing","classifiers","[26]–\n[28].","There","have","been","efforts","to","extend","adversarial","attacks\nto","communication","problems","such","as","autoencoder-based","end-\nto-end","communications","[37],","power","control","for","MIMO","com-\nmunications","[38],","and","dynamic","channel","access","[39],","[40].\nIn","addition,","adversarial","machine","learning","has","been","used","to\ndevelop","attacks","on","5G-specific","tasks","such","as","5G","spectrum\nsharing","with","incumbent","users","[41],","5G","signal","authentication\n[41],","and","5G","radio","access","network","(RAN)","slicing","[42],","[43].\nOur","goal","in","this","paper","is","to","investigate","the","vulnerability\nof","a","DNN","that","is","used","for","mmWave","beam","prediction","as\npart","of","the","IA","process","in","5G","and","beyond","communications.\nWe","first","generate","a","non-targeted","attack","using","fast","gradient\nmethod","(FGM)","[44]","to","cause","any","misclassification","at","the","DNN\nclassifier","at","the","receiver","(independent","of","the","wrong","labels\n\nDeep","Neural","\nNetwork\nRSSs","\nfrom","a","\nsubset","of","","\nbeams\nPredicted","\nbeam","\nfrom","a","\nlarger","set","\nof","beams\n(a)","Conventional","beam","sweeping","","","","","","(b)","Deep","learning","for","beam","prediction","","\nUE\nUE\ngNodeB\ngNodeB\nRSS","for","\nbeam","1\nRSS","for","\nbeam","1\nRSS","for","\nbeam","N\nRSS","for","\nbeam","1\nRSS","for","\nbeam","1\nRSS","for","\nbeam","M\ntime\ntime\nFig.","1.","Conventional","beam","sweeping","vs.","DL-based","beam","prediction.\nfor","beams).","Then,","we","introduce","thek-worst","beam","attack","that\nnot","only","causes","misclassification","but","also","enforces","the","DNN\nclassifier","to","select","one","of","thekworst","beams","to","further","reduce\nthe","IA","performance.","We","compare","the","non-targeted","FGM","attack\nandk-worst","beam","attack","with","benchmark","jamming","attacks\nwith","Gaussian","and","uniform","noise","added","across","RSSs","from\ninput","beams.","Our","results","show","that","the","beam","prediction","of","the\nIA","process","is","highly","vulnerable","to","adversarial","attacks","thatcan\nsignificantly","reduce","the","beam","prediction","accuracy.","The","effect\nof","this","attack","translates","to","notable","reduction","in","communication\nperformance","in","terms","of","data","rate","since","the","UEs","connect","to\nthe","gNodeB","using","beams","that","are","not","well","aligned","and","the\ncorresponding","RSSs","drop","significantly.\nThe","rest","of","the","paper","is","organized","as","follows.","Section","II\nprovides","the","system","model.","Section","III","describes","the","ad-\nversarial","attacks","considered","in","this","paper,","namely,","the","non-\ntargeted","attack","and","thek-worst","attack.","Section","IV","presents\nthe","performance","results.","Section","V","concludes","the","paper.\nII.","SYSTEMMODEL\nWe","consider","a","mmWave","network","that","consists","of","a","direc-\ntional","transmitter","(e.g.,","the","gNodeB","in","5G),","an","omnidirectional\nreceiver","(e.g.,","a","UE)","during","the","IA,","and","an","adversary.","A\npre-trained","DL-based","classifier","is","applied","to","the","RSS","values\nmeasured","at","the","receiver","to","select","the","best","beam","without","a","need\nto","sweep","all","beams,","as","proposed","in","[7],","[8].","Concurrently,","the\nadversary","attempts","to","cause","misclassification","at","the","receiver\nby","launching","an","over-the-air","adversarial","attack.\nFig.","1","illustrates","two","approaches","for","the","IA,","namely","con-\nventional","beam","sweeping","and","DL","for","beam","prediction.","In","the\nconventional","IA","process","with","exhaustive","beam","sweeping,","the\ntransmitter","transmits","pilot","signals","over","all","narrow","beams","and\nthe","receiver","uses","the","RSS","values","from","allNpossible","beams\nwhereN=|N|to","select","the","best","beam.","The","transmitter\ntransmits","the","pilot","signal","over","each","beam","at","a","separate","time\nslot.","DL","reduces","the","number","of","beams","swept","such","that","the\nDNN","classifier","at","the","receiver","only","uses","the","RSS","values\nDeep","Neural","\nNetwork\nPerturbations","\nadded","to\nRSSs","from","\na","subset","of","","beams\nWrongly","predicted","\nbeam","\nfrom","a","larger","\nset","of","beams\nUE\ngNodeB\nJammer\nRSS","+","received","\nperturbation","\nfor","beam","1\nRSS","+","received","\nperturbation","for","\nbeam","2\nRSS","+","\nreceived","\nperturbation","\nfor","beam","M","\nFig.","2.","Adversarial","attack","on","beam","prediction","with","deep","learning.\nfromMsubset","of","beams,","whereM","⊆","NandM=|M|,\nto","select","the","best","beam.","For","that","purpose,","the","transmitter\ntransmits","the","pilot","signals","over","a","smaller","set","of","beams,","each\nat","a","separate","time","slot.","Overall,","the","total","time","needed","for","the\nIA","is","reduced.","In","the","DL-based","approach,","the","DNN","classifier\nat","the","receiver","is","denoted","byf(.;θ)",":X\nM\n→R\nN\nwhere\nX\nM\n⊂R\nM\nis","the","input","to","the","DNN","which","corresponds","to","the\nRSS","values","ofMbeams","andθis","the","set","of","the","receiver’s\nDNN","parameters.","The","classifierfassigns","the","best","beam\nˆ\nl(x\nM\n,θ)","=","arg","max\nj\nf\nj\n(x\nM\n,θ)to","every","inputx\nM\n∈","X\nM\n.\nIn","this","formulation,f\nj\n(x\nM\n,θ)is","the","output","of","classifierf\ncorresponding","to","thejth","beam.\nIn","the","meantime,","as","shown","in","Fig.","2,","the","adversary","generates\nan","adversarial","attack","by","jamming","the","spectrum","with","adver-\nsarial","perturbation,δ=","[δ\n1\n,","δ\n2\n,···,","δ\nM\n],","under","some","suitable\npower","constraintP\nmax\nwith","respect","to","the","original","RSS","values,\nx∈R\nN\n,","by","solving","the","following","optimization","problem:\narg","min\nδ\nM\n∑\ni=1\nδ\ni\ns.t.\nˆ\nl(x\nM\n,θ)6=\nˆ\nl(x\nM\n+δ,θ)\nM\n∑\ni=1\nδ\ni\n≤P\nmax\n.(1)\nNote","thatx\nM\n∈R\nM\nis","theMelements","fromxwhich\ncorrespond","to","the","RSS","values","at","the","receiver","for","all","beams.\nHowever,","solving","(1)","is","hard","due","to","the","inherent","structure\nof","the","DNN.","Thus,","different","methods","have","been","proposed","to\napproximate","the","adversarial","attack","such","as","FGM.","FGM","is","a\ncomputationally","efficient","way","of","generating","adversarial","attacks\nby","linearizing","the","loss","function","of","the","DNN","classifier.","We\ndenote","the","loss","function","of","the","DNN","classifier","byL(δ,x,y),\nwherey∈{0,1}\nN\nis","the","one-hot","encoded","class","vector.","Then,\nFGM","linearizes","this","loss","function","in","a","neighborhood","ofxand\nuses","this","linearized","function","for","optimization.\nThroughout","the","paper,","we","assume","that","the","adversary","knows\n\nAlgorithm","1:Non-targeted","FGM","attack\nInputs:","RSS","valuesx\nM\n,","true","labely\ntrue\n,","desired\naccuracyε\nacc\n,","power","constraintP\nmax\n,","and","model","of\nthe","classifier\nInitialize:ε←0,","ε\nmax\n←P\nmax\n,","ε\nmin\n←0\nδ\nnorm\n=\n∇\nx\nM\nL(θ,x\nM\n,y\ntrue\n)\n(||∇\nx\nM\nL(θ,x\nM\n,y\ntrue\n)||\n1\n)\nif\nˆ\nl(x\nM\n,θ)","==y\ntrue\nthen\nwhileε\nmax\n−ε\nmin\n>","ε\nacc\ndo\nε\navg\n←(ε\nmax\n+ε\nmin\n)/2\nx\nadv\n←x\nM\n+ε\navg\nδ\nnorm\nif\nˆ\nl\nm\n(x\nadv\n)","==y\ntrue\nthenε\nmin\n←ε\navg\nelseε\nmax\n←ε\navg\nend\nend\nε=ε\nmax\n,δ\n∗\n=εδ\nnorm\nthe","architecture","(θandL(·))","of","the","DNN","classifier","at","the\nreceiver,","and","the","exact","RSS","values","for","allNbeams","that","are\nreceived","at","the","receiver.","Later","in","the","paper,","we","will","relax\nthe","assumption","about","knowing","allNRSS","values","to","knowing\nonlyMRSS","values,","and","compare","the","results","under","these\ntwo","assumptions.","In","the","next","section,","we","describe","the","two\nadversarial","attacks","considered","in","this","paper,","namely,","the","non-\ntargeted","attack","and","thek-worst","attack.\nIII.","ADVERSARIALATTACKS","ONBEAMPREDICTION\nA.","Non-targeted","FGM","Attack\nFirst,","we","consider","a","non-targeted","FGM","attack","where","the\nadversary","searches","for","a","perturbation","that","causes","any","misclas-\nsification","at","the","receiver’s","DNN","classifier.","For","that","purpose,\nthe","adversary","designs","a","perturbation","that","maximizes","the","loss\nfunctionL(δ,x\nM\n,y\ntrue\n),","wherey\ntrue\nis","the","true","label","ofx\nM\n.\nFGM","is","used","to","linearize","the","loss","function","asL(θ,x\nM\n+\nδ,y\ntrue\n)≈L(θ,x\nM\n,y\ntrue\n)","+δ\nT\n∇\nx\nM\nL(θ,x\nM\n,y\ntrue\n)that","is\nmaximized","by","settingδ=α∇\nx\nM\nL(θ,x\nM\n,y\ntrue\n),","whereα\nis","a","scaling","factor","to","constrain","the","adversarial","perturbation\npower","toP\nmax\n.","The","details","of","selectingαand","generating","the\nnon-targeted","FGM","attack","are","presented","in","Algorithm","1.\nB.k-worst","Beam","Attack\nNext,","the","adversary","designs","an","adversarial","attack","such","that\nit","not","only","causes","a","misclassification","at","the","receiver’s","DNN\nclassifier","but","also","tries","to","change","the","beam","to","one","of","the","worst\nkbeams.","Unlike","attacks","on","some","signal","classification","tasks","(in\nthe","computer","vision","or","wireless","domains),","where","changing\nthe","label","from","‘signal","1’","to","‘signal","2’","and","from","‘signal","1’","to\n‘signal","3’","may","have","the","same","effect","on","the","classifier","meaning\nthat","both","correspond","to","an","error","in","classification,","changing\nthe","label","from","the","best","beam","to","second","worst","beam","and","from\nthe","best","beam","to","the","worst","beam","have","totally","different","effects\non","the","communication","performance","(as","the","signal","quality","on\na","beam","strongly","affects","the","achieved","rate","following","the","IA).\nThus,","the","adversary","first","tries","to","change","the","label","to","the","worst\nbeam","and","if","the","adversary","is","not","able","to","change","to","that","label,\nAlgorithm","2:k-worst","beam","attack\nInputs:","RSS","valuesx\nM\n,","true","labely\ntrue\n,kworst","beam\nindices,","desired","accuracyε\nacc\n,","power","constraintP\nmax\n,\nand","model","of","the","classifier\nif\nˆ\nl(x\nM\n,θ)","==y\ntrue\nthen\nforiinkworst","beam","indicesdo\nInitialize:\nε←0,","ε\nmax\n←P\nmax\n,","ε\nmin\n←0,y\ntarget\n←i\nδ\nnorm\n=\n∇\nx\nM\nL(θ,x\nM\n,y\ntarget\n)\n(||∇\nx\nM\nL(θ,x\nM\n,y\ntarget\n)||\n1\n)\nwhileε\nmax\n−ε\nmin\n>","ε\nacc\ndo\nε\navg\n←(ε\nmax\n+ε\nmin\n)/2\nx\nadv\n←x\nM\n−ε\navg\nδ\nnorm\nif\nˆ\nl\nm\n(x\nadv\n)","==y\ntrue\nthenε\nmin\n←ε\navg\nelseε\nmax\n←ε\navg\nend\nx\nadv\n←x\nM\n−ε\navg\nδ\nnorm\nif\nˆ\nl\nm\n(x\nadv\n)","==ithenbreak\nend\nend\nδ\n∗\n=−ε\navg\nδ\nnorm\nthen","the","adversary","tries","to","change","the","label","to","the","second","worst\nbeam.","The","adversary","continues","to","do","so","until","it","tries","for","the\nkth","worst","beam.\nHere,","we","consider","the","targeted","FGM","attack","where","the","ad-\nversary","aims","to","fool","the","DNN","to","a","target","label.","Therefore,","the\nadversary","tries","to","minimize","the","loss","functionL(δ,x\nM\n,y\ntarget\n),\nwherey\ntarget\nis","one","of","thekworst","beams.","FGM","is","used\nagain","to","linearize","the","loss","function","asL(θ,x\nM\n+δ,y\ntarget\n)≈\nL(θ,x\nM\n,y\ntarget\n)+δ\nT\n∇\nx\nM\nL(θ,x\nM\n,y\ntarget\n)that","is","minimized\nby","settingδ=−α∇\nx\nM\nL(θ,x\nM\n,y\ntarget\n),","whereαis","a","scaling\nfactor","to","constrain","the","adversarial","perturbation","power","toP\nmax\n.\nFirst,","we","assume","that","the","adversary","knows","the","order","of","beam\nindices","based","on","the","real","RSS","values.","Then,","we","relax","this\nassumption","by","getting","the","order","from","the","output","of","the","DNN\nclassifier.","Since","the","DNN","classifier","is","only","trained","to","find","the\nbest","beam,","there","exists","a","discrepancy","between","the","real","orderof\nbeams","and","the","order","of","beams","obtained","from","the","DNN","output.\nThe","details","of","the","algorithm","are","presented","in","Algorithm","2.\nIV.","PERFORMANCEEVALUATION\nThis","section","describes","the","details","of","the","DNN","classifier\nused","at","the","receiver","and","the","dataset","that","is","used","to","train","it.\nFurthermore,","the","performances","of","the","two","attack","schemes","that\nare","introduced","in","this","paper","are","compared","with","two","benchmark\njamming","attacks","that","inject","Gaussian","or","uniform","noise","on\ndifferent","beams.\nA.","Deep","Learning","Framework","for","IA\nWe","use","the","DNN","structure","that","consists","of","seven","layers\nincluding","the","input","and","the","output","layers","as","shown","in","Table","I.\nThe","input","layer","hasM=","12neurons","and","the","output","layer","has\nN=","24neurons","where","each","neuron","represents","a","likelihood\nscore","for","each","beam.","Note","that","each","dense","layer’s","output\n\nTABLE","I\nTHEDNNARCHITECTURE","FOR","THEIA.\nLayers\nNumber","of","neuronsActivation","function\nInputM=","12-\nDense","132ReLu\nDense","264ReLu\nDense","3126ReLu\nDense","464ReLu\nDense","532ReLu\nOutputN=","24Softmax\nis","batch","normalized","before","sending","it","to","the","next","layer.","We\nfollow","the","simulation","setup","of","[7]","and","apply","the","attacks","in\na","two-dimensional","mmWave","network","scenario","where","line-of-\nsight","(LoS)","mmWave","channels","with","pathloss","and","shadowing\neffects","are","considered.","A10×10antenna","array","is","used\nat","the","transmitter","to","generate","a","beam","width","of","about15\n◦\nusing","the","standard","planar","array","formulation.","The","location","of\nthe","transmitter","is","fixed","at(0,0)and","the","receiver’sxandy\npositions","are","each","uniformly","randomly","distributed","between\n−25m","and25m.","This","bounds","the","simulation","cell","to","an","area","of\n50×50m.","The","transmit","power","is","set","to20dBm.","A","total","of10\n6\nreceiver","positions","are","generated,","which","act","as","data","samples.\nThe","adversary","is","also","uniformly","distributed","in","this","area","and\ngenerates","perturbations","that","are","added","to","the","data","samples.\nB.","Attack","Performance","Results\nWe","compare","the","two","attack","schemes","that","we","have","described\nearlier","with","the","Gaussian","attack","and","the","uniform","attack","that\ngenerate","perturbations","with","Gaussian","and","equal","power","dis-\ntribution","forMbeams,","respectively.","In","the","simulations,","we\nuse","the","perturbation-to-signal","ratio","(PSR)","metric","that","shows\nthe","relative","perturbation","power","with","respect","to","the","received\nsignal","power","(namely,","the","RSS","at","the","receiver).","As","the","PSR\nincreases,","the","attack","becomes","more","likely","to","be","detected.\nFig.","3","presents","the","accuracy","of","the","classifier","at","the","receiver\nunder","the","non-targeted","FGM","attack","and","compares","it","with\nthe","Gaussian","attack","and","the","uniform","attack.","The","non-targeted\nFGM","attack","significantly","impacts","the","accuracy","of","the","classifier\nfor","beam","selection","even","for","signal","strength","fluctuations","that\ncannot","be","resolved","with","typical","hardware.","Also,","the","Gaussian\nattack","and","the","uniform","attack","do","not","perform","well","compared\nto","the","non-targeted","attack","in","[-40dB,-20dB]","region,","while","they\nare","comparable","in","the","high","PSR","region.\nIn","Fig.","4,","we","investigate","the","performance","of","thek-worst\nbeam","attack,","wherekis","set","as","4,","8,","12,","and","compare","it","with\nthe","Gaussian","attack","and","the","uniform","attack.","Note","that","the\naccuracy","definition","in","Fig.","4","is","different","from","Fig.","3,","where","the\naccuracy","is","defined","as","the","percentage","that","the","label","obtained\nfrom","the","DNN","classifier","is","in","theN−kbest","beams","since","the\nattack","is","successful","only","if","thek-worst","beam","attack","fools","the\nDNN","classifier","into","choosing","one","of","the","worstkbeams.","As\nkincreases","for","thek-worst","beam","attack,","the","DNN","classifier\naccuracy","decreases","meaning","that","it","is","harder","to","enforce","the\nbeam","selection","to","the","worst","ones.","Also,","thek-worst","beam\n−55−45−35−25−15−55\nPSR","[dB]\n100\n90\n80\n70\n60\n50\n40\n30\n20\n10\n0\nAccuracy","%\nno","attack\ngaussian","attack\nuniform","attack\nnon-targeted","FGM","attack\nFig.","3.","Classifier","accuracy","under","the","non-targeted","attack.\n−55−45−35−25−15−55\nPSR","[dB]\n100\n90\n80\n70\n60\n50\n40\n30\n20\n10\n0\nAccuracy","%\nno","attack\nuniform","attack\ngaussian","attack\nusing","real","order\n4-worst","beam","attack\n8-worst","beam","attack\n12-worst","beam","attack\nusing","dnn","order\n4-worst","beam","attack\n8-worst","beam","attack\n12-worst","beam","attack\nFig.","4.","Classifier","accuracy","under","thek-worst","beam","attack.\nattack","using","the","real","order","of","RSSs","outperforms","thek-worst\nbeam","attack","using","the","DNN","order","as","there","is","a","discrepancy\nbetween","the","real","order","and","the","DNN-predicted","order","of","RSSs.\nFurthermore,","the","Gaussian","attack","and","the","uniform","attack","both\nsaturate","around","50%","meaning","that","under","both","attacks","the\nbeams","are","misclassified","to","the","best","or","worst","group","50%","of\nthe","time.\nV.","CONCLUSION\nWe","presented","an","adversarial","attack","to","fool","the","beam","se-\nlection","process","of","the","IA","using","a","DNN","classifier","that","uses\na","subset","of","beams","to","predict","the","beam","that","is","best","oriented\nto","the","receiver.","We","investigated","two","different","attack","methods,\nnamely,","the","non-targeted","FGM","attack","that","only","aims","to","fool\nthe","DNN","classifier","with","misclassification","to","any","other","beam\nlabel,","and","thek-worst","beam","attack","that","not","only","fools","the\nDNN","classifier","but","also","enforces","the","label","that","is","chosen","at\nthe","DNN","to","be","in","one","of","thek-worst","beams.","We","showed","that\nthe","adversarial","attack","can","significantly","decrease","the","accuracy\nof","the","DNN","and","fool","the","DNN","into","selecting","the","worst","beam.\nResults","demonstrate","that","as","DL","finds","applications","for","beam\nprediction","in","mmWave","communication","for","5G","and","beyond,\nthe","IA","process","becomes","vulnerable","to","adversarial","attacks","that\ncan","significantly","reduce","the","beam","selection","performance.\n\nREFERENCES\n[1]","A.","Krizhevsky,","I.","Sutskever,","and","G.","Hinton,","“Imagenet","classification\nwith","deep","convolutional","neural","networks,”","inAdvances","in","Neural\nInformation","Processing","Systems","(NIPS),","2011.\n[2]","G.","Hinton,","L.","Deng,","D.","Yu,","G.","Dahl,","A.","Mohamed,","A.","Senior,","N.","Jaitly,\nV.","Vanhoucke,","P.","Nguyen,","B.","Kingsburyv,","and","T.","Sainath,","“Deep","neural\nnetworks","for","acoustic","modeling","in","speech","recognition,”IEEE","Signal\nProcessing","Magazine,","vol.","29,","pp.","82–97,","Nov.","2012.\n[3]","T.","Erpek,","T.","O’Shea,","Y.","E.","Sagduyu,","Y.","Shi,","and","T.","C.","Clancy,","“Deep\nlearning","for","wireless","communications,”","inDevelopment","and","Analysis","of\nDeep","Learning","Architectures.","","Springer,","Cham,","2020,","pp.","223–266.\n[4]","M.","Giordani,","M.","Mezzavilla,","and","M.","Zorzi,","“Initial","access","in","5G\nmmWave","cellular","networks,”","vol.","54,","no.","11,","pp.","40–47,","Nov.","2016.\n[5]","Y.","Li,","J.","G.","Andrews,","F.","Baccelli,","T.","D.","Novlan,","and","C.","J.","Zhang,","“Design\nand","analysis","of","initial","access","in","millimeter","wave","cellular","networks,”\nIEEE","Transactions","on","Wireless","Communications,","vol.","16,","no.","10,","pp.\n6409–6425,","July","2017.\n[6]","A.","Alkhateeb,","Y.","H.","Nam,","M.","S.","Rahman,","J.","Zhang,","and","R.","W.","Heath,\n“Initial","beam","association","in","millimeter","wave","cellular","systems:","Analysis\nand","design","insights,”IEEE","Transactions","on","Wireless","Communications,\nvol.","16,","no.","5,","pp.","2807–2821,","May","2017.\n[7]","T.","S.","Cousik,","V.","K.","Shah,","T.","Erpek,","Y.","E.","Sagduyu,","and","J.","H.","Reed,","“Deep\nlearning","for","fast","and","reliable","initial","access","in","AI-Driven","6G","mmwave\nnetworks,”arXiv","preprint","arXiv:2101.01847,","2021.\n[8]","T.","S.","Cousik,","V.","K.","Shah,","J.","H.","Reed,","T.","Erpek,","and","Y.","E.","Sagduyu,","“Fast\ninitial","access","with","deep","learning","for","beam","prediction","in","5G","mmwave\nnetworks,”arXiv","preprint","arXiv:2006.12653,","2020.\n[9]","C.","Szegedy,","W.","Zaremba,","I.","Sutskever,","J.","Bruna,","D.","Erhan,I.","Goodfel-\nlow,","and","R.","Fergus,","“Intriguing","properties","of","neural","networks,”arXiv\npreprint","arXiv:","1312.6199,","2013.\n[10]","Y.","E.","Sagduyu,","Y.","Shi,","T.","Erpek,","W.","Headley,","B.","Flowers,","G.","Stantchev,\nand","Z.","Lu,","“When","wireless","security","meets","machine","learning:","Motivation,\nchallenges,","and","research","directions,”arXiv","preprint","arXiv:2001.08883,\n2020.\n[11]","Y.","Shi,","Y.","E.","Sagduyu,","T.","Erpek,","K.","Davaslioglu,","Z.","Lu,","and","J.","H.\nLi,","“Adversarial","deep","learning","for","cognitive","radio","security:","Jamming\nattack","and","defense","strategies,”","inIEEE","International","Conference","on\nCommunications","(ICC),","2018.\n[12]","T.","Erpek,","Y.","E.","Sagduyu,","and","Y.","Shi,","“Deep","learning","for","launching","and\nmitigating","wireless","jamming","attacks,”IEEE","Transactions","on","Cognitive\nCommunications","and","Networking,","vol.","5,","no.","1,","pp.","2–14,","Mar.","2019.\n[13]","M.","Sadeghi","and","E.","G.","Larsson,","“Adversarial","attacks","on","deep-learning\nbased","radio","signal","classification,”IEEE","Communications","Letters,","vol.","8,\nno.","1,","pp.","213–216,","Feb.","2019.\n[14]","S.","Kokalj-Filipovic","and","R.","Miller,","“Targeted","adversarial","examples\nagainst","RF","deep","classifiers,”","inACM","WiSec","Workshop","on","Wireless\nSecurity","and","Machine","Learning","(WiseML),","2019.\n[15]","S.","Kokalj-Filipovic,","R.","Miller,","and","G.","M.","Vanhoy,","“Adversarial","examples\nin","RF","deep","learning:","Detection","and","physical","robustness,”","inIEEE","Global\nConference","on","Signal","and","Information","Processing","(GlobalSIP),","2019.\n[16]","B.","Flowers,","R.","M.","Buehrer,","and","W.","C.","Headley,","“Evaluating","adversarial\nevasion","attacks","in","the","context","of","wireless","communications,”arXiv\npreprint","arXiv:1903.01563,","2019.\n[17]","S.","Bair,","M.","Delvecchio,","B.","Flowers,","A.","J.","Michaels,","and","W.","C.","Headley,\n“On","the","limitations","of","targeted","adversarial","evasion","attacks","against","deep\nlearning","enabled","modulation","recognition,”","inACM","WiSec","Workshop","on\nWireless","Security","and","Machine","Learning","(WiseML),","2019.\n[18]","Y.","Lin,","H.","Zhao,","Y.","Tu,","S.","Mao,","and","Z.","Dou,","“Threats","of","adversarial\nattacks","in","DNN-based","modulation","recognition,”","inInternational","Con-\nference","on","Computer","Communications","(INFOCOM),","2020.\n[19]","B.","Kim,","Y.","E.","Sagduyu,","K.","Davaslioglu,","T.","Erpek,","and","S.","Ulukus,","“Over-\nthe-air","adversarial","attacks","on","deep","learning","based","modulation","classifier\nover","wireless","channels,”","inConference","on","Information","Sciences","and\nSystems","(CISS),","2020.\n[20]","B.","Kim,","Y.","E.","Sagduyu,","K.","Davaslioglu,","T.","Erpek,","and","S.","Ulukus,\n“Channel-aware","adversarial","attacks","against","deep","learning-based","wireless\nsignal","classifiers,”arXiv","preprint","arXiv:2005.05321,","2020.\n[21]","M.","Z.","Hameed,","A.","Gyorgy,","and","D.","Gunduz,","“Communication","without\ninterception:","Defense","against","modulation","detection,”","inIEEE","Global\nConference","on","Signal","and","Information","Processing","(GlobalSIP),","2019.\n[22]","M.","Z.","Hameed,","A.","Gy","̈orgy,","and","D.","G","̈und","̈uz,","“The","best","defense","is","a\ngood","offense:","Adversarial","attacks","to","avoid","modulation","detection,”IEEE\nTransactions","on","Information","Forensics","and","Security,","vol.","16,","pp.","1074–\n1087,","Sep.","2021.\n[23]","B.","Kim,","Y.","E.","Sagduyu,","K.","Davaslioglu,","T.","Erpek,","and","S.","Ulukus,","“How\nto","make","5G","communications","“invisible”","adversarial","machinelearning\nfor","wireless","privacy,”","inAsilomar","Conference","on","Signals,","Systems,","and\nComputers,","2020.\n[24]","B.","Kim,","Y.","E.","Sagduyu,","K.","Davaslioglu,","T.","Erpek,","and","S.","Ulukus,\n“Adversarial","attacks","with","multiple","antennas","against","deep","learning-based\nmodulation","classifiers,”","inIEEE","Global","Communications","Conference\n(Globecom),","2020.\n[25]","B.","Kim,","Y.","E.","Sagduyu,","T.","Erpek,","K.","Davaslioglu,","and","S.","Ulukus,\n“Channel","effects","on","surrogate","models","of","adversarial","attacks","against\nwireless","signal","classifiers,”","inIEEE","International","Conference","on","Com-\nmunications","(ICC),","2020.\n[26]","Y.","E.","Sagduyu,","Y.","Shi,","and","T.","Erpek,","“IoT","network","security","from\nthe","perspective","of","adversarial","deep","learning,”","inIEEE","International\nConference","on","Sensing,","Communication,","and","Networking,","2019.\n[27]","Y.","Shi,","T.","Erpek,","Y.","E.","Sagduyu,","and","J.","Li,","“Spectrum","datapoisoning\nwith","adversarial","deep","learning,”","inIEEE","Military","Communications\nConference","(MILCOM),","2018.\n[28]","Y.","E.","Sagduyu,","T.","Erpek,","and","Y.","Shi,","“Adversarial","deep","learning","for\nover-the-air","spectrum","poisoning","attacks,”IEEE","Transactions","on","Mobile\nComputing,","vol.","20,","no.","2,","pp.","306–319,","Oct.","2019.\n[29]","Z.","Luo,","S.","Zhao,","Z.","Lu,","J.","Xu,","and","Y.","Sagduyu,","“When","attackers\nmeet","AI:","Learning-empowered","attacks","in","cooperative","spectrum","sensing,”\nIEEE","Transactions","on","Mobile","Computing,","2020.\n[30]","Z.","Luo,","S.","Zhao,","Z.","Lu,","Y.","E.","Sagduyu,","and","J.","Xu,","“Adversarial","machine\nlearning","based","partial-model","attack","in","IoT,”","inACM","Workshop","on\nWireless","Security","and","Machine","Learning","(WiseML),","2020.\n[31]","Y.","Shi,","K.","Davaslioglu,","and","Y.","E.","Sagduyu,","“Over-the-air","membership\ninference","attacks","as","privacy","threats","for","deep","learning-based","wireless\nsignal","classifiers,”","inACM","WiSec","Workshop","on","Wireless","Security","and\nMachine","Learning","(WiseML),","2020.\n[32]","K.","Davaslioglu","and","Y.","E.","Sagduyu,","“Trojan","attacks","on","wireless","signal\nclassification","with","adversarial","machine","learning,”","inIEEE","DySPAN\nWorkshop","on","Data-Driven","Dynamic","Spectrum","Sharing,","2019.\n[33]","Y.","Shi,","K.","Davaslioglu,","and","Y.","E.","Sagduyu,","“Generative","adversarial\nnetwork","for","wireless","signal","spoofing,”","inACM","Workshop","on","Wireless\nSecurity","and","Machine","Learning","(WiseML),","2019.\n[34]","Y.","Shi,","K.","Davaslioglu,","and","Y.","E.","Sagduyu,","“Generative","adversarial\nnetwork","in","the","air:","Deep","adversarial","learning","for","wireless","signal","spoof-\ning,”IEEE","Transactions","on","Cognitive","Communications","and","Networking,\nvol.","7,","no.","1,","pp.","294–303,","Mar.","2021.\n[35]","Y.","E.","Sagduyu,","R.","Berry,","and","A.","Ephremides,","“Jamming","games","in\nwireless","networks","with","incomplete","information,”IEEE","Communications\nMagazine,","vol.","49,","no.","8,","pp.","112–118,","Aug.","2008.\n[36]","Y.","E.","Sagduyu,","R.","A.","Berry,","and","A.","Ephremides,","“Wirelessjamming\nattacks","under","dynamic","traffic","uncertainty,”","inInternational","Symposium\non","Modeling","and","Optimization","in","Mobile,","Ad","Hoc,","and","Wireless\nNetworks","(WiOpt),","2010.\n[37]","M.","Sadeghi","and","E.","G.","Larsson,","“Physical","adversarial","attacks","against","end-\nto-end","autoencoder","communication","systems,”IEEE","Communications\nLetters,","vol.","23,","no.","5,","pp.","847–850,","May","2019.\n[38]","B.","Manoj,","M.","Sadeghi,","and","E.","G.","Larsson,","“Adversarial","attacks","on","deep\nlearning","based","power","allocation","in","a","massive","mimo","network,”arXiv\npreprint","arXiv:2101.12090,","2021.\n[39]","C.","Zhong,","F.","Wang,","C.","Gursoy,","and","S.","Velipasalar,","“Adversarial","jamming\nattacks","on","deep","reinforcement","learning","based","dynamic","multichannel\naccess,”","inIEEE","Wireless","Communications","and","Networking","Conference\n(WCNC),","2020.\n[40]","F.","Wang,","C.","Zhong,","C.","Gursoy,","and","S.","Velipasalar,","“Defense","strategies\nagainst","adversarial","jamming","attacks","via","deep","reinforcement","learning,”\ninConference","on","Information","Sciences","and","Systems","(CISS),","2020.\n[41]","Y.","E.","Sagduyu,","T.","Erpek,","and","Y.","Shi,","“Adversarial","machine","learning","for\n5G","communications","security,”arXiv","preprint","arXiv:2101.02656,","2021.\n[42]","Y.","Shi,","Y.","E.","Sagduyu,","T.","Erpek,","and","C.","Gursoy,","“How","to","attack","and\ndefend","5g","radio","access","network","slicing","with","reinforcement","learning,”\narXiv","preprint","arXiv:2101.05768,","2021.\n[43]","Y.","Shi","and","Y.","E.","Sagduyu,","“Adversarial","machine","learningfor","flood-\ning","attacks","","on","5g","radio","access","network","slicing,”arXiv","preprint\narXiv:2101.08724,","2021.\n[44]","A.","Kurakin,","I.","Goodfellow,","and","S.","Bengio,","“Adversarialexamples","in","the\nphysical","world,”","inInternational","Conference","on","Learning","Representa-\ntions","(ICLR),","2017."],"doc14":["\n\narXiv:2103.13521v1","","[math.ST]","","24","Mar","2021\nConditions","and","Assumptions","for\nConstraint-based","Causal","Structure\nLearning\nKayvan","Sadeghi","and","Terry","Soo\nDepartment","of","Statistical","Science,","University","College","London\ne-mail:\nk.sadeghi@ucl.ac.uk;","e-mail:math@terrysoo.com\nAbstract:The","paper","formalizes","constraint-based","structure","learningof","the\n“true”","causal","graph","from","observed","data","when","unobserved","variables","are\nalso","existent.","We","define","a","“generic”","structure","learning","algorithm,","which\nprovides","conditions","that,","under","the","faithfulness","assumption,","the","output","of\nall","known","exact","algorithms","in","the","literature","must","satisfy,","and","which","outputs\ngraphs","that","are","Markov","equivalent","to","the","causal","graph.","More","importantly,\nwe","provide","clear","assumptions,","weaker","than","faithfulness,","under","which","the\nsame","generic","algorithm","outputs","Markov","equivalent","graphs","tothe","causal\ngraph.","We","provide","the","theory","for","the","general","class","of","models","under","the\nassumption","that","the","distribution","is","Markovian","to","the","true","causal","graph,\nand","we","specialize","the","definitions","and","results","for","structuralcausal","models.\nMSC2020","subject","classifications:Primary","62H22;","secondary","62A99.\nKeywords","","and","","phrases:causal","discovery,","compositional","graphoid,","di-\nrected","acyclic","graph,","faithfulness,","graphical","model","selection,","independence\nmodel,","structure","learning,","structural","causal","models.\n1.","Introduction\nInferring","causal","relationships","has","always","been","one","of","the","main","objectives","in","many\nfields","of","study,","ranging","from","philosophy","to","science","[\n14].","In","the","past","decades,\ncausal","models[\n23]","have","been","used","to","infer","causal","relationships","from","observed\ndata.","Extensive","research","has","been","conducted","on","defining,","interpreting,","and","ap-\nplying","causal","models,","and","these","models","have","become","mainstream","in","statistics\nand","computer","science","[\n22;32;10;13].","Today,","a","very","popular","method","for","inferring\ncausal","relationships","is","based","on","the","use","of","statistical","models","over","graphs","with\nnodes","that","are","random","variables","representing","the","quantities","of","interest.","Edges\nindicate","probabilistic","dependence","among","these","variables","conditionalon","some\nother","variables","in","the","graph,","which","with","some","additional","assumptionscan","be\ninterpreted","as","causal","relationships.","These","models","are","calledgraphical","(Markov)\nmodels[\n17].\nStructural","causal","models(SCMs),","also","known","asstructural","equation","models,\nare","one","of","the","most","used","causal","models","[\n32;22].","SCMs","have","been","generally\ndefined","for","directed","acyclic","graphs","(DAGs)","(i.e.,","a","Bayesian","network),","where","an\narrow","implies","a","“direct”","cause.","However,","for","the","purpose","of","causal","inference,\nit","may","not","be","possible","to","determine","or","measure","all","common","causes.","For","this\n1\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning2\nreason,","SCMs","associated","to","DAG","models","with","latent","variables","(represented","by\nancestral","graphs","[\n27]","without","undirected","edges)","have","been","defined","[32;42].\nA","main","goal","of","causal","inference","based","on","graphical","models","is","causaldis-\ncovery;","in","this","framework","we","are","concerned","with","finding","graphs,","using","only\nobserved","data,","that","represent","the","causal","structure,","which","is","represented","by","an\nunknown","“true”","causal","graph.","Algorithms","for","constructing","or","selecting","such","a\ngraph","are","known","asstructural","learningalgorithms.","There","has","been","a","surge","in\ndefining","different","structural","learning","algorithms;","they","are","generally","categorized\nas","constraint-based","[\n32],","score-based","[5]","–which","work","on","the","factorization","of\ndensity–,","or","a","combination","of","these","[\n36].\nWe","are","concerned","withconstraint-basedstructure","learning","algorithms","for","the\ngeneral","case","of","ancestral","graphs","without","undirected","edges.","These","algorithms\nuse","conditional","independence","statements,","which","are","theoreticallytestable","from\nobserved","data","to","find","graphs","that,","at","best,","are","Markov","equivalent","to","the","true\ncausal","graph.","A","main","sufficient","condition","for","the","algorithms","towork,","that","is,","to\nprovide","an","output","that","is","Markov","equivalent","to","the","causal","graph,","isfaithfulness\n[\n44;41;33;6];","this","sufficient","condition","relates","the","independencies","induced","by\nthe","distribution","(of","the","SCM)","and","the","separations","induced","by","the","causal","graph.\nHowever,","faithfulness","to","the","unknown","causal","graph,","or","similar","assumptions","[\n43],\nare","not","testable.","In","addition,","the","(sufficient)","assumption","of","faithfulness","is","in\nsome","circumstances","too","strong;","see","Section\n5.\nIn","this","paper,","we","formalize","the","problem","of","constraint-based","structure","learning\nfrom","observed","data.","We","define","a","generic","structure","learning","algorithm,","which\nnaturally","arises","from","the","assumption","of","faithfulness,","by","using","a","formalization","of\nfaithfulness,","provided","in","[\n30].","This","algorithm","is","high","level","in","the","sense","that","we\nprovide","conditions","that","the","output","of","all","known","exact","algorithms","in","the","literature\nmust","satisfy","under","the","assumption","of","faithfulness;","see","Algorithm\n5and","Remark\n10.","Under","the","same","assumption,","we","show","that","this","generic","algorithm","works.\nMore","importantly,","we","provide","clear","assumptions,","weaker","than","faithfulness,","under\nwhich","the","same","generic","algorithm","works.","We","provide","the","theory","for","the","general\nclass","of","models","under","the","assumption","that","the","distribution","is","Markovian","to\nthe","true","causal","graph;","see","Theorem\n18.","We","also","specialize","the","definitions","and\nresults","for","SCMs;","see","Theorem34.","We","hope","that","the","framework","provided","here\nwill","be","useful","theoretical","tool","in","defining","appropriate","SCMs","as","well","as","concrete\nalgorithms","with","strong","theoretical","backing.\nThe","structure","of","the","paper","is","as","follows:","In","the","next","section,","we","provide","known\ndefinitions","and","results","needed","for","the","theory","presented","in","this","paper.","In","Section\n3,","we","formalize","the","settings","of","the","problem.","Section4deals","with","the","theory\nunder","the","faithfulness","assumption.","In","Section5,","we","introduce","the","structure\nlearning","theory","without","the","faithfulness","assumption.","Section\n6specializes","on\ncausal","structure","learning","for","SCMs.","We","end","the","paper","with","a","summary","and\ndiscussion","in","Section\n7.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning3\n2.","Preliminaries\nIn","this","section,","we","provide","the","basic","definitions","and","concepts","as","wellas","the\nknown","results","needed","for","the","paper.\n2.1.","Graph","Theoretical","Definitions","and","Concepts\nWe","usually","refer","to","a","graph","as","an","ordered","pairG=","(V,E),","whereVis","thenode\nset","andEis","theedgeset.","When","nodesiandjare","the","endpoints","of","an","edge,\nwe","call","themadjacent,","and","writei∼j.","Graphs","in","this","paper","aresimple,","that\nis,","they","have","at","most","one","edge","between","a","pair","of","nodes.","We","considertwo","types\nof","edges:arrows(i\n≻j)","andarcs(i≺≻j).","We","do","not","consider","graphs","that\nhave","simultaneous","third","type","of","edge:lines(i\nj).","The","completely","undirected\ngraph,","obtained","from","a","graphG,","is","called","theskeletonofG,","denoted","by","sk(G);\nit","is","obtained","by","removing","all","arrowheads","from","the","edges","of","the","graphG.","We\nsay","that","wedirectthe","edges","of","a","skeleton","by","assigning","arrowheads","at","the","edges,\nwhich","results","in","a","graph.\nAsubgraphof","a","graphG\n1\nis","graphG\n2\nsuch","thatV(G\n2\n)⊆V(G\n1\n)","andE(G\n2\n)⊆\nE(G\n1\n)","and","the","assignment","of","endpoints","to","edges","inG\n2\nis","the","same","as","inG\n1\n.\nAninduced","subgraphby","nodesA⊆Vis","a","subgraph","that","contains","all","and","only\nnodes","inAand","all","edges","between","two","nodes","inA.\nAwalkis","a","listhv\n0\n,e\n1\n,v\n1\n,...,e\nk\n,v\nk\niof","nodes","and","edges","such","that","for","1≤i≤\nk,","the","edgee\ni\nhas","endpointsv\ni−1\nandv\ni\n.","Apathis","a","walk","with","no","repeated","node\nor","edge.","Acycleis","a","walk","with","no","repeated","nodes","or","edges","except","forv\n0\n=v\nk\n.\nWe","say","a","path","isbetweenthe","first","and","the","last","nodes","of","the","list","inG.","We\ncall","the","first","and","the","last","nodesendpointsof","the","path","and","all","other","nodesinner\nnodes.","A","path","can","also","be","seen","as","a","certain","type","of","connected","subgraph","ofG;","a\nsubpathof","a","pathπis","an","induced","connected","subgraph","ofπ.\nFor","an","arrowj\n≻i,","we","say","that","the","arrow","isfromjtoi.","We","also","callj\naparentofi,iachildofjand","we","use","the","notation","pa(i)","for","the","set","of","all\nparents","ofiin","the","graph.","In","the","cases","ofi\n≻jori≺≻jwe","say","that","there","is\nan","arrowhead","atjor","pointing","toj.","A","pathhi=i\n0\n,i\n1\n,...,i\nn\n=jiisdirected\nfromitojif","alli\nk\ni\nk+1\nedges","are","arrows","pointing","fromi\nk\ntoi\nk+1\n.","If","there","is","a\ndirected","path","fromjtoi,","then","nodejis","anancestorofiandiis","adescendant\nofj.","We","denote","the","set","of","ancestors","ofiby","an(i);","unlike","some","authors,","we","do\nnot","assume","thati∈an(i).\nAtripathis","a","path","with","three","nodes.","Note","that","[\n28]","used","the","term","V-\nconfiguration","for","such","a","path.","We","follow","[15]","and","most","texts","by","letting","aV-\nconfigurationbe","a","tripath","with","non-adjacent","endpoints.","The","inner","nodetin\neach","of","the","three","tripaths\ni\n≻t≺j,","i≺≻t≺j,","i≺≻t≺≻j\nis","acollider(or","a","collider","node)","and","the","inner","node","of","any","other","tripath","is","a\nnon-collider(or","a","non-collider","node)","on","the","tripath","or,","more","generally,","on","any\npath","of","which","the","tripath","is","a","subpath;","i.e.","a","node","is","a","collider","if","two","arrowheads\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning4\nmeet","or","an","arrowhead","meets","a","dash.","A","path","is","called","acolliderif","all","its","inner\nnodes","are","colliders.\nIn","this","paper","we","are","mainly","concerned","withdirected","ancestral","graphs;","these\nareancestral","graphs(AGs)","[\n27]","without","lines,","i.e.","graphs","with","arrows","and","arcs\nwithout","a","directed","cycle","and","without","an","arc","with","one","endpoint","being","anan-\ncestor","of","the","other.","Sometimes","we","simply","refer","to","such","graphs","as","“graphs,”\ndropping","any","modifiers.","Some","results","we","use","in","this","paper","have","originally","been\nproven","for","the","more","general","classes","of","chain","mixed","graphs","(CMGs)and","anterial\ngraphs","(AnGs)","[\n29]","as","well","as","acyclic","directed","mixed","graphs","(ADMGs)","[26],","all\nof","which","contain","ancestral","graphs","(and","consequently","directed","ancestral","graphs)\nas","a","special","case.\nThe","class","of","directed","ancestral","graphs","also","containsbidirected","graphs(BGs),\ncontaining","only","bidirected","edges,","anddirected","acyclic","graphs(DAGs),","containing\nonly","arrows","and","being","acyclic.","DAGs","have","been","particularly","useful","todescribe\ncausal","Markov","relations;","see","for","example","[\n15;22;19;11;32].","For","an","extensive","dis-\ncussion","on","the","subclasses","of","acyclic","graphs","and","their","relationships","and","hierarchy,\nsee","[18].\n2.2.","Independence","Models","and","Their","Properties\nAnindependence","modelJover","a","finite","setVis","a","set","of","tripleshX,Y|Zi,","called\nindependence","statements,","whereX,Y,","andZare","disjoint","subsets","ofV;Zmay","be\nempty,","buth∅,Y|ZiandhX,∅|Ziare","always","included","inJ.","The","independence\nstatementhX,Y|Ziis","read","as","“Xis","independent","ofYgivenZ”.","Independence\nmodels","may","have","a","probabilistic","interpretation,","but","this","is","not","necessarily","the\ncase.","Similarly,","not","all","independence","models","can","be","easily","represented","by","graphs.\nFor","further","discussion","on","general","independence","models,","see","[35].\nIn","order","to","define","probabilistic","independence","models,","consider","a","setVand\na","collection","of","random","variables{X\nα\n}\nα∈V\nwith","state","spacesX\nα\n,α∈Vand\njoint","distributionP.","We","letX\nA\n={X\nv\n}\nv∈A\nfor","each","subsetAofV.","For","disjoint\nsubsetsA,B,","andCofVwe","use","the","short","notationA⊥⊥B|Cto","denote","thatX\nA\nisconditionally","independent","ofX\nB\ngivenX\nC\n[\n8;17],","that","is,","for","any","measurable\nS⊆X\nA\nandP-almost","allx\nB\nandx\nC\n,","we","have\nP(X\nA\n∈S|X\nB\n=x\nB\n,X\nC\n=x\nC\n)","=P(X\nA\n∈S|X\nC\n=x\nC\n),\nwhere","we","make","suitable","interpretations","in","terms","of","regular","conditional","probabil-\nities","when","necessary;","see","for","example","[\n4].","We","can","now","induce","an","independence\nmodelJ(P)","by","letting\nhA,B|Ci∈J(P)⇐⇒A⊥⊥B|Cw.r.t.P.\nSimilarly","we","use","the","notationA6⊥⊥B|CforhA,B|Ci/∈","J(P).","In","this","paper\nwe","present","the","results","for","“P,”","but","in","fact","all","the","conditions","and","assumptions\nare","onJ(P).","We","remark","that","all","the","results","and","conditions","could","be","presented\nusing","an","abstract","independence","modelJ.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning5\nIn","order","to","use","graphs","to","represent","independence","models,","the","notion","ofsep-\narationin","a","graph","is","fundamental.","A","pathπisconnectinggivenCif","every\ncollider","node","ofπis","inCor","an","ancestor","of","a","node","inC,","and","every","non-collider\nnode","is","not","inC.","For","pairwise","disjoint","subsets","(A,B,C),","we","writeA⊥B|Cif\nthere","are","no","connecting","paths","betweenAandBgivenC,","and","say","thatAand\nBareseparated","givenC.","We","will","also","use","the","notationA6⊥B|CforAandB\nnot","separated","givenC.","This","separation","criterion","is","generally","known","as","them-\nseparation,","used","in","[\n27;39;40],","for","ancestral","graphs","and","summary","graphs,","and\nis","a","generalization","of","thed-separationof","[22].\nIfA,B,","orChas","only","one","member{i},{j},","or{k},","for","better","readability,\nwe","writehi,j|ki","∈","Jinstead","ofh{i},{j}|{k}i","∈","J;","and","similarly","fori⊥j|k\nandi⊥⊥j|k.","We","also","writeA⊥BwhenC=∅;","and","similarlyA⊥⊥B.\nA","graphGinduces","an","independence","modelJ(G)","by","separation,","letting\nhA,B|Ci∈J(G)⇐⇒A⊥B|CinG.\nA","graph","is","calledmaximalif","the","absence","of","an","edge","betweeniandjcorre-\nsponds","to","a","conditional","separation","statement","foriandj,","i.e.","there","exists","for\nsomeCa","statement","of","formi⊥j|C.","In","addition,","we","call","two","graphsGand\nHMarkov","equivalentifJ(G)","=J(H).","Conditions","for","Markov","equivalence","for\nmost","classes","of","graphs","are","known;","see","[\n38;1;40].","Notice","that","two","Markov","equiv-\nalent","maximal","graphs","have","the","same","skeleton.","We","require","conditionsfor","Markov\nequivalence","of","the","classes","of","graphs","discussed","here.","A","collider","pathπ=hi,B,ji\nis","called","aminimal","collider","pathifi≁jand","there","is","no","proper","subsetB\n′\n⊂B\nsuch","thathi,B\n′\n,jiis","a","collider","path","betweeniandj.\nLemma","1([\n45]).Two","maximal","ancestral","graphs","(and","consequently","maximal\ndirected","ancestral","graphs)","are","Markov","equivalent","if","and","only","if","they","have","the\nsame","skeletons","and","minimal","collider","paths.\nFor","DAGs,","there","is","a","simpler","condition","for","Markov","equivalence:\nLemma","2([\n38]).Two","DAGs","are","Markov","equivalent","if","and","only","if","they","have","the\nsame","skeletons","and","collider","V-configurations.\nAn","independence","modelJover","a","setVis","asemi-graphoidif","it","satisfies","the\nfour","following","properties","for","disjoint","subsetsA,B,C,","andDofV:\n1.hA,B|Ci∈Jif","and","only","ifhB,A|Ci∈J(symmetry);\n2.","ifhA,B∪D|Ci","∈","J,","thenhA,B|Ci","∈","JandhA,D|Ci","∈","J(decompo-\nsition);\n3.","ifhA,B∪D|Ci","∈","J,","thenhA,B|C∪Di","∈","JandhA,D|C∪Bi","∈","J\n(weak","union);\n4.","ifhA,B|C∪Di","∈","JandhA,D|Ci","∈","J,","thenhA,B∪D|Ci","∈","J(con-\ntraction).\nNotice","that","the","reverse","implication","of","contraction","clearly","holds","by","decomposition\nand","weak","union.","A","semi-graphoid","for","which","the","reverse","implication","of","the","weak\nunion","property","holds","is","said","to","be","agraphoid;","that","is,","it","also","satisfies\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning6\n5.","ifhA,B|C∪Di","∈","JandhA,D|C∪Bi","∈","J,","thenhA,B∪D|Ci","∈","J\n(intersection).\nFurthermore,","a","graphoid","or","semi-graphoid","for","which","the","reverse","implication","of\nthe","decomposition","property","holds","is","said","to","becompositional,","that","is,","it","also\nsatisfies\n6.","ifhA,B|Ci","∈","JandhA,D|Ci","∈","J,","thenhA,B∪D|Ci","∈","J(composi-\ntion).\nAnother","important","property","of","independence","models","issingleton-transitivity\n(also","calledweak","transitivityin","[\n22]).","Fori,j,","andk,","single","elements","inV,\n7.","ifhi,j|Ci∈Jandhi,j|C∪{k}i∈J,","thenhi,k|Ci∈Jorhj,k|Ci∈J\n(singleton-transitivity).\nProbabilistic","independence","models","are","always","semi-graphoids","[\n22],","whereas\nthe","converse","is","not","necessarily","true;","see","[\n34].","IfPhas","strictly","positive","den-\nsity,","the","induced","independence","model","is","always","a","graphoid;","see,","forexample,\nProposition","3.1","in","[17].","See","also","[24]","for","a","necessary","and","sufficient","condition\nfor","the","intersection","property","to","hold.","If","the","distributionPis","a","regular","multi-\nvariate","Gaussian","distribution,","thenJ(P)","is","a","singleton-transitive","compositional\ngraphoid;","for","example","see","[\n35;22].","For","this","reason,","a","different","axiomatization","of\nsingleton-transitive","compositional","graphoid","is","called","aGaussoidin","[20].","On","the\nother","hand,","separation","in","graphs","satisfies","all","these","properties;","see","Propositions\n1","and","2","in","[\n30].","IfJ(P)","satisfies","any","of","these","properties,","then","we","may","simply\nsay","that","“P","satisfies","that","property”.\n2.3.","Ordered","Upward-","and","Downward-stabilities\nThe","definitions","and","results","below","are","a","special","case","of","those","in","Section","4","of","[\n30].\nConsider","apartial","order≤over","the","setV.","Ifa≤borb≤a,","thenaandbare\ncomparable;","otherwise","they","areincomparable.","Henceforth,","we","speak","of","“orders”\nreferring","to","“partial","orders”.\nWe","say","that","a","graphG=","(V,E)","admits","avalid","order≤if","for","nodesiandjof\nG,i\n≻jimplies","thati",">","j;","andi≺≻jimplies","thatiandjare","incomparable.\nThere","may","be","many","different","orders","that","are","valid","for","a","graph.","However,","we\nobtain","a","unique","ordering","for","a","graph","as","follows:","Given","a","graphG,","ifi","/∈an(j)\nandj","/∈an(i)","then","setiandjto","be","incomparable.","Otherwise,","leti",">","jwhen\ni\n≻j.","We","call","this","ordering","theminimal","orderforGsince","it","gives","the","fewest\npossible","comparable","pairs","of","nodes.","It","can","also","be","seen","that","ifGis","ancestral,\nthen","the","minimal","order","forGis","a","valid","order.\nWe","now","exploit","the","ordering","for","independence","models","in","order","to","define\ntwo","other","properties","in","addition","to","the","seven","properties","defined","in","Section\n2.2\n(namely","singleton-transitive","compositional","graphoid","axioms).","We","say","that","an\nindependence","modelJover","the","setVrespectively","satisfiesordered","upward-and\ndownward-stabilityw.r.t.","an","order≤ofVif","the","following","hold:\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning7\n8.","ifhi,j|Ci∈J,","thenhi,j|C∪{k}i∈Jfor","everyk∈V\\{i,j}such","that\ni","<","korj","<","k(ordered","upward-stability);\n9.","ifhi,j|Ci∈J,","thenhi,j|C\\{k}i∈Jfor","everyk∈V\\{i,j}such","that\ni≮k,j≮k,","andl≮kfor","everyl∈C\\{k}(ordered","downward-stability).\nIt","was","shown","in","[\n30]","that","the","independence","model","induced","by","ancestral","graphs\nsatisfies","ordered","upward-","and","downward-stability","w.r.t.","their","minimal","order.\nIf","an","independence","modelJsatisfies","ordered","upward-","and","downward-stability\nw.r.t.","the","minimal","order","of","a","graphG,","we","simply","say","that","“Jsatisfies","upward-\nand","downward-stability","w.r.t.G”.","In","addition,","similar","to","compositional","graphoids,\nifJ(P)","satisfies","ordered","upward-","or","downward-stability,","then","we","may","simply\nsay","that","“P","satisfies","that","property.”\n2.4.","Markov","and","Faithful","Independence","Models\nFor","a","graphG=","(V,E),","a","probability","distribution","defined","overVsatisfies","the\nglobal","Markov","propertyw.r.t.G,","or","is","simplyMarkoviantoG,","if","for","disjoint\nsubsetsA,B,","andCofVit","holds","that\nA⊥B|C=⇒A⊥⊥B|C,\nor","equivalentlyJ(G)⊆","J(P).","Notice","that","every","probability","distribution","over\nVis","Markovian","to","the","complete","graph","with","the","node","setV.\nWe","say","thatPand","a","graphGare","faithful","ifJ(P)","=J(G).","IfPandG\nare","faithful,","then","we","may","sometimes","also","say","thatPisfaithful","toGor","vice\nversa,","although","in","principle","faithfulness","is","a","symmetric","relation.","Thus,","ifPand\nGare","faithful,","then","in","addition","toPbeing","Markovian","toG,","every","conditional\nindependence","statement","corresponds","to","a","separation","inG.","Notice","that,","originally\nin","[\n32],","faithfulness","was","defined","only","to","be","the","opposite","direction","to","the","Markov\nproperty.","If","there","is","a","graph","that","is","faithful","toP,","then","we","say","thatPisgraphical.\nFor","a","given","probability","distributionP,","we","define","theskeletonofP,","denoted\nby","sk(P),","to","be","the","undirected","graph","that","is","obtained","fromPas","follows:","we\ndefine","the","node","set","of","sk(P)","to","beV,","and","for","every","pair","of","nodesi,j,","we","check\nwhetheri⊥⊥j|Cholds","for","someC⊆V\\{i,j};","if","it","does","not","then","we","draw\nan","edge","betweeniandj.","The","resulting","undirected","graph","is","the","same","the","one\nobtained","by","first","step","of","the","SGS","algorithm","[\n12].\nSuppose","that","there","exists","an","order≤overV.","We","can","uniquely","direct","the\nedges","of","sk(P)","based","on≤in","order","to","define","aG(P,≤)","induced","byPand≤.","It\ncan","be","seen","thatG(P,≤)","is","ancestral.\nWe","are","only","interested","in","orderings","that","are","minimal","orders","of","graphs.","Given\nP,","we","define","an","ordering≤to","beP-compatibleif≤is","the","minimal","order","for\nG(P,≤).\nIfPis","Markovian","to","a","graphG,","then","sk(P)","is","a","subgraph","of","sk(G);","see\n[\n30].","Hence,","ifPis","Markovian","to","a","graphGsuch","that","sk(G)","=","sk(P),","then\nGhas","the","fewest","number","of","edges","among","those","to","whichPis","Markovian.","We\nsay","thatPisminimally","Markovianto","a","graphGifPis","Markovian","toGand\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning8\nsk(G)","=","sk(P).","Notice","that","this","definition","is","subtly","different","from","the(causal)\nminimality","assumption[\n23;32;44;21],","which","holds","ifPis","Markovian","toG,\nbut","not","to","any","proper","subgraph","ofG—","in","fact,","it","can","be","seen","that","being\nminimal","Markovian","implies","causal","minimality.","Notice","also","that","only","minimally\nMarkovian","independence","models","to","a","graph","can","also","be","faithful","to","the","graph.\nWe","make","use","of","the","necessary","and","sufficient","conditions","for","faithfulness,","proved\nin","[\n30],","for","the","more","general","case","of","anterial","graphs:\nProposition","3([30]).LetPbe","an","probability","distribution","defined","overX\nV\n.\nThenPis","graphical","if","and","only","if\n(A)Pis","a","singleton-transitive","compositional","graphoid;","and\n(B)","there","exists","aP-compatible","order.overVw.r.t.","whichPsatisfies","ordered\ndownward-","and","upward-stability.\nIn","addition,","if(\nA)and(B)are","satisfied,","thenPis","faithful","toG(P,.).\n2.5.","Structural","Causal","Models\nHere","we","define","thestructural","causal","models(SCMs)","(also","known","as","thestructural\nequation","models(SEMs))","[\n23;32]","for","the","class","of","directed","ancestral","graphs,","as\nintroduced","in","[\n27].","Consider","a","graphGwithNnodes,","which","in","the","context\nof","causal","inference","may","be","referred","to","as","the","“true","causal","graph”.","An","SCMC\nassociated","withGis","defined","as","a","collection","ofNequations\nX\ni\n=φ\ni\n(X\npa(i)\n,ǫ\ni\n),","i∈{1,...,N},(1)\nwhere","pa(i)","is","defined","onG,","and,","for","any","subsetsAandB,","we","require","that\nǫ\nA\n⊥⊥ǫ\nB\nif","and","only","if,","inG,","there","is","no","arc","between","any","node","inAand","any","node\ninB.","Notice","that","in","the","more","widely-used","case","whereGis","a","DAG,","allǫ\ni\nare\njointly","independent.","Sometimes","theX\ni\nare","calledendogenous","variablesand","the\nnoisesǫ\ni\nare","also","calledexogenous","variables(which","are","generally","assumed","to\nbe","latent).","For","both","mathematical","and","causal","discussions","on","SCMswith","DAGs,\nsee","[\n25].","In","the","case","whereφ\ni\nrepresent","multivariate","linear","regressions,","SCMs\nare","also","known","as","the","system","of","linear","equations","[\n7].\nNotice","that","the","minimal","order","ofGinduces","an","order","forX\ni\ns","inC.","In","addition,\nby","using","the","equations","iteratively,","it","is","easy","to","see","that","eachX\ni\ncan","be","written\nas","a","function","ofǫ\nan(i)∪{i}\n.","An","SCM","also","entails","a","unique","joint","distributionP\nover","the","variables","(X\n1\n,...,X\nN\n).\nA","more","complete","representation","of","the","graph","associated","with","an","SCM","is","ob-\ntained","by","including","the","random","variablesǫ\ni\n.","These","graphs,","calledaugmented\ngraphsand","denoted","byG(X,ǫ).","We","construct","the","augmented","graph","in","our","set-\nting","as","follows:","we","denote","the","nodes","inGby","the","original","notation{X\n1\n,...,X\nN\n};\nwe","add","the","nodes{ǫ\n1\n,...,ǫ\nN\n}and","add","arrows","from","eachǫ\ni\ntoX\ni\n;","we","also","re-\nmove","all","arcs","betweenX\ni\ns,","and","instead","of","everyX\ni\nX\nj\n-arc,","add","an","arc","between\nǫ\ni\nandǫ\nj\n.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning9\nFor","example,","in","Figure1,","the","graph","in","(b)","is","the","augmented","graph","of","the\ngraph","in","(a).","An","SCM","associated","to","these","graphs,","in","whichφ\ni\nare","linear","is","as\nfollows:\nX\n4\n=ǫ\n4\n,","X\n3\n=ǫ\n3\n,","X\n2\n=αX\n4\n+ǫ\n2\n,","X\n1\n=βX\n3\n+ǫ\n1\n.\n3\n12\n4\nX\n3\nX\n1\nX\n2\nX\n4\nǫ\n3\nǫ\n1\nǫ\n2\nǫ\n4\nFig","1.","A","graphG(left)","and","its","augmented","graphG(X,","ǫ)(right).\nThe","above","setting","and","construction","of","the","augmented","graph","is","in","linewith\nthe","idea","originally","presented","in","[\n27]","for","linear","functions","and","Gaussian","distri-\nbutions,","although","unlike","in","the","mentioned","manuscript,","noises","corresponding","to\nendpoints","of","variables","adjacent","by","an","arc","arerequiredto","be","dependent.","This\nsetting","is","different","from","the","dominant","setting","in","the","literature","(e.g.","[\n25])","for","di-\nrected","ancestral","graphs,","where","for","every","arcX\ni\nX\nj\nit","is","assumed","that","there","exists\nan","exogenous","variableǫ\nij\n,","where,","in","the","directed","acyclic","augmented","graph,","it\npoints","to","bothX\ni\nandX\nj\n,","and","thatǫ\nij\ns","are","mutually","independent.\nRemark","4.Our","setting","is","more","general","than","the","other","alternative","presented\nhere.","Notice","that","we","can","write","a","noiseǫ\ni\nas","a","tuple(ǫ\nis\n)\ns∈S\n,","whereSis","the","set\nof","nodes","connected","toiby","an","arc.","However,","by","writingǫ\nij\n=","(ǫ\ni\n,ǫ\nj\n),","we","would\nnot","obtain","independent","noises","in","the","other","setting.\n3.","General","Setting","for","Structure","Learning\nWe","start","by","assuming","the","existence","of","anunknowndistributionP,","which","is\nMarkovian","to","an","unknown(true)","causal","graphG\n0\n.","Indeed,","this","setting","being\nconsidered","“causal”","requires","additional","models","and","assumptions,","which","stem\nfrom","the","identicality","of","conditioning","by","intervention","and","observation.","For","more\ndiscussion","on","this,","see","[\n23;32;25].","Nevertheless,","the","setting","presented","here","is\nwhat","is","required","for","causal","discovery","using","conditional","independence","under","any\ncausal","model.\nThe","main","goal","of","structure","learning","is","to","use","observational","data","tofind","a","graph\nthat","belongs","to","the","Markov","equivalence","class","ofG\n0\n.","The","distributionPinduces\nan","independence","modelJ(P)","whose","elements","we","can","test","for","using","the","observed\ndata.","Although","we","can,","in","principle,","test","each","statement","inJ(P),","testing","for","all\nindependence","statements","is","computationally","intractable.","In","a","constraint-based\nstructural","learning","algorithm,","one","uses","some","of","the","independencestatements","in\nJ(P)","to","construct","a","graph,","which","is","(hopefully)","in","the","Markov","equivalence","class\nofG\n0\n.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning10\nIndeed","the","exact","relationship","betweenP(or","more","specificallyJ(P))","and","the\nconstructed","graph","depends","on","the","specific","algorithm","used.","Here,we","propose","a\n“generic”","algorithm","to","construct","such","a","graph","and","denote","it","byG(P).","We","use\nthe","term","“generic”","to","hint","that","this","proposed","algorithm","is","high","level","inthe","sense\nthat","it","does","not","provide","details","of","how","to","implement","its","steps,","but","rather","we\nprovide","conditions","that","if","the","output","of","all","such","detailed","algorithms","satisfy,","then\nthey","are","Markov","equivalent","toG\n0\n.\nAlgorithm","5(Generic","algorithm).The","generic","constraint-basedstructure","learn-\ning","algorithmis","an","algorithm","with","outputG(P),","which","contains","the","following\ntwo","stages:\nStage","1Edges","from","a","complete","undirected","graph","are","removed","when","there","is","an\nindependence","statement","between","the","endpoints","of","that","edge.This","ensures\nthatsk(P)","=","sk(G(P)).\nStage","2Edges","ofsk(P)are","directed","so","thatPsatisfies","ordered","downward-","and\nupward-stability","w.r.t.","the","output,","i.e.G(P)","=G(J(P),≤),","for","an≤,\nw.r.t.","whichPsatisfies","ordered","downward-","and","upward-stability.\nIn","short,","the","diagram","below","shows","the","relationship","between","the","concepts","used\nin","this","setting:\nG\n0\nMarkovian\nL99P\nconditional","independence\n→J(P)\nAlgorithm\n→G(P)\nMarkov","equivalent\n∼G\n0\nWe,","in","the","same","fashion","as","all","constraint-based","structural","learning","algorithms,\ndefine","the","first","stage","of","thestructure-learning","algorithmto","be","sk(P).","Under","the\nfaithfulness","assumption","ofPandG\n0\n,","we","will","show","in","Section\n4that","not","only\nisG(P)","Markov","equivalent","toG\n0\n,","but","alsoPsatisfies","ordered","downward-","and\nupward-stability","w.r.t.","every","graph","Markov","equivalent","toG\n0\n.","Under","weaker\nconditions,","provided","in","Section\n5,","we","show","that","the","outputG(P)","is","Markov\nequivalent","toG\n0\n.\nThe","algorithms","in","the","literature,","generally","generate","a","completed","partially\ndirected","acyclic","graph","(CPDAGs)","[\n2;32]","or","partial","ancestral","graphs","(PAGs)\n[\n27;1],","which","are","a","representative","of","the","Markov","equivalent","class","ofG\n0\nwith\nthe","fewest","arrowheads.","Here,","we","are","not","concerned","with","making","aCPDAG","or","a\nPAG","fromG(P).\nWe","assume,","without","loss","of","generality,","that","the","causal","graphG\n0\nis","maximal:\nthe","reason","is","that","ifG\n0\nis","not","maximal,","then","there","is","always","a","maximal","graph\nthat","is","Markov","equivalent","toG\n0\n,","which","could","be","used","to","find","graphs","Markov\nequivalent","toG\n0\n;","see","[\n27;31].","Note","that","the","first","stage","of","the","structure","learning\nalgorithm","also","ensures","that","the","generatedG(P)","is","maximal.\nSince","Markov","equivalent","maximal","graphs","have","the","same","skeleton,","the","ob-\ntainedG(P)","must","have","the","same","skeleton","withG\n0\n.","We","are","looking","for","condi-\ntions,","under","which","this","holds.\nLet","an(i,j)","=","(an(i)∪an(j))\\{i,j}.","We","say","thatPisconverse","pairwise\nMarkoviantoG\n0\nif\ni⊥⊥j|an(i,j)⇒i≁jinG\n0\n;(2)\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning11\nnote","that","the","converse","of","this","condition","is","the","well-known","pairwise","Markov\nproperty","[\n17].","To","ensure","the","equality","of","the","mentioned","skeletons,","we","need","the\nfollowing","lemma:\nLemma","6.Suppose","that","the","distributionPis","Markovian","toG\n0\n,","and","that","the\nfollowing","to","conditions","are","satisfied:\n(a)Pis","converse","pairwise","Markovian","toG\n0\n;\n(b)","if","there","existsC,","not","containingiandj,","such","thati⊥⊥j|C,","theni⊥⊥j|an(i,j).\nThensk(G\n0\n)","=","sk(G(P)).\nProof.We","have","onG\n0\nthe","equivalence\ni≁jinG\n0\n⇐⇒i⊥⊥j|an(i,j),\nwhere","assumption","(a)","gives","the","reverse","direction,","and","the","forward","direction\nfollows","from","the","fact","thatPis","Markovian","toG\n0\n,","and","an(i,j)","always","separates\nnon-adjacentiandj.","Since","sk(P)","=","sk(G(P)),","we","have","the","equivalence\ni≁jinG(P)⇐⇒","∃Cs.t.i⊥⊥j|C.\nHence,","assumption","(\nb)","allows","us","to","tie","these","two","conditions","together","and","obtain\ni≁jinG(P)⇐⇒i≁jinG\n0\n.\nWe","need","some","additional","assumptions","on","the","distributions","to","determine","when\nthe","assumptions","of","Lemma6hold;","i.e.","when","existing","an","edge","implies","dependence\ngiven","the","joint","ancestors,","and","when","an","arbitrary","conditional","independence","of","a\npair","implies","their","conditional","independence","given","their","joint","ancestors.","A","con-\ndition","under","which","these","assumptions","hold","is","faithfulness,","as","will","be","discussed\nin","the","next","section.","However,","weaker","conditions","will","be","provided","in","Section\n5.\nSpecific","conditions","for","SCMs","will","also","be","provided","in","Section6.\n4.","Structure","Learning","under","Faithfulness\nFaithfulness","ofPandG\n0\nis","a","main","assumption","in","the","literature","for","structure\nlearning.","It","is","well-known","that","under","faithfulness,PisDAG-identifiable,","i.e.,","a\nDAG","(or","the","CPDAG)","Markov","equivalent","toG\n0\ncan","be","identified","[\n32].","Under\nfaithfulness,","ifPis","faithful","toG\n0\n,","then","the","structure","learning","algorithm","should\nprovide","aG(P)","that","is","faithful","toP.\nBy","Proposition\n3,","if","the","assumption","ofPbeing","graphical","holds,","thenP\nis","singleton-transitive","compositional","graphoid","and","there","is","an","ordering≤of\nthe","nodes","of","sk(P)","w.r.t.","whichPsatisfies","ordered","downward-","and","upward-\nstability.","Notice","that","among","all","these","conditions","required","for","graphicality,","or-\ndered","downward-","and","upward-stability","are","the","only","ones","that","are","related","to,\nand","in","fact","determine,","the","direction","of","the","edges","of","sk(P);","these","considerations\nmotivate","the","second","stage","of","Algorithm\n5.\nWe","work","towards","a","proof","that","under","faithfulness,","the","structurelearning","al-\ngorithm","works.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning12\nProposition","7.Suppose","thatPis","faithful","toG\n0\n.","The","output","of","the","structure\nlearning","algorithm","satisfiessk(G\n0\n)","=","sk(G(P)).\nProof.We","show","that","the","conditions","of","Lemma\n6hold.\n(a)","Ifi⊥⊥j|an(i,j),","then","faithfulness","gives,i⊥j|an(i,j)","inG\n0\n,","which","implies\nthati≁jinG\n0\n.\n(b)","If","there","exists","aCsuch","thati⊥⊥j|C,","then","faithfulness","gives,i⊥j|CinG\n0\n,\nwhich","implies","thati≁jinG\n0\n.","SincePis","Markovian","toG\n0\n,","we","have","that\ni⊥⊥j|an(i,j).\nProposition","8.Suppose","thatPis","faithful","toG\n0\n.","All","potential","outputs","of","the\nstructure","learning","algorithm","are","Markov","equivalent,","and","they","are","Markov","equiv-\nalent","toG\n0\n.\nProof.SincePis","graphical,","by","Proposition\n3,","it","is","singleton-transitive","com-\npositional","graphoid.","LetG(P)","andH(P)","be","two","potential","graphs","generated\nby","the","structure","learning","algorithm.","By","Proposition\n7,","we","have","that","sk(G\n0\n)","=\nsk(G(P))","=","sk(H(P)).\nIn","addition,Psatisfies","ordered","upward-","and","downward-stability","w.r.t.","both\nG(P)","andH(P).","Hence,","again","by","Proposition\n3,Pis","faithful","to","both.","Therefore,\nthese","graphs","are","all","Markov","equivalent.\nIn","addition,","the","other","direction","of","the","above","result","also","holds:\nProposition","9.Suppose","thatPis","faithful","toG\n0\n.","IfGis","Markov","equivalent","to\nG\n0\n,","thenPsatisfies","ordered","upward-","and","downward-stability","w.r.t.G.\nProof.The","graphGandPhave","to","be","faithful.","Therefore,","by","Proposition\n3,","we\nknow","thatPsatisfies","ordered","upward-","and","downward-stability","w.r.t.G.\nRemark","10.Therefore,","ordered","downward-","and","upward-stability","w.r.t.G(P)\nare","also","necessary","conditions","of","an","output","of","a","structure","learning","algorithm\nthat","generates","Markov","equivalent","graphs","toG\n0\n.","This","justifies","our","definition","of\nthe","structure","learning","algorithm","whenPis","graphical.","Hence,","any","“exact”","(as\nopposed","to","approximate)","constraint-based","algorithms","thatwork","under","the","as-\nsumption","of","faithfulness","(such","as","the","SGS","and","PC","algorithms","[\n32])","must","(and,\nin","fact,","do)","ensure","that,","w.r.t.","their","output,Psatisfies","ordered","downward-","and\nupward-stability.\n5.","Conditions","and","Assumptions","for","the","Structure","Learning\nAlgorithm\nAs","discussed,","the","goal","is","that","the","outputG(P)","of","the","structure","learning","algo-\nrithm","to","be","Markov","equivalent","to","(the","unknown)","graphG\n0\n.","In","the","previous\nsubsection,","we","saw","that,","under","the","assumption","of","faithfulness","ofPandG\n0\n,","this\nis","true.","However,","in","fact,","faithfulness","is","too","strong","and","not","necessary","for","this\ngoal,","as","will","be","shown","below","in","Example\n11;","see","also","Example15for","when","one\nfocuses","solely","on","the","class","of","DAGs.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning13\nExample","11(Ordered","stability","and","faithfulness).Consider","the","graph","in","Figure\n2,","and","assume","that","it","isG\n0\nin","the","setting","of","this","manuscript.","LetJ(P)be","the\nset","of","statements","implied","by","the","global","Markov","property","plusi⊥⊥j|k.","First","of\nall,","notice","thatPdoes","not","satisfy","singleton-transitivity.","Notice","also","thatPis\nminimally","Markovian","toG\n0\n,","butPandG\n0\nare","not","faithful.","In","addition,P\nsatisfies","ordered","upward-","and","downward-stability","w.r.t.G\n0\n.\nHowever,","all","graphs,","including","the","true","causal","graphG\n0\n,","w.r.t.","whichPsatis-\nfies","ordered","downward-","and","upward-stability","are","Markov","equivalent.","To","see","this,\nsuppose","that","there","is","a","graphHwith","the","same","skeleton,","w.r.t.","whichPsatisfies\nordered","upward-","and","downward-stability,","and","thatHis","not","Markov","equivalent\ntoG\n0\n.","If,","inH,kis","non-collider","thenk",">","ℓork",">","i,","which,","by","ordered","upward-\nstability,","impliesi⊥⊥ℓ|k;","but","this","is","not","inJ(P).","Now,","if","inH,","the","nodeℓ\nis","collider,","thenk,j",">","ℓ,","which","by","ordered","downward-stability","and","conditional\nindependencek⊥⊥j|ℓ,","impliesk⊥⊥j,","which","is","again","not","inJ(P).\ni\nkℓ\nj\nFig","2.G\n0\nBelow,","we","find","conditions","weaker","than","the","faithfulness","assumption","under\nwhich","the","structure-learning","algorithm","works.\n5.1.","Equivalence","of","Skeletons","ofG\n0\nandG(P)\nWe","first","need","to","provide","assumptions","so","thatG\n0\nandG(P)","have","the","same\nskeletons.","One","of","the","main","assumption","we","employ","is","thatPsatisfies","ordered\ndownward-","and","upward-stability","w.r.t.G\n0\n.\nTheorem","12.Consider","a","distributionPthat","is","Markovian","toG\n0\nsatisfying","the\nfollowing","conditions:\n(i)Pis","converse","pairwise","Markovian","toG\n0\n;\n(ii)Psatisfies","ordered","upward-","and","downward-stability","w.r.t.G\n0\n.\nThensk(G\n0\n)","=","sk(G(P)).\nProof.It","suffices","to","show","that","assumption","(\nb)","of","Lemma6is","satisfied.","Sup-\nposei⊥⊥j|C.","Consider","all","the","nodes","inC\\an(i,j).","SincePsatisfies","ordered\ndownward-stability","w.r.t.G\n0\n,","one","can","remove","the","nodek\n0\nwith","a","lowest","order","in\nthis","set","to","obtaini⊥⊥j|C\\{k\n0\n}.","Inductively,","we","will","obtaini⊥⊥j|C∩an(i,j).\nNow,","by","the","use","of","ordered","upward-stability,","we","add","other","nodes","inan(i,j)","to\nthe","conditioning","set,","and","obtaini⊥⊥j|an(i,j).\nCorollary","13.Consider","a","distributionPthat","satisfies","the","conditions","of","Theo-\nrem\n12.","ThenPis","minimally","Markovian","toG\n0\n.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning14\nNotice","again","that","minimality","[30],","which","is","used","here","with","this","exact","defi-\nnition,","is","slightly","different","from","the","well-known","causal","minimality","assumption\n[\n23].\n5.2.","Markov","equivalence","ofG(P)andG\n0\nIn","this","section,","we","will","describe","under","what","additional","testable","conditionsG\n0\nandG(P)","are","Markov","equivalent.","We","provide","the","conditions","and","results","bothfor\nthe","case","whereG\n0\nis","a","DAG","and","the","structure","learning","algorithm","only","generates\nDAGs,","and","also","for","the","general","case","whereG\n0\nis","a","directed","ancestral","graph","and\nthe","structure","learning","algorithm","generates","such","graphs.\nWe","formalize","the","problem","using","the","following","concept:","We","say","that","a","distri-\nbutionPsatisfies","theuniqueness","property(up","to","Markov","equivalence)","when","the\nfollowing","holds:","ifPsatisfies","ordered","upward-","and","downward-stability","w.r.t.","each\nmaximal","graph","with","skeleton","sk(P),","then","they","are","Markov","equivalent.","For","the\nspecial","case","of","DAGs,","we","say","that","a","distributionPsatisfies","theDAG-uniqueness\npropertyif","the","graphs","concerned","in","the","definition","of","the","uniqueness","property","are\nrestricted","to","DAGs.\nThe","distributionPsatisfying","the","uniqueness","property","is","equivalent","to","the","po-\ntential","outputs","of","the","structure","learning","algorithm","being","unique","upto","Markov\nequivalence.","This","is","an","obvious","requirement","of","the","structure","learning","algorithm\nso","that","the","algorithm","cannot","generate","two","graphs","that","are","not","Markov","equiva-\nlent.\nIn","order","to","ensure","that","the","output","of","the","algorithm","is","correct,","weneed","the\nfollowing","important","lemma:\nLemma","14.Consider","a","distributionPthat","is","Markovian","toG\n0\n.","Suppose","that\nthe","conditions","of","Theorem\n12are","satisfied;","that","is,Pis","converse","pairwise","Marko-\nvian","toG\n0\nandPsatisfies","ordered","upward-","and","downward-stability","w.r.t.G\n0\n.\n(a)","IfPsatisfies","the","uniqueness","property,","then","the","outputG(P)is","Markov","equiv-\nalent","toG\n0\n.\n(b)","IfG\n0\nis","a","DAG,","thenPsatisfying","the","DAG-uniqueness","property","implies\nthat","the","DAG","outputG(P)is","Markov","equivalent","toG\n0\n.\nProof.The","proof","follows","from","Theorem\n12.\nIn","what","follows,","we","provide","and","study","explicit","conditions","under","which","the\nuniqueness","property","is","satisfied.\nBy","Corollary\n13,","we","know","that,","under","the","assumptions","forP,","which","we","have\nso","far","utilized,Pis","minimally","Markovian","toG\n0\n.","In","Example15,","we","observe","that,\nif","we","replace","the","faithfulness","assumption","with","the","assumption","of","being","minimal\nMarkovian,","then","the","uniqueness","property","no","longer","holds.\nExample","15.LetJ(P)","={1⊥⊥4|{2,3},1⊥⊥4|3,2⊥⊥3|4}.","For","example,","there\nis","an","SCM","that","induces","such","an","independence","model:","Letǫ\n1\n,ǫ\n2\n,ǫ\n3\n,","andǫ\n4\nbe","i.i.d.\nDefine\nX\n1\n=","max(X\n2\n,X\n3\n,ǫ\n1\n);X\n2\n=","max(X\n4\n,ǫ\n2\n);X\n3\n=","max(2X\n4\n,ǫ\n3\n);X\n4\n=ǫ\n4\n.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning15\nIt","can","be","seen","that(X\ni\n)\ni∈{1,...,4}\ninducesJ(P).\nFirst","notice","thatPdoes","not","satisfy","the","uniqueness","property:","w.r.t.","both","graphs\nG\n1\nandG\n2\nin","Figure\n3(b)","and3(c),J(P)satisfies","ordered","upward-","and","downward-\nstability.","However,","these","two","graphs","are","not","Markov","equivalent.\nSincePsatisfies","the","compositional","graphoid","axioms","(but","not","singleton-transitivity),\nthis","also","shows","that","compositional","graphoid","plus","ordered","upward-","and","downward-\nstability","are","not","in","general","sufficient","for","the","uniqueness","property","to","hold.\nHowever,","if","we","assume","that","the","structure","learning","algorithmis","only","DAG-\ngenerating,","then","there","is","a","unique","graph","w.r.t.","whichPsatisfies","ordered","upward-\nand","downward-stability","(and","consequently","the","DAG-uniqueness","property","holds).\n43\n21\n43\n21\n43\n21\n(a)(b)(c)\nFig","3.","(a)","The","skeleton","ofPwith","no","arrows.","(b)","A","DAGG\n1\n.","(c)","A","graphG\n2\nwith","arcs.\nFrom","Example\n11,","we","see","that","singleton-transitivity","is","not","necessary","for","the\nuniqueness","property.","We","provide","a","(weaker)","condition,","which","together","with","as-\nsumptions","of","Theorem\n12,","are","still","sufficient","for","uniqueness.\nWe","say","that","an","independence","modelJispath-unstableif","for","every","path\nhi=i\n0\n,i\n1\n,···,i\nr\n,k,ji\nin","sk(P)","satisfyingi6∼jandi\nr\n∼jfor","everyr≥1,","also","satisfiesi⊥⊥j|U∪C\nandi⊥⊥j|U∪C∪{k},","for","someCdisjoint","from{i,j,k},","whereU={i\n1\n,···,i\nr\n}\norU=∅whenr=","0.","An","independence","model","that","is","not","path-unstable","is","called\npath-stable.\nIn","the","case","where","the","structure","learning","algorithm","is","DAG-generating,","the\nrequired","condition","is","simpler.","We","say","that","an","independence","modelJisV-\nunstableif","there","exists","a","V-configurationhi,k,jiin","sk(J)","such","thati⊥⊥j|Cand\ni⊥⊥j|C∪{k},","for","someCdisjoint","from{i,j,k}.","An","independence","model","that","is\nnot","V-unstable","is","calledV-stable.","In","the","same","fashion","as","before,","ifJ(P)","satisfies\npath-","or","V-stability","then","we","simply","say","that","“Psatisfies","these","conditions.”\nV-stability","is","weaker","than","singleton-transitivity:\nProposition","16.Singleton-transitivity","implies","V-stability.\nProof.Towards","a","contradiction,","suppose","that","there","is","a","V-configurationhi,k,ji\nin","sk(P)","such","thati⊥⊥j|Candi⊥⊥j|C∪{k},","for","someCdisjoint","from{i,j,k}.\nBy","singleton-transitivity,i⊥⊥k|Cork⊥⊥j|C,","which","is","absurd","since","bothikand\njkare","edges","in","sk(P).\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning16\nIn","addition,","the","converse","of","the","above","result","does","not","hold;","see","Example\n11.","Also","notice","that","singleton-transitivity","and","path-stability","do","not","imply","each\nother","(for","one","direction,","see","Example11again),","but","there","are","considerably\nfewer","independence","statements","to","test","for","for","path-stability","than","for","singleton-\ntransitivity..","We","now","have","the","following","relationship","to","the","uniquenessproperty:\nProposition","17.LetPbe","a","distribution.\n(a)","IfPis","path-stable","then","it","satisfies","the","uniqueness","property.\n(b)","IfPis","V-stable","then","it","satisfies","the","DAG-uniqueness","property.\nProof.We","start","with","the","proof","for","the","case","of","DAGs,","which","is","more","elementary\nthan","the","general","case.\n(b)","Suppose","thatPsatisfies","ordered","upward-","and","downward-stability","w.r.t.\ntwo","orders≤\n′\nand≤\n′′\n.","Towards","a","contradiction,","suppose","that","the","two","DAGs,\nG(P,≤\n′\n)","andG(P,≤\n′′\n)","are","not","Markov","equivalent.\nBy","Lemma\n2,","there","is","a","collider","V-configurationhi,k,ji,","say,","inG(P,≤\n′\n),\nwhich","is","a","non-collider","inG(P,≤\n′′\n)","(sayk",">\n′′\nj).","SinceG(P,≤\n′\n)","is","maxi-\nmal,i⊥⊥j|C,","for","someC.","By","ordered","downward-stability","w.r.t.≤\n′\n,","we","obtain\ni⊥⊥j|C\n′\n,","for","someC\n′\nsuch","thatk","/∈C\n′\n.","Now","by","ordered","upward-stability","w.r.t.\n≤\n′′\n,","we","obtaini⊥⊥j|C\n′\n∪","{k}.","This","shows","thatPis","V-unstable,","which","is","a\ncontradiction.\n(a)","Suppose","thatPsatisfies","ordered","upward-","and","downward-stability","w.r.t.\ntwo","orders≤\n′\nand≤\n′′\n.","Towards","a","contradiction,","suppose","that","the","two","maximal\ngraphsG(P,≤\n′\n)","andG(P,≤\n′′\n)","are","not","Markov","equivalent.\nBy","Lemma\n1,","there","is","a","minimal","collider","pathπ,","say,","inG(P,≤\n′\n),","which","is\nnot","a","minimal","collider","path","inG(P,≤\n′′\n).","Consider","a","shortest","minimal","collider\nsubpathπ\n′\nofπinG(P,≤\n′\n)","that","is","not","a","minimal","collider","inG(P,≤\n′′\n).","Fur-\nthermore,","we","can","assume","thatπ\n′\nis","not","a","collider","path","inG(P,≤\n′′\n),","since","ifπ\n′\nis","a","collider","path,","but","not","minimal,","we","consider","the","minimal","collider","subpath\nπ\n′′\ninG(P,≤\n′′\n).","Note","thatπ\n′′\nis","not","a","minimal","collider","inG(P,≤\n′\n).","We","can\nthen","continue","the","proof","usingπ\n′′\ninstead","ofπ\n′\n,","and","the","roles","ofG(P,≤\n′\n)","and\nG(P,≤\n′′\n)","reversed.\nLetiandjbe","the","endpoints","ofπ\n′\nwhich","is","not","a","collider","inG(P,≤\n′′\n).","Consider\na","nodek,","which","is","a","non-collider","node","onπ\n′\n.","We","show","thatkis","adjacent","toi\norjonπ\n′\n.","Towards","a","contradiction,","suppose","that","it","is","not","adjacent","to","either.\nConsider","a","subpath","ofπ\n′\ngiven","byhi\n′\n,h,k,ℓ,j\n′\ni.","Recall","that","the","endpoints","of\na","minimal","collider","path","are","not","adjacent.","Henceh∼ℓ,","otherwise,hh,k,ℓiis","a\nshorter","minimal","collider","subpath","inG(P,≤\n′\n)","that","is","not","a","minimal","collider","in\nG(P,≤\n′′\n).","Similarly,h∼j\n′\nandi\n′\n∼ℓ.","Sinceπ\n′\nis","a","minimal","collider,","thehℓ-edge\ncannot","be","an","arc,","and","thehj-","andiℓ-edge","have","to","be","arrows","fromhtoj\n′\nand\nℓtoi\n′\n,","respectively.","Since","directed","cycles","are","not","permissible","in","an","ancestral\ngraph,","it","is","easy","to","rule","out","the","existence","of","an","arrow","fromhtoℓand","vice-versa;\nwe","already","ruled","out","the","possibility","that","thehℓ-edge","is","an","arc,","and","we","require\nthath∼ℓ,","which","is","absurd.\nWithout","loss","of","generality,","assume","thatkis","adjacent","tojonπ\n′\n.","Letπ\n′\n=hi=\ni\n0\n,i\n1\n,···,i\nr\n,k,ji,","wherermay","be","0.","Ifr",">0,","then","by","minimality,i\nr\n∼jand\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning17\ni\nr\n≻j.","From","an","inductive","argument","alongπ\n′\n,","ifr",">0,","we","conclude","thatπ\n′\nis\nadiscriminatingpath","fromitoj;","that","is,","it","is","a","collider","path,","andi\nn\n∈an(j),\nfor","every","1≤n≤r.\nSinceG(P,≤\n′\n)","is","maximal,i⊥⊥j|C,","for","someC;","moreover,k","/∈an(i)","since\notherwiseiandjare","not","separated.","Sincekis","a","collider","inG(P,<\n′\n),","we\nhavek6∈an(j).","Therefore,","by","ordered","downward-stability","w.r.t.≤\n′\n,","we","ob-\ntaini⊥⊥j|C\n′\n,","for","someC\n′\nsuch","thatk","/∈C\n′\n.","By","ordered","upward-stability","w.r.t.\n≤\n′\n,","and","the","previously","established","discrimination,","we","obtaini⊥⊥j|U∪C\n′\n,","where\nU={i\n1\n,···,i\nr\n}(and","ifr=","0,","thenU=∅).","Now","by","ordered","upward-stability\nw.r.t.≤\n′′\n,","we","obtaini⊥⊥j|U∪C\n′\n∪{k},","sincekis","not","a","collider","node","onG(P,≤\n′′\n).\nThusPis","path-unstable,","which","is","a","contradiction.\nThis","leads","to","the","main","result,","which","provides","conditions","under","which","the\nstructure","learning","algorithm","works.\nTheorem","18.Suppose","thatPsatisfies","the","conditions","of","Theorem\n12,","that\nis,","it","is","converse","pairwise","Markovian","toG\n0\nand","satisfies","ordered","upward-","and\ndownward-stability","w.r.t.G\n0\n.\n(a)","IfPis","also","path-stable,","thenG(P)is","Markov","equivalent","toG\n0\n.\n(b)","IfG\n0\nis","a","DAG","andPis","V-stable,","then","a","DAG-outputG(P)of","the","structure-\nlearning","algorithm","is","Markov","equivalent","toG\n0\n.\nProof.The","proof","follows","from","Proposition\n17and","Lemma14.\n6.","Structure","Learning","for","Structural","Causal","Models\nFirst,","we","prove","the","global","Markov","property","for","general","SCMs,","which","allow","for\nthe","possibility","of","arcs.","Then","we","find","conditions","on","the","functions","of","the","SCM","to\nthat","ensure","the","converse","pairwise","Markov","property;","see","(\n2).\n6.1.","Global","Markov","Property","for","General","SCMs\nThe","main","assumption","used","in","the","general","setting","for","structure","learning","is","that\nPis","Markovian","to","the","causal","graphG\n0\n.","A","main","reason","for","popularity","of","SCMs\nfor","causal","learning","is","that","this","condition","is","automatically","satisfied","forthe","joint\ndistribution","of","an","SCM.","Indeed,","the","joint","distribution","of","an","SCM","with","mutually\nindependent","errors","being","Markovian","to","the","DAGG\n0\nis","a","well-known","result\n[\n37;23],","but","we","are","not","aware","of","such","a","result","in","an","explicit","and","non-parametric\nform","when","unobserved","variables","are","existent;","see","[16]","for","a","similar","result","in","the\nGaussian","case","and","with","a","slightly","different","type","of","graph.","Recently,","in[\n3],","a\nsimilar","result","is","proven","for","directed","SCMs,","but","for","a","less","general","setting;","see\nRemark\n4.\nTheorem","19.The","joint","distributionPof","an","SCM","is","Markovian","toG\n0\n.\nThe","proof","of","the","above","theorem","requires","some","definitions","and","results","that","are\nnot","used","in","the","subsequent","sections.","We","provide","the","proof","together","with","these\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning18\ndefinitions","and","results","in","the","remainder","of","this","subsection.","Readersmay","skip\nthe","proof","without","loss","of","continuity.\nWe","first","need","some","primary","definitions","and","results","mostly","from","[\n26].","The\ndistrictof","nodei,","denoted","by","dis(i),","is","the","set","of","nodes","connected","toiby\na","collider","path","on","which","every","edge","is","an","arc.","We","also","define","a","setAto","be\nancestralif","it","is","closed","under","the","ancestor","relation,","i.e.","ifA∪an(A)","=A.","IfA\nis","an","ancestral","set","in","a","graphG,","andiis","a","node","inAthat","has","no","children","inA,\nthen","we","define","theMarkov","blanketofiw.r.t.","the","induced","subgraphG[A]","onA\nby\nmb(i,A)","=","pa\nG[A]\n(dis\nG[A]\n(i))∪(dis\nG[A]\n(i)\\{i}).\nWe","use","the","notation","pst(i)","for","the","set","of","nodes","with","an","order","larger","thati.\nWe","say","that","a","probability","distribution","satisfies","theordered","local","Markov","property\nw.r.t.","the","ordering≤,","if","for","any","nodei,","and","ancestral","setAsuch","thati∈A⊆\npst(i),","we","have\ni⊥⊥[A\\(mb(i,A)∪{i})]|mb(i,A).\nWe","have","the","following","equivalence,","which","does","not","require","any","extra","assump-\ntions,","originally","proven","for","ADMGs","(which","is","a","more","general","class","thandirected\nancestral","graphs):\nLemma","20([\n26]).For","a","valid","ordering≤of","the","nodes","of","a","graph,","the","ordered\nMarkov","property","w.r.t.≤is","equivalent","to","the","global","Markov","property.\nIn","this","section,","we","also","utilize","the","concept","of","marginalization","over","probabil-\nity","distributions","and","graphs.","Letα(P,M)","be","the","marginalized","distribution","over\nM⊂Vso","thatα(P,M)","is","defined","overX\nV\\M\n.","Notice","that","the","induced","indepen-\ndence","model","ofα(P,M)","isJ(α(P,M))","={A⊥⊥B|D:","(A∪B∪D)∩M=∅}.\nBy","marginalizing","over","the","node","setMof","graphG,","a","new","graphα(G,M)","is\nobtained","from","which","the","node","setMis","removed:","For","every","pathπinGbetween\ni,j","/∈M,","whose","inner","nodes","are","all","non-collider","and","inM,","we","generate","an","edge\ninα(G,M),","which","preserves","the","(lack","of)","arrowheads","pointing","toiandjin\nπ;","We","apply","this","repeatedly","until","no","new","edges","are","being","generated,","and","then\nremove","all","the","nodes","inM;","for","more","details","of","this","algorithm,","refer","to","[\n27;28].\nThe","following","result","is","well-known","[27;28]:\nLemma","21.For","a","graphGand","disjoint","node","setsA,B,C,","andM,","it","holds\nthat\nA⊥B|Cinα(G,M)⇐⇒A⊥B|CinG.\nWe","shall","need","the","following","corollary","of","this","result:\nLemma","22.Suppose","that","a","distributionPis","Markovian","to","the","graphG.","Then\nα(P,M)is","Markovian","toα(G,M).\nProof.Pbeing","Markovian","toGimplies","thatA⊥B|CinGimplies","thatA⊥⊥B|C.\nA⊥B|Cinα(G,M)","implies","that","(A∪B∪C)∩M=∅,","and","alsoA⊥B|C(by\nLemma\n21).","(A∪B∪C)∩M=∅implies","thatA⊥⊥B|Cexists","inJ(α(P,M)).\nTherefore,A⊥B|Cinα(G,M)","impliesA⊥⊥B|Cexists","inJ(α(P,M)).\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning19\nWe","are","now","ready","to","provide","the","proof","of","Theorem19.\nProof","of","Theorem\n19.Consider","the","augmented","graphG\n0\n(X,ǫ)","and","the","joint\ndistributionP\nX,ǫ\n.","Consider","the","ordering","similar","to","the","ordering","in","the","SCM","for\nX\ni\ns,","and,","forǫ\ni\ns,","letX\ni+1\n>","ǫ\ni\n>","X\ni\n.","We","show","thatP\nX,ǫ\nsatisfies","the","ordered\nlocal","Markov","property","w.r.t.","this","ordering","inG\n0\n(X,ǫ).","Hence","by","Lemma\n20,","we\nobtain","thatP\nX,ǫ\nis","Markovian","toG\n0\n(X,ǫ).","Consider","a","node","inG\n0\n(X,ǫ).","We\nhave","two","cases:\nFirst,","assume","that","this","node","is","ofǫform,","i.e.","say","it","isǫ\ni\n.","Consider","alsoA⊆\npst(ǫ\ni\n).","We","have","that","mb(ǫ\ni\n,A)","={ǫ\nj\n∈A:X\nj\n∈dis(X\ni\n)","inG\n0\n}.","If","mb(ǫ\ni\n,A)","=\nA,","thenǫ\ni\n⊥⊥[A\\(mb(ǫ\ni\n,A)∪{ǫ\ni\n})]|mb(ǫ\ni\n,A)","is","trivial;","otherwise","there","is","no\nedge","between","mb(ǫ\ni\n,A)","andA\\(mb(ǫ\ni\n,A)∪{ǫ\ni\n})","inG\n0\n(X,ǫ),","which,","by","joint\nindependence","of","suchǫ\nj\n,","implies","that{ǫ\ni\n}∪mb(ǫ\ni\n,A)⊥⊥A\\(mb(ǫ\ni\n,A)∪{ǫ\ni\n}).\nThis,","by","the","weak","union","property,","implies\nǫ\ni\n⊥⊥[A\\(mb(ǫ\ni\n,A)∪{ǫ\ni\n})]|mb(ǫ\ni\n,A).\nSecondly,","assume","that","this","node","is","ofXform,","i.e.","say","it","isX\ni\n.","Consider\nalsoA⊆pst(X\ni\n)","=","(ǫ\ni\n,X\ni+1\n,ǫ\ni+1\n,...,X\nn\n,ǫ\nn\n).","We","have","that","mb(X\ni\n,A)","=\n{ǫ\ni\n}∪{X\nj\n:X\nj\n∈pa\nG\n0\n[A]\n(X\ni\n)}.","However,","given","mb(X\ni\n,A),","we","have","thatX\ni\nis\ndeterministic;","hence,","it","is","independent","of","all","disjoint","random","vectors","including\nA\\(mb(X\ni\n,A)∪{X\ni\n}).\nFinally,","since","the","inner","nodes","ofhX\ni\n,ǫ\ni\n,ǫ\nj\n,X\nj\niare","non-collider","inα(G\n0\n(X,ǫ),\nit","can","be","seen","thatα(G\n0\n(X,ǫ),ǫ)","=G\n0\n.","Hence,P\nX,ǫ\nbeing","Markovian","to\nG\n0\n(X,ǫ),","by","Lemma\n22,","implies","thatPis","Markovian","toG\n0\n.\n6.2.","Conditions","and","Assumptions","for","Structure","Learning","of","SCMs\nThe","general","setting","for","structure","learning","for","SCMs","is","the","same","asin","the","previ-\nous","sections,","and,","in","fact,","the","case","of","SCM","could","be","considered","a","special","case","of\nthe","theory","presented","above:","We","start","by","assuming","the","existenceof","anunknown\nSCMCassociated","to","anunknowncausal","graphG\n0\nas","described","in","Section\n2.5.\nFor","structure","learning","(from","observational","data),","we","find","a","graph","that","belongs\nto","the","Markov","equivalence","class","ofG\n0\n.","As","discussed,","the","SCMCentails","a","joint\ndistributionP,","which","is","still","unknown.","Therefore,","the","relationships","can","be","illus-\ntrated","in","the","following","diagram:\nG\n0\n←C→P\nconditional","independence\n→J(P)\nAlgorithm\n→G(P)\nMarkov","equivalent\n∼G\n0\nWe","begin","our","discussion","with","a","few","examples.","In","general,","the","independence\nmodels","of","the","SCMs","are","not","faithful","toG\n0\n.\nExample","23(Failure","of","faithfulness).Consider","the","following","SCM","where2\n≻1,\nand2is","the","only","parent","of1.","SupposeX\n2\n=ǫ\n2\nandX\n1\n=X\n2\n⊕ǫ\n1\nmod","2,","where\nǫ\n2\nandǫ\n1\nare","independent","Bernoulli","random","variables","with","parameter\n1\n2\n.","It","is\neasy","to","verify","thatX\n2\nis","also","independent","ofX\n1\n.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning20\nFor","a","continuous","example,","we","exploit","of","the","invariance","of","Lebesgue","measure\non","the","circle.","Takeǫ\n1\nandX\n2\n=ǫ\n2\nto","be","independent","continuous","real-valued\nrandom","variables.","LetFandGbe","the","cumulative","distribution","functions","forX\n2\nandǫ\n1\n,","respectively.","SetX\n1\n=F(X\n2\n)⊕G(ǫ\n1\n)","mod","1.","It","is","easy","to","verify","thatX\n2\nis","independent","ofX\n1\n.\nMotivated","by","Example\n23and","the","elementary","fact","that","a","random","rotation\nthat","is","independent","of","a","standard","bivariate","normal","remains","independent","of","the\nrandomly","rotated","bivariate","normal,","and","more","generally","the","connection","between\nsymmetries","and","independence","[\n9],","we","have","the","following","lemma.\nLemma","24.Consider","the","SCM","with","associated","graph2\n≻1,","so","that2is","the\nonly","parent","of1.","Suppose","thatX\n2\n=ǫ\n2\n,X\n1\n=φ\n1\n(X\n2\n,ǫ\n1\n)and","thatǫ\n2\nandǫ\n1\nare\nindependent.","ThenX\n2\nis","independent","ofX\n1\nif","and","only\nφ\n1\n(x\n2\n,ǫ\n1\n)\nd\n=X\n1\n(3)\nfor","almost","everyx\n2\n∈X\n2\n.\nNote","that","(\n3)","is","easily","satisfied","ifφ\n1\nis","actually","a","function","ofǫ\n1\nalone.","In\n(3),","it","may","be","helpful","to","think","ofx\n2\nas","indexing","(distinct)","ways","of","generating","a\nrandom","variable","with","lawX\n1\n,","given","the","randomizationǫ\n1\n.\nProof","of","Lemma\n24.LetS\n2\n⊂X\n2\nandS\n1\n⊂X\n2\nbe","measurable","subsets.","LetQ\nX\n2\nandQ\nǫ\nbe","the","laws","ofX\n2\nandǫ\n1\n,","respectively.","Since","2\n≻1,","andX\n2\nandǫ\n1\nare\nindependent,","we","have\nP(X\n1\n∈S\n1\n,X\n2\n∈S\n2\n)","","=P(φ\n1\n(X\n2\n,ǫ\n1\n)∈S\n1\n,X\n2\n∈S\n2\n)\n=\n∫","∫\n1[φ\n1\n(x\n2\n,e\n1\n)∈S\n1\n)]1[x\n2\n∈S\n2\n]dQ\nX\n2\n(x\n2\n)dQ\nǫ\n1\n(e\n1\n)\n=\n∫\nS\n2\nP(φ\n1\n(x\n2\n,ǫ\n1\n)∈S\n1\n)dQ\nX\n2\n(x\n2\n).\nThus","if","(\n3)","holds,","we","have\nP(X\n1\n∈S\n1\n,X\n2\n∈S\n2\n)","","=\n∫\nS\n2\nP(X\n1\n∈S\n1\n)dQ\nX\n2\n(x\n2\n)\n=P(X\n1\n∈S\n1\n)Q\nX\n2\n(S\n2\n)\n=P(X\n1\n∈S\n1\n)P(X\n2\n∈S\n2\n)\nand","the","desired","independence","follows.\nIfX\n2\nandX\n1\nare","independent,","then\nP(X\n1\n∈S\n1\n)","=\n1\nP(X\n2\n∈S\n2\n)\n∫\nS\n2\nP(φ\n1\n(x\n2\n,ǫ\n1\n))∈S\n1\n)dQ\nX\n2\n(x\n2\n)\nfor","all","measurable","subsetsS\n2\nwithQ\nX\n2\n(S\n2\n)>0.","By","setting\nS\n2\n={x\n2\n∈X\n2\n:P(φ\n1\n(x\n2\n,ǫ\n1\n)∈S\n1\n)>P(X\n1\n∈S)},\nwe","see","thatQ\nX\n2\n(S\n2\n)","=","0.","Hence","together","with","reversing","the","inequality","in","the\ndefinition","ofS\n2\n,","we","obtain","(\n3).\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning21\nIn","fact,","the","joint","distributions","of","SCMs","may","not","satisfy","any","of","the","axioms","for\nfaithfulness,","presented","in","Proposition\n3,","and","discussed","in","the","Sections2.2and\n2.3.","For","a","counter-example","and","a","thorough","discussion","on","the","intersection","prop-\nerty,","see","[24].","For","an","example","of","an","SCM","not","satisfying","singleton-transitivity,","see\nExample\n15.","For","counter-examples","for","other","axioms,","we","provide","the","following\nexamples:\nExample","25(Failure","of","composition","and","upward","stability).Consider","the","fol-\nlowing","SCM","associated","to","the","graphG\n0\nin","Figure\n4:\nX\n3\n=ǫ\n3\n;X\n2\n=ǫ\n2\n;X\n1\n=X\n2\n⊕X\n3\n⊕ǫ\n1\nmod","2;\nwhereǫ\n1\n,ǫ\n2\n,andǫ\n3\nare","independent,ǫ\n2\nandǫ\n3\nare","Bernoulli","random","variables\nwith","parameter\n1\n2\n,","andǫ\n1\nhas","parameter\n1\n3\n.\nIt","is","easy","to","verify","thatX\n1\n⊥⊥X\n2\n,","andX\n1\n⊥⊥X\n3\n,","butX\n1\n6⊥⊥(X\n2\n,X\n3\n)andX\n1\n6⊥⊥X\n2\n|X\n3\n.\nHence","this","is","an","example","for","an","SCM","not","satisfying","the","composition","property","or\nordered","upward-stability.\n1\n23\nFig","4.","A","directed","acyclic","graphG\n0\n.\nExample","26(Failure","of","ordered","downward-stability).Consider","a","complete\nDAG","with","nodes(1,2,3).","Letǫ\n3\n=","(N\n3\n,U\n3\n)andǫ\n2\n=","(U\n2\n,V\n2\n),","whereN\n3\n,U\n3\n,U\n2\n,\nandV\n2\nare","all","independent,","andN\n3\nis","Poisson","distributed,","andU\n3\n,U\n2\nand\nV\n2\nare","uniformly","distributed","on[0,1].","LetX\n3\n=ǫ\n3\n.","LetX\n2\n=φ\n2\n(X\n3\n,ǫ\n2\n)","=\n(ψ\n2\n(N\n3\n,U\n2\n),V\n2\n),","whereψ\n2\nis","a","deterministic","function","such","thatψ\n2\n(n\n3\n,U\n2\n)is\nuniformly","distributed","on","the","integers{1,...,n\n3\n+","1}.","LetX\n1\n=φ\n1\n(X\n3\n,X\n2\n)","=\n(N\n3\n,V\n2\n).","Clearly,X\n2\nis","not","independent","ofX\n3\n.","However,","conditional","onX\n1\n,","we\nhave","thatX\n2\nis","independent","ofX\n3\n.\nAn","important","property","used","in","the","results","of","previous","section","is","converse\npairwise","Markov","property.","Here,","we","are","mainly","concerned","with","providing","con-\nditions","for","verifying","this","property.","For","an","SCMC,","we","provide","an","assumption","on\nthe","joint","distribution","ofCthat","implies","the","converse","pairwise","Markov","property.\nConsider","the","following","extension","of","Lemma\n24.\nProposition","27.Consider","the","following","SCM,","wherej\n≻iand","we","writeX\ni\n=\nφ\ni\n(X\npa(i)\\{j}\n,X\nj\n,ǫ\ni\n).","Suppose","thatan(i,j)6=∅.","Theni⊥⊥j|an(i,j)if","and","only","if\nfor","almost","allx\nan(i,j)\n∈X\nan(i,j)\nthe","conditional","law","ofX\ni\ngivenX\nan(i,j)\n=x\nan(i,j)\nis","the","same","as","the","law","ofφ\ni\n(x\npa(i)\\{j}\n,x\nj\n,ǫ\ni\n)for","almost","allx\nj\n∈X\nj\nin","the","support\nof","the","conditional","distribution","ofX\nj\ngivenx\nan(i,j)\n.\nProof.LetF\nj\nandF\ni\nbe","theσ-algebras","forX\nj\nandX\ni\n.","LetD:X\nan(i,j)\n×\n(F\nj\n,F\ni\n)→[0,1]","be","a","regular","conditional","distribution","for","(X\nj\n,X\ni\n)","givenX\nan(i,j)\n.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning22\nFixx\nan(i,j)\n∈","X\nan(i,j)\n.","All","the","parents","ofiare","included","in","an(i,j),","except\nj.","LetQ\ni\nandQ\nj\nbe","marginal","distributions","ofX\ni\nandX\nj\nunderD\nx\nan\n(i,j)\n=\nD(x\nan\n(i,j),·,·).","Following","the","proof","of","Lemma\n24,","sincej≻iand","the","graph","is\nancestral,","we","have","thatǫ\ni\n,","with","lawQ\nǫ\ni\n,","is","independent","of","(X\nan(i,j)\n,X\nj\n).","Thus\nforS\nj\n∈F\nj\nandS\ni\n∈F\ni\n,","we","have\nD\nx\nan(i,j)\n(S\nj\n,S\ni\n)","","=\n∫","∫\nS\nj\n1[φ\ni\n(x\npa(i)\\{j}\n,x\nj\n,e\ni\n)∈S\ni\n)]dQ\nj\n(x\nj\n)dQ\nǫ\ni\n(e\ni\n)\n=\n∫\nS\nj\nP(φ\ni\n(x\npa(i)\\{j})\n,x\nj\n,ǫ\ni\n)∈S\ni\n)dQ\nj\n(x\nj\n).\nThus,","if\nQ\ni\n(S\ni\n)","=P(φ\ni\n(x\npa(i)\\{j})\n,x\nj\n,ǫ\ni\n)∈S\ni\n)(4)\nfor","allQ\nj\n-almost","allx\nj\n∈X\nj\n,","then\nD\nx\nan(i,j)\n(S\nj\n,S\ni\n)","=Q\nj\n(S\nj\n)Q\ni\n(S\ni\n)\nas","desired.\nA","routine","variation","of","the","rest","of","the","proof","of","Lemma\n24,","gives","that","the","con-\ndition","onφ\ni\nexpressed","in","(\n4)","is","also","necessary","for","the","conditional","independence\nofX\nj\nandX\ni\n.\nProposition27includes","Lemma24by","making","the","suitable","interpretations","in\nthe","case","that","an(i,j)","=∅.\nProposition27suggests","the","following","condition","that","implies","the","converse\npairwise","Markov","property,","in","the","case","that","true","causal","graph","is","a","DAG.","We","say\nthat","the","(joint","distribution)","of","an","SCM","satisfiespositivityifP(X\nB\n∈S|X\nA\n=\nx\nA\n)>0","almost","surely,","for","every","set","of","nodesBdisjoint","fromAand","every\nmeasurableSfor","whichP(X\nB\n∈S)>0,","for","almost","everyx\nA\n∈X\nA\n.\nObserve","that","each","functionφin","an","SCM","has","the","form\nφ:X\n1\n×···×X\nn\n×E","→X\nn+1\n,\nwhich","is","endowed","with","a","product","probability","measureμ⊗Q\nǫ\n,","the","joint","law","of","the\nparents","and","exogenous","variable","onX\n1\n×···×X\nn\n×E,","and","a","probability","measure\nν=","(μ⊗Q\nǫ\n)◦φ\n−1\nonX\nn+1\n,","the","law","of","the","child.","Letμ\nj\nbe","the","projection","ofμ\nto","space\nX\nj\n:=X\n1\n×···×X\nj−1\n×X\nj+1\n×···×X\nn\n.\nLetǫ,X=","(X\n1\n,...,X\nn\n),","andX\nj\nhave","lawsQ\nǫ\n,μ,","andμ\nj\nrespectively.","We","say\nthatφhasnon-constant","fibersif","for","all","1≤j≤nthere","is","someF⊂","X\nj\nwith\npositiveμ\nj\n-measure","for","each\nx\nj\n=","(x\n1\n,...,x\nj−1\n,x\nj+1\n,...,x\nn\n)∈F\nand","there","is","someS⊂X\nn+1\nsuch","that","the","functionk:X\nj\n→[0,1]","given","by\nk(x\nj\n)","=P(φ(x\n1\n,...,x\nj\n,...,x\nn\n,ǫ)∈S)\nis","non-constantμ\nj\n-almost","surely.","We","say","that","an","SCM","hasnon-constant","fibers\nif","every","function","in","the","SCM","has","non-constant","fibers.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning23\nRemark","28.Note","that","in","the","proof","of","Proposition27,","equality(4)fails","ifφ\ni\nhas","non-constant","fibers","and","the","SCM","satisfies","positivity.\nRemark","29.It","is","easy","to","see","that","additive","noise","models","with","the","form\nφ(x,ǫ)","=h(x)","+ǫ\nwill","have","non-constant","fibers","under","the","mild","condition","that","for","any1≤j≤n,\nand","any","fixedx\n1\n,...,x\nj−1\n,x\nj+1\n,...,x\nn\n,","the","function\ng(x\nj\n)","=h(x\n1\n,...,x\nj\n,...x\nn\n)\nis","non-constant","almost","surely;","assume","for","simplicity","that","all","the","relevant","condi-\ntional","distributions","are","equivalent","to","Lebesgue","measure.","Hence,","by","Remark\n28,\nthese","additive","noise","models","will","satisfy","the","converse","pairwise","Markov","property,\nprovided","that","the","true","causal","graph","is","a","DAG.\nRecall","that","ifi≺\n≻j,","thenǫ\ni\nandǫ\nj\nare","dependent.","In","order","to","deal","with\nthe","possibility","of","arcs,","we","have","the","following","restriction","that","allows","usto","pre-\nserve","dependence.","We","say","thatφ:X\n1\n×···×X\nn\n×E","→","X\nn+1\nin","an","SCM","is\nnoise","injectiveif","for","each","fixedx\n1\n,...,x\nn\n,","the","functione7→φ(x\n1\n,...,x\nn\n,e)","is\ninjective.\nLemma","30.Consider","an","SCM,","wherej≺\n≻i.","If","bothφ\ni\nandφ\nj\nare","noise\ninjective,","theni6⊥⊥j|an(i,j).\nProof.Fixx\nan(i,j)\n.","Sincej≺\n≻i,","all","the","parents","ofiandiare","included","in","an(i,j)\nandǫ\ni\nandǫ\nj\nare","dependent.","The","conditional","distribution","of","(X\ni\n,X\nj\n)","given\nX\nan(i,j)\n=x\nan(i,j)\nis","the","law","of\n(\n(φ\ni\n(x\npa(i)\n,ǫ\ni\n),φ\nj\n(x\npa(j)\n,ǫ\nj\n)\n)\n,\nsince","the","graph","is","ancestral","and","the","joint","law","of","(ǫ\ni\n,ǫ\nj\n)","remains","the","same","under\nthis","conditioning.","Sinceφ\ni\nandφ\nj\nare","noise","injective,","it","follows","thatφ\ni\n(x\npa(i)\n,ǫ\ni\n)\nandφ\nj\n(x\npa(j)\n,ǫ\nj\n)","are","dependent","if","and","only","ifǫ\ni\nandǫ\nj\nare","dependent.\nCorollary","31.The","additive","noise","models","of","Remark29satisfy","the","converse\npairwise","assumption,","without","the","assumption","the","true","causal","graph","is","a","DAG.\nProof.Immediate","from","Remark\n29and","Lemma30.\nWe","also","say","that","an","SCM","isnoise","injectiveif","every","function","in","the","SCM","is\nnoise","injective.","Notice","that","these","conditions","do","not","depend","on","the","structure","of\nthe","causal","graph.\nCorollary","32.Any","SCM","satisfying","positivity,","with","non-constant","fibers,","and\nnoise","injectivity","has","the","converse","pairwise","Markvov","property;","furthermore,","if\nthe","true","causal","graph","is","a","DAG,","then","the","noise","injectivity","assumption","may","be\ndropped.\nProof.Immediate","from","Proposition\n27,","Lemma30,","and","Remark28.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning24\nHence,","under","some","additional","assumptions,","the","SCMs","are","not","only","Marko-\nvian,","but","minimal","Markovian","to","their","true","causal","graph:\nCorollary","33.Consider","an","SCM","with","positivity,","non-constant","fibers,","noise\ninjectivity,","and","ordered","upward-","and","downward-stability","w.r.t.G\n0\n.","ThenPis\nminimally","Markovian","toG\n0\n;","furthermore,","if","the","true","causal","graph","is","a","DAG,\nthen","the","noise","injectivity","assumption","may","be","dropped.\nProof.The","proof","follows","from","the","Corollary\n13together","with","Theorem19and\nCorollary32.\nWe","can","now","present","our","main","result","for","structure","learning","for","SCMs:\nTheorem","34.Consider","an","SCM","with","positivity,","non-constant","fibers,","and","a\ndistributionP,","which","satisfies","ordered","upward-","and","downward-stability","w.r.t.\nthe","causal","graphG\n0\n.\n1.","IfPis","path-stable,","and","the","SCM","is","noise","injective,","thenG(P),","an","output\nof","the","structure-learning","algorithm,","is","Markov","equivalenttoG\n0\n.\n2.","IfG\n0\nis","a","DAG,","andPis","V-stable,","then","a","DAG-output","of","the","structure-\nlearning","algorithm","is","Markov","equivalent","toG\n0\n.\nProof.The","proof","follows","from","Theorem18,","Theorem19,","and","Corollary32.\n6.3.","Specialization","to","Specific","SCMs\nWe","consider","some","more","restrictive","assumptions","on","an","SCM","that","will","imply","the\nconverse","pairwise","Markov","property.\n6.3.1.","Discrete","Random","Variables\nFor","discrete","distributions,","we","have","the","following","simple","sufficient","condition","for\nan","SCM","to","satisfy","the","converse","pairwise","Markov","property.","We","say","that","an","SCM\nisdiscreteif","both","the","endogenous","and","exogenous","random","variables","are","discrete.\nProposition","35.Consider","an","SCM","that","is","discrete","and","satisfies","positivity.\nSuppose","that","for","all","the","nodesi,","the","cardinality","of","the","support","ofǫ\ni\nis","strictly\nless","than","the","support","ofX\ni\n.\n1.","IfPis","path-stable,","and","the","SCM","is","noise","injective,","thenG(P),","an","output\nof","the","structure-learning","algorithm,","is","Markov","equivalenttoG\n0\n.\n2.","IfG\n0\nis","a","DAG,","andPis","V-stable,","then","a","DAG-output","of","the","structure-\nlearning","algorithm","is","Markov","equivalent","toG\n0\n.\nProof.From","Theorems\n18and19it","suffices","to","verify","the","converse","pairwise\nMarkov","property","for","a","pair","of","adjacent","nodesiandj.","Lemma\n30takes","the","care\nof","the","case","wherei≺≻j.","Suppose","thati≻j.","If","the","support","ofǫ\ni\nis","strictly","less\nthan","the","support","ofX\ni\n,","then","positivity","implies","that","(4)","is","not","satisfied","so","that\nProposition\n27gives","that","the","conditional","independence","statementi⊥⊥j|an(i,j)\ndoes","not","hold.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning25\nIn","the","next","lemma,","we","show","that","under","some","assumptions,","the","failure","of","the\nconverse","pairwise","Markov","property","forj\n≻i,","forces","the","uniform","distribution","on\nbothX\ni\nandǫ\ni\n.","Letφ:X\n1\n×···×X\nn\n×E","→X\nn+1\nbe","a","noise","injective","function","in\na","discrete","SCM.","Givenx\n1\n,...,x\nj\n,...,x\nn\n,","let","Φ\nx\n1\n,...,x\nj−1\n,x\nj+1\n,...,x\nn\nx\nj\n=","Φ\nx\nj\nx\nj\ndenote\nthe","inverse","ofφ.","Suppose","that","for","all","choices","of","1≤j≤nandx\nj\nthere","exists\nx\n∗\nn+1\n∈X\nn+1\nsuch","that\n{Φ\nx\nj\nx\nj\n(x\n∗\nn+1\n)",":x\nj\n∈X\nj\n}=E.\nThen","we","say","thatφisnoise","surjective.\nProposition","36.Consider","the","following","SCM,","wherej\n≻iand\nX\ni\n=φ\ni\n(X\npa(i)\\{j}\n,X\nj\n,ǫ\ni\n).\nSuppose","that","the","joint","distribution","is","discrete","and","satisfies","positivity.","Suppose\nalso","thatφ\ni\nis","noise","injective","and","surjective.","Ifi⊥⊥j|an(i,j),","thenǫ\ni\nandX\nj\nare","both","uniformly","distributed","andE\ni\nandX\ni\nhave","the","same","cardinality.\nProof.Fixx\nan(i,j)\n.","Note","that","all","the","parents","ofi,","savej,","are","included","in","an(i,j),\nBy","Proposition\n27,","we","have\nP(X\ni\n=x\ni\n|X\nan(i,j)\n=x\nan(i,j)\n)","","=P(φ\ni\n(x\npa(i)\\{j})\n,x\nj\n,ǫ\ni\n)","=x\ni\n)\n=P(ǫ\ni\n=","Φ\nx\npa(i)\\{j}\nx\nj\n(x\ni\n))\nfor","allx\ni\n∈X\ni\nand","allx\nj\n∈X\nj\n,","by","positivity.","By","noise","surjectivity,","substituting\nx\ni\n=x\n∗\ni\n,","we","deduce","thatǫ\ni\nis","uniformly","distributed,","with","finite","supportE\ni\n.","Thus\nP(X\ni\n=x\ni\n|X\nan(i,j)\n=x\nan(i,j)\n)","=\n1\n#E\ni\nfor","allx\ni\n.","Hence","it","follows","thatX\ni\nis","also","uniformly","distributed.\nCorollary","37.Consider","a","discrete","SCM","satisfying","positivity.","Suppose","that\nall","the","functions","are","noise","injective","and","noise","surjective.If","each","of","the","exoge-\nnous","random","variables","are","not","uniformly","distributed,","then","the","converse","pairwise\nMarkov","property","is","satisfied.\nProof.Immediate","from","Proposition\n36and","Lemma30.\n6.3.2.","Continuous","Random","Variables\nWe","note","that","the","modular","addition","in","Example23is","not","continuous.","We","show\nthat","under","some","regularity","conditions,","up","to","a","change","of","coordinates,","only","trivial\nfunctions","can","result","in","independence.","Givenφ:X\n1\n×···×X\nn\n×E","→X\nn+1\n,","we\nsay","thatψis","aj-change","of","coordinatesif","there","existsg:","[−1/2,1/2]→","Esuch\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning26\nthat","for","allx\nj\n∈","X\nj\n,","there","existsh\nx\nj\n:X\nn+1\n→[−1/2,1/2]","such","that","ifUis\nuniformly","distributed","on","[−1/2,1/2]","and\nψ(x\nj\n,u)",":=h\nx\nj\n◦φ(x\n1\n,...,x\nj\n,...,x\nn\n,g(u)),\ntheng(U)","has","the","law","ofǫandψ(x\nj\n,ǫ)","is","uniformly","distributed","on","[−1/2,1/2]\nfor","allx\nj\n∈","X\nj\n.","We","say","thatψisregularif","for","fixedx\nj\n,","the","functionζ(u)","=\nψ(x\nj\n,u)","is","injective","andζ(u)","is","monotone;","note","that","under","these","conditions\nan","easy","argument","given","in","Lemma\n38shows","thatψis","areflectionof","the","form\nψ(x\nj\n,u)","=uorψ(x\nj\n,u)","=−ufor","allx\nj\n∈","X\nj\nand","allu∈[−1/2,1/2].","We","say\nthatφisnon-trivialif","for","eachj,","there","does","not","exists","a","regularj-change","of\ncoordinates.","We","say","that","an","SCM","isnon-trivialif","every","function","in","the","SCM\nis","non-trivial.","We","say","that","a","functionφin","an","SCM","isnoise","monotoneif","for\nallx\n1\n,...,x\nn\n,","the","functione7→φ(x\n1\n,...,x\nn\n,e)∈","X\nn+1\n⊂Ris","monotone","in\ne∈E","⊂R.\nProposition","38.Consider","the","following","SCM,","wherej\n≻iand\nX\ni\n=φ\ni\n(X\npa(i)\\{j}\n,X\nj\n,ǫ\ni\n).\nSuppose","thatφ\ni\nis","noise","injective","and","noise","monotone.","Also","assume","thatǫ\ni\nis\na","continuous","random","variable,","and","that","for","almost","allx\nan(i,j)\n,","the","conditional\ndistribution","law","ofX\ni\ngivenX\nan(i,j)\nis","continuous","with","respect","to","Lebesgue","mea-\nsure.","Ifi⊥⊥j|an(i,j),","thenφ\ni\nadmits","aj-regular","change","of","coordinates","and","any\nsuch","change","of","coordinates","is","a","reflection.\nProof.Recall","that","ifFis","the","cumulative","distribution","function","for","a","continuous\nrandom","variableZ,","thenFis","non-decreasing","andF(Z)−\n1\n2\nis","uniformly","dis-\ntributed","on","[−1/2,1/2].","In","addition,","the","inverse","transform","method","tells","us","that\nF\n−1\n(U+\n1\n2\n)","has","lawZifUis","uniformly","distributed","on","[−1/2,1/2].","Hence","by\nProposition\n27,","and","the","absolute","continuity","assumptions,","it","follows","thatφ\ni\nhas\naj-regular","change","of","coordinatesψ.","Fixx\nj\n∈X\nj\nand","writeψ(x\nj\n,u)","=ψ(u).","Ifψ\nis","increasing","inu,","then","forz∈[−1/2,1/2],","we","have","forUuniformly","distributed\non","[−1/2,1/2]","that\nz+","1/2","=P(ψ(U)≤z)","=P(U≤ψ\n−1\n(z))","=ψ\n−1\n(z)","+","1/2,\nfrom","which","it","follows","thatψ(x\nj\n,z)","=z.","Ifψis","decreasing,","then","a","similar","argu-\nment","gives","thatψ(x\nj\n,z)","=−z.\nCorollary","39.If","an","SCM","is","noise","injective","and","monotone,","and","is","non-trivial,\nthen","it","satisfies","the","converse","pairwise","Markov","property.\nProof.Immediate","from","Proposition\n38and","Lemma30.\n7.","Summary","and","Discussion\nA","main","message","of","this","paper","is","that","a","generic","constraint-base","structure","learning\nalgorithm","directs","the","edges","of","the","skeleton","of","the","probability","distributionPso\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning27\nthat","ordered","upward-","and","downward-stability","are","satisfied","byPw.r.t.","the","gener-\nated","graph.","Since,","under","faithfulness,","ordered","upward-","and","downward-stability\nare","necessary","for","the","output","of","the","algorithm,","all","exact","structure","learning","al-\ngorithms","that","assume","faithfulness","in","the","literature","satisfy","this","condition.","This\nhigh-level","algorithm","could","provide","a","roadmap","for","finding","computationally","“op-\ntimal”","constraint-based","structure","learning","algorithms.","This","is","a","direction","for\nfuture","work.\nIn","general,","we","formalized","the","problem","of","structure","learning","from","indepen-\ndence","statements","to","find","a","graph","that","is","Markov","equivalent","to","the","“true","causal\ngraph,”","which","is","the","unknown","graph","to","which","the","distribution","is","assumed","to","be\nMarkovian.","Under","the","widely-used","assumption","of","faithfulness,","thisformaliza-\ntion","leads","to","simple","and","clear","proofs","for","the","fact","that","the","output","ofthe","generic\nstructure","learning","algorithm,","proposed","here,","is","Markov","equivalentto","the","true\ncausal","graph,","and","every","Markov","equivalent","graph","must","satisfy","the","conditions","of\nthe","output","of","the","algorithm.\nMoreover,","we","provided","two","assumptions,","both","of","which","are","satisfied","by","faith-\nfulness,","in","order","to","ensure","that","the","skeleton","of","the","output","of","thefirst","stage\nof","the","algorithm","is","the","same","as","the","skeleton","of","the","causal","graph.","One","condi-\ntion","is","the","converse","pairwise","Markov","property","and","the","other","one","is","satisfied","by\nthe","assumption","that","the","distribution","satisfies","ordered","upward-","and","downward-\nstability","w.r.t.","the","causal","graph.","In","order","to","ensure","that","directingthe","edges","of\nthe","skeleton","of","the","output","of","the","first","stage","algorithm","will","result","toa","Markov\nequivalent","graph","to","the","causal","graph,","a","sufficient","condition","is","path-stability","in\nthe","general","case","of","directed","ancestral","graphs,","and","V-stability","inthe","case","where\nwe","only","deal","with","DAGs.","However,","under","these","conditions,","ordereddownward-\nand","upward-stability","are","not","necessary","for","an","output","of","the","algorithm","to","be\nMarkov","equivalent","toG\n0\n.\nAlthough,","the","structure","learning","is","usually","performed","for","SCMs,","in","principle,\nthe","theory","could","be","defined","for","the","more","general","case,","wherePis","Markovian\nto","the","causal","graph.","In","fact,","all","the","results","presented","here","arecorrect","for","an\nabstract","independence","modelJinstead","of","a","probability","distributionP.","We","have\npresented","the","results","forP,","and","then","specialized","the","theory","for","SCMs.","For","SCMs,\nwe","showed","that","in","the","general","case,","the","main","assumption","ofPbeing","Markovian\nto","the","causal","graph","is","always","satisfied.","In","addition,","we","provided","simple","conditions\non","the","SCM","that","imply","the","converse","pairwise","Markov","property.\nThe","assumptions","we","provide","are","weaker","than","the","completely","intestable","faith-\nfulness","assumption.","In","particular,","out","of","the","equivalent","conditionsto","faithfulness,\nprovided","in","[\n30],","intersection","and","composition","properties","are","not","needed,","nor","is\nthe","singleton-transitivity","in","its","form.","In","the","case","of","a","Gaussian","distribution,\nhowever,","all","these","assumptions","are","automatically","satisfied,","and","therefore,","our\nassumptions","are","equivalent","to","that","of","faithfulness.\nNotice","that","path-","and","V-stability,","assumed","for","the","general","case","and","the","DAGs,\nrespectively,","are,","in","fact,","only","the","properties","of","the","distribution","and","not","the\ncausal","graph.","V-stability","is","also","weaker","than","singleton-transitivity.","Path-","and\nV-stability","are","easier","to","test","than","singleton-transitivity","as","the","oneneeds","to\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning28\nonly","test","independence","for","the","endpoints","of","specific","paths","or","V-configurations\nin","sk(P)","respectively.\nThe","assumption","of","the","converse","pairwise","Markov","property","is","indeedrelated","to\nthe","causal","graph,","but","we","give","sufficient","conditions","on","the","SCM","for","this","property\nthat","are","no","longer","dependent","on","the","causal","graph.","Our","key","condition","of","having\nnon-constant","fibers","has","a","simple","interpretation","when","the","functionof","an","SCM\nhas","only","one","discrete","endogenous","variable","and","one","exogenous","variable:","there","is","a\nchoice","of","two","values","for","the","endogenous","variable,","whereby","the","distributions","of","the\nrandom","variables","given","by","evaluating","the","function","at","these","two","fixedvalues","and\nthe","exogenous","random","variable","are","distinct.","In","the","general","case","where","the","SCM\nmay","not","be","a","DAG,","we","need","to","impose","a","further","strong","injectivity","condition","on\nthe","functions.\nThe","assumption","of","distributions","(of","the","SCM)","satisfying","ordered","upward-","and\ndownward-stability","w.r.t.","the","causal","graph","is,","in","principle,","not","directly","testable.\nHowever,","in","our","primary","study,","we","observe","that","it","is","difficult","to","come","up","with\nnatural","examples","of","distributions","that","do","not","satisfy","these","conditions","when\ndealing","with","SCMs.","Nevertheless,","a","thorough","study","of","these","conditions","for","SCMs\nand","other","causal","models","is","needed,","and","is","subject","of","future","work.\nAcknowledgements\nThe","authors","are","grateful","to","Steffen","Lauritzen","for","providing","Example\n15,","to","Joris\nMooij","for","stimulating","discussions","with","the","first","author","especially","on","the","examples\ninvolving","modular","arithmetic,","and","to","Jonas","Peters","for","hosting","a","firstauthor’s\nvisit,","during","which","some","of","the","ideas","used","in","this","paper","were","discussed.\nReferences\n[1]Ali,","R.","A.,Richardson,","T.","S.andSpirtes,","P.(2009).","Markov","Equiv-\nalence","for","Ancestral","Graphs.Ann.","Statist.372808–2837.\n[2]Andersson,","S.","A.,Madigan,","D.andPerlman,","M.","D.(1997).","A","Char-\nacterization","of","Markov","Equivalence","Classes","for","Acyclic","Digraphs.Ann.\nStatist.25505–541.\n[3]Bongers,","S.,Forr\n","́\ne,","P.,Peters,","J.,Scholkopf,","B.andMooij,","J.","M.\n(2020).","Foundations","of","Structural","Causal","Models","with","Cycles","andLatent\nVariables.Ann.","Stat.to","appear,","arXiv:1611.06221.\n[4]Chang,","J.","T.andPollard,","D.(1997).","Conditioning","as","disintegration.\nStatist.","Neerlandica51287–317.\n[5]Chickering,","D.","M.(2003).","Optimal","Structure","Identification","with","Greedy\nSearch.J.","Mach.","Learn.","Res.3507–554.\n[6]Colombo,","","D.andMaathuis,","","M.","","H.(2014).","","Order-independent\nconstraint-based","causal","structure","learning.J.","Mach.","Learn.","Res.153741–\n3782.\n[7]Cox,","D.","R.andWermuth,","N.(1996).Multivariate","Dependencies",":","mod-\nels,","analysis","and","interpretation.","Chapman","&","Hall,","London,","United","King-\ndom.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning29\n[8]Dawid,","A.","P.(1979).","Conditional","independence","in","statistical","theory","(with\ndiscussion).J.","R.","Stat.","Soc.","Ser.","B.","Stat.","Methodol.411–31.\n[9]Dawid,","A.","P.(1985).","Invariance","and","independence","in","multivariate","distri-\nbution","theory.J.","Multivariate","Anal.17304–315.\n[10]Dawid,","A.","P.(2000).","Causal","Inference","without","Counterfactuals.J.","Amer.\nStatist.","Assoc.95407-424.\n[11]Geiger,","D.,Verma,","T.","S.andPearl,","J.(1990).","Identifying","indepen-\ndence","in","Bayesian","networks.Networks20507–534.\n[12]Glymour,","C.,Scheines,","R.,Spirtes,","P.andKelly,","K.(1987).Dis-\ncovering","Causal","Structure.","Academic","Press.\n[13]Hitchcock,","C.(2018).","Causal","Models.","InThe","Stanford","Encyclopedia","of\nPhilosophyfall","2018","ed.","(E.","N.","Zalta,","ed.)","Metaphysics","Research","Lab,","Stan-\nford","University.\n[14]Holland,","P.","W.(1986).","Statistics","and","causal","inference.J.","Amer.","Statist.\nAssoc.81945–970.","With","discussion","and","a","reply","by","the","author.\n[15]Kiiveri,","H.,Speed,","T.","P.andCarlin,","J.","B.(1984).","Recursive","causal\nmodels.J.","Aust.","Math.","Soc.,","Ser.","A3630–52.\n[16]Koster,","J.","T.","A.(1999).","On","the","Validity","of","the","Markov","Interpretation","of\nPath","Diagrams","of","Gaussian","Structural","Equations","Systems","with","Correlated\nErrors.Scand.","J.","Stat.26413-431.\n[17]Lauritzen,","S.","L.(1996).Graphical","Models.","Clarendon","Press,","Oxford,\nUnited","Kingdom.\n[18]Lauritzen,","S.","L.andSadeghi,","K.(2018).","Unifying","Markov","properties\nfor","graphical","models.Ann.","Statist.462251–2278.\n[19]Lauritzen,","S.","L.andSpiegelhalter,","D.","J.(1988).","Local","computations\nwith","probabilities","on","graphical","structures","and","their","application","to","expert\nsystems.J.","R.","Stat.","Soc.","Ser.","B.","Stat.","Methodol.50157-224.\n[20]Ln\nˇ\neni\nˇ\ncka,","R.andMat\n","́\nu\nˇ\ns,","F.(2007).","On","Gaussian","conditional","indepen-\ndence","structures.Kybernetika43327–342.\n[21]Neapolitan,","R.","E.(2004).Learning","Bayesian","networks.","Prentice","Hall,\nUpper","Saddle","River,","NJ,","USA.\n[22]Pearl,","J.(1988).Probabilistic","Reasoning","in","Intelligent","Systems",":","net-\nworks","of","plausible","inference.","Morgan","Kaufmann","Publishers,","San","Mateo,\nCA,","USA.\n[23]Pearl,","J.(2009).Causality:","Models,","Reasoning","and","Inference,","2nd","ed.\nCambridge","University","Press,","New","York,","NY,","USA.\n[24]Peters,","J.(2015).","On","the","Intersection","Property","of","Conditional","Indepen-\ndence","and","its","Application","to","Causal","Discovery.J.","Causal","Inference397–\n108.\n[25]Peters,","J.,Janzing,","D.andSch\n","̈\nolkopf,","B.(2017).Elements","of","Causal\nInference","-","Foundations","and","Learning","Algorithms.Adaptive","Computation\nand","Machine","Learning","Series.","The","MIT","Press,","Cambridge,","MA,","USA.\n[26]Richardson,","T.(2003).","Markov","properties","for","acyclic","directed","mixed\ngraphs.Scand.","J.","Stat.30145-157.\n[27]Richardson,","T.","S.andSpirtes,","P.(2002).","Ancestral","graph","Markov\nmodels.Ann.","Statist.30962–1030.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021\n\nSadeghi","and","Soo/Conditions","for","Causal","Structure","Learning30\n[28]Sadeghi,","K.(2013).","Stable","mixed","graphs.Bernoulli192330-2358.\n[29]Sadeghi,","K.(2016).","Marginalization","and","conditioning","for","LWF","chain\ngraphs.Ann.","Statist.441792–1816.\n[30]Sadeghi,","K.(2017).","Faithfulness","of","Probability","Distributions","and","Graphs.\nJ.","Mach.","Learn.","Res.181–29.\n[31]Sadeghi,","K.andLauritzen,","S.","L.(2014).","Markov","properties","for","mixed\ngraphs.Bernoulli,20676-696.\n[32]Spirtes,","P.,Glymour,","C.andScheines,","R.(2000).Causation,","Predic-\ntion,","and","Search,","2nd","ed.","MIT","press.\n[33]Steel,","D.(2006).","Homogeneity,","selection,","and","the","faithfulness","condition.\nMinds","and","Machines16303–317.\n[34]Studen\n","́\ny,","M.(1989).","Multiinformation","and","the","problem","of","characteriza-\ntion","of","conditional","independence","relations.Problems","of","Control","and","Infor-\nmation","Theory183–16.\n[35]Studen\n","́\ny,","M.(2005).Probabilistic","Conditional","Independence","Structures.\nSpringer-Verlag,","London,","United","Kingdom.\n[36]Tsamardinos,","I.,Brown,","L.","E.andAliferis,","C.","F.(2006).","The","max-\nmin","hill-climbing","Bayesian","network","structure","learning","algorithm.Machine\nLearning6531–78.\n[37]Verma,","T.andPearl,","J.(1988).","Causal","Networks:","Semantics","and","Ex-\npressiveness.Proceedings","of","the","Fourth","Workshop","on","Uncertainty","in","Arti-\nficial","Intelligence","(UAI)4352–359.\n[38]Verma,","T.andPearl,","J.(1990).","On","the","Equivalence","of","Causal","Models.\nInProceedings","of","the","Proceedings","of","the","Sixth","Conference","Annual","Confer-\nence","on","Uncertainty","in","Artificial","Intelligence","(UAI-90)220–227.","Elsevier\nScience,","New","York,","NY.\n[39]Wermuth,","N.(2011).","Probability","distributions","with","summary","graph\nstructure.Bernoulli17845–879.\n[40]Wermuth,","N.andSadeghi,","K.(2012).","Sequences","of","regressions","and","their\nindependences.TEST21215-252","and","274-279.\n[41]Woodward,","J.(1998).","Causal","Independence","and","Faithfulness.Multivari-\nate","Behavioral","Research33129-148.\n[42]Zhang,","J.(2008).","On","the","Completeness","of","Orientation","Rules","for","Causal\nDiscovery","in","the","Presence","of","Latent","Confounders","and","Selection","Bias.Artif.\nIntell.1721873–1896.\n[43]Zhang,","J.andSpirtes,","P.(2003).","Strong","Faithfulness","and","Uniform","Con-\nsistency","in","Causal","Inference.","InProceedings","of","the","Nineteenth","Conference\non","Uncertainty","in","Artificial","Intelligence.UAI’03632–639.","Morgan","Kauf-\nmann","Publishers","Inc.,","San","Francisco,","CA,","USA.\n[44]Zhang,","J.andSpirtes,","P.(2008).","Detection","of","Unfaithfulness","and","Robust\nCausal","Inference.Minds","and","Machines18239–271.\n[45]Zhao,","H.,Zheng,","Z.andLiu,","B.(2004).","On","the","Markov","equivalence\nof","maximal","ancestral","graphs.Science","in","China","Ser.","A,","Mathematics48\n548–562.\nimsart-generic","ver.","2020/08/06","file:","SEM-axioms-arxiv.tex","date:","March","26,","2021"],"doc17":["\n\nTowards","Optimal","Algorithms","for","Multi-Player\nBandits","without","Collision","Sensing","Information\nWei","Huang\n∗\n,","Richard","Combes\n†\nand","Cindy","Trinh\n‡\nMarch","25,","2021\nAbstract\nWe","propose","a","novel","algorithm","for","multi-player","multi-armed","bandits\nwithout","collision","sensing","information.","Our","algorithm","circumvents","two\nproblems","shared","by","all","state-of-the-art","algorithms:","it","does","not","need","as\nan","input","a","lower","bound","on","the","minimal","expected","reward","of","an","arm,","and\nits","performance","does","not","scale","inversely","proportionally","to","the","minimal\nexpected","reward.","We","prove","a","theoretical","regret","upper","bound","to","justify\nthese","claims.","","We","complement","our","theoretical","results","with","numerical\nexperiments,","showing","that","the","proposed","algorithm","outperforms","state-of-\nthe-art","in","practice","as","well.\n1","","","","Introduction","and","Contribution\n1.1","","","","Multi-player","bandits\nWe","consider","the","multi-player","multi-armed","bandit","problem","withKarms","and\nM","<","Kplayers.","","At","each","timet=","1,...,T,","whereTis","the","time","horizon,","each\nplayerm=","","1,...,Mselects","","an","","arm","","denoted","","byπ\nm\n(t)∈","{1,...,K}.","","","If","","arm\nk=","1,...,Khas","been","selected","by","strictly","more","than","one","player","we","say","that","a\ncollision","occurs","on","armk,","and","we","denote","by\nη\nk\n(t)","=1\n{\nM\n∑\nm=1\n1{π\nm\n(t)","=k}≥2\n}\nthe","corresponding","indicator","function.","","The","reward","received","by","playerm=","1,...,M\nis","denoted","by\nr\nm\n(t)","=X\nπ\nm\n(t)\n(t)[1−η\nπ\nm\n(t)\n(t)]\nwhere","(X\nk\n(t))\nt≥1\nis","i.i.d.","","Bernoulli","with","meanμ\nk\nfork=","1,...,K.","","In","other\nwords,","if","a","playermis","involved","in","a","collision","then","he","receives","a","reward","of","0,\notherwise","he","receives","a","binary","reward","with","meanμ\nπ\nm\n(t)\n.\n∗\nCentraleSupelec,","L2S,","France\n†\nCentraleSupelec,","L2S,","France\n‡\nCentraleSupelec,","L2S,","France\n1\narXiv:2103.13059v1","","[stat.ML]","","24","Mar","2021\n\n1.2","","","","No","collision","information\nWe","","consider","","the","","case","","where","","each","","playerm=","","1,...,Monly","","observes","","its","","own\nrewardr\nm\n(t)","and","nothing","else.","","He","may","not","observe","the","rewards","obtained","by\nother","players,","he","does","not","know","which","arm","has","been","selected","by","other","players,\nand","he","may","not","observe","the","collision","indicatorη\nπ\nm\n(t)\n.","","This","case","is","called","”without\ncollision","sensing”,","and","is","the","most","arduous","because","when","playermgets","a","reward\nofr\nm\n(t)","=","0,","he","cannot","guess","whether","this","was","caused","by","a","collision","so","that\nη\nπ\nm\n(t)\n(t)","=","1","or","if","this","was","caused","because","the","reward","of","the","chosen","arm","was","null\ni.e.X\nπ\nm\n(t)\n(t)","=","0.","","Of","course","however,","when","a","reward","ofr\nm\n(t)","=","1","is","obtained,\nhe","can","be","sure","that","no","collision","has","occurred.","","Therefore,","the","problem","is","fully\ndecentralized,","and","no","communication","is","allowed","between","the","players.\n1.3","","","","Regret","minimization\nRecall","thatμ\n1\n,...,μ\nK\ndenotes","the","mean","reward","of","each","arm","where","no","collision\nhas","occurred,","and","defineμ\n(1)\n,....,μ\n(K)\nits","version","sorted","in","descending","order,","so\nthat\nμ\n(1)\n≥μ\n(2)\n≥...≥μ\n(K)\n.\nThe","goal","for","the","players","is","to","maximize","the","expected","sum","of","rewards,","and","to","do\nso,","each","player","must","select","allocate","a","distinct","arm","amongst","theMbest","arms","to\nboth","avoid","any","collision","and","maximize","total","reward.","","The","regret","is","defined","as","the\ndifference","between","the","total","expected","reward","obtained","by","an","oracle","that","plays\nthe","optimal","decision","and","the","reward","obtained","by","the","players\nR(T,μ)","=\nT\n∑\nt=1\nM\n∑\nm=1\nμ\n(m)\n−E(r\nm\n(t))\nOur","goal","is","to","design","distributed","algorithms","in","order","to","minimize","regret.\n1.4","","","","Related","Work\nSingle-player","multi-armed","bandits","were","originially","proposed","by","[10]","and","asymp-\ntotically","optimal","strategies","proposed","by","[5],","[4]","amongst","others.","","Building","on\nthe","work","of","[5],","[1]","considered","a","generalization","to","the","case","where","a","single","player\ncan","choose","several","arms,","and","proposed","asymptotically","optimal","strategies.","","In\nfact,","the","problem","considered","by","[1]","can","be","seen","as","a","centralized","version","of","the\ndistributed","problem","we","consider","here.\nMotivated","by","wireless","communication","and","networking,","more","recent","work","has\nconsidered","multi-player","multi-armed","bandits,","[6],","[8],","for","instance","as","a","natural\nmodel","for","a","scenario","where","several","users","must","access","a","wireless","channel","in","a\ndecentralized","manner","[2].\nWhen","collision","sensing","is","available,","several","authors","[3],","[11]","have","shown","that,\none","","can","","obtain","","roughly","","the","","same","","performance","","as","","in","","the","","centralized","","case","","by\ncleverly","exploiting","collisions.\n2\n\nA","harder","problem","is","the","case","without","collision","sensing.","","The","state-of-the-art\nknown","algorithms","for","this","problem","are","SIC-MMAB2","[3],","EC-SIC","[9]","and","the\nalgorithm","","of","","[7].","","","Our","","work","","improves","","on","","these","","algorithms,","","both","","in","","terms","","of\nperformance,","and","in","terms","of","practical","applicability.\n1.5","","","","Our","Contribution\nAll","state-of-the-art","algorithms","such","as","SIC-MMAB","or","EC-SIC","all","suffer","from\ntwo","important","issues:","","(i)","Their","require","a","lower","bound","on","the","expected","reward\nof","the","worse","channelμ\n(K)\n,","and","cannot","be","used","without","this","information.","","Since\nin","practice","this","information","is","usually","not","available,","this","limits","their","practical\napplicability.","","","In","","fact","","EC-SIC","","also","","require","","the","","gapμ\n(M)\n−μ\n(M+1)\nwhich","","is\nalso","typically","unknown","(ii)","Their","regret","is","proportional","to\n1\nμ\n(K)\nwhich","can","be\narbitrarily","large.\nOur","main","contribution","is","to","propose","an","algorithm","correcting","both","of","these\nissues.","","The","proposed","algorithm","requires","no","input","information","besides","the","number\nof","armsKand","the","time","horizonTand","its","regret","is","upper","bounded","as:\nR(T,μ)","=O\n(\n∑\nk>M\nlnT\nμ\n(M)\n−μ\n(k)\n+K\n2\nMlnT+KM\n2\nln\n(\n1\nμ\n(M)\n−μ\n(M+1)\n)\n2\n)\nwhich","does","not","depend","on\n1\nμ\n(K)\n,","and","is","strictly","smaller","than","all","known","regret\nbounds","for","these","algorithms.","","We","present","numerical","experiments","which","confirm\nour","theoretical","predictions,","so","that","the","proposed","algorithm","performs","significantly\nbetter","than","EC-SIC","and","SIC-MMAB2.\n2","","","","Algorithm","and","Analysis\nThe","proposed","algorithm","can","be","broken","down","into","three","steps","and","corresponding\nsubroutines.","","Of","course,","since","the","proposed","algorithm","is","distributed,","all","players\nm=","1,...,Mapply","the","same","algorithm","based","on","their","own","observations.","","When\nproviding","pseudo-code,","it","is","understood","that","each","player","follows","the","same","pseudo\ncode,","in","a","distributed","fashion.","","When","stating","our","algorithms","we","use","the","notation\nX+=xto","denoteX←X+x,","i.e.","","addxtoX.","","All","additional","subroutines","as\nwell","as","proofs","are","presented","in","the","supplementary","material.\n2.1","","","","Step","1:","","Agreement","on","a","good","arm\nThe","first","step","of","the","proposed","algorithm","is","theFindGoodArmsubroutine.","","The\ngoal","of","this","subroutine","is","for","all","playersm=","1,...,Mto","agree","on","a","”good”","arm\n","̃\nk,","in","the","sense","thatμ\n","̃\nk\n≥\n1\n8\nμ\n(1)\n,as","well","as","output","an","lower","bound","onμ\n","̃\nk\n.\nThis","subroutine","is","the","cornerstone","of","our","algorithm,","and","the","main","reason","why\nour","algorithm","does","not","suffer","from","(i)","a","regret","scaling","inversely","proportionally\nto","the","reward","of","the","first","armO(\n1\nμ\n(K)\n)","(ii)","requiring","a","non","trivial","lower","bound\nofμ\n(K)\nas","an","input","parameter,","while","all","state-of-the-art","algorithms","suffer","from\n3\n\nproblems","(i)","and","(ii).","","Indeed,","once","a","good","arm","is","identified,","one","can","use","this\narm","to","exchange","information","between","players,","and","arms","with","very","low","rewards\nhave","no","bearing","on","performance","and","can","be","mostly","ignored.\nTheFindGoodArmsubroutine","is","designed","such","that,","with","high","probability,\nnot","only","all","players","agree","on","the","same","good","arm,","but","also","that","they","all","terminate\nthe","procedure","at","the","same","time.","","This","is","important","to","maintain","synchronization,\nand","achieving","this","synchronization","involves","a","non-trivial","idea","which","we","show\nnext.\nTheFindGoodArmsubroutine","is","broken","in","successive","phases,","and","each","phase\np≥1","has","two","sub-phases.","","In","the","first","sub-phase","of","phasep,","each","player","selects\nan","arm","uniformly","at","random","6K2\np\nln\n2\nδ\ntimes","and","observes","the","resulting","rewards.\nFor","each","armk=","1,...,K,","each","player","computesˆμ\np\nk\nwhich","is","the","ratio","between\nthe","sum","of","rewards","obtained","from","armkand","the","number","of","times","armkhas\nbeen","selected.","","Ifˆμ\np\nk\n≥2\n1−p\nwe","say","that","the","player","accepts","armkat","phasep\n(i.e.","","he","believes","thatμ\nk\nis","greater","than","2\n−p\n)","and","otherwise","he","rejects","armkat\nphasep.","","In","the","second","sub-phase,","the","players","attempt","to","reach","agreement","on\none","good","arm.","","For","all","arms`=","1,...,K,","if","a","player","accepts","arm`at","phasep,","he\nchooses","an","arm","uniformly","at","randomK2\np\nln\n2\nδ\ntimes","and","if","he","does","not","accept`\nthen","he","chooses","arm`forK2\np\nln\n2\nδ\ntimes.","","If","arm`yields","at","least","one","non-zero\nreward","then","we","say","that","the","player","confirms","arm`in","phasep.","","If","there","exists\n","̃\nksuch","that","the","player","confirms\n","̃\nk,","then","the","procedure","stops","and\n","̃\nkis","output.\nThis","mechanism","is","designed","so","that,","with","high","probability,","the","procedure","does\nnot","exit","until","all","players","have","agreed","on","a","good","arm.","","Indeed,","if","at","least","one","of\nthe","player","rejects","arm`,","then","he","will","select","arm`all","the","time,","and","no","non-zero\nreward","can","be","obtained","from`,","preventing","other","players","from","confirming","armk.\nTo","summarize","theFindGoodArmsubroutine","involves","sampling","arms","uniformly\nat","random","more","and","more,","until","at","least","one","of","them","has","a","large","enough","reward,\nand","","periodically","","exchanging","","information","","between","","players","","in","","order","","to","","reach\nagreement","over","one","good","arm,","and","once","agreement","is","reached,","the","procedure\nstops.","","Lemma","1","provides","an","analysis","ofFindGoodArmand","its","pseudo-code","is\ngiven","below.\nLemma","1Consider","theFindGoodArmsubroutine","with","input","parametersKand\nδ.","","Then,","with","probability","greater","than1−C\n1\nKM(ln\n1\nμ\n(1)\n)δ:\n(i)","","The","","subroutine","","lasts","","at","","mostC\n2\nK\n2\nμ\n(1)\nln\n1\nδ\ntime","","slots","","causing","","at","","most\nC\n2\nK\n2\nMln\n1\nδ\nregret.\n(ii)","The","output\n","̃\nkis","a","”good”","arm","i.e.μ\n","̃\nk\n≥\n1\n8\nμ\n(1)\n(iii)","The","output","̄μis","a","lower","bound","on","the","expected","reward","of\n","̃\nki.e.μ\n","̃\nk\n≥","̄μ\n(vi)","All","players","exit","the","subroutine","at","exactly","the","same","time","and","output","the\nsame","arm\n","̃\nkand","estimate","̄μ\nwhereC\n1\n,C\n2\nare","universal","constants.\n4\n\nAlgorithm","1FindGoodArm(for","playerm=","1,...,M))\nRequire:K:","","number","of","arms",",δ:","","confidence","parameter\nEnsure:\n","̃\nk:","","good","arm,","","̃μlower","bound","on","reward","of\n","̃\nk\n#","initialization\np←0,C[`]←0","for`=","1,...,K\nwhilemax\n`=1,...,K\nC[`]","=","0do\n#","current","phase\np+=","1\n#","rewards","and","number","of","samples\nR[k],N[k]←0","fork=","1,...,K\n#","sub-phase","1:","","explore","arms","uniformly","at","random\nfort=","1,...,6K2\np\nln\n2\nδ\ndo\nSelect","armk∈{1,...,K}uniformly","at","random","and","observe","rewardr\nUpdateR[k]","+=r,N[k]","+=","1\nend","for\n#","sub-phase","2:","","confirm","accepted","arms\nfor`←1,...,Kdo\n#","rewards","and","number","of","samples\nR\n′\n[k],N\n′\n[k]←0","fork=","1,...,K\n#","if","arm`was","accepted","sample","arms","uniformly\nif\nR[k]\nN[k]\n≥2\n1−p\nthen\nfort=","1,...,2\np\nKln\n2\nδ\ndo\nSelect","armk∈{1,...,K}uniformly","at","random","and","observe","reward\nr\nUpdateR\n′\n[k]","+=r,N\n′\n[k]","+=","1\nend","for\n#","if","a","non-zero","reward","is","obtained","confim","arm`\nifR\n′\n[`]≥1then\nC[`]←1\nend","if\n#","if","arm`was","rejected","only","sample`\nelse\nfort=","1,...,τ\n′\ndo\nSelect","armk=`and","observe","rewardr\nUpdateR\n′\n[`]","+=r,N\n′\n[`]","+=","1\nend","for\nend","if\nend","for\nend","while\n","̃\nk←arg","max\n`\nC[`],","","̃μ←2\n−p\nReturn\n","̃\nk,","̃μ\n5\n\nTimet\nvirtual","arm","1\nvirtual","arm","2\nvirtual","arm","3\nFigure","1:","","Mapping","between","a","single","real","arm","(below)","andKidentical","virtual\narms","(above).\n2.2","","","","Step","2:","","rank","assignment\nThe","","second","","part","","of","","our","","algorithm","","is","","the","","subroutineVirtualMusicalChairs\nwhich","","performs","","rank","","assignment.","","","Informally,","","the","","external","","rank","","is","","simply","","a\nnumber","in{1,...,K}such","that","all","players","are","assigned","a","different","rank.","","This\nallows","to","perform","orthogonalization","and","explore","arms","without","collisions","by","using\nsequential","hopping","as","done","in","[3].\nAs","the","name","indicates,","subroutineVirtualMusicalChairsis","based","on","the","so-\ncalled","Musical","Chairs","algorithm","where","users","repeatedly","choose","an","arm","at","random\nuntil","they","obtain","a","non-zero","reward","and","then","keep","sampling","this","very","same","arm,\nwhich","will","also","be","their","external","rank.","","However,","the","Musical","Chairs","used","in","[3]\nis","not","satisfactory","since","it","samples","from","all","armsk=","1,...,Kand","therefore","its\nperformance","is","limited","by","the","worse","arm","and","its","regret","scales","proportionally","to\nO(\n1\nμ\n(K)\n),","and","requires","a","lower","bound","onμ\n(K)\nas","an","input","parameter.\nInstead","we","propose","to","adapt","this","algorithm","to","only","sample","from","one","unique\ngood","arm\n","̃\nksuch","as","the","one","derived","by","theFindGoodArmsubroutine.","","To","do","so\nwe","map","this","unique","good","arm","intoK”virtual”","arms","which","are","identical","copies\nof","the","good","arm\n","̃\nk\n.","","We","simply","do","so","by","time","division.","","We","divide","time","in","blocks\nof","lengthK,","and","for`=","1,...,K,","the`-th","time","slot","of","each","block","is","mapped\nto","the`-th","virtual","arms.","","This","idea","is","illustrated","in","Figure","1","where","one","actual\narm","is","mapped","intoKvirtual","arms.","","It","is","noticed","that","a","player","actually","selects\n6\n\none","arm","everyKtime","steps","on","average.","","It","is","also","noted","that,","due","to","this","idea\nof","virtual","arms,VirtualMusicalChairscan","be","analyzed","simply","by","considering\nthe","classical","musical","chairs","algorithm","applied","toKidentical","arms","with","mean\nrewardμ\n","̃\nk\n.","","Lemma","2","provides","an","analysis","ofVirtualMusicalChairsand","its\npseudo-code","is","given","below.\nLemma","2Considerδ",">0.","","Consider","","the","","subroutineVirtualMusicalChairs\nwith","input","parametersK,","a","good","arm\n","̃\nkandτ=\nK\nμ\n","̃\nk\nln\n1\nδ\n.","","Then","the","subroutine\nexits","afterKτtime","slots,","incurring","regret","at","most8K\n2\nMln\n1\nδ\nand","with","probability\ngreater","than1−C\n3\nKMδit","assigns","a","distinct","external","rank","to","al","l","of","theMplayers\nwhereC\n3\nis","a","universal","constant.\nAlgorithm","2VirtualMusicalChairs(for","playerm=","1,...,M)\nRequire:K:","","number","of","arms,\n","̃\nk:","","a","good","arm,τ:","","sampling","time\nEnsure:s:","","external","rank","of","the","player\n#","rank","of","the","player","is","initial","ly","unset\ns←−1;\n#","musical","chairs","on","the","arm\n","̃\nk\nfort←1,...,Kτdo\n#","time","is","split","in","blocks","of","sizeKand","we","select","when","to","sample","at","the","start\nof","a","block.\nifmod","(t,K)","=","1then\nifs=−1then\n#","Choose","a","random","slot","if","rank","is","unset\nDraw`∈{1,...,K}uniformly","at","random\nelse\n#","Choose","the","rank","as","a","slot","if","it","is","set\n`←s\nend","if\nend","if\n#","sample","the","corresponding","time","slot\nifmod","(t,K)","=`then\nSelect","arm\n","̃\nk,","and","observe","rewardr\n#","set","rank","if","it","was","not","set","yet","and","a","non","zero","reward","was","obtained\nifr",">0","ands=−1then\ns←m\nend","if\nelse\nDo","not","select","an","arm.\nend","if\nend","for\nReturns\n7\n\n2.3","","","","Step","3:","","Computation","of","the","number","of","players\nThe","third","step","of","the","proposed","algorithm","is","theVirtualNumberPlayerssub-\nroutine","which","allows","players","to","estimate","the","number","of","playersM.","","Subroutine\nVirtualNumberPlayerstakes","as","an","inputKthe","number","of","players,\n","̃\nka","good\narm,sthe","external","rank","of","a","player,τa","sampling","time,","all","of","which","are","available\nfrom","the","previous","subroutines.\nOnce","","again","","we","","combine","","the","","sequential","","hopping","","technique","","used","","by","","[3]","","to\nestimateMalong","with","the","idea","of","virtual","arms,","","so","that","the","procedure","only\nsamples","from","a","good","arm\n","̃\nk,","and","hence","is","not","impacted","by","the","presence","of","some\narms","with","low","reward.\nTo","estimateM,","we","initialize","our","estimate","as\nˆ\nM=","1,","and","then","we","perform\nsequential","hopping","as","if","there","were\nˆ\nMplayers.","","If","at","least","one","non-zero","rewards","we\noutput\nˆ\nM,","and","otherwise","(since","this","implies","that","some","collisions","have","occurred)\nwe","increment\nˆ\nMand","repeat","the","procedure","and","so","on.","","As","a","byproduct,","we","also\noutput","the","internal","rankj∈","{1,...,M},","not","to","be","confused","with","the","external\nranks∈{1,...,K}.","","Each","player","is","assigned","a","different","internal","rank,","and","it","will\nserve","for","the","last","step","of","our","algorithm,","in","order","to","assign","roles","when","exploring\nthe","various","arms.\nLemma","3\nConsiderδ",">0.","","Consider","","the","","subroutineVirtualNumberPlayers\nwith","input","parametersK,","a","good","arm\n","̃\nkandτ=\n1\nμ\n","̃\nk\nln\n1\nδ\n.","","Then","the","subroutine\nexits","afterK\n2\nτtime","slots","causing","at","mostC\n4\nK\n2\nMln\n1\nδ\nregret,","and","with","probability\ngreater","than1−C\n5\nδ,","it","both","outputs","a","correct","estimate","of","the","number","of","players\nˆ\nM=M,","and","it","assigns","a","distinct","internal","rankj∈{1,...,M}to","all","of","theM\nplayers.","","BothC\n4\nandC\n5\nare","universal","constants.\n2.4","","","","Step","4:","","Distributed","exploration","and","finding","the","best\narms\nThe","last","step","is","subroutineDistributedExploration,","which","takes","as","an","input\nK\nthe","number","of","arms,jthe","internal","rank","of","the","player,τa","sampling","time,","and\noutput","one","arm","amongst","theMbest","arms,","which","is","assigned","to","the","player.\nDistributedExplorationis","similar","to","the","exploration","strategy","used","in","[9]\nand","its","analysis","provided","in","lemma","4","follows","along","similar","lines,","so","we","simply\nhighlight","the","main","steps","of","this","procedure.","","The","player","with","internal","rankj=","1\nis","called","the","leader,","and","other","players","are","called","the","followers.","","The","procedure\noperates","in","phases,","and","in","phasep,","the","active","players","(the","players","that","have\nnot","been","assigned","an","arm","yet)","sample","each","active","arm","(the","arms","for","which\nplayers","have","not","figured","out","whether","or","not","they","are","amongst","theMbest","arms)\n2\np\ndln\n1\nδ\ne\ntimes","using","sequential","hopping","(so","that","no","collisions","occur).","","Then","all\nfollowers","send","their","estimates","to","the","leader,","the","leader","aggregates","their","estimates,\ndetermines","which","arms","can","be","accepted","(the","arms","for","which","one","is","sure","that\nthey","are","amongst","theMbest","arms)","and","rejected","(the","arms","for","which","one","is\nsure","that","they","are","not","amongst","theMbest","arms)","and","then","sends","the","sets","of\n8\n\nAlgorithm","3VirtualNumberPlayers(for","playerm=","1,...,M)\nRequire:K:","","number","of","players,\n","̃\nka","good","arm,sexternal","rank","of","a","player,τ\nsampling","times\nEnsure:\nˆ\nM:","","estimated","number","of","players,j:","","internal","rank","of","the","player\n#","initialization\nˆ\nM←1,`←s,j←1\nforn=","1,...,2Kdo\nifn",">2sthen\n#","sequential","hopping\n`←mod","(`+","1,K)\nend","if\n#","sum","of","rewards","from","the","good","arm\nR←0\n#","sample","from","the","good","arm\nfork=","1,...,Kdo\nif`6=kthen\nfort=","1,...,τdo\nDo","not","select","any","arm\nend","for\nelse\n#","sample","from","virtual","armτtimes\nfort=","1,...,τdo\nSelect","arm\n","̃\nkand","observe","rewardr\nUpdateR+=r\nend","for\n#","if","no","non-zero","reward","was","obtained","increase","the","estimated","number\nof","players\nifR=","0then\nˆ\nM+=","1,\nifn≤2sthen\nj+=","1\nend","if\nend","if\nend","if\nend","for\nend","for\nReturn(\nˆ\nM,j)\n9\n\naccepted","and","rejected","arms","back","to","the","followers.","","If","an","arm","is","accepted","then","it","is\nassigned","to","an","active","player,","and","both","the","arm","and","the","player","become","inactive,\nand","the","player","simply","selects","the","assigned","arm","until","the","end","of","the","procedure.","","If\nan","arm","is","rejected","then","it","becomes","inactive.","","The","strategy","on","how","leader","and\nfollowers","act","in","this","information","exchange","step","is","given","in","subroutinesComFollow\nandComLeadin","appendix.","","In","essence,","the","leader","coordinates","and","takes","all","of\nthe","decisions,","while","followers","simply","collect","samples,","transmit","their","estimates\nit","and","receive","orders","on","what","to","do","next.","","The","strategy","to","send","and","receive\ndata","between","leader","and","followers","is","given","in","subroutinesEncoderSendFloat\nandEncoderReceiveFloatin","appendix.\nLemma","4Considerδ",">0andT≥0.\nConsider","the","subroutineDistributedExplorationwith","input","parametersK,\n","̃\nkandτ=\n1\nμ\n","̃\nk\nln\n1\nδ\napplied","with","time","horizonT(\n1\n).","","Then","with","probability","greater\nthat1−C\n6\nδKM(lnT)\n2\nthe","subroutine","incurs","a","regret","upper","bounded","by\nC\n7\n∑\nk>M\nln\n1\nδ\nμ\n(M)\n−μ\n(k)\n+C\n8\nKM\n2\nln\n(\n1\nμ\n(M)\n−μ\n(M+1)\n)\n2\nand","assigns","one","distinct","arm","to","each","player","from","the","set","of","theMbest","arms,\nwhereC\n6\n,C\n7\n,C\n8\nare","universal","constants.\n2.5","","","","Putting","it","together\nThe","complete","proposed","algorithm","is","presented","in","9,","and","combines","the","four","steps\nabove.","","It","is","noted","that","our","proposed","algorithm","is","in","fact","a","procedure","to","identify\nthe","set","of","best","arms.","","To","turn","it","into","an","algorithm","for","minimizing","regret","over","a\ntime","horizon","ofT,","one","can","simply","run","the","proposed","algorithm","with","confidence\nparameterδ=\n1\nT\n,","and","then","let","players","select","the","arm","that","has","been","assigned\nto","them","by","the","algorithm","until","the","time","horizon","runs","out.","","The","regret","upper\nbound","of","Theorem","1","is","our","main","result,","and","is","simply","proven","by","combining","the\nfour","previous","lemmas.","","As","promised,","unlike","all","state","of","the","state-of-the-art,","our\nalgorithm","does","not","need","as","an","input","any","information","such","as","the","number","of","arms\nMor","the","reward","of","the","worse","channelμ\n(K)\n,","and","its","regret","does","not","depend","on\nμ\n(K)\n.","","The","regret","bound","is","much","better","than","that","of","SIC-MMAB2","and","EC-SIC,\nin","the","sense","that","the","term","proportional","to\n1\nμ\n(K)\n(which","can","be","arbitrarily","large),\nhas","been","eliminated","i.e.","","performance","is","not","limited","by","the","worse","arm","anymore.\nThis","causes","a","dramatic","performance","gain","which","is","seen","in","numerical","experiments\nshown","below.\nLemma","1ConsiderT≥0.","","","First","","apply","","the","","proposed","","algorithm","","with","","input\nparametersKandδ=\n1\nT(lnT)\nwith","","time","","horizonT,","","let\n","̄\nkdenote","","its","","output,\n1\nApplying","a","procedure","with","time","horizonTsimply","means","that,","if","it","does","not","terminate\nbeforeTon","its","own,","then","its","execution","is","immediately","stopped","when","timeTis","reached.\n10\n\nAlgorithm","4DistributedExploration(for","playersm=","1,...,M)\nRequire:K:","","number","","of","","arms,j:","","internal","","rank","","of","","a","","player,M:","","number","","of\nplayers,\n","̃\nk:","","a","good","arm,τsampling","time\nEnsure:fan","arm","amongst","theMbest","arms","assigned","to","the","player\n#","initialization\nInitializep←0;f←−1;\n#","rewards","and","number","of","samples","for","each","arm\nR[k],v[k]←0","fork=","1,...,K\n#","rewards","and","number","of","samples","for","each","arm","held","by","each","players,","only\nstored","by","the","leader\nifj=","1then\nform=","1,...,Mandk=","1,...,Kdo\nˆμ[k,m],N[k,m]←0\nend","for\nend","if\n#","number","of","active","players\nM\n′\n←\nˆ\nM\n#","set","of","active","arms\nK←{1,...,K}\nwhilef=−1do\n#","start","phasep\np+=","1\n#","first","sub-phase","explore","arms","by","sequential","hopping\nk←j\nfort←1,...,|K|2\np\n⌈\nln\n1\nδ\n⌉\ndo\nk←(k+","1)","","mod|K|\nSelect","armk,","observe","rewardr\nUpdateR[k]←R[k]","+r,v[k]","+=","1,E[k]←\nR[k]\nv[k]\nend","for\n#","second","sub-phase:","","share","estimates","between","players\nQ←d\np\n2\n+","3e\nifj=","1then\n#","player","is","a","leader\n(f,K,M\n′\n,ˆμ,N)←ComLeader(ˆμ,N,K,M\n′\n,Q,τ,\n","̃\nk,p,δ)\nelse\n#","player","is","a","follower\n(f,K,M\n′\n)←ComFollow(E,j,K,M\n′\n,Q,τ,\n","̃\nk)\nend","if\nend","while\n11\n\nand","select","arm\n","̄\nkfor","the","remaining","time","steps.","","Then","the","expected","regret","of","this\nprocedure","is\nR(T)≤C\n9\n∑\nk>M\nlnT\nμ\n(M)\n−μ\n(k)\n+C\n10\nK\n2\nMlnT+C\n11\nKM\n2\nln\n(\n1\nμ\n(M)\n−μ\n(M+1)\n)\n2\nwithC\n9\n,C\n10\n,C\n11\nthree","universal","constants.\nAlgorithm","5Proposed","algorithm","(for","playerm=","1,...,M)\nRequire:K:","","number","of","arms,δ:","","confidence","level\nEnsure:\n","̄\nkan","arm","amongst","theMbest","arms","assigned","to","the","player\n#","find","a","good","arm","and","a","lower","bound","on","its","reward\n(\n","̃\nk,","̃μ)←FindGoodArm(K,δ)\n#","assign","external","rank","to","each","player\ns←VirtualMusicalChairs(K,\n","̃\nk,Kln(\n1\nδ\n)/","̃μ)\n#","estimate","the","number","of","players","and","assign","internal","rank\n(\nˆ\nM,j)←VirtualNumberPlayers(K,\n","̃\nk,s,log(\n1\nδ\n)/","̃μ)\n#","find","one","arms","out","of","theMbest","arms\n","̄\nk←DistributedExploration(K,j,\nˆ\nM,\n","̃\nk,log(\n1\nδ\n)/","̃μ)\nOutput\n","̄\nk\n3","","","","Numerical","Experiments\nWe","now","compare","the","empirical","performance","of","the","proposed","algorithm","against\nthe","","state-of-the-art","","algorithms","","SIC-MMAB2","","and","","EC-SIC.","","For","","simplicity","","we\nassume","that","rewards","decrease","from","best","to","worst","in","a","linear","fashion\nμ\n(k)\n=μ\n(1)\n+\nk−1\nK−1\n(μ\n(K)\n−μ\n(1)\n)\nThe","regret","of","algorithms","is","averaged","over","20","(or","more)","independent","runs,","and\n95%","confidence","intervals","are","presented.\nInfluence","","of","","the","","number","","of","","usersIn","","our","","first","","set","","of","","experiments,","","we\nconsiderμ\n(1)\n=","1","andμ\n(K)\n=","0.01,M=bK/2c.","","We","plot","the","expected","regret\nof","the","various","algorithms","for","different","system","sizesK=","5,10,20","on","figures","2,3\nand","4","respectively.","","Overall,","the","proposed","algorithms","clearly","outperform","EC-SIC\nand","SIC-MMAB2,","sometimes","by","several","orders","of","magnitude,","and","the","difference\nseems","more","and","more","severe","whenKincreases.\nInfluence","","of","","the","","gapFigure","","2","","and","","3","","considersμ\nM\n−μ\nM+1\n=","","0.2","","and\nμ\nM\n−μ\nM+1\n=","0.1.","","We","see","that","sometimes","the","proposed","algorithm","performs","a\nbit","worse","than","other","algorithms","for","very","small","time","horizons,","however","for","larger\ntime","horizons","it","does","ouperform","SIC-MMAB2","and","EC-SIC","which","seem","not","to\nconverge","quickly","enough.\n12\n\n0246810\nTime","T\n#10\n5\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nCumulative","regrets\n#10\n4\nSIC-MMAB2\nEC-SIC\nProposed","algorithm\nFigure","2:K=","5,M=","2,T=","10\n5\n0246810\nTime","T\n#10\n5\n0\n2\n4\n6\n8\n10\n12\n14\nCumulative","regrets\n#10\n5\nSIC-MMAB2\nEC-SIC\nProposed","algorithm\nFigure","3:K=","10,M=","5,T=","10\n6\n0246810\nTime","T\n#10\n6\n0\n0.5\n1\n1.5\n2\n2.5\nCumulative","regrets\n#10\n7\nSIC-MMAB2\nEC-SIC\nProposed","algorithm\nFigure","4:K=","20,M=","10,T=","10\n7\nImpact","of","the","number","of","players\nOn","figures","5","and","6","we","compare","between\nM=","2","users","andM=","8","users.","","ForM=","2,","both","the","proposed","algorithm","and\nEC-SIC","","do","","converge.","","","However,","","whenMincreases,","","the","","collision","","probability\nbecomes","larger,","causing","EC-SIC","to","spend","a","lot","of","times","to","perform","musical","chairs\nand","estimatingM.\n13\n\n0246810\nTime","T\n#10\n5\n0\n1\n2\n3\n4\n5\n6\n7\n8\nCumulative","regrets\n#10\n5\nSIC-MMAB2\nEC-SIC\nProposed","algorithm\nFigure","5:K=","10,M=","2,T=","10\n6\n0246810\nTime","T\n#10\n5\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nCumulative","regrets\n#10\n5\nSIC-MMAB2\nEC-SIC\nProposed","algorithm\nFigure","6:K=","10,M=","8,T=","10\n6\nImpact","of","the","worst","channelWe","present","the","regret","for","different","values\nofμ\n(K)\n.","","On","figure","7.","","Whenμ\n(K)\ndecreases,","we","can","see","that","the","performance","of\nSIC-MMAB2","and","EC-SIC","is","greatly","affected,","and","forμ\n(K)\n=","0.001","they","do","not\neven","start","the","exploration","phase.","","On","the","other","hand,","no","matter","how","smallμ\n(K)\nis,","the","cumulative","regret","of","the","proposed","algorithm","stays","similar,","which","confirms\nour","theoretical","predictions.\n14\n\n0246810\nTime","T\n#10\n4\n0\n1\n2\n3\n4\n5\n6\n7\nCumulative","regrets\n#10\n4\nSIC-MMAB2-mu\nmin\n=0.1\nEC-SIC-mu\nmin\n=0.1\nProposed","algorithm-mu\nmin\n=0.1\nSIC-MMAB2-mu\nmin\n=0.001\nEC-SIC-mu\nmin\n=0.001\nProposed","algorithm-mu\nmin\n=0.001\nFigure","7:K=","5,M=","2,T=","10\n5\nwith","differentμ\n(K)\n4","","","","Conclusion\nIn","this","work","we","have","proposed","a","new","algorithm","for","multi-player","multi-armed\nbandits","without","collision","sensing","information.","","Through","both","analysis","and","numer-\nical","experiments,","we","have","proven","that","it","performs","significantly","better","than","the\nstate-of-the-art","algorithms,","while","at","the","same","time","requiring","no","input","parameter\nother","than","the","number","of","arms.","","The","cornerstone","of","our","approach","is","a","novel,","non\ntrivial","distributed","procedure","to","enable","users","to","discover","a","good","arm","without","any\nprior","information","other","than","the","number","of","arms.","","We","believe","that","this","algorithm\nis","a","significant","contribution","to","the","problem,","as","not","only","the","algorithm","performs\nwell,","so","that","it","also","constitutes","a","step","towards","being","able","to","solve","multi-player\nmulti-armed","bandits","in","a","practical","setting","(like","cognitive","radio)","where","no","prior\ninformation","is","known","about","the","expected","rewards","of","the","arms.\nReferences\n[1]\nVenkatachalam","Anantharam,","Pravin","Varaiya,","and","Jean","Walrand.","","Asymp-\ntotically","efficient","allocation","rules","for","the","multiarmed","bandit","problem","with\nmultiple","plays-part","i:","","Iid","rewards.IEEE","Transactions","on","Automatic","Control,\n32(11):968–976,","1987.\n[2]Lilian","Besson","and","Emilie","Kaufmann.","","Multi-Player","Bandits","Revisited.","","vol-\nume","83","ofProceedings","of","Machine","Learning","Research,","pages","56–92.","PMLR,\n07–09","Apr","2018.\n[3]\nEtienne","Boursier","and","Vianney","Perchet.","Sic-mmab:","","Synchronisation","involves\ncommunication","in","multiplayer","multi-armed","bandits.","","InProc.","of","NIPS,","2019.\n[4]Olivier","Cappe,","Aurelien","Garivier,","Odalric-Ambrym","Maillard,","Remi","Munos,\nand","Gilles","Stoltz.","","Kullback–leibler","upper","confidence","bounds","for","optimal\nsequential","allocation.The","Annals","of","Statistics,","41(3):1516–1541,","Jun","2013.\n15\n\n[5]Tze","Leung","Lai","and","Herbert","Robbins.","","","Asymptotically","efficient","adaptive\nallocation","rules.Advances","in","applied","mathematics,","6(1):4–22,","1985.\n[6]Keqin","Liu","and","Qing","Zhao.","","Distributed","learning","in","multi-armed","bandit","with\nmultiple","players.IEEE","Transactions","on","Signal","Processing,","58(11):5667–5681,\n2010.\n[7]Gabor","Lugosi","and","Abbas","Mehrabian.","Multiplayer","bandits","without","observing\ncollision","information.","","arXiv","1808.08416,","2018.\n[8]Jonathan","Rosenski,","Ohad","Shamir,","and","Liran","Szlak.","","Multi-player","bandits–a\nmusical","chairs","approach.","","InInternational","Conference","on","Machine","Learning,\npages","155–163,","2016.\n[9]\nChengshuai","Shi,","","Wei","Xiong,","","Cong","Shen,","","and","Jing","Yang.","","Decentralized\nmulti-player","multi-armed","bandits","with","no","collision","information.","","InProc.","of\nAISTATS,","2020.\n[10]\nWilliam","Thompson.","On","the","likelihood","that","one","unknown","probability","exceeds\nanother","in","view","of","the","evidence","of","two","samples.Biometrika,","25(3-4):285–294,\n12","1933.\n[11]Po-An","Wang,","Alexandre","Proutiere,","Kaito","Ariu,","Yassir","Jedra,","and","Alessio\nRusso.","","Optimal","algorithms","for","multiplayer","multi-armed","bandits.","","InProc.\nof","AISTATS,","2020.\nA","","","","Proofs\nA.1","","","","Technical","results\nWe","recall","some","well","known","concentration","inequalities","used","for","our","analysis.\nProposition","1","(Multiplicative","Chernoff","Bound)\nConsiderX\n1\n,...,X\nt\ni.i.d.\nrandom","variables","in[0,1]with","expectationμ,","then","for","al","l\u000f∈[0,1]\nP\n(\n1\nt\nt\n∑\ns=1\nX\ns\n≤(1−\u000f)μ\n)\n≤exp\n(\n−\n\u000f\n2\ntμ\n2\n)\nand\nP\n(\n1\nt\nt\n∑\ns=1\nX\ns\n≥(1","+\u000f)μ\n)\n≤exp\n(\n−\n\u000f\n2\ntμ\n2","+\u000f\n)\nProposition","2","(Hoeffding’s","Inequality)ConsiderX\n1\n,...,X\nt\ni.i.d.","","random\nvariables","in[0,1]with","expectationμ,","then","for","al","l\u000f∈[0,1]\nP\n(\n1\nt\nt\n∑\ns=1\nX\ns\n≤μ−\u000f\n)\n≤exp\n(\n−2t\u000f\n2\n)\n16\n\nand\nP\n(\n1\nt\nt\n∑\ns=1\nX\ns\n≥μ+\u000f\n)\n≤exp\n(\n−2t\u000f\n2\n)\nA.2","","","","Proof","of","Lemma","1\nWhen","all","users","sample","a","channel","uniformly","at","random,","the","probability","that","a\nusermexperiences","collisions","is","(1−\n1\nK\n)\nM−1\n,","and","the","expected","reward","he","obtains\nwhen","selecting","channelkis","thereforeρ\nk\n=","(1−\n1\nK\n)\nM−1\nμ\nk\n.\nFor","phasep≥1,","playerm=","1,...,Mand","channelkwe","denote","byˆμ\np\nk,m\nthe\nempirical","mean","reward","received","by","playermfrom","armkduring","phasep,","denote\nbyt\np\nk,m\nthe","corresponding","number","of","samples.\nAcceptance","in","the","first","sub-phaseAssume","thatρ\nk\n≥2\n2−p\nthen:\nP(ˆμ\np\nk,m\n≤2\n1−p\n)≤P(ˆμ\np\nk,m\n≤2\n1−p\n,t\np\nk,m\n≥3×2\np\nln\n2\nδ\n)","+P(t\np\nk,m\n≤3×2\np\nln\n2\nδ\n)\nSinceˆμ\np\nk,m\nis","an","empirical","mean","oft\np\nk,m\ni.i.d.","","random","variables","in","[0,1]","with\nexpectationρ\nk\n≥2\n2−p\na","Chernoff","bound","yields:\nP(ˆμ\np\nk,m\n≤2\n1−p\n,t\np\nk,m\n≥3×2\np\nln\n2\nδ\n)≤exp(−\n4\n3\nln\n2\nδ\n)≤\nδ\n2\nSincet\np\nk,m\nis","an","empirical","mean","of","6K2\np\nln\n2\nδ\ni.i.d.","","random","variables","in","[0,1]","with\nexpectation\n1\nK\na","Chernoff","bound","yields:\nP(t\np\nk,m\n≤3×2\np\nln\n2\nδ\n)≤exp(−3×2\np−2\nln\n2\nδ\n)≤\nδ\n2\nWe","have","proven","that","ifρ\nk\n≥2\n2−p\nthenP(ˆμ\np\nk,m\n≤2\n1−p\n)≤δ,","so","that","armkwill\nbe","accepted","at","phasepby","usermwith","probability","greater","than","1−δ.\nRejection","in","the","first","sub-phaseAssume","thatρ\nk\n≤2\n−p\nthen","once","again:\nP(ˆμ\np\nk,m\n≥2\n1−p\n)≤P(ˆμ\np\nk,m\n≥2\n1−p\n,t\np\nk,m\n≥3×2\np\nln\n2\nδ\n)","+P(t\np\nk,m\n≤3×2\np\nln\n2\nδ\n)\nSinceˆμ\np\nk,m\nis","an","empirical","mean","oft\np\nk,m\ni.i.d.","","random","variables","in","[0,1]","with\nexpectationρ\nk\n≤2\n−p\na","Chernoff","bound","yields:\nP(ˆμ\np\nk,m\n≥2\n1−p\n,t\np\nk,m\n≥3×2\np\nln\n2\nδ\n)≤exp(−ln\n2\nδ\n)","=\nδ\n2\nSincet\np\nk,m\nis","an","empirical","mean","of","6K2\np\nln\n2\nδ\ni.i.d.","","random","variables","in","[0,1]","with\nexpectation\n1\nK\na","Chernoff","bound","yields:\nP(t\np\nk,m\n≤3×2\np\nln\n2\nδ\n)≤exp(−3×2\np−2\nln\n2\nδ\n)≤\nδ\n2\nWe","have","proven","that","ifρ\nk\n≤2\n−p\nthenP(ˆμ\np\nk,m\n≥2\n1−p\n)≤δ,","so","that","armkwill\nbe","rejected","by","usermat","phasepwith","probability","greater","than","1−δ.\n17\n\nConfirmation","in","the","second","sub-phaseConsider","armkIf","there","exists\nat","least","one","user","whom","did","not","accept","this","arm","in","the","first","phase","then,","by","design,\nthis","arm","cannot","be","confirmed.","","On","the","other","hand,","assume","thatρ\nk\n≥2\n−p\nand\nassume","that","all","users","accept","armk.","","Denote","byR\np\nk,m\nthe","total","reward","received","by\nusermwhen","attempting","to","confirm","armk,","which","is","a","sum","of","2\np\nKln\n2\nδ\nBernoulli\nrandom","variables","with","mean\nρ\nk\nK\nso","that:\nP(R\np\nk,m\n=","0)","=","(1−\nρ\nk\nK\n)\nK2\np\nln\n2\nδ\n≤exp(−ρ\nk\n2\np\nln\n2\nδ\n)≤exp(−ln\n2\nδ\n)","=\nδ\n2\nwhere","we","used","the","inequality","1−x≤e\n−x\n.","","We","have","proven","that,","ifρ\nk\n≥2\n−p\nand","that","all","users","accept","armk,","then","armkwill","be","confirmed","by","usermin","the\nsecond","subphase","with","probability","greater","and","the","procedure","will","terminate","with\nprobability","greater","than","1−\nδ\n2\nPutting","","things","","togetherWe","can","now","check","that","all","statements","of","the\ntheorem","are","true.","","We","will","use","the","fact","that","sinceρ\nk\n=μ\nk\n(1−1/K)\nM−1\nand","we\nhave\n(1−1/e)μ\nk\n≤(1−1/K)\nK−1\nμ\nk\n≤ρ\nk\n≤μ\nk\n.\nStatement","(i)","Definek\n?\n∈arg","max\nk=1,...,K\nρ\nk\n.","","Definep\n?\nthe","smallestpsuch\nthatρ\nk\n?\n≥2\n2−p\n.","","With","probability","greater","than","1−O(Mδ)","all","users","will","accept\narmk\n?\nin","phasep\n?\nand","with","probability","greater","than","1−O(Mδ)","all","users","will\nconfirm","armk\n?\nso","that","the","procedure","will","terminate.","","So,","with","probability","greater\nthan","1−O(Mδ),","the","procedure","terminates","at","or","before","phasep\n?\n.","","The","duration\nof","phasepis","(6","+K)K2\np\nln\n1\nδ\n,","so","that","the","duration","of","the","procedure","up","to","phase\np\n?\nis:\n(6","+K)Kln\n1\nδ\np\n?\n∑\np=1\n2\np\n=O(K\n2\n2\np\n?\nln\n1\nδ\n)","=O(\nK\n2\nρ\nk\n?\nln\n1\nδ\n)","=O(\nK\n2\nμ\nk\n?\nln\n1\nδ\n)\nusing","the","fact","thatρ\nk\n≥(1−1/e)μ\nk\nwhich","is","the","announced","duration.","","Further-\nmore,","the","amount","of","regret","caused","by","any","procedure","is","at","mostMμ\nk\n?\ntimes","its\nduration,","therefore","the","procedure","incurs","regret","at","most\nO(K\n2\nMln\n1\nδ\n)\nStatement","","(ii)","","Denote","","by\n","̃\nkthe","","output","","of","","the","","procedure.","","","Assume","","that\nρ\n","̃\nk\n≤2\n−p\n?\nthen","There","must","exist","some","usermthat","accepts","this","arm","at","some\nphase","1≤p≤p\n?\n,","and","sinceρ\n","̃\nk\n≤2\n−p\n,","this","happens","with","probability","at","most\nO(δp\n?\nKM).","","","On","","the","","other","","hand","","ifρ\n","̃\nk\n≥\n2\n−p\n?\nwe","","haveρ\n","̃\nk\n≥\n1\n8\nρ\nk\n?\nso","","that\nμ\n","̃\nk\n≥\n1\n8\nμ\nk\n?\nand\n","̃\nkis","a","good","arm.","","Hence","with","probability","at","least","1−O(MKp\n?\nδ)\nthe","procedure","outputs","a","good","arm.\nStatement","(iii)","Assume","that","the","procedure","terminates","at","phase","1≤p≤p\n?\n.\nWith","probability","at","least","1−O(MKp\n?\nδ)","we","have","thatρ\n","̃\nk\n≥\n2\n−p\nsince\n","̃\nk\nmust\nhave","been","accepted","by","at","least","one","user.","","Thereforeμ\n","̃\nk\n≥ρ\n","̃\nk\n≥\n2\n−p\n=","̄μ,","and","the\noutput","̄μis","indeed","a","lower","bound","on","the","expected","reward","of\n","̃\nkwith","probability\nat","least","1−O(MKp\n?\nδ).\n18\n\nStatement","(vi)","By","design","of","the","procedure,","all","users","must","output","the","same\narm","unless","they","do","not","exit","simultaneously.","","Denote","by\n","̃\nkthe","output","of","the\nprocedure.","","If","not","all","users","exit","the","procedure","simultaneously,","then","there","must\nexists","a","phasep=","1,...,p\n?\nand","an","armksuch","that","all","users","accept","armkbut","at\nleast","one","of","them","does","not","confirm","it.","","This","happens","with","probability","at","most\nO(Mp\n?\nδ),","therefore,","with","probability","at","least","1−O(Mp\n?\nδ)","all","users","exit","the\nprocedure","simultaneously.\nWe","also","note","thatp\n?\n=O(ln\n1\nμ\nk\n?\n).","","This","completes","the","proof.\nA.3","","","","Proof","of","Lemmas","2","and","3\nBy","designVirtualMusicalChairsandVirtualNumberPlayersterminate","after\nexactlyKτand","2Kτtime","steps","respectively.","","Furthermore","applying","those","two\nprocedures","is","equivalent","to","running","the","initialization","phase","of","SIC-MMAB","used\nby","[3],","in","a","system","withKidentical","channels","with","mean","rewardμ\n","̃\nk\n.","","Therefore,\nfrom","[3][Lemma","11],","we","have","that","the","both","of","those","procedures","succeed","with\nprobability","at","least","1−O(MKδ).","","Also,","as","stated","above,","the","amount","of","regret\ncaused","by","any","procedure","is","at","mostMμ\nk\n?\ntimes","its","duration,","therefore","both\nprocedures","incurs","regret","at","mostO(KτMμ\nk\n?\n)","=O(KMln\n1\nδ\n)\nA.4","","","","Proof","of","Lemma","4\nWe","now","analyze","theDistributedExplorationsubroutine.\nMaximal","number","of","phasesIt","is","noted","that","phaseplasts|K|2\np\ndln\n1\nδ\ne≥\n2\np\ndln\n1\nδ\ne\n.","","Since","the","time","horizon","isT,","the","maximal","number","of","phasesp\n?\nmust\nsatisfy\n2\np\n?\n≤2\np\n?\n+1\nln\n1\nδ\n=","ln\n1\nδ\np\n?\n∑\np=1\n2\np\n≤T\ntherefore","the","number","of","phases","is","upper","bounded","byp\n?\n≤ln\n2\nT.\nCommunication","errors\nConsider","the","subroutinesEncoderSendFloatand\nEncoderReceiveFloatfloat,","which","allow","to","send/receiveQbits","each","time","they\nare","called.","","By","design,","in","phasepthe","total","number","of","bits","sent","is","at","most\n3KMQ=","3KMd\np\n2\n+","3e\nHence","the","total","number","of","bits","sent","across","phases","is\nO(KM(p\n?\n)\n2\n)\nSince,","by","design","of","the","communication","protocol","and","the","fact","thatτ=\n1\nμ\n","̃\nk\nln\n1\nδ\n,\neach","time","a","bit","is","sent,","it","is","decoded","correctly","with","probability","greater","than\n1−δ.","","Therefore,","with","probability","greater","than","1−O(δKM(p\n?\n)\n2\n),","there","are","no\ncommunication","errors.\nEstimation","errorsNow","assume","that","no","communication","errors","have","taken\nplace,","and","denote","byˆμ\np\nk\nthe","estimate","of","the","mean","reward","of","channelkcomputed\n19\n\nby","the","leader","in","phasek,t\np\nk\nthe","corresponding","number","of","samples","and\nB\np\nk\n=\n√\n(2","ln\n1\nδ\n)/t\np\nk\n+","2\n−\np\n2\n−3\nWe","say","that","there","is","an","estimation","error","forkin","phasepif|ˆμ\np\nk\n−μ\nk\n|≥B\np\nk\n.","","We\nhave:\n|ˆμ\np\nk\n−μ\nk\n|≤|ˆμ\np\nk\n−E(ˆμ\np\nk\n)|+|μ\nk\n−E(ˆμ\np\nk\n)|\nThe","first","term","is","a","random","fluctuation","and","the","second","term","is","a","quantification\nerror","due","to","the","fact","that","users","send","quantified.","","SinceQ=\np\n2\n+","3","the","error","due\nto","quantification","is","upper","bounded","by\n|μ\nk\n−E(ˆμ\np\nk\n)|≤2\n−\np\n2\n−3\nAnd","using","Hoeffding’s","inequality","yields","an","upper","bound","for","the","estimation","error\nprobability:\nP(|ˆμ\np\nk\n−μ\nk\n|≥B\np\nk\n)≤P(|ˆμ\np\nk\n−E(ˆμ\np\nk\n)|≥\n√\n(2","ln\n1\nδ\n)/t\np\nk\n)≤δ\nConsidering","all","arms","and","all","phases",",","we","have","proven","that","with","probability","at\nleast","1−O(δKp\n?\n),","no","estimation","error","occurs","during","a","run","of","the","algorithm.\nBehaviour","on","a","clean","runWe","say","that","we","have","a","clean","run","if","no","com-\nmunication","errors","and","no","estimation","errors","occur","throughout","the","run","of","the\nalgorithm.","","We","have","already","established","that","clean","runs","occurs","with","probability\nat","least","1−O(δKM(p\n?\n)\n2\n).","","On","a","clean","run,","we","always","have","that\nˆμ\np\nk\n+B\np\nk\n≤μ\nk\nand\nˆμ\np\nk\n−B\np\nk\n≥μ\nk\nso","that","one","can","readily","check","that","ifkis","amongst","theMbest","arm,","it","can","never\nbe","rejected,","and","that","ifkis","not","amongst","theMbest","arms,","if","it","is","still","active","at\nphasepit","will","be","rejected","if","4B\np\nk\n≤μ\n(M)\n−μ\nk\n.","","Following","the","same","logic","as","[3],\none","can","establish","thatkis","selected","at","mostO(\nln\n1\nδ\n(μ\n(M)\n−μ\nk\n)\n2\n)","times,","and","that","the\nmaximal","number","of","phases","is","upper","bounded","by:\np\n?\n≤O\n(\nln\n(\n1\nμ\n(M)\n−μ\n(M+1)\n))\nRegret","on","a","clean","runWe","can","complete","the","proof","by","upper","bounding","the\nregret","on","a","clean","run.\nWe","first","turn","to","the","regret","caused","by","communication.","","Sending","a","bit","using","the\ndescribed","protocol","incurs","at","mostMμ\n(1)\nτ=Mln\n1\nδ\nregret","andO(KM(p\n?\n)\n2\n)","bits\nmust","be","sent,","therefore","the","regret","caused","by","communication","is","upper","bounded\nby\nO\n(\nKM\n2\nln\n(\n1\nμ\n(M)\n−μ\n(M+1)\n)\n2\n)\n20\n\nSince","no","collisions","occur,","optimal","arms","are","never","eliminated,","and","any","suboptimal\narmkis","","selected","","at","","mostO(\nln(1/δ)\n(μ\n(M)\n−μ\nk\n)\n2\n)","","times,","","the","","total","","regret","","caused","","by\nexploration","isO(\n∑\nk>M\nln\n1\nδ\nμ\n(M)\n−μ\nk\n).","","Therefore,","as","announced,","with","probability","at\nleast","than","1−O(δKM(lnT)\n2\n)","a","clean","run","occurs,","and","the","resulting","regret","is\nO\n(\nKM\n2\nln\n(\n1\nμ\n(M)\n−μ\n(M+1)\n)\n2\n+\n∑\nk>M\nln\n1\nδ\nμ\n(M)\n−μ\nk\n)\nwhich","completes","the","proof.\nB","","","","Additional","Subroutines\nWe","provide","here","the","pseudo-codes","for","the","remaining","subroutines.","","These","subrou-\ntines","are,","we","recall,","described","from","the","point","of","view","of","a","single","player,","which","is\nthe","natural","way","to","describe","a","decentralized","algorithm.\n21\n\nAlgorithm","6ComLeader\nRequire:ˆμestimates","held","by","each","player,Nnumber","of","samples","held","by","players,\nKset","","of","","active","","arms,M\n′\nnumber","","of","","active","","users,Qmessage","","length,τ:\nsampling","time,\n","̃\nk:","","good","channel,pphase,δconfidence","parameter\nEnsure:f\none","of","theMbest","channels","to","be","assigned","to","player,\n","̄\nKupdated\nversion","set","of","active","arms,\n","̄\nM\n′\nupdated","number","of","active","players,","̄μupdated\nestimates","held","by","players,\n","̄\nNupdates","number","of","samples","held","by","players\n","̄μ←ˆμ,\n","̄\nN←N\n#receive","the","updated","values","of","the","estimates","held","by","active","players\nfori←2,...,Mdo\nfork∈Kdo\n","̄μ[k,i]←DecoderReceiveFloat(\n","̃\nk,τ,Q)\n","̄\nN[k,i]←\n","̄\nN[k,i]","+","2\np\n⌈\nln\n1\nδ\n⌉\nend","for\nend","for\n#compute","the","estimates","aggregated","across","al","l","players","decide","which","arms","to\naccept","/","reject\nfork∈Kdo\n#compute","the","estimate","aggregated","across","al","l","players\nρ[k]←(\n∑\nM\ni=1\n","̄μ[k,i]\n","̄\nN)/(\n∑\nM\ni=1\n","̄\nN[k,i])\n#compute","confidence","radius\nB[k]←\n√\n(2","ln\n1\nδ\n)/(\n∑\nM\ni=1\n","̄\nN[k,i])","+","2\n−\np\n2\n−3\n#accept","arm\nif|{i∈K:ρ[k]−B[k]≥ρ[i]","+B[i]}|≥|K|−M\n′\nthen\nAddktoC[.,1]\nend","if\n#reject","arm\nif|{i∈K:ρ[i]−B[i]≥ρ[k]","+B[k]}|≥M\n′\nthen\nAddktoC[.,2]\nend","if\nend","for\n#message","size","to","send","accepted","/","rejected","arms\nQ\n′\n←dlog\n2\n|K|e\n#send","the","size","of","the","sets","of","accepted","/","rejected","arms\nfori←2,...,M\n′\nands=","1,2do\nEncoderSendInt(K,\n","̃\nk,τ,Q\n′\n,length(C[.,s]))\nend","for\n#send","the","contents","of","the","sets","of","accepted","/","rejected","arms\nfori←2,...,M\n′\nands=","1,2","andk∈C[.,s]do\nEncoderSendInt(K,\n","̃\nk,τ,Q\n′\n,k)\nend","for\nC\n′\n←Cand","remove\n","̃\nkfromC\n′\n[,.1]\n22\n\nifM\n′\n=length(C\n′\n[.,1])","andC=C\n′\nthen\nf←C[M\n′\n,1]\nelse","ifM\n′\n−1","=length(C\n′\n[.,1])","andC6=C\n′\nthen\n#assign","the","good","arm","to","the","leader\nf←\n","̃\nk\nelse\n#otherwise","make","accepted","and","rejected","arms","inactive","and","update","number\nof","active","users\n","̄\nM←M\n′\n−length(C[.,1])\nK\n′\n←K\nfork∈C\n′\ndo\nRemovekfromK\n′\nend","for\nend","if\n23\n\nAlgorithm","7ComFollow\nRequire:E:","","estimated","reward","of","each","arm","by","the","player,j:","","rank","of","the","player,\nK:","","set","of","active","arms,M\n′\n:","","number","of","active","players,Q:","","message","size,τ:\nsampling","time,\n","̃\nka","good","arm\nEnsure:,fone","of","theMbest","channels","to","be","assigned","to","player,\n","̄\nKupdated\nversion","set","of","active","arms,\n","̄\nM\n′\nupdated","number","of","active","players\nK\n′\n←K\\{\n","̃\nk}\n#send","reward","estimates","of","active","arms","to","the","leader\nfori=","2,...,M\n′\ndo\nifj=ithen\nfork∈Kdo\nEncoderSendFloat(K,\n","̃\nk,τ,Q,E[k])\nend","for\nelse\nfort=","1,...,|K|τQdo\nSelect","the","(jmod|K\n′\n|)-th","arm","in","setK\n′\nend","for\nend","if\nend","for\n#message","size","to","send","accepted","/","rejected","arms\nQ\n′\n←dlog\n2\n|K|e\n#receive","the","sizes","of","the","sets","of","accepted","and","rejected","arms\nfori←2,...,M\n′\ndo\nifj=ithen\nfors=","1,2do\nN[s]←DecoderReceiveInt(\n","̃\nk,τ,Q\n′\n)\nend","for\nelse\nfort=","1,...,2τQ\n′\ndo\nSelect","the","(jmod|K\n′\n|)-th","arm","in","setK\n′\nend","for\nend","if\nend","for\n#receive","the","contents","of","the","sets","of","accepted","and","rejected","arms\nfori←2,...,M\n′\ndo\nifj=ithen\nfors=","1,2","andq=","1,...,N[s]do\nC[q,s]←DecoderReceiveInt(\n","̃\nk,τ,Q\n′\n)\nend","for\nelse\nfort=","1,...,τQ\n′\n(N[1]","+N[2])do\nSelect","the","(jmod|K\n′\n|)-th","arm","in","setK\n′\nend","for\nend","if\nend","for\n24\n\n#update","the","set","of","active","arms,","and","the","active","users\n#avoid","assigning","the","good","arm","to","fol","lowers\nC←C\n′\nRemove\n","̃\nkfromC\n′\n[.,1]\n#if","an","accepted","arm","can","be","assigned","to","player","then","do","so\nifM\n′\n−j+","1≤length(C\n′\n[.,1])then\nf←C\n′\n[M\n′\n−j+","1,1]\n#otherwise","make","accepted","and","rejected","arms","inactive","and","update","number\nof","active","users\nelse\n","̄\nM←M\n′\n−length(C\n′\n[.,1])\n","̄\nK←K\nfork∈C\n′\ndo\nRemovekfrom\n","̄\nK\nend","for\nend","if\nAlgorithm","8EncoderSendFloat\nRequire:K:","","a","","subset","","of","","arms,\n","̃\nk:","","a","","good","","arm,τ:","","a","","sampling","","time,Q:","","the\nmessage","size,μ∈[0,1]","a","real","number","to","send\n#convert","the","number","to","send","to","a","binary","message","of","sizeQ\nS←FloatToBinary(μ,Q)\n#send","each","bit","of","the","binary","message\nforq=","1,...,Qdo\nifS[q]","=","1then\n#send","a1bit\n`←qmod|K\\\n","̃\nk|\nk←the`-th","arm","in","setK\\\n","̃\nk\nelse\n#send","a0bit\nk←\n","̃\nk\nend","if\nfort=","1,...,τdo\nSelect","armk\nend","for\nend","for\n25\n\nAlgorithm","9EncoderReceiveFloat\nRequire:\n","̃\nk:","","a","good","arm,τ:","","a","sampling","time,Q:","","the","message","size\nEnsure:μ∈[0,1]","a","received","real","number","to","send\n#decode","each","bit","of","the","binary","message\nforq=","1,...,Qdo\nB[q]←0\nfort=","1,...,τdo\nSelect","arm\n","̃\nkand","observe","rewardr\n#decode","a1bit","if","at","least","one","non","zero","reward","is","obtained\nifr",">0then\nB[q]←1\nend","if\nend","for\nend","for\n#convert","the","received","binary","message","to","a","real","number\nμ←BinaryToFloat(B,Q)\n26"],"doc1":["\n\nMultinomial","Logit","Contextual","Bandits:\nProvable","Optimality","and","Practicality\nMin-hwan","Oh\n1\nand","Garud","Iyengar\n2\n1\nSeoul","National","University,","Seoul,","South","Korea\n2\nColumbia","University,","New","York,","USA\n1\nminoh@snu.ac.kr,\n2\ngarud@ieor.columbia.edu\nAbstract\nWe","consider","a","sequential","assortment","selection","problem","where\nthe","user","choice","is","given","by","a","multinomial","logit","(MNL)","choice\nmodel","","whose","","parameters","","are","","unknown.","","In","","each","","period,","","the\nlearning","agent","observes","ad-dimensional","contextual","informa-\ntion","","about","","the","","user","","and","","theNavailable","","items,","","and","","offers\nan","assortment","of","sizeKto","the","user,","and","observes","the","ban-\ndit","","feedback","","of","","the","","item","","chosen","","from","","the","","assortment.","","We\npropose","","upper","","confidence","","bound","","based","","algorithms","","for","","this\nMNL","contextual","bandit.","The","first","algorithm","is","a","simple","and\npractical","method","which","achieves","an\n","̃\nO(d\n√\nT)regret","overT\nrounds.","Next,","we","propose","a","second","algorithm","which","achieves\na\n","̃\nO(\n√\ndT)regret.","This","matches","the","lower","bound","for","the","MNL\nbandit","problem,","up","to","logarithmic","terms,","and","improves","on","the\nbest","known","result","by","a\n√\ndfactor.","To","establish","this","sharper\nregret","bound,","we","present","a","non-asymptotic","confidence","bound\nfor","the","maximum","likelihood","estimator","of","the","MNL","model","that\nmay","be","of","independent","interest","as","its","own","theoretical","contri-\nbution.","We","then","revisit","the","simpler,","significantly","more","practi-\ncal,","first","algorithm","and","show","that","a","simple","variant","of","the","algo-\nrithm","achieves","the","optimal","regret","for","a","broad","class","of","impor-\ntant","applications.\nIntroduction\nIn","many","of","the","human-algorithm","interactions","today,","a","learn-\ning","","agent","","(algorithm)","","makes","","sequential","","decisions","","and","","re-\nceives","user","(human)","feedbackonlyfor","the","chosen","decisions.\nThe","","multi-armed","","bandit","","(Lattimore","","and","","Szepesv\n","́\nari","","2019)\nis","a","model","for","this","sequential","decision","making","with","partial\nfeedback.","It","is","a","classic","reinforcement","learning","problem","that\nexemplifies","the","dilemma","of","exploration","vs.","exploitation.","This\nmulti-armed","","bandit","","model","","has","","found","","diverse","","applications,\ne.g.","","learning","","click-through","","rates","","in","","search","","engines,","","prod-\nuct","recommendations","in","online","retailing,","movie","suggestions\non","streaming","services,","news","feeds,","etc.","Note","that","in","several\nof","","the","","applications,","","the","","goal","","is","","to","","maximize","","an","","appropri-\nate","“clickthrough”","rate.","Often","information","about","the","features\nof","the","agent’s","actions","and","contextual","information","about","the\nuser","are","available.","The","contextual","bandit","extends","the","multi-\narmed","","bandit","","by","","making","","the","","decision","","conditional","","on","","this\ncontext","and","feature","information.","In","many","real-world","prob-\nlems","including","the","aforementioned","examples,","the","agent","of-\nCopyright","©","2021,","Association","for","the","Advancement","of","Artificial\nIntelligence","(www.aaai.org).","All","rights","reserved.\nfers","a","menu","of","options","to","the","user,","rather","than","a","single","option\nas","","in","","traditional","","bandit","","action","","selection.","","The","","user","","chooses\nat","most","one","of","the","offered","options,","and","the","agent","receives","a\nreward","associated","with","the","user","choice.\nIn","this","paper,","we","consider","a","sequential","assortment","selec-\ntion","problem","which","is","a","combinatorial","variant","of","the","bandit\nproblem.","The","goal","is","to","offer","a","sequence","of","assortments","of\nat","","mostKitems","","from","","a","","set","","ofNpossible","","items.","","The","","se-\nquence","can","be","chosen","as","a","function","of","the","contextual","infor-\nmation","","of","","items,","","and","","possibly","","users,","","in","","order","","to","","minimize\nthe","expected","regret,","which","is","defined","as","the","gap","between","the\nexpected","revenue","generated","by","the","algorithm","and","the","offline\noptimal","expected","revenue","when","the","true","parameter","is","known.\nThed-dimensional","contextual","information,","or","a","set","of","feature\nvectors,","is","revealed","at","each","roundt,","allowing","the","feature","in-\nformation","of","items","to","change","over","time.","The","feedback","here\nis","","the","","particular","","item","","chosen","","by","","the","user","","from","","the","","offered\nassortment.","We","assume","that","the","item","choice","follows","a","multi-\nnomial","logistic","(MNL)","distribution","(McFadden","1978).","This\nis","","one","","of","","the","","most","","widely","","used","","model","","in","","dynamic","","assort-\nment","optimization","literature","(Caro","and","Gallien","2007;","Rus-\nmevichientong,","Shen,","and","Shmoys","2010;","Saur\n","́\ne","and","Zeevi\n2013;","Agrawal","et","al.","2019,","2017;","Aouad,","Levi,","and","Segev\n2018).\nFor","sequential","decision-making","with","contextual","informa-\ntion,","(generalized)","linear","bandits","(Abe","and","Long","1999;","Auer\n2002;","","Filippi","","et","","al.","","2010;","","Rusmevichientong","","and","","Tsitsik-\nlis","","2010;","","Abbasi-Yadkori,","","P\n","́\nal,","","and","","Szepesv\n","́\nari","","2011;","","Chu\net","al.","2011;","Li,","Lu,","and","Zhou","2017)","and","their","variants","have\nbeen","widely","studied.","However,","these","methods","are","only","lim-\nited","to","a","single","item","selection","which","is","increasingly","rarer","in\npractice","as","compared","to","multiple","item","offering","that","we","con-\nsider","in","this","work.","There","are","a","line","of","works","in","combinato-\nrial","variants","of","contextual","bandit","problems","(Qin,","Chen,","and\nZhu","","2014;","","Wen,","","Kveton,","","and","","Ashkan","","2015;","","Kveton","","et","","al.\n2015;","Zong","et","al.","2016)","mostly","with","semi-bandit","feedback\nor","cascading","feedback.","However,","these","methods","do","not","take\nthe","","user","","choice","","into","","account.","","Hence,","","substitution","","effect","","is\nnot","considered.","In","contrast","to","these","contextual","bandit","prob-\nlems","","and","","their","","combinatorial","","variants,","","in","","the","","multinomial\nlogit","(MNL)","contextual","bandit,","the","item","choice","(feedback)\nis","a","function","of","all","items","in","the","offered","assortment.","The","key\nchallenges","","are","","how","","to","","design","","an","","algorithm","","that","","offers","","as-\nsortments","","to","","simultaneously","","learn","","the","","unknown","","parameter\narXiv:2103.13929v1","","[stat.ML]","","25","Mar","2021\n\nMETHODCONTEXTREGRET\nAGRAWAL","ET","AL.","(2019)UCBNO\n","̃\nO(\n√\nNT),Ω(\n√\nNT/K)\nAGRAWAL","ET","AL.","(2017)TSNO\n","̃\nO(\n√\nNT)\nCHEUNG","ANDSIMCHI-LEVI(2017)TSYES\n","̃\nO(d\n√\nT)\n∗\nCHEN","ANDWANG(2017)N/AN/AΩ(\n√\nNT)(≡Ω(\n√\ndT))\nOU","ET","AL.","(2018)UCBYES\n","̃\nO(Kd\n√\nT)\nCHEN,","WANG,ANDZHOU(2018)UCBYES\n","̃\nO(d\n√\nT),Ω(d\n√\nT/K)\nOH","ANDIYENGAR(2019)TSYES\n","̃\nO(d\n√\nT)\n∗\n,\n","̃\nO(d\n3/2\n√\nT)\nTHISWORK(ALGORITHM1)UCBYES\n","̃\nO(d\n√\nT)\nTHISWORK(ALGORITHMS2)UCBYES\n","̃\nO(\n√\ndT)\nTable","1:","Comparison","of","regret","bounds","in","related","works","on","MNL","bandits.Tis","the","number","of","total","rounds,Kis","the","assortment\nsize,Nis","the","total","number","of","items,","anddis","the","feature","dimension.","UCB","denotes","upper-confidence","bound","and","TS","denotes\nThompson","sampling,","and","starred","(\n∗\n)","regrets","denote","Bayesian","regrets.\n","̃\nOis","a","big-Onotation","up","to","logarithmic","factors.\nand","maximize","the","expected","revenue","through","sequential","in-\nteractions","with","users","and","how","to","guarantee","its","performance.\nThere","has","been","an","emerging","body","of","literature","on","MNL","ban-\ndits","in","both","non-contextual","and","contextual","settings","(Agrawal\net","al.","2017,","2019;","Cheung","and","Simchi-Levi","2017;","Ou","et","al.\n2018;","Chen,","Wang,","and","Zhou","2018;","Oh","and","Iyengar","2019).\nHowever,","an","open","question","in","the","MNL","contextual","bandit\nproblem","","is","","whether","","one","","can","","close","","the","","gap","","between","","lower\nand","upper","bounds","of","regret.","Often,","meeting","such","a","criterion\ncomes","at","the","cost","of","practicality.","Hence,","designing","a","practi-\ncal","algorithm","that","achieves","the","provable","optimality","becomes\na","greater","challenge.","Our","contributions","are","as","follows:\n•UCB-MNL(Algorithm","","1)","","is","","an","","upper","","confidence","","bound\nbased","algorithm","for","MNL","contextual","bandits","that,","to","our\nknowledge,","","is","","the","","first","","polynomial","","time","","algorithm","","that\nachieves","anNindependent\n","̃\nO(d\n√\nT)regret.","This","result\nmatches","the","previous","best","upper","bound","(up","to","logarithmic\nfactors).\n•","","We","show","that\n","̃\nO(\n√\ndT)regret","is","achievable","in","the","MNL\ncontextual","bandits","(Theorem","3).","This","improves","on","the","best\nprevious","result","by\n√\ndfactor,","and","matches","the","lower","bound\nfor","the","MNL","bandit","problem","to","within","logarithmic","factor.\nHowever,","the","resulting","algorithm","is","not","practical","as","with\nother","","provably","","optimal","","bandit","","algorithms","","that","","rely","","on","","a\nframework","proposed","in","Auer","(2002).\n•DBL-MNL(Algorithms","","2),","","a","","simple","","variant","","ofUCB-MNL,\nachieves\n","̃\nO(\n√\ndT)regret","when","revenue","is","uniform","for","all\nitems","—","a","setting","that","arises","in","a","wide","range","of","applica-\ntions.DBL-MNLdoesnotrely","on","the","framework","in","Auer\n(2002),","and","has","state-of-the-art","computational","efficiency.\nThus,","this","work","is","the","first","one","to","provide","a","practical","algo-\nrithm","with","provable\n√\nddependence","on","the","dimension","of\nthe","context.\n•","","To","","establish","","a","","sharper","","regret","","bound,","","we","","prove","","a","","non-\nasymptotic","confidence","bound","for","the","maximum","likelihood\nestimator","of","the","MNL","model,","which","may","be","of","indepen-\ndent","interest.\nProblem","Formulation\nNotations\nFor","a","vectorx∈R\nd\n,","we","use‖x‖to","denote","its`\n2\n-norm.","The\nweighted`\n2\n-norm","","associated","","with","","a","","positive-definite","","ma-\ntrixVis","defined","by‖x‖\nV\n:=\n√\nx\n>\nV","x.","The","minimum","and\nmaximum","","eigenvalues","","of","","a","","symmetric","","matrixVare","","writ-\nten","","asλ\nmin\n(V)andλ\nmax\n(V)respectively.","","The","","trace","","of","","a\nmatrixVis","trace(V).","For","two","symmetric","matricesVand\nWof","the","same","dimensions,V\u0017Wmeans","thatV−W\nis","","positive","","semi-definite.","","For","","a","","positive","","integern,","","we","","de-\nfine[n]","","={1,2,...,n}.","Finally,","we","defineSto","be","the","set\nof","candidate","assortments","with","size","constraint","at","mostK,","i.e.\nS={S⊂[N]",":|S|≤K}.","Although","we","treatSas","station-\nary","for","ease","of","exposition,","we","can","allowS(as","well","as","the\nitem","set[N])","to","change","over","time.\nMNL","Contextual","Bandits\nThe","MNL","contextual","bandits","problem","is","defined","as","follows.\nThe","agent","has","a","set","ofNdistinct","items.","At","each","roundt,","the\nagent","observes","feature","vectorsx\nti\n∈R\nd\nfor","every","itemi∈\n[N].","Given","this","contextual","information,","at","every","roundt,","the\nagent","offers","an","assortmentS\nt\n={i\n1\n,...,i\n`\n}","∈","S,`≤K,\nand","observes","the","user","purchase","decisionc\nt\n∈S\nt\n∪{0},","where\n{0}denotes","“outside","option”","which","means","the","user","did","not\nchoose","any","item","offered","inS\nt\n.","This","selection","is","given","by","a\nmultinomial","","logit","","(MNL)","","choice","","model","","(McFadden","","1978)\nunder","which","the","choice","probability","for","itemi\nk\n∈S\nt\n(and","the\noutside","option)","is","defined","as\np\nt\n(i\nk\n|S\nt\n,θ\n∗\n)","=\nexp{x\n>\nti\nk\nθ\n∗\n}\n1","+\n∑\nj∈S\nt\nexp{x\n>\ntj\nθ\n∗\n}\n,\np\nt\n(0|S\nt\n,θ\n∗\n)","=\n1\n1","+\n∑\nj∈S\nt\nexp{x\n>\ntj\nθ\n∗\n}\nwhereθ\n∗\n∈R\nd\nis","a","time-invariant","parameter","unknown","to","the\nagent.","The","choice","response","for","each","itemi\nk\n∈S\nt\nis","defined\nasy\nti\nk\n:=1(c\nt\n=i\nk\n)∈","{0,1}andy\nt0\n:=1(c\nt\n=","","0)\nfor","the","outside","option.","Hence","the","choice","response","variable\n\ny\nt\n=","","(y\nt0\n,y\nti\n1\n,...,y\nti\n`\n)is","a","sample","from","this","multinomial\ndistribution:\ny\nt\n∼multinomial{1,(p\nt\n(0|S\nt\n,θ\n∗\n),...,p\nt\n(i\n`\n|S\nt\n,θ\n∗\n))}\nwhere","the","parameter1indicates","thaty\nt\nis","a","single-trial","sam-\nple,","","i.e.y\nt0\n+\n∑\n`\nk=1\ny\nti\nk\n=","","1.","","For","","eachi∈S\nt\n∪","{0}\nandt,","we","define","the","noise\u000f\nti\n:=y\nti\n−p\nt\n(i|S\nt\n,θ\n∗\n).","Since\neach\u000f\nti\nis","","a","","bounded","","random","","variable","","in[0,1],\u000f\nti\nisσ\n2\n-\nsub-Gaussian","withσ\n2\n=","1/4;","however,\u000f\nti\nisnotindepen-\ndent","acrossi∈S\nt\ndue","to","the","substitution","effect","in","the","MNL\nmodel.","The","revenue","parameterr\nti\nfor","each","item","is","also","given\nat","roundt.r\nti\nis","the","revenue","from","the","sale","if","itemiis","sold","in\nroundt.","Without","loss","of","generality,","assume|r\nti\n|","≤1for","all\niandt.","Then,","the","expected","revenue","of","the","assortmentS\nt\nis\ngiven","by\nR\nt\n(S\nt\n,θ\n∗\n)","=\n∑\ni∈S\nt\nr\nti\np\nt\n(i|S\nt\n,θ\n∗\n)(1)\nNote","that","for","a","very","broad","class","of","MNL","applications,","includ-\ning","search","ranking","and","media","recommendation,","the","goal","is","to\nmaximize","the","click-through","rate;","therefore,","the","item","revenue\nis","uniform.\nWe","defineS\n∗\nt\nto","be","the","offline","optimal","assortment","at","time\ntwhenθ\n∗\nis","known","apriori,","i.e.","when","the","true","MNL","proba-\nbilitiesp\nt\n(i|S,θ\n∗\n)are","known","a","priori:\nS\n∗\nt\n=","argmax\nS⊂S\nR\nt\n(S,θ\n∗\n).(2)\nThe","learning","agent","does","not","know","the","value","ofθ\n∗\n,","and","there-\nfore,","can","only","choose","the","assortmentS\nt\nin","periodtbased\non","the","choicesS\nτ\nfor","periodsτ","<","t,","and","the","observed","re-\nsponses.","We","measure","the","performance","of","the","agent","by","the\nregretR\nT\nfor","the","time","horizon","ofTperiods,","which","is","the\ngap","between","the","expected","revenue","generated","by","the","assort-\nment","chosen","by","the","agent","and","that","of","the","offline","optimal","as-\nsortment,","i.e.,\nR\nT\n=E\n[\nT\n∑\nt=1\n(\nR\nt\n(S\n∗\nt\n,θ\n∗\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n]\nwhereR\nt\n(S\n∗\nt\n,θ\n∗\n)is","the","expected","revenue","corresponding","to\nthe","","offline","","optimal","","assortment","","in","","periodt,","","i.e.,","","the","","high-\nest","revenue","which","can","be","obtained","with","the","knowledge","of\nθ\n∗\n.","Hence,","maximizing","the","cumulative","expected","revenue","is\nequivalent","to","minimizing","the","cumulative","expected","regret.\nMLE","for","Multinomial","Logistic","Regression\nWe","","briefly","","discuss","","the","","maximum","","likelihood","","estimation","","of\nthe","","unknown","","parameterθ\n∗\nfor","","the","","MNL","","model.","","First,","","re-\ncall","thaty\nt\n∈","{0,1}\n|S\nt\n|+1\nis","the","user","choice","response","vari-\nable","wherey\nti\nis","thei-th","component","ofy\nt\n.","Then,","the","nega-\ntive","log-likelihood","function","under","parameterθis","then","given\nby`\nn\n(θ)",":=−\n∑\nn\nt=1\n∑\ni∈S\nt\n∪{0}\ny\nti\nlogp\nt\n(i|S\nt\n,θ)which","is\nalso","known","as","the","cross-entropy","error","function","for","the","multi-\nclass","classification","problem.","Taking","the","gradient","of","this","neg-\native","log-likelihood","with","respect","toθ,","we","obtain\n∇\nθ\n`(θ)","=\nn\n∑\nt=1\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)x\nti\nAs","","the","","sample","","sizengoes","","to","","infinity,","","the","","MLE\nˆ\nθ\nn\nis\nasymptotically","","according","","to","","the","","classical","","likelihood","","the-\nory","","","(Lehmann","","","and","","","Casella","","","2006),","","","with\nˆ\nθ\nn\n−θ\n∗\n→\nN(0,I\n−1\nθ\n∗\n)whereI\nθ\n∗\nis","","the","","Fisher","","information","","matrix.\nWe","","show","","in","","the","","proof","","of","","Theorem","","2","","thatI\nθ\n∗\nis","","lower\nbounded","","by\n∑\nt\n∑\ni∈S\nt\np\nt\n(i|θ\n∗\n)p\nt\n(0|θ\n∗\n)x\nti\nx\n>\nti\n.","","Hence,","","if\np\nt\n(i|θ\n∗\n)p\nt\n(0|θ\n∗\n)≥κ",">0,","then","we","can","ensure","thatI\nθ\n∗\nis\ninvertible","and","prevent","asymptotic","variance","ofx\n>\nˆ\nθfrom","go-\ning","to","infinity","for","anyx.\nAlgorithms","and","Main","Results\nIn","this","section,","we","present","algorithms","for","the","MNL","contex-\ntual","bandit","problem","and","their","regret","bounds.\nAlgorithm:UCB-MNL\nThe","basic","idea","of","our","first","algorithm","is","to","maintain","a","confi-\ndence","set","for","the","parameterθ\n∗\n.","The","techniques","of","upper","con-\nfidence","bounds","(UCB)","have","been","widely","known","to","be","effec-\ntive","in","balancing","the","exploration","and","exploitation","trade-off\nin","many","bandit","problems,","includingK-arm","bandits","(Auer,\nCesa-Bianchi,","and","Fischer","2002;","Lattimore","and","Szepesv\n","́\nari\n2019),","linear","bandits","(Auer","2002;","Dani,","Hayes,","and","Kakade\n2008;","Abbasi-Yadkori,","P\n","́\nal,","and","Szepesv\n","́\nari","2011;","Chu","et","al.\n2011)","and","generalized","linear","bandits","(Filippi","et","al.","2010;","Li,\nLu,","and","Zhou","2017).\nFor","","each","","roundt,","","the","","confidence","","setC\nt\nforθ\n∗\nis","","con-\nstructed","","from","","the","","feature","","vectors{x\nt\n′\ni\n,i∈S\nt\n′\n}\nt\n′\n≤t\nand\nthe","observed","feedback","of","selected","itemsy\n1\n,...,y\nt−1\nfrom","all\nprevious","rounds.","Let\nˆ\nθ\nt\ndenote","the","estimate","of","the","unknown\nparameterθ\n∗\naftertperiods,","and","suppose","we","are","guaranteed\nthatθ\n∗\nlies","within","the","confidence","setC\nt\ncentered","at","MLE\nˆ\nθ\nt\nwith","radiusα\nt\n>0with","a","high","probability.","The","radiusα\nt\nhas\nto","be","chosen","carefully:","largerα\nt\ninduces","more","exploration;\nhowever,","","too","","largeα\nt\ncan","","cause","","regret","","to","","increase.","","In","","the\nMNL","setting,","exploitation","is","to","offerargmax\nS∈S\nR\nt\n(S,\nˆ\nθ\nt\n),\nwhereas","exploration","is","to","choose","a","setSthat","has","the","potential\nfor","high","expected","revenueR\nt\n(S,θ)asθvaries","overC\nt\n.","Thus,\na","direct","way","to","introduce","optimism,","and","induce","exploration,\nis","to","define","an","optimistic","revenue","for","each\n(\nN\nK\n)\nassortments.\nThis","is","the","approach","taken","in","Chen,","Wang,","and","Zhou","(2018);\nhowever,","this","enumeration","has","exponential","complexity","when\nNis","large","andKis","relatively","small.","We","show","that","one","can\ninduce","sufficient","exploration","by","defining","an","optimistic","util-\nityz\nti\nfor","each","item,","and","defining","the","optimistic","revenue","for\nany","assortmentSusing","the","optimistic","utility.\nz\nti\n:=x\n>\nti\nˆ\nθ\nt−1\n+α\nt\n‖x\nti\n‖\nV\n−1\nt−1\n(3)\nwhereV\nt\n=\n∑\nt\nt\n′\n=1\n∑\ni∈S\nt\nx\nt\n′\ni\nx\n>\nt\n′\ni\n∈R\nd×d\nis","a","symmetric\npositive","definite","matrix.","The","optimistic","utilityz\nti\nconsists","of\ntwo","components:","mean","utility","estimatex\n>\nti\nˆ\nθ\nt−1\nand","standard\ndeviationα\nt\n‖x\nti\n‖\nV\n−1\nt−1\n.","In","the","proof","of","the","regret","bound","of\nthe","algorithm,","we","show","thatz\nti\nis,","indeed,","an","upper","bound\nofx\n>\nti\nθ\n∗\nifθ\n∗\nlies","within","in","the","confidence","ellipsoid","centered\nat\nˆ\nθ\nt−1\n.","Based","onz\nti\n,","we","construct","the","following","optimistic\n\nAlgorithm","1UCB-MNL\n1:Input:","initializationT\n0\n,","confidence","radiusα\nt\n2:Initialization:fort∈[T\n0\n]\n3:Randomly","chooseS\nt\nwith|S\nt\n|=K\n4:V\nt\n←V\nt−1\n+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n5:forallt=T\n0\n+","1toTdo\n6:Computez\nti\n=x\n>\nti\nˆ\nθ\nt−1\n+α\nt\n‖x\nti\n‖\nV\n−1\nt−1\nfor","alli\n7:OfferS\nt\n=","argmax\nS⊂S\n","̃\nR\nt\n(S)and","observey\nt\n8:UpdateV\nt\n←V\nt−1\n+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n9:Compute","MLE\nˆ\nθ\nt\nby","solving\n∑\nt\nt\n′\n=1\n∑\ni∈S\nt\n′\n(\np\nt\n′\n(i|S\nt\n′\n,\nˆ\nθ\nt\n)−y\nt\n′\ni\n)\nx\nt\n′\ni\n=0\n10:end","for\nestimate","of","the","expected","revenue\n","̃\nR\nt\n(S)",":=\n∑\ni∈S\nr\nti\nexp","(z\nti\n)\n1","+\n∑\nj∈S\nexp","(z\ntj\n)\n.(4)\nWe","assume","an","access","to","an","assortment","optimization","method\nwhich","returns","the","assortment","at","timetfor","a","given","param-\neter","estimate,S\nt\n=","arg","max\nS⊂S\n","̃\nR\nt\n(S).","There","are","efficient\npolynomial-time","algorithms","available","to","solve","this","optimiza-\ntion","problem","(Rusmevichientong,","Shen,","and","Shmoys","2010;\nDavis,","Gallego,","and","Topaloglu","2014).","We","now","have","all","the\ningredients","for","our","algorithm,UCB-MNL(see","Algorithm","1).\nIn","","Algorithm","","1,","","during","","the","","initialization","","phase,","","we","","first\nrandomly","","choose","","an","","assortmentS\nt\nwith","","exactlyKitems\n(after","","initialization,S\nt\ncan","","be","","smaller","","thanK)","","to","","ensure\na","unique","MLE","solution.","The","initializationT\n0\n,","specified","in\nTheorem","","1,","","is","","chosen","","to","","ensure","","thatλ\nmin\n(V\nT\n0\n)is","","large\nenough.\nRegret","Bound","forUCB-MNLAlgorithm\nWe","","present","","the","","regret","","upper-bound","","ofUCB-MNLunder","","the\nfollowing","assumptions","on","the","context","process","and","the","MNL\nmodel,","both","standard","in","the","literature.\nAssumption","1.Each","feature","vectorx\nti\nis","drawn","i.i.d.","from\nan","unknown","distributionp\nx\n,","with‖x\nti\n‖≤1allt,iand","there\nexists","a","constantσ\n0\n>0such","thatE[x\nti\nx\n>\nti\n]≥σ\n0\n.\nThe","boundedness","is","used","to","make","the","regret","bounds","scale-\nfree.","The","i.i.d.","assumption","is","also","made","in","generalized","linear\nbandit","(Li,","Lu,","and","Zhou","2017)","and","MNL","contextual","bandit\n(Chen,","Wang,","and","Zhou","2018;","Oh","and","Iyengar","2019)","litera-\nture.\nAssumption","","2.There","","existsκ",">0such","","that","","for","","ev-\nery","","itemi∈Sand","","anyS∈","Sand","","all","","roundt,\nmin\n‖θ−θ\n∗\n‖≤1\np\nt\n(i|S,θ)p\nt\n(0|S,θ)≥κ.\nThe","asymptotic","normality","of","MLE","implies","the","necessity\nof","this","assumption.","This","is","a","standard","assumption","in","MNL\ncontextual","","bandits","","(Cheung","","and","","Simchi-Levi","","2017;","","Chen,\nWang,","and","Zhou","2018;","Oh","and","Iyengar","2019),","which","is","also\nequivalent","to","the","standard","assumption","for","the","link","function","in\ngeneralized","linear","contextual","bandits","(Filippi","et","al.","2010;","Li,\nLu,","and","Zhou","2017)","to","ensure","the","Fisher","information","matrix\nis","invertible.\nTheorem","","","1(Regret","","","ofUCB-MNL).Suppose","","","Assump-\ntions","","1","","and","","2","","hold","","and","","we","","runUCB-MNLwith","","confi-\ndence","widthα\nt\n=\n1\n2κ\n√\n2dlog\n(\n1","+\nt\nd\n)\n+","2","logtandT\n0\n=\nO(max{κ\n−2\n(dlog(T/d)","+","4","logT),K/σ\n2\n}).","Then","the","ex-\npected","regret","ofUCB-MNLis","upper-bounded","by\nR\nT\n=O\n(\nd\n√\nTlog","(1","+T/d)","log(T/d)\n)\n.\nDiscussion","of","Theorem","1.In","terms","of","key","problem","prim-\nitives,","Theorem","1","demonstrates\n","̃\nO(d\n√\nT)regret","bound","for\nUCB-MNLwhich","","is","","independent","","ofN;","","hence,","","it","","is","","appli-\ncable","","to","","the","","case","","with","","a","","very","","large","","number","","of","","candidate\nitems.","Chen,","Wang,","and","Zhou","(2018)","established","the","lower\nbound","","resultΩ(d\n√\nT/K)for","","MNL","","bandits.","","WhenKis\nsmall,","which","is","typically","true","in","many","applications,","the","re-\ngret","upper-bound","in","Theorem","1","demonstrates","thatUCB-MNL\nis","","almost","","optimal.","","The","","established","","regret","","ofUCB-MNLim-\nproves","the","previous","worst-case","regret","bound","of","Oh","and","Iyen-\ngar","(2019)","by\n√\ndfactor","and","that","of","Chen,","Wang,","and","Zhou\n(2018)","in","both","logarithmic","and","additive","factors.","Moreover,\nalthough","having","the","same","rate","of\n","̃\nO(d\n√\nT)regret","up","to","log-\narithmic","factors,","the","UCB","method","in","Chen,","Wang,","and","Zhou\n(2018)","has","exponential","computational","cost,","since","it","needs","to\nenumerate","","all","","of","","the","","possible","","(NchooseK)","","assortments.\nTherefore,UCB-MNLis","the","first","polynomial-time","algorithm\nthat","achieves\n","̃\nO(d\n√\nT)worst-case","regret.\nExtension","to","online","parameter","update.UCB-MNLis","sim-\nple","to","implement","and","works","very","well","in","practice.","We","fur-\nther","","improve","","both","","the","","time","","and","","space","","complexities","","of","","the\nalgorithm","by","using","an","online","parameter","update","version","(Al-\ngorithm","3","in","the","appendix).","Exploiting","the","fact","that","the","loss\nfor","","the","","MNL","","model","","is","","strongly","","convex","","over","","bounded","","do-\nmain,","we","apply","a","variant","of","the","online","Newton","step","inspired\nby","Hazan,","Koren,","and","Levy","(2014);","Zhang","et","al.","(2016)","to\nfind","an","approximate","solution","rather","than","computing","the","ex-\nact","MLE.","We","show","that","the","modified","algorithm","still","enjoys\nthe","same","order","of","the","statistical","efficiency","with\n","̃\nO(d\n√\nT)re-\ngret","even","with","the","online","update.\nCorollary","1.UCB-MNLwith","online","parameter","update","still\nhas\n","̃\nO(d\n√\nT)regret.\nNon-asymptotic","Normality","of","the","MLE","for\nthe","MNL","Model\nWe","have","shown","thatUCB-MNLis","both","statistically","and","com-\nputationally","efficient.","The","algorithm","also","shows","state-of-the-\nart","practical","performances","as","we","report","later","in","the","numerical\nexperiments.","However,","the","regret","bound","in","Theorem","1","has","a\nlinear","dependence","on","feature","dimensiondand,","therefore,","is\nnot","very","attractive","when","the","feature","vectors","are","high","dimen-\nsional.","We","next","investigate","whether","a","sublinear","dependence\nondis","","possible.","","In","","the","","regret","","analysis","","forUCB-MNL,","","we\nupper-bound","the","prediction","errorx\n>\n(θ\n∗\n−\nˆ\nθ\nt\n)using","H\n","̈\nolder’s\ninequality,|x\n>\nˆ\nθ\nt\n−x\n>\nθ\n∗\n|≤‖x‖\nV\n−1\nt\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\nV\nt\n,","where","we\nshow","each","of","the","terms","on","the","right","hand","side","is","bounded","by\n","̃\nO(\n√\nd),","hence","resulting","in","a","linear","dependence","ondwhen\ncombined.","A","potential","solution","to","circumvent","this","challenge\n\nis","to","control","the","prediction","error","directly","without","bounding\ntwo","terms","separately.\nIn","","Theorem","","2,","","we","","propose","","a","","non-asymptotic","","normality\nbound","for","the","MLE","for","the","MNL","model","in","order","to","estab-\nlish","a","sharper","concentration","result","for|x\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)|.","This","is\na","generalization","of","Theorem","1","in","Li,","Lu,","and","Zhou","(2017)\nto","the","MNL","model.","To","the","best","of","our","knowledge,","there","was\nno","existing","finite-sample","normality","results","for","the","prediction\nerror","of","the","utility","for","the","MNL","model.","This","concentration\nresult","can","be","of","independent","interest","beyond","the","bandit","prob-\nlem","we","address","in","this","work.\nTheorem","","2(Non-asymptotic","","normality","","of","","MLE).Sup-\npose","","","we","","","have","","","independent","","","responsesy\n1\n,...,y\nn\ncondi-\ntioned","","","on","","","feature","","","vectors{x\nti\n}\nn,K\nt=1,i=1\n.","","","DefineV\nn\n=\n∑\nn\nt=1\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n,","and","letδ",">0be","given.","Furthermore,\nassume","","thatλ\nmin\n(V\nn\n)≥max\n{\n9D\n4\nκ\n4\nlog(1/δ)\n,\n144D\n2\nκ\n4\n}\nwhere\nD:=","min\n{\n4\n√\n2d+","log\n1\nδ\n,\n√\ndlog(n/d)","+","2","log\n1\nδ\n}\n.","Then,\nfor","anyx∈R\nd\n,","the","maximum","likelihood","estimator\nˆ\nθ\nn\nof","the\nMNL","model","satisfies","with","probability","at","least1−3δthat\n|x\n>\nˆ\nθ\nn\n−x\n>\nθ\n∗\n|≤\n5\nκ\n√\nlog\n1\nδ\n‖x‖\nV\n−1\nn\n.\nHence,","","the","","prediction","","error","","can","","be","","bounded","","by\n","̃\nO(\n√\nd)\nwith","high","probability","as","long","as","the","conditions","on","indepen-\ndence","of","samples","and","the","minimum","eigenvalue","are","satisfied.\nNote","that","although","the","statement","of","Theorem","2","is","similar","to\nthat","of","the","generalized","linear","model","version","in","Li,","Lu,","and\nZhou","(2017),","the","extension","to","the","MNL","model","is","non-trivial\nbecause","choice","probability","for","any","given","itemi∈S\nt\nis","func-\ntion","of","the","all","the","items","in","the","assortmentS\nt\n,","and","hence","the\nanalysis","is","much","more","involved.","Theorem","2","implies","that","we\ncan","control","the","behavior","of","the","MLE","in","every","direction","al-\nlowing","us","to","handle","the","prediction","error","in","a","tighter","fashion.\nProvably","Optimal","but","Impractical\nUnfortunately,","we","cannot","directly","apply","the","tight","bound","for\nthe","","MLE","","shown","","in","","Theorem","","2","","toUCB-MNLsince","","Theo-\nrem","2","requires","independent","samples","(as","well","as","the","minimum\neigenvalue","being","large","enough,","but","this","condition","can","be","sat-\nisfied","by","initial","exploration).UCB-MNLis","not","guaranteed","to\nproduce","","independent","","samples","","since","","the","","algorithm","","chooses\nassortments","based","on","previous","observations,","causing","depen-\ndence","between","collected","samples.","This","issue","can","be","handled\nby","","generating","","independent","","samples","","using","","a","","framework","","in\nAuer","(2002),","which","we","denote","as","“Auer-framework.”","This\nAuer-framework","has","been","previously","used","in","several","vari-\nants","of","(generalized)","linear","bandits","(Chu","et","al.","2011;","Li,","Lu,\nand","Zhou","2017;","Zhou,","Xu,","and","Blanchet","2019).","We","show\nthat","the","adaptation","of","the","Auer-framework","to","the","MNL","con-\ntextual","bandit","problem","is","possible\n1\nand","establish","the","follow-\ning","regret","bound.\nTheorem","","3(Provably","","optimal","","regret).Suppose","","Assump-\ntions","1","and","2","hold.","There","exists","an","algorithm","which","estab-\nlishes\n","̃\nO(\n√\ndT)regret","for","the","MNL","contextual","bandits.\n1\nWe","defer","the","details","of","the","algorithm","to","the","appendix","since","this\nis","not","the","focus","of","the","paper.\nAlgorithm","2DBL-MNL\n1:Input:","sampling","parameterq\nk\n,","confidence","radiusβ\nk\n2:Setτ\n1\n←d,t←1,V\n0\n←0\nd×d\n3:Initialization:fort∈[d]\n4:Randomly","chooseS\nt\n∈Swith|S\nt\n|=K\n5:V\nt\n←V\nt−1\n+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n6:foreach","episodek=","2,3,...do\n7:Set","the","last","round","ofk-th","episode:τ\nk\n←2\nk−1\n8:Compute","MLE\nˆ\nθ\nk\nby","solving\n∑\nτ\nk−1\nt=τ\nk−2\n+1\n∑\ni∈S\nt\n(\np\nt\n(i|S\nt\n,\nˆ\nθ\nk\n)−y\nti\n)\nx\nti\n=0\n9:UpdateW\nk−1\n←V\nτ\nk−1\n+1\n;","ResetV\nτ\nk−1\n+1\n←0\nd×d\n10:foreach","roundt=τ\nk−1\n+","1,...,τ\nk\ndo\n11:ifτ\nk\n−t≤q\nk\nandλ\nmin\n(V\nt\n)≤\nKq\nk\nσ\n0\n2\nthen\n12:Randomly","chooseS\nt\n∈Swith|S\nt\n|=K\n13:else\n14:OfferS\nt\n=","argmax\nS∈S\n","̃\nR\nt\n(S)\n15:end","if\n16:UpdateV\nt+1\n←V\nt\n+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n17:end","for\n18:end","for\nΩ(\n√\nNT)lower","","bound","","was","","shown","","in","","Chen","","and","","Wang\n(2017)","","for","","the","","non-contextual","","MNL","","bandits.","","This","","lower\nbound","can","be","translated","toΩ(\n√\ndT)if","each","item","is","repre-\nsented","as","one-hot","encoding.","Hence","the","regret","bound","in","The-\norem","3","matches","the","lower","bound","for","the","MNL","bandit","prob-\nlem","with","finite","items.","To","our","knowledge,","this","is","the","first","re-\nsult","that","achieves","the","rate","of\n","̃\nO(\n√\ndT)regret","and","establishes\nthe","provable","optimality","in","the","MNL","contextual","bandit","prob-\nlem.","However,","this","comes","at","a","cost.","The","algorithm","based","on\nthe","Auer-framework,","although","provably","optimal,","is","not","prac-\ntical","","(see","","the","","numerical","","experiments)!","","In","","fact,","","this","","is","","true\nforalloptimal","methods","(Chu","et","al.","2011;","Li,","Lu,","and","Zhou\n2017;","Zhou,","Xu,","and","Blanchet","2019)","that","rely","on","the","Auer-\nframework","(Auer","2002)","because","the","framework","wastes","too\nmany","samples","with","random","exploration.\n2\nNext,","we","investi-\ngate","whether\n","̃\nO(\n√\ndT)regret","can","be","achieved","in","a","practical\nmanner","for","the","class","of","applications","where","the","revenue","for\neach","item","is","uniform.","As","discussed","earlier","that","this","class","in-\ncludes","web","search","and","media","recommendations.\nAlgorithm:DBL-MNL\nWe","propose","a","new","algorithm,DBL-MNL(Algorithm","2)","that\nisbothprovably","","optimal","","and","","practical.DBL-MNLoperates\nin","","an","","episodic","","manner.","","At","","the","","beginning","","of","","each","","episode,\nthe","","MLE","","is","","computed","","using","","the","","samples","","from","","a","","previous\nepisode.","Within","an","episode,","the","parameter","is","not","updated,","but\nthe","algorithm","takes","an","UCB","action","based","on","the","parameter\ncomputed","at","the","beginning","of","the","episode.","In","particular,","for\nroundtin","","thek-th","","episode,","","the","","upper-bound","","of","","an","","utility\n2\nThese","previous","methods","(Chu","et","al.","2011;","Li,","Lu,","and","Zhou\n2017;","Zhou,","Xu,","and","Blanchet","2019)","that","use","techniques","in","(Auer\n2002)","do","not","provide","numerical","evaluations.\n\nestimate","is","computed","as\n","̃z\nti\n=x\n>\nti\nˆ\nθ\nk\n+α\nk\n‖x\nti\n‖\nW\n−1\nk−1\nwhereW\nk−1\n=\nτ\nk−1\n∑\nt\n′\n=τ\nk−1\n+1\n∑\ni∈S\nt\n′\nx\nt\n′\ni\nx\n>\nt\n′\ni\nandτ\nk−1\nis","","the","","last","","round","","of","","thek−1-th","","episode.","","Note\nthat","","the","","Gram","","matrix","","resets","","every","","episode.","","Under","","this","","ac-\ntion","","selection,","","samples","","within","","each","","episode","","are","","indepen-\ndent","of","each","other.","Episode","lengths","are","doubled","over","time\nsuch","that","the","length","of","thek-th","episode","is","twice","as","large","as\nthek−1-th","","episode.","","This","","doubling","","technique","","is","","inspired\nby","","Jaksch,","","Ortner,","","and","","Auer","","(2010);","","Javanmard","","and","","Naz-\nerzadeh","","(2019).","","Towards","","the","","end","","of","","each","","episode,","","the","","al-\ngorithm","checks","whetherλ\nmin\n(V\nt\n)is","suitably","large.","If","not,\nit","performs","random","exploration.","Since","episode","lengths","are\ngrowing","exponentially","and","the","threshold","forλ\nmin\n(V\nt\n)is","only\nlogarithmic","int,","even","in","the","worst","case,","the","algorithm","draws\nO(logT)random","samples.","Note","that","the","algorithm","may","not\neven","take","these","exploratory","actions","sinceλ\nmin\n(V\nt\n)may","al-\nready","surpass","the","threshold","for","large","enough","episodes","(this\nis","","clearly","","observed","","in","","numerical","","evaluations).","","This","","makes\nDBL-MNLmuch","more","practical","since","it","would","perform","mini-\nmal","random","exploration.","Furthermore,","the","algorithm","is","com-\nputationally","efficient","with","only","logarithmic","number","of","pa-\nrameter","updates","instead","of","updating","in","every","period.\nRegret","Bound","ofDBL-MNL\nWe","analyze","the","regret","ofDBL-MNLfor","which","we","aim","to","es-\ntablish\n","̃\nO(\n√\ndT)regret.","","For","","our","","analysis,","","we","","add","","the","","fol-\nlowing","mild","assumption","which","encompasses","many","canoni-\ncal","distributions.\nAssumption","3(Relaxed","symmetry).For","a","joint","distribution\np\nX\n,","there","existsρ\n0\n<∞such","that\np\nX\n(−x)\np\nX\n(x)\n≤ρ\n0\nfor","allx.\nThis","assumption","is","also","used","in","the","analysis","of","sparse","ban-\ndits","Oh,","Iyengar,","and","Zeevi","(2020).","Assumption","3","states","that\nthe","joint","distributionp\nX\ncan","be","skewed","but","this","skewness","is\nbounded.","For","symmetrical","distributions,ρ\n0\n=","","1.","One","can\nsee","","that","","a","","large","","class","","of","","continuous","","and","","discrete","","distribu-\ntions","satisfy","Assumption","3,","e.g.,","Gaussian,","truncated","Gaus-\nsian,","uniform","distribution,","and","Rademacher","distribution,","and\nmany","more.","Under","this","suitable","regularity,","we","establish","the\nfollowing","regret","bound","forDBL-MNL.\nTheorem","4(Regret","bound","ofDBL-MNL).Suppose","Assump-\ntions","","1-3","","hold","","and","","the","","revenuer\ni\n≡ris","","uniform.","","Then\nthe","","expected","","regret","","ofDBL-MNLover","","horizonTisR\nT\n=\nO\n(\n√\ndTlog","(T/d)","log(TN)","log(T)\n)\n.\nDiscussion","of","Theorem","4.DBL-MNLachieves\n","̃\nO(\n√\ndT)\nregret","when","the","revenue","for","each","item","is","uniform.","This","en-\ncompasses","","all","","applications","","where","","the","","goal","","is","","to","","maximize\nan","appropriate","“click-through","rate”","from","offering","the","assort-\nment.","Theorem","4","provides","insights","beyond","the","MNL","con-\ntextual","","bandits:","","it","","shows","","that","","under","","the","","suitable","","regularity\ncondition,","","it","","is","","possible","","for","","a","","practical","","algorithm","","to","","attain\n","̃\nO(\n√\ndT)regret.","","We","","expect","","this","","technique","","to","","yield","","practi-\ncal","provably","optimal","algorithms","for","other","variants","of","con-\ntextual","bandit","problems.","The","regret","bound","ofUCB-MNLisN\nindependent;","in","contrast,DBL-MNLhas","a","logarithmic","depen-\ndence","onN(as","is","common","for\n","̃\nO(\n√\ndT)regret","algorithms).\nIn","fact,","the","numerical","experiments","suggest","that","performance\ndoes","have","at","least","logarithmic","dependence","onNfor","all","meth-\nods","(as","indicated","by","Theorem","4","forDBL-MNL).\nProof","Outline","of","Theorem","4\nSince","the","length","of","an","episode","grows","exponentially,","the","num-\nber","of","episodes","up","to","roundTis","logarithmic","inT.","In","par-\nticular,","","theT-th","","round","","belongs","","to","","theL-th","","episode","","with\nL=blog\n2\nTc+","1.","","LetT\nk\n:={τ\nk−1\n+","1,...,τ\nk\n}denote\nan","index","set","of","rounds","that","belong","to","thek-th","episode.","Note\nthat","","the","","length","","of","","thek-th","","episode","","is|T\nk\n|=τ\nk\n/2.","","Then,\nwe","letReg(k-th","episode)denote","the","cumulative","regret","of","the\nk-th","episode,","i.e.,\nReg(k-th","episode)",":=E\n[\n∑\nt∈T\nk\n(\nR\nt\n(S\n∗\nt\n,θ\n∗\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n]\nso","","that","","the","","cumulative","","expected","","regret","","overTrounds","","is\nR(T)","","=\n∑\nL\nk=1\nReg(k-th","episode).","","Therefore,","","it","","suffices\nto","","bound","","eachReg(k-th","episode).","","Now,","","for","","each","","episode\nk∈[L],","we","consider","the","following","two","cases.\n(i)|T\nk\n|","≤q\nk\n:","In","this","case,","the","length","of","an","episode","is","not\nlarge","enough","to","have","the","concentration","of","the","prediction\nerror","due","to","the","failure","of","ensuring","the","lower","bound","on\nλ\nmin\n(V\nt\n).","Therefore,","we","cannot","control","the","regret","in","this\ncase.","However,","the","total","number","of","such","rounds","is","only\nlogarithmic","inT,","hence","the","regret","corresponding","to","this\ncase","contributes","minimally","to","the","total","regret.\n(ii)|T\nk\n|>","q\nk\n:","We","can","apply","the","fast","convergence","result","in\nTheorem","","2","","as","","long","","as","","the","","lower","","bound","","onλ\nmin\n(V\nt\n)is\nguaranteed","—","note","that","the","independence","condition","is","al-\nready","satisfied","since","samples","in","each","episode","are","indepen-\ndent","of","each","other.","We","show","thatλ\nmin\n(V\nt\n)grows","linearly\nastincreases","","in","","each","","episode","","with","","high","","probability.","","In\ncase","ofλ\nmin\n(V\nt\n)not","growing","as","fast","as","the","rate","we","re-\nquire,","we","perform","random","sampling","to","satisfy","this","crite-\nrion","towards","the","end","of","each","episode.","Therefore,","with","high\nprobability,","the","lower","bound","onλ\nmin\n(V\nt\n)is","satisfied.\nFor","case","(i),","clearlyq\nk\n≤q\nL\nfor","anyk∈","{1,...,L}.|T\nk\n|\neventually","grows","to","be","larger","thanq\nL\nfor","someksinceq\nL\nis","","logarithmic","","inT.","","Letk\n′\nbe","","the","","first","","episode","","such","","that\n|T\nk\n′\n|≥q\nL\n.","Hence,|T\nk\n′\n|≤2q\nL\n.","Thus,","the","cumulative","regret\nprior","","to","","thek\n′\n-th","","episode","","isO\n(\nlogd+d\n2\n+","log\n2\n(TN)\n)\n.\nThen,","lettingk\n′′\nbe","the","first","episode","such","that|T\nk\n′′\n|","≥q\nk\n′′\nand","noting","thatk\n′′\n≤k\n′\ngives\nk\n′′\n−1\n∑\nk=1\nReg(k-th","episode)≤\nk\n′\n−1\n∑\nk=1\nReg(k-th","episode).\nHence,","the","cumulative","regret","corresponding","to","case","(i)","is","at\nmost","poly-logarithic","inT.\nFor","case","(ii),","it","suffices","to","show","random","sampling","ensures\nthe","growth","ofλ\nmin\n(V\nt\n).","We","show","that","random","sampling","with\ndurationq\nk\nspecified","","in","","Theorem","","4","","ensures","","the","","minimum\neigenvalue","condition","for","the","Gram","matrix,","i.e.,λ\nmin\n(V\nτ\nk\n)≥\n\n02004006008001000\nTime","(t)\n0\n1\n2\n3\n4\n5\n6\nCumulative","Regret\nN=50,","K=5,","d=5,","Gaussian\nTS-MNL\nTS-MNL","optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n1\n2\n3\n4\n5\n6\nCumulative","Regret\nN=100,","K=5,","d=5,","Gaussian\nTS-MNL\nTS-MNL","optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n1\n2\n3\n4\n5\n6\nCumulative","Regret\nN=200,","K=5,","d=5,","Gaussian\nTS-MNL\nTS-MNL","optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n2\n4\n6\n8\n10\n12\nCumulative","Regret\nN=50,","K=5,","d=5,","Uniform\nTS-MNL\nTS-MNL","optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n2\n4\n6\n8\n10\n12\nCumulative","Regret\nN=100,","K=5,","d=5,","Uniform\nTS-MNL\nTS-MNL","optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n2\n4\n6\n8\n10\n12\nCumulative","Regret\nN=200,","K=5,","d=5,","Uniform\nTS-MNL\nTS-MNL","optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\nFigure","1:","The","regret","plots","show","thatUCB-MNLandDBL-MNLperform","at","start-of-the-art","levels","across","different","problem","instances.\nEvaluations","are","for","features","drawn","from","a","multivariate","Gaussian","(first","row)","and","uniform","(second","row)","distributions.\nmax\n{\n9D\n4\nk\nκ\n4\nlog(τ\nk\nN/2)\n,\n144D\n2\nk\nκ\n4\n}\nwith","high","probability","for","each\nepisodek∈[L].","","We","","then","","apply","","the","","confidence","","bound","","in\nTheorem","2","to","thek-th","episode","which","requires","samples","in","the\n(k−1)-th","episode","are","independent","andλ\nmin\n(V\nτ\nk−1\n)at","the\nend","of","the(k−1)-th","episode","is","large","enough.","That","is,","with\na","lower","bound","guarantee","onλ\nmin\n(V\nτ\nk−1\n)and","the","fact","that\nsamples","are","independent","of","each","other","in","each","episode,","we\nhave","with","high","probability\n|x\n>\nti\n(\nˆ\nθ\nk\n−θ\n∗\n)|≤β\nk\n‖x\nti\n‖\nW\n−1\nk−1\n,∀i∈[N],∀t∈T\nk\nwith","suitable","confidence","widthβ\nk\nspecified","in","Theorem","4.\nTherefore,","","the","","expected","","regret","","in","","thek-th","","episode","","can","","be\nbounded","","by\n","̃\nO(\n√\ndτ\nk\n).","","Then","","we","","combine","","the","","results","","over\nall","episodes","to","establish\n","̃\nO(\n√\ndT)regret.\nNumerical","Experiments\nIn","","this","","section,","","we","","evaluate","","the","","performances","","of","","our","","pro-\nposed","","algorithms:UCB-MNL(Algorithm","","1)","","andDBL-MNL\n(Algorithm","","2)","","in","","numerical","","experiments.","","In","","our","","evalua-\ntions,","","we","","report","","the","","cumulative","","regret","","for","","each","","roundt∈\n{1,...,T}.","For","each","experimental","configuration,","we","evalu-\nate","the","algorithms","on","20","independent","instances","and","report\naverage","performances.","In","each","instance,","the","underlying","pa-\nrameterθ\n∗\nis","sampled","from","thed-dimensional","uniform","dis-\ntribution,","with","each","element","ofθ\n∗\nuniformly","distributed","in\n[0,1].","The","underlying","parameters","are","fixed","during","each","prob-\nlem","instance","but","not","known","to","the","algorithms.","For","efficient\nevaluations,","we","consider","uniform","revenues,","i.e.,r\nti\n=","1for\nalliandt.","Therefore,","the","combinatorial","optimization","step\nto","solve","for","the","optimal","assortment","reduces","to","sorting","items\naccording","to","their","utility","estimate.","Also,","recall","that","the","re-\ngret","bound","forDBL-MNL(Theorem","4)","is","derived","under","the\nHorizon","(T)\nMethod10005000\nTS-MNL(Oh","and","Iyengar","2019)6.6573.99\nTS-MNL","Opt.(Oh","and","Iyengar","2019)6.8177.18\nUCB-MNL(Algorithm","1)6.6274.28\nDBL-MNL(Algorithm","2)1.205.92\nTable","2:","Runtime","evaluation","(sec),N=","100,K=","5,d=","5\nuniform","revenue","assumption,","therefore,","the","uniform","revenue\nsetting","provides","a","suitable","test","bed","for","all","methods","consid-\nered","in","this","section.\nWe","compare","the","performances","of","the","proposed","algorithms\nwith","those","of","the","state-of-the-art","Thompson","sampling","based\nalgorithms,TS-MNLand","“optimistic”TS-MNL,","proposed","in\nOh","and","Iyengar","(2019).","Additionally,","we","evaluate","the","per-\nformance","of","the","provably","optimal","but","impractical","algorithm,\nsupCB-MNL(see","Algorithm","5","in","the","appendix),","that","is","based\non","","the","","Auer-framework.","","Figure","","1","","shows","","that","","the","","perfor-\nmances","ofUCB-MNLandDBL-MNLare","superior","to","or","com-\nparable","to","the","state-of-the-art","Thompson","sampling","methods.\nMoreover,","the","runtime","evaluation","shows","thatDBL-MNLis","sig-\nnificantly","faster","than","the","other","methods","due","to","its","logarithmic\nnumber","of","parameter","updates.\nEthical","Statement\nWe","conform","that","our","work","meets","the","standards","listed","in","the\nethics","and","malpractice","statement","of","the","AAAI.\n\nReferences\nAbbasi-Yadkori,","Y.;","P\n","́\nal,","D.;","and","Szepesv\n","́\nari,","C.","2011.","","Im-\nproved","algorithms","for","linear","stochastic","bandits.","InAdvances\nin","Neural","Information","Processing","Systems,","2312–2320.\nAbe,","N.;","and","Long,","P.","M.","1999.","","Associative","reinforcement\nlearning","using","linear","probabilistic","concepts.","InInternational\nConference","on","Machine","Learning,","3–11.\nAgrawal,","S.;","Avadhanula,","V.;","Goyal,","V.;","and","Zeevi,","A.","2016.\nA","near-optimal","exploration-exploitation","approach","for","assort-\nment","selection.","InProceedings","of","the","2016","ACM","Conference\non","Economics","and","Computation,","599–600.\nAgrawal,","S.;","Avadhanula,","V.;","Goyal,","V.;","and","Zeevi,","A.","2017.\nThompson","Sampling","for","the","MNL-Bandit.","InConference","on\nLearning","Theory,","76–78.\nAgrawal,","S.;","Avadhanula,","V.;","Goyal,","V.;","and","Zeevi,","A.","2019.\nMNL-bandit:","","A","","dynamic","","learning","","approach","","to","","assortment\nselection.Operations","Research67(5):","1453–1485.\nAouad,","A.;","Levi,","R.;","and","Segev,","D.","2018.","","Greedy-like","algo-\nrithms","for","dynamic","assortment","planning","under","multinomial\nlogit","preferences.Operations","Research66(5):","1321–1345.\nAuer,","P.","2002.","","","Using","confidence","bounds","for","exploitation-\nexploration","","trade-offs.Journal","","of","","Machine","","Learning","","Re-\nsearch3(Nov):","397–422.\nAuer,","P.;","Cesa-Bianchi,","N.;","and","Fischer,","P.","2002.","Finite-time\nanalysis","of","the","multiarmed","bandit","problem.Machine","learn-\ning47(2-3):","235–256.\nBartlett,","P.","L.;","Bousquet,","O.;","Mendelson,","S.;","et","al.","2005.","Lo-\ncal","rademacher","complexities.The","Annals","of","Statistics33(4):\n1497–1537.\nCao,","W.;","Li,","J.;","Tao,","Y.;","and","Li,","Z.","2015.","","","On","top-k","selec-\ntion","in","multi-armed","bandits","and","hidden","bipartite","graphs.","","In\nAdvances","in","Neural","Information","Processing","Systems,","1036–\n1044.\nCaro,","","F.;","","and","","Gallien,","","J.","","2007.","","","Dynamic","","assortment","","with\ndemand","learning","for","seasonal","consumer","goods.Management\nScience53(2):","276–292.\nChen,","X.;","and","Wang,","Y.","2017.","A","Note","on","Tight","Lower","Bound\nfor","","MNL-Bandit","","Assortment","","Selection","","Models.arXiv\npreprint","arXiv:1709.06109.\nChen,","X.;","Wang,","Y.;","and","Zhou,","Y.","2018.","","Dynamic","Assort-\nment","Optimization","with","Changing","Contextual","Information.\narXiv","preprint","arXiv:1810.13069.\nCheung,","W.","C.;","and","Simchi-Levi,","D.","2017.","","Thompson","sam-\npling","for","online","personalized","assortment","optimization","prob-\nlems","","with","","multinomial","","logit","","choice","","models.Available","","at\nSSRN","3075658.\nChu,","W.;","Li,","L.;","Reyzin,","L.;","and","Schapire,","R.","2011.","Contex-\ntual","bandits","with","linear","payoff","functions.","","InProceedings","of\nthe","Fourteenth","International","Conference","on","Artificial","Intel-\nligence","and","Statistics,","208–214.\nDani,","V.;","Hayes,","T.","P.;","and","Kakade,","S.","M.","2008.","","Stochastic\nlinear","optimization","under","bandit","feedback.","InProceedings","of\nthe","21st","Annual","Conference","on","Learning","Theory,","355–366.\nDavis,","J.;","Gallego,","G.;","and","Topaloglu,","H.","2013.","","Assortment\nplanning","under","the","multinomial","logit","model","with","totally","uni-\nmodular","constraint","structures",".\nDavis,","J.","M.;","Gallego,","G.;","and","Topaloglu,","H.","2014.","","Assort-\nment","optimization","under","variants","of","the","nested","logit","model.\nOperations","Research62(2):","250–273.\nFilippi,","S.;","Cappe,","O.;","Garivier,","A.;","and","Szepesv\n","́\nari,","C.","2010.\nParametric","bandits:","The","generalized","linear","case.","InAdvances\nin","Neural","Information","Processing","Systems,","586–594.\nGhose,","A.;","Ipeirotis,","P.","G.;","and","Li,","B.","2014.","","Examining","the\nimpact","of","ranking","on","consumer","behavior","and","search","engine\nrevenue.Management","Science60(7):","1632–1654.\nHazan,","","E.;","","Agarwal,","","A.;","","and","","Kale,","","S.","","2007.","","","Logarithmic\nregret","algorithms","for","online","convex","optimization.Machine\nLearning69(2-3):","169–192.\nHazan,","E.;","Koren,","T.;","and","Levy,","K.","Y.","2014.","Logistic","regres-\nsion:","Tight","bounds","for","stochastic","and","online","optimization.","In\nConference","on","Learning","Theory,","197–209.\nJaksch,","T.;","Ortner,","R.;","and","Auer,","P.","2010.","","Near-optimal","re-\ngret","bounds","for","reinforcement","learning.Journal","of","Machine\nLearning","Research11(Apr):","1563–1600.\nJavanmard,","A.;","and","Nazerzadeh,","H.","2019.","","","Dynamic","pric-\ning","in","high-dimensions.The","Journal","of","Machine","Learning\nResearch20(1):","315–363.\nKveton,","B.;","Szepesvari,","C.;","Wen,","Z.;","and","Ashkan,","A.","2015.\nCascading","bandits:","Learning","to","rank","in","the","cascade","model.\nInInternational","","Conference","","on","","Machine","","Learning,","","767–\n776.\nKveton,B.;Zaheer,M.;Szepesvari,C.;Li,L.;\nGhavamzadeh,","","M.;","","and","","Boutilier,","","C.","","2019.Random-\nized","","Exploration","","in","","Generalized","","Linear","","Bandits.arXiv\npreprint","arXiv:1906.08947.\nLattimore,","T.;","and","Szepesv\n","́\nari,","C.","2019.Bandit","Algorithms.\nCambridge","University","Press","(preprint).\nLehmann,","E.","L.;","and","Casella,","G.","2006.Theory","of","point","esti-\nmation.","Springer","Science","&","Business","Media.\nLi,","L.;","Lu,","Y.;","and","Zhou,","D.","2017.","","Provably","Optimal","Algo-\nrithms","for","Generalized","Linear","Contextual","Bandits.","","InInter-\nnational","Conference","on","Machine","Learning,","2071–2080.\nMcFadden,","D.","1978.","","Modeling","the","choice","of","residential","lo-\ncation.Transportation","Research","Record(673).\nOh,","M.-h.;","and","Iyengar,","G.","2019.","","Thompson","Sampling","for\nMultinomial","Logit","Contextual","Bandits.","InAdvances","in","Neu-\nral","Information","Processing","Systems,","3145–3155.\nOh,","","M.-h.;","","Iyengar,","","G.;","","and","","Zeevi,","","A.","","2020.Sparsity-\nagnostic","lasso","bandit.arXiv","preprint","arXiv:2007.08477.\nOu,","M.;","Li,","N.;","Zhu,","S.;","and","Jin,","R.","2018.","Multinomial","Logit\nBandit","","with","","Linear","","Utility","","Functions.","","","","InProceedings","","of\nthe","27th","International","Joint","Conference","on","Artificial","Intel-\nligence,","IJCAI’18,","2602–2608.","AAAI","Press.\nPollard,","D.","1990.","","Empirical","processes:","theory","and","applica-\ntions.","InNSF-CBMS","regional","conference","series","in","probabil-\nity","and","statistics,","i–86.","JSTOR.\n\nQin,","L.;","Chen,","S.;","and","Zhu,","X.","2014.","","Contextual","combina-\ntorial","bandit","and","its","application","on","diversified","online","recom-\nmendation.","","InProceedings","of","the","2014","SIAM","International\nConference","on","Data","Mining,","461–469.","SIAM.\nRusmevichientong,","P.;","Shen,","Z.-J.","M.;","and","Shmoys,","D.","B.\n2010.","Dynamic","assortment","optimization","with","a","multinomial\nlogit","choice","model","and","capacity","constraint.Operations","re-\nsearch58(6):","1666–1680.\nRusmevichientong,","P.;","and","Tsitsiklis,","J.","N.","2010.","","","Linearly\nparameterized","bandits.Mathematics","of","Operations","Research\n35(2):","395–411.\nSaur\n","́\ne,","D.;","and","Zeevi,","A.","2013.","Optimal","dynamic","assortment\nplanning","with","demand","learning.Manufacturing","&","Service\nOperations","Management15(3):","387–404.\nThompson,","W.","R.","1933.","On","the","likelihood","that","one","unknown\nprobability","exceeds","another","in","view","of","the","evidence","of","two\nsamples.Biometrika25(3/4):","285–294.\nTropp,","","J.","","A.","","2012.","","","User-friendly","","tail","","bounds","","for","","sums","","of\nrandom","matrices.Foundations","of","computational","mathemat-\nics12(4):","389–434.\nWen,","Z.;","Kveton,","B.;","and","Ashkan,","A.","2015.","","Efficient","learn-\ning","in","large-scale","combinatorial","semi-bandits.","","","InInterna-\ntional","Conference","on","Machine","Learning,","1113–1122.\nZhang,","L.;","Yang,","T.;","Jin,","R.;","Xiao,","Y.;","and","Zhou,","Z.-H.","2016.\nOnline","","stochastic","","linear","","optimization","","under","","one-bit","","feed-\nback.","","","InInternational","","Conference","","on","","Machine","","Learning,\n392–401.\nZhou,","Z.;","Xu,","R.;","and","Blanchet,","J.","2019.","","Learning","in","gen-\neralized","linear","contextual","bandits","with","stochastic","delays.","","In\nAdvances","in","Neural","Information","Processing","Systems,","5198–\n5209.\nZong,","S.;","Ni,","H.;","Sung,","K.;","Ke,","N.","R.;","Wen,","Z.;","and","Kveton,\nB.","2016.","","Cascading","Bandits","for","Large-scale","Recommenda-\ntion","Problems.","InProceedings","of","the","Thirty-Second","Confer-\nence","on","Uncertainty","in","Artificial","Intelligence,","UAI’16,","835–\n844.\n\nRelated","Work\nBesides","the","contextual","bandit","literature","and","their","combinatorial","variants","mentioned","in","Introduction,","our","work","also","falls","into\nthe","category","of","dynamic","assortment","optimization.","Rusmevichientong,","Shen,","and","Shmoys","(2010)","and","Saur\n","́\ne","and","Zeevi","(2013)\nconsider","the","problem","of","minimizing","regret","under","the","MNL","choice","model","where","Rusmevichientong,","Shen,","and","Shmoys","(2010)\nshowedO(N\n2\nlog\n2\nT)regret","bound.","Saur\n","́\ne","and","Zeevi","(2013)","improved","the","bound","toO(NlogT).","However,","these","methods\nrequire","a","priori","knowledge","of","“separability”","between","the","true","optimal","assortment","and","the","other","sub-optimal","alternatives.","Agrawal\net","al.","(2017,","2019)","and","Chen","and","Wang","(2017)","also","formulated","dynamic","assortment","selection","as","an","online","regret","minimization\nproblem.","However,","these","previous","works","are","in","non-contextual","settings","and","assume","that","each","item","is","associated","with","a","unique\nparameter,","hence","generalization","across","different","items","is","not","considered.\nOu","et","al.","(2018)","extend","Agrawal","et","al.","(2019)","to","linear","utility,","yet","they","still","assume","the","utilities","are","fixed","over","time.","Recent\nwork","by","Chen,","Wang,","and","Zhou","(2018)","establishes\n","̃\nO(d\n√\nT)regret","bound","for","the","MNL","contextual","bandit","with","changing","context,\nthe","same","setting","as","ours.","Although","their","algorithm","appears","similar","to","our","first","algorithm,","UCB-MNL","(Algorithm","1),","there","is","a\nfundamental","difference","between","Chen,","Wang,","and","Zhou","(2018)","and","our","UCB-MNL.","Chen,","Wang,","and","Zhou","(2018)","enumerates\nthe","exponentially","many","(NchooseK)","assortments","and","builds","confidence","bounds","for","each","of","them.","In","contrast,","UCB-MNL\nmaintains","the","confidence","bound","in","the","parameter","space","and","subsequently","computes","the","upper","confidence","bounds","of","utility","for\neach","of","theNitems.","Chen,","Wang,","and","Zhou","(2018)","recognize","this","computational","issue","and","propose","an","approximate","optimization\nalgorithm","to","somewhat","remedy","it;","however,","not","completely.","Consider","the","simple","case","where","each","item","has","unit","revenue.","In","this\ncase,","","assortment","","selection","","under","","UCB-MNL","","reduces","","to","","sorting","","items","","based","","upper-confidence","","bounds","","and","","the","","run","","time","","is\nindependent","ofK,","whereas","Chen,","Wang,","and","Zhou","(2018)","still","have","to","consider","all","the","(NchooseK)","assortments.","Oh","and\nIyengar","(2019)","consider","Thompson","sampling","(Thompson","1933)","approach","to","the","MNL","contextual","bandits","but","their","regret","bound\nstill","has","a","gap","withd\n3/2\n√\nTregret.","Currently","known","lower","bounds","areΩ(d\n√\nT/K)(Chen,","Wang,","and","Zhou","2018)","andK\nindependent","lower","bound","withΩ(\n√\ndT)which","comes","fromΩ(\n√\nNT)of","non-contextual","setting","in","Chen","and","Wang","(2017).\nHowever,","no","previous","work","has","closed","the","gap","for","either","case.","Table","1","summarizes","the","regret","bounds","and","settings","of","recent","work\nin","the","MNL","bandits.","Our","main","results","in","this","paper","provide","tightest","results","for","the","MNL","bandit","problem","in","most","general","and\npractical","settings.\nProof","Outline","of","Theorem","1\nThe","","proof","","of","","the","","regret","","bound","","in","","Theorem1","","involves","","bounding","","the","","parameter","","estimation","","error‖\nˆ\nθ\nt\n−θ\n∗\n‖\nV\nt\nand\n∑\nt\nt\n′\n=1\n∑\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\nV\n−1\nt\n′\n−1\n.","Also,","we","need","to","ensure","that","the","optimistic","utility","estimate","is","indeed","optimistic,","i.e.,","the","optimistic\nutility","estimate","is","higher","than","the","true","utility.","We","present","the","following","key","lemmas.\nThe","initialization","durationT\n0\nis","specified","in","Theorem","1,","which","is","chosen","to","ensure","thatλ\nmin\n(V\nT\n0\n)is","large","enough","so","that","we\ncan","ensure‖\nˆ\nθ\nt\n−θ\n∗\n‖≤1fort",">","T\n0\n.","The","following","proposition","allows","us","to","find","suchT\n0\n.\nProposition","1(Li,","Lu,","and","Zhou","2017,","Proposition","1).Letx\nt\n′\ni\nbe","drawn","i.i.d.","from","some","distributionνwith‖x\nt\n′\ni\n‖","≤1and\nE[x\nt\n′\ni\nx\n>\nt\n′\ni\n]≥σ\n0\n(Assumption","1).","DefineV\nT\n0\n=\n∑\nT\n0\nt\n′\n=1\n∑\ni∈S\nt\n′\nx\nt\n′\ni\nx\n>\nt\n′\ni\n,","whereT\n0\nis","the","length","of","random","initialization.","Suppose\nwe","run","a","random","initialization","with","assortment","sizeKfor","durationT\n0\nwhich","satisfies\nT\n0\n≥\n1\nK\n(\nC\n1\n√\nd+C\n2\n√\n2","logT\nσ\n0\n)\n2\n+\n2B\nKσ\n0\nfor","some","positive,","universal","constantsC\n1\nandC\n2\n.","Then,λ\nmin\n(V\nT\n0\n)≥Bwith","probability","at","least1−\n1\nT\n2\n.\nThe","proposition","implies","that","we","can","haveλ\nmin\n(V\nT\n0\n)≥Kwith","a","high","probability","if","we","run","the","initialization","forO(σ\n−2\n0\n(d+\nlogT))rounds.","Similar","to","Filippi","et","al.","(2010)","and","Li,","Lu,","and","Zhou","(2017),","the","i.i.d.","assumption","(in","Assumption","1)","on","the\ncontextx\nti\nis","only","needed","to","ensure","thatV\nT\n0\nis","invertible","at","the","end","of","the","initialization","phase.","In","the","rest","of","the","regret","analysis,\nwe","do","not","require","this","stochastic","assumption.","Hence,","after","the","initialization,x\nti\ncan","even","be","chosen","adversarily","as","long","as‖x\nti\n‖\nis","bounded.","We","also","wantλ\nmin\n(V\nT\n0\n)to","be","large","enough","so","that‖\nˆ\nθ\nt\n−θ\n∗\n‖≤1fort",">","T\n0\n.","The","following","lemma","specifies","how\nlargeλ\nmin\n(V\nT\n0\n)should","be\nLemma","1(Kveton","et","al.","2019,","Lemma","9).LetT\n0\nbe","any","round","such","that\nλ\nmin\n(V\nT\n0\n)≥max\n{\nσ\n2\nκ\n−2\n(dlog(T/d)","+","4","logT),K\n}\n.\nThen","for","anyt≥T\n0\n,P\n(\n‖\nˆ\nθ\nt\n−θ\n∗\n‖>1\n)\n≤\n1\nT\n2\n.\nLemma","2","shows","that","the","true","parameterθ\n∗\nlies","within","an","ellipsoid","centered","at\nˆ\nθ\nt\nwith","a","suitable","confidence","radius","underV\nt\nweighted`\n2\nnorm","with","a","high","probability.","Recall","that","Proposition","1","ensures","that","we","haveλ\nmin\n(V\nT\n0\n)is","sufficiently","large","at","the\nend","of","the","initialization","phase","with","a","suitable","initialization","duration","(which","is","specified","in","the","statement","of","Theorem","1)","if","we","run\nthe","initialization","with","sizeKassortments;","hence","the","algorithm","satisfies","the","condition","of","the","following","lemma.\n\nLemma","2.Suppose‖\nˆ\nθ\nt\n−θ\n∗\n‖≤1fort",">","T\n0\n.","Then\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\nV\nt\n≤\n1\n2κ\n√\n2dlog\n(\n1","+\nt\nd\n)\n+","2","logt(5)\nholds","for","allt",">","T\n0\nwith","a","probability1−O(t\n−2\n).\nThe","condition‖\nˆ\nθ\nt\n−θ\n∗\n‖≤1can","be","ensured","with","a","high","probability","by","combining","Lemma","1","and","Proposition","1.","Lemma","2","is","a\nfinite-sample","normality-type","estimation","error","bound","for","the","MLE","of","the","MNL","model.","This","result","suggests","that","we","can","construct\nthe","optimistic","utility","estimate","using","the","confidence","radiusα\nt\n=\n1\n2κ\n√\n2dlog\n(\n1","+\nt\nd\n)\n+","2","logt.","The","following","lemma","shows","our\noptimistic","utility","estimatez\nti\nis","an","upper","confidence","bound","for","the","expected","utilityx\n>\nti\nθ\n∗\nif","the","true","parameterθ\n∗\nis","contained\nin","the","confidence","ellipsoid","centered","at\nˆ\nθ\nt\n.\nLemma","3.Letz\nti\n=x\n>\nti\nˆ\nθ\nt−1\n+α\nt\n‖x\nti\n‖\nV\n−1\nt\n.","If(5)holds,","then","we","have\n0≤z\nti\n−x\n>\nti\nθ\n∗\n≤2α\nt\n‖x\nti\n‖\nV\n−1\nt\n.\nThe","following","lemma","shows","that","the","optimistic","expected","revenue\n","̃\nR\nt\n(S\nt\n)is","an","upper","bound","of","the","true","expected","revenue","of\nthe","optimal","assortmentR\nt\n(S\n∗\nt\n,θ\n∗\n).","The","lemma","is","an","adaptation","of","Lemma","4.2","in","(Agrawal","et","al.","2019)","which","is","shown","for\nnon-contextual","setting.\nLemma","4.SupposeS\n∗\nt\nis","the","offline","optimal","assortment","as","defined","in(2),","and","supposeS\nt\n=","arg","max\nS⊂S\n","̃\nR\nt\n(S).","If","for","every\nitemi∈S\n∗\nt\n,z\nti\n≥x\n>\ni\nθ\n∗\n,","then","the","revenues","satisfy","the","following","inequalities","for","all","roundt:\nR\nt\n(S\n∗\nt\n,θ\n∗\n)≤\n","̃\nR\nt\n(S\n∗\nt\n)≤\n","̃\nR\nt\n(S\nt\n).\nIt","is","important","to","note","that","Lemma","4","does","not","claim","that","the","expected","revenue","is","generally","a","monotone","function,","but","only\nthe","value","of","the","expected","revenue","corresponding","to","the","optimal","assortment","increases","with","an","increase","in","the","MNL","parameters\n(Agrawal","et","al.","2019).\nThen","we","show","that","the","expected","revenue","has","Lipschitz","property","and","bound","the","immediate","regret","with","the","maximum","variance\nover","the","assortment.\nLemma","5.Suppose","that0≤z\nti\n−x\n>\nti\nθ\n∗\n≤2α\nt\n‖x\nti\n‖\nV\n−1\nt\nholds","fori∈S\nt\nwhereS\nt\nis","the","chosen","assortment","in","roundt.","Then,\nwe","have\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)≤2α\nt\nmax\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt\nThe","next","technical","lemma","bounds","the","sum","of","weighted","squared","norms.","Note","that","we","later","apply","Cauchy-Schwarz","inequality\nto","eventually","bound\n∑\nT\nt=1\nmax\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt\nby\n","̃\nO(\n√\ndT).\nLemma","6.DefineV\nT\n0\n=\n∑\nT\n0\nt=1\n∑\ni∈S\nt\n′\nx\nti\nx\n>\nti\nandV\nT\n=V\nT\n0\n+\n∑\nT\nt=V\n0\n+1\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n.","Ifλ\nmin\n(V\nT\n0\n)≥K,","then","we","have\nT\n∑\nt=1\nmax\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt\n≤2dlog","(T/d)\nHence,","each","of","Lemma","2","and","Lemma","6","contributes\n√\ndfactor","separately","to","the","overall","regret,","resulting","indfactor","in","Theo-\nrem","1.","Now","we","can","combine","the","results","to","show","the","cumulative","regret","bound.","First","we","define","the","joint","high","probability","event\nfor","the","concentration","of","the","MLE","and","the","random","initialization.\nDefinition","1.Define","the","following","event:\nˆ\nE:=\n{\n‖\nˆ\nθ\nt\n−θ\n∗\n‖≤1,‖\nˆ\nθ\nt\n−θ\n∗\n‖\nV\nt\n≤α\nt\n,∀t≥T\n0\n}\nNote","that","by","Proposition","1","withT\n0\n=","max\n{\nσ\n2\n(dlog(T/d)+4","logT)\nKσ\n0\nκ\n2\n,\nd+logT\nσ\n2\n0\n}\n,","we","can","show\nλ\nmin\n(V\nT\n0\n)≥max\n{\nσ\n2\nκ\n−2\n(dlog(T/d)","+","4","logT),K\n}\nwith","a","high","probability,","which","in","turn","can","ensure‖\nˆ\nθ\nt\n−θ\n∗\n‖","≤1by","Lemma","1.","We","first","break","the","regret","into","the","initialization\nphase","and","the","learning","phase:\nR\nT\n=E\n[\nT\n0\n∑\nt=1\n(R(S\n∗\nt\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))\n]\n+E\n[\nT\n∑\nt=T\n0\n+1\n(R(S\n∗\nt\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))\n]\n≤T\n0\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R(S\nt\n,θ\n∗\n)\n)\n]\n\nwhere","the","last","inequality","comes","from","optimistic","revenue","estimation","by","Lemma","4.","Now,","we","further","decompose","the","regret","of","the\nlearning","phase","further","into","two","components","–","when","the","high","probability","event","holds","in","Lemma","2","and","in","Lemma","1","(i.e.,\nˆ\nEholds)\nand","when","either","of","the","events","does","not","hold,","(i.e.\nˆ\nE\nc\n).\nR\nT\n≤T\n0\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n1(\nˆ\nE)\n]\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n1(\nˆ\nE\nc\n)\n]\n≤T\n0\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n1(\nˆ\nE)\n]\n+\nT\n∑\nt=1\nO(t\n−2\n)\n≤T\n0\n+\nT\n∑\nt=1\n2α\nT\nmax\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt\n+O(1)\nwhere","the","last","inequality","is","from","Lemma","5.","Applying","Cauchy-Schwarz","inequality","in","the","second","term,","it","follows","that\nR\nT\n≤T\n0\n+","2α\nT\n√\n√\n√\n√\nT\nT\n∑\nt=1\nmax\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt\n+O(1).\nApplying","Lemma","6","for\n∑\nT\nt=1\nmax\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt\n,\nR\nT\n≤T\n0\n+","2α\nT\n√\n2dTlog","(T/d)","+O(1).\nFinally,","lettingα\nT\n=\nσ\nκ\n√\n2dlog\n(\n1","+\nT\nd\n)\n+","logT,","we","have\nR\nT\n≤T\n0\n+\nd\nκ\n√\nTlog","(1","+T/d)","log(T/d)","+\n1\nκ\n√\ndlogTlog","(T/d)","+O(1).\nProofs","of","Lemmas","for","Theorem","1\nProof","of","lemma","2\nProof.We","first","define","the","following:\nJ\nn\n(θ)","=\nn−1\n∑\nt=1\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−p\nt\n(i|S\nt\n,θ\n∗\n))x\nti\nZ\nn\n:=J\nn\n(\nˆ\nθ)","=\nn\n∑\nt=1\n∑\ni∈S\nt\n\u000f\nti\nx\nti\n.\nThen","we","follow","the","same","arguments","of","the","proof","of","Theorem","2","until","(12)","which","states\n‖Z\nn\n‖\nV\n−1\nn\n=‖J\nn\n(\nˆ\nθ)‖\nV\n−1\nn\n≥κ\n2\n‖\nˆ\nθ−θ\n∗\n‖\n2\nV\nn\nfor","any\nˆ\nθ∈","{θ:‖θ−θ\n∗\n‖","≤1}.","Then","we","are","left","to","bound‖Z\nn\n‖\n2\nV\n−1\nn\n.","We","can","use","Theorem","1","in","(Abbasi-Yadkori,","P\n","́\nal,","and\nSzepesv\n","́\nari","2011),","which","states","if","the","noise\u000f\nti\nis","sub-gaussian","with","parameterσ,","then\n‖Z\nn\n‖\n2\nV\n−1\nn\n≤2σ\n2\nlog\n(\ndet(V\nn\n)\n1/2\ndet(V\nT\n0\n)\n−1/2\nδ\n)\nwith","probability","at","least1−δ.","Then","we","combine","with","Lemma","8.","So","it","follows","that\n‖Z\nn\n‖\n2\nV\n−1\nn\n≤2σ\n2\n[\nd\n2\nlog\n(\ntrace(V\nT\n0\n)","+nK\nd\n)\n−\n1\n2\nlog","det(V\nT\n0\n)","+","log\n1\nδ\n]\n.\n\nLetλ\n1\n,...,λ\nd\nbe","the","eigenvalues","ofV\nT\n0\nand","let\n","̄\nλ=\n∑\ni\nλ\ni\nd\n,","then\n‖Z\nn\n‖\n2\nV\n−1\nn\n≤2σ\n2\n[\nd\n2\nlog\n(\n","̄\nλ+\nnK\nd\n)\n−\nd\n2\nlog\n","̄\nλ+\nd\n2\nlog\n","̄\nλ−\n1\n2\nlog","det(V\nT\n0\n)","+","log\n1\nδ\n]\n=","2σ\n2\n[\nd\n2\nlog\n(\n1","+\nnK\nd\n","̄\nλ\n)\n+\n1\n2\n∑\ni\nlog\n","̄\nλ\nλ\ni\n+","log\n1\nδ\n]\n≤2σ\n2\n[\nd\n2\nlog\n(\n1","+\nnK\ndλ\nmin\n(V\nT\n0\n)\n)\n+\nd\n2\nlog\n","̄\nλ\nλ\nmin\n(V\nT\n0\n)\n+","log\n1\nδ\n]\n≤2σ\n2\n[\nd\n2\nlog\n(\n1","+\nn\nd\n)\n+\nd\n2\nlog\n","̄\nλ\nK\n+","log\n1\nδ\n]\n≤2σ\n2\n[\ndlog\n(\n1","+\nn\nd\n)\n+","log\n1\nδ\n]\nwhere","the","third","inequality","is","byλ\nmin\n(V\nT\n0\n)≥Kand","the","last","inequality","is","fromd\n","̄\nλ=trace(V\nT\n0\n)≤nK.","Then,","using","the","fact\nthatσ\n2\n=\n1\n4\nin","our","problem,","we","have","that\n‖\nˆ\nθ\nn\n−θ\n∗\n‖\nV\nn\n≤\n1\n2κ\n√\n2dlog\n(\n1","+\nn\nd\n)\n+","log\n1\nδ\n.\nwith","probability","at","least1−δ.\nProof","of","Lemma","6\nThe","proof","of","Lemma","6","requires","the","following","technical","lemmas.","These","lemmas","follow","from","the","proof","of","Lemma","6","in","(Oh","and\nIyengar","2019)","with","a","subtle","difference","inV\nT\n0\n.","For","completeness,","we","present","the","proof","in","this","specific","setting.\nLemma","7.Suppose‖x\nti\n‖≤1for","alliandt.","DefineV\nt\n=V\nT\n0\n+\nt\n∑\nt\n′\n=T\n0\n+1\n∑\ni∈S\nt\n′\nx\nt\n′\ni\nx\n>\nt\n′\ni\n.","Ifλ\nmin\n(V\nT\n0\n)≥K.","Then\nt\n∑\nt\n′\n=T\n0\n+1\n∑\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nt\n′\n−1\n≤2","log\n(\ndet(V\nt\n)\nλ\nmin\n(V\nT\n0\n)\nd\n)\nProof.Letλ\n1\n,λ\n2\n,...,λ\nd\nbe","the","eigenvalues","of\n∑\nn\ni=1\nx\nti\nx\n>\nti\n.","Since\n∑\nn\ni=1\nx\nti\nx\n>\nti\nis","positive","semi-definite,λ\nj\n≥0for","allj.\nHence,","we","have\ndet\n(\nI+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n=\nd\n∏\nj=1\n(1","+λ\nj\n)\n≥1","+\nd\n∑\nj=1\nλ\nj\n=","1−d+\nd\n∑\nj=1\n(1","+λ\nj\n)\n=","1−d+trace\n(\nI+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n=","1","+\n∑\ni∈S\nt\n‖x\nti\n‖\n2\n2\n(6)\nNow,","we","lower-bounddet(V\nt\n).\ndet(V\nt\n)","=","det\n(\nV\nt\n+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n=","det(V\nt\n)","det\n(\nI+\n∑\ni∈S\nt\nV\n−1/2\nt\nx\nti\n(V\n−1/2\nt\nx\nti\n)\n>\n)\n≥det(V\nt\n)\n(\n1","+\n∑\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt\n)\n≥det(V\nT\n0\n)\nt\n∏\nt\n′\n=T\n0\n+1\n(\n1","+\n∑\ni∈S\nt\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nt\n′\n−1\n)\n(7)\n\nThe","first","inequality","comes","from","(6).","The","second","inequality","comes","from","applying","the","first","inequality","repeatedly.","Letλ\nmin\n(V\nt\n)be\nthe","minimum","eigenvalue","ofV\nt\n.","Notice","that\n‖x\nti\n‖\n2\nV\n−1\nt\n′\n−1\n≤\n‖x\nti\n‖\n2\nλ\nmin\n(V\nτ−1\n)\n≤\n1\nλ\nmin\n(V\nT\n0\n)\n≤\n1\nK\n.\nHence\n∑\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt\n′\n−1\n≤1for","allt≥T\n0\n.","Then","using","the","fact","thatz≤2","log(1","+z)for","anyz∈[0,1],","we","have\nt\n∑\nt\n′\n=T\n0\n+1\n∑\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nt\n′\n−1\n≤2\nt\n∑\nt\n′\n=T\n0\n+1\nlog\n\n\n1","+\n∑\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nt\n′\n−1\n\n\n=","2","log\nt\n∏\nt\n′\n=T\n0\n+1\n\n\n1","+\n∑\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nt\n′\n−1\n\n\n≤2","log\n(\ndet(V\nt\n)\ndet(V\nT\n0\n)\n)\n≤2","log\n(\ndet(V\nt\n)\nλ\nmin\n(V\nT\n0\n)\nd\n)\nThe","second","inequality","is","from","(7).\nLemma","8.Suppose‖x\nti\n‖≤1for","alliandt.","Thendet(V\nt\n)is","increasing","with","respect","totand\ndet(V\nt\n)≤\n(\ntK\nd\n)\nd\n(8)\nProof.For","any","symmetric","positive","definite","matrix\n","̃\nV∈R\nd×d\nand","column","vectorx∈R\nd\n,","we","have\ndet(\n","̃\nV+xx\n>\n)","=","det(V)","det\n(\nI+\n","̃\nV\n−1/2\nxx\n>\n","̃\nV\n−1/2\n)\n=","det(\n","̃\nV)","det(1","+‖\n","̃\nV\n−1/2\nx‖\n2\n)\n≥det(\n","̃\nV).\nThe","second","equality","above","is","due","to","Sylvester’s","determinant","theorem,","which","states","thatdet(I+BA)","","=","","det(I+AB).","Let\nλ\n1\n,...,λ\nd\n>0be","the","eigenvalues","ofV\nt\n.","Then\ndet(V\nt\n)≤\n(\nλ\n1\n+...+λ\nd\nd\n)\nd\n=\n(\ntrace(V\nt\n)\nd\n)\nd\n=\n(\n∑\nt\nt\n′\n=1\n∑\ni∈S\nt\n′\ntrace(x\nt\n′\ni\nx\n>\nt\n′\ni\n)\nd\n)\nd\n=\n(\n∑\nt\nt\n′\n=1\n∑\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\n2\nd\n)\nd\n≤\n(\ntK\nd\n)\nd\n.\nProof.Proof","of","Lemma","6","Combining","Lemma","7","and","Lemma","8,\nt\n∑\nt\n′\n=1\nmax\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nτ\n≤2","log\n(\ndet(V\nt\n)\ndet(V\nT\n0\n)\n)\n≤2","log\n(\ntK\ndλ\nmin\n(V\nT\n0\n)\n)\nd\n≤2dlog","(t/d).\nwhere","the","last","inequality","is","byλ\nmin\n(V\nT\n0\n)≥K.","Then","we","complete","the","proof.\n\nProof","of","Lemma","3\nProof.\n|x\n>\nti\nˆ\nθ\nt−1\n−x\n>\nti\nθ\n∗\n|=\n∣\n∣\n∣\n∣\n[\nV\n−1/2\nt−1\n(\nˆ\nθ\nt−1\n−θ\n∗\n)\n]\n>\n(V\n−1/2\nt−1\nx\nti\n)\n∣\n∣\n∣\n∣\n≤‖V\n−1/2\nt−1\n(\nˆ\nθ\nt−1\n−θ\n∗\n)‖\n2\n‖(V\n−1/2\nt−1\nx\nti\n)‖\n2\n=‖\nˆ\nθ\nt−1\n−θ\n∗\n‖\nV\nt\n‖x\nti\n‖\nV\n−1\nt\n≤α‖x\nti\n‖\nV\n−1\nt\nwhere","the","first","inequality","is","by","H\n","̈\nolder’s","inequality.","Hence,","it","follows","that\n(\nx\n>\nti\nˆ\nθ\nt−1\n+α‖x\nti\n‖\nV\n−1\nt\n)\n−x\n>\nti\nθ\n∗\n≤2α‖x\nti\n‖\nV\n−1\nt\n.\nAlso,","From|x\n>\nti\nˆ\nθ\nt−1\n−x\n>\nti\nθ\n∗\n|≤α‖x\nti\n‖\nV\n−1\nt\n,","we","have\nx\n>\nti\nˆ\nθ\nt−1\n−x\n>\nti\nθ\n∗\n≥−α‖x\nti\n‖\nV\n−1\nt\nHence,","we","have\n(\nx\n>\nti\nˆ\nθ\nt−1\n+α‖x\nti\n‖\nV\n−1\nt\n)\n−x\n>\nti\nθ\n∗\n≥0\nProof","of","Lemma","5\nProof.Letu\nti\n≥u\n′\nti\nfor","alli.","By","the","mean","value","theorem,","there","exists","̄u\nti\n:=","(1−c)u\nti\n+cu\n′\nti\nfor","somec∈(0,1)with\n∑\ni∈S\nr\nti\nexp","(u\nti\n)\n1","+\n∑\nj∈S\nexp","(u\ntj\n)\n−\n∑\ni∈S\nr\nti\nexp(u\n′\nti\n)\n1","+\n∑\nj∈S\nexp(u\n′\ntj\n)\n=\n(\n∑\ni∈S\nr\nti\nexp{","̄u\nti\n}(u\nti\n−u\n′\nti\n))(1","+\n∑\ni∈S\nexp{","̄u\nti\n})\n(1","+\n∑\ni∈S\nexp{","̄u\nti\n})\n2\n−\n(\n∑\ni∈S\nr\nti\nexp{","̄u\nti\n})(\n∑\ni∈S\nexp{","̄u\nti\n}(u\nti\n−u\n′\nti\n))\n(1","+\n∑\ni∈S\nexp{","̄u\nti\n})\n2\n=\n∑\ni∈S\nr\nti\np\nti\n(S,","̄u\nt\n)(u\nti\n−u\n′\nti\n)−R\nt\n(S,","̄u\nt\n)·\n∑\ni∈S\np\nti\n(S,","̄u\nt\n)(u\nti\n−u\n′\nti\n)\n=\n∑\ni∈S\n(\nr\nti\n−R\nt\n(S,","̄u\nt\n)\n)\np\nti\n(S,","̄u\nt\n)(u\nti\n−u\n′\nti\n)\n≤max\ni∈S\n|u\nti\n−u\n′\nti\n|=","max\ni∈S\n(u\nti\n−u\n′\nti\n)\nwhere","the","inequality","is","from|r\nti\n|≤1,","andp\nti\n(S,","̄u\nt\n)≤1is","a","multinomial","probability.\nOnline","Parameter","Update\nUCB-MNL","","is","","simple","","to","","implement","","and","","more","","practical","","compared","","to","","previously","","known","","methods","","in","","MNL","","bandit","","problems.\nThe","algorithm","also","enjoys","a","good","theoretical","property,","in","particular,","good","statistical","efficiency","shown","in","Theorem","1.","Despite\nthese","advantages,","however,","UCB-MNL","can","be","still","computationally","expensive.","In","each","roundt,","the","MLE\nˆ\nθ\nt\nis","computed","using\nΘ(tK)samples,","i.e.,","the","per-round","computational","complexity","grows","at","least","linearly","withtfor","a","straightforward","implementation\nof","the","algorithm.","Note","that","this","issue","is","not","unique","to","UCB-MNL.","(Chen,","Wang,","and","Zhou","2018)","also","suffers","from","the","same\nissue","in","addition","to","its","computationally","expensive","procedure","of","the","upper","confidence","construction","for","all","assortments","which","we\ndiscussed","earlier.","In","fact,","this","bottleneck","makes","many","bandit","algorithms","including","those","in","generalized","linear","bandits","(Filippi\net","al.","2010;","Li,","Lu,","and","Zhou","2017)","inappropriate","for","online","implementations","in","real-world","applications","since","the","entire","learning\nhistory","is","stored","in","memory","and","used","for","parameter","estimation","in","each","round.\nIn","this","section,","we","discuss","a","modification","of","UCB-MNL","which","incorporate","an","efficient","online","update","that","effectively","exploits\nparticular","structures","of","the","MNL","model.","As","mentioned","earlier,","computing","the","exact","solution","for","MLE","does","not","scale","well","in\ntime","and","space","complexity.","Hence,","we","propose","an","online","update","scheme","to","find","an","approximate","solution.","First,","we","define","the\nper-round","loss","for","the","MNL","model","and","its","gradient.\nDefinition","2.Define","the","per-round","lossf\nt\n(θ)and","its","gradientG\nt\n(θ)as","the","following:\nf\nt\n(θ)",":=−\n∑\ni∈S\nt\ny\nti\nlogp\nt\n(i|S\nt\n,θ)","=−\n∑\ni∈S\nt\ny\nti\nx\n>\nti\nθ+","log\n(\n1","+\n∑\nj∈S\nt\nexp(x\n>\ntj\nθ)\n)\nG\nt\n(θ)",":=∇\nθ\nf\nt\n(θ)","=\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)x\nti\n\nThe","important","observation","here","is","that","the","loss","for","the","MNL","model","at","each","roundtis","strongly","convex","over","bounded","domain,\nwhich","enables","us","to","apply","a","variant","of","the","online","Newton","step","(Hazan,","Agarwal,","and","Kale","2007),","in","particular","inspired","by\n(Hazan,","Koren,","and","Levy","2014;","Zhang","et","al.","2016)","which","proposed","online","algorithms","for","the","logistic","model.","Specifically,","we\npropose","to","find","an","approximate","solution","by","solving","the","following","problem\nˆ\nθ\nt\n=","argmin\nθ\n{\n1\n2\n‖θ−\nˆ\nθ\nt−1\n‖\n2\nV\nt\n+","(θ−\nˆ\nθ\nt−1\n)\n>\nG\nt−1\n(\nˆ\nθ\nt−1\n)\n}\n(9)\nwhereV\nt\n=V\nt\n+\nκ\n2\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n.\nAlgorithm","3UCB-MNL","with","online","parameter","update\n1:Input:","total","roundsT,","initialization","roundsT\n0\nand","confidence","radius","̃α\nt\n2:Initialization:fort∈[T\n0\n]\n3:Randomly","chooseS\nt\nwith|S\nt\n|=K\n4:V\nt\n←V\nt−1\n+\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n5:forallt=T\n0\n+","1toTdo\n6:Compute","̃z\nti\n=x\n>\nti\nˆ\nθ\nt−1\n+","̃α\nt\n‖x\nti\n‖\nV\n−1\nt−1\nfor","alli∈[N]\n7:ComputeS\nt\n=","argmax\nS⊂S\n","̃\nR\nt\n(S)based","on{","̃z\nti\n}\n8:OfferS\nt\nand","observey\nt\n(user","choice","at","timet)\n9:UpdateV\nt\n←V\nt−1\n+\nκ\n2\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n10:Compute\nˆ\nθ\nt\nby","solving","the","problem\nˆ\nθ\nt\n=","argmin\nθ\n{\n1\n2\n‖θ−\nˆ\nθ\nt−1\n‖\n2\nV\nt\n+","(θ−\nˆ\nθ\nt−1\n)\n>\nG\nt−1\n(\nˆ\nθ\nt−1\n)\n}\n11:end","for\nThe","modified","algorithm","is","summarized","in","Algorithm","3.","The","key","difference","is","the","parameter","update","rule","in","(9)","and","the","corre-\nsponding","confidence","radius.","During","the","learning","phase,","the","learning","agent","builds","a","upper","confidence","utility","estimate","̃z\nti\nbased\non","a","new","confidence","radius","̃α\nt\nwhich","is","specified","in","Lemma","9","and","Theorem","5.","For","parameter","estimation,","onlyΘ(K)samples\nare","needed","(for","both","computation","and","space)","per","each","round,","compared","toΘ(tK)in","Algorithm","1","which","grows","linearly","with\neach","roundt.\nLemma","9.Ifλ\nmin\n(V\nT\n0\n)≥K,","then\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\nV\nt\n≤\n√\nT\n0\n+\n8\nκ\ndlog\n(\n1","+\nt\nd\n)\n+\n(\n8\nκ\n+\n16\n3\n)\nlog","(d2","log\n2\n(tK/2)et\n4\n)","+","4\nholds","for","allt",">","T\n0\nwith","a","probability1−O(t\n−2\n).\nThe","proof","relies","on","exploiting","the","structure","of","the","MNL","loss","and","concentration","inequalities","for","martingales.","Since","we","use\nfewer","samples","(less","information)","per","update","in","the","modified","online","update","compared","to","the","MLE","computation,","one","might","expect\nthe","confidence","bound","to","increase","with","the","online","update","modification.","Nevertheless,","Lemma","9","shows","the","confidence","bound","with\nO\n(\n√\ndlog","(1","+t/d)\n)\nwhich","is","of","the","same","order","as","the","bound","shown","in","Lemma","2","–","although","there","are","extra","additive","terms","and\npotentially","a","larger","constant.","This","suggests","that","the","total","regret","bound","for","the","modified","UCB-MNL","should","be","also","of","the","same\norder","as","the","original","UCB-MNL.","We","present","the","regret","bound","for","the","UCB-MNL","with","online","parameter","update,","which","is","an\nformal","statement","of","Corollary","1.\nTheorem","5.There","exists","a","universal","constantC\n0\n>0,","such","that","if","we","runUCB-MNLwith","“online","parameter","update”\n(Algorithm","3)","with","confident","radius","̃α\nt\nfor","total","ofTrounds","withT\n0\n=\n⌈\nC\n0\nmax\n{\nd+logT\nσ\n2\n0\nK\n,\n1\nσ\n0\n}⌉\nassortment","size","constraintK,\nthen","the","expected","regret","of","the","algorithm","with","is","upper-bounded","by\nR\nT\n≤T\n0\n+O(1)","+","̃α\nT\n√\ndTlog","(T/d)","=O\n(\nd\n√\nTlog","(1","+T/d)","log(T/d)\n)\nwhere","̃α\nt\n=\n√\nT\n0\n+\n8\nκ\ndlog\n(\n1","+\nt\nd\n)\n+\n(\n8\nκ\n+\n16\n3\n)\nlog","(d2","log\n2\n(tK/2)et\n4\n)","+","4.\nTheorem","5","achieves","a","regret","bound","of\n","̃\nO(d\n√\nT)which","matches","the","bound","in","Theorem","1","for","","UCB-MNL.","The","proof","of\nTheorem","5","follows","the","similar","steps","as","Theorem","1","and","is","presented","in","the","follwing","section.","This","result","suggests","that","the","modified\nUCB-MNL","is","appropriate","for","online","implementation,","achieving","both","statistical","and","computational","efficiency.","In","Section",",","we\ncompare","the","numerical","performances","of","UCB-MNL","and","its","online","update","modification","along","with","other","benchmarks.\n\nProofs","for","Lemma","9","and","Theorem","5\nThe","proof","of","Lemma","9","depends","on","the","few","technical","lemma","we","present","here","in","this","section.","Recall","from","Definition","2","for","the\nper-round","lossf\nt\n(θ)and","its","gradientG\nt\n(θ):\nf\nt\n(θ)","=−\n∑\ni∈S\nt\n∪{0}\ny\nti\nlogp\nt\n(i|S\nt\n,θ)","=−\n∑\ni∈S\nt\ny\nti\nx\n>\nti\nθ+","log\n(\n1","+\n∑\nj∈S\nt\nexp(x\n>\ntj\nθ)\n)\nG\nt\n(θ)","=∇\nθ\nf\nt\n(θ)","=\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)x\nti\nWe","will","use","these","terms","throughout","this","section.","In","addition","tof\nt\n(θ)andG\nt\n(θ),","we","also","define","their","conditional","expectations\nwhich","we","will","utilize","in","the","proofs","of","this","section.\nDefinition","3.Define","the","conditional","expectations","overyoff\nt\n(θ)and","its","gradientG\nt\n(θ).\n","̄\nf\nt\n(θ)",":=E\ny\n[f\nt\n(θ)|F\nt\n]\n","̄\nG\nt\n(θ)",":=E\ny\n[G\nt\n(θ)|F\nt\n]","=E\ny\n[∇f\nt\n(θ)|F\nt\n]\nLemma","10.For","anyθ\n1\n,θ\n2\n,","we","have\nf\nt\n(θ\n2\n)≥f\nt\n(θ\n1\n)","+G\nt\n(θ\n1\n)\n>\n(θ\n2\n−θ\n1\n)","+\nκ\n2\n(θ\n2\n−θ\n1\n)\n>\n(\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n(θ\n2\n−θ\n1\n)\nProof.Using","the","Taylor","expansion,","with\n","̄\nθ=cθ\n2\n−(1−c)θ\n1\nfor","somec∈(0,1)\nf\nt\n(θ\n2\n)","=f\nt\n(θ\n1\n)","+G\nt\n(θ\n1\n)\n>\n(θ\n2\n−θ\n1\n)","+\n1\n2\n(θ\n2\n−θ\n1\n)\n>\nH\nf\n(\n","̄\nθ)(θ\n2\n−θ\n1\n)(10)\nwhereH\nf\n(\n","̄\nθ)is","the","Hessian","matrix","at\n","̄\nθ.","Following","the","proof","of","Theorem","2,","the","Hessian","matrix","can","be","lower-bounded","as","follows\nH\nf\n(\n","̄\nθ)","=\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,\n","̄\nθ)x\nti\nx\n>\nti\n−\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nt\n(i|S\nt\n,\n","̄\nθ)p\ntj\n(S\nt\n,\n","̄\nθ)x\nti\nx\n>\ntj\n\u0017\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,\n","̄\nθ)p\nt0\n(\n","̄\nθ)x\nti\nx\n>\nti\nFrom","Assumption","2,","we","have\nH\nf\n(\n","̄\nθ)\u0017κ\n∑\ni∈S\nt\nx\nti\nx\n>\nti\nTherefore,","we","have\nf\nt\n(θ\n2\n)","=f\nt\n(θ\n1\n)","+G\nt\n(θ\n1\n)\n>\n(θ\n2\n−θ\n1\n)","+\n1\n2\n(θ\n2\n−θ\n1\n)\n>\nH\nf\n(\n","̄\nθ)(θ\n2\n−θ\n1\n)\n≥f\nt\n(θ\n1\n)","+G\nt\n(θ\n1\n)\n>\n(θ\n2\n−θ\n1\n)","+\nκ\n2\n(θ\n2\n−θ\n1\n)\n>\n(\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n(θ\n2\n−θ\n1\n).\nLemma","11.\n2G\nt\n(\nˆ\nθ\nt\n)\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)≤‖G\nt\n(θ\nt\n)‖\n2\nV\n−1\nt+1\n+‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt+1\n−‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\nProof.Note","that\nˆ\nθ\nt+1\nis","the","optimal","solution","to","the","problem\nˆ\nθ\nt+1\n=","argmin\nθ\n1\n2\n‖θ−\nˆ\nθ\nt\n‖\n2\nV\nt+1\n+","(θ−\nˆ\nθ\nt\n)\n>\nG\nt\n(\nˆ\nθ\nt\n)\nHence,","from","the","first-order","optimality","condition,","we","have\n[\nG\nt\n(\nˆ\nθ\nt\n)","+V\nt+1\n(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)\n]\n>\n(θ−\nˆ\nθ\nt+1\n)≥0,∀θ\nwhich","gives\nθ\n>\nV\nt+1\n(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)≥\nˆ\nθ\n>\nt+1\nV\nt+1\n(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)(θ−\nˆ\nθ\nt+1\n).\n\nThen","we","can","write\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt+1\n−‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n=\nˆ\nθ\n>\nt\nV\nt+1\nˆ\nθ\nt\n−\nˆ\nθ\n>\nt+1\nV\nt+1\nˆ\nθ\nt+1\n+","2θ\n∗\n>\nV\nt+1\n(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)\n≥\nˆ\nθ\n>\nt\nV\nt+1\nˆ\nθ\nt\n−\nˆ\nθ\n>\nt+1\nV\nt+1\nˆ\nθ\nt+1\n+","2\nˆ\nθ\n>\nt+1\nV\nt+1\n(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)−2G\nt\n(\nˆ\nθ\nt\n)(θ\n∗\n−\nˆ\nθ\nt+1\n)\n=\nˆ\nθ\n>\nt\nV\nt+1\nˆ\nθ\nt\n+\nˆ\nθ\n>\nt+1\nV\nt+1\nˆ\nθ\nt+1\n−2\nˆ\nθ\n>\nt+1\nV\nt+1\nˆ\nθ\nt\n−2G\nt\n(\nˆ\nθ\nt\n)(θ\n∗\n−\nˆ\nθ\nt+1\n)\n=‖\nˆ\nθ\nt\n−\nˆ\nθ\nt+1\n‖\n2\nV\nt+1\n+","2G\nt\n(\nˆ\nθ\nt\n)(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)","+","2G\nt\n(\nˆ\nθ\nt\n)(\nˆ\nθ\nt\n−θ\n∗\n)\n≥−‖G\nt\n(θ\nt\n)‖\n2\nV\n−1\nt+1\n+","2G\nt\n(\nˆ\nθ\nt\n)(\nˆ\nθ\nt\n−θ\n∗\n)\nwhere","the","last","inequality","is","from","the","fact","that\n‖\nˆ\nθ\nt\n−\nˆ\nθ\nt+1\n‖\n2\nV\nt+1\n+","2G\nt\n(\nˆ\nθ\nt\n)(\nˆ\nθ\nt+1\n−\nˆ\nθ\nt\n)≥min\nθ\n{\n‖θ‖\n2\nV\nt+1\n+","2G\nt\n(\nˆ\nθ\nt\n)(θ)\n}\n=−‖G\nt\n(θ\nt\n)‖\n2\nV\n−1\nt+1\n.\nLemma","12.For","allθ∈R\nd\n,","we","have\n","̄\nf\nt\n(θ)≥\n","̄\nf\nt\n(θ\n∗\n).\nProof.\n","̄\nf\nt\n(θ)−\n","̄\nf\nt\n(θ\n∗\n)","=−\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,θ\n∗\n)","logp\nt\n(i|S\nt\n,θ)","+\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,θ\n∗\n)","logp\nt\n(i|S\nt\n,θ\n∗\n)\n=\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,θ\n∗\n)","[logp\nt\n(i|S\nt\n,θ\n∗\n)−logp\nt\n(i|S\nt\n,θ)]\n=\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,θ\n∗\n)","log\np\nt\n(i|S\nt\n,θ\n∗\n)\np\nt\n(i|S\nt\n,θ)\n≥0\nwhere\n∑\ni∈S\nt\np\nt\n(i|S\nt\n,θ\n∗\n)","log\np\nt\n(i|S\nt\n,θ\n∗\n)\np\nt\n(i|S\nt\n,θ)\nis","the","Kullback-Leibler","divergence","between","two","distributions","which","is","always","non-\nnegative.\nLemma","13.For","any","positive-semidefinte","matrixV,\n‖G\nt\n(θ)‖\n2\nV\n≤4","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\nProof.For","any","positive-semidefinte","matrixV\n(z\ni\n−z\nj\n)\n>\nV(z\ni\n−z\nj\n)\n>\n=z\n>\ni\nV","z\ni\n+z\n>\nj\nV","z\nj\n−z\n>\ni\nV","z\nj\n−z\n>\nj\nV","z\ni\n≥0\nwhich","impliesz\n>\ni\nV","z\ni\n+z\n>\nj\nV","z\nj\n≥z\n>\ni\nV","z\nj\n+z\n>\nj\nV","z\ni\n.","We","letz\ni\n:=","(p\nt\n(i|S\nt\n,θ)−y\nti\n)x\nti\n\n‖G\nt\n(θ)‖\n2\nV\n=\n∑\ni∈S\nt\n∑\nj∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)","(p\ntj\n(S\nt\n,θ)−y\ntj\n)x\n>\nti\nV","x\ntj\n=\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)\n2\nx\n>\nti\nV","x\nti\n+\n1\n2\n∑\ni∈S\nt\n∑\nj∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)","(p\ntj\n(S\nt\n,θ)−y\ntj\n)","(x\n>\nti\nV","x\ntj\n+x\n>\ntj\nV","x\nti\n)\n≤\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)\n2\nx\n>\nti\nV","x\nti\n+\n1\n2\n∑\ni∈S\nt\n∑\nj∈S\nt\n[\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)\n2\nx\n>\nti\nV","x\ntj\n+","(p\ntj\n(S\nt\n,θ)−y\ntj\n)\n2\nx\n>\ntj\nV","x\nti\n]\n=\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)\n2\nx\n>\nti\nV","x\nti\n+\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)\n2\nx\n>\nti\nV","x\nti\n=","2\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)\n2\nx\n>\nti\nV","x\nti\n≤4","max\ni∈S\nt\nx\n>\nti\nV","x\nti\n=","4","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\nLemma","14.With","a","probability","at","least1−δ,\nt\n∑\nt\n′\n=T\n0\n+1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)≤\nκ\n4\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\n+\n(\n4\nκ\n+\n8\n3\n)\nlog\n(\nd2","log\n2\ntK\n2\net\n2\nδ\n)\n+","2\nProof.First,","notice","that\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)is","a","martingale","difference","sequence.","Also,","we","have\n∣\n∣\n∣\n∣\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n∣\n∣\n∣\n∣\n≤\n∣\n∣\n∣\n∣\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n∣\n∣\n∣\n∣\n+\n∣\n∣\n∣\n∣\n[\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n∣\n∣\n∣\n∣\n≤\n∥\n∥\n∥\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)\n∥\n∥\n∥\n∥\n∥\n∥\nˆ\nθ\nt\n′\n−θ\n∗\n∥\n∥\n∥\n+\n∥\n∥\n∥\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)\n∥\n∥\n∥\n∥\n∥\n∥\nˆ\nθ\nt\n′\n−θ\n∗\n∥\n∥\n∥\n≤2\n√\n2‖\nˆ\nθ\nt\n′\n−θ\n∗\n‖\nwhere","the","last","inequality","is","from","the","fact","that‖G\nt\n(θ)‖=‖\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)x\nti\n‖","≤\n√\n2for","anyθ.","Also,","note","that","for\nlarge","enought\n′\n(i.e.","after","the","random","initialization),","we","have‖\nˆ\nθ\nt\n′\n−θ\n∗\n‖≤1.","Hence,","we","have\n∣\n∣\n∣\n∣\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n∣\n∣\n∣\n∣\n≤2\n√\n2.\nWe","define","the","martingaleM\nt\n:=\n∑\nt\nt\n′\n=1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n).","And,","we","also","defineΣ\nt\nas\nΣ\nt\n:=\nt\n∑\nt\n′\n=1\nE\ny\nt\n′\n[\n(\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n)\n2\n]\n≤\nt\n∑\nt\n′\n=1\nE\ny\nt\n′\n[\n(\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n)\n2\n]\n≤\nt\n∑\nt\n′\n=1\n∑\ni∈S\nt\n′\n(\nx\n>\nt\n′\ni\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n)\n2\n=\nt\n∑\nt\n′\n=1\n‖\nˆ\nθ\nt\n′\n−θ\n∗\n‖\n2\nW\nt\n′\n:=B\nt\n\nNote","thatB\nt\n,","the","upper","bound","forΣ\nt\n,","is","a","random","variable,","so","we","cannot","directly","apply","Bernstein’s","inequality","toM\nt\n.","Instead,\nwe","consider","two","cases","(i)B\nt\n≤\n4\ntK\nand","(ii)B\nt\n>\n4\ntK\n.\nCase","(i)Let’s","assumeB\nt\n=\nt\n∑\nt\n′\n=1\n‖\nˆ\nθ\nt\n′\n−θ\n∗\n‖\n2\nW\nt\n′\n≤\n4\ntK\n.","Then","we","have\nM\nt\n=\nt\n∑\nt\n′\n=1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n=\nt\n∑\nt\n′\n=1\n∑\ni∈S\nt\n′\n(y\nt\n′\ni\n−p(S\nt\n,θ\n∗\n))x\n>\nt\n′\ni\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n≤\nt\n∑\nt\n′\n=1\n∑\ni∈S\nt\n′\n|x\n>\nt\n′\ni\n(\nˆ\nθ\nt\n−θ\n∗\n)|\n≤\n√\n√\n√\n√\ntK\nt\n∑\nt\n′\n=1\n∑\ni∈S\nt\n′\n(\nx\n>\nt\n′\ni\n(\nˆ\nθ\nt\n−θ\n∗\n)\n)\n2\n≤2.\nCase","(ii)Let’s","assumeB\nt\n=\nt\n∑\nt\n′\n=1\n‖\nˆ\nθ\nt\n′\n−θ\n∗\n‖\n2\nW\nt\n′\n>\n4\ntK\n.","Note","that","we","have","both","a","lower","and","upper","bounds","forB\nt\n,","i.e.,\n4\ntK\n<","B\nt\n≤tK.","Then","we","can","use","the","peeling","process","(Bartlett","et","al.","2005).\nP\n(\nM\nt\n≥2\n√\nη\nt\nB\nt\n+\n8η\nt\n3\n)\n=P\n(\nM\nt\n≥2\n√\nη\nt\nB\nt\n+\n8η\nt\n3\n,\n4\ntK\n<","B\nt\n≤tK\n)\n=P\n(\nM\nt\n≥2\n√\nη\nt\nB\nt\n+\n8η\nt\n3\n,\n4\ntK\n<","B\nt\n≤tK,Σ\nt\n≤B\nt\n)\n≤\nm\n∑\nj=1\nP\n(\nM\nt\n≥2\n√\nη\nt\nB\nt\n+\n8η\nt\n3\n,\n4·2\nj−1\ntK\n<","B\nt\n≤\n4·2\nj\ntK\n,Σ\nt\n≤B\nt\n)\n≤\nm\n∑\nj=1\nP\n(\nM\nt\n≥\n√\nη\nt\n8·2\nj\ntK\n+\n8η\nt\n3\n,Σ\nt\n≤\n4·2\nj\ntK\n)\n≤mexp(−η\nt\n)\nwherem=d2","log\n2\ntK\n2\ne,","and","the","last","inequality","is","from","Bernstein’s","inequality","for","martingales.","Combining","with","the","result","in\nCases","(i)","and","(ii),","lettingη\nt\n=","log\nmt\n2\nδ\n=","log\nd2","log\n2\ntK\n2\net\n2\nδ\nand","taking","the","union","bound","overt,","we","have","with","probability","at","least\n1−δ\nM\nt\n=\nt\n∑\nt\n′\n=1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)≤2\n√\n√\n√\n√\nη\nt\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\n+\n8η\nt\n3\n+","2.\nThen","we","applyuv≤cu\n2\n+v\n2\n/(4c)to","the","second","term","on","the","right","hand","side","withc=\n2\nκ\n.\n√\n√\n√\n√\nη\nt\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\n≤\n2η\nt\nκ\n+\nκ\n8\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\nThen","we","have\nt\n∑\nt\n′\n=T\n0\n+1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)≤\nκ\n4\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\n+\n(\n4\nκ\n+\n8\n3\n)\nη\nt\n+","2\n\nProof","of","Lemma","9\nProof.From","Lemma","10,","we","have\nf\nt\n(\nˆ\nθ\nt\n)≤f\nt\n(θ\n∗\n)","+G\nt\n(\nˆ\nθ\nt\n)\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)−\nκ\n2\n(θ\n∗\n−\nˆ\nθ\nt\n)\n>\n(\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n(θ\n∗\n−\nˆ\nθ\nt\n)\nTaking","expectation","overygives\n","̄\nf\nt\n(\nˆ\nθ\nt\n)≤\n","̄\nf\nt\n(θ\n∗\n)","+\n","̄\nG\nt\n(\nˆ\nθ\nt\n)\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)−\nκ\n2\n(θ\n∗\n−\nˆ\nθ\nt\n)\n>\n(\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n(θ\n∗\n−\nˆ\nθ\nt\n)\nNote","that∇\n","̄\nf\nt\n(θ)","=E\ny\n[∇f\nt\n(θ)]","=\n","̄\nG\nt\n(θ)by","the","Leibniz","integral","rule.","LetW\nt\n:=\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n.","Since\n","̄\nf\nt\n(θ)≥\n","̄\nf\nt\n(θ\n∗\n)from\nLemma","12,","we","have\n0≤\n","̄\nf\nt\n(\nˆ\nθ\nt\n)−\n","̄\nf\nt\n(θ\n∗\n)\n≤\n","̄\nG\nt\n(\nˆ\nθ\nt\n)\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)−\nκ\n2\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n=G\nt\n(\nˆ\nθ\nt\n)\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)−\nκ\n2\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n+\n[\n","̄\nG\nt\n(\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)\n]\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)\nFrom","Lemma","11,","we","have2G\nt\n(\nˆ\nθ\nt\n)\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)≤‖G\nt\n(θ\nt\n)‖\n2\nV\n−1\nt+1\n+‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt+1\n−‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n.","So","we","have\n0≤\n1\n2\n‖G\nt\n(θ\nt\n)‖\n2\nV\n−1\nt+1\n+\n1\n2\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt+1\n−\n1\n2\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n−\nκ\n2\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n+\n[\n","̄\nG\nt\n(\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)\n]\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)\n≤2","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt+1\n+\n1\n2\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt+1\n−\n1\n2\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n−\nκ\n2\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n+\n[\n","̄\nG\nt\n(\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)\n]\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)\nwhere","the","last","inequality","is","by","Lemma","13,‖G\nt\n(θ)‖\n2\nV\n−1\nt+1\n≤4","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt+1\n.","Note","that","sinceV\nt+1\n=V\nt\n+\nκ\n2\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n,\nwe","have\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt+1\n=‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt\n+\nκ\n2\n(\nˆ\nθ\nt\n−θ\n∗\n)\n>\n(\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n(\nˆ\nθ\nt\n−θ\n∗\n)\n=‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt\n+\nκ\n2\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nW\nt\n.\nTherefore,","we","can","continue\n0≤2","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt+1\n+\n1\n2\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt\n+\nκ\n4\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nW\nt\n−\n1\n2\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n−\nκ\n2\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n+\n[\n","̄\nG\nt\n(\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)\n]\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)\n=","2","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt+1\n+\n1\n2\n‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt\n−\n1\n2\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n−\nκ\n4\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n+\n[\n","̄\nG\nt\n(\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)\n]\n>\n(\nˆ\nθ\nt\n−θ\n∗\n)\nHence,","we","have\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n≤‖\nˆ\nθ\nt\n−θ\n∗\n‖\n2\nV\nt\n+","4","max\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt+1\n−\nκ\n2\n‖θ\n∗\n−\nˆ\nθ\nt\n‖\n2\nW\nt\n+","2\n[\n","̄\nG\nt\n(\nˆ\nθ\nt\n)−G\nt\n(\nˆ\nθ\nt\n)\n]\n>\n(\nˆ\nθ\nt\n−θ\n∗\n).\nSumming","overtgives\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n≤λ\nmax\n(V\nT\n0\n)","+","4\nt\n∑\nt\n′\n=T\n0\n+1\nmax\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nτ+1\n−\nκ\n2\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\n+","2\nt\n∑\nt\n′\n=T\n0\n+1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n\nNow,","we","can","use","Lemma","14","which","shows","with","a","probability","at","least1−δ,\nt\n∑\nt\n′\n=T\n0\n+1\n[\n","̄\nG\nt\n′\n(\nˆ\nθ\nt\n′\n)−G\nt\n′\n(\nˆ\nθ\nt\n′\n)\n]\n>\n(\nˆ\nθ\nt\n′\n−θ\n∗\n)\n≤\nκ\n4\nt\n∑\nt\n′\n=T\n0\n+1\n‖θ\n∗\n−\nˆ\nθ\nt\n′\n‖\n2\nW\nt\n′\n+\n(\n4\nκ\n+\n8\n3\n)\nlog\n(\nd2","log\n2\ntK\n2\net\n2\nδ\n)\n+","2.\nWe","have","with","a","probability","at","least1−δ\n‖\nˆ\nθ\nt+1\n−θ\n∗\n‖\n2\nV\nt+1\n≤T\n0\n+","4\nt\n∑\nt\n′\n=T\n0\n+1\nmax\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nτ+1\n+\n(\n8\nκ\n+\n16\n3\n)\nlog\n(\nd2","log\n2\ntK\n2\net\n2\nδ\n)\n+","4\n≤T\n0\n+\n8\nκ\ndlog\n(\n1","+\nT\nd\n)\n+\n(\n8\nκ\n+\n16\n3\n)\nlog\n(\nd2","log\n2\ntK\n2\net\n2\nδ\n)\n+","4\nwhere","we","apply","Lemma","6","to","bound\n∑\nt\nt\n′\n=1\nmax\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nτ+1\nin","the","last","inequality.","Note","thatV\nt\nin","Algorithm","1","andV\nt\nin\nAlgorithm","3","are","different","by","the","factor","of\nκ\n2\n,","which","results","in","additional\n2\nκ\nfactor","for","the","bound","of\n∑\nt\nt\n′\n=1\nmax\ni∈S\nt\n′\n‖x\nt\n′\ni\n‖\n2\nV\n−1\nτ+1\n.\nProof","of","Theorem","5\nProof.Similar","to","the","proof","of","Theorem","1,","we","first","define","the","high","probability","event\nDefinition","4.Define","the","following","event:\n","̃\nE=\n{\nλ\nmin\n(V\nT\n0\n)≥K,‖\nˆ\nθ\nt\n−θ\n∗\n‖\nV\nt\n≤","̃α\nt\n,∀t≤T\n}\nwhere","̃α\nt\nis","defined","as","Theorem","5.\nThen","following","steps","equivalent","the","first","few","steps","in","the","proof","of","Theorem","1,","we","have\nR\nT\n≤T\n0\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n1(\n","̃\nE)\n]\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n1(\n","̃\nE\nc\n)\n]\n≤T\n0\n+E\n[\nT\n∑\nt=T\n0\n+1\n(\n","̃\nR\nt\n(S\nt\n)−R\nt\n(S\nt\n,θ\n∗\n)\n)\n1(\n","̃\nE)\n]\n+\nT\n∑\nt=1\nO(t\n−2\n)\n≤T\n0\n+\nT\n∑\nt=1\n2","̃α\nT\nmax\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt\n+O(1)\nApplying","Cauchy-Schwarz","inequality","and","Lemma","6","for\n∑\nT\nt=1\nmax\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt\n,","we","have\nR\nT\n≤T\n0\n+","2","̃α\nT\n√\n2dTlog","(T/d)","+O(1)\nwhere","̃α\nT\n=\n√\nT\n0\n+\n8\nκ\ndlog\n(\n1","+\nT\nd\n)\n+\n(\n8\nκ\n+\n16\n3\n)\nlog","(d2","log\n2\n(TK/2)et\n4\n)","+","4.\nProof","of","Theorem","2\nIn","this","section,","we","present","a","finite-sample","version","of","the","asymptotic","normality","of","the","MLE","for","the","MNL","model.","It","is","a","general-\nization","of","Theorem","1","in","(Li,","Lu,","and","Zhou","2017)","to","a","multinomial","setting.\nProof.Recall","that","the","gradient","of","the","negative","log-likelihood","of","the","MNL","model","is","given","by\n∇\nθ\n`\nn\n(θ)","=\nn\n∑\nt=1\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−y\nti\n)x\nti\nWe","define","its","conditional","expectationJ\nn\n(θ)and","will","use","this","term","throughout","this","section\n\nDefinition","5.Define","the","conditional","expectation∇\nθ\n`(θ)as\nJ\nn\n(θ)",":=E\ny\n[∇\nθ\n`\nn\n(θ)|F\nt\n]","=\nn\n∑\nt=1\n∑\ni∈S\nt\n(p\nt\n(i|S\nt\n,θ)−p\nt\n(i|S\nt\n,θ\n∗\n))x\nti\n.\nNotice","thatJ\nn\n(\nˆ\nθ)","=\n∑\nn\nt=1\n∑\ni∈S\nt\n\u000f\nti\nx\nti\nsince","the","choice","of\nˆ\nθis","given","by","the","MLE.","In","other","words,\nˆ\nθis","given","by","the","solution\nto","the","following:\nn\n∑\nt=1\n∑\ni∈S\nt\n(\np\nt\n(i|S\nt\n,\nˆ\nθ)−y\nti\n)\nx\nti\n=","0\nHence","it","follows","that\nJ\nn\n(\nˆ\nθ)","=\nn\n∑\nt=1\n∑\ni∈S\nt\n(\np\nt\n(i|S\nt\n,\nˆ\nθ)−p\nt\n(i|S\nt\n,θ\n∗\n)\n)\nx\nti\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n(\np\nt\n(i|S\nt\n,\nˆ\nθ)−y\nti\n)\nx\nti\n+\nn\n∑\nt=1\n∑\ni∈S\nt\n(y\nti\n−p\nt\n(i|S\nt\n,θ\n∗\n))x\nti\n=","0","+\nn\n∑\nt=1\n∑\ni∈S\nt\n\u000f\nti\nx\nti\nFor","convenience,","defineZ\nn\n:=J\nn\n(\nˆ\nθ).","For","brevity,","we","will","denotep\nti\n(θ)",":=p\nt\n(i|S\nt\n,θ)when","it","is","clear","thatS\nt\nis","the","assortment\nchosen","at","roundt.\nConsistency","of","MLE\nIn","this","section,","we","show","the","consistency","of","MLE\nˆ\nθ.","For","anyθ\n1\n,θ\n2\n∈R\nd\n,","the","mean","value","theorem","implies","that","there","exists\n","̄\nθ=cθ\n1\n+","(1−c)θ\n2\nwithc∈(0,1).\nJ\nn\n(θ\n1\n)−J\nn\n(θ\n2\n)","=\n\n\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n∇\nj\np\nti\n(\n","̄\nθ)x\nti\nx\n>\ntj\n\n\n(θ\n1\n−θ\n2\n)\n=\nn\n∑\nt=1\n\n\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)x\nti\nx\n>\nti\n−\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(\n","̄\nθ)p\ntj\n(\n","̄\nθ)x\nti\nx\n>\ntj\n\n\n(θ\n1\n−θ\n2\n)\nLetH\nt\n:=\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)x\nti\nx\n>\nti\n−\n∑\ni,j∈S\nt\np\nti\n(\n","̄\nθ)p\ntj\n(\n","̄\nθ)x\nti\nx\n>\ntj\n.","NoticeH\nt\nis","a","Hessian","of","a","negative","log-likelihood","which","is\nconvex.","Hence,H\nt\nis","positive","semidefinite.","Also","note","that\n(x\ni\n−x\nj\n)(x\ni\n−x\nj\n)\n>\n=x\ni\nx\n>\ni\n+x\nj\nx\n>\nj\n−x\ni\nx\n>\nj\n−x\nj\nx\n>\ni\n\u00170\nwhich","impliesx\ni\nx\n>\ni\n+x\nj\nx\n>\nj\n\u0017x\ni\nx\n>\nj\n+x\nj\nx\n>\ni\n.","Therefore,","it","follows","that\nH\nt\n=\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)x\nti\nx\n>\nti\n−\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(\n","̄\nθ)p\ntj\n(\n","̄\nθ)x\nti\nx\n>\ntj\n=\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)x\nti\nx\n>\nti\n−\n1\n2\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(\n","̄\nθ)p\ntj\n(\n","̄\nθ)\n(\nx\nti\nx\n>\ntj\n+x\ntj\nx\n>\nti\n)\n\u0017\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)x\nti\nx\n>\nti\n−\n1\n2\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(\n","̄\nθ)p\ntj\n(\n","̄\nθ)\n(\nx\nti\nx\n>\nti\n+x\ntj\nx\n>\ntj\n)\n=\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)x\nti\nx\n>\nti\n−\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(\n","̄\nθ)p\ntj\n(\n","̄\nθ)x\nti\nx\n>\nti\n=\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)\n\n\n1−\n∑\nj∈S\nt\np\ntj\n(\n","̄\nθ)\n\n\nx\nti\nx\n>\nti\n=\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)p\nt0\n(\n","̄\nθ)x\nti\nx\n>\nti\n\nwherep\nt0\n(\n","̄\nθ)is","","","the","","","probability","","","of","","","choosing","","","the","","","no","","","purchase","","","option","","","under","","","parameter\n","̄\nθ.","","","DefineH\nn\n(θ):=\n∑\nn\nt=1\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)p\nt0\n(\n","̄\nθ)x\nti\nx\n>\nti\n.","Then,","we","can","write\nJ\nn\n(θ\n1\n)−J\nn\n(θ\n2\n)","=\n[\nn\n∑\nt=1\nH\nt\n]\n(θ\n1\n−θ\n2\n)\n≥\n[\nn\n∑\nt=1\n∑\ni∈S\nt\np\nti\n(\n","̄\nθ)p\nt0\n(\n","̄\nθ)x\nti\nx\n>\nti\n]\n(θ\n1\n−θ\n2\n)\n=H\nn\n(\n","̄\nθ)(θ\n1\n−θ\n2\n)(11)\nIf\n","̄\nθ∈","B\nη\n:={θ:‖θ−θ\n∗\n‖","≤η}with","","someη",">0,","","thenp\nti\n(\n","̄\nθ)p\nt0\n(\n","̄\nθ)≥κ\nη\n,","","whereκ\nη\nis","","defined","","asκ\nη\n:=\ninf\nθ∈B\nη\n,i∈S,S∈S\np\nti\n(θ)p\nt0\n(θ)>0.","Then","sinceH\nn\n(\n","̄\nθ)\u0017κ\nη\nV\nn\n,","we","have\n(θ\n1\n−θ\n2\n)\n>\n(J\nn\n(θ\n1\n)−J\nn\n(θ\n2\n))≥(θ\n1\n−θ\n2\n)\n>\n(κ\nη\nV\nn\n)(θ\n1\n−θ\n2\n)>0\nfor","anyθ\n1\n6=θ\n2\n.","Therefore,J\nn\n(θ)is","an","injection","fromR\nd\ntoR\nd\n.","Note","thatB\nη\nis","a","convex","set.","Hence,","ifθ\n1\n,θ\n2\n∈","B\nη\n,","then","also\n","̄\nθ∈B\nη\n.","Also,","by","the","definition","ofJ\nn\n(θ),","we","haveJ\nn\n(θ\n∗\n)","=","0.","Then,","for","anyθ∈B\nη\n,","it","follows","that\n‖J\nn\n(θ)‖\n2\nV\n−1\nn\n=‖J\nn\n(θ)−J\nn\n(θ\n∗\n)‖\n2\nV\n−1\nn\n≥(θ−θ\n∗\n)\n>\nH\nn\n(\n","̄\nθ)V\n−1\nn\nH\nn\n(\n","̄\nθ)(θ−θ\n∗\n)\n≥κ\n2\nη\nλ\nmin\n(V\nn\n)‖θ−θ\n∗\n‖\n2\n(12)\nwhere","the","first","inequality","is","due","to","(11)","and","the","second","inequality","is","again","from","the","fact","thatH\nn\n(\n","̄\nθ)\u0017κ\nη\nV\nn\n.","Now,","we","need","an\nupper-bound","for‖J\nn\n(θ)‖\nV\n−1\nn\n.","From","Lemma","15,","we","have\n‖J\nn\n(\nˆ\nθ)‖\nV\n−1\nn\n≤2\n√\n2d+","log\n1\nδ\n(13)\nwith","probability","at","least1−δ.","Then,","we","combine","with","(12)","and","have\n‖\nˆ\nθ−θ\n∗\n‖≤\n2\nκ\nη\n√\n2d+","log(1/δ)\nλ\nmin\n(V\nn\n)\nThen","sinceκ=κ\n1\nwhereκ≤min\n‖θ−θ\n∗\n‖≤1\np\nti\n(S,θ)p\nt0\n(S,θ)defined","in","Assumption","2,","we","have\n‖\nˆ\nθ−θ\n∗\n‖≤\n2\nκ\n√\n2d+","log(1/δ)\nλ\nmin\n(V\nn\n)\n≤1(14)\nas","long","asλ\nmin\n(V\nn\n)≥\n4\nκ\n2\n(2d+","log\n1\nδ\n).\nNormality","of","MLE\nIn","this","section,","we","show","the","normality","result","of","MLE\nˆ\nθ.","For","the","rest","of","the","section,","we","assume","(13)","holds.","First,","we","defineF,L\nandEwhich","are","defined","as:\nF(θ)",":=\nn\n∑\nt=1\n∑\ni∈S\nt\np\nti\n(θ)x\nti\nx\n>\nti\n−\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(θ)p\ntj\n(θ)x\nti\nx\n>\ntj\nL:=F(θ\n∗\n)","=\nn\n∑\nt=1\n∑\ni∈S\nt\np\nti\n(θ\n∗\n)x\nti\nx\n>\nti\n−\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(θ\n∗\n)p\ntj\n(θ\n∗\n)x\nti\nx\n>\ntj\nE:=F(\n","̃\nθ)−F(θ\n∗\n)\nwhere\n","̃\nθ:=cθ\n∗\n+","(1−c)\nˆ\nθfor","some","constantc∈(0,1).","Then,","it","follows","that\nZ\nn\n=J\nn\n(\nˆ\nθ)","=J\nn\n(\nˆ\nθ)−J\nn\n(θ\n∗\n)\n=","(L+E)(\nˆ\nθ−θ\n∗\n).\nHence,","for","anyx∈R\n2\n,","we","can","write\nx\n>\n(\nˆ\nθ−θ\n∗\n)","=x\n>\n(L+E)\n−1\nZ\nn\n=x\n>\nL\n−1\nZ\nn\n−x\n>\nL\n−1\nE(L+E)\n−1\nZ\nn\n.(15)\nNote","that(L+E)is","a","non-singular","matrix,","hence(L+E)is","invertible.","Here,","the","key","element","is","controlling","the","matrixE.","Note\nthat","if\nˆ\nθandθ\n∗\nare","close","(so\n","̃\nθandθ\n∗\nare","also","close),","elements","inEare","small.\n\nBounding","MatrixE\nFirst,","we","further","decomposeEinto","two","summations,E\n1\nandE\n2\nE=\nn\n∑\nt=1\n∑\ni∈S\nt\n(\np\nti\n(\n","̃\nθ)−p\nti\n(θ\n∗\n)\n)\nx\nti\nx\n>\nti\n︸︷︷︸\nE\n1\n−\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n(\np\nti\n(\n","̃\nθ)p\ntj\n(\n","̃\nθ)−p\nti\n(θ\n∗\n)p\ntj\n(θ\n∗\n)\n)\nx\nti\nx\n>\ntj\n︸︷︷︸\nE\n2\n(16)\nWe","first","bound","the","first","summationE\n1\n.","Note","that\nE\n1\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n(\np\nti\n(\n","̃\nθ)−p\nti\n(θ\n∗\n)\n)\nx\nti\nx\n>\nti\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n∇\nj\np\nti\n(θ\n1\n)x\n>\ntj\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\nti\n=\nn\n∑\nt=1\n∑\ni∈S\nt\np\nti\n(θ\n1\n)x\n>\nti\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\nti\n−\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\n(θ\n1\n)p\ntj\n(θ\n1\n)x\n>\ntj\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\nti\nwhere","the","second","equality","is","by","the","mean","value","theorem","for","someθ\n1\n:=c\n1\nθ\n∗\n+","(1−c\n1\n)\nˆ\nθwithc\n1\n∈(0,1).","Note","that","the","mean\nvalue","theorem","is","applied","to\n","̃\nθandθ\n∗\n,","and","since\n","̃\nθis","a","convex","combination","of\nˆ\nθandθ\n∗\n,","we","can","find","suchc\n1\n.","Then","it","follows","that\nE\n1\n=\nn\n∑\nt=1\n∑\ni∈S\nt\np\nti\n(θ\n1\n)\n\n\nx\n>\nti\n(\nˆ\nθ−θ\n∗\n)−\n∑\nj∈S\nt\np\ntj\n(θ\n1\n)x\n>\ntj\n(\nˆ\nθ−θ\n∗\n)\n\n\nx\nti\nx\n>\nti\n≤\nn\n∑\nt=1\n∑\ni∈S\nt\np\nti\n(θ\n1\n)\n∥\n∥\n∥\n∥\n∥\n∥\nx\nti\n−\n∑\nj∈S\nt\np\ntj\n(θ\n1\n)x\ntj\n∥\n∥\n∥\n∥\n∥\n∥\n‖\nˆ\nθ−θ\n∗\n‖x\nti\nx\n>\nti\n≤\nn\n∑\nt=1\n∑\ni∈S\nt\n2p\nti\n(θ\n1\n)‖\nˆ\nθ−θ\n∗\n‖x\nti\nx\n>\nti\nwhere","we","have","used","the","assumption","that‖x\nti\n‖<1for","alliandtfor","the","last","inequality.","Then,","for","anyx∈R\nd\n\\{0},","we","have\nx\n>\nL\n−1/2\nE\n1\nL\n−1/2\nx≤\nn\n∑\nt=1\n∑\ni∈S\nt\n2p\nti\n(θ\n1\n)‖\nˆ\nθ−θ\n∗\n‖‖x\n>\nL\n−1/2\nx\nti\n‖\n2\n≤\nn\n∑\nt=1\n∑\ni∈S\nt\n2‖\nˆ\nθ−θ\n∗\n‖‖x\n>\nL\n−1/2\nx\nti\n‖\n2\n≤2‖\nˆ\nθ−θ\n∗\n‖\n(\nx\n>\nL\n−1/2\n(\nn\n∑\nt=1\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\nL\n−1/2\nx\n)\n≤\n2\nκ\n‖\nˆ\nθ−θ\n∗\n‖‖x‖\n2\nwhere","the","third","inequality","follows","from","the","fact","thatp\nti\n(θ\n1\n)≤1.","Therefore,","combining","with","(14)","it","follows","that\n‖L\n−1/2\nE\n1\nL\n−1/2\n‖≤\n2\nκ\n‖\nˆ\nθ−θ\n∗\n‖≤\n4\nκ\n2\n√\n2d+","log(1/δ)\nλ\nmin\n(V\nn\n)\n.(17)\nSimilarly,","we","can","bound","the","second","summationE\n2\nin","(16).","Again","by","the","mean","value","theorem,","for","someθ\n2\n:=c\n2\nθ\n∗\n+(1−c\n2\n)\nˆ\nθ\nwithc\n2\n∈(0,1)we","have\nE\n2\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n(\np\nti\n(\n","̃\nθ)p\ntj\n(\n","̃\nθ)−p\nti\n(θ\n∗\n)p\ntj\n(θ\n∗\n)\n)\nx\nti\nx\n>\ntj\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n∑\nk∈S\nt\n∇\nk\n[p\nti\n(θ\n2\n)p\ntj\n(θ\n2\n)]x\n>\nt,k\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\nti\n.\n\nLetp\nti\n=p\nti\n(θ\n2\n)for","brevity.","Then,","it","follows","that\nE\n2\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n∑\nk∈S\nt\n∇\nk\n[p\nti\np\ntj\n]x\n>\nt,k\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\ntj\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n[\np\ntj\n(\np\nti\nx\nti\n−\n∑\nk∈S\nt\np\nti\np\nt,k\nx\nt,k\n)\n+p\nti\n(\np\ntj\nx\ntj\n−\n∑\nk∈S\nt\np\ntj\np\nt,k\nx\nt,k\n)]\n>\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\ntj\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\np\ntj\n[\n(x\nti\n+x\ntj\n)−2\n∑\nk∈S\nt\np\nt,k\nx\nt,k\n]\n>\n(\nˆ\nθ−θ\n∗\n)x\nti\nx\n>\ntj\n≤\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\np\nti\np\ntj\n∥\n∥\n∥\n∥\n∥\n(x\nti\n+x\ntj\n)−2\n∑\nk∈S\nt\np\nt,k\nx\nt,k\n∥\n∥\n∥\n∥\n∥\n‖\nˆ\nθ−θ\n∗\n‖x\nti\nx\n>\ntj\n≤\nn\n∑\nt=1\n∑\ni∈S\nt\n∑\nj∈S\nt\n4p\nti\np\ntj\n‖\nˆ\nθ−θ\n∗\n‖x\nti\nx\n>\ntj\n=\nn\n∑\nt=1\n∑\ni∈S\nt\n4p\nti\n(1−p\nt0\n)‖\nˆ\nθ−θ\n∗\n‖x\nti\nx\n>\nti\nwherep\nt0\n=p\nt0\n(θ\n2\n)is","a","probability","of","choosing","an","outside","option.","Then,","for","anyx∈R\nd\n\\{0},","we","have\nx\n>\nL\n−1/2\nE\n2\nL\n−1/2\nx≤\nn\n∑\nt=1\n∑\ni∈S\nt\n4p\nti\n(θ\n2\n)","(1−p\nt0\n(θ\n2\n))‖\nˆ\nθ−θ\n∗\n‖‖x\n>\nL\n−1/2\nx\nti\n‖\n2\n≤\nn\n∑\nt=1\n∑\ni∈S\nt\n4‖\nˆ\nθ−θ\n∗\n‖‖x\n>\nL\n−1/2\nx\nti\n‖\n2\n≤4‖\nˆ\nθ−θ\n∗\n‖\n(\nx\n>\nL\n−1/2\n(\nn\n∑\nt=1\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\nL\n−1/2\nx\n)\n≤\n4\nκ\n‖\nˆ\nθ−θ\n∗\n‖‖x‖\n2\nSimilarly,","combining","with","(14)","it","follows","that\n‖L\n−1/2\nE\n2\nL\n−1/2\n‖≤\n4\nκ\n‖\nˆ\nθ−θ\n∗\n‖≤\n8\nκ\n2\n√\n2d+","log(1/δ)\nλ\nmin\n(V\nn\n)\n.(18)\nHence,","combining","(17)","and","(18),","we","have","withλ\nmin\n(V\nn\n)≥\n24\n2\nκ\n4\n(d+","log\n1\nδ\n)\n‖L\n−1/2\nEL\n−1/2\n‖=‖L\n−1/2\n(E\n1\n−E\n2\n)L\n−1/2\n‖\n≤‖L\n−1/2\nE\n1\nL\n−1/2\n‖+‖L\n−1/2\nE\n2\nL\n−1/2\n‖\n≤\n12\nκ\n2\n√\n2d+","log(1/δ)\nλ\nmin\n(V\nn\n)\n≤\n1\n2\n.(19)\nBounding","the","Prediction","Errorx\n>\n(\nˆ\nθ−θ\n∗\n)\nRecall","from","(15)","that","the","prediction","error","for","anyx∈R\n2\ncan","be","written","as\nx\n>\n(\nˆ\nθ−θ\n∗\n)","=x\n>\nL\n−1\nZ\nn\n−x\n>\nL\n−1\nE(L+E)\n−1\nZ\nn\n.\nFirst,","we","bound","the","first","termx\n>\nL\n−1\nZ\nn\nin","(15).","We","start","with","providing","the","following","definitions","for","the","ease","of","our","presenta-\ntion:\nX\nt\n:=","[x\nt1\n;x\nt2\n;...;x\nt|S\nt\n|\n]\n>\n∈R\n|S\nt\n|×d\nD:=","[X\n1\n;X\n2\n;...;X\nn\n]\n>\n∈R\n(\n∑\nt\n|S\nt\n|)×d\nE\nt\n:=","[\u000f\nt1\n,\u000f\nt2\n,...,\u000f\nt|S\nt\n|\n]\n>\n∈R\n|S\nt\n|\n\nThen","we","use","the","notations","above","to","see|x\n>\nL\n−1\nZ\nn\n|=\n∣\n∣\n∑\nt\nx\n>\nL\n−1\nX\n>\nt\nE\nt\n∣\n∣\n.","For","independent","samples,X\nt\nandE\nt\nare","indepen-\ndent.","Therefore,","for","eacht\nE\n[\nx\n>\nL\n−1\nX\n>\nt\nE\nt\n]\n=E\n[\n∑\ni∈S\nt\nx\n>\nL\n−1\nx\nti\n\u000f\nti\n]\n=\n∑\ni∈S\nt\nE\n[\nx\n>\nL\n−1\nx\nti\n]\nE[\u000f\nti\n]","=","0\nsinceE[\u000f\nti\n]","=","0for","allt,i.","Also,","we","have\n∣\n∣\nx\n>\nL\n−1\nX\n>\nt\nE\nt\n∣\n∣\n≤‖x\n>\nL\n−1\nX\n>\nt\n‖‖E\nt\n‖≤\n√\n2‖x\n>\nL\n−1\nX\n>\nt\n‖\nwhere","we","use‖E\nt\n‖≤\n√\n2.","We","also","know‖x\n>\nL\n−1\nX\n>\nt\n‖is","bounded","since","bothX\nt\nandxare","bounded.","Hence,","eachx\n>\nL\n−1\nX\n>\nt\nE\nt\nis","","therefore","","a","","bounded","","random","","variable.","","This","","allows","","us","","to","","apply","","Hoeffding","","inequality","","for","","bounded","","random","","variables","","in\nLemma","22.\nP\n(\n|x\n>\nL\n−1\nZ\nn\n|≥ν\n)\n=P\n(\n∣\n∣\n∣\n∣\n∣\nn\n∑\nt=1\nx\n>\nL\n−1\nX\n>\nt\nE\nt\n∣\n∣\n∣\n∣\n∣\n≥ν\n)\n≤2","exp\n{\n−\n2ν\n2\n∑\nn\nt=1\n(\n2\n√\n2‖x\n>\nL\n−1\nX\n>\nt\n‖\n)\n2\n}\n=","2","exp\n{\n−\nν\n2\n4‖x\n>\nL\n−1\nD\n>\n‖\n2\n}\n≤2","exp\n{\n−\nκ\n2\nν\n2\n4‖x‖\n2\nV\n−1\nn\n}\n(20)\nwhere","the","second","equality","follows","from","the","definition","ofD\nt\n,","i.e.,\nn\n∑\nt=1\n‖x\n>\nL\n−1\nX\n>\nt\n‖\n2\n=\nn\n∑\nt=1\nx\n>\nL\n−1\nX\n>\nt\nX\nt\nL\n−1\nx=x\n>\nL\n−1\nD\n>\nDL\n−1\nx=‖x\n>\nL\n−1\nD\n>\n‖\n2\n.\nAnd,","the","last","inequality","follows","from","the","fact","thatL\u0017κV=κD\n>\nDand","combining","it","with","the","following:\n‖x\n>\nL\n−1\nD\n>\n‖\n2\n=x\n>\nL\n−1\nD\n>\nDL\n−1\nx≤\n1\nκ\n2\n‖x‖\n2\nV\n−1\nn\n.\nThen,","letting","the","right-hand","side","of","(20)","be2δand","solving","forν,","we","obtain","that","with","probability","at","least1−2δ,\n|x\n>\nL\n−1\nZ|≤\n2\n√\nlog(1/δ)\nκ\n‖x‖\nV\n−1\nn\n.(21)\nThen,","","the","","rest","","of","","the","","proof","","for","","the","","theorem","","follows","","the","","proof","","of","","Theorem","","1","","in","","(Li,","","Lu,","","and","","Zhou","","2017).","","For","","the","","sake","","of\ncompleteness,","we","present","the","full","proof.\n|x\n>\nL\n−1\nE(L+E)\n−1\nZ\nn\n|≤‖x‖\nL\n−1\n‖L\n−1/2\nE(L+E)\n−1\nZ\nn\n‖\n≤‖x‖\nL\n−1\n‖L\n−1/2\nE(L+E)\n−1\nL\n1/2\n‖‖Z\nn\n‖\nL\n−1\n≤\n1\nκ\n‖x‖\nV\n−1\nn\n‖L\n−1/2\nE(L+E)\n−1\nL\n1/2\n‖‖Z\nn\n‖\nV\n−1\nn\n(22)\nwhere","the","last","inequality","is","fromL\u0017κV\nn\n.","Then","it","follows","that\n‖L\n−1/2\nE(L+E)\n−1\nL\n1/2\n‖=‖L\n−1/2\nE(L\n−1\n−L\n−1\nE(L+E)\n−1\n)L\n1/2\n‖\n=‖L\n−1/2\nEL\n−1/2\n−L\n−1/2\nEL\n−1\nE(L+E)\n−1\nL\n1/2\n‖\n≤‖L\n−1/2\nEL\n−1/2\n‖+‖L\n−1/2\nEL\n−1/2\n‖‖L\n−1/2\nE(L+E)\n−1\nL\n1/2\n‖\nBy","solving","this","inequality,","we","get\n‖L\n−1/2\nE(L+E)\n−1\nL\n1/2\n‖≤\n‖L\n−1/2\nEL\n−1/2\n‖\n1−‖L\n−1/2\nEL\n−1/2\n‖\n≤2‖L\n−1/2\nEL\n−1/2\n‖\n≤\n24\nκ\n2\n√\nd+","log(1/δ)\nλ\nmin\n(V\nn\n)\n\nwhere","","the","","second","","inequality","","is","","from","","(19)","","and","","the","","third","","inequality","","is","","from","","combining","","with","","(19).","","Combining","","with","","(22)","","and\n‖Z\nn\n‖\nV\n−1\nn\n≤2\n√\n2d+","log\n1\nδ\nfrom","Lemma","15","(which","we","assume","to","hold","in","this","section),","we","have\n|x\n>\nL\n−1\nE(L+E)\n−1\nZ\nn\n|≤\n1\nκ\n‖x‖\nV\n−1\nn\n‖L\n−1/2\nE(L+E)\n−1\nL\n1/2\n‖‖Z\nn\n‖\nV\n−1\nn\n≤\n48\n(\n2d+","log\n1\nδ\n)\nκ\n3\n√\nλ\nmin\n(V\nn\n)\n‖x‖\nV\n−1\nn\n(23)\nThen","combining","the","results","from","(21)","and","(23),","we","have\n|x\n>\n(\nˆ\nθ\nn\n−θ\n∗\n)|≤|x\n>\nL\n−1\nZ|+|x\n>\nL\n−1\nE(L+E)\n−1\nZ\nn\n|\n≤\n√\nlog\n1\nδ\nκ\n‖x‖\nV\n−1\nn\n+\n48\n(\n2d+","log\n1\nδ\n)\nκ\n3\n√\nλ\nmin\n(V\nn\n)\n‖x‖\nV\n−1\nn\n.\nThen","it","follows","that|x\n>\n(\nˆ\nθ\nn\n−θ\n∗\n)|≤\n5\nκ\n√\nlog\n1\nδ\n‖x‖\nV\n−1\nn\nholds","as","long","asλ\nmin\n(V\nn\n)≥\n144\nκ\n4\n(\n4d\n2\n+","log\n1\nδ\n)\nholds.\nLemma","15.For","anyδ",">0,","with","probability","at","least1−δ,","we","have\n‖J\nn\n(\nˆ\nθ)‖\nV\n−1\nn\n≤4\n√\n2d+","log\n1\nδ\n.(24)\nProof.This","lemma","is","an","extension","of","Lemma","7","in","(Li,","Lu,","and","Zhou","2017).","For","convenience,","letZ=J\nn\n(\nˆ\nθ)andV=V\nn\n.","Let\nˆ\nBbe","a","1/2-net","of","the","unit","ballB\nd\n.","Then|\nˆ\nB|","≤6\nd\n(Pollard","1990,","Lemma","4.1),","and","for","anyx∈B\nd\n,","there","is","aˆx∈\nˆ\nBsuch","that\n‖x−ˆx‖≤\n1\n2\n.","Therefore,","we","have\nx\n>\nV\n−1/2\nZ=","ˆx\n>\nV\n−1/2\nZ+","(x−ˆx)\n>\nV\n−1/2\nZ\n=","ˆx\n>\nV\n−1/2\nZ+‖x−ˆx‖·\n1\n‖x−ˆx‖\n(x−ˆx)\n>\nV\n−1/2\nZ\n≤ˆx\n>\nV\n−1/2\nZ+\n1\n2\nsup\nz∈B\nd\nz\n>\nV\n−1/2\nZ",".\nTaking","supremum","on","both","sides,","we","get\nsup\nx∈B\nd\nx\n>\nV\n−1/2\nZ≤2","max\nˆx∈\nˆ\nB\nˆx\n>\nV\n−1/2\nZ",".\nAlso,","note","that‖Z‖\nV\n−1\n=‖V\n−1/2\nZ‖\n2\n=","sup\n‖x‖\n2\n≤1\nx\n>\nV\n−1/2\nZ.","Recall","thatZ=\n∑\nn\nt=1\nX\n>\nt\nE\nt\n.","Then,","it","follows","that\nP(‖Z‖\nV\n−1\n≥ν)≤P\n(\nmax\nˆx∈\nˆ\nB\nˆx\n>\nV\n−1/2\nZ",">\nν\n2\n)\n≤\n∑\nˆx∈\nˆ\nB\nP\n(\nˆx\n>\nV\n−1/2\nZ",">\nν\n2\n)\n=\n∑\nˆx∈\nˆ\nB\nP\n(\nn\n∑\nt=1\nˆx\n>\nV\n−1/2\nX\n>\nt\nE\nt\n≥\nν\n2\n)\n.\nNoting","that|ˆx\n>\nV\n−1/2\nX\n>\nt\nE\nt\n|","≤\n√\n2‖ˆx\n>\nV\n−1/2\nX\n>\nt\n‖,","we","again","apply","Hoeffding","inequality","(Lemma","22)","to","a","sum","of","bounded\nrandom","variablesˆx\n>\nV\n−1/2\nX\n>\nt\nE\nt\nas","done","in","(20).","Then,","it","follows","that\nP(‖Z‖\nV\n−1\n≥ν)≤\n∑\nˆx∈\nˆ\nB\nexp\n{\n−\n2ν\n2\n32\n∑\nn\nt=1\n‖ˆx\n>\nV\n−1/2\nX\n>\nt\n‖\n2\n}\n=\n∑\nˆx∈\nˆ\nB\nexp\n{\n−\nν\n2\n16‖ˆx\n>\nV\n−1/2\nD\n>\n‖\n2\n}\n≤exp\n{\n−\nν\n2\n16\n+dlog","6\n}\n\nwhere","the","second","inequality","is","by","a","union","bound","and","the","forth","inequality","is","from","Hoeffding","inequality.","The","last","inequality\ncomes","from","the","fact","thatV=D\n>\nDand","also","from|\nˆ\nB|≤6\nd\n.","If","we","letν=","4\n√\n2d+","log(1/δ),","then","we","have\nP\n(\n‖Z‖\nV\n−1\n≥4\n√\n2d+","log(1/δ)\n)\n≤exp\n{\n−\n32d+","16","log(1/δ)\n16\n+dlog","6\n}\n≤δ.\nGenerating","Independent","Samples","usingSUPCB-MNL\nAlgorithm","4BASECB-MNL\n1:Input:","confidence","radiusα,","index","setΨ,","setA,","features{x\nti\n}\n2:Compute","MLE\nˆ\nθ\nt\nby","solving","the","equation\n∑\nt\n′\n∈Ψ\n∑\ni∈S\nt\n′\n(p\nt\n′\n(i|S\nt\n′\n,θ)−y\nt\n′\ni\n)x\nt\n′\ni\n=","0\n3:UpdateV\nΨ\n=\n∑\nt\n′\n∈Ψ\n∑\ni∈S\nt\n′\nx\nt\n′\ni\nx\n>\nt\n′\ni\n4:Compute","the","following:\nw\nti\n=α‖x\nti\n‖\nV\n−1\nΨ\nfor","alli∈I\nW\nt\n=","2","max\ni∈I\nw\nti\nwhereI={i∈S:S∈A}\nTo","overcome","the","issue","of","dependent","samples,","we","design","a","method","which","consists","of","two","parts:","(i)","a","subroutine","algorithm\nBASECB-MNL","(Algorithm","4)","to","compute","MLE","and","maximum","standard","deviation","of","utility","among","the","items","in","the","candidate\nset","(assuming","statistical","independence","among","the","samples),","and","(ii)","a","master","algorithmSUPCB-MNL","(Algorithm","5)","to","ensure\nthe","independence","assumption","holds.","As","mentioned","in","Section",",","this","technique","is","inspired","by","the","decomposition","of","the","algorithm\nintroduced","in","Auer","(2002)","and","also","adopted","in","many","followup","works,","e.g.,","(Chu","et","al.","2011;","Li,","Lu,","and","Zhou","2017;","Zhou,\nXu,","and","Blanchet","2019).","supCB-MNL","operates","on","the","radius","of","the","confidence","bound,","independent","of","expected","mean","utility,\nto","perform","exploration.","supCB-MNL","maintains{Ψ\n`\n}\nL\n`=0\n,","the","sets","of","time","indices","which","are","the","partitions","of","the","entire","plan-\nning","horizon{1,2,...,T}.","The","purpose","of","this","partitioning","is","to","ensure","that","the","choice","responsesy\nt\nin","each","index","setΨ\n`\nare\nindependent,","so","that","we","can","apply","the","normality","result","of","Theorem","2","to","samples","in","eachΨ\n`\nseperately.\nIn","each","round","of","Algorithm","5,","the","learning","agent","screens","the","candidate","assortments","based","on","the","value","ofw\nti\n=α‖x\nti\n‖\nV\n−1\nt\nfor","items","in","assortments","inA\n`\nthrough","epochs`=","1,...,Luntil","an","assortmentS\nt\nis","chosen.\n•Sub-routine:in","step","(a),","we","runBASECB-MNL","(Algorithm","4)","which","uses","the","normality","result","to","computew\n(`)\nti\nfor","alli,\nW\n(`)\nt\n,","and\nˆ\nθ\n(`)\nt\n.","We","can","utilize","the","normality","result","here","since{y\nt\n,t∈Ψ\n`\n}’s","are","independent","given","the","feature","vectors","in","each\nΨ\n`\n(see","Lemma","16).\n•Exploitation:in","step","(b),","if","the","maximal","confidence","interval","of","an","assortment","is","very","small,","smaller","than\n1\nK\n√\nT\n,","for","all","possible\ncandidate","sets,","then","we","perform","pure","exploitation.","This","step’s","contribution","to","the","total","regret","will","be","small.\n•Exploration:in","step","(c),","if","there","is","a","set","that","has","large","confidence","interval","(larger","than2\n−`\n),","then","we","choose","that","set","asS\nt\n.\nThen","we","update","the","index","setΨ\n`\nto","include","the","timestampt.\n•Pruning:finally,","step","(d)","is","a","pruning","step,","where","we","remove","clearly","sub-optimal","sets","and","keep","the","sets","which","are","possibly\noptimal.\nIf","the","algorithm","does","not","chooseS\nt\nin","epoch`,","then","it","moves","on","to","the","next","epoch`+","1and","repeat","the","process","untilS\nt\nis\nchosen","either","through","exploitation","action","in","(b)","or","exploration","action","in","(c).","Note","that","when","maximizing","the","expected","revenue\nR\nt\n(S,\nˆ\nθ)in","step","(b)","or","in","step","(d),","it","uses","the","expected","revenue","defined","in","(1)","replacingθ\n∗\nwith","the","current","estimator\nˆ\nθ\n(`)\nt\n—\nnote","that","we","use","the","expected","revenueR\nt\n(S)inSUPCB-MNL,","not","the","optimistic","expected","revenue\n","̃\nR\nt\n(S)used","in","UCB-MNL\n(Algorithm","1).\nAdapted","from","Lemma","14","of","Auer","(2002)","and","Lemma","4","of","Li,","Lu,","and","Zhou","(2017),","the","following","result","shows","that","the\nsamples","collected","from","Algorithm","5","in","each","index","setΨ\n`\nare","independent.\nLemma","16.For","all`∈[L]andt∈[T],","given","the","set","of","feature","vectors","in","index","setΨ\n`\n,{[x\nti\n]\ni∈S\nt\n,t∈Ψ\n`\n},","the","corresponding\nchoice","responses{y\nt\n,t∈Ψ\n`\n}are","independent","random","variables.\n\nAlgorithm","5SUPCB-MNL\n1:Input:T,","initializationT\n0\n,","confidence","radiusα\n2:Initialization:fort∈[T\n0\n]\n3:randomly","chooseS\nt\nwith|S\nt\n|=K\n4:setL=b\n1\n2\nlog\n2\nTc,","andΨ\n0\n=···=","Ψ\nL\n=∅.\n5:forallT\n0\n=τ+","1toTdo\n6:InitializeA\n1\n=Sand`=","1\n7:whileS\nt\nis","emptydo\n8:(a).","Run","Algorithm","4","withA\n`\n,αandΨ\n`\n∪[T\n0\n]to","compute\nˆ\nθ\n(`)\nt\n,w\n(`)\nti\n,W\n(`)\nt\n9:(b).IfW\n(`)\nt\n≤\n1\n√\nT\n,\n10:setS\nt\n=","argmax\nS∈A\n`\nR\nt\n(S,\nˆ\nθ\n(`)\nt\n)\n11:updateΨ\n0\n=","Ψ\n0\n∪{t}\n12:(c).Else","ifW\n(`)\nt\n>2\n−`\n,\n13:setS\nt\n=","argmax\nS⊆A\n`\n∑\ni∈S\nw\n(`)\nti\n14:updateΨ\n`\n=","Ψ\n`\n∪{t}\n15:(d).Else","ifW\n(`)\nt\n≤2\n−`\n,\n16:computeM\n(`)\nt\n=","max\nS∈A\n`\nR\nt\n(S,\nˆ\nθ\n(`)\nt\n)\n17:A\n`+1\n=\n{\nS∈A\n`\n:R\nt\n(S,\nˆ\nθ\n(`)\nt\n)≥M\n(`)\nt\n−2\n−`+1\n}\n18:`←`+","1\n19:end","while\n20:end","for\nRegret","Bound","forSUPCB-MNL\nIndependent","samples","ensured","by","the","master","algorithmSUPCB-MNL","and","Lemma","16","enable","us","to","apply","the","non-asymptotic\nnormality","result","in","Theorem","2","separately","to","samples","in","each","index","setΨ\n`\n.","We","present","the","following","regret","bound","ofSUPCB-\nMNL","(Algorithm","5),","which","is","a","formal","statement","of","Theorem","3\nTheorem","","","3(Formal","","","statement).Suppose","","","Assumptions","","","1","","","and","","","2,","","","and","","","we","","","run","","","Algorithm","","","5","","","withT\n0\n=\nC\n0\nκ\n4\nmax\n{\n√\ndT\nσ\n0\n,\nd+2","log(TNlog\n2\nT)\nσ\n2\n0\n}\nwith","a","universal","constantC\n0\nandα=\n5\nκ\n√\n2","log(TNlog\n2\nT)forT≥\n","̃\nTrounds,","where\n","̃\nT=","Ω\n(\nmax\n{\nlog\n2\n(TNlog\n2\nT)\nd\n,d\n3\n})\n.(25)\nThen,","the","algorithm’s","expected","regret","is","upper-bounded","by\nR\nT\n=O\n(\n√\ndTlog(T/d)","log(TNlog\n2\nT)","log\n2\nT\n)\n.\nDiscussion","of","Theorem","3.We","establish\n","̃\nO(\n√\ndT)regret","bound","forSUPCB-MNL","algorithm.","Chen","and","Wang","(2017)","provide\na","lower","bound","ofΩ(\n√\nNT)in","the","non-contextual","setting","which","is","free","ofK.","This","lower","bound","can","be","translated","toΩ(\n√\ndT)\nif","each","item","is","represented","as","one-hot","encoding.","Hence","the","regret","bound","in","Theorem","3","matches","the","lower","bound","for","the","MNL\nbandit","problem","with","finite","actions.","To","the","best","of","our","knowledge,SUPCB-MNL","is","the","first","algorithm","which","achieves","the","rate\nof\n","̃\nO(\n√\ndT)regret","in","MNL","contextual","bandits.","Comparing","with","Theorem","1","for","UCB-MNL","(Algorithm","1)","as","well","as","its","online\nupdate","variant","(Algorithm","3)","—","which","are","near-optimal","in","the","case","of","infinitely","large","item","set","(or","exponentially","largeN)","—","the\nimprovement","of\n√\ndfactor","comes","from","directly","controlling","the","utility","estimation","error","using","Theorem","2.","Note","that","the","regret\nbound","in","Theorem","3","has","logarithmic","dependence","onN,","thereforeSUPCB-MNL","is","not","applicable","to","a","case","where","there","are","an\ninfinite","number","of","total","items.","However,","whenNis","not","exponentially","large","(i.e.,N\u001ce\nd\n),","the","rate","ofSUPCB-MNL","is","optimal.\nProof","Sketch","of","Theorem","3\nNote","that","we","want","to","have","the","concentration","result","of","the","prediction","error","in","Theorem","2","to","hold","for","all","itemsi∈[N]and","for","all\nroundst∈[T]including","the","inner","loop","(epochs)","in","Algorithm","5;","hence","for","all`up","toL=O(log\n2\nT).","Hence,","we","choose","the\nconfidence","radius","to","beα=\n5\nκ\n√\n2","log","(TNlog\n2\nT).","Then","with","probability","at","least1−\n3\nTNlog\n2\nT\n,","we","would","have\n|x\n>\nti\n(\nˆ\nθ\nt\n−θ\n∗\n)|≤α‖x\nti\n‖\nV\n−1\nΨ\n`\n\nfor","eacht∈Ψ\n`\nif","the","independence","and","minimum","eigenvalue","conditions","are","satisfied.","Then","we","can","use","the","union","bound","to\nshow","this","concentration","holds","jointly","for","all","items","and","all","rounds","with","a","high","probability.","Now,","we","know","that","the","independence\nrequirement","is","satisfied","bySUPCB-MNL","and","Lemma","16.","For","the","minimum","eigenvalue","condition,","we","need","to","ensure","that\nλ\nmin\n(V\nt\n)","=","Ω\n(\nd\n2\n+","log","(TNlog\n2\nT)\nκ\n4\n)\n.(26)\nHence","forT≥\n","̃\nTwhere\n","̃\nT=","Ω\n(\nmax\n{\nlog\n2\n(TNlog\n2\nT)\nd\n,d\n3\n})\n,","using","Proposition","1,","we","can","run","the","random","initialization","for\nO(\n√\ndT)to","ensure","(26)","holds","with","a","high","probability.","Given","this","concentration","result,","we","decompose","the","regret","into","to","two\nparts","–","the","regret","incurred","when","an","assortment","is","chosen","for","exploitation","(step","(b)","in","Algorithm","5)","and","the","regret","for","exploration\n(step","(c)","in","Algorithm","5).","We","show","the","regret","coming","from","step","(b)","is","small","since","the","utility","estimates","are","already","accurate","in\nthat","case.","We","also","show","that","even","when","we","take","an","exploratory","action","in","step","(c),","the","regret","incurred","by","such","an","action","is","not\ntoo","large","due","to","the","concentration","result","as","well","as","the","pruning","procedure","in","step","(d).\nProof","of","Theorem","3\nWe","first","present","two","lemmas","to","help","bound","the","cumulative","expected","regret.","The","first","lemma","ensures","that","normality","results\n(Theorem","2)","holds","with","given","confidence","radiusαfor","all","items.\nLemma","17.LetT\n0\n=\nC\n0\nκ\n4\nmax\n{\n√\ndT\nσ\n0\n,\nd+2","log(TNlog\n2\nT)\nσ\n2\n0\n}\nandα=\n5\nκ\n√\n2","log(TNlog\n2\nT).","SupposeT≥\n","̃\nTwhere\n","̃\nTis","defined\nas","(25).","Define","the","following","event:\nE\nt\n:=\n{\n|x\n>\nti\nˆ\nθ\n(`)\nt−1\n−x\n>\nti\nθ\n∗\n|≤w\n(`)\nti\n,∀i∈[N],∀`∈[L]\n}\n(27)\nThen,","eventE\nt\nholds","with","probability","at","least1−O(T\n−2\n)for","allt≥T\n0\nThe","next","lemma","bounds","the","immediate","regret","ofSUPCB-MNL,","breaking","down","to","two","choice","scenarios","—","when","an","assort-\nment","is","chosen","for","exploitation","(step","(b))","or","for","exploration","(step","(c))","in","Algorithm","4.","Intuitively,","the","regret","coming","from","step\n(b)","is","very","small","since","the","utility","estimates","are","accurate","in","that","scenario.","The","challenge","is","to","show","that","even","when","we","take","an\nexploratory","action","in","step","(c),","the","regret","incurred","by","such","an","action","is","not","too","large.\nLemma","18.Suppose","that","eventE\nt\nin","(27)","holds,","and","that","in","roundt,","the","assortmentS\nt\nis","chosen","at","stage`\nt\n.","ThenS\n∗\nt\n∈A\n`\nfor\nall`≤`\nt\n.","Furthermore,","we","have\nR\nt\n(S\n∗\nt\n,θ\n∗\n)−R\nt\n(S\nt\n,θ\n∗\n)≤\n\n\n\n\n\n2\n√\nT\n,ifS\nt\nchosen","in","step(b)\n8\n2\n`\nt\n,ifS\nt\nchosen","in","step(c)\nThen,","we","follow","the","similar","arguments","of","Li,","Lu,","and","Zhou","(2017)","to","show","the","cumulative","expected","regret","bound.","First,","define\nV\n`,t\n=\n∑\nt∈Ψ\n`\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n,","then","by","Lemma","6","and","Cauchy-Schwarz","inequality,","we","have\n∑\nt∈Ψ\n`\nmax\ni∈S\nt\nw\n(`)\nti\n=\n∑\nt∈Ψ\n`\nmax\ni∈S\nt\nα‖x\nti\n‖\nV\n−1\n`,t\n≤α\n√\n2|Ψ\n`\n|dlog(T/d).\nHowever,","from","the","choices","made","at","exploration","steps","(step","(c))","of","Algorithm","5,","we","know\n2\n−`\n|Ψ\n`\n|≤2\n∑\nt∈Ψ\n`\nmax\ni∈S\nt\nw\n(`)\nti\nfor`∈{1,...,L}.","Now,","we","combine","the","two","inequalities","above.","Then","it","follows","that\n|Ψ\n`\n|≤2\n`+1\nα\n√\n2|Ψ\n`\n|dlog(T/d).(28)\nNote","that","each","index","setΨ\n`\nis","a","disjoint","set","with∪\nL\n`=0\nΨ\n`\n={t+","1,...,T}.","Then,","we","break","the","regret","into","three","components\n–","when","eventE\nt\nin","(27)","holds,","i.e.,","the","concentration","result","holds,","and","when","the","event","does","not","hold","(E\nc\nt\n),","and","the","random\ninitialization","phase","with","lengthT\n0\n.","Note","that","we","need","the","minimum","eigenvalue","ofV\nT\n0\nto","be","larger","than","the","case","in","UCB-MNL\nbut","we","can","still","use","Proposition","1","to","ensure","such","case","with","a","high","probability.\nR\nT\n≤T\n0\n+E\n[\nT\n∑\nt=T\n0\n+1\n(R(S\n∗\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(E\nt\n)\n]\n+E\n[\nT\n∑\nt=T\n0\n+1\n(R(S\n∗\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(E\nc\nt\n)\n]\n\nWe","further","decompose","the","regret","into","the","disjoint","stages","recorded","byΨ\n`\n.\nR\nT\n≤T\n0\n+E\n[\n∑\nt∈Ψ\n0\n(R(S\n∗\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(E\nt\n)\n]\n+E\n[\nL\n∑\n`=1\n∑\nt∈Ψ\n`\n(R(S\n∗\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(E\nt\n)\n]\n+O(1)\n≤T\n0\n+\n2\n√\nT\n|Ψ\n0\n|+\nL\n∑\n`=1\n8\n2\n`\n|Ψ\n`\n|+O(1)\n≤T\n0\n+","2\n√\nT+\nL\n∑\n`=1\n16α\n√\n2|Ψ\n`\n|dlog(T/d)","+O(1)\n≤T\n0\n+","2\n√\nT+","16α\n√\n2dLTlog(T/d)","+O(1)\nwhere","the","third","inequality","uses","(28)","and","the","last","inequality","is","by","Cauchy-Schwartz","inequality.","Now,","with","our","choices","ofα=\n5\nκ\n√\n2","log(TNlog\n2\nT),T\n0\n=\nC\n0\nκ\n4\nmax\n{\n√\ndT\nσ\n0\n,\nd+2","log(TNlog\n2\nT)\nσ\n2\n0\n}\nandL=b\n1\n2\nlog\n2\nTc≤\n1\n2\nlog\n2\nT,","then","we","complete","the","proof\nProofs","of","Lemmas","for","Theorem","3\nProof","of","Lemma","16\nProof.Since","a","timestamptcan","only","be","added","toΨ\n`\n,`≥1in","step","(c)","of","Algorithm","5,","the","event{t∈Ψ\n`\n}only","depends","on","the\nresults","of","trialst\n′\n∈","∪\n`\n′\n<`\nΨ\n`\n′\nand","on","̄w\n(`)\nti\n.","From","the","definition","of","̄w\n(`)\nti\n,","we","know","it","only","depends","on","the","sets","of","feature","vectors\n{x\nu,i\n}\ni∈S\nu\n,u∈Ψ\n`\nand","on{x\nti\n}\ni∈S\nt\n.\nProof","of","Lemma","17\nProof.WithT\n0\n=\nC\n0\nκ\n4\nmax\n{\n√\ndT\nσ\n0\n,\nd+2","log(TNlog\n2\nT)\nσ\n2\n0\n}\nandT≥\n","̃\nT,","at","the","end","of","initialization","we","have\nλ\nmin\n(V\nT\n0\n)≥C\n√\ndT=","Ω\n(\nmax\n{\nlog","(TNlog\n2\nT),d\n2\n})\n,\nwith","probability","at","least1−\n1\n(TNlog\n2\nT)\n2\nusing","Proposition","1.","Then,","the","condition","on","the","minimum","eigenvalue","ofV\nt\nfort≥T\n0\nis","satisfied","sinceλ\nmin\n(V\nt\n)≥λ\nmin\n(V\nT\n0\n).","Therefore,","applying","Theorem","2,","we","have\n|x\n>\nti\n(\nˆ\nθ\nt\n−θ\n∗\n)|≤α‖x\nti\n‖\nV\n−1\nt\nwith","probability","at","least1−\n3\n(TNlog\n2\nT)\n2\n.","Note","that","we","are","applying","Theorem","2","tox\nti\nfor","alliwhich","are","i.i.d","by","definition\n(Assumption","1).","Now,","applying","the","union","bound","over","all","items","and","epochs,","we","complete","the","proof.\nProof","of","Lemma","18\nProof.Combining","Lemma","4","and","Lemma","5,","we","have\n∣\n∣\n∣\nR\nt\n(S,θ\n∗\n)−R\nt\n(S,\nˆ\nθ\n(`)\n)\n∣\n∣\n∣\n≤\n∣\n∣\n∣\n","̃\nR\nt\n(S,\nˆ\nθ\n(`)\n)−R\nt\n(S,\nˆ\nθ\n(`)\n)\n∣\n∣\n∣\n≤2","max\ni∈S\nw\n(`)\nti\n≤W\n(`)\nt\n.\nWe","first","show","the","optimal","assortmentS\n∗\nt\n∈A\n`\nfor","all`.","We","prove","this","by","induction.","For`=","1,","the","lemma","automatically","holds.\nAs","an","inductive","step,","supposeS\n∗\nt\n∈A\n`\nand","we","want","to","proveS\n∗\nt\n∈A\n`+1\n.","Since","the","algorithm","proceed","to","stage`+","1,","we","know\nfrom","step","(c)","in","Algorithm","5","that\n∣\n∣\n∣\nR\nt\n(S,θ\n∗\n)−R\nt\n(S,\nˆ\nθ\n(`)\n)\n∣\n∣\n∣\n≤W\n(`)\nt\n≤2\n−`\nfor","allS∈A\n`\n.","In","particular,","it","holds","forS=S\n∗\nt\nsinceS\n∗\nt\n∈A\n`\nby","the","inductive","step.","Then","the","optimality","ofS\n∗\nt\nimplies\nR\nt\n(S\n∗\nt\n,\nˆ\nθ\n(`)\n)≥R\nt\n(S\n∗\nt\n,θ\n∗\n)−2\n−`\n≥R\nt\n(S,θ\n∗\n)−2\n−`\n≥R\nt\n(S,\nˆ\nθ\n(`)\n)−2·2\n−`\nforS∈A\n`\n.","Hence,","it","follows","that\nR\nt\n(S\n∗\nt\n,\nˆ\nθ\n(`)\n)≥max\nS∈A\n`\nR\nt\n(S,\nˆ\nθ\n(`)\n)−2·2\n−`\n=M\n(`)\nt\n−2·2\n−`\n.\nTherefore,","we","haveS\n∗\nt\n∈A\n`+1\naccording","to","step","(d).\n\nIfS\nt\nis","selected","in","step","(b),","that","it","impliesR\nt\n(S\nt\n,\nˆ\nθ\n(`\nt\n)\n)≥R\nt\n(S\n∗\nt\n,\nˆ\nθ\n(`\nt\n)\n).","Then","if","follows","that\nR\nt\n(S\nt\n,θ\n∗\n)≥R\nt\n(S\nt\n,\nˆ\nθ\n(`\nt\n)\n)−\n1\n√\nT\n≥R\nt\n(S\n∗\nt\n,\nˆ\nθ\n(`\nt\n)\n)−\n1\n√\nT\n≥R\nt\n(S\n∗\nt\n,θ\n∗\n)−\n2\n√\nT\n.\nSupposeS\nt\nis","chose","at","stage`\nt\nin","step","(c)","in","Algorithm","5.","The","lemma","holds","automatically","for`\nt\n=","1sinceR\nt\n(S,θ\n∗\n)∈[0,1]\nfor","allSandt.","If`\nt\n>1,S\nt\nmust","have","passed","through","steps","(c)","and","(d)","in","the","previous","stage,`\nt\n−1.","Also","note","that","we","have\nalready","shown","that","the","optimal","assortmentS\n∗\nt\n∈A\n`\nt\n.","Hence,S\n∗\nt\nalso","must","have","passed","through","steps","(c)","and","(d)","in","stage`\nt\n−1.\nTherefore,","passing","through","step","(c)","at","stage`\nt\n−1implies","that\n∣\n∣\n∣\nR\nt\n(S,\nˆ\nθ\n(`\nt\n−1)\n)−R\nt\n(S,θ\n∗\n)\n∣\n∣\n∣\n≤W\n(`\nt\n−1)\nt\n≤2\n−(`\nt\n−1)\nforS=S\nt\nandS=S\n∗\nt\n.","Also,","for","step","(d)","at","stage`\nt\n−1implies","that\nR\nt\n(S\n∗\nt\n,\nˆ\nθ\n(`\nt\n−1)\n)−R\nt\n(S\nt\n,\nˆ\nθ\n(`\nt\n−1)\n)≤2·2\n−(`\nt\n−1)\nCombining","these","inequalities","above,","we","have\nR\nt\n(S\nt\n,θ\n∗\n)≥R\nt\n(S\nt\n,\nˆ\nθ\n(`\nt\n−1)\n)−2\n−(`\nt\n−1)\n≥R\nt\n(S\n∗\nt\n,\nˆ\nθ\n(`\nt\n−1)\n)−3·2\n−(`\nt\n−1)\n≥R\nt\n(S\n∗\nt\n,θ\n∗\n)−4·2\n−(`\nt\n−1)\n.\nProof","of","Theorem","4\nWe","first","make","the","formal","statement","of","Theorem","4.\nTheorem","4(Formal","statement).Suppose","Assumptions","1-3","hold,r\ni\n≡ris","uniform","for","alli,K≤\n18\nκ\n4\n,","and","we","runDBL-MNL\nwithα\nk\n=\n5\nκ\n√\nlog(τ\n2\nk\nN/4)andq\nk\n=\n288\nKσ\n0\nκ\n4\n(4d\n2\n+","log(τ\n2\nk\nN/4)).","Then","the","expected","regret","ofDBL-MNLover","horizonTis\nupper-bounded","by\nR\nT\n=O\n(\n√\ndTlog","(T/d)","log(TN)","log\n2\nT\n)\n.\nRemark","1.We","emphasize","that","the","assumptionK≤\n18\nκ\n4\nis","not","restrictive.","In","fact,","we","can","instead","use","Proposition","1","to","show","that\nq\nk\n=\nC\nK\nmax\n{\nd\n2\n+","log(τ\n2\nk\nN/4)\nσ\n0\nκ\n4\n,\nd+","2","log(τ\nk\n/2)\nσ\n2\n0\n}\nfor","some","constantCsatisfies","the","threshold","onλ\nmin\n(V\nτ\nk\n)without","assumingK≤\n18\nκ\n4\n.","However,","we","would","like","to","provide","a\nspecific","value","ofq\nk\nwhich","does","not","depend","on","an","unknown","constant","sinceq\nk\nis","an","input","to","the","algorithm.","Furthermore,","in","many\nreal-world","applications,Kis","typically","small;","henceK≤\n18\nκ\n4\n(recall","thatκ∈(0,1))","is","a","reasonable","assumption.\nSince","the","length","of","episode","grows","exponentially,","the","number","of","episodes","by","roundTis","logarithmic","in","horizonT.","In","particular,\nroundTbelongs","to","theL-th","episode","withL=blog\n2\nTc+","1.","Let","Regret(k)denote","cumulative","regret","of","thek-th","episode.","Hence,\nR\nT\n≤\nL\n∑\nk=1\nRegret(k).\nLetT\nk\n:={τ\nk−1\n+","1,...,τ\nk\n}denote","a","set","of","rounds","that","belong","to","thek-th","episode.","Note","that","the","length","of","thek-th","episode","is\n|T\nk\n|=τ\nk\n/2.","Now,","for","each","episodek,","we","consider","the","following","two","cases.\n(i)|T\nk\n|≤q\nk\n:","In","this","case,","the","length","of","an","episode","is","not","large","enough","to","ensure","the","concentration","of","the","prediction","error","due","to\nthe","failure","to","ensure","the","lower","bound","onλ\nmin\n(V\nt\n).","Therefore,","we","use","a","crude","upper","bound","on","the","regret","in","this","case.","However,\nthe","number","of","such","rounds","is","only","logarithmic","inT,","hence","contributing","minimally","to","the","total","regret.\n(ii)|T\nk\n|>","q\nk\n:","We","can","apply","Theorem","2","in","this","case","if","the","lower","bound","onλ\nmin\n(V\nt\n)is","guaranteed.λ\nmin\n(V\nt\n)grows","linearly\nastincreases","in","each","episode","(with","high","probability)","since","samples","are","independent","of","each","other.","In","case","ofλ\nmin\n(V\nt\n)not\ngrowing","as","fast","as","the","rate","we","require,","we","perform","random","sampling","to","satisfy","this","criterion","towards","the","end","of","each","episode.\nTherefore,","with","high","probability,","the","lower","bound","onλ\nmin\n(V\nt\n)becomes","satisfied.\n\nFor","case","(i),","clearlyq\nk\n≤2C\n0\n(4d\n2\n+","log(T\n2\nN))for","anykwhereC\n0\n=\n144\nKσ\n0\nκ\n4\n.|T\nk\n|eventually","grows","to","be","larger","than\n2C\n0\n(4d\n2\n+","log(T\n2\nN)).","","Letk\n′\nbe","","the","","first","","episode","","such","","that|T\nk\n′\n|","≥2C\n0\n(4d\n2\n+","log(T\n2\nN)).","","Hence,|T\nk\n′\n|","≤4C\n0\n(2d\n2\n+\nlog(T\n2\nN)).","Then","cumulative","regret","due","to","case","(i)","is","at","most\nk\n′\n−1\n∑\nk=1\nRegret(k)≤\nk\n′\n−1\n∑\nk=1\n|T\nk\n|=|T\nk\n′\n|≤4C\n0\n(\n4d\n2\n+","log(T\n2\nN)\n)\n.\nFor","case","(ii),","it","suffices","to","show","random","sampling","ensures","the","growth","ofλ\nmin\n(V\nt\n).","Lemma","19","shows","that","random","sampling\nwith","durationq\nk\nspecified","in","Theorem","4","ensures","the","lower","bound","ofλ\nmin\n(V\nt\n),","i.e.,λ\nmin\n(V\nt\n)≥C\n0\n(4d\n2\n+","log(τ\n2\nk\nN/4))with\nhigh","probability.\nLemma","19.SupposeK≤\n18\nκ\n4\nandq\nk\n=","2C\n0\n(4d\n2\n+","log(τ\n2\nk\nN/4)).","For","thek-th","episode,","with","probability","at","least1−\n4\nτ\n2\nk\nN\n,","we\nhave\nλ\nmin\n(V\nτ\nk\n)≥C\n0\n(4d\n2\n+","log(τ\n2\nk\nN/4))(29)\nwhereC\n0\n=\n144\nKσ\n0\nκ\n4\n.\nWe","then","apply","Theorem","2","to","prediction","error","in","thek-th","episode","which","requires","samples","in","thek−1-th","episode","are","inde-\npendent","andλ\nmin\n(V\nτ\nk−1\n)at","the","end","of","thek−1-th","episode","is","large","enough.","With","a","lower","bound","guarantee","onλ\nmin\n(V\nτ\nk−1\n)\nfrom","Lemma","19","and","the","fact","that","samples","are","independent","of","each","other","within","each","episode,","we","have","with","probability","at","least\n1−\n3\n|T\nk\n|\n2\nN\n|x\n>\nti\n(\nˆ\nθ\nk\n−θ\n∗\n)|≤α\nk\n‖x\nti\n‖\nW\n−1\nk−1\nwhereα\nk\n=\n5\nκ\n√\nlog(τ\n2\nk\nN/4).","Recall","thatW\nk−1\n=V\nτ\nk−1\n=\n∑\nτ\nk−1\nt\n′\n=τ\nk−1\n+1\n∑\ni∈S\nt\n′\nx\nt\n′\ni\nx\n>\nt\n′\ni\nis","the","Gram","matrix","at","the","end","of","the\nk−1-th","episode.","Then,","we","can","use","the","union","bound","to","show","this","concentration","result","for","all","times","and","all","round","within","the\nepisode.","Hence,","it","folows","that","with","probability","at","least1−\n3\n|T\nk\n|\n,\n|x\n>\nti\n(\nˆ\nθ\nk\n−θ\n∗\n)|≤α\nk\n‖x\nti\n‖\nW\n−1\nk−1\n,∀i∈[N],∀t∈T\nk\n.(30)\nLet\n","̃\nE\nk\ndenote","the","event","that","both","the","minimum","eigenvalue","condition","in","(29)","(at","the","end","of","thek−1-th","episode)","and","the","MLE\nconcentration","result","in","(30)","hold.\n","̃\nE\nk,1\n:=\n{\nλ\nmin\n(V\nτ\nk−1\n)≥C\n0\n(\n4d\n2\n+","log\n(\nτ\nk−1\nN\n2\n)\n)}\n","̃\nE\nk,2\n:=\n{\n|x\n>\nti\n(\nˆ\nθ\nk\n−θ\n∗\n)|≤α\nk\n‖x\nti\n‖\nW\n−1\nk−1\n,∀i∈[N],∀t∈T\nk\n}\n","̃\nE\nk\n:=\n","̃\nE\nk,1\n∩\n","̃\nE\nk,2\n.\nOn","this","event\n","̃\nE\nk\n,","by","the","definition","of","the","upper","confidence","bound","of","an","utility","estimate","̃z\nti\nand","following","the","same","arguments\nas","Lemma","3,","we","have\n0≤","̃z\nti\n−x\n>\nti\nθ\n∗\n≤2α\nk\n‖x\nti\n‖\nW\n−1\nk−1\n.\nTherefore,","the","optimistic","expected","revenue\n","̃\nR\nt\n(S)based","on{","̃z\nti\n}is","computed","the","same","way","as","(4).","It","is","important","to","note","that\nwhile","the","formation","of","the","optimistic","revenue\n","̃\nR\nt\n(S)is","identical","to","(4),","the","actual","values","of\n","̃\nR\nt\n(S)are","different","for","the","two\nalgorithms.","In","particular,","when","feature","dimensiondis","large,\n","̃\nR\nt\n(S)of","DBL-MNL","can","be","much","tighter","than","that","of","UCB-MNL\nsince","the","confidence","width","̃α\nk\nfor","DBL-MNL","does","not","have","dependence","ond.\nLetS\nt\n=","argmax\nS∈S\n","̃\nR\nt\n(S).","Then,","it","follows","that\n","̃\nR\nt\n(S\nt\n)≥R(S\n∗\nt\n,θ\n∗\n)following","from","Lemma","4.","Thus,","we","can","bound","the\nregret","in","thek-th","episode","as","follows:\nRegret(k)","=\n∑\nt∈T\nk\n(R(S\n∗\nt\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(\n","̃\nE\nk\n)\n≤\n∑\nt∈T\nk\n(\n","̃\nR(S\nt\n)−R(S\nt\n,θ\n∗\n)\n)\n1(\n","̃\nE\nk\n)\n\nThen,","by","the","Lipschitz","property","of","the","expected","revenue","of","the","MNL","model","shown","in","Lemma","5,","it","follows","that\n∑\nt∈T\nk\n(\n","̃\nR(S\nt\n)−R(S\nt\n,θ\n∗\n)\n)\n1(\n","̃\nE\nk\n)≤\n∑\nt∈T\nk\n∑\ni∈S\nt\n∣\n∣\n∣\nx\n>\nti\n(\nˆ\nθ\nk\n−θ\n∗\n)","+α\nk\n‖x\nti\n‖\nW\n−1\nk−1\n∣\n∣\n∣\n≤2α\nk\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\nW\n−1\nk−1\nwhere","the","last","inequality","is","from","(30).","Then","we","use","Lemma","20","to","bound","using","the","norm","using","the","current","Gram","matrix.","This\nresult","utilizes","the","fact","that","the","minimum","eigenvalue","of","the","Gram","matrix","grows","linearly","within","each","episode","since","the","samples","are\nindependent","from","each","other,","allowing","us","to","use","the","matrix","Chernoff","inequality","to","the","sum","of","independent","matrices.","Furthermore,\nthe","fact","that","episode","length","difference","is","two-fold","for","adjacent","episodes","allows","us","to","bound","the","difference","between","the","Gram\nmatrices.\nLemma","20.Fort∈T\nk\n,\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\nW\n−1\nk−1\n≤C\n1\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt−1\nwith","probability","at","least1−de\n−C\n2\n(t−τ\nk−1\n)\n.\nLet\n","̃\nE\nk,3\n:=\n{\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\nW\n−1\nk−1\n≤C\n1\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt−1\n,∀t∈T\nk\n}\ndenote","the","event","that","Lemma","20","holds","for\nthek-th","episode.","Under","this","event","along","with",",","it","follows","that\n∑\nt∈T\nk\n(\n","̃\nR(S\nt\n)−R(S\nt\n,θ\n∗\n)\n)\n1(\n","̃\nE\nk\n∩\n","̃\nE\nk,3\n)≤2C\n1\nα\nk\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\nV\n−1\nt−1\n≤2C\n1\nα\nk\n√\nτ\nk\n2\n∑\nt∈T\nk\n∑\ni∈S\nt\n‖x\nti\n‖\n2\nV\n−1\nt−1\n≤2C\n1\nα\nk\n√\nτ\nk\ndlog\n(\nτ\nk\n2d\n)\nwhere","we","use","the","Cauchy-Schwarz","inequality","in","the","second","inequality","and","apply","the","bound","on","the","self-normalized","process","in\nLemma","6","in","the","last","inequality.","Thus,","when","events\n","̃\nE\nk\nand\n","̃\nE\nk,3\nhold,","the","regret","in","thek-th","episode","is","bounded","by\n∑\nt∈T\nk\n(R(S\n∗\nt\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(\n","̃\nE\nk\n∩\n","̃\nE\nk,3\n)","=O\n(\n√\ndτ\nk\nlog","(τ\nk\n/d)","log(τ\nk\nN)\n)\nOn","the","other","hand,","the","cumulative","regret","for","the","episode","under","the","failure","events","of\n","̃\nE\nk\nand\n","̃\nE\nk,3\nare\n∑\nt∈T\nk\n(R(S\n∗\nt\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(\n","̃\nE\nc\nk\n)","=O(1)\n∑\nt∈T\nk\n(R(S\n∗\nt\n,θ\n∗\n)−R(S\nt\n,θ\n∗\n))1(\n","̃\nE\nc\nk,3\n)","=O(d).\nTherefore,","summing","over","all","episodes,","the","cumulative","expected","regret","is","given","by\nR\nT\n=O\n(\n√\ndTlog","(T/d)","log(TN)","log\n2\nT\n)\nProof","of","Lemma","19\nProof.By","the","design","of","Algorithm","2,","it","suffices","to","show","that","the","random","sampling","for","durationq\nk\nprovides","sufficient","growth","of\nλ\nmin\n(V\nτ\nk\n).","Let\n","̃\nT\nk\nbe","the","set","of","rounds","in","thek-th","episode","that","random","sampling","is","performed.","Without","loss","generality,","assume\nthat","the","random","initialization","is","invoked","for","the","full","durationq\nk\n(note","that","Algorithm","2","may","not","invoke","random","sampling","at","all\nif","the","minimum","eigenvalue","condition","is","already","satisfied).","Hence,\n","̃\nT\nk\n={τ\nk\n−q\nk\n+","1,τ\nk\n}in","this","case.","First,","under","random\nsampling","ofS\nt\n,","we","have\nλ\nmin\n\n\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nE[x\nti\nx\n>\nti\n]\n\n\n≥\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nλ\nmin\n(\nE[x\nti\nx\n>\nti\n]\n)\n=Kq\nk\nσ\n0\n=\n288\nκ\n4\n(4d\n2\n+","log(τ\n2\nk\nN/4))\n\nwhere","","the","","inequality","","is","from","","the","","fact","","that","","the","","minimum","eigenvalue","","functionλ\nmin\n(·)is","","concave","","over","","positive","semi-definite\nmatrices.","Also,","since‖x\nti\n‖≤1is","bounded,\nλ\nmax\n(\n∑\ni∈S\nt\nE[x\nti\nx\n>\nti\n]\n)\n≤K\nfor","allt.","Therefore,","we","can","use","the","Matrix","Chernoff","inequality","shown","in","Lemma","23","(Corollary","5.2","of","(Tropp","2012))\nP\n\n\n\nλ\nmin\n(\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n≤\n144\nκ\n4\n(4d\n2\n+","log(τ\n2\nk\nN/4))\n\n\n\n≤P\n\n\n\nλ\nmin\n(\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n)\n≤\n1\n2\n·λ\nmin\n(\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nE[x\nti\nx\n>\nti\n]\n)\n\n\n\n≤d·exp\n\n\n\n−\n1\n4\n·λ\nmin\n(\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nE[x\nti\nx\n>\nti\n]\n)\n/(2K)\n\n\n\n≤d·exp\n{\n−\n18(4d\n2\n+","log(τ\n2\nk\nN/4))\nKκ\n4\n}\n=","exp\n{\nlogd−\n72d\n2\nKκ\n4\n−\n18","log(τ\n2\nk\nN/4)\nKκ\n4\n}\n≤exp\n{\n−\n18","log(τ\n2\nk\nN/4)\nKκ\n4\n}\n≤\n(\n4\nτ\n2\nk\nN\n)\n18/(Kκ\n4\n)\n≤\n4\nτ\n2\nk\nN\n.\nSinceλ(V\nτ\nk\n)<\n∑\nt∈\n","̃\nT\nk\n∑\ni∈S\nt\nx\nti\nx\n>\nti\n,","this","completes","the","proof.\nProof","of","Lemma","20\nProof.Recall","thatW\nk−1\nis","the","Gram","matrix","at","the","end","of","thek−1-th","episode,","i.e.,V\nτ\nt−1\nbefore","it","resets","at","the","beginning","of","the\nk-th","episode.","SinceV\nt\nresets","at","the","beginning","of","each","episode,","we","focus","on","howV\nt\ngrows","in","thek-th","episode","relative","toW\nk−1\n,\nthe","Gram","matrix","at","the","end","of","the","previous","episode.","Clearly,","ifCW\nk−1\n<V\nt\n,","for","allt∈","{τ\nk−1\n+","1,τ\nk\n}for","some","constantC,\nthen","the","claim","holds.","Then","it","suffices","to","showλ\nmin\n(V\nt\n)grows","linearly","astincreases","during","thek−1-th","episode.","In","fact,","since\nXis","time-invariant,","we","show","theλ\nmin\n(V\nt\n)grows","linearly","withtin","all","episodes.\nLet\n","̃\nθ\nk,t\nbe","the","parameter","corresponding","to","the","upper","confidence","reward","at","roundt,max\nS∈S\n","̃\nR\nt\n(S).","Note","that\n","̃\nθ\nk,t\nis","not\nthe","same","as","the","MLE\nˆ\nθ\nk\n.","Since","we","take","an","UCB","action","in","Algorithm","2,","this","is","equivalent","to","taking","some","optimistic","parameter\nwithin","the","confidence","ellipsoid","centered","at\nˆ\nθ\nk\n.","It","is","important","to","note","that","since","we","do","not","update","the","MLE","and","confidence","bound\nwithin","each","episode,","the","samplesy\nt\n’s","are","still","independent","from","each","other","in","the","same","episode.","Consider(i\n1\n,...,i\nN\n),","a","set","of\nall","permutations","of","integers{1,,,N}.","Without","loss","of","generality,","assumeNis","divisible","byK.","Then","we","can","write\nE\n[\nX\nti\nX\n>\nti\n]\n=\n1\nN\nE\n[\nX\nt1\nX\n>\nt1\n+...+X\ntN\nX\n>\ntN\n]\n=\n1\nN\n∑\n(i\n1\n,...,i\nN\n)\nE\n[\n(X\nt,i\n1\nX\n>\nt,i\n1\n+...+X\nt,i\nN\nX\n>\nt,i\nN\n)1{X\n>\nt,i\n1\n","̃\nθ\nk,t\n<···<","X\n>\nt,i\nN\n","̃\nθ\nk,t\n}\n]\n4\n1\nN\n∑\n(i\n1\n,...,i\nN\n)\nN\nK\nC\nX\nE\n[\n(V\nt,min\n(I)","+V\nt,max\n(I))1{X\n>\nt,i\n1\n","̃\nθ\nk,t\n<···<","X\n>\nt,i\nN\n","̃\nθ\nk,t\n}\n]\nwhereV\nt,min\n(I)andV\nt,max\n(I)are","the","first","and","lastKsums","respectively","under","orderingI=","(i\n1\n,...,i\nN\n).","That","is,\nV\nt,min\n(I)","=V\nt,min\n(i\n1\n,...,i\nN\n)",":=X\nt,i\n1\nX\n>\nt,i\n1\n+...+X\nt,i\nK\nX\n>\nt,i\nK\nV\nt,max\n(I)","=V\nt,max\n(i\n1\n,...,i\nN\n)",":=X\nt,i\nN−K+1\nX\n>\nt,i\nN−K+1\n+...+X\nt,i\nN\nX\n>\nt,i\nN\n\nNote","that","the","last","inequality","holds","sinceC\nX\n(V\nmin\n(I)","+V\nmax\n(I))dominates","anyKsum","in{X\nt,i\n1\nX\n>\nt,i\n1\n,...,X\nt,i\nN\nX\n>\nt,i\nN\n}\nwhich","follows","from","applying","Lemma","21","repeatedly","fromk\n′\n=","1tok\n′\n=K.\nE\n[\nX\nti\nX\n>\nti\n]\n4\nC\nX\nK\n∑\n(i\n1\n,...,i\nN\n)\nE\n[\n(V\nt,min\n(I)","+V\nt,max\n(I))1{X\n>\nt,i\n1\n","̃\nθ\nk,t\n<···<","X\n>\nt,i\nN\n","̃\nθ\nk,t\n}\n]\n4\nC\nX\nρ\n0\nK\n∑\n(i\n1\n,...,i\nN\n)\nE\n[\nV\nt,max\n(I)1{X\n>\nt,i\n1\n","̃\nθ\nk,t\n<···<","X\n>\nt,i\nN\n","̃\nθ\nk,t\n}\n]\n=\nC\nX\nρ\n0\nK\nE\n[\n∑\nX\nti\n∈X\nt\nX\nti\nX\n>\nti\n1\n(\nX\nti\n∈S\nt\n)\n]\nwhere","the","second","inequality","is","comes","from","utilizing","the","relaxed","symmetry","(Assumption","3)","and","the","proof","of","Lemma","2","in","(Oh,\nIyengar,","and","Zeevi","2020).","The","last","eqaulity","follow","from","the","fact","thatS\nt\n=","argmax\nS∈S\n","̃\nR\nt\n(S).","Therefore,\nE\n[\n∑\nX\nti\n∈X\nt\nX\nti\nX\n>\nti\n1\n(\nX\nti\n∈S\nt\n)\n]\n<\nK\nC\nX\nρ\n0\nE\n[\nX\nti\nX\n>\nti\n]\n.\nNow,","fort∈T\nk\n,","we","define\nΣ\nk,t\n:=\nt\n∑\nt\n′\n=τ\nk−1\n+1\nE\n\n\n∑\nX\nt\n′\ni\n∈X\nt\n′\nX\nt\n′\ni\nX\n>\nt\n′\ni\n1\n(\nX\nt\n′\ni\n∈S\nt\n′\n)\n\n\n.\nThen,","since","the","minimum","eigenvalue","functionλ\nmin\n(·)is","concave","over","positive","semi-definite","matrices,","we","have\nλ\nmin\n(Σ\nk,t\n)","=λ\nmin\n\n\nt\n∑\nt\n′\n=τ\nk−1\n+1\nE\n\n\n∑\nX\nt\n′\ni\n∈X\nt\n′\nX\nt\n′\ni\nX\n>\nt\n′\ni\n1\n(\nX\nt\n′\ni\n∈S\nt\n′\n)\n\n\n\n\n≥\nt\n∑\ns=τ\nk−1\n+1\nλ\nmin\n\n\nE\n\n\n∑\nX\nt\n′\ni\n∈X\nt\n′\nX\nt\n′\ni\nX\n>\nt\n′\ni\n1\n(\nX\nt\n′\ni\n∈S\nt\n′\n)\n\n\n\n\n≥\nK(t−τ\nk−1\n)σ\n0\nρ\n0\nC\nX\n>0.(31)\nNow,","","to","","apply","","the","","matrix","","concentration","","inequality,","","we","","need","","to","","show","","an","","upper","","bound","","on","","the","","maximum","","eigenvalue","","of\nE\n[\n∑\nX\nt\n′\ni\n∈X\nt\n′\nX\nt\n′\ni\nX\n>\nt\n′\ni\n1\n(\nX\nt\n′\ni\n∈S\nt\n′\n)\n]\n.","We","use","the","fact","that‖X\nt\n′\ni\n‖≤1is","bounded.","Hence,","we","have","for","allτ\nλ\nmax\n\n\nE\n\n\n∑\nX\nt\n′\ni\n∈X\nt\n′\nX\nt\n′\ni\nX\n>\nt\n′\ni\n1\n(\nX\nt\n′\ni\n∈S\nt\n′\n)\n\n\n\n\n≤K",".\nThen","we","can","apply","Corollary","5.2","in","(Tropp","2012)","to","the","finite","sequence","of","independent","matricesV\nt\nfort∈T\nk\n.\nP\n(\nλ\nmin\n(V\nt\n)≤\nK(t−τ\nk−1\n)σ\n0\n2ρ\n0\nC\nX\n)\n≤d\n(\ne\n−1/2\n0.5\n1/2\n)\n(t−τ\nk−1\n)σ\n0\nρ\n0\nC\nX\n=dexp\n{\n(t−τ\nk−1\n)σ\n0\nρ\n0\nC\nX\nlog\n(\ne\n−1/2\n0.5\n1/2\n)}\n≤dexp\n{\n−\n(t−τ\nk−1\n)σ\n0\n10ρ\n0\nC\nX\n}\nwhere","the","last","inequality","uses−\n1\n2\n−\n1\n2\nlog\n1\n2\n≤","−\n1\n10\n.","Therefore,λ\nmin\n(V\nt\n)grows","linearly","astgrows","within","the","episode","with\nprobability","at","least1−dexp{−(t−τ\nk−1\n)σ\n0\n/(10ρ\n0\nC\nX\n)}.","This","completes","the","proof.\nRemark","2.Since","our","primary","focus","here","is","to","showλ\nmin\n(V\nt\n)grows","linearly","in","every","episode,","we","only","show","a","very","crude","bound\nforC\nX\nfor","which","we","show","a","finite","value","Note","that","exact","value","ofC\nX\nis","characterized","by","the","distribution","of","feature","vector.","For\nexample,","multivariate","Gaussian","and","uniform","distributions,","it","can","be","shown","thatC\nX\n=O(1).\n\nLemma","21.Consider","i.i.d.","arbitrary","distributionp\nX\n.","Fix","some","vectorθ∈R\nd\n.","For","a","given","integerk∈{k\n′\n,...,N−k\n′\n+","1},\nE\n[\nX\nk\nX\n>\nk\n1{X\n>\n1\nθ","<···<","X\n>\nk\nθ","<···<","X\n>\nN\nθ}\n]\n4C\nk\nE\n[\n(X\nk\n′\nX\n>\nk\n′\n+X\nN−k\n′\n+1\nX\n>\nN−k\n′\n+1\n)1{X\n>\n1\nθ","<···<","X\n>\nN\nθ}\n]\nwhereC\nk\n=\n(k\n′\n−1)!(N−k\n′\n)!\n(k−1)!(N−k)!\n.\nProof.First","notice","that\nE\n[\nX\nk\nX\n>\nk\n1{X\n>\n1\nθ","<···<","X\n>\nk\nθ","<···<","X\n>\nN\nθ}\n]\n=E\nV\n[\nV","V\n>\nE\nX\n1:N\n/X\nk\n[\n1{X\n>\n1\nθ","<···<","X\n>\nk−1\nθ","<","V\n>\nθ","<","X\n>\nk+1\nθ","<···<","X\n>\nN\nθ}|V\n]]\nwhereX\n1:N\n/X\nk\ndenotesX\n1\n,...,X\nk−1\n,X\nk+1\n,...,X\nN\n.","Letψ(y)",":=P(X\n>\nθ≤y)denote","the","CDF","ofX\n>\nθ.","Then\nP\n(\nX\n>\n1\nθ","<···<","X\n>\nk−1\nθ","<","V\n>\nθ","<","X\n>\nk+1\nθ","<···<","X\n>\nN\nθ\n)\n=\nk−1\n∏\ni=1\nP\n(\nX\n>\ni\nθ≤V\n>\nθ\n)\n1\n(k−1)!\nN\n∏\ni=k+1\nP\n(\nX\n>\ni\nθ≥V\n>\nθ\n)\n1\n(N−k)!\n=\n1\n(k−1)!(N−k)!\nψ(V\n>\nθ)\nk−1\n(\n1−ψ(V\n>\nθ)\n)\nN−k\n.\nThen,","we","need","to","show","there","existsCsuch","that\nP\n(\nX\n>\n1\nθ","<···<","X\n>\nk−1\nθ","<","V\n>\nθ","<","X\n>\nk+1\nθ","<···<","X\n>\nN\nθ\n)\n≤CP\n(\nX\n>\n1\nθ","<","...","<","X\n>\nk\n′\n−1\nθ","<","V\n>\nθ","<","X\n>\nk\n′\n+1\nθ","<","...","<","X\n>\nN\nθ\n)\n+CP\n(\nX\n>\n1\nθ","<","...","<","X\n>\nN−k\n′\nθ","<","V\n>\nθ","<","X\n>\nN−k\n′\n+2\nθ","<","...","<","X\n>\nN\nθ\n)\nThat","is,\n1\n(k−1)!(N−k)!\nψ(V\n>\nθ)\nk−1\n(\n1−ψ(V\n>\nθ)\n)\nN−k\n≤\nC\n(k\n′\n−1)!(N−k\n′\n)!\n[\nψ(V\n>\nθ)\nk\n′\n−1\n(\n1−ψ(V\n>\nθ)\n)\nN−k\n′\n+ψ(V\n>\nθ)\nN−k\n′\n(\n1−ψ(V\n>\nθ)\n)\nk\n′\n−1\n]\nHence,\nC≥\n(k\n′\n−1)!(N−k\n′\n)!\n(k−1)!(N−k)!\n·\nψ(V\n>\nθ)\nk−1\n(\n1−ψ(V\n>\nθ)\n)\nN−k\nψ(V\n>\nθ)\nk\n′\n−1\n(1−ψ(V\n>\nθ))\nN−k\n′\n+ψ(V\n>\nθ)\nN−k\n′\n(1−ψ(V\n>\nθ))\nk\n′\n−1\nSinceψ(V\n>\nθ)∈[0,1],","we","have\nψ(V\n>\nθ)\nk−1\n(\n1−ψ(V\n>\nθ)\n)\nN−k\nψ(V\n>\nθ)\nk\n′\n−1\n(1−ψ(V\n>\nθ))\nN−k\n′\n+ψ(V\n>\nθ)\nN−k\n′\n(1−ψ(V\n>\nθ))\nk\n′\n−1\n≤1\nfor","allN,k,","andk\n′\n.","Hence,","forC=\n(k\n′\n−1)!(N−k\n′\n)!\n(k−1)!(N−k)!\n,","the","claim","holds.\nOther","Lemmas\nProposition","2.For","eachE\nt\n=","[\u000f\nt1\n,\u000f\nt2\n,...,\u000f\nt|S\nt\n|\n]\n>\n,‖E\nt\n‖≤\n√\n2.\nProof.Note","that","by","the","definition","of\u000f\nti\n,","we","have\n\u000f\nt1\n+\u000f\nt2\n+...+\u000f\nt|S\nt\n|\n=","0,and\u000f\nti\n∈[−1,1].(32)\nHence","the","vectorE\nt\nlies","within","the","bounded","hyperplane","in","(32).","Therefore,","the`\n2\nnorm‖E\nt\n‖=\n√\n\u000f\n2\nt1\n+\u000f\n2\nt2\n+...+\u000f\n2\nt|S\nt\n|\nis\nmaximized","at","the","corners","of","this","bounded","hyperplane,","i.e.,","for","somei,j∈S\nt\n,i6=j\n\u000f\nti\n=","1,\u000f\ntj\n=−1and\u000f\ntk\n=","0,for","allk6=i,k6=j,\nwhich","gives‖E\nt\n‖≤\n√\n2.\n\nLemma","22(Hoeffding’s","inequality).LetX\n1\n,...,X\nn\nbenindependent","random","variables","such","thatE[X\ni\n]","","=","","0and","almost\nsurely,X\ni\n∈[a\ni\n,b\ni\n],","for","alli.","Then","for","anynu",">0,\nP\n(\n∣\n∣\n∣\n∣\n∣\nn\n∑\ni=1\nX\ni\n∣\n∣\n∣\n∣\n∣\n>","ν\n)\n≤2","exp\n(\n−\n2ν\n2\n∑\nn\ni=1\n(b\ni\n−a\ni\n)\n2\n)\n.\nLemma","23(Tropp","(2012),","Corollary","5.2).Consider","a","finite","sequence{Y\nk\n}of","independent,","random,","self-adjoint","matrices","such\nthat","eachY\nk\nis","positive","semi-definite","andλ\nmax\n(Y\nk\n)≤Ralmost","surely.","Compute","the","minimum","and","maximum","eigenvalues","of\nthe","sum","of","expectations,\nμ\nmin\n:=λ\nmin\n(\n∑\nk\nE[Y\nk\n]\n)\nandμ\nmax\n:=λ\nmax\n(\n∑\nk\nE[Y\nk\n]\n)\nThen\nP\n{\nλ\nmin\n(\n∑\nk\nE[Y\nk\n]\n)\n≤(1−δ)μ\nmin\n}\n≤d·\n(\ne\n−δ\n(1−δ)\n1−δ\n)\nμ\nmin\n/R\nforδ∈[0,1]and\nP\n{\nλ\nmax\n(\n∑\nk\nE[Y\nk\n]\n)\n≤(1","+δ)μ\nmax\n}\n≤d·\n(\ne\nδ\n(1","+δ)\n1+δ\n)\nμ\nmax\n/R\nforδ≥0.\nPractical","Extensions\nIn","this","section,","we","briefly","discuss","some","of","the","widely","used","problem","settings","in","real-world","applications,","to","which","our","proposed\nalgorithms","can","be","efficiently","extended","or","reduced.\nPosition","Dependent","Offering\nIn","many","real-world","applications,","the","choices","of","items","are","affected","by","not","only","their","utilities","but","also","the","positions","where","they","are\ndisplayed","in","the","offered","assortment","(Ghose,","Ipeirotis,","and","Li","2014).","For","example,","in","a","brick-and-mortar","store,","items","displayed\nin","upper-shelf","positions","often","receive","more","attention","than","those","displayed","in","lower-shelf","positions.","Similarly,","in","an","online","store,\nitems","displayed","at","the","top","of","the","web","page","are","more","likely","to","be","clicked","or","purchased","than","those","displayed","at","the","bottom.","The\neffect","of","the","display","positions","is","usually","unknown","a","priori.\nIn","our","proposed","framework,","we","can","easily","incorporate","display","position","effect","by","including","a","categorical","variable","indicating\nthe","","display","","position.","","Hence,","","we","","need","","to","","estimate","","parameters","","corresponding","","to","","each","","display","","position.","","Suppose","","there","","areK\ndistinct","display","positions.","Letz\ntik\ndenote","the","upper","confidence","utility","for","itemiin","roundtin","display","positionk∈[K]and","let\nw\ntik\n:=","exp(z\ntik\n).","Then","the","optimal","assortment","choiceS\nt\n={(i,k)∈[N]×[K]",":φ\ntik\n=","1}can","be","given","by","the","solutions","of\nthe","following","optimization","problem:\nmax\n∑\ni∈[N],k∈[K]\nr\nti\nw\ntik\nφ\ntik\n1","+\n∑\nik\nw\ntik\nφ\ntik\ns.t.\n∑\ni\nφ\ntik\n≤1∀k∈[N]\n∑\nk\nφ\ntik\n≤1∀i∈[N]\nφ\ntik\n∈{0,1}","","∀i∈[N],k∈[K]\n(33)\nwhereφ\ntik\nis","the","decision","variable","indicating","itemiis","displayed","at","positionkat","roundt.","Note","that","the","constraints","satisfy","that\neach","position","displays","at","most1item,","and","each","item","is","displayed","at","most","once.\nProposition","3(Davis,","Gallego,","and","Topaloglu","2013).The","optimal","position","dependent","assortment","can","be","computed","by","solving\nan","LP.\nThe","proposition","states","that","our","algorithms","can","still","use","the","LP","solution","for","this","position","dependent","extension","of","the","combi-\nnatorial","optimization","problem.","To","see","this,","we","first","define","the","preference","weightw\nti\n(θ)","=","exp(x\n>\nti\nθ)under","some","parameterθ.\nRecall","that,","in","the","optimization","step,","we","are","indifferent","of","what","parameter","we","use,","i.e.","the","optimization","step","gives","the","optimizer\nsetS\nt\n⊂[N]which","maximizes","the","expected","revenue","given","any","parameter.","Therefore,","for","the","rest","of","this","section","we","will","use","the\nnotationw\nti\nfor","brevity","to","denote","the","preference","weight","given","some","parameter","at","roundt.\nFor","optimization","procedure,","we","define","the","decision","variableφ\nti\n∈","{0,1}such","thatφ\nti\n=","1if","itemiis","offered","at","roundt,\notherwiseφ\nti\n=","0.","Under","MNL,","if","the","item","offer","decisions","are","given","by","the","vectorφ\nt\n={φ\nti\n:i∈[N]}","∈","{0,1}\nN\n,","then","the\n\nuser","purchases","itemiwith","probabilityp\ni\n(φ\nt\n)","=\nw\nti\nφ\nti\n1+\n∑\nj∈[N]\nw\ntj\nφ\ntj\nwhere","1","in","the","denominator","again","represents","the","no-purchase\noption.","Then","we","can","rewrite","the","expected","revenue","as\nR\nt\n(φ\nt\n)","=\n∑\ni∈[N]\nr\nti\np\ni\n(φ\nt\n)","=\n∑\ni∈[N]\nr\nti\nw\nti\nφ\nti\n1","+\n∑\nj∈[N]\nw\ntj\nφ\ntj\nwherer\nti\nis","the","revenue","parameter","for","itemiat","roundt.","Based","on","the","cardinality","constraint","on","the","assortment,","The","feasible","set\nof","assortment","decisions","are","given","byF={φ\nt\n∈","{0,1}\nN\n:\n∑\ni∈[N]\nφ\nti\n≤K}.","Note","thatFdefined","here","is","a","special","case","of\ntotally","unimodular","constraint","matrix","for","which","(Davis,","Gallego,","and","Topaloglu","2013)","show","the","LP","formulation.","Then","our","goal\nis","to","find","a","set","of","feasible","items","to","offer","so","as","to","maximize","the","expected","revenue:\nR\n∗\nt\n=","argmax\nφ\nt\n∈F\nR\nt\n(φ\nt\n)(34)\nwhere","fromφ\n∗\nt\n=","argmax\nφ\nt\n∈F\nR\nt\n(φ\nt\n)we","can","get","the","assortmentS\nt\n={i∈[N]",":φ\nti\n=","1}.","Note","that","problem","(34)","has","a\nnonlinear","objective","function","and","integrality","requirements","on","its","decision","variables.","Theorem","1","in","(Davis,","Gallego,","and","Topaloglu\n2013)","shows","that","problem","(34)","is","equivalent","to","the","following","LP","problem:\nmax\n∑\ni∈[N]\nr\nti\nρ\nti\ns.t.\n∑\ni∈[N]\nρ\nti\n+ρ\nt0\n=","1\n∑\ni∈[N]\nρ\nti\nw\nti\n≤Kρ\nt0\n0≤\nρ\nti\nw\nti\n≤ρ\nt0\n(35)\nwhere","the","decision","variables","are{ρ\nti\n:i∈[N]∪{0}}.","In","this","LP","problem,","we","can","interpret","the","decision","variableρ\nti\n,i6=","0\nas","the","probability","that","the","user","purchases","itemiin","roundtandρ\nt0\nas","the","probability","that","the","user","makes","no","purchase.","The","first\nconstraint","ensures","that","in","each","round","a","user","purchases","at","most","1","item","in","the","assortment,","i.e.,","either","purchases","an","item","in","the","given\nassortment","or","purchase","none.\nFor","the","position","dependent","offering,","we","rewrite","the","maximization","problem","in","(34)","by","redefining","the","decision","variableφ\ntik\n∈\n{0,1}as","a","binary","variable","indicating","itemiis","displayed","at","positionkat","roundt.\nmax\n∑\ni∈[N],k∈[K]\nr\nti\nw\ntik\nφ\ntik\n1","+\n∑\ni,k\nw\ntik\nφ\ntik\ns.t.\n∑\ni\nφ\ntik\n≤1∀k∈[N]\n∑\nk\nφ\ntik\n≤1∀i∈[N]\nφ\ntik\n∈{0,1}","","∀i∈[N],k∈[K]\n(36)\nNote","that","the","constraints","satisfy","that","each","position","displays","at","most1item,","and","each","item","is","displayed","at","most","once.\nComparisons","with","previous","methods","on","position-dependent","offering.The","non-contextual","setting","in","(Agrawal","et","al.","2016,\n2017)","can","be","extended","to","incorporate","position","dependence;","however,","unlike","in","the","setting","here,","the","agent","must","offer","every\nitem","in","each","position","to","learn","the","effect","of","display","position.","Therefore,","the","extension","would","create","at","least","linearly","increased\namount","","of","","learning","","to","","their","","algorithm","","that","","is","","already","","not","","scalable","","for","","largeN.","","On","","the","","other","","hand,","","our","","proposed","","methods\nare","","able","","to","","learn","","the","","position","","effect","","across","","items.","","In","","(Chen,","","Wang,","","and","","Zhou","","2018),","","it","","is","","possible","","to","","include","","a","","categorical\nvariable","corresponding","to","display","position","as","part","of","context","vector;","however,","this","will","result","in","a","further","exponential","increase\nin","computational","complexity.","Moreover,","their","method","cannot","exploit","that","fact","that","the","assortment","optimization","problem","is","an\nLP","(see","the","discussion","on","Section",").\nTop-KSelection","with","User","Choice","Consideration\nThe","top-Kselection","problem","(Cao","et","al.","2015)","is","not","necessarily","an","extension","but","rather","a","special","case","of","the","MNL","bandit\nproblem","where","the","revenue","parameters","are","uniform.","Hence,","our","problem","reduces","to","findingKitems","which","have","the","highest\nutility","values.","Note","that","this","special","case","still","differs","from","other","variants","of","combinatorial","bandits","such","as","semi-bandits","and\ncascading","bandits","in","that","top-Kofferingmaystill","take","the","substitution","effect","into","account.","This","special","case","is","particularly\n\n02004006008001000\nTime","(t)\n0\n1\n2\n3\n4\n5\nCumulative","Regret\nN=50,","K=5,","d=10,","Gaussian\nTS-MNL","Gaussian\nTS-MNL","Optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n1\n2\n3\n4\n5\nCumulative","Regret\nN=100,","K=5,","d=10,","Gaussian\nTS-MNL","Gaussian\nTS-MNL","Optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0\n1\n2\n3\n4\n5\nCumulative","Regret\nN=200,","K=5,","d=10,","Gaussian\nTS-MNL","Gaussian\nTS-MNL","Optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nCumulative","Regret\nN=50,","K=10,","d=5,","Gaussian\nTS-MNL","Gaussian\nTS-MNL","Optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nCumulative","Regret\nN=100,","K=10,","d=5,","Gaussian\nTS-MNL","Gaussian\nTS-MNL","Optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\n02004006008001000\nTime","(t)\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nCumulative","Regret\nN=200,","K=10,","d=5,","Gaussian\nTS-MNL","Gaussian\nTS-MNL","Optimistic\nsupCB-MNL\nUCB-MNL\nDBL-MNL\nFigure","2:","The","regret","plots","show","that","the","proposed","algorithms,","UCB-MNL","and","DBL-MNL,","perform","at","start-of-the-art","levels\nacross","different","problem","instances.\nimportant","because","of","its","wide","range","of","applications.","For","example,","the","decision-making","agent","may","want","to","maximize","the","click-\nthrough","rate","(CTR)","on","a","website","where","each","click","is","weighted","uniformly.","A","notable","aspect","of","the","top-Kselection","problem","is\nthat","the","combinatorial","assortment","selection","step","reduces","to","a","sorting","task","based","on","estimated","utilities","in","our","proposed","algorithms,\nmaking","the","assortment","selection","procedure","much","more","computationally","efficient.","However,","(Chen,","Wang,","and","Zhou","2018)","still\nhas","to","enumerate","allNchooseKmany","assortments","and","construct","upper","the","confidence","bounds","of","utilities","for","each","of","the\nassortments","to","choose","the","items","even","in","this","setting.\nExperiment","Details","and","Additional","Results\nWe","consider","two","multivariate","distributions","for","feature","vectors:","a","multivariate","Gaussian","distribution","and","uniform","on","a","unit","sphere.\nFor","a","a","multivariate","Gaussian","distribution,","we","draw","eachx\nti\ni.i.d.","fromN(0\nd\n,I\nd\n).","Since","the","vanilla","version","of","MLE-UCB","is\nan","exponential-time","algorithm.","We","use","their","greedy","heuristic","version","which","does","not","provide","a","performance","guarantee.","For\nefficient","","evaluations,","","we","","consider","","uniform","","revenues,","","i.e.,r\nti\n=rfor","","alli.","","Therefore,","","the","","combinatorial","","optimization","","step\nreduces","to","sorting","items","according","to","its","utility","estimate.\nFor","each","instance,","we","generate","the","true","parameterθ\n∗\nfrom","a","uniform","distribution","in[0,1]\nd\nand","simulate","accordingly.","For","each\ncase","with","different","experimental","configurations,","we","conducted","20","independent","runs","for","each","instance,","and","report","the","average\nof","the","cumulative","regret","for","each","of","the","algorithms.","The","error","bars","represent","the","standard","deviations.","Note","that","each","instance","is\ngenerated","using","different","random","seeds.\nFigure","1","and","Figure","2","show","the","sample","results.","The","performance","of","UCB-MNL","and","DBL-MNL","are","superior","to","or","compa-\nrable","to","the","existing","method.","UCB-MNL","As","expected,SUPCB-MNL","that","relies","on","the","Auer-framework","Auer","(2002)","is","not\ncompetitive.","It","wastes","too","many","samples","for","random","exploration.","We","also","conduct","run-time","experiments","for","the","algorithms\nreported","in","Table","2.","We","observe","that","DBL-MNL","is","significantly","more","efficient","computationally","compared","to","the","other","methods\ndue","to","its","logarithmic","number","of","parameter","updates.","Note","thatSUPCB-MNL","has","a","pruning","assortment","step","which","can","be","com-\nputationally","expensive.","However,","for","uniform","revenues","(which","is","considered","in","the","experiments","shown","here),","this","procedure\ncan","be","performed","in","a","much","more","manageable","manner.","Furthermore,","in","our","experiments","almost","all","of","the","action","selections","of\nSUPCB-MNL","came","from","the","exploration","step","(which","explains","the","poor","performances),","and","therefore","the","run-time","was","reported\nsmaller","than","DBL-MNL","and","TS","methods,","but","this","may","not","be","true","in","general","once","the","pruning","step","is","used","more","often.","Overall,\nthe","experiments","show","that","both","UCB-MNL","and","DBL-MNL","can","learn","to","find","the","optimal","policy","quickly","while","DBL-MNL","is\nalso","very","efficient","computationally."],"doc0":["\n\narXiv:2103.14029v1","","[stat.ML]","","25","Mar","2021\nCausal","Inference","Under","Unmeasured","Confounding","With\nNegative","Controls:","","A","Minimax","Learning","Approach\nNathan","Kallus\n∗∗\nXiaojie","Mao\n∗\nMasatoshi","Uehara\n∗\nCornell","University\nAbstract\nWe","study","the","estimation","of","causal","parameters","when","not","all","confounders","are","observed","and\ninstead","negative","controls","are","available.","Recent","work","has","shown","how","these","can","enable","identifi-\ncation","and","efficient","estimation","via","two","so-called","bridge","functions.","In","this","paper,","we","tackle","the\nprimary","challenge","to","causal","inference","using","negative","controls:","the","identification","and","estimation\nof","these","bridge","functions.","Previous","work","has","relied","on","uniqueness","and","completeness","assumptions\non","these","functions","that","may","be","implausible","in","practice","and","also","focused","on","their","parametric","es-\ntimation.","Instead,","we","provide","a","new","identification","strategythat","avoids","both","uniqueness","and\ncompleteness.","And,","we","provide","a","new","estimators","for","these","functions","based","on","minimax","learn-\ning","formulations.","These","estimators","accommodate","general","function","classes","such","as","reproducing\nHilbert","spaces","and","neural","networks.","We","study","finite-sample","convergence","results","both","for","es-\ntimating","bridge","function","themselves","and","for","the","final","estimation","of","the","causal","parameter.","We\ndo","this","under","a","variety","of","combinations","of","assumptions","that","include","realizability","and","closedness\nconditions","on","the","hypothesis","and","critic","classes","employed","inthe","minimax","estimator.","Depending\non","how","much","we","are","willing","to","assume,","we","obtain","different","convergence","rates.","In","some","cases,\nwe","show","the","estimate","for","the","causal","parameter","may","converge","even","when","our","bridge","function\nestimators","do","not","converge","to","any","valid","bridge","function.","And,","in","other","cases,","we","show","we","can\nobtain","semiparametric","efficiency.\n1","","Introduction\nCausal","inference","from","observational","data","is","a","necessity","in","many","fields","where","experimentation","and\nrandomization","is","limited.","Even","when","experimentation","is","feasible,","observational","data","can","help\nsupport","initial","or","supplementary","investigations.","Compared","to","experimental-intervention","data,\nthe","key","difficulty","with","observational","data","is","confounding","or","endogeneity:","correlations","between\nobserved","actionsAand","outcomesYthat","are","not","due","to","a","causal","relationship,","as","might","be\ninduced","by","common","causes","such","as","a","healthy","lifestyle","leadingto","both","selection","into","treatment\nand","good","health","outcomes.","A","common","identification","strategy","is","to","control","for","many","baseline\ncovariates","and","assume","they","fully","account","for","all","such","commoncauses,","termed","unconfoundedness,\nignorability,","or","exchangeability.","However,","in","practice,","it","is","dubious","that","all","confounders","are","ever\ntruly","accounted","for,","casting","doubt","on","any","resulting","conclusion.\nWhen","some","confounders","are","unobserved,","an","alternative","identification","strategy","is","to","use\nnegative","controls[Miao","et","al.,","2018a,b,","Tchetgen","et","al.,","2020,","Cui","et","al.,","2020,","Deaner,","2021,\nShi","et","al.,","2020].","Negative","controls","are","observed","covariates","that","have","a","more","restricted","relation-\nship","with","the","action","and","outcome:negative","control","actionsdo","not","directly","impact","the","outcome\nof","interest","andnegative","control","outcomesare","not","directly","impacted","by","either","the","negative","control\nactions","or","the","primary","action","of","interest.","See","Fig.","1","for","a","typical","causal","diagram.","When","these\nnegative","control","variables","are","sufficiently","informative","about","the","unmeasured","confounders,","there\n∗\nAlphabetical","order.\n1\n\nexist","the","so-calledbridge","functionsthat","enable","identification","and","estimation","of","causal","quantities.\nThese","bridge","functions","are","the","analogues","to","the","propensity","and","outcome","regression","functions\none","would","use","if","all","confounders","were","observed.\nLearning","these","bridge","functions,","however,","is","a","nontrivial","task,","as","it","no","longer","amounts","to\na","regression","problem","as","in","the","unconfounded","case,","which","can","be","outsourced","to","standard","ma-\nchine","learning","methods.","Cui","et","al.","[2020]","recently","studied","the","semiparametric","efficiency","of","the\nnegative","control","method","and","proposed","a","doubly","robust","approach,","but","they","focused","on","para-\nmetric","estimates,","which","may","be","too","restrictive","in","practice.Moreover,","their","analysis","relied","on\nthe","bridge","functions’uniqueness,","which","may","be","dubious","in","practice","and","even","refutable","in","many\nexamples.","It","also","required","certain","completeness","assumptions.","In","this","paper,","we","tackle","these\npractical","challenges","to","estimation","with","negative","controlsby","relaxing","such","uniqueness","and","com-\npleteness","assumptions","and","introducing","new","minimax","estimators","for","the","bridge","functions","that\nare","amenable","to","general","function","approximation,","in","the","spirit","of","agnostic","machine","learning.","We\ncatalog","a","variety","of","settings","in","which","the","functions","are","learnable","and","estimation","with","negative\ncontrols","is","practically","feasible.\nOur","contributions","are:\n•","We","introduce","a","new","identification","method,","which","relaxes","several","previous","assumptions","in-\ncluding","the","uniqueness","of","bridge","functions","and","certain","completeness","conditions.","We","also\nconsider","a","more","general","setting","than","average-effect","estimation,","where","we","allow","counterfac-\ntual","actions","to","be","possibly","stochastic","and","the","action","space","to","be","possibly","continuous.\n•","We","propose","new","estimators","for","bridge","functions","(even","if","nonunique)","by","introducing","an\nadversarial","critic","function","and","formulating","the","learning","problem","as","a","minimax","game.","Our\nminimax","approach","accommodate","the","use","of","any","type","of","flexible","function","class","such","as","repro-\nducing","kernel","Hilbert","spaces","(RKHS)","and","neural","networks.","Then,","by","plugging","these","bridge\nfunctions","estimators","into","different","estimating","equations,we","derive","our","final","estimators.\n•","We","provide","finite","sample","convergences","results","under","a","variety","of","different","assumptions","(see\nTable","1).","One","important","assumption","is","the","well-specification","of","the","hypothesis","classes,\nwhich","we","callrealizability.","Another","assumption,","which","we","callclosedness,","ensures","that","the\ncritic","classes","in","our","minimax","estimators","are","sufficiently","rich.","Depending","on","how","much","of\nthese","we","are","willing","to","assume,","we","obtain","different","convergence","rates","for","the","final","estimator.\nOne","surprising","result","is","that","when","we","assume","realizability","of","both","bridges","and","critics,","our\nestimator","is","consistent","even","though","the","bridge","functions","themselves","are","not","consistently\nestimated","(see","row","I","in","Table","1).\n2","","Setup\nWe","consider","an","actionA∈","Athat","can","be","discrete","or","continuous.","We","associateAwith","a","base\nmeasureμ;e.g.,","the","counting","measure","ifAis","finite","or","Lebesgue","measure","ifAis","continuous.","Let\nY(a)denote","the","real-valued","counterfactual","outcome","that","would","be","observed","if","the","action","were\nset","toa∈","AandY=Y(A)be","the","observed","outcome","corresponding","to","the","actually","observed\naction.","Moreover,","letX∈","X","⊆R\nd\nbe","a","collection","of","observed","covariates.","For","a","given","contrast\nfunctionπ:A×X","7→R,","we","are","interested","in","estimating","thegeneralized","average","causal","effect\n(GACE):\nJ=E\n\u0014\nZ\nY(a)π(a|X)dμ(a)\n\u0015\n.(1)\nExample","1(Average","treatment","effect).ConsiderA={0,1}.","We","are","interested","in","the","effect\nof","“treatment”A=","1compared","to","“control”A=","0.","","Lettingπ(a|x)","=","2a−1we","obtain\nJ=E[Y(1)−Y(0)],","known","as","the","average","treatment","effect","(ATE).\nExample","2(Target-population","ATE).In","the","same","setting","as","Example","1","ifκ(x)is","the","Radon-\nNikodym","derivative","of","the","distribution","ofXin","some","target","population","with","respect","to","(wrt)\nthe","data","distribution","ofX,","then","settingπ(a|x)","=","(2a−1)κ(x),Jis","the","ATE","on","the","target\npopulation.\n2\n\nTable","1:","Convergence","rates","of","different","GACE","estimators","under","different","assumptions","(ignoring\npolylogs).","","The","key","identification","assumptions,","Assumptions","1","and","2,","are","always","assumed.","","The\nsetsH\nobs\n0\n,Q\nobs\n0\ndenote","the","sets","of","observed","bridge","functions","(see","Lemma","3).","The","function","classes\nH,Q\n′\nare","used","to","construct","the","estimator\nˆ\nhfor","the","outcome","bridge","functionh\n0\n∈H\nobs\n0\nandQ,H\n′\nto","construct","the","estimatorˆqfor","the","action","bridge","functionq\n0\n∈Q\nobs\n0\n.","","We","here","summarize","our\nconclusions","when","all","relevant","function","classes","are","Hölder","balls","ofα-times","differentiable","functions\nover","ad-dimensional","domain.","","“Est.”","","refers","to","which","estimating","equation","is","used","for","the","final\nestimator","(see","Section","4.4).","“Sta.\"","refers","to","whether","the","bridge","function","estimators","use","stabilizers\n(see","Section","4).","“Uni.”","refers","to","whether","we","assume","bridge","functions","are","unique.","The","projection\noperatorsP\nz\nandP\nw\nare","defined","in","Eq.","(8),","andP\nu\n:L\n2\n(W,","Z,","A,","X)→L\n2\n(U,","A,","X)is","defined","as\nP\nu\n(g(W,","Z,","A,","X))","=E[g(W,","Z,","A,","X)|U,","A,","X].\nMain","AssumptionsEst.Rate","wrtnSta.","Uni.","Note\nI\nQ\nobs\n0\n∩Q6=∅,H\nobs\n0\n∩H\n′\n6=∅\nIPW\nn\n−min(\n1\n2\n,\nα\nd\n)\nNo","","No\nˆ\nh,ˆqgenerally","do","not\nconverge","to","any\nh\n0\n∈H\nobs\n0\n,\nq\n0\n∈Q\nobs\n0\n.\nH\nobs\n0\n∩H6=∅,πQ\nobs\n0\n∩Q\n′\n6=∅\nREG\nQ\nobs\n0\n∩Q6=∅,H\nobs\n0\n∩{h:h−H⊆H\n′\n}6=\n∅\nDR\nH\nobs\n0\n∩H6=∅,Q\nobs\n0\n∩{q:π(q−Q)⊆\nQ\n′\n}6=∅\nDR\nII\nQ\nobs\n0\n∩Q6=∅,πP\nw\n(Q−Q\nobs\n0\n)⊆H\n′\nIPW\nn\n−\nα\n2α+d\nYes\nNo\nkπP\nw\n(ˆq−q\n0\n)k\n2\n→0\nfor","anyq\n0\n∈Q\nobs\n0\n.\nor","DR\nn\n−min(\n1\n4\n,\nα\n2d\n)\nNo\nIII\nH\nobs\n0\n∩H6=∅,P\nz\n(H−H\nobs\n0\n)⊆Q\n′\nREG\nn\n−\nα\n2α+d\nYes\nNo\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n→0\nfor","anyh\n0\n∈H\nobs\n0\n.\nor","DR\nn\n−min(\n1\n4\n,\nα\n2d\n)\nNo\nIV\nAssumptions","in","rows","II","and","III,\nDR\nmax(n\n−\n1\n2\n,\nτ\n2\n1\nn\n−\n2α\n2α+d\n)\nYes","","No\nFaster","than","row","I","if\nτ\n2\n1\n=o(n\nα(d−2α)\nd(2α+d)\n).\nkP\nu\n(ˆqπ−q\n0\nπ)k\n2\n≤τ\n1\nkP\nw\n(ˆqπ−q\n0\nπ)k\n2\n,\nkP\nu\n(\nˆ\nh−h\n0\n)k\n2\n≤τ\n1\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\nAssumptions","in","rows","II","and","III,\nDR\nmax(n\n−\n1\n2\n,\nτ\n2\nn\n−\n2α\n2α+d\n)\nYes","","Yes\nAchieves","efficiency\nifτ\n2\n=o(n\n2α−d\n2(2α+d)\n).\nkˆqπ−q\n0\nπk\n2\n≤τ\n2\nkP\nw\n(ˆqπ−q\n0\nπ)k\n2\n,\nk\nˆ\nh−h\n0\nk\n2\n≤τ\n2\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\nExample","3(Policy","evaluation).Ifπ(a|x)is","a","density","onAfor","eachxwrtμ,","thenJis","the\naverage","outcome","we","experience","when","we","follow","the","policy","thatassigns","an","action","drawn","from\nπ(·","|X)for","an","individual","with","covariatesX[Tian,","2008,","Dudik","et","al.,","2014,","Kennedy,","2019,\nMuñoz","and","Van","Der","Laan,","2012].","","The","measureμis","the","Lebesgue","measure","when","the","action\nspace","is","continuous,","and","is","the","counting","measure","when","the","action","space","is","discrete.","A","special\ncase","of","this","is","deterministic","interventions","whereπ(·|x)is","Dirac","at","one","action.\n1\nWedo","notassume","that","the","observed","covariatesXinclude","all","confounders","that","affect","both\nthe","action","and","the","potential","outcomes,","and","instead","there","exist","someunmeasuredconfounders\nU∈U","⊆R\np\nu\n(discrete,","continuous,","or","mixed):\nY(a)6⊥A|X,butY(a)⊥A|U,X.\nIfUwere","observed,","we","could","identify","the","GACEJsimply","by","controlling","for","bothX,U.\nHowever,","in","this","paper","we","assume","that","confoundersUcannotbe","observed,","in","which","case,","the\nGACEJis","generallyunidentifiablefrom","the","distribution","of","the","observed","variables(Y,X,A)\nalone.","","To","overcome","the","challenge","of","unmeasured","confounding,","in","this","paper","we","employ","the\nnegative","control","framework","proposed","in","Miao","et","al.","[2018a],Cui","et","al.","[2020],","Miao","et","al.","[2018b],\nDeaner","[2021],","Tchetgen","et","al.","[2020].","This","framework","involves","two","additional","types","of","observed\nvariables:","negative","control","actionsZ∈Z","⊆R\np\nz\nand","negative","control","outcomesW∈W","⊆R\np\nw\n,\n1\nWhen","the","action","space","is","discrete,","we","can","estimate","both","stochastic","and","deterministic","policies.","When","the","action\nspace","is","continuous,i.e.,μis","Lebesgue,","we","only","deal","with","stochastic","polices","in","this","paper","since","otherwise","they","do","not\nhave","valid","densities","wrtμ.\n3\n\nX\nU\nZW\nAY\nFigure","1:","A","typical","causal","diagram","for","negative","controls.","The","dashed","edges","may","be","absent,","and","the\ndashed","circle","aroundUindicates","thatUis","unobserved.\nwhich","can","be","discrete,","continuous,","or","mixed.","These","variables","are","called","“negative”","controls","due\nto","the","assumed","absence","of","certain","causal","effects:","negative","control","actions","cannot","directly","affect\nthe","outcomeY,","and","neither","negative","control","actionsZnor","the","primary","actionAcan","affect","the\nnegative","control","outcomesW.","Meanwhile,","these","variables","are","still","relevant","control","variables","as\nthey","are","related","to","the","unmeasured","confounders.","We","can,","in","a","sense,","view","them","as","proxies","for\nthe","unmeasured","confoundersU.\nFig.","1","shows","a","typical","causal","diagram","for","this","setting.","To","formalize","our","setting","and","allow","for\nmore","generality,","however,","we","will","rely","on","potential","outcomenotation.","LetY(a,z)andW(a,z)\ndenote","the","corresponding","counterfactual","outcomes","one","would","observe","had","the","primary","action\nand","negative","control","action","taken","value(a,z)∈A×Z.","We","then","formalize","the","negative","control\nassumptions","as","follows.\nAssumption","1(Negative","Controls).1.","Consistency:Y=Y(A,Z),W=W(A,Z).\n2.","Negative","control","actions:Y(a,z)","=Y(a),∀a∈A.\n3.","Negative","control","outcomes:W(a,z)","=W,∀a∈A,z∈Z.\n4.","Latent","unconfoundedness:(Z,A)⊥(Y(a),W)|U,X,∀a∈A.\n5.","Overlap:|π(a|x)/f(a|x,u)|<∞,∀a∈A,x∈X,u∈U.\nHere","condition","1","encodes","SUTVA","and","no","interference","across","units","[Imbens","and","Rubin,","2015].\nConditions","2","and","3","paraphrase","the","definition","of","negative","controls","in","terms","of","the","potential\noutcome","notation:","the","negative","control","actionZcannot","affect","the","primary","outcomeY,","and","the\nnegative","control","outcomeWcannot","be","affected","by","either","the","primary","actionAor","the","negative\ncontrol","actionZ.","","In","particular,","condition","2","ensures","the","potential","outcomeY(a)referred","to\nin","our","estimand","in","Eq.","(1)","is","well-defined.","","Condition","4","formalizes","the","assumption","that","the\nunmeasured","variablesUcaptures","all","common","causes","of(A,Z)and(Y,W)not","included","in\nX.","","Other","causal","diagrams","other","than","Fig.","1","may","also","satisfy","condition","4","(see","table","A.1","of\nTchetgen","et","al.,","2020).","Condition","5","requires","sufficient","overlap","between","the","contrast","functionπ\nand","the","distribution","of","observed","actions","given","both","observed","and","unobserved","confounders.","This\nis","a","canonical","assumption","in","causal","inference","and","policy","evaluation.\nOur","data","consist","ofnindependent","and","identically","distributed","(iid)","observations","of(Z,X,W,A,Y).\nCrucially,Uisunobserved.","And,","our","aim","is","to","estimate","the","GACEJfrom","these","data.\nNotationWe","letEdenote","expectations","wrt(Z,X,W,A,Y),","andE\nn\ndenote","empirical","average\nover","thenobservations","thereof.","","For","a","functiongof(z,x,w,a,y)(or","a","subset","thereof)","we\noften","writegto","mean","the","random","variableg(Z,X,W,A,Y).","ForOmeasurable","with","respect\nto(Z,X,W,A,Y),","we","letL\n2\n(O)denote","the","space","of","square-integrable","functions","of","a","variable\nO.","Thus,e.g.,L\n2\n(W,A,X)andL\n2\n(Z,A,X)denote","the","space","of","square-integrable","functions","of\nW,A,XandZ,A,X,","respectively.","For","a","functiong,","we","letkgk\n2\ndenote","the","norm","in","these","spaces.\nFor","a","vectorθ,","we","letkθkdenote","the","Euclidean","norm.","We","letk·k\n∞\ndenote","the","sup","norm","of","either\na","variable","or","function,","and","for","a","class","of","functions","we","let","it","denote","the","largest","norm","in","the","class.\n4\n\nFor","subsetsA,Bof","a","field,","we","defineA+B={a+b:a∈A,b∈B},AB={ab:a∈A,b∈B}.\nWe","call","a","subsetSof","a","linear","space","symmetric","if−s∈Sfor","anysinS,","and","we","callSif\nstar-shaped","(around","the","origin)","ifαs∈S∀s∈S,α∈[0,1].","Finally,","we","often","useO(·)notation\nto","denote","rates","wrtn.","When","we","use","it","in","different","ways,","we","explain","the","meaning.\n3","","Identifying","GACE","via","Bridge","Functions\nIn","this","section","we","discuss","identification","and","define","the","bridge","functions.\n3.1","","The","Ideal","Unconfounded","Setting\nIf","the","unobserved","confoundersUwereobserved,","then","the","GACEJcould","be","identified,","that\nis,","it","can","be","written","as","a","function","of","the","distribution","of(Y,A,X,U).","To","illustrate","this,","define\nthe","regression","functionk\n0\n(a,u,x)","=E[Y|A=a,X=x,U=u],","and","define","the","generalized\npropensity","scoref(a|u,x)as","the","conditional","density","of","the","distributionA|X,Urelative","to","the\nbase","measureμ[Hirano","and","Imbens,","2004].","Based","on","these","two","functions,","thefollowing","lemma\nshows","the","identification","ofJifUwereobserved","using","three","different","formulations.\nLemma","1.IfY(a)⊥A|U,Xand|π(a|x)/f(a|x,u)|<∞for","anya∈A,x∈X,u∈U,","then\nJ=E[φ\nIPW\n(Y,A,U,X)]","=E[φ\nREG\n(Y,A,U,X)]","=E[φ\nDR\n(Y,A,U,X)],\nwhereφ\nIPW\n(y,a,u,x;f)","=\nπ(a|x)\nf(a|x,u)\ny,\nφ\nREG\n(y,a,u,x;k\n0\n)","=\nZ\nk\n0\n(a\n′\n,u,x)π(a\n′\n|x)dμ(a\n′\n),\nφ\nDR\n(y,a,u,x;k\n0\n,f)","=\nπ(a|x)\nf(a|x,u)\n(y−k\n0\n(a,u,x))","+\nZ\nk\n0\n(a\n′\n,u,x)π(a\n′\n|x)dμ(a\n′\n).\nLemma","1","also","suggests","estimators","forJifUwere","observed:","we","can","first","estimate","the","nuisance\nfunctionsk\n0\n(a,u,x)and/orf(a|u,x),","and","then","estimateJby","using","any","of","the","three","estimating\nequations","above","with","the","estimated","nuisance(s).","The","resulting","three","estimators","are","called","the\ninverse","propensity","weighting","(IPW)","estimator,","the","regression-based","(REG)","estimator,","and","the\ndoubly","robust","(DR)","estimator,","respectively","[e.g.,","Robins","et","al.,","1994,","Dudik","et","al.,","2014].\n3.2","","The","Negative-Control","Setting\nHowever,","in","this","paper","we","deal","with","the","setting","whereUisunobserved,","so","these","estimators","are\ninfeasible.","In","particular,","neitherk\n0\n(a,u,x)norf(a|u,x)can","be","identified.","Instead,","we","can","use\nthe","negative","controlsZ,Wto","proxy","these","two","functions","via","thebridge","functions[Miao","et","al.,\n2018b,","Cui","et","al.,","2020].\nAssumption","2(Bridge","functions).There","exist","functionsh\n0\nandq\n0\ns.t.h\n0\n∈L\n2\n(W,A,X)and\nπq\n0\n∈L\n2\n(Z,A,X)and","the","following","holds","almost","surely:\nE[h\n0\n(W,A,X)|A,U,X]","=k\n0\n(A,U,X),(2)\nE[π(A|X)q\n0\n(Z,A,X)|A,U,X]","=\nπ(A|X)\nf(A|U,X)\n.(3)\nAssumption","2","implies","that","a","functionh\n0\nof","the","negative","control","outcomesWand","another\nfunctionq\n0\nof","the","negative","control","actionsZcan","play","a","similar","role","as","the","regression","function\nk\n0\nand","the","generalized","propensity","scoref,","respectively","(see","Lemma","2","below).","Here","we","callh\n0\ntheoutcome","bridge","functionandq\n0\ntheaction","bridge","function.","Note","we","only","assume","that","such\nbridge","functions","exist,","but","they","may","benonunique.","In","contrast,","many","previous","negative","control\nliterature","assume","the","uniqueness","of","bridge","functions,","either","explicitly","or","as","a","consequence","of\nother","assumptions","[e.g.,","Miao","et","al.,","2018b,","Cui","et","al.,","2020].","See","more","discussion","inSection","7\nand","Appendix","B.\n5\n\nThe","existence","of","bridge","functions","depends","on","the","relationship","between(Y,Z,W)and","the\nunmeasured","confoundersU.","","Generally,","such","bridge","functions","exist","only","when","the","negative\ncontrol","proxiesZ,Waresufficiently","informativeabout","the","unmeasured","confoundersU.\nExample","4(Discrete","setting).Suppose","the","variablesW,Z,A,Uare","all","discrete","variables","with\nvaluesw\ni\n,z\nj\n,u\ns\nfori=","1,...,|W|,j=","1,...,|Z|,s=","1,...,|U|.","LetP(W|U,a,x)denote\na|W|×|U|matrix","whose(i,s)th","element","isP[W=w\ni\n|U=u\ns\n,A=a,X=x],P(Z|U,a,x)\na|Z|×|U|matrix","whose(j,s)th","element","isP[Z=z\nj\n|U=u\ns\n,A=a,X=x],E[Y|U,a,x]a\n1×|U|vector","whosesth","element","isE[Y|U=u\ns\n,A=a,X=x],F(a|U,x)a|U|×|U|diagonal\nmatrix","whosesth","diagonal","element","isf(a|u\ns\n,x),","andea|U|×1vector","of","all","ones.\nWith","these","notations,","Eqs.","(2)","and","(3)","translates","into","the","following","linear","equation","system:\nh\n⊤\n0\n(W,a,x)P(W|U,a,x)","=E[Y|U,a,x].\nq\n⊤\n0\n(Z,a,x)P(Z|U,a,x)F(a|U,x)","=e\n⊤\n,\nIt","is","easy","to","show","that","ifP(W|U,a,x)andP(Z|U,a,x)have","full","column","rank","(which","implies\nthat|W|","≥","|U|and|Z|","≥","|U|)","andf(a|u,x)>0for","anyu∈","U,","then","the","linear","equations\nsystem","above","have","solutions,","that","is,","the","bridge","functions","exist.","","However,","the","solutions","are\ngenerallynonunique,","unless|W|=|Z|=|U|so","thatP(W|U,a,x)andP(Z|U,a,x)are\ninvertible","square","matrices.\nExample","5(Linear","Model).Suppose(Y,W,Z,A)are","generated","from","as","follows:\nY=α\n⊤\nY\nU+β\n⊤\nY\nX+γ\n⊤\nY\nA+ω\n⊤\nY\nW+ǫ\nY\n,\nZ=α\nZ\nU+β\nZ\nX+γ\nZ\nA+ǫ\nZ\n,\nW=α\nW\nU+β\nW\nX+ǫ\nW\n,\nA∼Unif\n\u0010\nα\n⊤\nA\nU+β\n⊤\nA\nX,\nα\n⊤\nA\nU+β\n⊤\nA\nX\n\u0011\n,\nwhereǫ\nY\n,ǫ\nZ\n,ǫ\nW\nare","independent","mean-zero","random","noises","that","are","also","independent","with\n(A,U,X).\nSuppose","thatα\nZ\n∈R\np\nz\n×p\nu\n,α\nW\n∈R\np\nw\n×p\nu\nboth","have","full","column","rank.","Then","we","can","show\nthat","bridge","functionsh\n0\nandq\n0\nalways","exist:\nh\n0\n(W,A,X)","=","(θ\nW\n+ω\nY\n)\n⊤\nW+\n\u0010\nβ\nY\n−θ\n⊤\nW\nβ\nW\n\u0011\nX+γ\nY\nA,∀θ\nW\ns.t.θ\n⊤\nW\nα\nW\n=α\n⊤\nY\n,\nq\n0\n(Z,A,X)","=θ\n⊤\nZ\nZ+\n\u0010\nβ\nA\n−β\nA\n−θ\n⊤\nZ\nβ\nZ\n\u0011\nX−θ\n⊤\nZ\nγ\nZ\nA,∀θ\nZ\ns.t.θ\n⊤\nZ\nα\nZ\n=\nα\n⊤\nA\n−α\n⊤\nA\n.\nObviously,","the","outcome","bridge","functionh\n0\nis","nonunique","ifp\nw\n>","p\nu\nand","the","action","bridge","function\nq\n0\nis","nonunique","ifp\nz\n>","p\nu\n.\nExample","6.More","generally,","when","we","do","not","have","parametric","models","for","thedata","generating\nprocess","as","we","do","in","Examples","4","and","5,","we","need","to","otherwise","ensure","the","existence","of","solutions","to\nconditional","moment","equations","in","Eqs.","(2)","and","(3).","These","conditional","moment","equations","define\ninverse","problems","known","as","Fredholm","integral","equations","of","the","first","kind.","The","existence","of","their\nsolutions","can","be","rigorously","characterized","by","Picard’s","theorem","[Kress,","2014,","Carrasco","et","al.,\n2007].","","Following","Miao","et","al.","[2018a],","we","show","in","Appendix","B.1that","under","some","additional\nregularity","conditions","on","the","singular","value","decompositionof","the","linear","operators","associated\nwith","the","Fredholm","integral","equations,","the","existence","of","solutions","to","Eqs.","(2)","and","(3)","can","be\nensured","by","the","following","completeness","conditions:","for","anyg(U,A,X)∈L\n2\n(U,A,X),\nE[g(U,A,X)|Z,A,X]","=","0only","wheng(U,A,X)","=","0,\nE[g(U,A,X)|W,A,X]","=","0only","wheng(U,A,X)","=","0.\nThese","completeness","conditions","mean","that","the","negative","controlsZ,Whave","sufficient","variability\nrelative","to","the","variability","of","the","unobserved","confoundersU.","In","this","paper","we","only","explicitly\nrely","on","the","minimal","assumption","of","the","existence","of","bridge","functions,","rather","than","such","stronger\ncompleteness","conditions","and","additional","regularity","conditions","that","might","imply","their","existence.\n6\n\nOur\nstrategy:\nDefine","bridge","functions\nbyH\n0\n6=∅,Q\n0\n6=∅\nH\n0\n⊆H\nobs\n0\n,Q\n0\n⊆Q\nobs\n0\n(Lemma","3)\nJis","identified","byH\nobs\n0\n,\nQ\nobs\n0\n(Lemmas","4","and","5)\nPrevious\nstrategies:\nDefine","bridge","functions\nbyH\nobs\n0\n6=∅,Q\nobs\n0\n6=∅\nAssume","completenessso\nthatH\nobs\n0\n⊆H\n0\n,Q\nobs\n0\n⊆Q\n0\nJis","identified","by\nH\n0\n,Q\n0\n(Lemma","2)\nFigure","2:","Different","identification","strategies.","Without","any","assumptions,","what","we","can","identify","from\nthe","data","isH\nobs\n0\n,Q\nobs\n0\nbut","notH\n0\n,Q\n0\n.","See","relevant","discussions","below","Lemma","5.\nExamples","4","and","5","illustrate","that","bridge","functions,","besides","existing,","are","nonunique","if","the\nnegative","control","proxies","carry","more","information","than","the","unmeasured","confounders,","namely,\nwhen","the","negative","controls","have","more","values","than","the","unmeasured","confounders","in","Example","4,\nor","when","the","dimension","of","negative","controls","exceeds","the","dimension","of","the","unmeasured","confounders\nin","Example","5.","Since","unmeasured","confounders","are","unobserved","in","practice,","we","may","tend","to","use\nas","many","negative","control","variables","as","possible","to","safeguardthe","existence","of","bridge","functions.\nBut","this","may","also","cause","bridge","functions","to","be","nonunique.","Therefore,","the","assumption","of","unique\nbridge","functions","imposed","in","previous","literature","[e.g.,","Miao","et","al.,","2018b,","Cui","et","al.,","2020]","may","be\ntoo","strong.","In","contrast,","our","paper","allows","for","nonunique","bridge","functions,","and","assumes","uniqueness\nonly","when","it","is","needed","to","derive","stronger","theoretical","guarantee.\nAssumption","2","can","be","equivalently","stated","as","saying","that","the","following","partial","identification\nsets","of","bridge","functions","are","nonempty","sets:\nH\n0\n={h∈L\n2\n(W,A,X)",":E[Y−h(W,A,X)|A,U,X]","=","0}6=∅,\nQ\n0\n={q:πq∈L\n2\n(Z,A,X)E[π(A|X)","(q(Z,A,X)−1/f(A|U,X))|A,U,X]","=","0}6=∅.\n(4)\nAgain,","bridge","functions","may","be","nonunique","so","these","two","partial","identification","sets","may","each\ncontain","more","than","one","element.","The","lemma","below","shows","thatanyvalid","bridge","function","in","these\npartial","identification","sets","can","identifyJ.\nLemma","2.LetO=","(Y,W,Z,A,X)be","the","observed","variables","andT:L\n2\n(W,A,X)→L\n2\n(W,X)\nbe","the","linear","operator","defined","by(Th)(w,x)","=\nR\nh(w,a,x)π(a|x)dμ(a).","Under","Assumptions","1\nand","2,","for","anyh\n0\n∈H\n0\nandq\n0\n∈Q\n0\n,\nJ=E\nh\n","̃\nφ\nIPW\n(O;q\n0\n)\ni\n=E\nh\n","̃\nφ\nREG\n(O;h\n0\n)\ni\n=E\nh\n","̃\nφ\nDR\n(O;h\n0\n,q\n0\n)\ni\n,\nwhere\n","̃\nφ\nIPW\n(O;q\n0\n)","=π(A|X)q\n0\n(Z,A,X)Y,\n","̃\nφ\nREG\n(O;h\n0\n)","=","(Th\n0\n)(X,W),\n","̃\nφ\nDR\n(O;h\n0\n,q\n0\n)","=π(A|X)q\n0\n(Z,A,X)","(Y−h\n0\n(W,A,X))","+","(Th\n0\n)(X,W).\nNote","that","the","estimating","equations","in","Lemma","2","simply","replacethe","regression","function\nk\n0\n(A,X,U)and","the","inverse","propensity","score","weight1/f(A|X,U)in","Lemma","1","by","the","bridge\nfunctionsh\n0\n(W,A,X)andq\n0\n(Z,A,X).","Since","the","latter","only","depends","on","observed","variables,\nas","long","as","we","can","learnanypair","of","bridge","functions,","we","can","use","the","estimating","equations","in\nLemma","2","to","estimateJ.\n3.3","","Learning","Bridge","Functions","from","Observed","Data\nAssumption","2","defines","the","bridge","functions","in","terms","of","conditional","moment","equations\n2\ngiven","the\nunobserved","confoundersU,","so","we","cannot","use","it","directly","to","learn","the","bridge","functions","from","the\nobserved","data.","Neverthelss,","the","following","lemma","shows","thatthe","bridge","functions","also","satisfy\nanalogous","conditional","moment","equations","based","on","only","observed","data.\n2\nEquations","(3)","and","(6)","do","not","exactly","fall","into","the","usual","conditional","moment","equation","framework","[e.g.,","Ai","and","Chen,\n2003],","since","they","involve","unknown","density","functionsf(A|U,","X),","f(A|W,","X),","respectively.","We","still","call","it","a","conditional\nmoment","equation","for","simplicity,","but","estimatingq\n0\ndoes","require","more","care.","See","discussion","below","Lemma","6.\n7\n\nLemma","3.Under","Assumptions","1","and","2,","anyh\n0\n∈H\n0\nandq\n0\n∈Q\n0\nsatisfy","that\nE[Y−h\n0\n(W,A,X)|Z,A,X]","=","0,(5)\nE[π(A|X)","(q\n0\n(Z,A,X)−1/f(A|W,X))|W,A,X]","=","0.(6)\nThe","conditional","moment","equations","in","Eqs.","(5)","and","(6)","give","rise","to","the","following","alternative\nsets","of","functions","that","we","can","possibly","learn","from","observed","data,","whose","elements","we","callobserved\nbridge","functions:\nH\nobs\n0\n={h∈L\n2\n(W,A,X)",":E[Y−h(W,A,X)|Z,A,X]","=","0},\nQ\nobs\n0\n={q:πq∈L\n2\n(Z,A,X),E[π(A|X)","(q(Z,A,X)−1/f(A|W,X))|W,A,X]","=","0}.\nAccording","to","Lemma","3,H\n0\n⊆H\nobs\n0\nandQ\n0\n⊆Q\nobs\n0\n.","So,","under","Assumption","2,H\nobs\n6=∅,Q\nobs\n6=∅.\nThe","following","lemma","shows","that,","as","long","as","some","nominal","bridge","functions","exist,i.e.,H\n0\n6=\n∅,Q\n0\n6=∅,","thenanypair","of","bridge","functions","inH\nobs\n0\nandQ\nobs\n0\ncanalsoidentifyJeven","if","they\nare","not","inH\n0\n,Q\n0\n.\nLemma","4.Under","Assumptions","1","and","2,","for","anyh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n,\nJ=E\nh\n","̃\nφ\nIPW\n(O;q\n0\n)\ni\n=E\nh\n","̃\nφ\nREG\n(O;h\n0\n)\ni\n=E\nh\n","̃\nφ\nDR\n(O;h\n0\n,q\n0\n)\ni\n.\nLemma","4","suggests","a","straightforward","way","to","estimateJ:","first","estimateh\n0\n∈H\nobs\n0\nandq\n0\n∈\nH\nobs\n0\n,","and","then","estimate","the","GACEJby","using","any","of","the","estimating","equations","above.\nInterestingly,","Lemma","4","holds","for","any","bridge","functionsh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n,","even","if","they\nviolate","the","conditional","moment","equations","in","Eqs.","(2)","and","(3),i.e.,","it","holds","forh\n0\n∈H\nobs\n0\n\\H\n0\nand\nq\n0\n∈Q\nobs\n\\Q\n0\n.","In","other","words,","under","Assumptions","1","and","2,","even","when","the","setsof","bridge","functions\nare","unidentifiable","(i.e.,H\n0\n(","H\nobs\n0\nandQ\n0\n(","Q\nobs\n0\n),","the","GACEJcan","still","be","identifiable.","This","is\npossible","due","to","the","existence","ofbothoutcome","bridge","functionh\n0\n∈H\n0\nand","action","bridge","function\nq\n0\n∈Q\n0\n(i.e.,","Assumption","2).\n3\nWith","the","existence","of","both","bridge","functions,","Lemma","4","follows\nas","a","consequence","of","the","lemma","below,","which","states","that","whether","the","REG","and","IPW","estimating\nequations","can","identifyJonly","depends","on","whether","the","bridge","functions","satisfy","the","observed-data\nconditional","moment","equations","in","Eqs.","(5)","and","(6),","instead","ofthe","unobserved","counterparts","in\nEqs.","(2)","and","(3).\nLemma","5.Suppose","that","Assumptions","1","and","2","hold","and","fix","anyh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n.","Then\nfor","anyh∈L\n2\n(W,A,X)andπq∈L\n2\n(Z,A,X),\nE\nh\n","̃\nφ\nREG\n(O;h)\ni\n−J=E[π(A|X)q\n0\n(Z,A,X)E[h(W,A,X)−Y|Z,A,X]],\nE\nh\n","̃\nφ\nIPW\n(O;q)\ni\n−J=E[h\n0\n(W,A,X)E[π(A|X)","(q(Z,A,X)−1/f(A|W,X))|W,A,X]].\nOur","proof","of","the","identification","ofJvia","Lemma","5","is","completely","different","from","the","identification\nresults","in","previous","literature","[Cui","et","al.,","2020,","Deaner,","2021].","These","previous","literature","start","by\nassumingH\nobs\n0\n6=∅,Q\nobs\n0\n6=∅,","and","impose","extracompleteness","conditionsto","ensure","that","any\nh\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\nmust","also","satisfy","thath\n0\n∈H\n0\n,q\n0\n∈Q\n0\n.","Then","they","useh\n0\n∈H\n0\n,q\n0\n∈Q\n0\nto\nidentify","causal","estimands","based","on","Lemma","2.\n4\nIn","contrast,","we","start","withH\n0\n6=∅,Q\n0\n6=∅,","which\nimpliesH\nobs\n0\n6=∅,Q\nobs\n0\n6=∅,","and","then","show","that","we","can","directly","useh\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\nto\nidentify","causal","estimands","based","on","Lemmas","4","and","5.","In","this","way,","we","can","achieve","identification\nwithout","assuming","any","completeness","conditions.","See","Fig.","2","for","an","illustration","for","the","difference\nin","identification","strategies","and","see","Appendix","A","for","more","discussion.","In","Lemma","11","in","Section","6.2,\nwe","will","also","show","that","Lemma","5","plays","an","important","role","in","analyzing","the","convergence","rates","of\nour","GACE","estimators.\n3\nWe","can","actually","weaken","Assumption","2","in","Lemma","4","further:","we","only","needH\n0\n6=∅,Q\nobs\n0\n6=∅for","REG","and","DR\nestimating","equations","to","identifyJ,","andQ\n0\n6=∅,H\nobs\n0\n6=∅for","IPW","and","DR","estimating","equations","to","identifyJ.","In\ncontrast,","if","we","followed","the","identification","strategy","in","previous","literature,","then","we","would","needH\nobs\n0\n6=∅with","an","extra\ncompleteness","condition","for","REG","and","DR","estimating","equations,","andQ\nobs\n0\n6=∅with","another","completeness","condition\nfor","IPW","and","DR","estimating","equations.","See","discussion","below","Lemma","5","and","in","Appendix","B.\n4\nMiao","et","al.","[2018b,a]","only","focus","on","the","outcome","bridge","function,","but","their","identification","strategy","is","similar","to\nthese:","they","assumeH\nobs\n0\n6=∅along","with","an","extra","completeness","condition","in","order","to","ensure","that","the","REG","estimating\nequation","can","identify","the","ATE.\n8\n\n4","","Minimax","Estimators","of","Bridge","functions\nEstimating","bridge","functions","based","on","Eqs.","(5)","and","(6)","requires","solving","conditional","moment\nequations,","which","is","generally","a","difficult","estimation","problem.","Estimation","methods","in","the","previous\nliterature","only","focus","on","parametric","methods","[Cui","et","al.,","2020]","or","sieve","methods","[Deaner,","2021].\nIn","this","paper,","we","propose","to","use","minimax","approaches","to","estimate","the","bridge","functions,","which\nenable","the","use","of","more","flexible","hypothesis","classes","such","as","neural","networks","and","RKHS.\nIn","this","section,","we","introduce","two","minimax","reformulations","ofthe","conditional","moment","equa-\ntions","in","Eqs.","(5)","and","(6).","","Each","reformulation","motivates","an","estimation","strategy","for","bridge\nfunctions.","Analogous","reformulations","have","been","also","studied","(separately)","by","previous","literature\nin","the","context","of","estimation","using","instrument","variables","(IV).","See","Section","7","for","the","literature\nreview.\n4.1","","Strategy","I:","Minimax","Estimators","without","Stablizers\nAs","motivation,","consider","a","generic","conditional","estimating","equation","problem,E[ρ(g\n0\n(O\n1\n),O\n1\n)|O\n2\n]","=\n0,","where","we","wish","to","solve","for","the","functiong\n0\nandO\n1\n,O\n2\nare","two","sets","of","random","variables.","Note\nthat\nE[ρ(g\n0\n(O\n1\n),O\n1\n)|O\n2\n]","=","0⇐⇒E\n\u0002\ng\n′\n(O\n2\n)ρ(g\n0\n(O\n1\n),O\n1\n)\n\u0003\n=","0,∀g\n′\n∈L\n2\n(O\n2\n),\n⇐⇒sup\ng\n′\n∈L\n2\n(O\n2\n)\n\u0000\nE\n\u0002\ng\n′\n(O\n2\n)ρ(g\n0\n(O\n1\n),O\n1\n)\n\u0003\u0001\n2\n=","0.(7)\nWe","next","apply","this","observation","to","our","Eqs.","(5)","and","(6)","in","the","following","lemma.","First,","we","define\nthe","linear","operatorsP\nz\n:L\n2\n(W,A,X)→L\n2\n(Z,A,X)andP\nw\n:L\n2\n(Z,A,X)→L\n2\n(W,A,X)as\nfollows:\nP\nz\n(h)","=E[h(W,A,X)|Z,A,X],","P\nw\n(q)","=E[q(Z,A,X)|W,A,X].(8)\nLemma","6.Suppose","Assumptions","1","and","2","hold,","thatH⊆L\n2\n(W,A,X),","πQ⊆L\n2\n(Z,A,X)\nsatisfy","realizability","in","thatH\nobs\n0\n∩H6=∅,Q\nobs\n0\n∩Q6=∅,","and","thatQ\n′\n⊆L\n2\n(Z,A,X),H\n′\n⊆\nL\n2\n(W,A,X)satisfy","closedness","in","thatP\nz\n\u0000\nH−H\nobs\n0\n\u0001\n⊆Q\n′\n,","πP\nw\n\u0000\nQ−Q\nobs\n0\n\u0001\n⊆H\n′\n.","Then\nH\nobs\n0\n∩H=","arg","min\nh∈H\nsup\nq∈Q\n′\n(E[q(Z,A,X)","(h(W,A,X)−Y)])\n2\n,(9)\nQ\nobs\n0\n∩Q=","arg","min\nq∈Q\nsup\nh∈H\n′\n(E[π(A|X)q(X,A,Z)h(W,A,X)−(Th)(W,X)])\n2\n.(10)\nThis","lemma","motivates","the","following","estimators","for","bridge","functions\nˆ\nh∈arg","min\nh∈H\nmax\nq∈Q\n′\n(E\nn\n[q(Z,A,X)","(h(W,A,X)−Y)])\n2\n,(11)\nˆq∈arg","min\nq∈Q\nmax\nh∈H\n′\n(E\nn\n[π(A|X)q(X,A,Z)h(W,A,X)−(Th)(X,W)])\n2\n,(12)\nwhereE\nn\nrepresents","sample","average","based","on","observed","data.\nOur","estimators\nˆ\nh,ˆqcan","be","viewed","as","solution","to","minimax","games,","where","an","adversarial","player\npicks","elements","from","function","classesQ\n′\n,H\n′\nto","form","the","most","difficult","marginal","moments","while\nour","estimators","minimize","the","violations","of","such","marginal","moments.","","We","callQ\n′\n,H\n′\nthecritic\nclassesand","elements","thereincritic","functions,","while","we","callQ,Hthehypothesis","classes.\nNote","that","although","Eq.","(6)","involves","the","generalized","propensity","scoref(A|W,X),","it","does\nnot","appear","in","Eq.","(12)","at","all.","In","this","sense,","our","estimation","method","forˆqis","different","from","a","naïve\napplication","of","Eq.","(7)","to","Eq.","(6),","wherein","we","would","first","get","a","preliminary","generalized","propen-\nsity","score","estimator\nˆ\nf(A|W,X)and","then","solvearg","min\nq∈Q\nmax\nh∈H\n′\n(E\nn\n[h(W,A,X)π(A|X){q\n0\n−\n1/\nˆ\nf(A|W,X)}])\n2\n.Instead,","our","estimator","in","Eq.","(12)","exploits","the","fact","thatE[h(W,A,X)π(A|X)/f(A|W,X)]","=\nE[(Th)","(X,W)].","Thus","it","obviates","the","need","to","estimate","the","generalized","propensity","score","before\nestimating","the","bridge","functions,","which","is","apparently","more","appealing.","This","fact","also","character-\nizes","the","difference","in","the","estimation","ofh\n0\nandq\n0\n.","The","estimation","ofh\n0\nis","analogous","to","the\nnonparametric","IV","regression","problem","[Newey","and","Powell,","2003,","Darolles","et","al.,","2010],","and","the\n9\n\nestimator","Eq.","(11)","is","analogous","to","minimax","approaches","thereto.","In","contrast,","the","estimation","of\nq\n0\nrequires","additional","considerations.\nExample","1,","Cont’d(Average","treatment","effect).","","Consider","binary","actionA∈","{0,1}in","Ex-\nample","1.","","In","this","case,","the","conditional","moment","equation","for","the","action","bridge","functionq\n0\nis\nequivalent","to\nE[I[A=a]q\n0\n(Z,a,X)−1|W,X]","=","0,","a∈{0,1}.\nApparently,","this","equation","does","not","explicitly","depend","on","thepropensity","score","either.","Note","that\nwhenZ=W=∅,","the","action","bridge","function","given","by","this","conditional","moment","equation","is\nexactly","the","inverse","propensity","score","weight.\n4.2","","Strategy","II:","Minimax","Estimators","with","Stablizers\nAgain","considering","the","generic","estimating","equation,","note","that","for","any","constantλ",">0,\nE[ρ(g\n0\n(O\n1\n),O\n1\n)|O\n2\n]","=","0⇐⇒\n0","=\n1\n4λ\nE\n\u0002\n(E[ρ(g\n0\n(O\n1\n),O\n1\n)|O\n2\n])\n2\n\u0003\n=","","","sup\ng\n′\n∈L\n2\n(O\n2\n)\nE\n\u0002\ng\n′\n(O\n2\n)ρ(g\n0\n(O\n1\n),O\n1\n)\n\u0003\n−λkg\n′\nk\n2\n2\n.(13)\nWe","apply","this","observation","to","our","Eqs.","(5)","and","(6)","in","the","following","lemma.\nLemma","7.Fix","a","constantλ",">0.","Suppose","Assumptions","1","and","2","hold,","thatH⊆L\n2\n(W,A,X),","πQ⊆\nL\n2\n(Z,A,X)satisfy","realizability","in","thatH\nobs\n0\n∩H6=∅,Q\nobs\n0\n∩Q6=∅,","and","thatQ\n′\n⊆L\n2\n(Z,A,X),H\n′\n⊆\nL\n2\n(W,A,X)are","star-shaped\n5\nand","satisfy","closedness","in","thatP\nz\n\u0000\nH−H\nobs\n0\n\u0001\n⊆Q\n′\n,","πP\nw\n\u0000\nQ−Q\nobs\n0\n\u0001\n⊆\nH\n′\n.\n6\nThen,\nH\nobs\n0\n∩H=","arg","min\nh∈H\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n2\nQ\nobs\n0\n∩Q=","arg","min\nq∈Q\nsup\nh∈H\n′\nE[π(A|X)q(X,A,Z)h(X,A,W)−(Th)(X,W)]−λkhk\n2\n2\n.\nThis","lemma","motivates","the","following","estimators","for","bridge","functions\nˆ\nh=","arg","min\nh∈H\nmax\nq∈Q\n′\nE\nn\n[{h(X,A,W)−Y}q]−λE\nn\n[q\n2\n],(14)\nˆq=","arg","min\nq∈Q\nmax\nh∈H\n′\nE\nn\n[q(X,A,Z)π(A|X)h(X,A,W)−Th(X,W)]−λE\nn\n[h\n2\n](15)\nWe","call","the","termsλE\nn\n[q\n2\n],λE\nn\n[h\n2\n]stabilizers.","When","critic","classesQ\n′\nandH\n′\nare","symmetric\nandλis","set","to0,","the","objective","functions","in","Eqs.","(14)","and","(15)","are","equivalent","to","their","counterparts\nin","Eqs.","(11)","and","(12).","Note","that","the","stabilizers","are","quite","different","from","regularizers.","Regular-\nizers","typically","introduce","estimation","bias,","usually","to","dealwith","ill-posed","inverse","problems","[e.g.,\nKnight","and","Fu,","2000,","Carrasco","et","al.,","2007].","Stabilizers","on","the","other","hand","do","not","introduce","bias\nand","are","merely","a","way","to","reformulate","the","conditional","moment","equation.\n4.3","","Examples","of","Bridge","Function","Estimators\nIn","this","part,","we","give","examples","of","bridge","function","estimatorsbased","on","three","different","critic\nfunction","classes:","linear","class,","RKHS,","and","neural","networks.In","particular,","for","the","linear","class","and\nRKHS,","the","inner","maximization","problems","in","Eqs.","(11),","(12),","(14)","and","(15)","have","a","closed-form\nsolution,","so","that","the","minimax","problems","can","solved","by","standard","optimization","techniques","such\nas","stochastic","gradient","descent.","In","the","following,","we","often","omit","the","arguments","of","functions","for\nbrevity,","but","their","meaning","should","be","self-evident","from","the","context.\n5\nWe","can","drop","this","assumption","ifλ=\n1\n2\n.\n6\nThe","assumptions","thatH\n′\nandQ\n′\nare","star-shaped,P\nz\n(\nH−H\nobs\n0\n)\n⊆Q\n′\n,","andπP\nw\n(\nQ−Q\nobs\n0\n)\n⊆H\n′\ncan","also","be\nreplaced","by","assuming","instead","thatCP\nz\n(\nH−H\nobs\n0\n)\n⊆Q\n′\n,","CπP\nw\n(\nQ−Q\nobs\n0\n)\n⊆H\n′\nfor","someC",">0.\n10\n\n4.3.1","","Linear","classes\nGiven","basis","functionsφ(x,a,z),ψ(x,a,w)of","dimensionsd\n1\n,d\n2\n,","respectively,","consider\nQ\n′\n=\nn\n(z,a,x)7→α\n⊤\n1\nφ(z,a,x)",":α\n1\n∈R\nd\n1\n,kα\n1\nk≤c\n1\no\n,(16)\nH\n′\n=\nn\n(w,a,x)7→α\n⊤\n2\nψ(w,a,x)",":α\n2\n∈R\nd\n2\n,kα\n2\nk≤c\n2\no\n.(17)\nTypical","examples","of","basis","functions","include","splines,","polynomials,","and","wavelets","[Chen,","2007].\nWhend\n1\n,d\n2\ngrow","withn,","these","function","classes","are","also","called","sieves.","See","also","discussions","in\nExample","10.\nMinimax","Estimators","without","Stablizers.It","is","easy","to","show","that","with","linear","critic\nclasses,","the","inner","maximum","objectives","in","Eqs.","(11)","and","(12)","have","closed-form","expressions,","and\nthe","resulting","bridge","function","estimators","are","given","as","follows:\nˆ\nh=","arg","min\nh∈H\n(E\nn\n[{Y−h}φ])\n⊤\n(E\nn\n[{Y−h}φ]),(18)\nˆq=","arg","min\nq∈Q\n(E\nn\n[qπψ−Tψ])\n⊤\n(E\nn\n[{qπψ−Tψ}]).(19)\nIf","furtherQandHare","also","linear","classes","(without","norm","constraints","for","simplicity),","namely,\nπQ=\nn\n(z,a,x)7→α\n⊤\n1\n","̃\nφ(z,a,x)",":α\n1\n∈R\n","̃\nd\n1\no\n,(20)\nH=\nn\n(w,a,x)7→α\n⊤\n2\n","̃\nψ(w,a,x)",":α\n2\n∈R\n","̃\nd\n2\no\n,(21)\nthen","we","have\nˆ\nh=\n","̃\nψ\n⊤\nˆα\n2\n,ˆα\n2\n={E\nn\n[\n","̃\nψφ\n⊤\n]E\nn\n[φ\n","̃\nψ\n⊤\n]}\n+\nE\nn\n[\n","̃\nψφ\n⊤\n]E\nn\n[Y","φ],\nˆq=\n","̃\nφ\n⊤\nˆα\n1\n,ˆα\n1\n={E\nn\n[\n","̃\nφψ\n⊤\n]E\nn\n[ψ\n","̃\nφ\n⊤\n]}\n+\nE\nn\n[\n","̃\nφψ\n⊤\n]E\nn\n[Tψ],\nwhereA\n+\nis","the","Moore–Penrose","inverse","of","a","matrixA.\nIt","may","sometimes","be","useful","to","constrain","the","norms","of","coefficients","inQandH,","especially\nwhen","using","linear","sieves","with","growing","basis","functions","[Newey","and","Powell,","2003,","Newey,","2013].\nIt","is","often","more","convenient","to","formulate","this","as","Tikhonov","regularization","and","simply","penalize\nkα\n1\nk\n2\nandkα\n2\nk\n2\nin","Eqs.","(18)","and","(19).","The","solution","remains","closed","form.\nMinimax","Estimators","with","Stablizers.The","inner","maximum","objectives","in","Eqs.","(14)\nand","(15)","may","no","longer","admit","closed-form","solutions","when","we","constrain","the","norms","ofα\n1\n,α\n2\nin\nH\n′\n,Q\n′\n.","To","circumvent","this","issue,","we","consider","settingc\n1\n=c\n2\n=∞in","the","critic","classesH\n′\n,Q\n′\nand\nregularizing","coefficient","norms","in","the","inner","maximization","objectives.\nLemma","8.Fixc\n1\n=c\n2\n=","+∞in","the","critic","function","classesQ\n′\n,H\n′\nin","Eqs.(16)and(17).\nConsider","the","following","estimators","adapted","from","Eqs.(14)and(15):\nˆ\nh=","arg","min\nh∈H\nmax\nq∈Q\n′\nE\nn\n[{h(X,A,W)−Y}q]−λE\nn\n[q\n2\n]−γ\n1\nkα\n1\nk\n2\n,\nˆq=","arg","min\nq∈Q\nmax\nh∈H\n′\nE\nn\n[q(X,A,Z)π(A|X)h(X,A,W)−Th(X,W)]−λE\nn\n[h\n2\n]−γ\n2\nkα\n2\nk\n2\nThen","we","have\nˆ\nh=","arg","min\nh∈H\nE\nn\n[{Y−h}φ]\n⊤\n{γ\n1\nI+λE\nn\n[φφ]}\n−1\nE\nn\n[{Y−h}φ],\nˆq=","arg","min\nq∈Q\nE\nn\n[qπψ−Tψ]\n⊤\n{γ\n2\nI+λE\nn\n[ψψ]}\n−1\nE\nn\n[{qπψ−Tψ}].\nIf","furtherQandHare","linear","classes","as","in","Eqs.","(20)","and","(21),","then","we","have\nˆ\nh=\n","̃\nψ\n⊤\nˆα\n2\n,ˆα\n2\n={E\nn\n[\n","̃\nψφ\n⊤\n]{γ\n1\nI+λE\nn\n[φφ\n⊤\n]}\n−1\nE\nn\n[φ\n","̃\nψ\n⊤\n]}\n+\nE\nn\n[\n","̃\nψφ\n⊤\n]{γ\n1\nI+λE\nn\n[φφ\n⊤\n]}\n−1\nE\nn\n[Y","φ],\nˆg=\n","̃\nφ\n⊤\nˆα\n1\n,ˆα\n1\n={E\nn\n[\n","̃\nφψ\n⊤\n]{γ\n2\nI+λE\nn\n[ψψ\n⊤\n]}\n−1\nE\nn\n[ψ\n","̃\nφ\n⊤\n]}\n+\nE\nn\n[\n","̃\nφψ\n⊤\n]{γ\n2\nI+λE\nn\n[ψψ\n⊤\n]}\n−1\nE\nn\n[Tψ].\nAgain,","we","can","also","add","Tikhonov","regularization","on","the","coefficients","ofH,Q.\n11\n\n4.3.2","","RKHS\nWhen","we","use","RKHS","as","the","critic","classes,","the","inner","maximization","problems","in","the","two","estimation\nstrategies","can","also","be","computed","in","closed-form.","","Let","us","first","introduce","two","kernel","functions\nk\nz\n:","(Z,A,X)×(Z,A,X)→Randk\nw\n:","(W,A,X)×(W,A,X)→R,","and","denote","the","induced\nRKHS","asL\nz\nandL\nw\nwith","RKHS","normsk·k\nL\nz\nandk·k\nL\nw\n,","respectively.\nWe","consider","the","following","critic","function","classes:\nQ\n′\n={q:q∈L\nz\n,kqk\nL\nz\n≤c\n1\n},H\n′\n={h:h∈L\nw\n,khk\nL\nw\n≤c\n2\n}.(22)\nMinimax","Estimators","without","Stablizers.With","RKHS","critic","function","classes,","we","sim-\nplify","the","minimax","estimation","problems","in","Eqs.","(11)","and","(12)","in","the","following","lemma.\nLemma","9.ForQ\n′\n,H\n′\ngiven","in","Eq.(22),","Eqs.(11)and(12)are","equivalent","to\nˆ\nh=","arg","min\nh∈H\n(ψ\nn\n(h))\n⊤\nK\nz,n\nψ\nn\n(h),(23)\nˆq=","arg","min\nq∈Q\n(φ\nn\n(q))\n⊤\nK\nw1,n\nφ\nn\n(q)−2","(φ\nn\n(q))\n⊤\nK\nw2,n\n1\nn\n,(24)\nwhereK\nz,n\n,K\nw1,n\n,K\nw2,n\naren×nGram","matrices","whose(i,j)th","entry","isk\nz\n((Z\ni\n,A\ni\n,X\ni\n),(Z\nj\n,A\nj\n,X\nj\n)),\nk\nw\n((W\ni\n,A\ni\n,X\ni\n),(W\nj\n,A\nj\n,X\nj\n),E\nπ(A\nj\n|X\nj\n)\n[k\nw\n((W\ni\n,A\ni\n,X\ni\n),(W\nj\n,A\nj\n,X\nj\n))],","respectively,","andψ\nn\n(h),\nφ\nn\n(q)aren×1vectors","whoseith","elements","are(Y\ni\n−h(X\ni\n,A\ni\n,Z\ni\n)),q(X\ni\n,A\ni\n,Z\ni\n)π(A\ni\n|X\ni\n),","re-\nspectively,","and1\nn\n∈R\nn\nis","the","all-ones","vector.\nMinimax","Estimators","with","Stablizers.Similar","to","the","linear","classes,","the","inner","maxi-\nmization","problems","in","Eqs.","(14)","and","(15)","may","no","longer","have","closed-form","solutions","with","the\nRKHS","norm","constraints","in","Eq.","(22).","To","circumvent","this","issue,we","can","again","setc\n1\n=c\n2\n=∞in\nEq.","(22),","or","equivalently","setQ\n′\n=L\nz\n,H\n′\n=L\nw\n,","and","instead","regularize","the","inner","maximization\nobjectives.\nLemma","10.Consider","the","following","estimators","adapted","from","Eqs.(14)and(15):\nˆ\nh=","arg","min\nh∈H\nmax\nq∈L\nw\n,\nE\nn\n[{h(X,A,W)−Y}q]−λE\nn\n[q\n2\n]−γ\n1\nkqk\nL\nw\n,(25)\nˆq=","arg","min\nq∈Q\nmax\nh∈L\nz\nE\nn\n[q(X,A,Z)π(A|X)h(X,A,W)−Th(X,W)]−λE\nn\n[h\n2\n]−γ\n2\nkhk\nL\nw\n.(26)\nThen","we","have\nˆ\nh=","arg","min\nh∈H\nψ\nn\n(h)\n⊤\nK\n1/2\nz,n\n{γ\n1\nI+λK\nz,n\n}\n−1\nK\n1/2\nz,n\nψ\nn\n(h),(27)\nˆg=","arg","min\nq∈Q\nφ\nn\n(q)\n⊤\nK\n1/2\nw1,n\n(λK\nw1,n\n+γ\n2\nI)\n−1\nK\n1/2\nw1,n\nφ\nn\n(q)−2{φ\nn\n(q)\n⊤\n(λK\nw1,n\n+γ\n2\nI)\n−1\nK\nw2,n\n1\nn\n}.\n(28)\nIn","all","of","Eqs.","(23),","(24),","(27)","and","(28),","computing","the","final","bridge","estimators","only","involves\nminimization","problems","whose","objectives","are","convex","inhorqand","only","depend","onhorqvia\ntheir","evaluation","at","data","points.","","IfH,Qare","linear","hypothesis","classes","like","those","in","Eqs.","(20)\nand","(21),","then\nˆ\nhandˆqshould","also","have","closed","form","solutions.","","IfHis","a","RKHS","hypothesis\nclasses","with","kernelkeither","with","norm","constraints","or","with","norm","regularizers,","then","the","optimal\nsolution","to","Eqs.","(23)","and","(27)","will","have","the","form\nˆ\nh(z,a,x)","=\nP\nn\ni=1\nα\ni\nk((Z\ni\n,A\ni\n,X\ni\n),(z,a,x)),\nleading","to","a","convex","quadratic","program","inαwith","a","closed-form","solution.","The","same","holds","for\nEqs.","(24)","and","(28)","ifQis","a","RKHS","hypothesis","class.","If","the","hypothesis","classesH,Qare","some","more\ncomplex","classes","such","as","neural","networks,","then","we","can","use","stochastic","gradient","descent","methods\nto","solve","for\nˆ\nh,ˆq,","which","have","been","shown","to","be","highly","successful","in","many","nonconvex","applications\n[Jain","and","Kar,","2017].\n12\n\n4.3.3","","Neural","Networks\nWhen","we","use","neural","networks","forQ,H,Q\n′\n,H\n′\n,","we","obtain","a","non-convex","minimax","optimization.\nSeveral","types","of","simultaneous","SGD","methods","are","known","to","be","commonly","used","in","this","problem\nsuch","as","(simultaneous","version","of)","Adam","[Kingma","and","Ba,","2015],","which","is","a","variant","of","gradient\ndescent","with","momentum","and","per-parameter","adaptive","learningrates.","An","improved","approach","is\nthe","Optimistic","Adam","[Daskalakis","et","al.,","2018],","which","is","an","adaptation","of","Adam","with","additional\nnegative","momentum.","A","negative","momentum","term","is","known","to","be","helpful","for","avoiding","oscillations\nwhen","solving","minimax","problems.\n4.4","","An","Overview","of","the","Estimation","Theory","for","GACE\nIn","Sections","4.1","and","4.2,","we","provide","two","types","of","minimax","estimators\nˆ\nh,ˆqfor","the","bridge","functions.\nOnce","we","obtain","these","estimators,","we","can","plug","them","into","the","estimating","equations","in","Lemma","4\nto","construct","the","following","estimators","for","the","GACEJ:\nˆ\nJ\nIPW\n=E\nn\nh\n","̃\nφ\nIPW\n(O;","ˆq)\ni\n=E\nn\n[π(A|X)ˆq(Z,A,X)Y],\nˆ\nJ\nREG\n=E\nn\nh\n","̃\nφ\nREG\n(O;\nˆ\nh)\ni\n=E\nn\nh\n(T\nˆ\nh)(X,W)\ni\n,\nˆ\nJ\nDR\n=E\nn\nh\n","̃\nφ\nDR\n(O;\nˆ\nh,ˆq)\ni\n=E\nn\nh\nπ(A|X)ˆq(Z,A,X)\n\u0010\nY−\nˆ\nh(W,A,X)\n\u0011\n+","(T\nˆ\nh)(X,W)\ni\n.\nIn","Sections","5","and","6,","we","will","show","that","GACE","estimators","based","ondifferent","estimating","equations\nand","different","minimax","bridge","functions","estimators,","either","without","stablizers","(Section","4.1)","or\nwith","stablizers","(Section","4.2),","have","different","theoretical","properties.","Each","type","of","estimator","has\nits","merits","depending","on","how","much","we","are","willing","to","assume.\nIn","the","rest","of","the","paper,","we","willalwaysassume","Assumptions","1","and","2.","We","will","show","that\ntwo","additional","types","of","assumptions","will","play","an","important","role","in","the","theoretical","guarantees\nfor","different","estimators.\n1.Realizability,","which","characterizes","whether","the","hypothesis","classesH,Qor","critic","classesH\n′\n,Q\n′\ncontain","some","observed","bridge","functionsh\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\n,","that","is,","whetherH∩H\nobs\n0\n6=∅\nandQ∩Q\nobs\n0\n6=∅,","orH\n′\n∩H\nobs\n0\n6=∅andQ\n′\n∩Q\nobs\n0\n6=∅.\n2.Closedness,","which","characterizes","whether","the","critic","classesH\n′\n,Q\n′\nare","rich","enough","so","that\nthe","resulting","minimax","reformulation","is","equivalent","to","the","original","conditional","moment","equa-\ntions.","Specifically,","the","relevant","assumptions","areP\nz\n\u0000\nH−H\nobs\n0\n\u0001\n⊆Q\n′\nand/orπP\nw\n\u0000\nQ−Q\nobs\n0\n\u0001\n⊆\nH\n′\n,","as","appear","in","Lemmas","6","and","7.\nThe","theoretical","results","for","our","GACE","estimators","are","organized","as","follows:\n•","In","Section","5,","we","will","derive","finite-sample","error","bounds","for","GACE","estimators","based","on\nminimax","bridge","function","estimators","without","stabilizers","(Section","4.1)","under","realizability\nassumptions","for","both","hypothesis","classes","and","critic","classes.\n•","In","Section","6","we","will","analyze","error","bounds","when","we","use","minimaxbridge","function","estima-\ntors","with","stabilizers","(Section","4.2),","assuming","the","realizability","assumption","for","one","or","both\nhypothesis","classes","and","the","closedness","assumptions","for","one","or","both","critic","classes.\n•","In","Section","6.3,","we","show","that,","when","we","additionally","assume","that","bridge","functions","are","unique\nand","that","the","conditional","moment","equations","in","Eqs.","(5)","and","(6)are","not","too","ill-posed,","we","have\nthat","the","resulting","doubly","robust","estimator\nˆ\nJ\nDR\nis","asymptotically","normal","with","asymptotic\nvariance","equal","to","the","semiparametric","efficiency","bound.\nIn","Table","1,","we","list","our","results","for","different","estimators","underdifferent","assumptions,","when","spe-\ncialized","to","Hölder","function","classes.\n13\n\n5","","Finite","Sample","Analysis","of","Estimators","without","Stabi-\nlizers\nIn","this","section,","we","analyze","different","GACE","estimators","based","on","minimax","estimation","of","bridge\nfunctionswithoutstabilizers","(Section","4.1).","Thus,","throughout","this","section,\nˆ\nh,ˆqrefer","to","the","bridge\nfunction","estimators","in","Eqs.","(11)","and","(12).","We","also","continue","to","assume","Assumptions","1","and","2.\nFirst,","we","present","results","for","IPW","and","REG","estimators","underonlyrealizability,without\nclosedness.\nTheorem","1(Analysis","of","IPW","and","REG","estimators).\n1.","IfH\nobs\n0\n∩H\n′\n6=∅,Q\nobs\n0\n∩Q6=∅,","then","we","have\n|\nˆ\nJ\nIPW\n−J|≤sup\nq∈Q\n|(E−E\nn\n)[qπY]|+","4","","sup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|.\n2.","IfH\nobs\n0\n∩H6=∅,πQ\nobs\n0\n∩Q\n′\n6=∅,","then","we","have\n|\nˆ\nJ\nREG\n−J|≤sup\nh∈H\n|(E−E\nn\n)[Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[q(Y−h)]|.\nHere","we","assume","thatH\nobs\n0\n∩H\n′\n6=∅,Q\nobs\n0\n∩Q6=∅orH\nobs\n0\n∩H6=∅,πQ\nobs\n0\n∩Q\n′\n6=∅,","which\nwe","termedrealizabilityin","Section","4.4.","These","conditions","mean","that","one","hypothesis","class","and","its\ncorresponding","critic","class","are","well","specified,","in","the","sense","that","they","contain","some","valid","(observed)\nbridge","functions","inH\nobs\n0\norQ\nobs\n0\n.","Under","these","conditions,","we","can","upper","bound","the","estimation\nerrors","of\nˆ\nJ\nIPW\nand\nˆ\nJ\nREG\nby","two","empirical","process","terms.","In","Section","5.1,","we","will","show","that\nthese","terms","converge","to0asngoes","to","infinity","for","some","common","function","classes","ofH,H\n′\n,Q,Q\n′\n.\nTherefore,\nˆ\nJ\nIPW\nand\nˆ\nJ\nREG\nare","consistent","estimators","for","the","GACEJ.\nInterestingly,","the","GACE","estimators\nˆ\nJ\nREG\n,\nˆ\nJ\nIPW\nmay","converge","to","the","true","GACEJeven\nwhen","the","bridge","function","estimators\nˆ\nhandˆqdo","not","converge","to","any","valid","observed","bridge\nfunctions","inH\nobs\n0\nandQ\nobs\n0\n.","This","is","in","stark","contrast","to","the","usual","IPW","or","REG","estimators","in\nthe","unconfounded","setting","without","using","minimax","estimation.","We","illustrate","this","phenomenon","in\nthe","following","simple","example","of","the","REG","estimator.\nExample","7.SupposeH\nobs\n0\n={h\n0\n},H={a\n1\n+a\n2\nh\n0\n:a\n1\n∈R,a\n2\n∈R},Q\nobs\n0\n={q\n0\n},Q\n′\n={πq\n0\n}.\nThen","it","is","easy","to","show","that","minimizers","for","the","population","minimax","objective","in","Eq.","(9)","are\narg","min\nh∈H\nsup\nq∈Q\n′\n(E[q(h−Y)])\n2\n={h∈H:E[πq\n0\n(h−Y)]","=","0}\n={a\n1\n+a\n2\nh\n0\n:a\n1\n=E[πq\n0\n(1−a\n2\n)h\n0\n]/E[πq\n0\n],a\n2\n∈R}.\nNotice","that,","unlike","Lemma","6,","the","above","isnotequal","toH\nobs\n0\n∩H,","but","this","is","not","a","contradiction,\nas","here","we","donothave","closedness.","Therefore,","the","estimator\nˆ\nhthat","minimizes","the","empirical\nanalogue","of","the","minimax","objective","above","generally","does","not","converge","toh\n0\n.","Neverthelss,","it","is\neasy","to","show","thatH\nobs\n0\n∩H6=∅,πQ\nobs\n0\n∩Q\n′\n6=∅are","satisfied,","and|\nˆ\nJ\nREG\n−J|converges","to\n0asngoes","to","infinity.","Later,","in","Theorem","5,","we","show","that","under","closedness","assumptions","on\nH\n′\n,Q\n′\n,","the","bridge","function","estimators","in","Eqs.","(11)","and","(12)","without","stabilizersdoconverge","to\nvalid","observed","bridge","functions","in","a","suitable","notion.","But","inthis","section,","we","do","not","require","such\nconvergence,","yet","we","can","still","ensure","our","GACE","estimators","converge.\nNext,","we","present","an","analogous","result","for","the","DR","estimator.\nTheorem","2(Analysis","of","DR","estimators).IfQ\nobs\n0\n∩Q6=∅,H\nobs\n0\n∩{h:h−H⊆H\n′\n}6=∅,","then\n|\nˆ\nJ\nDR\n−J|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπY−qπh+Th]|+","4","","sup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|.(29)\nIfH\nobs\n0\n∩H6=∅,Q\nobs\n0\n∩{q:π(q−Q)⊆Q\n′\n}6=∅,","then\n|\nˆ\nJ\nDR\n−J|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπY−qπh+Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[q(Y−h)]|.(30)\n14\n\nTheorem","2","suggests","that","as","long","as","the","hypothesis","classQorHis","well-specified,","and","the\n(respective)","associated","critic","classH\n′\norQ\n′\nis","rich","enough","relative","toHorQ,","then\nˆ\nJ\nDR\nis","consis-\ntent","provided","that","these","function","classes","have","limited","complexity","to","ensure","uniform","convergence\nof","the","empirical","process","terms","above.","In","particular,\nˆ\nJ\nDR\nis","consistent","when","either","empirical\nprocess","conditions","onQ,H\n′\nor","onH,Q\n′\nhold.","Moreover,","whenH={0},Q\n′\n={0}so","that\nˆ\nJ\nDR\nreduces","to\nˆ\nJ\nIPW\n,","Eq.","(29)","exactly","recovers","the","result","for\nˆ\nJ\nIPW\nin","Theorem","1.","Analogously,","when\nwhenQ={0},H\n′\n={0},","Eq.","(30)","recovers","the","result","for\nˆ\nJ\nREG\nin","Theorem","1.\n5.1","","Convergence","Rates","of","GACE","Estimators","for","Common","Func-\ntion","Classes\nIn","this","part,","we","analyze","the","convergence","rates","of\nˆ\nJ\nREG\nand\nˆ\nJ\nIPW\nby","further","bounding","the","error\nterms","in","Theorem","1","in","terms","of","the","complexity","of","some","common","function","classes.","For","simplicity\nand","brevity,","we","setH\n′\n=HandQ\n′\n=πQ.","The","results","can","easily","be","specialized","to","each","of\nˆ\nJ\nREG\nor\nˆ\nJ\nIPW\nwhen","only","the","corresponding","pair","of","hypothesis","and","critic","classes","are","realizable.","Each\nresult","we","present","also","implies","the","same","convergence","rate","for\nˆ\nJ\nDR\nif","we","simply","modify","the","critic\nclass","realizability","condition","to","be","as","in","Theorem","2.","We","omit","these","corresponding","results","for\nˆ\nJ\nDR\nfor","brevity.\nExample","8(VC-subgraph","classes).VC-subgraph","classes","are","function","classes","whose","subgraph\nsets","have","bounded","VC","dimension","[van","der","Vaart,","1998,","Chapter19].","For","example,{φ7→θ\n⊤\nφ:\nkθk\n2\n≤1,θ∈R\nd\n}has","a","VC-subgraph","dimensiond+","1[van","der","Vaart,","1998,","Chapter","19].\nCorollary","1.LetH,Q\n′\nbe","VC-subgraph","classes","with","finite","VC-subgraph","dimensionsV(H),V(Q\n′\n),\nrespectively.","AssumeH∩H\nobs\n0\n6=∅,Q\n′\n∩πQ\nobs\n0\n6=∅,","andkHk\n∞\n,kQ\n′\nk\n∞\n,kYk\n∞\n<∞.","Then,","letting\nO(·)be","the","order","wrtn,V(H),V(Q\n′\n),δ.,","with","probability1−δ,","we","have\nmax{|\nˆ\nJ\nREG\n−J|,|\nˆ\nJ\nIPW\n−J|}=O(\np\n(V(H)","+V(Q\n′\n)","+","1","+","log(1/δ))/n).\nCorollary","1","shows","that\nˆ\nJ\nREG\n,\nˆ\nJ\nIPW\n,\nˆ\nJ\nDR\nhave","parametric","convergence","rates","for","VC-subgraph\nclasses","under","realizability.\nExample","9(Nonparametric","classes","characterized","by","metric","entropy).Many","common","non-\nparametric","classes,","such","as","Hölder","balls","and","Sobolev","balls,cannot","be","characterized","by","VC-\nsubgraph","dimensions.","Instead,","their","complexity","can","be","characterized","by","their","metric","entropies\n[Wainwright,","2019].","For","example,","a","Hölder","ballWwith","smoothness","levelαand","an","input","dimen-\nsiondhas","metric","entropy","under","infinity","normlogN(ε,W,k·k\n∞\n)","=O(ε\n−d/α\n).\nCorollary","2.SupposelogN(ε,H,k·k\n∞\n)","=O(ε\n−β\n),logN(ε,Q\n′\n,k·k\n∞\n)","=O(ε\n−β\n)for","a","positive\nconstantsβ.","Further","assumeH∩H\nobs\n0\n6=∅,Q\n′\n∩πQ\nobs\n0\n6=∅,","andkHk\n∞\n,kQ\n′\nk\n∞\n,kYk\n∞\n<∞.\nThen,","lettingO(·)be","the","order","wrtn,δ,","with","probability1−δ,","we","have\nmax\nn\n|\nˆ\nJ\nREG\n−J|,|\nˆ\nJ\nIPW\n−J|\no\n=\n\n\n\n\n\nO(n\n−1/2\n+\np\nlog(1/δ)/n)β","<2\nO(n\n−1/2\nlog(n)","+\np\nlog(1/δ)/n)β=","2\nO(n\n−1/β\n+\np\nlog(1/δ)/n)β",">2\nCorollary","2","states","that","the","convergence","rates","of\nˆ\nJ\nREG\nand\nˆ\nJ\nIPW\nare","determined","by","the","worse\nof","the","metric","entropy","ofHandQ\n′\n.","This","implies","that","when","these","two","function","classes","are","Donsker\nclasses","[van","der","Vaart,","1998],i.e.,β","<2,","both","estimators","have","parametric","convergence","rates.\nBut","if","either","function","class","is","non-Donsker,i.e.,β≥2,","then","the","estimators","typically","have","slower\nconvergence","rates.\nExample","10(Linear","Sieves).It","is","often","difficult","to","optimize","over","the","infinitely","dimensional\nnonparametric","classes","in","Example","9,e.g.,","the","Hölder","balls.","","Instead,","we","may","consider","using\na","sequence","of","more","tractable","function","class","with","increasingcomplexity","to","approximate","those\nnonparametric","classes.","These","approximating","classes","are","called","sieves","[Chen,","2007].","In","particular,\nwe","may","consider","linear","sieves","forHandQinduced","by","basis","functions{ψ\nj\n(w,a,x)}\nk\nn\nj=1\nand\n{φ\nj\n(z,a,x)}\nk\nn\nj=1\n,","respectively,e.g.,","splines,","polynomials,","wavelets,","etc.","For","brevity,","we","consider\n15\n\nboth","sieves","having","the","same","dimensionk\nn\n,","which","is","increasing","the","sample","sizen.","This","leads","to\nthe","classes\nS\n1,n\n=\n(\n(w,a,x)7→\nk\nn\nX\nj=1\nω\nj\nψ\nj\n(w,a,x)",":ω∈R\nk\nn\n)\n,\nS\n2,n\n=\n(\n(z,a,x)7→\nk\nn\nX\nj=1\nω\nj\nφ\nj\n(z,a,x)",":ω∈R\nk\nn\n)\n.\n(31)\nFor","simplicity,","assume","thatW","×","Z","×","A","×","X=","[0,1]\nd\nW\n+d\nZ\n+d\nA\n+d\nX\nwithd\nW\n=d\nZ\nand","let\nd=d\nW\n+d\nA\n+d\nX\n.","DefineΛ\nα\n([0,1]\nd\n)as","the","Hölder","ball","over[0,1]\nd\nwith","smoothness","levelαand\nfinite","radius.","For","brevity","we","consider","the","same","smoothness","level","for","both","bridge","functions;","this\ncan","easily","be","relaxed.","We","require","linear","sieves","in","Eq.","(31)","toapproximate","these","Hölder","balls\nwith","small","enough","approximation","errors:\n∀h∈Λ\nα\n([0,1]\nd\n),∃h\nn\n∈S\n1,n\n,s.t.kh−h\nn\nk=O\n\u0010\nk\n−α/d\nn\n\u0011\n,(32)\n∀q∈Λ\nα\n([0,1]\nd\n),∃q\nn\n∈S\n2,n\n,s.t.kq−q\nn\nk=O\n\u0010\nk\n−α/d\nn\n\u0011\n.(33)\nNote","the","rate","in","Eqs.","(32)","and","(33)","is","standard","in","sieve","approximations","[Chen,","2007].\nCorollary","3.LetH=S\n1,n\nandQ\n′\n=S\n2,n\nforS\n1,n\n,S\n2,n\nin","Eq.(31)satisfying","the","approximation\nconditions","in","Eqs.(32)and(33).","AssumeH\nobs\n0\n∩Λ\nα\n([0,1]\nd\n)6=∅,πQ\nobs\n0\n∩Λ\nα\n([0,1]\nd\n)6=∅,","and\nkHk\n∞\n,kQ\n′\nk\n∞\n,kYk\n∞\n<∞.","Then","with","probability1−δ,\nmax\nn\n|\nˆ\nJ\nREG\n−J|,|\nˆ\nJ\nIPW\n−J|\no\n=O\n\u0010\nn\n−α/(2α+d)\n+\np\nlog(1/δ)/n\n\u0011\n.\nCompared","to","Corollaries","1","and","2,","Corollary","3","assumes","realizability","onΛ\nα\n(([0,1]\nd\n)rather\nthan","onH,Q\n′\n.","Therefore,","we","cannot","prove","Corollary","3","by","directly","applying","Theorem","1","that\nonly","considers","stochastic","errors.","Instead,","we","need","a","more","refined","version","of","Theorem","1","that","we\ndevelop","in","Appendix","D,","which","additionally","incorporates","thebias","terms","due","to","the","fact","that","the\nrealizability","conditions","onH,Q\n′\nmay","be","violated.","These","bias","terms","are","then","upper-bounded","by\nsieve","approximation","errors","in","Eqs.","(32)","and","(33).","We","then","balance","the","stochastic","errors","with\nthe","bias","terms","to","get","the","convergence","rate","in","Corollary","3.\nNote","that","the","rate","in","Corollary","3","is","slower","than","the","ratemax(n\n−1/2\n,n\nα/d\n)in","Corollary","2\nwhen","specialized","to","Hölder","balls","(i.e.,β=\nd\nα\n)","under","the","same","realizability","assumption.","This\nreflects","the","potential","loss","when","we","use","linear","sieves","to","approximate","Hölder","balls.\nWe","can","straightforwardly","extend","Corollaries","1","to","3","in","a","few","aspects.","First,","all","of","the","above\nfinite-sample","results","can","be","extended","to","asymptotic","results.","","For","example,","the","conclusion","in\nCorollary","1","can","be","used","to","showE[(\nˆ\nJ−J)\n2\n]","=O(n\n−1\n)for\nˆ\nJ=\nˆ\nJ\nIPW\nor\nˆ\nJ=\nˆ\nJ\nREG\n.","Second,","we\nhave","assumed","thatkHk\n∞\n,kQ\n′\nk\n∞\n,i.e.,","envelopes","of","classesHandQ\n′\nare","bounded","functions.","We\ncan","relax","these","assumptions","by","allowing","square-integrableenvelopes","under","additional","regularity\nconditions.","Finally,","as","mentioned,","we","can","very","easily","considerH6=H\n′\nandπQ6=Q\n′\n,","assume\ndifferent","smoothness","levels","for","the","hypothesis","and","critic","classes,","and","extend","the","results","to","the\nDR","estimator.\n6","","Finite","Sample","Analysis","of","Estimators","with","Stabiliz-\ners\nIn","the","previous","section,","we","studied","the","convergence","of","our","GACE","estimators","based","on","minimax\nbridge","function","estimatorswithoutstabilizers","(Section","4.1),","by","assuming","the","realizability","ofH,Q\n′\n(or","realizability","ofH\n′\n,Q).","In","this","section,","we","show","that","under","a","different","set","of","assumptions,i.e.,\nclosedness","and","realizability,","bridge","function","estimatorswithstablizers","converge","to","valid","observed\nbridge","functions","at","sufficiently","fast","rates","in","terms","of","projected","mean-squared","errors.\n7\nThen,","we\n7\nWe","can","also","show","that","under","the","same","assumptions,","bridge","function","estimators","without","stabilizers","converge","to\nvalid","observed","bridge","functions","in","projected","mean-squarederrors,","albeit","at","slower","rates.","See","Theorem","5.\n16\n\nestablish","the","convergence","rate","of","the","resulting","GACE","estimators.","Finally,","by","leveraging","the","fast\nconvergence","results","with","stablizers","and","additionally","assuming","that","bridge","functions","are","unique\nand","the","associated","inverse","problems","are","not","too","ill-posed,","we","can","show","that","the","resulting","DR\nestimator","is","also","semiparametrically","efficient.\nThroughout","this","section,\nˆ\nh,ˆqrefer","to","the","minimax","bridge","function","estimators","in","Eqs.","(14)\nand","(15),","that","is,","the","minimax","bridge","function","estimatorswithstabilizers.","","We","continue","to\nassume","Assumptions","1","and","2.\nFor","any","valid","bridge","functionh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n,","we","quantify","the","estimation","errors","of\nbridge","function","estimators\nˆ\nhandˆqbykP\nz\n(\nˆ\nh−h\n0\n)k\n2\n2\nandkπP\nw\n(ˆq−q\n0\n)k\n2\n,","which","we","call","projected\nmean-squared","errors","(projected","MSE).","Projected","MSE","measures","how","much\nˆ\nhandˆqviolate","the\nconditional","moment","equations","in","Eqs.","(5)","and","(6):\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n2\n=E\n\u0014\n\u0010\nE[Y−\nˆ\nh(W,A,X)|Z,A,X]\n\u0011\n2\n\u0015\n,(34)\nkπP\nw\n(ˆq−q\n0\n)k\n2\n2\n=E\n\u0002\n(E[π(A|X)","(ˆq(Z,A,X)−1/f(A|W,X))|W,A,X])\n2\n\u0003\n.(35)\nObviously,","these","estimation","errors","are","invariant","to","the","choice","ofh\n0\nandq\n0\nso","they","are","particularly\nrelevant","when","bridge","functions","are","nonunique.","Note","that","even","whenkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n→0and\nkπP\nw\n(ˆq−q\n0\n)k\n2\n→0,\nˆ\nhandπˆqmay","not","necessarily","convergence","to","any","fixed","limits","sinceH\nobs\n0\nandQ\nobs\n0\nneed","not","be","singletons.\nTo","control","these","errors","for","our","bridge","function","estimators,we","further","introduce","an","alternative\nfunction","class","complexity","measure","called","thecritical","radius[Bartlett","et","al.,","2005].\nDefinition","1(Localized","Rademacher","Complexity","and","Critical","Radius).Given","a","classGof\nfunctions","of","variablesO,","its","empirical","localized","Rademacher","complexity","with","respect","to","the\nsample{O\n1\n,...,O\nn\n}and","radiusη",">0is","defined","as\nR\nn\n(η;G)","=\n1\n2\nn\nX\nǫ∈{−1,+1}\nn\n\"\nsup\ng∈G:E\nn\n[g\n2\n]≤η\n2\n1\nn\nX\ni\nǫ\ni\ng(O\ni\n)\n#\n.\nWhenη=","+∞,","the","quantityR\nn\n(+∞;G)is","called","the","(global)","Rademacher","complexity.","The\ncritical","radius","ofGis","the","smallest","positiveηthat","satisfies","the","inequality\nR\nn\n(η;G)≤η\n2\n/kGk\n∞\n.\nIn","the","result","below,","we","first","bound","the","estimation","error","of","theoutcome","bridge","function\nestimator","in","terms","of","the","critical","radius","of","some","special","function","classes.\nTheorem","3(Convergence","rate","of\nˆ\nhwith","stabilizer).AssumeH\nobs\n0\n∩H6=∅,","andkHk\n∞\n,kYk\n∞\n<\n∞.","Fix","someh\n0\n∈H\nobs\n0\n∩Hand","further","assume","the","following","conditions:\n1.Q\n′\nis","symmetric","and","star-shaped","and","it","satisfiesP\nz\n(H−h\n0\n)⊂Q\n′\n.\n2.η\nh,n\nupper","bounds","the","critical","radii","ofQ\n′\nand","the","classG\nh\ndefined","as\nG\nh\n:\n=\n\b\n(w,z,a,x)7→(h(w,a,x)−h\n0\n(w,a,x))q(z,a,x)",":h∈H,q∈Q\n′\n\t\n.\nThen,","lettingO(·)be","the","order","wrtλ,δ,n,η\nh,n\n,","with","probability1−δ,","we","have\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n=O\n\u0012\u0012\n1","+λ+\n1\nλ\n\u0013\n\u0010\nη\nh,n\n+\np\n(1","+","log(1/δ))/n\n\u0011\n\u0013\n.\nIn","Theorem","3,","we","assume","the","realizability","condition","for","the","hypothesis","classH,","and","the\nclosedness","conditionP\nz\n(H−h\n0\n)⊂Q\n′\n.","The","latter","closedness","condition","is","invariant","to","choice","of\nh\n0\n∈H\nobs\n0\n∩H,","by","following","Eq.","(34).","This","closedness","condition","indicates","that","the","critic","class\nQ\n′\nis","rich","enough","relative","to","the","hypothesis","classH,","so","that","solving","the","minimax","formulation\nwith","stabilizers","is","equivalent","to","solving","the","corresponding","conditional","moment","equation","(see\nLemma","7).","Theorem","3","states","that","the","convergence","rate","of","outcome","bridge","function","estimator\nˆ\nh\nis","determined","by","the","critical","radiiη\nh,n\nof","the","critic","classQ\n′\nand","the","classG\nh\ninduced","by","bothH\nandQ\n′\n.","In","Section","6.1,","we","will","further","boundη\nh,n\nfor","common","function","classes.\nAnalogously,","we","can","also","bound","the","estimation","error","of","the","action","bridge","function","estimator\nunder","symmetric","conditions.\n17\n\nTheorem","4(Convergence","rate","ofˆqwith","stabilizer).AssumeQ\nobs\n0\n∩Q6=∅andkπQk\n∞\n,\nkπ(a|x)/f(a|x,w)k\n2\n<∞.","Fix","someq\n0\n∈Q\nobs\n0\n∩Qand","further","assume","the","following","condi-\ntions:\n1.H\n′\nis","symmetric","and","star-shaped,","and","it","satisfiesπP\nw\n(Q−q\n0\n)⊂H\n′\n.\n2.η\nq,n\nupper","bounds","the","critical","radii","ofH\n′\nand","the","classG\nq\ndefined","as\nG\nq\n:\n={(w,z,a,x)7→π(a|x)(q(z,a,x)−q\n0\n(z,a,x))h(w,a,x)",":q∈Q,h∈H\n′\n}.\nThen,","lettingO(·)be","the","order","wrtλ,δ,n,η\nq,n\n,","with","probability1−δ,","we","have\nkπP\nw\n(ˆq−q\n0\n)k\n2\n=O\n\u0012\u0012\n1","+λ+\n1\nλ\n\u0013\n\u0010\nη\nq,n\n+\np\n{1","+","log(1/δ)}/n\n\u0011\n\u0013\n.\nWe","finally","remark","that","the","use","of","stabiliziers","in","Eqs.","(14)","and(15)","plays","an","important","role","in\nderiving","the","convergence","rates","in","Theorems","3","and","4.","Without","stabilizers","(i.e.,λ=","0),","the","error\nbounds","in","Theorems","3","and","4","are","apparently","vacuous","since","they","scale","with1/λ.","Although","we","can\nuse","an","alternative","way","to","show","the","projected","MSE","convergenceof","bridge","functions","estimators\nthat","do","not","use","stabilizers,e.g.,","estimators","in","Eqs.","(11)","and","(12),","the","resulting","convergence","rates\nwill","be","slower","than","the","rates","of","bridge","functions","using","stabilizers.\nTheorem","5(Slow","convergence","rates","of\nˆ\nh,ˆqwithout","stabilizers).Consider","the","bridge","function\nestimators\nˆ\nh,ˆqin","Eqs.(11)and(12),","i.e.,","without","stabilizers","(unlike","the","rest","of","this","sectionand\nonly","for","this","theorem).\n1.","SupposeH∩H\nobs\n0\n6=∅and","take","someh\n0\n∈H∩H\nobs\n0\n.","","IfP\nz\n(H−h\n0\n)⊆Q\n′\nandQ\n′\nis\nsymmetric,","then\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n≤2\nr\nsup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[{y−h}q]|.\n2.","SupposeQ∩Q\nobs\n0\n6=∅and","take","someq\n0\n∈Q∩Q\nobs\n0\n.","IfπP\nw\n(Q−q\n0\n)⊆H\n′\n,","andH\n′\nis\nsymmetric,","then\nkπP\nw\n(ˆq−q\n0\n)k\n2\n≤2\nr\nsup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|.\nNote","that","Theorem","5","also","holds","for","estimators","in","Eqs.","(14)","and(15)","withλ=","0,","since","these\nestimtors","are","equivalent","to","estimators","in","in","Eqs.","(11)","and","(12)","whenH\n′\n,Q\n′\nare","symmetric","(see\ndiscussions","below","Lemma","7).","Crucially,","the","error","bounds","in","Theorem","5","typically","converge","more\nslowly","than","error","bounds","in","Theorems","3","and","4.","For","example,","when","we","use","VC-subgraph","classes,\nthe","rates","in","Theorem","5","areO(n\n−1/4\n),","while","the","rates","in","Theorems","3","and","4","for","bridge","function\nestimators","with","stabilizers","areO(n\n−1/2\n),","as","we","show","below.","","(Recall","that","in","Section","5.1","we\nshowed\nˆ\nJ\nREG\nand\nˆ\nJ\nIPW\nstill","nonetheless","converges","at","rateO(n\n−1/2\n)in","this","setting.)","As","another\nexample,","when","we","use","Hölder","balls,","the","rates","in","Theorem","5","areO(max(n\n−1/4\n,n\n−α/2d\n)),","while\nthe","rates","in","Theorems","3","and","4","areO(n\n−α/(2α+d)\n).\n6.1","","Convergence","Rates","of","Bridge","Function","Estimators","for","Com-\nmon","Function","Classes\nTheorems","3","and","4","show","that","the","convergence","rates","of","minimax","estimators\nˆ\nh,ˆqwith","stabilizers\n(Section","4.2)","are","determined","by","critical","radii","of","related","function","classes.","In","this","part,","we","further\nprovide","concrete","convergence","rates","for","these","function","classes.","We","focus","on","analyzingkP\nz\n(\nˆ\nh−\nh\n0\n)k\n2\nas","an","example.kπP\nw\n(ˆq−q\n0\n)k\n2\ncan","be","analyzed","analogously.\nWe","first","give","the","error","bounds","for","VC-subgraph","classes","in","Example","8","and","nonparametric\nclasses","(e.g.,","Hölder","balls,","Sobolev","balls)","in","Example","9.","The","bounds","are","derived","by","directly\nemploying","Theorem","3","and","bounding","the","critical","radii","of","thesefunction","classes.\nCorollary","4.Assume","that","the","conditions","in","Theorem","3","hold","for","someh\n0\n∈H∩H\nobs\n0\n.\n18\n\n1.","SupposeHandQ\n′\nare","VC-subgraph","classes","with","VC-subgraph","dimensionsV(H),V(Q\n′\n),\nrespectively.","Then,","lettingO(·)be","the","order","wrtn,δ,V(H),V(Q\n′\n),","with","probability1−δ,\nwe","have\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n=O(\np\n(V(Q\n′\n)","+V(H))","logn+","1","+","log(1/δ)/\n√\nn).\n2.","SupposeHandQ\n′\nare","classes","whose","metric","entropy","satisfies","that","for","a","constantβ",">0,\nmax(logN(ε,H,k·k\n∞\n),logN(ε,Q\n′\n,k·k\n∞\n))≤c\n0\n(1/ε)\nβ\n.\nThen,","lettingO(·)be","the","order","wrtn,β,δ,","with","probability1−δ,","we","have\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n=\n\n\n\n\n\nO(n\n−1/(2+β)\n+\np\nlog(1/δ)/n)β","<2\nO(n\n−1/4\nlogn+\np\nlog(1/δ)/n)β=","2\nO(n\n−1/(2β)\n+\np\nlog(1/δ)/n)β",">2\nIn","the","following","corollary,","we","also","prove","error","bounds","for","linear","sieves","as","in","Example","10.\nCorollary","5.LetH=S\n1,n\nandQ\n′\n=S\n2,n\nforS\n1,n\n,S\n2,n\nin","Eq.(31)satisfying","the","approximation\nconditions","in","Eqs.(32)and(33).","AssumeH\nobs\n0\n∩Λ\nα\n([0,1]\nd\n)6=∅,H⊆Λ\nα\n([0,1]\nd\n).","Additionally,\nsuppose","that","for","someh\n0\n∈H\nobs\n0\n∩Λ\nα\n([0,1]\nd\n)we","haveP\nz\n(Λ\nα\n([0,1]\nd\n)−h\n0\n)⊂Λ\nα\n([0,1]\nd\n).","Then,\nletting\n","̃\nO(·)be","the","order","wrtn,α,δup","to","poly","logarithmic","factors","inn,","with","probability1−δ,","we\nhave\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n=\n","̃\nO(n\n−α/(2α+d)\n+\np\nlog(1/δ)/n).\nIn","Corollary","5,","we","assume","realizibility","condition","and","closedness","condition","on","the","Hölder","ball\nΛ\nα\n([0,1]\nd\n),","rather","than","on","the","linear","sievesHandQ\n′\n.","","Therefore,","we","cannot","directly","apply\nTheorem","3","to","prove","Corollary","5,","just","like","we","cannot","prove","Corollary","3","by","directly","applying\nTheorem","1.","Instead,","we","need","to","use","a","generalized","version","of","Theorem","3","that","can","handle","addi-\ntional","bias","terms,","which","we","establish","in","Appendix","D,","and","thenbalance","the","bias","terms","with","the\nstochastic","errors","shown","in","Theorem","3.\n6.2","","Analysis","of","the","GACE","Estimator\nIn","this","part,","we","bound","the","errors","of","GACE","estimators","based","on","results","in","Theorems","3","and","4.\nBefore","deriving","these","error","bounds,","we","first","note","that","according","to","Lemma","5,","the","bias","of\nˆ\nJ\nREG\nand\nˆ\nJ\nIPW\ncan","be","bounded","by","the","projected","MSE","of","bridge","function","estimators","in","Eqs.","(34)\nand","(35).\nLemma","11.Under","the","assumptions","in","Lemma","5,","for","anyh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n,\n\f\n\f\n\f\nE[\n","̃\nφ\nREG\n(O;\nˆ\nh)|\nˆ\nh]−J\n\f\n\f\n\f\n≤kπq\n0\nk\n2\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n,\n\f\n\f\n\f\nE[\n","̃\nφ\nIPW\n(O;","ˆq)|ˆq]−J\n\f\n\f\n\f\n≤kh\n0\nk\n2\nkπP\nw\n(ˆq−q\n0\n)k\n2\n.\nIn","the","following","theorem,","we","first","derive","the","convergence","rates","of\nˆ\nJ\nREG\nand\nˆ\nJ\nIPW\nbased","on\nLemma","11,","Theorems","3","and","4.\nTheorem","6.1.","Under","the","conditions","of","Theorem","3,","if","further∅","6=πQ\nobs\n0\n⊆L\n2\n(Z,A,W),\nthen","with","probability","at","least1−δ,\n|\nˆ\nJ\nREG\n−J|=O\n\u0010\nR\nn\n(∞;TH)","+η\nh,n\n+\np\n(log(1/δ))/n\n\u0011\n.(36)\n2.","Under","the","conditions","of","Theorem","4",",","if","further∅6=H\nobs\n0\n⊆L\n2\n(X,A,W),","then","with","proba-\nbility","at","least1−δ,\n|\nˆ\nJ\nIPW\n−J|=O\n\u0010\nR\nn\n(∞;πQ)","+η\nq,n\n+\np\n(log(1/δ))/n\n\u0011\n.(37)\nHereR\nn\n(∞;TH)andR\nn\n(∞;πQ)are","the","gloabl","Rademacher","complexity","(see","Definition","1)\nof","function","classesTHandπQ,","respectively.\n19\n\nIn","the","right","hand","sides","of","Eqs.","(36)","and","(37),","the","global","Radamacher","complexity","bound\nthe","variances","due","to","plugging","in","estimted","bridge","functions","rather","than","true","ones,","and","the","crit-\nical","radiiη\nq,n\n,η\nh,n\nbound","the","plug-in","bias.","Typically,","the","critical","radiiη\nq,n\n,η\nh,n\ndominate","in\nthese","two","error","bounds.","Therefore,","the","convergence","rates","of\nˆ\nJ\nREG\n,J\nIPW\nare","typically","the","same\nas","the","convergence","rates","of","bridge","function","estimators","in","terms","of","projected","MSE","(see","Theo-\nrems","3","and","4).","Notably,","these","convergence","rates","are","often","slower","than","the","convergence","rates\nin","Theorem","1.","For","example,","for","nonparametric","classes","with","a","metric","entropy","exponentβ(see\nExample","9),","the","convergence","rates","in","Theorem","6","becomeO\n\u0010\nn\n−1/max(2β,β+2)\n\u0011\naccording","to\nCorollary","4","statement","2,","while","the","convergence","rates","in","Theorem","1","becomeO\n\u0010\nn\n−1/max(2,β)\n\u0011\naccording","to","Corollary","2.","This","shows","potential","advantage","ofminimax","bridge","function","estima-\ntorswithoutstabilizers.","However,","we","stress","that","Theorem","6","and","Theorem","1are","based","on","quite\ndifferent","assumptions","so","they","are","not","directly","comparable.","For","example,","Theorem","6","inherits","the\nclosedness","assumptions","for","the","critic","classes","from","Theorems","3","and","4,","while","Theorem","1","requires\nrealizability","assumptions","for","the","critic","classes.\nNext,","we","derive","the","convergence","rates","of","the","doubly","robust","estimator\nˆ\nJ\nDR\n.\nTheorem","7(Analysis","of","DR","estimators).Assume","the","conditions","of","Theorem","6","statement","1\nhold","andkπQk\n∞\n<∞.","Then,","with","probability1−δ,\n|\nˆ\nJ\nDR\n−J|=O\n\u0010\nR\nn\n(∞;πQ{y−H}+TH)","+η\nh,n\n+\np\n(1","+","log(1/δ))/n\n\u0011\n.\nAssume","the","conditions","of","Theorem","6","statement","2","hold","andkHk\n∞\n<∞.","Then,","with","probability\n1−δ,\n|\nˆ\nJ\nDR\n−J|=O\n\u0010\nR\nn\n(∞;πQ{y−H}+TH)","+η\nq,n\n+\np\n(1","+","log(1/δ))/n\n\u0011\n.\nAgain,","the","two","error","bounds","above","for\nˆ\nJ\nDR\nare","typically","dominated","byη\nh,n\nandη\nq,n\n,","re-\nspectively.","Thus","Theorem","7","suggests","that\nˆ\nJ\nDR\nis","consistent","when","the","projected","MSE","of","either\nthe","outcome","bridge","function","estimator\nˆ\nhorthe","action","bridge","function","estimatorˆqvanishes","to\n0.","In","particular,","if","the","projected","MSE","of","either","bridge","function","estimator","converges","at\n√\nnrate,\nthen\nˆ\nJ\nDR\nis\n√\nn-consistent.","This","result","is","reminiscent","of","the","doubly","robustness","property","in","the\nunconfounded","setting","[e.g.,","Bang","and","Robins,","2005].\n6.3","","Tighter","Analysis","of","the","Doubly","Robust","Estimator\nIn","Theorem","9,","we","showed","that","the","convergence","rate","of","the","doubly","robust","estimator\nˆ\nJ\nDR\nis\ndetermined","by","the","projected","MSE","convergence","rate","of","a","singlebridge","function","estimator,","when\nconditions","in","either","Theorem","3orTheorem","4","are","satisfied.","","In","this","section,","we","show","that","if\nconditions","inboththeorems","are","satisfied,","and","the","related","inverse","problems","arenot","too","ill-posed,\nthen","the","doubly","robust","estimator\nˆ\nJ\nDR\ncan","converge","at","a","much","faster","rate","than","the","bridge\nfunction","estimators.\nWe","first","introduce","measures","of","the","ill-posedness","of","the","inverse","problems","defined","by","conditional\nmoment","equations","in","Eqs.","(5)","and","(6),","relative","to","the","hypothesis","classesH,Q.\nDefinition","2.[Measures","of","Ill-posedness","of","Inverse","Problems]","Fixh\n0\n∈H\nobs\n0\n∩Handq\n0\n∈\nQ\nobs\n0\n∩Q.","Define","the","ill-posedness","measuresτ\nH\n1,n\n,τ\nQ\n1,n\n∈R\n+\nandτ\nH\n2,n\n,τ\nQ\n2,n\n∈R\n+\nas","follows:\nτ\nH\n1,n\n=","sup\nh∈H\nkE[h−h\n0\n|A,U,X]k\n2\nkE[h−h\n0\n|Z,A,X]k\n2\n,","τ\nQ\n1,n\n=","sup\nq∈Q\nkE[π(q−q\n0\n)|A,U,X]k\n2\nkE[π(q−q\n0\n)|W,A,X]k\n2\n.(38)\nτ\nH\n2,n\n=","sup\nh∈H\nkh−h\n0\nk\n2\nkE[h−h\n0\n|Z,A,X]k\n2\n,","τ\nQ\n2,n\n=","sup\nq∈Q\nkπ(q−q\n0\n)k\n2\nkE[π(q−q\n0\n)|W,A,X]k\n2\n.(39)\nIn","this","definition,","we","follow","the","convention\n0\n0\n=","0.","Note","the","subscriptnimplies","the","possible\n(but","not","necessary)","dependence","onn,","which","is","relevant","ifHandQgrow","withn.\n20\n\nTo","interpret","the","ill-posedness","measures","above,","let","us","focusonτ\nH\n1,n\nandτ\nH\n2,n\nas","examples\nand","note","thatE[h−h\n0\n|Z,A,X]","=E[E[h−h\n0\n|A,U,X]|Z,A,X]according","to","Assumption","1\ncondition","4.","This","means","that","we","have","two","different","levels","of","inverse","problems:","the","first","involves\ninvertingE[h−h\n0\n|A,U,X]fromE[h−h\n0\n|Z,A,X],","and","the","second","involves","invertingh−h\n0\nfromE[h−h\n0\n|Z,A,X]forh∈H.","","The","degrees","of","ill-posedness","of","these","two","levels","relative\nto","the","hypothesis","classHare","quantified","byτ\nH\n1,n\nandτ\nH\n2,n\n,","respectively.","Obviously,","we","have1≤\nτ\nH\n1,n\n≤τ\nH\n2,n\n,","which","agrees","with","the","fact","that","the","second","level","of","inverse","problem","is","no","less","ill-posed\nthan","the","first","one.","Note","thatτ\nH\n1,n\nis","invariant","to","the","choice","ofh\n0\n∈H\nobs\n0\n,","sinceE[h\n0\n|Z,A,X]","=\nE[Y|Z,A,X]andE[h\n0\n|U,A,X]","=E[Y|U,A,X]for","anyh\n0\n∈H\nobs\n0\naccording","to","Eqs.","(2)\nand","(5).","Soτ\nH\n1,n\nmay","be","finite","even","when","the","bridge","function","is","not","uniquely","identified.","In\ncontrast,τ\nH\n2,n\nis","obviously+∞whenH\nobs\n0\n∩His","not","a","singleton.","","Moreover,","note","that","the\ndefinition","ofτ\nH\n1,n\nandτ\nH\n2,n\ndepend","on","the","choice","of","hypothesis","classH(which","can","change","with\nn).","","When","specialized","to","linear","sieves","(Example","10),","these","measures","are","related","to","the","sieve\nill-posedness","measures","introduced","in","Blundell","et","al.","[2003].\nThe","ill-posedness","measures","in","Definition","2","directly","influence","the","convergence","behavior","of\nminimax","bridge","function","estimators","in","different","error","measures.","","For","example,","ifτ\nH\n1,n\n<+∞\nandτ\nH\n2,n\n<+∞for","alln,","then","for","the","minimax","estimator\nˆ\nh,","the","error","bound","onkP\nz\n(\nˆ\nh−h\n0\n)k\nderived","in","Theorem","3","easily","translate","into","bounds","onkE[\nˆ\nh−h\n0\n|A,U,X]k\n2\n(see","Theorem","8)\nandk\nˆ\nh−h\n0\nk\n2\n,","with","additional","inflation","factors","ofτ\nH\n1,n\nandτ\nH\n2,n\n,","respectively.","So","largerτ\nH\n1,n\nandτ\nH\n2,n\n,i.e.,","more","ill-posed","inverse","problems,","correspond","to","slower","convergence","rates","in","terms\nofkE[\nˆ\nh−h\n0\n|A,U,X]k\n2\nandk\nˆ\nh−h\n0\nk\n2\n.","At","the","extreme,","if","these","ill-posedness","measures","are\ninfinite,","then","convergence","in","terms","ofkP\nz\n(\nˆ\nh−h\n0\n)kdoes","not","necessarily","imply","convergence","in\nterms","ofkE[\nˆ\nh−h\n0\n|A,U,X]k\n2\nork\nˆ\nh−h\n0\nk\n2\n.","","The","ill-posedness","measures","depend","both","on\nthe","data","generating","process","and","on","the","choices","of","hypothesisclassesH,Q.","As","is","discussed","in\nBlundell","et","al.","[2003]","for","linear","sieves,","larger","hypothesisclasses","typically","correspond","to","bigger","ill-\nposedness","measures.","Therefore,","the","choice","of","hypothesis","classesH,Qcan","considerably","influence\nthe","convergence","of","bridge","function","estimators","not","only","through","their","realizability","and","complexity\n(e.g.,","the","critical","radii)","but","also","their","induced","ill-posedness.\nNext,","we","slightly","revise","our","doubly","robust","estimator","by","cross-fitting","the","bridge","function","esti-\nmators,","a","technique","that","has","been","widely","used","in","semiparametric","estimation","to","remove","restrictive\nDonsker","conditions","on","hypothesis","classes","[e.g.,","Zheng","and","van","der","Laan,","2011,","Chernozhukov","et","al.,\n2018].","For","simplicity,","we","focus","on","two-fold","cross-fitting.","It","is","straightforward","to","extend","our","re-\nsults","to","cross-fitting","with","more","folds.\nDefinition","3(Cross-fitted","DR","Estimator).Randomly","split","the","whole","sample","into","two","halves\ndenoted","asD\n0\n,D\n1\n.","Then","forj=","0,1,","fit\nˆ\nh\n(j)\n,ˆq\n(j)\nbased","onD\nj\naccording","to","Eqs.","(14)","and","(15),\nrespectively.","Finally,","redefine","the","doubly","robust","GACE","estimator","by\nˆ\nJ\nDR\n=\n1\nn\nn\nX\ni=1\nπ(A\ni\n|X\ni\n)ˆq\n(I\ni\n)\n(Z\ni\n,A\ni\n,X\ni\n){Y\ni\n−\nˆ\nh\n(I\ni\n)\n(W\ni\n,A\ni\n,X\ni\n)}+","(T\nˆ\nh\n(I\ni\n)\n)(W\ni\n,X\ni\n),\nwhereI\ni\n=I[i∈D\n0\n].\nNow","we","derive","the","property","of","the","cross-fitted","DR","estimator","interms","of","the","ill-posedness\nmeasuresτ\nH\n1,n\n,τ\nQ\n1,n\nin","Eq.","(38),withoutassuming","unique","bridge","functions.\nTheorem","8.[Tighter","analysis","of","DR","estimator","without","unique","bridge","functions]","Suppose","the\nconditions","in","Theorems","3","and","4","hold.","Then","with","probability1−δ,\nkE[\nˆ\nh−h\n0\n|A,U,X]k\n2\n=O\n\u0010\nτ\nH\n1,n\n\u0010\nη\nh,n\n+\np\n{1","+","log(1/δ)}/n\n\u0011\u0011\n,(40)\nkE[π(ˆq−q\n0\n)|A,U,X]k\n2\n=O\n\u0010\nτ\nQ\n1,n\n\u0010\nη\nq,n\n+\np\n{1","+","log(1/δ)}/n\n\u0011\u0011\n,(41)\n|\nˆ\nJ\nDR\n−J|=O\n\u0010\nτ\nH\n1,n\nτ\nQ\n1,n\n\u0010\nη\nh,n\n+\np\n{1","+","log(1/δ)}/n\n\u0011\u0010\nη\nq,n\n+\np\n{1","+","log(1/δ)}/n\n\u0011\u0011\n(42)\nTheorem","8","shows","that","the","doubly","robust","estimator\nˆ\nJ\nDR\nconverges","faster","than","the","bridge\nfunction","estimators\nˆ\nh,ˆqin","terms","of","their","error","measures","in","Eqs.","(40)","and","(41).","","In","partic-\nular,","ifτ\nH\n1,n\nτ\nQ\n1,n\nη\nh,n\nη\nq,n\n=o(n\n−1/2\n),i.e.,","the","inverse","problems","are","not","too","ill-posed,","then\n21\n\nˆ\nJ\nDR\nis\n√\nn-consistent.","","To","compare","this","with","the","result","in","Section","5,","let","us","suppose","that","all\nrelevant","function","classes","areΛ\nα\n\u0000\n[0,1]\nd\n\u0001\nas","an","example.","","In","this","case,","the","convergence","rate\nhere","for","the","doubly","robust","estimtor","based","on","bridge","functionestimatorswithstabilizers","is\nmax(τ\nH\n1,n\nτ\nQ\n1,n\nn\n−2α/(2α+d)\n,n\n−1/2\n),","while","the","convergence","rate","in","Theorem","2","for","the","estimtorwith-\noutstabilizers","ismax(n\n−α/(2α+d)\n,n\n−1/2\n).","Therefore,","the","estimator","with","stabilizers","can","achieve\nfaster","rate","if","the","ill-posedness","measures","satisfyτ\nH\n1,n\nτ\nQ\n1,n\n=o\n\u0010\nn\nα/(2α+d)\n\u0011\n.","The","convergence","rate\nhere","can","be","faster","primarily","because","the","realizability","and","closedness","assumptions","in","Theorems","3\nand","4","and","the","assumptions","of","limited","ill-posedness","ensure","that","bridge","function","estimators","con-\nverge","to","valid","observed","bridge","functions","in","terms","of","error","measures","in","Eqs.","(40)","and","(41),","while\nunder","only","realizability","assumptions","in","Theorem","2,","the","bridge","function","estimators","may","have","no\nrelation","to","the","true","bridge","functions","at","all.\nHowever,","since","bridge","functions","can","be","nonunique,","the","minimax","estimators\nˆ\nh,ˆqmay","not\nconverge","to","any","fixed","limit,","despite","the","fact","that","the","error","measures","in","Eqs.","(40)","and","(41)","vanish\nto0.","","In","this","case,","even","ifτ\nH\n1,n\nτ\nQ\n1,n\nη\nh,n\nη\nq,n\n=o(n\n−1/2\n)so","that\nˆ\nJ\nDR\nis\n√\nn-consistent,","certain\nstochastic","equicontinuity","term","(i.e.,","Eq.","(58)","in","Appendix","E.5)","will","contribute","to","nonnegligible\nbut","intractable","asymptotic","variance,","so","it","is","difficult","to","derive","the","asymptotic","distribution","of\nˆ\nJ\nDR\n.","In","the","following","lemma,","we","further","assume","that","the","hypothesis","classes","targetuniquebridge\nfunctions,","and","show","conditions","that","enable\nˆ\nJ\nDR\nto","then","have","asymptotic","normal","distribution\nwith","a","closed-form","variance.\nTheorem","9.Suppose","that","conditions","in","Theorem","3","and","Theorem","4","hold,H∩H\nobs\n0\n={h\n0\n}and\nπQ∩πQ\nobs\n0\n={πq\n0\n}.","Then\nˆ\nJ\nDR\n−J=E\nn\n[\n","̃\nφ\nDR\n(O;h\n0\n,q\n0\n)]","+O\np\n\u0010\nmin(τ\nH\n2,n\n,τ\nQ\n2,n\n)η\nq,n\nη\nh,n\n\u0011\n.\nIt","follows","that","ifmin(τ\nH\n2,n\n,τ\nQ\n2,n\n)η\nq,n\nη\nh,n\n=o(n\n−1/2\n),","then\n√\nn\n\u0010\nˆ\nJ\nDR\n−J\n\u0011\nd\n→N(0,V\neff\n),\nwhereV\neff\n=E\nh\n","̃\nφ\n2\nDR\n(O;h\n0\n,q\n0\n)\ni\n.\nIn","Theorem","9,","whenH,Qcan","change","withn,","the","assumptions","of","unique","bridge","functions\nshould","be","understood","in","terms","of","their","limiting","spaces.","For","example,","whenH,Qare","linear","sieves\nin","Example","10,","we","can","replace","the","uniqueness","assumptions","byH\nobs\n0\n∩Λ\nα\n\u0000\n[0,1]\nd\n\u0001\n={h\n0\n}and\nπQ\nobs\n0\n∩Λ\nα\n\u0000\n[0,1]\nd\n\u0001\n={πq\n0\n}.","Then","we","can","easily","prove","the","same","conclusion","given","the","sieve\napproximation","conditions","in","Eqs.","(32)","and","(33).","Similar","to","Theorem","8,","the","convergence","rate","of\nˆ\nJ\nDR\nin","Theorem","9","is","faster","than","the","convergence","rate","of","bridge","function","estimators\nˆ\nhandˆqin\nL\n2\nerror","measures.","However,","althoughτ\nH\n1,n\nτ\nQ\n1,n\nη\nh,n\nη\nq,n\n=o(n\n−1/2\n)suffices","for\n√\nn-consistency\nof\nˆ\nJ\nDR\naccording","to","Theorem","8,","Theorem","9","suggests","that","we","needmin(τ\nH\n2,n\n,τ\nQ\n2,n\n)η\nq,n\nη\nh,n\n=\no\n\u0010\nn\n−1/2\n\u0011\nfor","the","asymptotic","normality.","Therefore,","by","requiring","uniqueness","of","bridge","functions\nand","restricting","the","ill-posedness","of","more","difficult","inverse","problems,","Theorem","9","proves","a","stronger\nasymptotic","normality","conclusion.\nFinally,","we","remark","that","the","asymptotic","varianceV\neff\nin","Theorem","9","coincides","with","the","semi-\nparametric","efficiency","bound","derived","in","Appendix","C","under","additional","regularity","conditions.","Our\nresults","thus","extend","the","asymptotic","efficiency","results","in","Cui","et","al.","[2020]","who","study","estimating\nthe","average","treatment","effect","with","a","binary","action","variable","and","a","focus","on","parametric","estimation\nof","bridge","functions.\n7","","Related","Literature\nNegative","Controls.Miao","et","al.","[2018a]","first","studied","the","identification","of","counterfactual","dis-\ntributions","with","negative","controls","under","completeness","conditions.","Their","results","extend","previous\nliterature","on","identification","with","proxy","variables","in","nonclassical","measurement","error","models","based\non","stronger","assumptions","[e.g.,","Hu","and","Schennach,","2008,","Kuroki","and","Pearl,","2014].","","Shi","et","al.\n22\n\n[2020]","focus","on","multiply","robust","estimation","of","the","average","treatment","effect","with","negative","con-\ntrols","when","unmeasured","confounders","(U)","as","well","as","negative","controls","(Z,W)","are","categorical.\nMiao","et","al.","[2018b]","proposes","to","estimate","the","average","treatment","effect","based","on","parametric","mod-\nels","for","a","unique","outcome","bridge","function","(h\n0\nin","Assumption","2)","under","completeness","conditions\nsimilar","to","those","assumed","in","Miao","et","al.","[2018a].","The","estimation","and","inference","is","carried","out","in","the\nstandard","Generalized","Method","of","Moments","(GMM)","framework","[Hansen,","1982].","Tchetgen","et","al.\n[2020]","further","extend","this","method","to","longitudinal","studies.Cui","et","al.","[2020]","derive","the","semipara-\nmetric","efficiency","bound","for","average","treatment","effect","based","on","both","the","outcome","bridge","function\nand","action","bridge","function,","provided","that","these","bridge","functions","uniquely","exist","and","some","com-\npleteness","conditions","also","hold.","Our","work","extends","these","previous","literature","in","several","aspects.\nFirst,","our","paper","focuses","on","a","generalized","average","causal","effect","with","a","general","action","space","that\ncan","be","either","continuous","or","discrete,","which","generalizes","theaverage","treatment","effect","with","discrete\ntreatment","studied","in","previous","literature","(see","Example","1).","Second,","the","assumptions","in","this","paper\nare","weaker","than","the","aforementioned","literature,","in","that","we","allow","for","nonunique","bridge","functions\n8\nand","do","not","assume","any","completeness","condition.","See","more","detailed","discussions","in","Appendices","A\nand","B.","Third,","our","minimax","estimation","procedures","accommodate","both","nonparametric","models","and\nparametric","models","for","the","bridge","functions,","while","the","aforementioned","literature","only","consider\nparametric","estimation.\nDeaner","[2021]","studies","the","identification","of","counterfactualmean","on","the","treated,","based","on","both\nthe","outcome","bridge","function","and","the","action","bridge","function.Notably,","Deaner","[2021]","also","allows\nthe","bridge","functions","to","be","nonunique","but","does","require","completeness","conditions,","albeit","weaker\nthan","those","assumed","in","Miao","et","al.","[2018a],","Cui","et","al.","[2020].","Moreover,","Deaner","[2021]","focues","on\nnonparametric","estimation","for","the","outcome","bridge","function","based","on","penalized","sieve","minimum\ndistance","estimation","[Chen","and","Pouzo,","2012,","2015],","and","estimate","the","final","estimand","based","on","an\nestimating","equation","analogous","to\n","̃\nφ\nREG\nin","Lemma","4.","Compared","to","Deaner","[2021],","the","minimax\nestimation","approach","in","our","paper","is","more","flexible","and","can","leverage","a","wide","array","of","machine\nlearning","methods","such","as","RKHS","methods","and","neural","networks","rather","than","just","sieve","methods.\nIn","addition,","our","paper","studies","estimators","based","on","all","threeestimating","equations,i.e.,\n","̃\nφ\nIPW\n,\n","̃\nφ\nREG\n,","and\n","̃\nφ\nDR\nin","Lemma","4.","Furthermore,","we","do","not","assume","any","completeness","condition","and\ninstead","we","provide","a","new","proof","for","identification","in","Lemma","4.\nInstrumental","variable","estimation","and","minimax","estimationEstimation","of","the","out-\ncome","bridge","functionh\n0\nis","closely","related","to","the","nonparametric","instrumental","variable","(IV)","re-\ngression","problem","[Newey,","2013].","Our","paper","nonetheless","differs","significantly","from","these","previous\nliterature.","First,","the","conditional","moment","equation","for","theaction","bridge","functionq\n0\nin","Eq.","(6)\nis","distinct","from","the","IV","conditional","moment","equation","since","itincludes","an","unknown","density,","and\nnaively","applying","the","minimax","reformulations","will","introduce","the","extra","nuisance.","See","the","discus-\nsions","below","Lemma","6.","Second,","our","target","estimand","is","the","GACEJrather","than","bridge","functions,\nso","most","of","our","analysis","is","substantially","different","from","previous","literature.","For","example,","our","new\nanalysis","shows","that","our","GACE","estimator","with","bridge","functions","estimated","by","the","first","minimax\nreformulation","in","Eq.","(7)","remains","consistent","even","when","the","bridge","function","estimators","are","incon-\nsistent","(see","Example","7).","Despite","of","these","differences,","as","we","mentioned,","the","estimation","ofh\n0\nitself\nis","similar","to","the","IV","regression","problem.","Therefore,","we","next","summarize","the","relevant","literature\non","IV","regression.\nThe","nonparametric","IV","problem","is","typically","cast","into","the","frame","work","of","conditional","moment\nequations","[e.g.,","Chen","and","Qiu,","2016,","Ai","and","Chen,","2003].","One","classical","approach","to","this","problem\nis","a","nonparametric","analogue","of","the","two-stage","least","squares","(2SLS)","method","based","on","sieve","esti-\nmators","[Newey","and","Powell,","2003]","or","kernel","density","estimators","[Darolles","et","al.,","2010,","Hall,","2005,\nCarrasco","et","al.,","2007].","Another","classical","approach","is","to","usesieves","to","convert","the","conditional","mo-\nments","into","unconditional","moments","of","of","increasing","dimension","[e.g.,","Chen,","2007,","Ai","and","Chen,\n2003,","Chen","and","Qiu,","2016],","and","then","combine","all","unconditional","moments","via","standard","GMM\nmethod","[Hansen,","1982].","Later,","Hartford","et","al.","[2017],","Singhet","al.","[2019]","extend","the","two-stage\napproach","by","employing","neural","network","density","estimator","or","conditional","mean","embedding","in\n8\nAlthough","Tchetgen","et","al.","[2020],","Shi","et","al.","[2020],","Miao","et","al.","[2018a]","briefly","touch","upon","nonunique","bridge","func-\ntions","in","parametric","models,","they","do","not","thoroughly","investigate","this","in","their","estimation","methods.\n23\n\nRKHS","respectively","in","the","first","stage.","Deaner","[2021],","Singh","[2020]","apply","these","methods","for","the\nestimation","of","outcome","bridge","functions.","However,","it","remains","unclear","how","to","incorporate","more\ngeneral","hypothesis","classes","while","still","providing","rigoroustheoretical","guarantees","for","nonparametric\nestimators,","on","par","with","results","in","previous","classical","literature.\nRecently,","there","have","been","intense","interest","in","minimax","approaches","that","reformulate","the","non-\nparametric","IV","regression","problem","via","Eq.","(7),","Eq.","(13),","or","other","closely","related","variants.","The","re-\nsulting","minimax","formulation","is","more","analogous","to","the","M-estimation","(or","empirical","risk","minimiza-\ntion)","framework","predominant","in","machine","learning","and","statistics,","which","naturally","permits","more\ngeneral","function","classes.","For","example,","Lewis","and","Syrgkanis[2018],","Zhang","et","al.","[2020]","use","the","re-\nformulation","in","Eq.","(7),","while","Dikkala","et","al.","[2020],","Chernozhukov","et","al.","[2020],","Liao","et","al.","[2020]\nemploy","the","reformulation","in","Eq.","(13).","","Moreover,","Bennett","et","al.","[2019],","Bennett","and","Kallus\n[2020],","Muandet","et","al.","[2020]","consider","different","variants","that","are","closely","related","to","the","refor-\nmulation","in","Eq.","(13).","","However,","as","we","dicuss","below","Lemma","7,","thedistinction","between","the\nreformulations","in","Eq.","(7)","and","Eq.","(13)","are","subtle.","Notably,","Dikkala","et","al.","[2020]","provide","a","thor-\nough","analysis","of","the","convergence","rates","of","their","minimax","estimators.","We","build","on","their","analysis\ntechnique","when","analyzing","the","bridge","function","estimators","based","on","estimation","strategy","II","in\nSection","4.2","(see","Theorem","3).\nMinimax","estimators","have","been","also","employed","in","a","variety","of","other","contexts,","such","as","the","esti-\nmation","of","the","causal","effects","[Wong","and","Chan,","2018,","Chernozhukov","et","al.,","2020,","Hirshberg","and","Wager,\n2019]","and","reinforcement","learning","policy","evalution","[Feng","etal.,","2019,","Uehara","et","al.,","2020,","Yang","et","al.,\n2020],","when","all","confounders","are","measured.","Unlike","these","literature,","our","paper","focuses","on","the\nmore","challenging","setting","with","unmeasured","confounders","and","addresses","the","confounding","problem\nby","using","negative","controls.\n8","","Conclusions","and","Future","Work\nIn","this","paper","we","tackled","a","central","challenge","in","doing","causal","inferences","using","negative","controls:\nestimating","the","bridge","functions.","We","developed","an","alternative","identification","strategy","that","es-\nchewed","both","uniqueness","and","completeness","assumptions","that","were","imposed","on","bridge","functions\nin","previous","approaches","and","that","may","be","dubious","in","practice.","We","proposed","new","minimax","es-\ntimators","for","the","bridge","functions","that","were","amenable","to","general","function","approximation.","We\nstudied","the","behavior","of","these","bridge","function","estimators","and","the","resulting","GACE","estimators\nunder","a","range","of","different","assumptions.","Depending","on","how","muchone","is","willing","to","assume,","we\nshowed","different","rates","of","convergence.","In","some","settings,","GACE","estimators","remained","consistent\neven","when","bridge","function","estimators","were","not.","In","other","settings,","the","GACE","estimator","was\nshown","to","achieve","the","semiparametric","efficiency","bound.\nOur","work","can","be","extended","to","tackle","complex","estimation","in","other","settings.","","For","example,\nboth","Tennenholtz","et","al.","[2020],","Lee","and","Bareinboim","[2021]","study","complex","settings","where","a","causal\nestimand","is","identified","using","a","proxy","or","negative-control","approach","–","the","first","a","partially-observable\nreinforcement","learning","setting","and","the","second","a","more","general","directed","acyclic","graph","setting","–\nbut","both","focus","on","the","setting","ofdiscretedata","distributions","for","simplicity.","By","leveraging","our\nwork,","which","allows","flexible","hypothesis","classes,","we","may","be","able","to","tackle","these","more","complicated\nsettings","on","continuous","spaces","with","lax","assumptions","and","strong","guarantees.\nReferences\nChunrong","Ai","and","Xiaohong","Chen.","","Efficient","estimation","of","modelswith","conditional","moment\nrestrictions","containing","unknown","functions.Econometrica,","71:1795–1843,","2003.\nH.","Bang","and","J.","M.","Robins.","","Doubly","robust","estimation","in","missingdata","and","causal","inference\nmodels.Biometrics,","61:962–973,","2005.\nPeter","L.","Bartlett,","Olivier","Bousquet,","and","Shahar","Mendelson.Local","rademacher","complexities.\nAnn.","Statist.,","33(4):1497–1537,","2005.\n24\n\nAndrew","Bennett","and","Nathan","Kallus.","","The","variational","method","ofmoments.arXiv","preprint\narXiv:2012.09422,","2020.\nAndrew","Bennett,","Nathan","Kallus,","and","Tobias","Schnabel.","Deep","generalized","method","of","moments\nfor","instrumental","variable","analysis.","InAdvances","in","Neural","Information","Processing","Systems","32,\npages","3564–3574.","2019.\nRichard","Blundell,","Xiaohong","Chen,","and","Dennis","Kristensen.","Semi-nonparametric","iv","estimation\nof","shape-invariant","engel","curves.Econometrica,","75(6):1613–1669,","2003.\nMarine","Carrasco,","Jean-Pierre","Florens,","and","Eric","Renault.","Chapter","77","linear","inverse","problems\nin","structural","econometrics","estimation","based","on","spectral","decomposition","and","regularization.","In\nHandbook","of","Econometrics,","volume","6,","pages","5633–5751.","Elsevier","B.V,","2007.\nXiaohong","Chen.","Chapter","76","large","sample","sieve","estimation","of","semi-nonparametric","models.Hand-\nbook","of","Econometrics,","6:5549–5632,","2007.\nXiaohong","Chen","and","Demian","Pouzo.","Estimation","of","nonparametric","conditional","moment","models\nwith","possibly","nonsmooth","generalized","residuals.Econometrica,","80(1):277–321,","2012.\nXiaohong","Chen","and","Demian","Pouzo.","Sieve","wald","and","qlr","inferences","on","semi/nonparametric","con-\nditional","moment","models.Econometrica,","83(3):1013–1079,","2015.\nXiaohong","Chen","and","Yin","Jia","Jeff","Qiu.","Methods","for","nonparametricand","semiparametric","regressions\nwith","endogeneity:","A","gentle","guide.Annual","Review","of","Economics,","(8):259–290,","2016.\nVictor","Chernozhukov,","Denis","Chetverikov,","Mert","Demirer,","Esther","Duflo,","Christian","Hansen,","Whit-\nney","Newey,","and","James","Robins.","Double/debiased","machine","learning","for","treatment","and","struc-\ntural","parameters.Econometrics","Journal,","21:C1–C68,","2018.\nVictor","Chernozhukov,","Whitney","Newey,","Rahul","Singh,","and","Vasilis","Syrgkanis.","Adversarial","estima-\ntion","of","riesz","representers.arXiv","preprint","arXiv:2101.00009,","2020.\nYifan","Cui,","Hongming","Pu,","Xu","Shi,","Wang","Miao,","and","Eric","Tchetgen","Tchetgen.","Semiparametric\nproximal","causal","inference.arXiv","preprint","arXiv:2011.08411,","2020.\nSerge","Darolles,","Yanqin","Fan,","Jean-Pierre","Florens,","and","Eric","Renault.","Nonparametric","instrumental\nregression.Econometrica,","79(5):1541–1565,","2010.\nConstantinos","Daskalakis,","Andrew","Ilyas,","Vasilis","Syrgkanis,","and","Haoyang","Zeng.","Training","gans\nwith","optimism.ICLR,","2018.\nBen","Deaner.","Proxy","controls","and","panel","data.arXiv","preprint","arXiv:1810.00283,","2021.\nNishanth","Dikkala,","Greg","Lewis,","Lester","Mackey,","and","Vasilis","Syrgkanis.","Minimax","estimation","of\nconditional","moment","models.","In","H.","Larochelle,","M.","Ranzato,","R.Hadsell,","M.","F.","Balcan,","and\nH.","Lin,","editors,Advances","in","Neural","Information","Processing","Systems,","volume","33,","pages","12248–\n12262,","2020.\nMiroslav","Dudik,","Dumitru","Erhan,","John","Langford,","and","Lihong","Li.","Doubly","robust","policy","evaluation\nand","optimization.Statistical","Science,","29:485–511,","2014.\nXavier","D’Haultfoeuille.","On","the","completeness","condition","in","nonparametric","instrumental","problems.\nEconometric","Theory,","27(3):460–471,","2011.\nYihao","Feng,","Lihong","Li,","and","Qiang","Liu.","","A","kernel","loss","for","solving","the","bellman","equation.","","In\nAdvances","in","Neural","Information","Processing","Systems,","volume","32,","2019.\nDylan","J.","Foster","and","Vasilis","Syrgkanis.","","","Orthogonal","statistical","learning.arXiv","preprint\narXiv:1901.09036,","2019.\n25\n\nA.","R.","Hall.Generalized","method","of","moments.","Oxford","University","Press,","2005.\nLars","Peter","Hansen.","","Large","sample","properties","of","generalized","method","of","moments","estimators.\nEconometrica,","50:1029–1054,","1982.\nJason","Hartford,","Greg","Lewis,","Kevin","Leyton-Brown,","and","Matt","Taddy.","Deep","IV:","A","flexible","ap-\nproach","for","counterfactual","prediction.","InProceedings","of","the","34th","International","Conference","on\nMachine","Learning,","volume","70,","pages","1414–1423,","2017.\nKeisuke","Hirano","and","Guido","W.","Imbens.","The","propensity","score","with","continuous","treatments.","InAp-\nplied","Bayesian","Modeling","and","Causal","Inference","from","Incomplete-Data","Perspectives,","chapter","7,\npages","73–84.","John","Wiley","&","Sons,","Ltd,","2004.\nDavid","Hirshberg","and","Stefan","Wager.","","Augmented","minimax","linearestimation.arXiv","preprint\narXiv:1712.00038,","2019.\nYingyao","Hu","and","Susanne","M","Schennach.","Instrumental","variable","treatment","of","nonclassical","mea-\nsurement","error","models.Econometrica,","76(1):195–216,","2008.\nYingyao","Hu","and","Ji-Liang","Shiu.","Nonparametric","identificationusing","instrumental","variables:","Suf-\nficient","conditions","for","completeness.Econometric","Theory,","34(3):659–693,","2011.\nGuido","W.","Imbens","and","Donald","B.","Rubin.Causal","Inference","for","Statistics,","Social,","and","Biomedical\nSciences:","An","Introduction.","2015.\nPrateek","Jain","and","Purushottam","Kar.","","Non-convex","optimizationfor","machine","learning.arXiv\npreprint","arXiv:1712.07897,","2017.\nEdward","H","Kennedy.","Nonparametric","causal","effects","based","on","incremental","propensity","score","inter-\nventions.Journal","of","the","American","Statistical","Association,","114:645–656,","2019.\nDiederik","P","Kingma","and","Jimmy","Ba.","Adam:","A","method","for","stochasticoptimization.ICLR,","2015.\nKeith","Knight","and","Wenjiang","Fu.","Asymptotics","for","lasso-type","estimators.Annals","of","statistics,\npages","1356–1378,","2000.\nRainer","Kress.Linear","Integral","Equations.","Applied","mathematical","sciences","(Springer-Verlag","New\nYork","Inc.)",";","v.","82.","Springer","New","York",":","Imprint:","Springer,","NewYork,","NY,","3rd","ed.","2014.\nedition,","2014.\nManabu","Kuroki","and","Judea","Pearl.","Measurement","bias","and","effect","restoration","in","causal","inference.\nBiometrika,","101(2):423–437,","2014.\nS.","Lee","and","E.","Bareinboim.","Causal","identification","with","matrix","equations.Columbia","CausalAI\nLaboratory","Technical","Report","(R-70),","2021.\nGreg","Lewis","and","Vasilis","Syrgkanis.","Adversarial","generalizedmethod","of","moments.arXiv","preprint\narXiv:1803.07164,","2018.\nLuofeng","Liao,","You-Lin","Chen,","Zhuoran","Yang,","Bo","Dai,","Mladen","Kolar,","and","Zhaoran","Wang.","Prov-\nably","efficient","neural","estimation","of","structural","equation","models:","An","adversarial","approach.","In\nAdvances","in","Neural","Information","Processing","Systems,","volume","33,","pages","8947–8958,","2020.\nShahar","Mendelson.","Improving","the","sample","complexity","using","global","data.IEEE","transactions","on\nInformation","Theory,","48(7):1977–1991,","2002.\nWang","Miao,","Zhi","Geng,","and","Eric","J","Tchetgen","Tchetgen.","Identifying","causal","effects","with","proxy\nvariables","of","an","unmeasured","confounder.Biometrika,","105(4):987–993,","2018a.\nWang","Miao,","Xu","Shi,","and","Eric","Tchetgen","Tchetgen.","A","confoundingbridge","approach","for","double\nnegative","control","inference","on","causal","effects.arXiv","preprint","arXiv:1808.04945,","2018b.\n26\n\nKrikamol","Muandet,","Arash","Mehrjou,","Si","Kai","Lee,","and","Anant","Raj.","Dual","instrumental","variable\nregression.","","In","H.","Larochelle,","M.","Ranzato,","R.","Hadsell,","M.","F.","Balcan,","and","H.","Lin,","editors,\nAdvances","in","Neural","Information","Processing","Systems,","volume","33,","pages","2710–2721,","2020.\nIván","Díaz","Muñoz","and","Mark","Van","Der","Laan.","","Population","intervention","causal","effects","based","on\nstochastic","interventions.Biometrics,","68(2):541–549,","2012.\nWhitney","K.","Newey.","Nonparametric","instrumental","variables","estimation.The","American","economic\nreview,","103(3):550–556,","2013.\nWhitney","K.","Newey","and","James","L.","Powell.","Instrumental","variableestimation","of","nonparametric\nmodels.Econometrica,","71(5):1565–1578,","2003.\nJ.","M.","Robins,","A.","Rotnitzky,","and","L.","P.","Zhao.","Estimation","of","regression","coefficients","when","some\nregressors","are","not","always","observed.Journal","of","the","American","Statistical","Association,","89:846–\n866,","1994.\nThomas","A","Severini","and","Gautam","Tripathi.","Efficiency","bounds","for","estimating","linear","functionals","of\nnonparametric","regression","models","with","endogenous","regressors.Journal","of","Econometrics,","170\n(2):491–498,","2012.\nXu","Shi,","Wang","Miao,","Jennifer","C","Nelson,","and","Eric","J","Tchetgen","Tchetgen.","Multiply","robust","causal\ninference","with","double-negative","control","adjustment","for","categorical","unmeasured","confounding.\nJournal","of","the","Royal","Statistical","Society:","Series","B","(Statistical","Methodology),","82(2):521–540,\n2020.\nRahul","Singh.","","Kernel","methods","for","unobserved","confounding:","Negative","controls,","proxies,","and\ninstruments.arXiv","preprint","arXiv:2012.10315,","2020.\nRahul","Singh,","Maneesh","Sahani,","and","Arthur","Gretton.","Kernel","instrumental","variable","regression.","In\nAdvances","in","Neural","Information","Processing","Systems,","volume","32,","2019.\nEric","J","Tchetgen","Tchetgen,","Andrew","Ying,","Yifan","Cui,","Xu","Shi,","andWang","Miao.","An","introduction\nto","proximal","causal","learning.arXiv","preprint","arXiv:2009.10982,","2020.\nGuy","Tennenholtz,","Uri","Shalit,","and","Shie","Mannor.","Off-policy","evaluation","in","partially","observable\nenvironments.Proceedings","of","the","AAAI","Conference","on","Artificial","Intelligence,","34(06):10276–\n10283,","Apr.","2020.\nJin","Tian.","Identifying","dynamic","sequential","plans.","InProceedings","of","the","Twenty-Fourth","Conference\non","Uncertainty","in","Artificial","Intelligence,","UAI’08,","page","554–561,","2008.\nMasatoshi","Uehara,","Jiawei","Huang,","and","Nan","Jiang.","Minimax","weight","and","q-function","learning","for\noff-policy","evaluation.ICML","2020","(To","appear),","2020.\nA.","W.","van","der","Vaart.Asymptotic","statistics.","Cambridge","University","Press,","Cambridge,","UK,","1998.\nMartin","J","Wainwright.High-Dimensional","Statistics",":","A","Non-Asymptotic","Viewpoint.","Cambridge\nUniversity","Press,","New","York,","2019.\nRaymond","K","W","Wong","and","Kwun","Chuen","Gary","Chan.","Kernel-based","covariate","functional","balancing\nfor","observational","studies.Biometrika,","105(1):199–213,","2018.\nMengjiao","Yang,","Ofir","Nachum,","Bo","Dai,","Lihong","Li,","and","Dale","Schuurmans.","Off-policy","evalua-\ntion","via","the","regularized","lagrangian.","InAdvances","in","Neural","Information","Processing","Systems,\nvolume","33,","pages","6551–6561,","2020.\nRui","Zhang,","Masaaki","Imaizumi,","Bernhard","Schölkopf,","and","Krikamol","Muandet.","Maximum","moment\nrestriction","for","instrumental","variable","regression.arXiv","preprint","arXiv:2010.07684,","2020.\nWenjing","Zheng","and","Mark","J","van","der","Laan.","Cross-validated","targeted","minimum-loss-based","esti-\nmation.","InTargeted","Learning:","Causal","Inference","for","Observational","andExperimental","Data,\nSpringer","Series","in","Statistics,","pages","459–474.","Springer","NewYork,","New","York,","NY,","2011.\n27\n\nA","","Comparing","Identification","Strategies\nLiteratureExistence","of","Bridge","Fun.UniquenessCompleteness","Conditions\nMiao","et","al.","[2018b]H\n0\n6=∅YesAssumption","5","condition","1\nShi","et","al.","[2020]H\nobs\n0\n6=∅Yes\n9\nAssumption","5","condition","1\nCui","et","al.","[2020]H\nobs\n0\n6=∅,Q\nobs\n0\n6=∅Yes\nAssumption","3","conditions","1-2,\nAssumption","5\nDeaner","[2021]H\nobs\n0\n6=∅,Q\nobs\n0\n6=∅NoAssumption","3","conditions","1-2\nOur","paperH\n0\n6=∅,Q\n0\n6=∅NoNo\nTable","2:","Assumptions","for","estimation","in","negative","control","literature.","","Note","that","Assumption","1","is\nassumed","in","all","literature","so","we","suppress","it","in","this","table.","Here","“Uniqueness”","refers","to","whether","bridge\nfunctions","are","assumed","to","be","unique.\nIn","Table","2,","we","list","the","assumptions","assumed","in","different","literature","on","negative","controls.","One\nnotable","difference","between","our","paper","and","previous","literature","is","that","our","paper","does","not","assume\nany","completeness","condition","but","previous","papers","do.","In","this","section,","we","describe","the","identification\nstrategy","in","previous","literature","that","relies","on","completeness","conditions","in","detail,","and","compare","it\nwith","our","identification","strategy","via","Lemmas","4","and","5.\nWe","first","recall","the","sets","of","bridge","functions","given","by","the","conditional","moment","equations","in\nEqs.","(2)","and","(3):\nH\n0\n={h∈L\n2\n(W,A,X)",":E[Y−h(W,A,X)|A,U,X]","=","0},\nQ\n0\n={q:πq∈L\n2\n(Z,A,X),E[π(A|X)","(q(Z,A,X)−1/f(A|U,X))|A,U,X]","=","0},\nand","the","sets","of","bridge","functions","given","by","the","observed","data","conditional","moment","equations","in\nEqs.","(5)","and","(6):\nH\nobs\n0\n={h∈L\n2\n(W,A,X)",":E[Y−h(W,A,X)|Z,A,X]","=","0},\nQ\nobs\n0\n={q:πq∈L\n2\n(Z,A,X),E[π(A|X)","(q(Z,A,X)−1/f(A|W,X))|W,A,X]","=","0}.\nIn","Lemma","2,","we","already","show","that","any","bridge","functions","inH\n0\nandQ\n0\ncan","identify","the","causal\nparameter.","However,","we","can","not","directly","learn","functions","inH\n0\nandQ\n0\nfrom","the","observed","data,\nbecause","they","depend","on","the","unmeasured","confoundersU.","Instead,","we","can","only","learn","functions","in\nH\nobs\n0\nandQ\nobs\n0\nfrom","the","observed","data.","Although","in","Lemma","3,","we","already","show","thatH\n0\n⊆H\nobs\n0\nandQ\n0\n⊆Q\nobs\n0\n,","the","converse","may","not","be","true.","","In","other","words,","functions","inH\nobs\n0\nandQ\nobs\n0\nthat","we","can","learn","from","observed","data","may","not","necessarily","belong","toH\n0\nandQ\n0\n.","Thus","without\nfurther","conditions,","we","cannot","use","Lemma","2","for","identification,","since","this","lemma","only","applies","to\nfunctions","inH\n0\nandQ\n0\n.\nPrevious","literature","handle","this","problem","by","assuming","the","following","completeness","conditions.\nAssumption","3.Consider","the","following","conditions:\n1.","For","anyg(A,U,X)∈L\n2\n(A,U,X),E[g(A,U,X)|W,A,X]","=","0only","wheng(A,U,X)","=","0.\n2.","For","anyg(A,U,X)∈L\n2\n(A,U,X),E[g(A,U,X)|Z,A,X]","=","0only","wheng(A,U,X)","=","0.\nWith","these","completeness","conditions,","we","can","show","thatQ\nobs\n0\n=Q\n0\nandH\nobs\n0\n=H\n0\n,","namely,\nany","bridge","functions","that","we","can","learn","from","the","observed","data(i.e.,","functions","inQ\nobs\n0\nandH\nobs\n0\n)\nare","indeed","nominal","bridge","function","(i.e.,","functions","inQ\n0\nandH\n0\n).\nLemma","12.Suppose","Assumption","1","holds.\n1.","If","Assumption","3","condition","1","further","holds,","thenQ\nobs\n0\n=Q\n0\n.\n2.","If","Assumption","3","condition","2","further","holds,","thenH\nobs\n0\n=H\n0\n.\n9\nThis","paper","only","very","briefly","touches","on","nonuniqueness,","and","focuses","on","unique","bridge","functions","in","the","estimation.\n28\n\nTherefore,","by","assuming","completeness","conditions","in","Assumption","3,","previous","literature","can\nuse","Lemma","2","to","identify","the","causal","parameter","by","anyq\n0\n∈Q\nobs\n0\n=Q\n0\nand/orh\n0\n∈H\nobs\n0\n=H\n0\n.\nRemark","1.Although","it","appears","that","Shi","et","al.","[2020],","Miao","et","al.","[2018b]","do","not","assume","com-\npleteness","conditions","in","Assumption","3,","their","identificationstrategy","is","actually","the","same","as","those\ndo","assume","Assumption","3:","they","impose","some","other","assumption","that","implicitly","ensuresH\nobs\n0\n=H\n0\n,\nso","that","they","can","still","use","Lemma","2","to","achieve","identification.","In","Miao","et","al.","[2018b],","they","assume\nthatH\n0\n6=∅,i.e.,H\n0\ncontains","at","least","one","function,","and","thatH\nobs\n0\nis","a","singleton.","Moreover,\nLemma","2","impliesH\n0\n⊆H\nobs\n0\n,i.e.,H\n0\ncontains","at","most","one","function,","thusH\n0\nmust","be","identical\ntoH\nobs\n0\n.","Shi","et","al.","[2020]","studies","discrete","negative","controls","and","unmeasured","confounders","(see\nExample","4),","and","focuses","on","the","setting","where","these","variableshave","the","same","number","of","values,\ni.e.,|W|=|Z|=|U|.","In","this","case,","they","assume","that","the","matrixP(W|Z,a,x)is","invertible","for\nanya∈A,x∈X(see","Assumption","5","condition","1","below).","It","is","easy","to","show","that","this","condition\nimplies","thatP(U|Z,a,x)is","also","invertible,","namely,","Assumption","3","condition","2","holds.Thus,\nShi","et","al.","[2020]","implicitly","requiresH\nobs\n0\n=H\n0\nas","well.\nIn","contrast,","our","paper","assumesH\n0\n6=∅andQ\n0\n6=∅directly,","which","in","turn","impliesH\nobs\n0\n6=∅\nandQ\nobs\n0\n6=∅according","to","Lemma","3.","Then","we","prove","identification","based","on","functions","inH\nobs\n0\nandQ\nobs\n0\nby","Lemmas","4","and","5,","without","assuming","any","completeness","conditions","(see","Fig.","2","for","an\nillustration).","Suprisingly,","we","show","that","identification","can","be","even","achieved","byh\n0\n∈H\nobs\n0\n\\H\n0\nandq\n0\n∈Q\nobs\n0\n\\H\n0\nwhenH\n0\n6=∅andQ\n0\n6=∅.","Therefore,","we","do","not","need","any","completeness\nconditions","to","ensureH\nobs\n0\n=H\n0\norQ\nobs\n0\n=Q\n0\n.\nRemark","2.In","Appendix","B.1,","we","also","show","another","role","of","Assumption","3:","condition","1","with\nsome","additional","regularity","conditions","can","ensure","the","existence","of","outcome","bridge","functionh\n0\nthat","satisfiesE[h\n0\n(W,A,X)|A,U,X]","=μ(A,U,X),","and","condition","2","with","similar","regularity","con-\nditions","can","ensure","the","existence","of","action","bridge","functionq\n0\nthat","satisfiesE[π(A|X)q\n0\n(Z,A,X)|\nA,U,X]","=\nπ(A|X)\nf(A|U,X)\n.","In","other","words,","completeness","conditions","1","and","2","together","with","additional\nregularity","conditions","can","ensure","our","Assumption","2,i.e.,H\n0\n6=∅andQ\n0\n6=∅.\nB","","Completeness","Conditions\nIn","Appendix","A,","we","show","that","completeness","conditions","in","Assumption","3","play","an","important","role\nin","the","identification","strategy","in","previous","literature.","In","this","section,","we","review","some","related","com-\npleteness","conditions,","discuss","about","their","relations,","and","further","describe","how","our","assumptions","in\nSection","2","differ","from","those","in","previous","literature.","For","completeness","conditions","in","other","settings,\nsuch","as","nonparametric","instrumental","variable","models,","see","review","and","discussions","in","Hu","and","Shiu\n[2011],","D’Haultfoeuille","[2011],","Darolles","et","al.","[2010],","Newey","and","Powell","[2003].","Throughout","this\nsection,","we","always","assume","Assumption","1","so","we","suppress","this","assumption","in","all","statements.\nIn","the","following","assumptions,","we","list","two","other","completeness","conditions","that","also","involve\nthe","unobserved","confoundersU.","Although","these","conditions","are","not","directly","assumed","in","previous\nliterature,","we","will","show","in","Lemma","14","that","they","are","implied","by","some","other","conditions","assumed\nin","previous","literature.\nAssumption","4.Consider","the","following","conditions:\n1.","For","anyg(W,A,X)∈L\n2\n(W,A,X),E[g(W,A,X)|A,U,X]","=","0only","wheng(W,A,X)","=","0.\n2.","For","anyg(Z,A,X)∈L\n2\n(Z,A,X),E[g(Z,A,X)|A,U,X]","=","0only","wheng(Z,A,X)","=","0.\nIn","the","following","lemma,","we","further","show","that","completeness","conditions","3","and","4","in","Assump-\ntion","3","can","ensure","the","uniqueness","of","bridge","functions.\nLemma","13.If","completeness","condition","1","in","Assumption","4","holds,","thenH\n0\nis","either","empty","or\na","singleton.","If","completeness","condition","2","in","Assumption","4","holds,","thenQ\n0\nis","either","empty","or","a\nsingleton.\nNext,","we","introduce","two","completeness","conditions","that","involve","only","observed","variables.\nAssumption","5.Consider","the","following","conditions:\n1.","For","anyg(W,A,X)∈L\n2\n(W,A,X),E[g(W,A,X)|Z,A,X]","=","0only","wheng(W,A,X)","=","0.\n29\n\n2.","For","anyg(Z,A,X)∈L\n2\n(Z,A,X),E[g(Z,A,X)|W,A,X]","=","0only","wheng(Z,A,X)","=","0.\nIn","the","following","lemma,","we","further","show","the","relationship","among","Assumptions","3","to","5.\nLemma","14.Assume","Assumption","1","holds.\n1.","If","Assumptions","3","and","4","hold,","then","Assumption","5","holds.\n2.","If","Assumption","5","holds,","then","Assumption","4","holds.\nLemma","14","shows","that","Assumptions","3","and","4","are","sufficient","for","Assumption","5,","and","Assumption","5\nis","sufficient","for","Assumption","4.","Since","Assumption","4","ensure","unique","bridge","functions","according\nto","Lemma","13,","assuming","Assumption","5","[Cui","et","al.,","2020]","implicitly","requires","the","bridge","functions\nto","be","unique.","","However,","our","paper","shows","that","this","uniquenss","requirement","is","too","strong","by\nExamples","4","and","5.","Thus","we","intentionally","avoid","assuming","uniqueness","as","much","as","possible.\nMoreover,","just","like","completeness","conditions,","conditions","in","Assumption","3","can","ensureH\n0\n6=∅\nandQ\n0\n6=∅under","additional","regularity","conditions","(see","Remark","2","and","Lemmas","16","and","17),\nAssumption","5","can","also","ensureH\nobs\n0\n6=∅andQ\nobs\n0\n6=∅under","similar","regularity","conditions.","The\nlatter","is","the","starting","point","of","identification","strategy","in","Miao","et","al.","[2018b,a],","Cui","et","al.","[2020].\nIn","contrast,","our","paper","starts","with","assumingH\n0\n6=∅andQ\n0\n6=∅directly","without","relying","on","any\ncompleteness","conditions","and","additional","regularity","conditions.\nWe","believe","that","our","approach","is","desirable","for","several","reasons.","","First,","completeness","con-\nditions","and","the","associated","regularity","conditions","are","generally","difficult","to","interpret","or","verify\n[Newey","and","Powell,","2003],","so","it","is","appealing","to","get","rid","of","these","conditions.","","Second,","as","we\nshow","in","Examples","4","and","5,","confounding","models","that","relate","unmeasured","confounders","to","negative\ncontrols","may","directly","inform","sufficient","conditions","forH\n0\n6=∅andQ\n0\n6=∅,","while","it","is","less","straight-\nforward","to","do","so","forH\nobs\n0\n6=∅andQ\nobs\n0\n6=∅.","This","is","probably","also","one","reason","why","previous\nliterature","often","turn","to","opaque","completeness","conditions","toensureH\nobs\n0\n6=∅andQ\nobs\n0\n6=∅rather\nthan","motivate","it","from","data","generating","processes.","Third,","requiring","completeness","conditions","in\nAssumption","5","to","ensureH\nobs\n0\n6=∅andQ\nobs\n0\n6=∅may","result","in","stronger","restrictions","than","requiring\nH\n0\n6=∅andQ\n0\n6=∅.","Take","the","discrete","setting","in","Example","4","as","an","example.","We","already","show\nthat","under","the","rank","conditions","in","Example","4,H\n0\n6=∅andQ\n0\n6=∅need|W|≥|U|and|Z|≥|U|.\nIn","contrast,","if","we","assume","completeness","conditions","in","Assumption","5","to","justifyH\nobs\n0\n6=∅and\nQ\nobs\n0\n6=∅,","then","we","would","require|W|=|Z|=|U|.\nProposition","1.Consider","the","setting","in","Example","4.","Assume","Assumption","1","holdsand","matri-\ncesP(W|U,a,x)∈R\n|W|×|U|\n,P(U|W,a,x)∈R\n|U|×|W|\n,P(Z|U,a,x)∈R\n|Z|×|U|\n,P(U|\nZ,a,x)∈R\n|U|×|Z|\nall","have","rank|U|for","anya∈A,x∈X.\n1.","if","condition","1","in","Assumption","5","holds,","then|Z|≥|W|=|U|.\n2.","if","condition","2","in","Assumption","5","holds,","then|W|≥|Z|=|U|.\nNote","the","rank","conditions","alone","only","require|W|≥|U|and|Z|≥|U|.\nB.1","","Completeness","Conditions","and","Existence","of","Bridge","Functions\nIn","this","section,","we","show","the","existence","of","bridge","functions","inEqs.","(2)","and","(3)","under","the","com-\npleteness","conditions","in","Assumption","3","conditions","1","and","2","and","some","additional","regularity","con-\nditions,","using","the","singular","value","decomposition","approach","in","Kress","[2014],","Miao","et","al.","[2018a],\nCarrasco","et","al.","[2007].\nCharacterize","the","linear","operators","associated","with","Eqs.","(2)and","(3).LetK\nW|a,x\n:\nL\n2\n(W|A=a,X=x)→L\n2\n(U|A=a,X=x)andK\nZ|a,x\n:L\n2\n(Z|A=a,X=x)→L\n2\n(U|\nA=a,X=x)be","the","linear","operators","defined","as","follows:\n[K\nW|a,x\nh](a,u,x)","=E[h(W,a,x)|A=a,U=u,X=x]","=\nZ\nK(w,a,u,x)h(w,a,x)f(w|a,x)dμ(w),\n[K\nZ|a,x\nq](a,u,x)","=E[q(Z,a,x)|A=a,U=u,X=x]","=\nZ\nK\n′\n(z,a,u,x)h(z,a,x)f(z|a,x)dμ(w),\n30\n\nwhereK(w,a,u,x)andK\n′\n(z,a,u,x)are","the","corresponding","kernel","functions","defined","as","follows:\nK(w,a,u,x)","=\nf(w,u|a,x)\nf(u|a,x)f(w|a,x)\n,","K\n′\n(z,a,u,x)","=\nf(z,u|a,x)\nf(u|a,x)f(z|a,x)\n.\nTheir","adjoint","operatorsK\n∗\nW|a,x\n:L\n2\n(U|A=a,X=x)→L\n2\n(W|A=a,X=x)and\nK\n∗\nZ|a,x\n:L\n2\n(U|A=a,X=x)→L\n2\n(Z|A=a,X=x)are","given","as","follows:\n[K\n∗\nW|a,x\ng](w,a,x)","=\nZ\nK(w,a,u,x)g(u,a,x)f(u|a,x)dμ(w)","=E[g(U,a,x)|W=w,A=a,X=x],\n[K\nZ|a,x\ng](z,a,x)","=\nZ\nK\n′\n(z,a,u,x)g(a,u,x)f(u|a,x)dμ(w)","=E[g(U,a,x)|Z=z,A=a,X=x].\nThe","existence","of","bridge","functions","is","equivalent","to","existence","of","solutions","to","the","following\nequations","of","the","first","kind:\n[K\nW|a,x\nh](a,u,x)","=k\n0\n(a,u,x),[K\nZ|a,x\nq](a,u,x)","=","1/f(a|u,x),a.e.u,a,xw.r.tP.\nTo","ensure","this","existence,","we","further","assume","the","following","conditions.\nAssumption","6.Assume","that","for","almost","everya,x:\n1.\nRR\nf(w|u,a,x)f(u|w,a,x)dμ(w)dμ(u)<∞.\n2.\nRR\nf(z|u,a,x)f(u|z,a,x)dμ(z)dμ(u)<∞.\nAccording","to","Example","2.3","in","Carrasco","et","al.","[2007,","P5659],","Assumption","6","ensures","that","both\nK\nW|a,x\nandK\nZ|a,x\nare","compact","operators.","","Then","by","Theorem","2.41","in","Carrasco","et","al.","[2007,\nP5660],","bothK\nW|a,x\nandK\nZ|a,x\nadmit","singular","value","decomposition:","there","exist\n\u0010\nλ\nj\nW|a,x\n,φ\nj\nW|a,x\n,ψ\nj\nW|a,x\n\u0011\n+∞\nj=1\n,\n\u0010\nλ\nj\nZ|a,x\n,φ\nj\nZ|a,x\n,ψ\nj\nZ|a,x\n\u0011\n+∞\nj=1\nwith","orthonormal","sequences\nn\nφ\nj\nW|a,x\n∈L\n2\n(W|a,x)\no\n,\nn\nφ\nj\nZ|a,x\n∈L\n2\n(Z|a,x)\no\n,\nn\nψ\nj\nW|a,x\n∈L\n2\n(U|a,x)\no\n,\nn\nψ\nj\nZ|a,x\n∈L\n2\n(U|a,x)\no\nsuch","that\nK\nW|a,x\nφ\nj\nW|a,x\n=λ\nj\nW|a,x\nψ\nj\nW|a,x\n,","K\nZ|a,x\nφ\nj\nZ|a,x\n=λ\nj\nZ|a,x\nψ\nj\nZ|a,x\n.\nExistence","of","bridge","functions.Following","Miao","et","al.","[2018a],","we","use","the","Picard’s","Theo-\nrem","[Kress,","2014,","Theorem","15.18]","to","characterize","the","existence","of","solutions","to","equations","of","the\nfirst","kind","by","the","singular","value","decomposition","of","the","associated","operators.\nLemma","15(Picard’s","Theorem).LetK:H\n1\n→H\n2\nbe","a","compact","operator","with","singular","system\n(λ\nj\n,φ\nj\n,ψ\nj\n)\n+∞\nj=1\n,","andφbe","a","given","function","inH\n2\n.","Then","the","equation","of","the","first","kindKh=φ\nhave","solutions","if","and","only","if\n1.φ∈N(K\n∗\n)\n⊥\n,","whereN(K\n∗\n)","={h:K\n∗\nh=","0}is","the","null","space","of","the","adjoint","operatorK\n∗\n.\n2.\nP\n+∞\nn=1\nλ\n−2\nn\n|hφ,ψ\nn\ni|\n2\n<+∞.\nIn","the","following","two","lemmas,","we","show","the","existence","of","bridge","functions","under","the","complete-\nness","conditions.\nLemma","16.Assume","Assumption","3","condition","1,","Assumption","6","condition","1","and","the","following\nconditions","for","almost","alla,x:\n•k\n0\n(a,U,x)∈L\n2\n(U|A=a,X=x).\n•\nP\n+∞\nj=1\n\u0010\nλ\nj\nW|a,x\n\u0011\n−2\nn\nR\nk\n0\n(a,u,x)ψ\nj\nW|a,x\n(u,a,x)dμ(u)\no\n2\n<∞.\nThen","there","exists","functionh\n0\n∈L\n2\n(W|A=a,X=x)for","almost","alla,xsuch","that\nE[Y−h\n0\n(W,A,X)|A,U,X]","=","0.\n31\n\nLemma","17.Assume","Assumption","3","condition","2","and","Assumption","6","condition","2and","the","following\nconditions","for","almost","alla,x:\n•\nπ(a|x)\nf(a|U,x)\n∈L\n2\n(U|A=a,X=x).\n•\nP\n+∞\nj=1\n\u0010\nλ\nj\nZ|a,x\n\u0011\n−2\nn\nR\nπ(a|x)\nf(a|u,x)\nψ\nj\nZ|a,x\n(u,a,x)dμ(u)\no\n2\n<∞.\nThen","there","exists","functionq\n0\nsuch","that\nE[π(A|X)q\n0\n(Z,A,X)|A,U,X]","=\nπ(A|X)\nf(A|U,X)\nandπ(a|x)q\n0\n(Z,a,x)∈L\n2\n(Z|A=a,X=x)for","almost","alla,x.\nC","","Semiparametric","Efficiency","Bound\nIn","this","section,","we","derive","the","semiparametric","efficiency","bound","forJ=E\n\u0002\nR\nY(a)π(a|X)d(a)\n\u0003\nunder","a","nonparametric","modelM\nnp\nin","which","bridge","functionsh\n0\nandq\n0\nare","unrestricted.","Cru-\ncially,","our","efficiency","analysis","follows","Severini","and","Tripathi","[2012]","and","doesnotrequire","unique\nexistence","of","bridge","functions.","Therefore,","our","analysis","strictly","generalizes","the","efficiency","results\nin","Cui","et","al.","[2020].","When","specialized","to","the","average","treatment","effect","with","discrete","treatments\nand","unique","bridge","functions,","our","efficiency","bound","coincides","with","the","bound","in","Theorem","3.1","of\nCui","et","al.","[2020].\nWe","first","recall","thatP\nz\n:L\n2\n(W,A,X)→L\n2\n(Z,A,X)is","the","conditional","expectation","operator\ngiven","byP\nz\n(g)(Z,A,X)\n:\n=E[g(W,A,X)|Z,A,X],andP\nw\n:L\n2\n(Z,A,X)→L\n2\n(W,A,X)is\ngiven","byP\nw\n(g)(W,A,X)\n:\n=E[g(Z,A,X)|W,A,X].","For","anyh∈L\n2\n(W,A,X),","defineP\nN(P\nz\n)\nh\nandP\nN(P\nz\n)\n⊥\nhas","the","projection","ofhonto","the","null","space","of","the","operatorP\nz\nand","its","orthog-\nonal","complement","respectively.","","Similarly,","we","can","defineP\nN(P\nw\n)\nπqandP\nN(P\nw\n)\n⊥\nπqfor","any\nq∈L\n2\n(Z,A,X).\nAs","we","show","in","Lemma","4,","the","GACEJcan","be","identified","by","any","bridge","functions","that","satisfy\nEqs.","(5)","and","(6),","namely,","any","bridge","functions","inH\nobs\n0\nandQ\nobs\n0\n.","Although","these","bridge","func-\ntions","may","not","be","unique,","the","following","lemma","shows","that","theirprojections","onto","the","orthogonal\ncomplement","of","the","null","space","of","the","corresponding","linear","operator","are","always","unique.\nLemma","18.For","anyh\n0\n,h\n′\n0\n∈H\nobs\n0\nandq\n0\n,q\n′\n0\n∈Q\nobs\n0\n,\nP\nN(P\nz\n)\n⊥\nh\n0\n=P\nN(P\nz\n)\n⊥\nh\n′\n0\n,","πP\nN(P\nw\n)\n⊥\nq\n0\n=πP\nN(P\nw\n)\n⊥\nq\n′\n0\n.\nGiven","Lemma","18,","we","can","defineh\n∗\n0\n=P\nN(P\nz\n)\n⊥\nH\nobs\n0\nandπq\n∗\n0\n=πP\nN(P\nw\n)\n⊥\nQ\nobs\n0\n.","If","bridge\nfunctions","happen","to","be","unique,i.e.,H\nobs\n0\n={h\n0\n}andπQ\nobs\n0\n={πq\n0\n},","then","obviouslyh\n∗\n0\n=h\n0\nandπq\n∗\n0\n=πq\n0\n.\nIn","order","to","derive","the","efficiency","bound,","we","further","assume","the","following","regularity","conditions\nunder","the","modelM\nnp\n.\nAssumption","7.1.","Suppose\nE[(Y−h\n∗\n0\n(W,A,X))Th\n∗\n0\n(W,X)\n+π(A|X)q\n∗\n0\n(Z,A,X)","(Y−h\n∗\n0\n(W,A,X))\n2\n|Z,A,X]∈Range(P\nz\n),(43)\nE\n\u0002\n(π(A|X))\n2\nq\n∗2\n0\n(Z,A,X)","(E[Y|W,Z,A,X]−h\n∗\n0\n(W,A,X))|W,A,X\n\u0003\n−E[π(A|X)q\n∗\n0\n(Z,A,X)E[π(A|X)q\n∗\n0\n(Z,A,X)","(E[Y|W,Z,A,X]−h\n∗\n0\n(W,A,X))|W,X]|W,A,X]\n∈Range(P\nw\n).(44)\n2.","For","almost","alla∈A,z∈Z,x∈X,\nE\nh\n(π(A|X)q\n∗\n0\n(Z,A,X))\n2\ni\n<∞,E\nh\n(Th\n∗\n0\n(W,X)−J)\n2\ni\n<∞,\nE\nh\n(Y−h\n∗\n0\n(W,A,X))\n2\n|A=a,Z=z,X=x\ni\n<∞.\n32\n\nIn","Assumption","7,","Eq.","(43)","is","ensured","by","the","Assumption","10(3)","in","Cui","et","al.","[2020],","if","the\nbridge","functions","are","unique","andJis","average","treatment","effect","for","discrete","treatments.","We","choose\nto","assume","Eq.","(43)","directly","rather","than","conditions","more","similar","to","those","in","Cui","et","al.","[2020]","to\navoid","inverting","some","complicated","operators","in","Cui","et","al.","[2020].","Moreover,","Eq.","(44)","is","completely\nnew.","This","condition","is","needed","to","ensure","that","the","efficient","influence","functionEIF(J)proposed\nin","Theorem","10","satisfies","the","semiparametric","restriction","due","to","the","existence","of","action","bridge\nfunctions","functionq\n0\n.","Theorem","3.1","in","Cui","et","al.","[2020]","appears","to","omit","this","restriction","in","their\nproof.\nTheorem","10.Under","Assumptions","1,","2","and","7,","the","efficient","influence","function","ofJrelative","to\nthe","tangent","space","implied","byM\nnp\n(i.e.,Sin","in","Eq.(67))","is","the","following:\nEIF(J)","=π(A|X)q\n∗\n0\n(Z,A,X)[Y−h\n∗\n0\n(W,A,X)]","+Th\n∗\n0\n(W,X)−J.\nThe","corresponding","semiparametric","efficiency","bound","ofJisV\neff\n=E\n\u0002\nEIF\n2\n(J)\n\u0003\n.\nWhen","the","bridge","functions","happen","to","be","unique,","the","efficient","influence","function","and","efficiency\nbound","easily","follow","from","Theorem","10.\nCorollary","6.Under","the","assumptions","in","Theorem","10,","if","further","the","bridge","functions","are","unique,\ni.e.,H\nobs\n0\n={h\n0\n}andπQ\nobs\n0\n={πq\n0\n},","then","the","efficient","influence","function","ofJrelative","to","the\ntangent","space","implied","byM\nnp\n(i.e.,Sin","in","Eq.(67))","is","the","following:\nEIF(J)","=π(A|X)q\n0\n(Z,A,X)[Y−h\n0\n(W,A,X)]","+Th\n0\n(W,X)−J.\nThe","corresponding","semiparametric","efficiency","bound","ofJisV\neff\n=E\n\u0002\nEIF\n2\n(J)\n\u0003\n.\nIn","Theorem","9,","we","show","that","our","GACE","estimator","proposed","in","Section","6.3","can","attain","the\nefficiency","bound","in","Corollary","6","when","the","bridge","functions","are","unique.\nD","","Finite","Sample","Results","with","Bias","Terms\nD.1","","Extension","of","Theorem","1","and","Theorem","2\nWe","present","a","finite","sample","error","bound","when","we","use","minimax","estimators","without","stabilizers.\nComparing","to","Theorem","1,","the","following","theorems","hold","withoutassuming","realizability","assump-\ntions.\nTheorem","11.For","anyh∈H\nobs\n0\n,q∈Q\nobs\n0\n,\n|\nˆ\nJ\nIPW\n−J|≤sup\nq∈Q\n|(E−E\nn\n)[qπY]|+","4","","sup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|+\n+","inf\nh∈H\n′\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h)]|+","inf\nq∈Q\nsup\nh∈H\n′\n|E[(q\n0\n−q)πh]|.\nTheorem","12.For","anyh∈H\nobs\n0\n,q∈Q\nobs\n0\n,\n|\nˆ\nJ\nREG\n−J|≤sup\nh∈H\n|(E−E\nn\n)[Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[q(Y−h)]|\n+","inf\nh∈H\nsup\nq∈Q\n′\n|E[{h\n0\n−h}q]|+","inf\nq∈Q\n′\nsup\nh∈H\n|E[(q\n0\nπ−q)(h−h\n0\n)|.\nIn","each","theorem,","our","assumption","is","only","the","existence","of","bridge","functions,i.e.,","Assumption","2.\nThe","first","term","and","the","second","term","are","variance","terms,","which","converge","to0.","The","third","term\nand","the","fourth","term","are","bias","terms,","which","may","remain","even","if","the","sample","size","goes","to","infinity.\nIn","Theorem","1,","we","show","that","these","bias","terms","are","zero","under","additional","realizability","conditions.\nThe","following","is","an","extension","of","Theorem","2.\n33\n\nTheorem","13.For","anyh∈H\nobs\n0\n,q∈Q\nobs\n0\n,\n|\nˆ\nJ\nDR\n−J|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπY−qπh+Th]|+","4","","sup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|+\n+","inf\nq∈Q\nsup\nh∈H\n′\n|E[(q\n0\n−q)πh]|+","inf\nh∈H\n′\nsup\nh\n′\n∈H\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h\n′\n−h)]|,\n|\nˆ\nJ\nDR\n−J|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπY−qπh+Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[q(Y−h)]|\n+","inf\nh∈H\nsup\nq∈Q\n′\n|E[{h\n0\n−h}q]|+","inf\nq∈Q\n′\nsup\nq\n′\n∈Q\nsup\nh∈H\n|E[(q\n0\nπ−q\n′\nπ−q)(h−h\n0\n)|.\nAgain,","in","the","theorem,","the","first","and","second","terms","are","varianceterms,","and","the","third","and\nfourth","terms","are","bias","terms,","which","may","remain","even","if","the","sample","size","goes","to","infinity.","","In\nTheorem","2,","we","show","that","these","bias","terms","are","zero","under","additional","realizability","conditions.\nD.2","","Extension","of","Theorems","3","and","4\nTheorem","14.SupposekHk\n∞\n,kYk\n∞\n≤C\nH\n.","We","take","an","arbitraryh\n0\n∈H\nobs\n0\nandh\n′\n∈H.","Define\nǫ\nh\n′\n:\n=","sup\nh∈H\ninf\nq∈Q\n′\nkq−P\nz\n(h−h\n′\n)k.","Additionally,","assumeQ\n′\nis","symmetric","and","star-shaped.\nLetη\nh\nbe","an","upper","bound","on","the","critical","radius","ofQ\n′\nandG\nh\n,","where\nG\nh\n:={(x,a,w,z)7→{(h−h\n′\n)(w,a,x)}q(x,a,z);h∈H,q∈Q\n′\n}.\nThen,","with","probability1−δ,\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n≤\n\u0012\u001a\n1","+\nλ\n2\n+C\n2\nH\nλ\n+C\nH\n\u001b\nη\n′\nh\n+ǫ\nn\n+\nkP\nz\n(h\n0\n−h\n′\n)k\n2\nλη\n′\nh\n+kP\nz\n(h\n′\n−h\n0\n)k\n2\n\u0013\nwhereη\n′\nh\n=η\nh\n+\np\nc\n0\nlog(c\n1\n/δ)/nwith","some","universal","constantsc\n0\n,c\n1\n,c\n2\n.\nWhenP\nz\n(H−H\nobs\n0\n)⊂Q\n′\n,H\nobs\n0\n∩H6=∅,","we","can","takeh\n′\n=h\n0\n∈H\nobs\n0\n∩Hand","we","haveǫ\nh\n′\n=","0,\nso","that","Theorem","14","reduces","to","Theorem","4.\nTheorem","15.SupposekπQk\n∞\n≤C\nQ\n,kπ(a|x)/f(a|x,u)k\n2\n<∞.","We","take","an","arbitraryq\n0\n∈Q\nobs\n0\nandq\n′\n∈Q.","","Defineǫ\nn\n=","sup\nq∈Q\ninf\nh∈H\n′\nkh−P\nw\n(qπ−q\n′\nπ)k\n2\n.","","Additionally,","assumeH\n′\nis\nsymmetric","and","star-shaped.","Letη\nq\nbe","an","upper","bound","on","the","critical","radius","ofH\n′\nandG\nq\n,","where\nG\nq\n:={(x,a,w,z)7→{(q−q\n′\n)(x,a,z)}π(a|x)h(x,a,w);q∈Q,h∈H\n′\n}.\nThen,","with","probability1−δ,\nkP\nw\n(ˆqπ−q\n0\nπ)k\n2\n≤c\n2\n\u0012\u001a\n1","+\nλ\n2\n+C\n2\nQ\nλ\n+C\nQ\n\u001b\nη\n′\nq\n+ǫ\nn\n+\nkP\nw\n(q\n′\nπ−q\n0\nπ)k\n2\nλη\n′\nq\n+kP\nw\n(q\n′\nπ−q\n0\nπ)k\n2\n\u0013\nwhereη\n′\nq\n=η\nq\n+\np\nc\n0\nlog(c\n1\n/δ)/nwith","some","universal","constantsc\n0\n,c\n1\n,c\n2\n.\nSimilarly,","whenπP\nw\n(Q−Q\nobs\n0\n)⊂H\n′\n,Q∩Q\nobs\n0\n6=∅,","Theorem","15","reduces","to","Theorem","3.\nE","","Proofs\nIn","all","of","the","proofs,","when","we","assumekYk\n∞\n,kHk\n∞\n,kQk\n∞\n,kπ/f(a|x,w)k\n2\nare","finite,","we","denote\ntheir","upper","bounds","asC\nY\n,C\nH\n,C\nQ\n,C\nw\nrespectively.\n34\n\nE.1","","Proofs","for","Section","2\nProof","of","Lemma","1.We","first","prove","the","identification","viaφ\nREG\n:\nJ=E\n\u001a\nZ\nY(a)π(a|X)dμ(a)\n\u001b\n=E\n\u001a\nZ\nE[Y(a)|U,X]π(a|X)dμ(a)\n\u001b\n(Tower","property)\n=E\n\u001a\nZ\nE[Y(a)|U,X,A=a]π(a|X)dμ(a)\n\u001b\n(Y(a)⊥A|U,X)\n=E\n\u001a\nZ\nE[Y|U,X,A=a]π(a|X)dμ(a)\n\u001b\n=E[φ\nREG\n(Y,A,U,X;k\n0\n)].(Consistency)\nWe","next","prove","the","identification","viaφ\nIPW\n:\nJ=E\n\u001a\nZ\nE[Y|U,X,A=a]π(a|X)dμ(a)\n\u001b\n=E\n\u001a\nZ\nE[Y|U,X,A=a]{π(a|X)/f(a|X,U)}×f(a|X,U)dμ(a)\n\u001b\n=E{E[Y|U,X,A]π(A|X)/f(A|X,U)}\n=E{Y","π(A|X)/f(A|X,U)}=E[φ\nIPW\n(Y,A,U,X;f)].\nFinally,","the","identification","viaφ\nDR\nfollows","from","the","fact","that\nE[φ\nDR\n(Y,A,U,X;k\n0\n,f)]","=E[φ\nREG\n(Y,A,U,X;k\n0\n)]","=J.\nBridge","functions","in","Example","5.Here","we","show","the","details","of","deriving","bridge","functions","in","Exam-\nple","5.\nWe","first","derive","the","functionh\n0\n(W,A,X).","Ifθ\n⊤\nw\nα\nW\n=α\n⊤\nY\n,then\nθ\n⊤\nW\nW=α\n⊤\nY\nU+θ\n⊤\nW\nβ\nW\nX+θ\n⊤\nW\nǫ\nW\n=⇒α\n⊤\nY\nU=θ\n⊤\nW\nW−θ\n⊤\nW\nβ\nW\nX−θ\n⊤\nW\nǫ\nW\n.\nTherefore,\nY=","(θ\nW\n+ω\nY\n)\n⊤\nW+\n\u0010\nβ\n⊤\nY\n−θ\n⊤\nW\nβ\nW\n\u0011\nX+ω\n⊤\nW\nW+ǫ\nY\n−θ\n⊤\nW\nǫ\nW\n=h\nw\n(W,A,X)","+ǫ\nY\n−θ\n⊤\nW\nǫ\nW\n.\nIt","follows","from","the","independence","ofǫ\nY\n,ǫ\nW\nwithA,U,Xthat\nE[Y|A,U,X]","=E[h\n0\n(W,A,X)|A,U,X]","+E\nh\nǫ\nY\n−θ\n⊤\nW\nǫ\nW\ni\n=E[h\n0\n(W,A,X)|A,U,X].\nNow","we","deriveq\n0\n(Z,A,X).","First","note","that1/f(A|U,X)","=","1/\n\u0010\n(\nα\nA\n−α\nA\n)U+\n\u0010\nβ\nA\n−β\nA\n\u0011\nX\n\u0011\n.\nBecauseθ\n⊤\nZ\nα\nZ\n=\nα\n⊤\nA\n−α\n⊤\nA\n,\nθ\n⊤\nZ\nZ=","(\nα\nA\n−α\nA\n)\n⊤\nU+θ\n⊤\nZ\nβ\nZ\nX+θ\n⊤\nZ\nγ\nZ\nA+θ\n⊤\nZ\nǫ\nZ\n,\nwhich","means","that\nq\n0\n(Z,A,X)","=θ\n⊤\nZ\nZ+\n\u0010\nβ\nA\n−β\nA\n−θ\n⊤\nZ\nβ\nZ\n\u0011\nX−θ\n⊤\nZ\nγ\nZ\nA\n=","(\nα\nA\n−α\nA\n)\n⊤\nU+\n\u0010\nβ\nA\n−β\nA\n\u0011\n⊤\nX+θ\n⊤\nZ\nǫ\nZ\n.\nTherefore,\nE[q\n0\n(Z,A,X)|A,U,X]","=","(\nα\nA\n−α\nA\n)\n⊤\nU+\n\u0010\nβ\nA\n−β\nA\n\u0011\n⊤\nX+E\nh\nθ\n⊤\nZ\nǫ\nZ\ni\n=","1/f(A|U,X).\n35\n\nProof","for","Lemma","2.We","derive","the","equations","in","Lemma","2","one","by","one.\nFirst,\nE\nh\n","̃\nφ\nIPW\n(O;q\n0\n)\ni\n=E[E[π(A|X)q\n0\n(Z,A,X)Y|A,U,X]]\n=E[E[π(A|X)q\n0\n(Z,A,X)|A,U,X]E[Y|A,U,X]]\n=E[E[π(A|X)/f(A|U,X)|A,U,X]E[Y|A,U,X]]\n=E[π(A|X)Y/f(A|U,X)]\n=E\n\u0014\nZ\nπ(a|X)E[Y(a)|A=a,U,X]","dμ(a)\n\u0015\n=E\n\u0014\nZ\nπ(a|X)E[Y(a)|U,X]","dμ(a)\n\u0015\n=J.\nHere","the","second","equality","follows","fromY⊥Z|A,U,Xand","the","third","equality","follows","from","the\ndefinition","ofq\n0\naccording","to","Eq.","(3).\nSecond,\nE\nh\n","̃\nφ\nREG\n(O;h\n0\n)\ni\n=E\n\u0014\nZ\nπ(a|X)h\n0\n(W,a,X)dμ(a)\n\u0015\n=E\n\u0014\nZ\nπ(a|X)E[h\n0\n(W,a,X)|A=a,U,X]","dμ(a)\n\u0015\n=E\n\u0014\nZ\nπ(a|X)E[Y|A=a,U,X]","dμ(a)\n\u0015\n=J.\nHere","the","second","equality","follows","fromW⊥A|U,Xand","the","third","equality","follows","from","the\ndefinition","ofh\n0\naccording","to","Eq.","(2).\nFinally,\nE\nh\n","̃\nφ\nDR\n(O;h\n0\n,q\n0\n)\ni\n=E\nh\n","̃\nφ\nREG\n(O;h\n0\n,q\n0\n)\ni\n+E[π(A|X)q\n0\n(Z,A,X)","(Y−h\n0\n(W,A,X))]\n=J+E[E[π(A|X)q\n0\n(Z,A,X)","(Y−h\n0\n(W,A,X))|A,U,X]]\n=J+E[E[π(A|X)q\n0\n(Z,A,X)|A,U,X]E[Y−h\n0\n(W,A,X)|A,U,X]]\n=J.\nHere","the","third","equality","follows","from","thatZ⊥Y|A,U,Xand","the","last","equality","follows","from","the\ndefinition","ofh\n0\naccording","to","Eq.","(2).\nProof","for","Lemma","3.For","anyh\n0\n∈H\n0\n,","we","have","that\nE[Y−h\n0\n(W,A,X)|Z,A,U,X]","=E[Y−h\n0\n(W,A,X)|A,U,X]","=","0,\nwhere","the","first","equality","holds","because(W,Y)⊥Z|A,U,X.","Therefore,\nE[Y−h\n0\n(W,A,X)|Z,A,X]","=E[E[Y−h\n0\n(W,A,X)|Z,A,U,X]|Z,A,X]","=","0.\nFor","anyq\n0\n∈Q\n0\n,","we","have","that\nE[π(A|X)q\n0\n(Z,A,X)|W,A,U,X]","=E[π(A|X)q\n0\n(Z,A,X)|A,U,X]","=\nπ(A|X)\nf(A|U,X)\n,\nwhere","the","first","equality","follows","fromZ⊥W|A,U,X.","Therefore,\nE[π(A|X)q\n0\n(Z,A,X)|W,A,X]","=E[E[π(A|X)q\n0\n(Z,A,X)|W,A,U,X]|W,A,X]\n=E\n\u0014\nπ(A|X)\nf(A|U,X)\n|W,A,X\n\u0015\n.\n36\n\nThen","the","conclusion","follows","from","the","fact","that\nE\n\u0014\n1\nf(A|U,X)\n|W,A,X\n\u0015\n=\nZ\n1\nf(A|u,X)\nf(u|W,A,X)d(u)\n=\nZ\nf(W,A|u,X)f(u,X)\nf(A|u,X)f(W,A,X)\ndμ(u)\n=\nZ\nf(W|u,X)f(u,X)\nf(W,A,X)\ndμ(u)\n=\n1\nf(A|W,X)\n.\nHere","the","third","equality","follows","from","the","fact","thatW⊥A|U,X.\nIn","summary,","the","condition","that(W,Y)⊥Z|A,U,Xensures","Eq.","(5)","holds,","while","the\ncondition","that(Z,A)⊥W|U,Xensures","Eq.","(6)","holds.\nProof","for","Lemma","4.The","conclusions","thatE\nh\n","̃\nφ\nREG\n(O;h\n0\n)\ni\n=E\nh\n","̃\nφ\nIPW\n(O;q\n0\n)\ni\nfor","anyh\n0\n∈\nH\nobs\n0\nandq\n0\n∈Q\nobs\n0\neasily","follows","from","Lemma","5","and","thath\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\nsatisfy\nEqs.","(5)","and","(6).\nNote","that","for","anyh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n,\nE\nh\n","̃\nφ\nDR\n(O;h\n0\n,q\n0\n)\ni\n=E[π(A|X)q\n0\n(Z,A,X)","(Y−h\n0\n(W,A,X))]","+E[(Th\n0\n)(X,W)]\n=E[π(A|X)q\n0\n(Z,A,X)E[Y−h\n0\n(W,A,X)|Z,A,X]]","+E\nh\n","̃\nφ\nREG\n(O;q\n0\n)\ni\n=E\nh\n","̃\nφ\nREG\n(O;",";h\n0\n,q\n0\n)\ni\n=J.\nHere","the","second","equation","again","follows","from","the","definition","ofh\n0\naccording","to","Assumption","2.\nProof","for","Lemma","5.Before","proving","the","conclusion,","note","that","for","anyh∈L\n2\n(W,A,X)and\nq\n0\n∈Q\nobs\n0\n,\nE[q\n0\n(Z,A,X)π(A|X)h(W,A,X)]","=E[E[E[q\n0\n(Z,A,X)π(A|X)|W,A,X]h(W,A,X)]]\n=E\n\u0014\nπ(A|X)\nf(A|W,X)\nh(W,A,X)\n\u0015\n=E\n\u0014\nE\n\u0014\nπ(A|X)\nf(A|W,X)\nh(W,A,X)|W,X\n\u0015\u0015\n=E\n\u0014\nZ\nπ(a|X)\nf(a|W,X)\nh(W,a,X)f(a|W,X)dμ(a)\n\u0015\n=E[(Th)(W,X)].\nHere","the","second","equality","follows","becauseq\n0\nsatisfies","Eq.","(6).\nIPWWe","prove","a","stronger","statement:\nE\nh\n","̃\nφ\nIPW\n(O;q)\ni\n−J=E\n\u0014\n{E[π(A|X)q(Z,A,X)|W,A,X]−\nπ(A|X)\nf(A|W,X)\n}h\n0\n(W,A,X)\n\u0015\nfor","anyh\n0\n∈H\nobs\n0\nassumingQ\n0\n6=∅.","First,","by","taking","some","elementh\n0\ninH\nobs\n0\n,","we","have\nE\nh\n","̃\nφ\nIPW\n(O;q)\ni\n=E[π(A|X)q(Z,A,X)Y]\n=E[π(A|X)q(Z,A,X)E[Y|Z,A,X]]\n=E[π(A|X)q(Z,A,X)h\n0\n(W,A,X)]\n=E[E[π(A|X)q(Z,A,X)|W,A,X]h\n0\n(W,A,X)].\n37\n\nMoreover,","by","taking","some","elementq\n0\n∈Q\nobs\n0\n,\nJ=E[π(A|X)q\n0\n(Z,A,X)Y](Lemma","2)\n=E[π(A|X)q\n0\n(Z,A,X)E[Y|A,X,W]](Conditional","independence)\n=E[E[π(A|X)q\n0\n(Z,A,X)|W,A,X]h\n0\n(W,A,X)]\n=E\n\u0014\nπ(A|X)\nf(A|W,X)\nh\n0\n(W,A,X)\n\u0015\n.\nIt","follows","that\nE\nh\n","̃\nφ\nIPW\n(O;q)\ni\n−J=E\n\u0014\n{E[π(A|X)q(Z,A,X)|W,A,X]−\nπ(A|X)\nf(A|W,X)\n}h\n0\n(W,A,X)\n\u0015\n.\nREGWe","prove","a","stronger","statement:\nE\nh\n","̃\nφ\nREG\n(O;h)\ni\n−J=E[π(A|X)q\n0\n(Z,A,X)E[h(W,A,X)−Y|Z,A,X]].\nfor","someq\n0\n∈Q\nobs\n0\nassumingH\n0\n6=∅.","Note","again","that\nE\nh\n","̃\nφ\nREG\n(O;h)\ni\n=E[(Th)(W,X)]\n=E[π(A|X)q\n0\n(Z,A,X)h(W,A,X)]\n=E[π(A|X)q\n0\n(Z,A,X)E[h(W,A,X)|Z,A,X]].\nMoreover,","by","taking","some","elementh\n0\n∈H\nobs\n0\n,\nJ=E[(Th\n0\n)(W,X)](Lemma","2)\n=E[π(A|X)q\n0\n(Z,A,X)h\n0\n(W,A,X)]\n=E[π(A|X)q\n0\n(Z,A,X)E[h\n0\n(W,A,X)|Z,A,X]]\n=E[π(A|X)q\n0\n(Z,A,X)E[Y|Z,A,X]].\nIt","follows","that\nE\nh\n","̃\nφ\nREG\n(O;h)\ni\n−J=E[π(A|X)q\n0\n(Z,A,X)E[h(W,A,X)−Y|Z,A,X]].\nProof","for","Lemma","6.Fixh\n0\n∈H\nobs\n0\nandq\n0\n∈Q\nobs\n0\n.","This","conclusion","follows","from","the","fact","that\nfor","anyh∈H,h\n′\n∈L\n2\n(W,A,X),q∈Q,q\n′\n∈L\n2\n(Z,A,X),\n\u0000\nE\n\u0002\nq\n′\n(Z,A,X)","(h(W,A,X)−Y)\n\u0003\u0001\n2\n≤E\n\u0002\n(E[(Y−h(W,A,X))|Z,A,X])\n2\n\u0003\n\u0000\nE\n\u0002\nq(X,A,Z)h\n′\n(X,A,W)−(Th\n′\n)(X,W)\n\u0003\u0001\n2\n≤E\n\u0002\n(π(A|X)E[q(Z,A,X)−1/f(A|X,W)|W,A,X])\n2\n\u0003\n,\nand","the","two","upper","bounds","are","attained","by\nq\n′\n(Z,A,X)","=E[(h(W,A,X)−Y)|Z,A,X]\n=E[h(W,A,X)−h\n0\n(W,A,X)|Z,A,X]∈P\nZ\n\u0010\nH−H\nobs\n0\n\u0011\n⊆Q\n′\nand\nh\n′\n(W,A,X)","=π(A|X)E[q(Z,A,X)−1/f(A|X,W)|W,A,X]\n=π(A|X)E[q(Z,A,X)−q\n0\n(Z,A,X)|W,A,X]∈πP\nW\n\u0010\nQ−Q\nobs\n0\n\u0011\n⊆H\n′\n.\n38\n\nProof","for","Lemma","7.We","prove","the","first","equation","as","an","example,","and","the","second","equation","can\nbe","proved","analogously.\nFirst,","note","that","anyh\n0\n∈H\nobs\n0\n∩Hsatisfies\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h\n0\n(W,A,X)−Y)]−λkqk\n2\n=","sup\nq∈Q\n′\n−λkqk\n2\n=","0.\nIn","addition,","for","anyh∈H,\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n≥E[0×(h(W,A,X)−Y)]−λk0k\n2\n=","0.\nThus","we","have\nmin\nh∈H\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n=","0\nand\nH\nobs\n0\n∩H⊆arg","min\nh\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n.\nSecond,","take","̃q=cE[h(W,A,X)−Y|Z,A,X]forc=","min(1,1/λ).","SinceQ\n′\nis","star-shaped,","we\nhave","̃q∈Q\n′\nand\nE[","̃q(Z,A,X)","(h(W,A,X)−Y)]−λk","̃qk\n2\n=","(c−λc\n2\n)E\n\u0002\n(E[h(W,A,X)−Y|Z,A,X])\n2\n\u0003\n≤sup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n.\nThus","for","anyh∈arg","min\nh∈H\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n,\n0≤(c−λc\n2\n)E\n\u0002\n(E[h(W,A,X)−Y|Z,A,X])\n2\n\u0003\n≤sup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n=","0,\nwhich","implies","that\nh∈arg","min\nh∈H\n(c−λc\n2\n)E\n\u0002\n(E[h(W,A,X)−Y|Z,A,X])\n2\n\u0003\n=H\nobs\n0\n∩H.\nIt","follows","that\narg","min\nh∈H\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n⊆H\nobs\n0\n∩H.\nTherefore,","we","have\nH\nobs\n0\n∩H=","arg","min\nh∈H\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n.\nNote","that","we","do","not","need","the","star-shape","condition","whenλ=","1/2.","It","is","easy","to","show","that\nsup\nq∈L\n2\n(Z,A,X)\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n=","","","","sup\nq∈L\n2\n(Z,A,X)\nE\n\u0002\nE[(h(W,A,X))−Y|Z,A,X]q(Z,A,X)−λq\n2\n(Z,A,X)\n\u0003\n=\n1\n4λ\nE\n\u0002\n(E[h(W,A,X)−Y|Z,A,X])\n2\n\u0003\n,\nwhere","the","supremum","is","achieved","byπ(A|X)q(Z,A,X)","=\n1\n2λ\nE[(h(W,A,X)−Y)|Z,A,X].\nIn","particular,","whenλ=","1/2,","the","supremum","above","is","achieved","byπ(A|X)q(Z,A,X)","=\nE[(h(W,A,X)−Y)|Z,A,X]∈P\nZ\n(H−H\n0\n)⊆Q\n′\n.","This","implies","that\narg","min\nh∈H\nsup\nq∈Q\n′\nE[q(Z,A,X)","(h(W,A,X)−Y)]−λkqk\n2\n=","arg","min\nh∈H\n1\n2\nE\n\u0002\n(E[h(W,A,X)−Y|Z,A,X])\n2\n\u0003\n=H∩H\nobs\n0\n.\nObviously,","if","we","assume∪\nt>\n\b\ntP\nz\n\u0000\nH−H\nobs\n0\n\u0001\t\n⊆Q\n′\ninstead","of","assumingQ\n′\nis","star-shaped","and\nP\nz\n\u0000\nH−H\nobs\n0\n\u0001\n⊆Q\n′\n,","then","we","can","prove","the","conclusion","in","a","similar","way.\n39\n\nE.2","","Proof","of","Section","4\nProof","for","Lemma","8.The","conclusion","follows","easily","from","simple","algebra.\nProof","of","Lemma","9.We","derive","Eq.","(23)","as","follows:\nsup\nkqk\nL\nz\n≤1\n(E\nn\n[{Y−h}hq(·),k\nz\n((Z,A,X),·)i])\n2\n=","","","sup\nq∈kqk\nL\nz\n≤1\n(hq(·),E\nn\n[{Y−h}k\nz\n((Z,A,X),·)]i)\n2\n(Linearity)\n=hE\nn\n[{Y−h}k\nz\n((Z,A,X),·)],E\nn\n[{Y−h}k\nz\n((Z,A,X),·)]i(CS","inequality)\n=\n1\nn\n2\nX\ni,j\n{Y\ni\n−h(X\nj\n,A\ni\n,Z\ni\n)}k\nz\n((X\ni\n,A\ni\n,Z\ni\n),(Z\nj\n,A\nj\n,X\nj\n)){Y\nj\n−h(Z\nj\n,A\nj\n,X\nj\n)}.\nMoreover,","we","can","derive","Eq.","(24)","as","follows:\nsup\nkhk\nL\nw\n≤1\n(E\nn\n[qπhh,k\nw\ni−T(hh(·),k\nw\n((W,A,X),·)i)])\n2\n=","","","sup\nkhk\nL\nw\n≤1\n(hh(·),E\nn\n[qπk\nw\n((W,A,X),·)−Tk\nw\n((W,A,X),·))]i)\n2\n(Linearity)\n=hE\nn\n[qπk\nw\n((W,A,X),·)−Tk\nw\n((W,A,X),·)i\n2\n.(CS","inequality)\nHere,","the","operatorTk\nw\n((x,a,w),·)","=E\nπ(a|x)\n[k\nw\n((x,a,w),·)].","Taking","the","term","only","related","to\nq,","the","above","is","equal","to\n1\nn\n2\nX\ni,j\nq(W\ni\n,A\ni\n,X\ni\n)π(A\ni\n|X\ni\n)k\nw\n((W\ni\n,A\ni\n,X\ni\n),(W\nj\n,A\nj\n,X\nj\n))q(Z\nj\n,A\nj\n,X\nj\n)π(A\nj\n|X\nj\n)\n−\n2\nn\n2\nX\ni,j\nq(W\ni\n,A\ni\n,X\ni\n)π(A\ni\n|X\ni\n)Tk\nw\n((W\nj\n,A\nj\n,X\nj\n),(W\ni\n,A\ni\n,X\ni\n)).\nProof","of","Lemma","10.From","the","representer","theorem,","an","solution","of","the","inner","maximization","in\nEq.","(25)","should","beq\n∗\n(·)","=\nP\ni\nα\ni\nk\nw\n((Z\ni\n,A\ni\n,X\ni\n),·).","Thus,","this","inner","maximization","problem","can\nbe","reduced","to","solving\nmax\nα∈R\nn\nψ\n⊤\nn\nK\nz,n\nα−α\n⊤\n(λK\nz,n\n+γ\n1\nI)K\nz,n\nα\n=","max\n","̃α∈R\nn\nψ\n⊤\nn\nK\n1/2\nz,n\n","̃α−","̃α\n⊤\n(λK\nz,n\n+γ\n1\nI)","̃α(","̃α=K\n1/2\nz,n\nα)\n=\n1\n4\nψ\n⊤\nn\nK\n1/2\nz,n\n(λK\nz,n\n+γ\n1\nI)\n−1\nK\n1/2\nz,n\nψ\nn\n,\nwhere","the","last","maximum","is","achieved","by\n","̃α\n∗\n=\n1\n2\n(λK\nz,n\n+γ\n1\nI)\n−1\nψ\nn\n.\nFrom","the","representer","theorem,","a","solution","of","the","inner","maximization","problem","in","Eq.","(26)\nshould","beh\n∗\n(·)","=\nP\ni\nα\ni\nk\nw\n((X\ni\n,A\ni\n,W\ni\n),·).","","Thus,","this","inner","maximization","problem","can","be\nreduced","to","solving\nmax\nα∈R\nn\nφ\n⊤\nn\nK\nw1,n\nα−1\n⊤\nn\nK\nw2,n\nα−α\n⊤\n(λK\nw1,n\n+γ\n2\nI)K\nw1,n\nα.\nAssumingK\nw1,n\nis","a","positive","definite","matrix,","the","optimization","problem","above","is","solved","by\nˆα=\n1\n2\n(λK\nw1,n\n+γI)\n−1\n(φ\nn\n−K\n−1\nw1,n\nK\nw2,n\n1\nn\n).\nThus,","the","resulting","optimal","value","is\n1\n4\nφ\n⊤\nn\nK\n1/2\nw1,n\n(λK\nw1,n\n+γI)\n−1\nK\n1/2\nw1,n\nφ\nn\n−\n1\n2\n{φ\n⊤\nn\n(λK\nw1,n\n+γI)\n−1\nK\nw2,n\n1\nn\n}.\n40\n\nE.3","","Proofs","for","Section","5\nWe","often","use","the","following","lemmas.","Instead","of","proving","Theorems","1","and","2,","we","prove","the","gener-\nalized","versions,","Theorems","11","and","12.\nLemma","19(Dudley","integral).\nR\nn\n(∞;F).inf\nτ≥0\n(\nτ+\nZ\nsup\nf∈F\n√\nE\nn\n[f\n2\n]\nτ\nr\nlogN(τ,F,k·k\nn\n)\nn\n)\n.\nNotesup\nf∈F\np\nP\nn\n[f\n2\n]is","upper","bounded","by","the","envelopekFk\n∞\n.\nLemma","20.Covering","number","of","VC-subgraph","classes","[van","der","Vaart,","1998,","Lemma","19.15]\nFor","a","VC","class","of","functionsFwith","measurable","envelope","functionFandr≥1,","one","has","for","any\nprobability","measureQwithkFk\nQ,r\n>0,\nN(ǫkFk\nQ,r\n,F,L\nr\n(Q)).V(F)(4e)\nV(F)\n\u0012\n2\nǫ\n\u0013\nrV(F)\n.\nProof","of","Theorem","11.We","take","elementsh\n0\n,q\n0\ns.t.h\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\n.","","This","operation","is\nfeasible","sinceH\n0\n,Q\n0\nare","non-empty","from","the","assumption.","(NoteH\n0\n6=∅,Q\n0\n6=∅implyH\nobs\n0\n6=\n∅,Q\nobs\n0\n6=∅).\nFirst","StepWe","define\nJ\nIPW\n:\n=E[ˆqπY].\nThen,\n|J\nIPW\n−\nˆ\nJ\nIPW\n|≤sup\nq∈Q\n|(E−E\nn\n)[qπY]|.\nIn","addition,\n|J\nIPW\n−J|≤|E[(ˆq−q\n0\n)πY]|=|E[E[(ˆq−q\n0\n)πY|A,X,U]]|\n=|E[(ˆq−q\n0\n)πh\n0\n]|(Z⊥A,Y|X,U)\n≤sup\nh∈H\n′\n|E[(ˆq−q\n0\n)πh]|+","inf\nh∈H\n′\n|E[(ˆq−q\n0\n)π(h\n0\n−h)]|\n=|E[(ˆq−q\n0\n)π\n","̄\nh]|+","sup\nq∈Q\ninf\nh∈H\n′\n|E[(q−q\n0\n)π(h\n0\n−h)]|,\n","̄\nh\n:\n=","arg","max\nh∈H\n′\n|E[(ˆq−q\n0\n)πh]|\n≤|E[(ˆq−q\n0\n)π\n","̄\nh]|+","inf\nh∈H\n′\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h)]|.\nSecond","StepWe","define\nf\nq\n(q,h)","=qπ(−h)","+Th.\nNoteE[f\nq\n(q,h)]","=E[(−q+q\n0\n)πh].","Next,","we","take\nq\n′\n=","arg","min\nq∈Q\nsup\nh∈H\n′\n|E[f\nq\n(q,h)]|,","h\n†\n=","arg","max\nh∈H\n′\n|E\nn\n[f\nq\n(ˆq,h)]|.\nThen,\n|E[f\nq\n(ˆq,h\n†\n)]|−|E[f\nq\n(q\n′\n,h\n†\n)]|\n=|E[f\nq\n(ˆq,h\n†\n)]|−|E\nn\n[f\nq\n(ˆq,h\n†\n)]|+|E\nn\n[f\nq\n(ˆq,h\n†\n)]|−|E\nn\n[f\nq\n(q\n′\n,h\n†\n)]|+|E\nn\n[f\nq\n(q\n′\n,h\n†\n)]|−|E[f\nq\n(q\n′\n,h\n†\n)]|\n=|E[f\nq\n(ˆq,h\n†\n)]|−|E\nn\n[f\nq\n(ˆq,h\n†\n)]|+|E\nn\n[f\nq\n(q\n′\n,h\n†\n)]|−|E[f\nq\n(q\n′\n,h\n†\n)]|(Definition","ofˆq)\n≤2|sup\nq∈Q,h∈H\n′\n(E−E\nn\n)[f\nq\n(q,h)]|.(h\n†\n∈H\n′\n,ˆq∈Q,q\n′\n∈Q)\n41\n\nBesides,\n|E[f\nq\n(ˆq,\n","̄\nh)]|−|E[f\nq\n(ˆq,h\n†\n)]|\n≤|E[f\nq\n(ˆq,\n","̄\nh)]|−|E\nn\n[f\nq\n(ˆq,\n","̄\nh)]|+|E\nn\n[f\nq\n(ˆq,\n","̄\nh)]|−|E\nn\n[f\nq\n(ˆq,h\n†\n)]|+|E\nn\n[f\nq\n(ˆq,h\n†\n)]|−|E[f\nq\n(ˆq,h\n†\n)]|\n≤|E[f\nq\n(ˆq,\n","̄\nh)]|−|E\nn\n[f\nq\n(ˆq,\n","̄\nh)]|+|E\nn\n[f\nq\n(ˆq,h\n†\n)]|−|E[f\nq\n(ˆq,h\n†\n)]|(Definition","ofh\n†\n)\n≤2|sup\nq∈Q,h∈H\n′\n(E−E\nn\n)[f\nq\n(q,h)]|.(ˆq∈Q,\n","̄\nh∈H\n′\n,h\n†\n∈H\n′\n)\nThird","StepCombining","all","results,\n|J−\nˆ\nJ\nIPW\n|≤|J\nIPW\n−\nˆ\nJ\nIPW\n|+|J\nIPW\n−J|\n≤sup\nq∈Q\n|(E−E\nn\n)[qπY]|+|E[f\nq\n(ˆq,\n","̄\nh)]|+","inf\nh∈H\n′\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h)]|\n≤sup\nq∈Q\n|(E−E\nn\n)[qπY]|+","4|sup\nq∈Q,h∈H\n′\n(E−E\nn\n)[f\nq\n(q,h)]|+|E[f\nq\n(q\n′\n,h\n†\n)]|\n+","inf\nh∈H\n′\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h)]|\n≤sup\nq∈Q\n|(E−E\nn\n)[qπY]|+","4|sup\nq∈Q,h∈H\n′\n(E−E\nn\n)[f\nq\n(q,h)]|+\n+","inf\nh∈H\n′\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h)]|+","inf\nq∈Q\nsup\nh∈H\n′\n|E[(q−q\n0\n)πh]|.\nProof","of","Theorem","12.We","take","elementsh\n0\n,q\n0\ns.t.h\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\n.","","This","operation","is\nfeasible","sinceH\n0\n,Q\n0\nare","non-empty","from","the","assumption.\nFirst","stepWe","define\nJ\nREG\n:\n=E[Th].\nThen,\n|J\nREG\n−\nˆ\nJ\nREG\n|≤sup\nh∈H\n(E−E\nn\n)|[Th]|.\nIn","addition,\n|J\nREG\n−J|≤|E[T(\nˆ\nh−h\n0\n)|=|E[q\n0\nπ(\nˆ\nh−h\n0\n)|\n≤sup\nq∈Q\n′\n|E[q(\nˆ\nh−h\n0\n)|+","inf\nq∈Q\n′\n|E[(q\n0\nπ−q)(\nˆ\nh−h\n0\n)|\n≤|E[","̄q(\nˆ\nh−h\n0\n)|+","sup\nh∈H\ninf\nq∈Q\n′\n|E[(q\n0\nπ−q)(h−h\n0\n)|,","̄q\n:\n=","arg","max\nq∈Q\n′\n|E[q(\nˆ\nh−h\n0\n)|\n≤|E[","̄q(\nˆ\nh−h\n0\n)|+","inf\nq∈Q\n′\nsup\nh∈H\n|E[(q\n0\nπ−q)(h−h\n0\n)|.\nSecond","stepWe","define\nf\nh\n(q,h)","={y−h}q.\nNoteE[f\nh\n(q,h)]","=E[{h\n0\n−h}q].","Next,","we","take\nh\n′\n=","arg","min\nh∈H\nsup\nq∈Q\n′\n|E[f\nh\n(q,h)]|,","q\n†\n=","arg","max\nq∈Q\n′\nE\nn\n[{Y−h}q].\nThen,\n|E[f\nh\n(q\n†\n,\nˆ\nh)]|−|E[f\nh\n(q\n†\n,h\n′\n)]|\n=|E[f\nh\n(q\n†\n,\nˆ\nh)]|−|E\nn\n[f\nh\n(q\n†\n,\nˆ\nh)]|+|E\nn\n[f\nh\n(q\n†\n,\nˆ\nh)]|−|E\nn\n[f\nh\n(q\n†\n,h\n′\n)]|+|E\nn\n[f\nh\n(q\n†\n,h\n′\n)]|−|E[f\nh\n(q\n†\n,h\n′\n)]|\n≤|E[f\nh\n(q\n†\n,\nˆ\nh)]|−|E\nn\n[f\nh\n(q\n†\n,\nˆ\nh)]|+|E\nn\n[f\nh\n(q\n†\n,h\n′\n)]|−|E[f\nh\n(q\n†\n,h\n′\n)]|(Definition","of\nˆ\nh)\n≤2","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[f\nh\n(q,h)]|.(q\n†\n∈Q\n′\n,\nˆ\nh,h\n′\n∈H)\n42\n\nBesides,\n|E[f\nh\n(","̄q,\nˆ\nh)]|−|E[f\nh\n(q\n†\n,\nˆ\nh)]|\n=|E[f\nh\n(","̄q,\nˆ\nh)]|−|E\nn\n[f\nh\n(","̄q,\nˆ\nh)]|+|E\nn\n[f\nh\n(","̄q,\nˆ\nh)]|−|E\nn\n[f\nh\n(q\n†\n,\nˆ\nh)]|+|E\nn\n[f\nh\n(q\n†\n,\nˆ\nh)]|−|E[f\nh\n(q\n†\n,\nˆ\nh)]|\n≤|E[f\nh\n(","̄q,\nˆ\nh)]|−|E\nn\n[f\nh\n(","̄q,\nˆ\nh)]|+|E\nn\n[f\nh\n(q\n†\n,\nˆ\nh)]|−|E[f\nh\n(q\n†\n,\nˆ\nh)]|(Definition","ofq\n†\n)\n≤2","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[f\nh\n(q,h)]|.(","̄q,q\n†\n∈Q\n′\n,\nˆ\nh,h∈H)\nThird","stepCombining","all","results,\n|J−\nˆ\nJ\nREG\n|≤|J\nREG\n−\nˆ\nJ\nREG\n|+|J\nREG\n−J|\n≤sup\nh∈H\n|(E−E\nn\n)[Th]|+|E[f\nh\n(","̄q,\nˆ\nh)]|+","inf\nq∈Q\n′\nsup\nh∈H\n|E[(q\n0\nπ−q)(h−h\n0\n)|\n≤sup\nh∈H\n|(E−E\nn\n)[Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[f\nh\n(q,h)]|+|E[f\nh\n(q\n†\n,h\n′\n)]|\n+","inf\nq∈Q\n′\nsup\nh∈Q\n′\n|E[(q\n0\nπ−q)(h−h\n0\n)|\n≤sup\nh∈H\n|(E−E\nn\n)[Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[f\nh\n(q,h)]|\n+","inf\nh∈H\nsup\nq∈Q\n′\n|E[{h\n0\n−h}q]|+","inf\nq∈Q\n′\nsup\nh∈H\n|E[(q\n0\nπ−q)(h−h\n0\n)|.\nProof","of","Theorem","13.We","take","elementsh\n0\n,q\n0\ns.t.h\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\n.","","This","operation","is\nfeasible","sinceH\n0\n,Q\n0\nare","non-empty","from","the","assumption.\nFirst","StatementFirst,","we","prove\n|\nˆ\nJ\nDR\n−J|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπY−qπh+Th]|+","4","","sup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|+\n+","inf\nq∈Q\nsup\nh∈H\n′\n|E[(q\n0\n−q)πh]|+","inf\nh∈H\n′\nsup\nh\n′\n∈H\nsup\nq∈Q\n|E[(q−q\n0\n)π(h\n0\n−h\n′\n−h)]|.\nWe","define\nJ\nDR\n:\n=E[ˆqπ{Y−\nˆ\nh}+T\nˆ\nh].\nThen,\n|J\nDR\n−\nˆ\nJ\nDR\n|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπ{Y−h}+Th]|.\nIn","addition,\n|J\nDR\n−J|≤|E[(ˆq−q\n0\n)π(h\n0\n−\nˆ\nh)]|\n≤sup\nh∈H\n′\n|E[(ˆq−q\n0\n)πh]|+","inf\nh∈H\n′\n|E[(ˆq−q\n0\n)π(h\n0\n−\nˆ\nh−h)]|\n=|E[(ˆq−q\n0\n)\n","̄\nh]|+","sup\nh\n′\n∈H\nsup\nq∈Q\ninf\nh∈H\n′\n|E[(q−q\n0\n)π(h\n0\n−h\n′\n−h)]|,\n","̄\nh\n:\n=","arg","max\nh∈H\n′\n|E[(ˆq−q\n0\n)πh]|\n=|E[(ˆq−q\n0\n)\n","̄\nh]|+","inf\nh∈H\n′\nsup\nh\n′\n∈H,q∈Q\n|E[(q−q\n0\n)π(h\n0\n−h\n′\n−h)]|.\nThe","rest","of","the","proof","is","the","same","as","Theorem","11.\n43\n\nSecond","StatementSecond,","we","prove\n|\nˆ\nJ\nDR\n−J|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπY−qπh+Th]|+","4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[q(Y−h)]|\n+","inf\nh∈H\nsup\nq∈Q\n′\n|E[{h\n0\n−h}q]|+","inf\nq∈Q\n′\nsup\nh∈H,q\n′\n∈Q\n|E[(q\n0\nπ−q\n′\n−q)(h−h\n0\n)|.\nWe","define\nJ\nDR\n:\n=E[ˆqπ{Y−\nˆ\nh}+T\nˆ\nh].\nThen,\n|J\nDR\n−\nˆ\nJ\nDR\n|≤sup\nq∈Q,h∈H\n|(E−E\nn\n)[qπ{Y−h}+Th]|.\nIn","addition,\n|J\nDR\n−J|≤|E[(ˆq−q\n0\n)π(h\n0\n−\nˆ\nh)]|\n≤sup\nq∈Q\n′\n|E[q(\nˆ\nh−h\n0\n)|+","inf\nq∈Q\n′\n|E[(q\n0\nπ−ˆqπ−q)\nˆ\nh−h\n0\n)|\n≤|E[","̄q(\nˆ\nh−h\n0\n)|+","","sup\nh∈H,q\n′\n∈Q\ninf\nq∈Q\n′\n|E[(q\n0\nπ−q\n′\nπ−q)(h−h\n0\n)|,","̄q\n:\n=","arg","max\nq∈Q\n′\n|E[q(\nˆ\nh−h\n0\n)|\n≤|E[","̄q(\nˆ\nh−h\n0\n)|+","inf\nq∈Q\n′\nsup\nh∈H,q\n′\n∈Q\n|E[(q\n0\nπ−q\n′\nπ−q)(h−h\n0\n)|.\nThe","rest","of","the","proof","is","the","same","as","Theorem","12.\nProof","for","Theorem","1.The","conclusion","for\nˆ\nJ\nIPW\ndirectly","follows","from","Theorem","11","and","the","con-\nclusion","for\nˆ\nJ\nREG\ndirectly","follows","from","Theorem","12.\nProof","of","Corollary","1.We","define","three","function","classes","for","the","analysis:\nA\n1\n={(x,a,z,y)7→q(x,a,z)y:q∈Q\n′\n},\nA\n2\n={(x,a,z,w,y)7→q(x,a,z)h(x,a,w)",":q∈Q\n′\n,h∈H},\nA\n3\n={(x,a,w)7→(Th)(x,w)∈H}.\nThen,","from","Wainwright","[2019,","Theorem","4.10]","and","Theorem","1,","wehave\n|\nˆ\nJ−J|≤c{R\nn\n(∞;A\n1\n)","+R\nn\n(∞;A\n2\n)","+R\nn\n(∞;A\n3\n)","+\np\nlog(1/δ)/n}.\nwherecis","some","universal","constant.","First,","it","is","seen\nR\nn\n(∞;HQ\n′\n)≤R\nn\n(∞;","0.25\n\b\n(Q\n′\n−H)\n2\n)","+","(H+Q\n′\n)\n2\n\t\n)\n≤0.25{R\nn\n(∞;","(Q\n′\n−H)\n2\n)","+R\nn\n(∞;","(H+Q\n′\n)\n2\n)}\n≤0.5(C\nQ\n+C\nH\n){R\nn\n(∞;","(Q\n′\n−H))","+R\nn\n(∞;","(H+Q\n′\n))}\n(Contraction","property","[Mendelson,","2002])\n≤(C\nQ\n+C\nH\n){R\nn\n(∞;Q\n′\n)","+R\nn\n(∞;H)}.\nBesides,","from","the","definition","of","VC-dimension,\nV(A\n1\n)≤C\nY\nV(Q\n′\n),","V(A\n3\n)","=V(TH)≤V(H).\nThus,\n|\nˆ\nJ−J|≤c(R\nn\n(∞;Q\n′\n)","+R\nn\n(∞;H)","+\np\nlog(1/δ)/n).\nHere,","from","Dudley","integral","(Lemma","19),","by","using","the","coveringnumber","of","the","VC-subgraph","class\nis","explicitly","calculated","(Lemma","20),","we","have\nR\nn\n(∞;Q\n′\n)","=O(\np\nV(Q\n′\n)/n),R\nn\n(∞;H)","=O(\np\nV(H)/n).\nThen,\n|\nˆ\nJ−J|≤c(\np\nV(Q\n′\n)/n+\np\nV(H)/n+\np\nlog(1/δ)/n).\n44\n\nProof","of","Corollary","2.From","the","proof","of","Corollary","1,","we","have\n|\nˆ\nJ−J|≤c(R\nn\n(∞;Q\n′\n)","+R\nn\n(∞;H)","+\np\nlog(1/δ)/n).\nfor","some","constantc.","Then,","from","Dudley","integral,","the","statement","is","immediately","concluded.\nProof","of","Corollary","3.WLOS,","we","prove","the","result","of\nˆ\nJ\nIPW\n.","By","taking","some","element","inh\n0\n∈\nH\nobs\n0\n∩Λ\nα\n([0,1]\nd\n),q\n0\n∈πQ\nobs\n0\n∩Λ\nα\n([0,1]\nd\n).","Then,","from","Theorem","11,","with1−δ,","we","have\n|\nˆ\nJ\nIPW\n−J|≤c{\np\nk\nn\n/n+","inf\nh∈H\n′\nsup\nq∈Q\n′\n|E[(q−q\n0\nπ)(h\n0\n−h)]|+","inf\nq∈Q\n′\nsup\nh∈H\n′\n|E[(q\n0\nπ−q)h]|+\np\nlog(1/δ)/n}.\nFrom","the","assumptions","(32)","and","(33),\ninf\nh∈H\n′\nsup\nq∈Q\n|E[(q−q\n0\nπ)(h\n0\n−h)]|≤2C\nQ\ninf\nh∈H\n′\nE[|h\n0\n−h|]","=O(k\n−p/d\nn\n),(kQ\n′\nk\n∞\n≤C\nQ\n′\n)\ninf\nq∈Q\nsup\nh∈H\n′\n|E[|(q\n0\nπ−q)h]|≤C\nH\ninf\nq∈Q\n′\nE[|q−q\n0\nπ|]","=O(k\n−p/d\nn\n)..(kHk\n∞\n≤C\nH\n)\nIn","the","end,","the","final","error","becomes\nO(k\n−p/d\nn\n+\np\nk\nn\n/n+\np\nlog(1/δ)/n),\nwhere","the","second","and","third","term","are","statistical","error","terms,which","is","derived","in","the","proof","of\nCorollary","1.","Balancing","these","two","terms,","the","final","error","isO(n\n−p/(2p+d)\n).\nE.4","","Proofs","for","Section","6\nInstead","of","proving","Theorems","3","and","4,","we","prove","Theorems","14","and","15.","We","often","use","the","following\nlemmas.\nLemma","21.Wainwright","[2019,","Corollary","14.3]","LetN(τ;B\nn\n(δ;F),k·k\nn\n)denote","theτ-covering\nnumber","ofB\nn\n(δ;F)",":={f|kfk\nn\n≤δ}.","Then,","the","critical","inequality","of","the","empirical","version","is\nsatisfied","for","anyδ",">0s.t.\n1\n√\nn\nZ\nδ\nδ\n2\n/(2kFk\n∞\n)\np\nlogN(t,B\nn\n(δ;F),k·k\nn\n)dt≤\nδ\n2\nkFk\n∞\n.\nLemma","22(Theorem","14.1,","Wainwright","[2019]",").Given","a","star-shaped","andb-uniformly","bounded\nfunction","classG,","letη\nn\nbe","any","positive","solution","of","the","inequalityR\ns\n(η;G)≤η\n2\n/b.","We","call","this\nsolution","to","the","critical","radius","ofG.","Then,","for","anyt≥η\nn\n,","we","have\n|kgk\n2\nn\n−kg|\n2\n2\n|≤0.5kgk\n2\n2\n+","0.5t\n2\n,∀g∈G.\nNext,","consider","a","function","classF:X→Rwith","lossl:R×Z→R.\nLemma","23(Lemma","7","[Foster","and","Syrgkanis,","2019]).Assumesup\nf∈F\nkfk\n∞\n≤cand","pick","any\nf\n∗\n∈F.","Defineη\nn\nbe","solution","to\nR\nn\n(η;","star(F","−f\n∗\n))≤η\n2\n/c.\nMoreover,","assume","that","the","lossl(·,·)isL-Lipschitz","in","the","first","argument.","Then,","forη=η\nn\n+\np\nc\n0\nlog(c\n1\n/δ)/nwith","some","universal","constantsc\n0\n,c\n1\n,","with1−δ,\n|(E\nn\n[l(f(x),z)]−E\nn\n[l(f\n∗\n(x),z)])−(E[l(f(x),z)]−E[l(f\n∗\n(x),z)])|.Lη\nn\n(kf−f\n∗\nk\n2\n+η\nn\n).\nProof","of","Theorem","14.Define\nΦ(h,q)","=E[{y−h(x,a,w)}q(x,a,z)]\nΦ\nn\n(h,q)","=E\nn\n[{y−h(x,a,w)}q(x,a,z)]\nΦ\nλ\n(h,q)","=E[{y−h(x,a,w)}q(x,a,z)]−λkqk\n2\nn\nΦ\nλ\nn\n(h,q)","=E\nn\n[{y−h(x,a,w)}q(x,a,z)]−λkqk\n2\n2\n.\n45\n\nwherekqk\n2\nn\n={E[q\n2\n]}\n1/2\n.","From","Lemma","22,","we","have\n∀q∈Q,|kqk\nn\n−kqk\n2\n2\n|≤0.5kqk\n2\n2\n+η\n2\nn\n(45)\nfor","our","choice","ofη\nn\n:=η\nh,n\n+\np\nc\n0\nlog(c\n1\n/δ)/nnotingη\nh,n\nupper","bounds","the","critical","radius","of\nQ.\nPart","1By","definition","of","the","estimator\nˆ\nhand","the","assumptionh\n′\n∈H,","we","have\nsup\nq∈Q\nΦ\nλ\nn\n(\nˆ\nh,q)≤sup\nq∈Q\nΦ\nλ\nn\n(h\n′\n,q).(46)\nFrom","Lemma","23,","with","probability1−δ,","we","have\n∀q∈Q:|Φ\nn\n(h\n′\n,q)−Φ(h\n′\n,q)|.C\n1\n{η\nn\nkqk\n2\n+η\n2\nn\n}.(47)\nHere,","we","usel(a\n1\n,a\n2\n)",":=a\n1\na\n2\n,a\n1\n=q(s,a),a\n2\n=y−h(x,a,w)isC\n1\n-Lipschitz","with","respect","to\na\n1\nnotingy−h(x,a,w)is","in[−C\n1\n,C\n1\n]with","some","constantsC\n1\n:\n=C\nY\n+C\nH\n.\n|l(a\n1\n,a\n2\n)−l(a\n′\n1\n,a\n2\n)|≤C\n1\n|a\n1\n−a\n′\n1\n|.\nThus,\nsup\nq∈Q\nΦ\nλ\nn\n(h\n′\n,q)≤sup\nq∈Q\n{Φ\nn\n(h\n′\n,q)−λkqk\n2\nn\n}definition\n≤sup\nq∈Q\n{Φ(h\n′\n,q)","+cC\n1\n{η\nn\nkqk\n2\n+η\n2\nn\n}−λkqk\n2\nn\n}From","Eq.","(47)\n≤sup\nq∈Q\n{Φ(h\n′\n,q)","+cC\n1\n{η\nn\nkqk\n2\n+η\n2\nn\n}−0.5λkqk\n2\n2\n+λη\n2\nn\n}From","Eq.","(45)\n≤sup\nq∈Q\n{Φ(h\n′\n,q)−0.25λkqk\n2\n2\n+cC\n1\n{η\nn\nkqk\n2\n+η\n2\nn\n}−0.25λkqk\n2\n2\n+λη\n2\nn\n}\n≤sup\nq∈Q\n{Φ(h\n′\n,q)−0.25λkqk\n2\n2\n+c(λ+C\n2\n1\n/λ+C\n1\n)η\n2\nn\n}.\nIn","the","last","line,","we","use","a","general","inequalitya,b",">0:\nsup\nq∈Q\n(akqk\n2\n−bkqk\n2\n2\n)≤a\n2\n/4b.\nMoreover,\nsup\nq∈Q\nΦ\nλ\nn\n(\nˆ\nh,q)","=","sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)","+","Φ\nn\n(h\n′\n,q)−λkqk\n2\nn\n}\n≥sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2λkqk\n2\nn\n}+","inf\nq∈Q\n{Φ\nn\n(h\n′\n,q)","+λkqk\n2\nn\n}\n=","sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2λkqk\n2\nn\n}+","inf\n−q∈Q\n{Φ\nn\n(h\n′\n,−q)","+λkqk\n2\nn\n}\n=","sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2λkqk\n2\nn\n}+","inf\n−q∈Q\n{−Φ\nn\n(h\n′\n,q)","+λkqk\n2\nn\n}\n=","sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2λkqk\n2\nn\n}−sup\n−q∈Q\n{Φ\nn\n(h\n′\n,q)−λkqk\n2\nn\n}\n=","sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2λkqk\n2\nn\n}−sup\n−q∈Q\n{Φ\nλ\nn\n(h\n′\n,q)}\n=","sup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2λkqk\n2\nn\n}−sup\nq∈Q\n{Φ\nλ\nn\n(h\n′\n,q)}.\n46\n\nHere,","we","useQis","symmetric.","Therefore,\nsup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ\nn\n(h\n′\n,q)−2kqk\n2\nn\n}≤sup\nq∈Q\n{Φ\nλ\nn\n(\nˆ\nh,q)}+","sup\nq∈Q\n{Φ\nλ\nn\n(h\n′\n,q)}\n≤2","sup\nq∈Q\n{Φ\nλ\nn\n(h\n′\n,q)}(From","(46))\n≤2","sup\nq∈Q\n{Φ(h\n′\n,q)−0.25λkqk\n2\n2\n+c(λ+C\n2\n1\n/λ+C\n1\n)η\n2\nn\n}\n≤2","sup\nq∈Q\n{kP\nz\n(h\n0\n−h\n′\n)k\n2\nkqk\n2\n−0.25λkqk\n2\n2\n+c(λ+C\n2\n1\n/λ+C\n1\n)η\n2\nn\n}\n≤c{kP\nz\n(h\n0\n−h\n′\n)k\n2\n2\n/λ+","(λ+C\n2\n1\n/λ+C\n1\n)η\n2\nn\n}.\nPart","2We","fixq\n′\n∈Q.","Then,","we","define\nq\nh\n:\n=","arg","min\nq∈Q\nkq−P\nz\n(h\n′\n−h)k.\nSupposekq\nˆ\nh\nk\n2\n≥η\nn\n,","and","letr=η\nn\n/{2kq\nˆ\nh\nk}","∈[0,0.5].","Then,","notingQis","star-convex,Qis\nsymmetric,\nsup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ(h\n′\n,q)−2λkqk\n2\nn\n}≥r{Φ\nn\n(\nˆ\nh,q\nˆ\nh\n)−Φ(h\n′\n,q\nˆ\nh\n)}−2λr\n2\nkq\nˆ\nh\nk\n2\nn\n.\nHere,","we","userq\nˆ\nh\n∈Q.","Then,\nr\n2\nkq\nˆ\nh\nk\n2\n.r\n2\n{1.5kq\nˆ\nh\nk\n2\n2\n+","0.5η\n2\nn\n}From","Eq.","(45)\n.η\n2\nn\n.From","definition","ofr.\nTherefore,\nsup\nq∈Q\n{Φ\nn\n(\nˆ\nh,q)−Φ(h\n′\n,q)−2λkqk\n2\nn\n}≥r{Φ\nn\n(\nˆ\nh,q\nˆ\nh\n)−Φ(h\n′\n,q\nˆ\nh\n)}−2λη\n2\nn\n.\nObserve","that\nΦ\nn\n(h,q\nh\n)−Φ\nn\n(h\n′\n,q\nh\n)","=E\nn\n[{h\n′\n−h}q\nh\n(s,a)].\nTherefore,","from","Lemma","23,","notingη\nn\nupper","bounds","the","critical","radius","ofstar(G\nh\n),∀h∈H,\n|Φ\nn\n(h,q\nh\n)−Φ\nn\n(h\n′\n,q\nh\n)−{Φ(h,q\nh\n)−Φ(h\n′\n,q\nh\n)}|\n≤(η\nn\nk{h−h\n′\n}q\nˆ\nh\nk\n2\n+η\n2\nn\n)\n.(C\n1\nη\nn\nkq\nˆ\nh\nk\n2\n+η\n2\nn\n).\nIn","the","last","line,","we","usekh−h\n′\nk\n∞\n.C\n1\n.","We","invoke","Lemma","23","treatingl(a\n1\n,a\n2\n),a\n1\n=","(h−h\n′\n)q.\nThus,\nr{Φ\nn\n(\nˆ\nh,q\nˆ\nh\n)−Φ\nn\n(h\n′\n,q\nˆ\nh\n)}≥r{Φ(\nˆ\nh,q\nˆ\nh\n)−Φ(h\n′\n,q\nˆ\nh\n)}−cr(C\n1\nη\nn\nkq\nˆ\nh\nk\n2\n+η\n2\nn\n)\n≥r{Φ(\nˆ\nh,q\nˆ\nh\n)−Φ(h\n′\n,q\nˆ\nh\n)}−crC\n1\nη\nn\nkq\nˆ\nh\nk\n2\n−c0.5η\n2\nn\n(Definition","ofr)\n(a)\n=rE[P\nz\n(−\nˆ\nh+h\n′\n)q\nˆ\nh\n]−crC\n1\nη\nn\nkq\nˆ\nh\nk\n2\n−c0.5η\n2\nn\n=\nη\nn\n2kq\nˆ\nh\nk\n2\n{E[P\nz\n(−\nˆ\nh+h\n′\n)q\nˆ\nh\n]−cC\n1\nkq\nˆ\nh\nk\n2\nη\nn\n}−0.5η\n2\nn\n≥0.5η\nn\n{kP\nz\n(−\nˆ\nh+h\n′\n)k\n2\n−2ǫ\nn\n}−c(1","+C\n1\n)η\n2\nn\n.\nFor","(a),","we","use\nΦ(\nˆ\nh,q\nˆ\nh\n)−Φ(h\n′\n,q\nˆ\nh\n)","=E[{−\nˆ\nh+h\n′\n}q\nˆ\nh\n]","=E[P\nz\n(−\nˆ\nh+h\n′\n)q\nˆ\nh\n].\n47\n\nFor","(b),","we","use\nE[P\nz\n(−\nˆ\nh+h\n′\n)q\nˆ\nh\n]\nkq\nˆ\nh\nk\n2\n=\nE[{−q\nˆ\nh\n+q\nˆ\nh\n+P\nz\n(−\nˆ\nh+h\n′\n)}q\nˆ\nh\n]\nkq\nˆ\nh\nk\n2\n≥\nkq\nˆ\nh\nk\n2\n2\n−k{−q\nˆ\nh\n+P\nz\n(−\nˆ\nh+h\n′\n)}k\n2\nkq\nˆ\nh\nk\n2\nkq\nˆ\nh\nk\n2\n=kq\nˆ\nh\nk\n2\n−k{−q\nˆ\nh\n+P\nz\n(−\nˆ\nh+h\n′\n)}k\n2\n=kq\nˆ\nh\nk\n2\n−ǫ\nn\n≥kP\nz\n(−\nˆ\nh+h\n′\n)k\n2\n−2ǫ\nn\n.\nCombining","all","resultsThus,kq\nˆ\nh\nk\n2\n≤η\nn\nor\nη\nn\n{kP\nz\n(\nˆ\nh−h\n′\n)k\n2\n−ǫ\nn\n}−(1","+C\n1\n+λ)η\n2\nn\n.\nkP\nz\n(h\n0\n−h\n′\n)k\n2\n2\nλ\n+","(λ+C\n2\n1\n/λ+C\n1\n)η\n2\nn\n.\nTherefore,","we","have\nkP\nz\n(\nˆ\nh−h\n′\n)k\n2\n.kq\nˆ\nh\nk\n2\n+kP\nz\n(\nˆ\nh−h\n′\n)−q\nˆ\nh\nk\n2\n≤η\nn\n+ǫ\nn\nor\nkP\nz\n(\nˆ\nh−h\n′\n)k\n2\n.(1","+λ+C\n2\n1\n/λ+C\n1\n)η\nn\n+\nkP\nz\n(h\n0\n−h\n′\n)k\n2\n2\nη\nn\nλ\n+ǫ\nn\n.\nThus,","from","triangle","inequality,\nkP\nz\n(h\n0\n−\nˆ\nh)k\n2\n.(1","+λ+C\n2\n1\n/λ+C\n1\n)η\nn\n+\nkP\nz\n(h\n0\n−h\n′\n)k\n2\n2\nη\nn\nλ\n+ǫ\nn\n+kP\nz\n(h\n0\n−h\n′\n)k\n2\n.\nProof","of","Theorem","15.Define\nΦ(q,h)","=E[−q(x,a,z)π(a|x)h(x,a,w)","+E\na∼π(a|x)\n[h(x,a,w)]]\nΦ\nn\n(q,h)","=E\nn\n[−q(x,a,z)π(a|x)h(x,a,w)","+E\na∼π(a|x)\n[h(x,a,w)]]\nΦ\nλ\n(q,h)","=E[−q(x,a,z)π(a|x)h(x,a,w)","+E\na∼π(a|x)\n[h(x,a,w)]]−λE[h\n2\n]\nΦ\nλ\nn\n(q,h)","=E\nn\n[−q(x,a,z)π(a|x)h(x,a,w)","+E\na∼π(a|x)\n[h(x,a,w)]]−λE\nn\n[h\n2\n].\nFrom","Lemma","22,","we","have\n∀h∈H,|khk\n2\nn\n−khk\n2\n2\n|≤0.5khk\n2\n2\n+η\n2\nn\n(48)\nfor","our","choice","ofη\nn\n:=η\nq,n\n+\np\nc\n0\nlog(c\n1\n/δ)/nnotingη\nq,n\nupper","bounds","the","critical","radius","ofH.\nFirst","PartBy","definition","ofˆqandq\n′\n∈Q,","we","have\nsup\nh∈H\nΦ\nλ\nn\n(ˆq;h)","=","sup\nh∈H\nΦ\nλ\nn\n(q\n′\n;h).\nFrom","Lemma","23,","with","probability1−δ,","we","have\n∀h∈H,|Φ\nn\n(q\n′\n,h)−Φ(q\n′\n,h)|.C\n2\n{η\nn\nkhk\n2\n+η\n2\nn\n},","C\n2\n=C\nQ\n+C\n1/2\nw\n,(49)\nwhereC\nQ\nis","an","upper","bound","of","the","function","class{q(s,a,z)π(a|x)}.","This","is","derived","as","follows.\nFirst,","we","use","the","lossl(a\n1\n,a\n2\n)","=a\n1\na\n2\n,a\n1\n=−q(x,a,z)π(a|x),a\n2\n=h(x,a,w)isC\nQ\n-Lipschitz","in\na\n2\n.","This","implies\n|E\nn\n[−q(x,a,z)π(a|x)h(x,a,w)]−E[−q(x,a,z)π(a|x)h(x,a,w)]|.C\nQ\n{η\nn\nkhk\n2\n+η\n2\nn\n}.\n48\n\nSimilarly,\n|E\nn\n[Th]−E[Th]|.{η\nn\nkThk\n2\n+η\n2\nn\n}.{η\nn\nC\n1/2\nw\nkhk\n2\n+η\n2\nn\n}.\nCombining","the","above","twos,","Eq.","(49)","is","derived.\nThus,\nsup\nh∈H\nΦ\nλ\nn\n(q\n′\n,h)","=","sup\nh∈H\n{Φ\nn\n(q\n′\n,h)−λkhk\n2\nn\n}\n≤sup\nh∈H\n{Φ(q\n′\n,h)","+cC\n2\n(η\nn\nkhk\n2\n+η\n2\nn\n)−λkhk\n2\nn\n}\n≤sup\nh∈H\n{Φ(q\n′\n,h)","+cC\n2\n(η\nn\nkhk\n2\n+η\n2\nn\n)−0.5λkhk\n2\n2\n+λη\n2\nn\n}(Use","Eq.","(48))\n≤sup\nh∈H\n{Φ(q\n′\n,h)−0.25λkhk\n2\n2\n+cC\n2\n(η\nn\nkhk\n2\n+η\n2\nn\n)−0.25λkhk\n2\n2\n+λη\n2\nn\n}\n≤sup\nh∈H\n{Φ(q\n′\n,h)−0.25λkhk\n2\n2\n+c{C\n2\n2\n/λ+λ+C\n2\n}η\n2\nn\n}.\nIn","the","last","line,","we","use","a","general","inequalitya,b",">0,\nakhk\n2\n−bkhk\n2\n2\n≤a\n2\n/4b.\nMoreover,\nsup\nh∈H\nΦ\nλ\nn\n(ˆq,h)\n=","sup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ(q\n′\n,h)","+","Φ(q\n′\n,h)−khk\n2\nn\n−kThk\n2\nn\n}\n≥sup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ(q\n′\n,h)−2khk\n2\nn\n−2kThk\n2\nn\n}+","inf\nh∈H\n{Φ(q\n′\n,h)−khk\n2\nn\n−kThk\n2\nn\n}\n=","sup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ(q\n′\n,h)−2khk\n2\nn\n−2kThk\n2\nn\n}+","inf\n−h∈H\n{Φ(q\n′\n,−h)−khk\n2\nn\n−kThk\n2\nn\n}\n=","sup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ(q\n′\n,h)−2khk\n2\nn\n−2kThk\n2\nn\n}−sup\n−h∈H\n{Φ(q\n′\n,h)","+khk\n2\nn\n+kThk\n2\nn\n}\n=","sup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ(q\n′\n,h)−2khk\n2\nn\n−2kThk\n2\nn\n}−sup\nh∈H\n{Φ\nλ\n(q\n′\n,h)}.\nHere,","we","useHis","symmetric.","Therefore,\nsup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ(q\n′\n,h)−2khk\n2\nn\n}≤sup\nh∈H\n{Φ\nλ\nn\n(ˆq,h)}+","sup\nh∈H\n{Φ\nλ\n(q\n′\n,h)}\n≤2","sup\nh∈H\n{Φ\nλ\nn\n(q\n′\n,h)}\n≤sup\nh∈H\n{Φ(q\n′\n,h)−0.25λkhk\n2\n2\n+c{C\n2\n2\n/λ+λ+C\n2\n}η\n2\nn\n}\n≤sup\nh∈H\n{kP\nw\n(q\n′\n−q\n0\n)k\n2\nkhk\n2\n−0.25λkhk\n2\n2\n+c{C\n2\n2\n/λ+λ+C\n2\n}η\n2\nn\n}\n≤c{kP\nw\n(q\n′\n−q\n0\n)k\n2\n/λ+C\n2\n2\n/λ+λ+C\n2\n}η\n2\nn\n}.\nSecond","PartWe","fixq\n′\n.","We","define\nh\nq\n:\n=","arg","min\nh∈H\nkh−P\nw\n{(q−q\n′\n)π}k\n2\n.\nSupposekh\nˆq\nk","≥η\nn\n,","and","letr=η\nn\n/{2kh\nˆq\nk\n2\n}","∈(0,0.5].","Then,","notingHis","star-convex","and\nsymmetric,\nsup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ\nn\n(q\n′\n,h)−2λkhk\n2\nn\n}≥r{Φ\nn\n(ˆq,h\nˆq\n)−Φ\nn\n(q\n′\n,h\nˆq\n)}−2λr\n2\nkh\nˆq\nk\n2\nn\n.\nHere,","we","userh\nˆq\n∈H.","Then,","from","Lemma","22,\nr\n2\nkh\nˆq\nk\n2\nn\n≤cr\n2\n{kh\nˆq\nk\n2\n2\n+η\n2\nn\n}\n≤cη\n2\nn\n.(Definition","ofr)\n49\n\nTherefore,\nsup\nh∈H\n{Φ\nn\n(ˆq,h)−Φ\nn\n(q\n′\n,h)−2λkhk\n2\nn\n}≥r{Φ\nn\n(ˆq,h\nˆq\n)−Φ\nn\n(q\n′\n,h\nˆq\n)}−cλη\n2\nn\n.\nObserve","that\nΦ\nn\n(q,h\nq\n)−Φ\nn\n(q\n′\n,h\nq\n)","=E\nn\n[(−q(x,a,z)","+q\n′\n(x,a,z))π(a|x)h\nq\n(a,x,y)].\nTherefore,","from","Lemma","23,","notingη\nn\nupper","bounds","the","critical","radius","ofG\nq\n,","settingl(a\n1\n,a\n2\n)","=\na\n1\na\n2\n,a\n1\n=","(q−q\n′\n)πh\nq\n,","we","have∀q∈Q,\n|Φ\nn\n(q,h\nq\n)−Φ\nn\n(q\n′\n,h\nq\n)−{Φ(q,h\nq\n)−Φ(q\n′\n,h\nq\n)}|\n≤c(η\nn\nE[{(q\n′\n(x,a,z)−q(x,a,z))π(a|x)h\nq\n(a,x,y)}\n2\n]\n1/2\n+η\n2\nn\n)\n≤c(η\nn\nkh\nq\nk\n2\nC\n2\n+η\n2\nn\n).\nHere,","we","usek(q\n′\n(x,a,z)−q(x,a,z))π(a|x)k\n∞\n≤C\n2\n.","Then,\nr{Φ(ˆq,h\nˆq\n)−Φ(q\n′\n,h\nˆq\n)}\n≥r{Φ(ˆq,h\nˆq\n)−Φ(q\n′\n,h\nˆq\n)}−rc(η\nn\nkh\nq\nk\n2\nC\n2\n+η\n2\nn\n)\n≥r{Φ(ˆq,h\nˆq\n)−Φ(q\n′\n,h\nˆq\n)}−rc(η\nn\nkh\nq\nk\n2\nC\n2\n)−0.5cη\n2\nn\n(a)\n=rE[P\nw\n{−q\n′\n+","ˆq}(a,x,w)h\nq\n(a,x,w)]−rc(η\nn\nkh\nq\nk\n2\nC\n2\n)−0.5cη\n2\nn\n=\nη\nn\n2{kh\nˆq\nk\n2\n}\n(E[P\nw\n{−q\n′\n+","ˆq}(a,x,w)h\nq\n(a,x,w)]−cη\nn\nC\n2\nkh\nˆq\nk\n2\n)−0.5cη\n2\nn\n(b)\n≥0.5η\nn\n(kP\nw\n{(−q\n′\n+","ˆq)π}k\n2\n−2ǫ\nn\n)−c{1","+C\n2\n}η\n2\nn\n.\nFor","(a),","we","use\nΦ(q,h\nq\n)−Φ(q\n′\n,h\nq\n)","=E[{−q(x,a,z)","+q\n′\n(x,a,z)}π(a|x)h\nq\n(a,x,w)]\n=E[{E[−q(x,a,z)","+q\n′\n(x,a,z)|x,a,w]}π(a|x)h\nq\n(a,x,w)]\n=E[P\nw\n{q\n′\n−q}(a,x,w)h\nq\n(a,x,w)].\nFor","(b),","we","use\nE[πP\nw\n{−q\n′\n+","ˆq}h\nq\n]\nkh\nˆq\nk\n2\n=\nE[[−h\nˆq\n+h\nˆq\n+πP\nw\n{−q\n′\n+","ˆq}]h\nq\n]\nkh\nˆq\nk\n2\n=\nkh\nˆq\nk\n2\n2\n−kh\nˆq\nk\n2\nk−h\nˆq\n+πP\nw\n{−q\n′\n+","ˆq}k\n2\nkh\nˆq\nk\n2\n≥kh\nˆq\nk\n2\n−ǫ\nn\n≥kπP\nw\n{−q\n′\n+","ˆq}k\n2\n−2ǫ\nn\n.\nCombining","all","resultsThus,kh\nˆq\nk≤η\nn\nor\nη\nn\n{kP\nw\n(πˆq−πq\n′\n)k\n2\n−ǫ\nn\n}−(1","+C\n2\n+λ)η\n2\nn\n.kπP\nw\n(q\n′\n−q\n0\n)k\n2\n2\n/λ+{C\n2\n2\n/λ+λ+C\n2\n}η\n2\nn\nTherefore,\nkP\nw\n(πˆq−πq\n′\n)k\n2\n.kh\nˆq\n−πP\nw\n(πˆq−πq\n′\n)k\n2\n+kh\nˆq\nk\n2\n≤η\nn\n+ǫ\nn\n.\nand\nkP\nw\n(πˆq−πq\n′\n)k\n2\n.kπP\nw\n(q\n′\n−q\n0\n)k\n2\n2\n/λη\nn\n+{1","+C\n2\n2\n/λ+λ+C\n2\n}η\nn\n+ǫ\nn\n.\nFinally,","from","triangle","inequality,\nkP\nw\n(πˆq−πq\n0\n)k\n2\n.kπP\nw\n(q\n′\n−q\n0\n)k\n2\n2\n/λη\nn\n+{1","+C\n2\n2\n/λ+λ+C\n2\n}η\nn\n+ǫ\nn\n+kP\nw\n(πq\n0\n−πq\n′\n)k\n2\n.\n50\n\nProof","of","Theorem","5.We","use","notation","in","the","proof","of","Theorem","11.","Then,\nE[{P\nz\n(\nˆ\nh−h\n0\n)}\n2\n]≤sup\nq∈Q\n′\nE[P\nz\n(\nˆ\nh−h\n0\n)q](P\nz\n(H−h\n0\n)⊆Q\n′\n)\n≤sup\nq\n′\n∈Q\n′\nE[{\nˆ\nh−h\n0\n}q]\n≤sup\nq\n′\n∈Q\n′\n|E[{\nˆ\nh−h\n0\n}q]|(Qis","symmetric)\n≤4","","sup\nq∈Q\n′\n,h∈H\n|(E−E\nn\n)[{y−h}q]|.(See","the","argument","in","Theorem","11)\nWe","use","notation","in","the","proof","of","Theorem","12.","Then,\nE[{πP\nw\n(ˆq−q\n0\n)}\n2\n]≤sup\nh∈H\n′\nE[πP\nw\n(ˆq−q\n0\n)h](πP\nw\n(Q−q\n0\n)⊆H\n′\n)\n≤sup\nh∈H\n′\nE[(ˆq−q\n0\n)h]\n≤sup\nh∈H\n′\n|E[(ˆq−q\n0\n)h]|(H\n′\nis","symmetric)\n≤4","","sup\nq∈Q,h∈H\n′\n|(E−E\nn\n)[−qπh+Th]|.(See","the","argument","in","Theorem","12)\nProof","of","Corollary","4.\nVC","subgraph","clasesWe","define","the","empiricalL\n2\n-norm","askf(·)k\nn,2\n={1/n\nP\nf(s\ni\n,a\ni\n)\n2\n}\n1/2\n,\nL\n∞\n-norm","askf(·)k\nn,∞\n=","max\n1≤i≤n\n|f(s\ni\n,a\ni\n)|.","Then,","we","have\nlogN(t,(H−h\n0\n)Q\n′\n,k·k\nn,∞\n)\n≤logN(t,HQ\n′\n,k·k\nn,∞\n)","+","logN(t,h\n0\nQ\n′\n,k·k\nn,∞\n)\n≤logN(t/{2C\nH\n},Q\n′\n,k·k\nn,∞\n)","+","logN(t/{2C\nQ\n},H,k·k\nn,∞\n)","+","logN(t/C\nH\n,Q\n′\n,k·k\nn,∞\n).\nWith","the","above","in","mind,\nZ\nη\n0\nr\nlogN(t,(H−h\n0\n)Q\n′\n,k·k\nn,2\n)\nn\nd(t)\n≤\nZ\nη\n0\nr\nlogN(t,(H−h\n0\n)Q\n′\n,k·k\nn,∞\n)\nn\nd(t)(k·k\nn,2\n≤k·k\nn,∞\n)\n≤\nZ\nη\n0\nr\n2","logN(t/2C\nH\n,Q\n′\n,k·k\nn,∞\n)\nn\n+\nr\nlogN(t/2C\nQ\n,H,k·k\nn,∞\n)\nn\nd(t)\n≤\nZ\nη\n0\nr\n2","logN(t/2C\nH\n,Q\n′\n,\n√\nnk·k\nn,2\n)\nn\n+\nr\nlogN(t/2C\nQ\n,H,\n√\nnk·k\nn,2\n)\nn\nd(t).\n(k·k\nn,∞\n≤k·k\nn,2\n√\nn)\n=O\n\u0012\nZ\nη\n0\np\nmax(V(H),V(Q\n′\n)","log(1/t)d(t)\nlogn\n√\nn\n\u0013\n([van","der","Vaart,","1998,","Lemma","19.15])\n=O\n\u0012\np\nmax(V(H),V(Q\n′\n)\nlogn\n√\nn\nηlog(1/η)\n\u0013\n.\nThen,","the","critical","inequality","in","Lemma","21","becomes\nO\n\u0012\np\nmax(V(H),V(Q)\nlogn\n√\nn\nηlog(1/η)\n\u0013\n≤η\n2\n.\nThis","is","satisfied","with\nη\nh\n=O\n\u0012\np\nmax(V(H),V(Q)\nlogn\n√\nn\nlog\n\u0012\np\nmax(V(H),V(Q)\nlogn\n√\nn\n\u0013\u0013\n.\n51\n\nNonparametric","modelsWe","have\nlogN(t,(H−h\n0\n)Q\n′\n,k·k\nn,∞\n)\n≤logN(t,HQ\n′\n,k·k\nn,∞\n)","+","logN(t,h\n0\nQ\n′\n,k·k\nn,∞\n)\n≤logN(t/{2C\nH\n},Q\n′\n,k·k\nn,∞\n)","+","logN(t/{2C\nQ\n},H,k·k\nn,∞\n)","+","logN(t/C\nH\n,Q\n′\n,k·k\nn,∞\n).\nWith","the","above","in","mind,\nZ\nη\n0\nr\nlogN(t,(H−h\n0\n)Q\n′\n,k·k\nn,2\n)\nn\nd(t)\n≤\nZ\nη\n0\nr\nlogN(t,(H−h\n0\n)Q\n′\n,k·k\n∞\n)\nn\nd(t)(k·k\nn,2\n≤k·k\n∞\n)\n≤\nZ\nη\n0\nr\n2","logN(t/2C\nH\n,Q\n′\n,k·k\n∞\n)\nn\n+\nr\nlogN(t/2C\nQ\n,H,k·k\n∞\n)\nn\nd(t)\nThen,","the","critical","inequality","in","Lemma","21","becomes\n\n\n\n\n\nn\n−1/2\nη\n1−0.5β\n≤η\n2\n,(β≥2)\nn\n−1/2\nlog(η)≤η\n2\n,(β=","2)\nn\n−1/2\nη\n−β+2\n≤η\n2\n,(β≤2).\nBy","solving","the","above","equation","wrtη,","the","rateη\nh\nis","derived.\nProof","of","Corollary","5.We","consider","someh\n′\n∈Hwhich","specified","later.","From","Theorem","14,","for\nh\n0\n∈H\nobs\n0\n∩Λ\nα\n([0,1]\nd\n),","we","have\nkP\nw\n(\nˆ\nh−h\n0\n)k\n2\n=O\n\u0012\nη\n′\nh\n+ǫ\nn\n+\nkP\nw\n(h\n′\n−h\n0\n)k\n2\nη\n′\nh\n+kP\nw\n(h\n′\n−h\n0\n)k\n2\n\u0013\n.\nwhereη\n′\nh\n=η\nh\n+c\n0\np\nlog(c\n1\n/δ)n,","andη\nh\nis","the","maximum","of","critical","radii","ofQ\n′\nandG\nh\n,","and\nǫ\nn\n=","sup\nh∈H\ninf\nq∈Q\n′\nkq−P\nw\n(h−h\n′\n)k\n2\n.\nFirst,","from","Corollary","4,\nη\n′\nh\n=O\n\u0012\n√\nk\nn\nlogn\n√\nn\nlog(\n√\nk\nn\nlogn\n√\nn\n)","+\np\n(1","+","log(1/δ))/n\n\u0013\n.\nNext,","we","takeh\n′\ns.t.\nkP\nw\n(h\n′\n−h\n0\n)k\n2\n≤kh\n0\n−h\n′\nk\n∞\n=O(k\n−p/d\nn\n).\nfrom","the","assumption.","Besides,","for","anyg:=P\nw\n(h−h\n0\n),","we","haveg∈Λ\nα\n[0,1]\nd\n).","Thus,","there\nexistsq∈Q\n′\ns.t.\nkq−P\nw\n(h−h\n′\n)k\n2\n≤kq−P\nw\n(h−h\n0\n)k\n∞\n+kP\nw\n(h\n′\n−h\n0\n)k\n2\n=kq−P\nw\n(h−h\n0\n)k\n∞\n+O(k\n−p/d\nn\n)","=O(k\n−p/d\nn\n),\nwhich","leads","toǫ\nn\n=O(k\n−p/d\nn\n).\nFinally,","the","error","bound","is\nkP\nw\n(h\n0\n−\nˆ\nh)k\n2\n=\n","̃\nO\n","\np\nk\nn\n/n+k\n−p/d\nn\n+\nk\n−2p/d\nn\np\nk\nn\n/n\n!\n.\nThis","is","equal","to\n","̃\nO(n\n−p/(2p+d)\n)by","balancing","the","all","terms.\nProof","of","Lemma","11.Obvious","from","Lemma","5.\nProof","of","Theorem","6.\n52\n\nIPW","estimatorsThe","error","is","decomposed","into","the","three","terms:\n|\nˆ\nJ\nIPW\n−J|=|E\nn\n[ˆqπy]−J|\n≤|{E\nn\n[(ˆq−q\n0\n)πy]−E[(ˆq−q\n0\n)πy]}|+|{E[ˆqπy]−E[q\n0\nπy]}|+|E\nn\n[q\n0\nπy]−J|.(50)\nThe","first","term","in","(50)","is","upper","bounded","by\n2","sup\nq∈Q\n|(E\nn\n−E)[qπy]|.\nThe","second","term","in","(50)","is\nE[ˆqπy]−E[q\n0\nπy]","=E[{(ˆq−q\n0\n)π}y]","=E[{(ˆq−q\n0\n)π}E[y|x,a,z]]\n=E[{(ˆq−q\n0\n)π}E[h\n0\n|x,a,z]](Use","the","assumptionH\n0\n6=∅)\n=E[{(ˆq−q\n0\n)π}h\n0\n]\n=E[P\nw\n{(ˆq−q\n0\n)π}h\n0\n].\nThus,","from","CS","inequality,","this","term","is","upper-bounded","by\nkP\nw\n{(ˆq−q\n0\n)π}k\n2\nkh\n0\nk\n2\n.\nThe","third","term","in","(50)","is","upper-bounded","by","Bernstein","inequality.","This","concludes\n|\nˆ\nJ\nIPW\n−J|≤O(R\nn\n(∞;πQ)","+η\nq\n+\np\n(1","+","log(1/δ))/n).(51)\nREG","estimatorsThe","error","is","decomposed","into","the","three","terms:\n|\nˆ\nJ\nREG\n−J|≤|{E\nn\n[T(\nˆ\nh−h\n0\n)]−E[T(\nˆ\nh−h\n0\n)]}|+|{E[T\nˆ\nh]−E[Th\n0\n]}|+|E\nn\n[Th\n0\n]−J|.(52)\nThe","first","term","in","Eq.","(52)","is","upper","bounded","by\n2|sup\nh∈H\n(E\nn\n−E)[Th]|.\nThe","second","term","in","Eq.","(52)","is","upper-bounded","as","follows:\n|E[T\nˆ\nh]−E[Th\n0\n]|=|E[π(a|x)/f(a|x,w){\nˆ\nh−h\n0\n}]|\n=|E[E[π(a|x)q\n0\n(a,x,z)|a,x,w]{\nˆ\nh−h\n0\n}]|(Use","the","assumptionQ\n0\n6=∅)\n=|E[π(a|x)q\n0\n(a,x,z){\nˆ\nh−h\n0\n}]|\n=|E[π(a|x)q\n0\n(a,x,z)P\nz\n{\nˆ\nh−h\n0\n}]|≤kq\n0\nπk\n2\nkP\nz\n{\nˆ\nh−h\n0\n}k\n2\n.\nThe","third","term","in","Eq.","(52)","is","upper-bounded","by","Bernstein","inequality.","This","concludes\n|\nˆ\nJ\nREG\n−J|≤O(R\nn\n(∞;TH)","+η\nh\n+\np\n(1","+","log(1/δ))/n).(53)\nProof","of","Theorem","7.The","proof","is","similar","to","Theorem","6.","The","error","is","decomposed","into","the","three\nterms:\n|\nˆ\nJ\nDR\n−J|≤|{E\nn\n[{πˆq{y−\nˆ\nh}+T\nˆ\nh}−{πq\n0\n{y−h\n0\n}+Th\n0\n}]−E[πˆq{y−\nˆ\nh}+T\nˆ\nh]−{πq\n0\n{y−h\n0\n}+Th\n0\n}]}|\n+|{E[{πˆq{y−\nˆ\nh}+T\nˆ\nh}]−E[{πq\n0\n{y−h\n0\n}+Th\n0\n}]}|\n+|E\nn\n[{πq\n0\n{y−h\n0\n}+Th\n0\n}]−J|.(54)\nThe","first","term","is","upper-bounded","by\n2|sup\nh∈H,q∈Q\n(E\nn\n−E)[πq{y−h}+Th]|.\n53\n\nIf","the","condition","of","Theorem","4","holds,","the","second","term","is","upper-bounded","by\nkP\nw\n{(ˆq−q\n0\n)π}k\n2\nsup\nh∈H\nkh\n0\n−hk\n2\n.\nIf","the","condition","of","Theorem","3","holds,","the","second","term","is","upper-bounded","by\nkP\nz\n{\nˆ\nh−h\n0\n}k\n2\nsup\nq∈Q\nk{q\n0\n−q}πk\n2\n.\nThe","third","term","is","upper-bounded","by","Bernstein’s","inequality.Then,|\nˆ\nJ\nDR\n−J|is","upper-bunded\nas","the","statements,\nE.5","","Proofs","for","Section","6.3\nProof","of","Theorem","8.We","define\nη\n′\nh\n=η\nh\n+\np\n1","+","log(1/δ)/n,","η\n′\nq\n=η\nq\n+\np\n1","+","log(1/δ)/n.\nRecall","we","use","sample","splitting.","The","estimator","is","defined","as\nE\nn\n1\n[φ(ˆq\n(0)\n,\nˆ\nh\n(0)\n)]","+E\nn\n0\n[φ(ˆq\n(1)\n,\nˆ\nh\n(1)\n)].\nwhereE\nn\n1\n[·]is","the","empirical","average","overD\n1\nandE\nn\n0\n[·]is","the","empirical","average","overD\n0\n.","We\ndefine\nφ(x,a,w,z,y;h,q)","=π(a|s)q(s,a){y−h(s,a)}+","(Th)(s,a).\nWe","take","arbitrary","elementsh\n0\n,q\n0\ns.t.h\n0\n∈H\nobs\n0\n,q\n0\n∈Q\nobs\n0\n.","Then,","the","bias","is","decomposed","into\nthe","three","terms:\nE\nn\n1\n[φ(ˆq,\nˆ\nh)]−J=","(E\nn\n1\n−E)[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)]","+E[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)]","+E\nn\n1\n[φ(q\n0\n,h\n0\n)]−J.\n(55)\nWe","omit(1)fromˆq,\nˆ\nh.","Recall","with","probability1−2δ,","from","the","assumption","(38),","we","have\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n≤O(η\n′\nh\n),kE[\nˆ\nh(a,x,w)−y|a,x,u]k\n2\n≤O(τ\nH\n1,n\nη\n′\nh\n),\nkP\nw\n(ˆq−q\n0\n)k\n2\n≤O(η\n′\nq\n),kE[π(a|x){ˆq(a,x,z)−1/f(a|x,w)}|a,x,u]k\n2\n≤O(τ\nQ\n1,n\nη\n′\nq\n)\nWe","always","condition","on","this","event","in","the","following","proof.\nFirst","TermWith1−δ,","the","first","term","in","(55)","is","obviouslyO(\np\nlog(1/δ)/n\n1\n)from","Bernstein’s\ninequality","noting\nkφ(x,a,r,z,w,y)k\n∞\n≤C\nQ\n{C\nY\n+C\nH\n}+C\nH\n.\nSecond","TermNext,","we","analyze","the","second","term","in","(55)",".","By","some","algebra,","this","is","equal","to\nE[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)|D\n0\n]\n=E[π(ˆq−q\n0\n)(y−h\n0\n)|D\n0\n]","+E[πq\n0\n{−\nˆ\nh+h\n0\n}+T(\nˆ\nh−h\n0\n)|D\n0\n]","+E[π{ˆq−q\n0\n}{h\n0\n−\nˆ\nh}|D\n0\n]\n=E[π{ˆq−q\n0\n}{h\n0\n−\nˆ\nh}|D\n0\n]\n=E[E[π{ˆq−q\n0\n}|A,X,U]E[{h\n0\n−\nˆ\nh}|A,X,U]|D\n0\n](Z⊥W|A,X,U)\n≤kE[\nˆ\nh(a,x,w)−y|a,x,u]k\n2\nkE[π(a|x){ˆq(a,x,z)−1/f(a|x,w)}|a,x,u]k\n2\n(CS","inequality)\n=O(τ\nH\n1,n\nτ\nQ\n1,n\nη\n′\nh\nη\n′\nq\n).\nThird","TermWith1−δ,","the","third","term","in","(55)","is","obviouslyO(\np\nlog(1/δ)/n\n1\n)from","Bern-\nstein’s","inequality\n54\n\nCombining","all","termsWith1−δ,\n|\nˆ\nJ\nDR\n−J|=O(\np\n1","+","log(1/δ)/n+τ\nH\n1,n\nτ\nQ\n1,n\nη\n′\nh\nη\n′\nq\n)","=O(τ\nH\n1,n\nτ\nQ\n1,n\nη\n′\nh\nη\n′\nq\n).\nProof","of","Theorem","9.We","prove","the","following","stronger","statement.","Denote\nkP\nz\n(\nˆ\nh−h\n0\n)k\n2\n≤C\nh\nη\n′\nh\n,kP\nw\n(ˆq−q\n0\n)k\n2\n≤C\nq\nη\n′\nq\n.\nWith","probability1−(δ+","10δ\n′\n),\n|\nˆ\nJ\nDR\n−J|≤\nr\n2var[πq\n0\n{y−h\n0\n}+Th\n0\n]","log(1/δ)\nn\n+\n2{C\nQ\nC\nH\n+C\nQ\nC\nY\n+C\nH\n}log(1/δ)\n3n\n+","min(τ\nH\n2,n\n,τ\nQ\n2,n\n)C\nh\nC\nq\nη\n′\nh\nη\n′\nq\n(56)\n+c\n(\n[τ\nQ\n2,n\nη\n′\nq\nC\nq\n{C\nY\n+C\nH\n}+τ\nH\n2,n\nC\nh\nη\n′\nh\n{C\nQ\n+\n√\nC\nw\n}]\nr\nlog(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nQ\nC\nY\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n)\n.\nwherecis","a","universal","constant","and\nV\neff\n=","var[πq\n0\n{y−h\n0\n}+Th\n0\n].\nThen,","the","asymptotic","statement","is","immediately","given.\nRecall","we","use","sample","splitting.","The","estimator","is","defined","as\nE\nn\n1\n[φ(ˆq\n(0)\n,\nˆ\nh\n(0)\n)]","+E\nn\n0\n[φ(ˆq\n(1)\n,\nˆ\nh\n(1)\n)]\nwhereE\nn\n1\n[·]is","the","empirical","average","overD\n1\nandE\nn\n0\n[·]is","the","empirical","average","overD\n0\n.","We\ndefine\nφ(s,a,r,s\n′\n;h,q)","=π(a|s)q(s,a){y−h(s,a)}+","(Th)(s,a).\nThe","bias","is","decomposed","into","the","three","terms:\nE\nn\n1\n[φ(ˆq,\nˆ\nh)]−J=","(E\nn\n1\n−E)[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)]","+E[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)]","+E\nn\n1\n[φ(q\n0\n,h\n0\n)]−J.\n(57)\nRecall","with","probability1−2δ\n′\n,","from","the","assumption","(39),","we","have\nk(\nˆ\nh−h\n0\n)k\n2\n≤τ\nH\n2,n\nC\nh\nη\n′\nh\n,k(ˆq−q\n0\n)k\n2\n≤τ\nQ\n2,n\nC\nq\nη\n′\nq\n.\nWe","always","condition","on","this","event","in","the","proof.\nFirst","TermWe","analyze","the","first","term","in","(57).","Note","we","have\n(E\nn\n1\n−E)[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)|D\n0\n](58)\n=","(E\nn\n1\n−E)[π(ˆq−q\n0\n)(y−h\n0\n)|D\n0\n](59)\n+","(E\nn\n1\n−E)[πq\n0\n{−\nˆ\nh+h\n0\n}+T(\nˆ\nh−h\n0\n)|D\n0\n](60)\n+","(E\nn\n1\n−E)[π{ˆq−q\n0\n}{h\n0\n−\nˆ\nh}|D\n0\n].(61)\nFrom","Bernstein’s","inequality,","with","probability1−δ\n′\n,","(59)","is\n|(E\nn\n1\n−E)[π(ˆq−q\n0\n)(y−h\n0\n)|D\n0\n]|\n≤\nr\n2E[{π(ˆq−q\n0\n)}\n2\n{y−h\n0\n}\n2\n|D\n0\n]","log(1/δ\n′\n)\nn\n1\n+\n2kπ(ˆq−q\n0\n)(y−h\n0\n)k\n∞\nlog(1/δ\n′\n)\n3n\n1\n≤c\n\n\n\ns\n(τ\nQ\n2,n\n)\n2\nC\n2\nq\nη\n2\nq\n{C\n2\nY\n+C\n2\nH\n}log(1/δ\n′\n)\nn\n1\n+\nC\nQ\n{C\nY\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n.\n\n\n\n.\n(kyk\n∞\n≤C\ny\n,kh\n0\nk\n∞\n≤C\nH\n,kπqk\n∞\n≤C\nQ\n)\n55\n\nFrom","Bernstein’s","inequality,","with","probability1−δ\n′\n,","(60)","is\n|(E\nn\n1\n−E)[q\n0\n{−\nˆ\nh+h\n0\n}+T(\nˆ\nh−h\n0\n)|D\n0\n]|\n≤c\n\n\n\ns\n{E[{πq\n0\n{−\nˆ\nh+h\n0\n}}\n2\n|D\n0\n]","+E[{T(\nˆ\nh−h\n0\n)}\n2\n|D\n0\n]}log(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n\n\n\n≤c\n\n\n\ns\n{E[{−\nˆ\nh+h\n0\n}\n2\n|D\n0\n]C\n2\nQ\n+E[{T(\nˆ\nh−h\n0\n)}\n2\n|D\n0\n]}log(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n\n\n\n.\n(kπq\n0\nk\n∞\n≤C\nQ\n)\nBesides,\nkT(\nˆ\nh−h\n0\n)k\n2\n2\n=E[{E\nπ\n[\nˆ\nh−h\n0\n]}\n2\n]≤E[E\nπ\n[{\nˆ\nh−h\n0\n}\n2\n]](Jensen’s","inequality)\n=E\n\u0014\nπ(A|X)\nf(A|X,W)\n{\nˆ\nh−h\n0\n}\n2\n\u0015\n≤C\nw\nE[{\nˆ\nh−h\n0\n}\n2\n].(kπ(a|x)/f(a|x,w)k\n2\n≤C\nw\n)\nThen,\n|(E\nn\n1\n−E)[q\n0\n{−\nˆ\nh+h\n0\n}+T(\nˆ\nh−h\n0\n)|D\n0\n]|\n≤c\n\n\n\ns\n(τ\nH\n2,n\n)\n2\nC\n2\nh\nη\n2\nh\n{C\n2\nQ\n+C\nw\n}log(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n\n\n\n.(kπq\n0\nk\n∞\n≤C\nQ\n)\nThe","term","(61)","is","similarly","calculated.","Therefore,\n|(E\nn\n1\n−E)[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)|D\n0\n]|\n≤c\n(\n[τ\nQ\n2,n\nη\n′\nq\nC\nq\n{C\nY\n+C\nH\n}+τ\nH\n2,n\nC\nh\nη\n′\nh\n{C\nQ\n+\n√\nC\nw\n}]\nr\nlog(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nQ\nC\nY\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n)\nSecond","TermNext,","we","analyze","the","second","term","in","(57)",".","By","some","algebra,","this","is","equal","to\nE[φ(ˆq,\nˆ\nh)−φ(q\n0\n,h\n0\n)|D\n0\n]\n=E[π(ˆq−q\n0\n)(y−h\n0\n)|D\n0\n]","+E[πq\n0\n{−\nˆ\nh+h\n0\n}+T(\nˆ\nh−h\n0\n)|D\n0\n]","+E[π{ˆq−q\n0\n}{h\n0\n−\nˆ\nh}|D\n0\n]\n=E[π{ˆq−q\n0\n}{h\n0\n−\nˆ\nh}|D\n0\n]\n=E[π{ˆq−q\n0\n}E[{h\n0\n−\nˆ\nh}|a,x,z]|D\n0\n]\n≤min(k{q\n0\n−ˆq}πk\n2\nkP\nz\n(h\n0\n−\nˆ\nh)k\n2\n,kP\nw\n{q\n0\n−ˆq}πk\n2\nk(h\n0\n−\nˆ\nh)k\n2\n)\n≤min(τ\nH\n2,n\n,τ\nQ\n2,n\n)C\nh\nC\nq\nη\n′\nh\nη\n′\nq\n.(CS","inequality)\nCombining","all","termsWith1−(δ+","10δ\n′\n),\n|E\nn\n1\n[φ(ˆq,\nˆ\nh)]","+E\nn\n0\n[φ(ˆq,\nˆ\nh)]−J|\n≤|E\nn\n[φ(q\n0\n,h\n0\n)]−J|+","min(τ\nH\n2,n\n,τ\nQ\n2,n\n)C\nh\nC\nq\nη\n′\nh\nη\n′\nq\n+\n+c\n(\n[τ\nQ\n2,n\nη\n′\nq\nC\nq\n{C\nY\n+C\nH\n}+τ\nH\n2,n\nC\nh\nη\n′\nh\n{C\nQ\n+\n√\nC\nw\n}]\nr\nlog(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nQ\nC\nY\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n)\n≤\nr\n2var[πq\n0\n{y−h\n0\n}+Th\n0\n]","log(1/δ)\nn\n+","min(τ\nH\n2,n\n,τ\nQ\n2,n\n)C\nh\nC\nq\nη\n′\nh\nη\n′\nq\n+\n2{C\nQ\nC\nH\n+C\nQ\nC\nY\n+C\nH\n}log(1/δ)\n3n\n+c\n(\n[τ\nQ\n2,n\nη\n′\nq\nC\nq\n{C\nY\n+C\nH\n}+τ\nH\n2,n\nC\nh\nη\n′\nh\n{C\nQ\n+\n√\nC\nw\n}]\nr\nlog(1/δ\n′\n)\nn\n1\n+\n{C\nQ\nC\nH\n+C\nQ\nC\nY\n+C\nH\n}log(1/δ\n′\n)\nn\n1\n)\n.\n56\n\nE.6","","Proofs","for","Appendix","B\nProof","for","Lemma","12.According","to","Lemma","3,","we","have","thatH\n0\n⊆H\nobs\n0\n.","For","anyh\n0\n∈H\nobs\n0\n⊆H,\nE[Y−h\n0\n(W,A,X)|Z,A,X]","=E[E[Y−h\n0\n(W,A,X)|A,U,X]|Z,A,X]","=","0.\nBy","Assumption","3","condition","2,","we","have","thatE[Y−h\n0\n(W,A,X)|A,U,X]","=","0,i.e.,h\n0\n∈H\n0\n.","It\nfollows","thatH\nobs\n0\n=H\n0\n.","Similarly,","we","can","prove","thatQ\nobs\n0\n=Q\n0\nunder","Assumption","3","condition\n1.\nProof","for","Lemma","13.Consider","two","bridge","functionsh\n0\n,h\n′\n0\n∈H\n0\n:\nE[Y−h\n0\n(W,A,X)|U,A,X]","=E\n\u0002\nY−h\n′\n0\n(W,A,X)|U,A,X\n\u0003\n=","0.\nThus","we","have\nE\n\u0002\nh\n0\n(W,A,X)−h\n′\n0\n(W,A,X)|U,A,X\n\u0003\n=","0.\nThen","Assumption","4","condition","1","implies","thath\n0\n(W,A,X)","=h\n′\n0\n(W,A,X).","Therefore,H\n0\nis","at\nmost","a","singleton.","We","can","similarly","prove","thatQ\n0\nis","at","most","a","singleton.\nProof","for","Lemma","14.Under","Assumption","1,","we","have","that\nE[g(W,A,X)|Z,A,X]","=E[E[g(W,A,X)|U,A,X]|Z,A,X],\nE[g(Z,A,X)|W,A,X]","=E[E[g(Z,A,X)|U,A,X]|W,A,X].\nWe","first","prove","statement","1.","According","to","Assumption","3","condition","2,E[g(W,A,X)|Z,A,X]","=","0\nif","and","only","ifE[g(W,A,X)|U,A,X]","=","0.","Assumption","4","condition","1","further","ensures","that","this\nholds","if","and","only","ifg(W,A,X)","=","0.","In","other","words,","Assumption","3","conditions","2","and","Assumption","4\ncondition","1","are","sufficient","for","Assumption","5","condition","1.","Similarly,","we","can","show","that","Assumption","3\nconditions","1","and","Assumption","4","condition","2","are","sufficient","for","Assumption","5","condition","2.\nNext,","we","prove","statement","2.","IfE[g(W,A,X)|U,A,X]","=","0,","thenE[g(W,A,X)|Z,A,X]","=","0\nas","well.","","By","Assumption","5","condition","1,","this","holds","if","and","only","ifg(W,A,X)","=","0.","Therefore,\nAssumption","5","condition","1","is","sufficient","for","Assumption","4","condition","1.","Similarly,","we","can","prove\nthat","Assumption","5","condition","2","is","sufficient","for","Assumption","4","condition","2.\nProof","for","Proposition","1.Fixa∈","A,x∈","X.","","Letg(W,a,x)be","an|W|","×1vector","whoseith\nelement","isg(w\ni\n,a,x).","Then","condition","1","in","Assumption","5","is","equivalent","to","the","following:\ng\n⊤\n(W,a,x)P(W|Z,a,x)","=","0⇐⇒g(W,a,x)","=","0.\nAccording","to","Assumption","1,","we","haveW⊥Z|U,A,X.","Thus\nP(W|Z,a,x)","=P(W|U,a,x)P(U|Z,a,x).\nTherefore,","we","need\ng\n⊤\n(W,a,x)P(W|U,a,x)P(U|Z,a,x)","=","0⇐⇒g(W,a,x)","=","0.\nThis","requires","the","rank","ofP(W|U,a,x)P(U|Z,a,x)to","be|W|.","It","follows","that|Z|≥|W|=|U|.\nSimilarly,","we","can","prove","that","condition","2","in","Assumption","5","holds","implies|W|≥|Z|=|U|.\nProof","for","Lemma","16.We","need","to","prove","that","the","following","equation","of","the","first","kind","is","solvable:\n[K\nW|a,x\nh](a,u,x)","=k\n0\n(a,u,x),a.e.u,a,xw.r.tP.\nThus","we","only","need","to","verify","the","assumptions","in","the","Picard’s","Theorem","in","Lemma","15","withK=\nK\nW|a,x\nandφ=k\n0\n.","Note","that","condition2in","Lemma","15","is","satisfied","by","our","asserted","assumptions.\nThus","we","only","need","to","showk\n0\n∈N\n\u0000\nK\n∗\nW|a,x\n\u0001\n⊥\n.\nSince(K\n∗\nW|a,x\ng)(w,a,x)","=E[g(U,a,x)|W=w,A=a,X=x].","By","Assumption","3","condition\n1,N\n\u0000\nK\n∗\nW|a,x\n\u0001\n={0},","which","means","thatN\n\u0000\nK\n∗\nW|a,x\n\u0001\n⊥\n=","domK\n∗\nW|a,x\n=L\n2\n(U|A=a,X=x).\nTherefore,k\n0\n∈N\n\u0000\nK\n∗\nW|a,x\n\u0001\n⊥\n.\nProof","for","Lemma","17.The","proof","is","completely","analogous","to","the","proof","for","Lemma","16.\n57\n\nE.7","","Proofs","for","Appendix","C\nProof","for","Lemma","18.By","the","definition","ofH\nobs\n0\n,","we","have","that\nE[Y−h\n0\n(W,A,X)|Z,A,X]","=E\n\u0002\nY−h\n′\n0\n(W,A,X)|Z,A,X\n\u0003\n=","0,\nwhich","implies","that\nP\nz\n\u0000\nh\n0\n−h\n′\n0\n\u0001\n=E\n\u0002\nh\n0\n(W,A,X)−h\n′\n0\n(W,A,X)|Z,A,X\n\u0003\n=","0.\nTherefore,h\n0\n−h\n′\n0\n∈N(P\nz\n).","It","follows","that\nP\nN(P\nz\n)\n⊥\n\u0000\nh\n0\n−h\n′\n0\n\u0001\n=","0.\nEquivalently,\nP\nN(P\nz\n)\n⊥\nh\n0\n=P\nN(P\nz\n)\n⊥\nh\n′\n0\n.\nSimilarly,","we","can","proveπP\nN(P\nw\n)\n⊥\nq\n0\n=πP\nN(P\nw\n)\n⊥\nq\n′\n0\n.\nProof","for","Theorem","10.Step","I:","deriving","the","tangent","space.First,","consider","regular","para-\nmetric","submodelP\nt\n={f\nt\n(y,w,z,a,x)",":t∈R\ns\n}withf\n0\n(y,w,z,a,x)equals","the","true","density\nf(y,w,z,a,x).","The","associated","score","function","is","denoted","asS(y,w,z,a,x)","=∂\nt\nlogf\nt\n(y,w,z,a,x)|\nt=0\n.\nThe","expectation","w.r.t","the","distributionf\nt\n(y,w,z,a,x)is","denoted","byE\nt\n.","We","can","similarly","denote\nthe","score","functions","for","any","component","of","this","parametric","submodel.","","For","example,","the","score\nfunction","forf\nt\n(y,w|z,a,x)is","denoted","asS(y,w|z,a,x)","=∂\nt\nlogf\nt\n(y,w|z,a,x)|\nt=0\n.","It","is","easy\nto","show","that\nS(Y,W,Z,A,X)","=S(Z,A,X)+S(Y,W|Z,A,X),E[S(Z,A,X)]","=","0,E[S(Y,W|Z,A,X)|Z,A,X]","=","0.\nLeth\nt\nandq\nt\nbe","curves","intoN(P\nz\n)\n⊥\nandN(P\nw\n)\n⊥\nrespectively,","such","thath\nt\n|\nt=0\n=h\n∗\n0\nand\nπq\nt\n|\nt=0\n=πq\n∗\n0\n,","and\nE\nt\n[Y−h\nt\n(W,A,X)|Z,A,X]","=","0(62)\nE\nt\n[π(A|X)q\nt\n(Z,A,X)|W,A,X]","=π(A|X)/f\nt\n(A|W,X).(63)\nEq.","(62)","implies","that\n∂\nt\nE\nt\n[Y−h\nt\n(W,A,X)|Z,A,X]|\nt=0\n=","0,\nwhich","in","turn","implies","that\nE[(Y−h\n∗\n0\n(W,A,X))S(W,Y|Z,A,X)|Z,A,X]","=E[∂\nt\nh\nt\n(W,A,X)|\nt=0\n|Z,A,X].(64)\nThis","means","thatS(W,Y|Z,A,X)must","satisfy","thatE[(Y−h\n∗\n0\n(W,A,X))S(W,Y|Z,A,X)|Z,A,X]∈\nRange(P\nz\n).\nSimilarly,","Eq.","(63)","implies","that\nE\n\u0014\nπ(A|X)q\n∗\n0\n(Z,A,X)S(Z|W,A,X)","+π(A|X)\nS(A|W,X)\nf(A|W,X)\n|W,A,X\n\u0015\n=−E[∂\nt\n(π(A|X)q\nt\n(Z,A,X))|\nt=0\n|W,A,X],\nor","equivalently\nE[π(A|X)q\n∗\n0\n(Z,A,X)S(Z,A|W,X)|W,A,X]","=−E[∂\nt\n(π(A|X)q\nt\n(Z,A,X))|\nt=0\n|W,A,X].\nThis","in","turn","suggests","that\nE[π(A|X)q\n∗\n0\n(Z,A,X)S(Z,A|W,X)|W,A,X]∈Range(P\nw\n)(65)\n58\n\nNote","that\nS(z,a|w,x)","=∂\nt\nlogf\nt\n(z,a|w,x)|\nt=0\n=∂\nt\nlogf\nt\n(w,z,a,x)|\nt=0\n−∂\nt\nlogf\nt\n(w,x)|\nt=0\n=\n∂\nt\nR\nf\nt\n(y,w,z,a,x)dy|\nt=0\nf(w,z,a,x)\n−\n∂\nt\nRRR\nf\nt\n(y,w,z,a,x)dydzda|\nt=0\nf(w,x)\n=\nR\nf(y,w,z,a,x)S(y,w,z,a,x)dy\nf(w,z,a,x)\n−\nRRR\nf(y,w,z,a,x)S(y,w,z,a,x)dydzda\nf(w,x)\n=E[S(Y,W,Z,A,X)|Z=z,A=a,W=w,X=x]−E[S(Y,W,Z,A,X)|W=w,X=x].\nThus","we","have\nE[π(A|X)q\n∗\n0\n(Z,A,X)","(E[S(Y,W,Z,A,X)|W,Z,A,X]−E[S(Y,W,Z,A,X)|W,X])|W,A,X]∈Range(P\nw\n).\n(66)\nTherefore,","all","score","vectors","underM\nnp\nmust","lie","in","the","following","setS:\nS=\n\u001a\nS(Y,W,Z,A,X)","=S(Z,A,X)","+S(Y,W|Z,A,X)",":\nS(Z,A,X)∈L\n2\n(Z,A,X),S(Y,W|Z,A,X)∈L\n2\n(Y,W|Z,A,X),\nE[S(Z,A,X)]","=","0,E[S(Y,W|Z,A,X)|Z,A,X]","=","0,\nE[π(A|X)q\n∗\n0\n(Z,A,X)","(E[S(Y,W,Z,A,X)|W,Z,A,X]−E[S(Y,W,Z,A,X)|W,X])|W,A,X]∈Range(P\nw\n),\nE[(Y−h\n∗\n0\n(W,A,X))S(Y,W|Z,A,X)|Z,A,X]∈Range(P\nz\n)\n\u001b\n.(67)\nStep","II:","deriving","a","preliminary","influence","function.Denote","the","target","parameter","under\ndistributionf\nt\n(y,w,z,a,x)asJ\nt\n=E\nt\n[Th\nt\n(W,X)].","We","need","to","derive\n∂\nt\nJ\nt\n|\nt=0\n=E[Th\n∗\n0\n(W,X)S(W,X)]","+E[∂\nt\nTh\nt\n(W,X)|\nt=0\n]\nNote","that\nE[∂\nt\nTh\nt\n(W,X)|\nt=0\n]","=E[π(A|X)q\n∗\n0\n(Z,A,X)E[∂\nt\nh\nt\n(W,A,X)|\nt=0\n|Z,A,X]]\n=E[π(A|X)q\n∗\n0\n(Z,A,X)","(Y−h\n∗\n0\n(W,A,X))S(W,Y|Z,A,X)]\n=E[π(A|X)q\n∗\n0\n(Z,A,X)","(Y−h\n∗\n0\n(W,A,X))S(W,Y|Z,A,X)]\n+E[π(A|X)q\n∗\n0\n(Z,A,X)","(Y−h\n∗\n0\n(W,A,X))S(Z,A,X)]\n=E[π(A|X)q\n∗\n0\n(Z,A,X)","(Y−h\n∗\n0\n(W,A,X))S(W,Y,Z,A,X)].\nHere","the","second","equality","follows","from","Eq.","(64),","and","the","thirdequality","follows","from","the","fact","that\nE[Y−h\n∗\n0\n(W,A,X)|Z,A,X]","=","0.\nMoreover,\nE[Th\n∗\n0\n(W,X)S(W,X)]","=E[Th\n∗\n0\n(W,X)S(W,X)]","+E[Th\n∗\n0\n(W,X)S(Y,Z,A|W,X)]\n=E[Th\n∗\n0\n(W,X)S(Y,W,Z,A,X)]\n=E[(Th\n∗\n0\n(W,X)−J)S(Y,W,Z,A,X)].\nHere","the","first","equality","follows","from","the","fact","thatE[S(Y,Z,A|W,X)|W,X]","=","0,","and","the","last\nequality","follows","fromE[S(Y,Z,A,W,X)|W,X]","=","0.\nTherefore,","we","have","that\n∂\nt\nJ\nt\n|\nt=0\n=E[(π(A|X)q\n∗\n0\n(Z,A,X)[Y−h\n∗\n0\n(W,A,X)]","+Th\n∗\n0\n(W,X)−J)S(Y,W,Z,A,X)].\nThis","means","thatπ(A|X)q\n∗\n0\n(Z,A,X)[Y−h\n∗\n0\n(W,A,X)]","+Th\n∗\n0\n(W,X)−Jis","a","valid","influence\nfunction","forJunder","the","modelM\nnp\n.\nStep","III:","verifying","efficient","influence","function.Now","we","verify","thatπ(A|X)q\n∗\n0\n(Z,A,X)[Y−\nh\n∗\n0\n(W,A,X)]+Th\n∗\n0\n(W,X)−Jalso","belongs","toSso","that","it","is","also","the","efficient","influence","function\nforJrelative","to","the","tangent","spaceS.\n59\n\nFirst,","note","that","we","can","decompose","this","influence","function","in","the","following","way:\n","̃\nS(Y,W,Z,A,X)\n:\n=π(A|X)q\n∗\n0\n(Z,A,X)[Y−h\n∗\n0\n(W,A,X)]","+Th\n∗\n0\n(W,X)−J\n=\n","̃\nS(Z,A,X)","+\n","̃\nS(Y,W|Z,A,X),\nwhere\n","̃\nS(Z,A,X)","=E[Th\n∗\n0\n(W,X)−J|Z,A,X],\n","̃\nS(Y,W|Z,A,X)","=Th\n∗\n0\n(W,X)−E[Th\n∗\n0\n(W,X)|Z,A,X]","+π(A|X)q\n∗\n0\n(Z,A,X)[Y−h\n∗\n0\n(W,A,X)].\nIt","is","easy","to","show","thatE\nh\n","̃\nS(Z,A,X)\ni\n=","0andE\nh\n","̃\nS(Y,W|Z,A,X)|Z,A,X\ni\n=","0.","According\nto","the","Eq.","(43),","we","have","that\nE\nh\n(Y−h\n∗\n0\n(W,A,X))\n","̃\nS(Y,W|Z,A,X)|Z,A,X\ni\n∈Range(P\nz\n).\nNext,","it","is","easy","to","show","that\nE\nh\n","̃\nS(Y,W,Z,A,X)|W,Z,A,X\ni\n−E\nh\n","̃\nS(Y,W,Z,A,X)|W,X\ni\n=π(A|X)q\n0\n(Z,A,X)","(E[Y|W,Z,A,X]−h\n0\n(W,A,X))\n−E[π(A|X)q\n0\n(Z,A,X)","(E[Y|W,Z,A,X]−h\n0\n(W,A,X))|W,X]\nBy","the","asserted","Eq.","(44),","we","have","that\nE\n\u0002\nπ(A|X)q\n2\n0\n(Z,A,X)","(E[Y|W,Z,A,X]−h\n0\n(W,A,X))|W,A,X\n\u0003\n−E[q\n0\n(Z,A,X)E[π(A|X)q\n0\n(Z,A,X)","(E[Y|W,Z,A,X]−h\n0\n(W,A,X))|W,X]|W,A,X]\n∈Range(P\nw\n),\nwhich","implies","that\nE\nh\nq\n0\n(Z,A,X)\n\u0010\nE\nh\n","̃\nS(Y,W,Z,A,X)|W,Z,A,X\ni\n−E\nh\n","̃\nS(Y,W,Z,A,X)|W,X\ni\u0011\n|W,A,X\ni\n∈Range(P\nw\n).\nFinally,","Assumption","7","condition","2","implies","thatE\n\u0002\nEIF\n2\n(J)\n\u0003\n<∞.\nTherefore,\nEIF(J)","=π(A|X)q\n∗\n0\n(Z,A,X)[Y−h\n∗\n0\n(W,A,X)]","+Th\n∗\n0\n(W,X)−J∈S,\nwhich","means","thatEIF(J)is","the","efficient","influence","function","ofJandE\n\u0002\nEIF\n2\n(J)\n\u0003\nis","the","corre-\nsponding","semiparametric","efficiency","bound,","both","relative","to","the","tangent","spaceS.\n60"],"doc8":["\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20201\nAny","Part","of","Bayesian","Network","Structure","Learning\nZhaolong","Ling,","Kui","Yu,","Hao","Wang,","Lin","Liu,","and","Jiuyong","Li\nAbstract—We","study","an","interesting","and","challenging","problem,\nlearning","any","part","of","a","Bayesian","network","(BN)","structure.","In","this\nchallenge,","","it","","will","","be","","computationally","","inefficient","","using","","existing\nglobal","","BN","","structure","","learning","","algorithms","","to","","find","","an","","entire","","BN\nstructure","","to","","achieve","","the","","part","","of","","a","","BN","","structure","","in","","which","","we\nare","","interested.","","And","","local","","BN","","structure","","learning","","algorithms\nencounter","","the","","false","","edge","","orientation","","problem","","when","","they","","are\ndirectly","used","to","tackle","this","challenging","problem.","In","this","paper,\nwe","","first","","present","","a","","new","","concept","","of","","Expand-Backtracking","","to\nexplain","","why","","local","","BN","","structure","","learning","","methods","","have","","the\nfalse","edge","orientation","problem,","then","propose","APSL,","an","efficient\nand","","accurate","","A\nny","","Part","","of","","BN","","Structure","","Learning","","algorithm.\nSpecifically,","APSL","divides","the","V-structures","in","a","Markov","blanket\n(MB)","","into","","two","","types:","","collider","","V-structure","","and","","non-collider","","V-\nstructure,","then","it","starts","from","a","node","of","interest","and","recursively\nfinds","both","collider","V-structures","and","non-collider","V-structures","in\nthe","found","MBs,","until","the","part","of","a","BN","structure","in","which","we","are\ninterested","are","oriented.","To","improve","the","efficiency","of","APSL,","we\nfurther","design","the","APSL-FS","algorithm","using","F\neature","Selection,\nAPSL-FS.","Using","six","benchmark","BNs,","the","extensive","experiments\nhave","","validated","","the","","efficiency","","and","","accuracy","","of","","our","","methods.\nIndex","Terms—Bayesian","","network,","","Local","","structure","","learning,\nGlobal","","structure","","learning,","","Feature","","selection.\nI.","","INTRODUCTION\nB\nAYESIAN","","networks","","(BNs)","","are","","graphical","","models","","for\nrepresenting","","multivariate","","probability","","distributions","","[1],\n[2],","[3].","The","structure","of","a","BN","takes","the","form","of","a","directed\nacyclic","graph","(DAG)","that","captures","the","probabilistic","relation-\nships","between","variables.","Learning","a","BN","plays","a","vital","part","in\nvarious","","applications,","","such","","as","","classification","","[4],","","[5],","","feature\nselection","[6],","[7],","[8],","and","knowledge","discovery","[9],","[10].\nHowever,","","in","","the","","era","","of","","big","","data,","","a","","BN","","may","","easily","","have\nmore","","than","","1,000","","nodes.","","For","","instance,Munin\n1\nis","","a","","well-\nknown","","BN","","for","","diagnosis","","of","","neuromuscular","","disorders","","[11],\nwhich","","has","","four","","subnetworks,","","and","","three","","of","","them","","have","","more\nthan","","1,000","","nodes.","","When","","we","","are","","only","","interested","","in","","one","","of\nsubnetwork","structures,","if","we","can","start","from","any","one","of","nodes\nof","this","subnetwork","and","then","gradually","expands","to","learn","only\nthis","subnetwork","structure,","it","will","be","much","more","efficient","than\nlearning","the","entire","BN","structure.\nThis","work","is","partly","supported","by","the","National","Key","Research","and","Develop-\nment","Program","of","China","(under","grant","2019YFB1704101),","and","the","National\nScience","Foundation","of","China","(under","grant","61876206","and","61872002).\nZ.","Ling","is","with","the","School","of","Computer","Science","and","Technology,","Anhui\nUniversity,","Hefei,","Anhui,","230601,","China.","E-mail:","zlling@ahu.edu.cn.\nK.","","Yu","","and","","H.","","Wang","","are","","with","","Key","","Laboratory","","of","","Knowledge","","Engi-\nneering","","with","","Big","","Data","","of","","Ministry","","of","","Education","","(Hefei","","University","","of\nTechnology),","and","the","School","of","Computer","and","Information,","Hefei","University\nof","","Technology,","","Hefei,","","Anhui,","","230009,","","China.","","E-mail:","","yukui@hfut.edu.cn,\njsjxwangh@hfut.edu.cn.\nL.","","Liu","","and","","J.","","Li","","are","","with","","the","","School","","of","","Information","","Technology","","and\nMathematical","Sciences,","University","of","South","Australia,","Adelaide,","SA,","5095,\nAustralia.","E-mail:","lin.liu@unisa.edu.au,","jiuyong.li@unisa.edu.au.\n1\nhttp://www.bnlearn.com/bnrepository/discrete-massive.html#munin4\nLocal","BN","structure","learning\nT\nDepth=1\nDepth=2\nDepth=3\nScalable\nGlobal","BN","structure","learning\nDepth=4\nFig.","1.","","An","illustrative","example","of","learning","a","part","of","a","BN","structure","around\nnodeTto","any","depth","from","1","to","4,","which","achieves","a","local","BN","structure","around\nTwhen","learning","to","a","depth","of","1,","and","achieves","a","global","BN","structure","when\nlearning","to","a","depth","of","4","(the","maximum","depth).\nThus","in","this","paper,","we","focus","on","learning","any","part","of","a","BN\nstructure,","","that","","is,","","learning","","a","","part","","of","","a","","BN","","structure","","around\nany","one","node","to","any","depth.","For","example","in","Fig.","1,","given","a\ntarget","","variable,","","structure","","learning","","to","","a","","depth","","of","","1","","means","","to\ndiscover","and","distinguish","the","parents","and","children","(PC)","of","the\ntarget","","variable,","","structure","","learning","","to","","a","","depth","","of","","2","","means","","to\ndiscover","and","distinguish","the","PC","of","each","node","in","the","target’s\nPC","on","the","basis","of","structure","learning","to","a","depth","of","1,","and","so\non.\nClearly,","it","is","trivial","to","obtain","any","part","of","a","BN","structure","if\nwe","can","learn","a","global","BN","structure","using","a","global","BN","struc-\nture","","learning","","algorithm","","[12],","","[13],","","[14].","","However,","","learning\na","global","BN","structure","is","known","as","NP-complete","[15],","[16],\nand","easily","becomes","non-tractable","in","large","scale","applications\nwhere","","thousands","","of","","attributes","","are","","involved","","[17],","","[18].","","Fur-\nthermore,","","it","","is","","not","","necessary","","and","","wasteful","","to","","find","","a","","global\nBN","structure","when","we","are","only","interested","in","a","part","of","a","BN\nstructure.\nRecently,","","Gao","","et","","al.","","[19]","","proposed","","a","","new","","global","","BN\nstructure","learning","algorithm,","called","Graph","Growing","Structure\nLearning","","(GGSL).","","Instead","","of","","finding","","the","","global","","structure\ndirectly,","GGSL","starts","from","a","target","node","and","learns","the","local\nstructure","","around","","the","","node","","using","","score-based","","local","","learning\nalgorithm","","[20],","","then","","iteratively","","applies","","the","","local","","learning\nalgorithm","","to","","the","","node’s","","PC","","for","","gradually","","expanding","","the\nlearned","","local","","BN","","structure","","until","","a","","global","","BN","","structure","","is\nachieved.","","However,","","if","","we","","directly","","apply","","GGSL","","to","","tackle\nany","","part","","of","","BN","","structure","","learning","","problem,","","first,","","GGSL","","is\nstill","","a","","global","","BN","","structure","","learning","","algorithm,","","and","","second,\nit","","is","","time-consuming","","or","","infeasible","","when","","the","","BN","","is","","large\nbecause","the","scored-based","local","learning","algorithm","[20]","used\nby","GGSL","needs","to","learn","a","BN","structure","involving","all","nodes\nselected","currently","at","each","iteration","[7].\narXiv:2103.13810v1","","[cs.LG]","","23","Mar","2021\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20202\nFig.","2.","","","A","simple","Bayesian","network.Tis","a","target","node","in","black.","Existing\nlocal","BN","structure","learning","algorithms","cannot","orient","the","edgeF−Twhen\nthey","only","find","the","local","structure","ofT.","Then,","they","recursively","find","the","local\nstructure","of","the","nodesF,","D,","andCfor","expanding","the","local","structure","ofT.\nFinally,","","since","","the","","V-structureA→C←Bcan","","be","","oriented","","in","","the","","local\nstructure","ofC,","the","local","algorithms","backtrack","the","edgesC→D→F→\nT,","and","thusFis","a","parent","ofT.\nDue","","to","","the","","limitation","","of","","the","","score-based","","local","","learning\nalgorithm","","on","","large-sized","","BNs,","","existing","","local","","BN","","structure\nlearning","","algorithms","","are","","constraint-based.","","Such","","as,","","PCD-\nby-PCD","","(PCD","","means","","Parents,","","Children","","and","","some","","Descen-\ndants)","[21]","and","Causal","Markov","Blanket","(CMB)","[22].","Local\nBN","structure","learning","focus","on","discovering","and","distinguish-\ning","the","parents","and","children","of","a","target","node","[22],","and","thus\nPCD-by-PCD","and","CMB","only","learn","a","part","of","a","BN","structure\naround","","any","","one","","node","","to","","a","","depth","","of","","1.","","More","","specifically,\nboth","","of","","PCD-by-PCD","","and","","CMB","","first","","find","","a","","local","","structure\nof","","a","","target","","node.","","If","","the","","parents","","and","","children","","of","","the","","target\nnode","","cannot","","be","","distinguished","","in","","the","","local","","structure,","","these\nalgorithms","","recursively","","find","","the","","local","","structure","","of","","the","","nodes\nin","the","target’s","PC","for","gradually","expanding","the","learned","local\nstructure","(Expanding","phase),","and","then","backtrack","the","edges","in\nthe","learned","expansive","structure","to","distinguish","the","parents","and\nchildren","of","the","target","(Backtracking","phase).","As","illustrated","in\nFig.","2,","we","call","this","learning","process","Expand-Backtracking.\nHowever,","","if","","we","","directly","","apply","","the","","local","","BN","","structure\nlearning","","","algorithms","","","to","","tackle","","","any","","","part","","","of","","","BN","","structure\nlearning","","problem,","","this","","will","","lead","","to","","that","","many","","V-structures\ncannot","be","correctly","found","(i.e.,","V-structures","missed)","during\nthe","","Expanding","","phase.","","Missing","","V-structures","","will","","generate\nmany","","potential","","cascade","","errors","","in","","edge","","orientations","","during\nthe","Backtracking","phase.\nMoreover,","","PCD-by-PCD","","uses","","symmetry","","constraint","","(see\nTheorem","3","in","Section","III)","to","generate","undirected","edges,","so","it\ntakes","time","to","find","more","unnecessary","PCs.","CMB","spends","time\ntracking","","conditional","","independence","","changes","","after","","Markov\nblanket","(MB,","see","Definition","6","in","Section","III)","discovery,","and\nthe","","accuracy","","of","","CMB","","is","","inferior","","on","","small-sized","","data","","sets\nbecause","","it","","uses","","entire","","MB","","set","","as","","the","","conditioning","","set","","for\ntracking","","conditional","","independence","","changes.","","Thus,","","even","","if\nthe","","existing","","local","","BN","","structure","","learning","","algorithms","","do","","not\nmiss","the","V-structures,","they","still","cannot","learn","a","part","of","a","BN\nstructure","efficiently","and","accurately.\nIn","this","paper,","we","formally","present","any","part","of","BN","structure\nlearning,","","to","","learn","","a","","part","","of","","a","","BN","","structure","","around","","any","","one\nnode","","to","","any","","depth","","efficiently","","and","","accurately.","","As","","illustrated\nin","Fig.","1,","any","part","of","BN","structure","learning","can","learn","a","local\nBN","","structure","","with","","a","","depth","","of","","1,","","and","","achieve","","a","","global","","BN\nstructure","","with","","a","","depth","","of","","the","","maximum","","depth.","","And","","hence,\nany","part","of","BN","structure","learning","has","strong","scalability.","The\nmain","contributions","of","the","paper","are","summarized","as","follows.\n1)","","We","present","a","new","concept","of","Expand-Backtracking,","to\ndescribe","the","learning","process","of","the","existing","local","BN\nstructure","","learning","","algorithms.","","And","","we","","divide","","the","","V-\nstructures","included","in","an","MB","into","collider","V-structures\nand","","non-collider","","V-structures","","to","","analyze","","the","","missing\nV-structures","in","Expand-Backtracking.\n2)","","Based","on","the","analysis,","we","propose","APSL,","an","efficient\nand","","","accurate","","","A\nny","","","Part","","","of","","","BN","","","Structure","","","Learning\nalgorithm.","Specifically,","APSL","starts","from","any","one","node\nof","interest","and","recursively","finds","both","of","the","collider","V-\nstructures","and","non-collider","V-structures","in","MBs,","until\nall","edges","in","the","part","of","a","BN","structure","are","oriented.\n3)","","We","","","further","","","design","","","APSL-FS,","","","an","","","any","","","part","","","of","","","BN\nstructure","","learning","","algorithm","","using","","F\neature","","Selection.\nSpecifically,","","APSL-FS","","employs","","feature","","selection","","for\nfinding","a","local","skeleton","of","a","node","without","searching","for\nconditioning","sets","to","speed","up","local","skeleton","discovery,\nleading","to","improve","the","efficiency","of","APSL.\n4)","","We","","conduct","","a","","series","","of","","experiments","","on","","six","","BN","","data\nsets,","","to","","validate","","the","","efficiency","","and","","accuracy","","of","","the\nproposed","","algorithms","","against","","2","","state-of-the-art","","local\nBN","","structure","","learning","","algorithms","","and","","5","","state-of-the-\nart","global","BN","structure","learning","algorithms.\nThe","rest","of","this","paper","is","organized","as","follows:","Section","II\ndiscusses","","related","","work.","","Section","","III","","provides","","notations","","and\ndefinitions.","","Section","","IV","","analyzes","","the","","missing","","V-structures\nin","","Expand-Backtracking.","","Section","","V","","presents","","the","","proposed\nalgorithms","","APSL","","and","","APSL-FS.","","Section","","VI","","discusses","","the\nexperimental","results,","and","Section","VII","concludes","the","paper.\nII.","","RELATEDWORK\nMany","","algorithms","","for","","BN","","structure","","learning","","have","","been\nproposed","","and","","can","","be","","divided","","into","","two","","main","","types:","","local\nmethods","and","global","methods.","However,","there","are","some","issues\nwith","","these","","methods","","when","","we","","apply","","them","","to","","tackle","","the","","any\npart","of","BN","structure","learning","problem.\nLocal","","BN","","structure","","learning","","algorithmsState-of-the-\nart","","local","","methods","","apply","","standard","","MB","","or","","PC","","discovery\nalgorithms","","to","","recursively","","find","","V-structures","","in","","the","","local","","BN\nstructure","for","edge","orientations,","until","the","parents","and","children\nof","","the","","target","","node","","are","","distinguished,","","and","","thus","","they","","learn","","a\npart","","of","","a","","BN","","structure","","around","","any","","one","","node","","to","","a","","depth","","of\n1.","","PCD-by-PCD","","(PCD","","means","","Parents,","","Children","","and","","some\nDescendants)","","[21]","","applies","","Max-Min","","Parents","","and","","Children\n(MMPC)","","[23]","","to","","recursively","","search","","for","","PC","","and","","separating\nsets,","","then","","uses","","them","","for","","local","","skeleton","","construction","","and\nfinding","","V-structures,","","respectively,","","and","","finally","","uses","","the","","V-\nstructures","and","Meek","rules","[24]","for","edge","orientations.","How-\never,","at","each","iteration","of","any","part","of","BN","structure","learning,\nsince","PCD-by-PCD","only","finds","the","V-structures","connecting","a\nnode","with","its","spouses","V-structures,","the","V-structures","included\nin","","the","","PC","","of","","the","","node","","are","","sometimes","","missed,","","then","","using\nthe","","Meek-rules","","leads","","to","","false","","edge","","orientations","","in","","the","","part\nof","a","BN","structure.","Moreover,","PCD-by-PCD","uses","symmetry\nconstraint","","to","","generate","","undirected","","edges,","","so","","it","","needs","","to","","find\nthe","","PC","","of","","each","","node","","in","","the","","target’s","","PC","","to","","generate","","the\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20203\nundirected","edges","between","the","target","and","target’s","PC,","which\nis","","time-consuming.","","Causal","","Markov","","Blanket","","(CMB)","","[22]\nfirst","","uses","","HITON-MB","","[25]","","to","","find","","the","","MB","","of","","the","","target,\nthen","orients","edges","by","tracking","the","conditional","independence\nchanges","","in","","MB","","of","","the","","target.","","However,","","at","","each","","iteration","","of\nany","","part","","of","","a","","BN","","structure","","learning,","","since","","CMB","","only","","find\nV-structures","","included","","in","","the","","PC","","of","","a","","node,","","the","","V-structures\nconnecting","the","node","with","its","spouses","are","sometimes","missed,\nthen","","tracking","","conditional","","independence","","changes","","leads","","to\nfalse","","edge","","orientations","","in","","the","","part","","of","","a","","BN","","structure.","","In\naddition,","","CMB","","uses","","entire","","MB","","set","","as","","the","","conditioning","","set\nand","needs","to","spend","time","for","conditional","independence","tests\nafter","","MB","","discovery,","","which","","deteriorates","","the","","performance","","of\nCMB","in","accuracy","and","efficiency,","respectively.\nGlobal","","BN","","structure","","learning","","algorithmsState-of-the-\nart","","global","","methods","","first","","identify","","each","","variable’s","","MB/PC\nusing","the","existing","MB/PC","methods,","then","construct","a","global\nBN","","skeleton","","(i.e.,","","an","","undirected","","graph)","","using","","the","","found\nMBs/PCs,","and","finally","orient","the","edge","directions","of","the","skele-\nton","using","constraint-based","or","score-based","BN","learning","meth-\nods.","","Grow-Shrink","","(GS)","","[12]","","first","","applies","","constraint-based\nMB","method,","Grow-Shrink","Markov","blanket","(GSMB)","[12]","to\nfind","MB","of","each","node","to","construct","global","BN","skeleton,","then\nuses","","conditional","","independence","","test","","to","","find","","all","","V-structures,\nand","finally","orients","undirect","edges","by","using","Meek-rules","[24].\nSince","","then,","","many","","structure","","learning","","algorithms","","have","","been\nproposed.","","Max-Min","","Hill-Climbing","","(MMHC)","","[13]","","first","","ap-\nplies","constraint-based","PC","method,","MMPC","[23]","to","find","PC","of\neach","node","to","construct","global","BN","skeleton,","then","uses","score-\nbased","","method","","to","","orient","","edges.","","Both","","of","","Score-based","","Local\nLearning+Constraint","","(SLL+C)","","[26]","","and","","Score-based","","Local\nLearning+Greedy","","(SLL+G)","","[26]","","uses","","the","","score-based","","MB\nmethod,","SLL","[26]","to","find","MB/PC","of","each","node","to","construct\nglobal","","BN","","skeleton,","","then","","orient","","edges","","by","","using","","constraint-\nbased","and","score-based","methods,","respectively.","However,","when\nwe","apply","these","global","methods","to","any","part","of","BN","structure\nlearning,","it","is","time-consuming","to","learn","an","entire","BN","structure\nto","achieve","a","part","of","a","BN","structure.\nRecently,","Gao","et","al.","[19]","proposed","graph","growing","structure\nlearning","(GGSL)","to","learn","a","global","BN","structure.","Instead","of\nfinding","the","MB/PC","of","each","variable","in","advance,","GGSL","starts\nfrom","","any","","one","","node","","and","","learns","","the","","local","","structure","","around\nthe","","node","","using","","the","","score-based","","MB","","discovery","","algorithm,\nS\n2\nTMB","[20],","then","iteratively","applies","S\n2\nTMB","to","the","node’s\nneighbors","","for","","gradually","","expanding","","the","","learned","","local","","BN\nstructure","until","an","entire","BN","structure","is","achieved.","However,\nGGSL","still","needs","to","learn","an","entire","BN","structure","to","achieve","a\npart","of","a","BN","structure.","In","addition,","although","the","score-based\nMB","method","can","directly","find","the","local","BN","structure","without\nexpanding","","outward,","","it","","is","","computationally","","expensive","","[7],\nbecause","it","needs","to","learn","a","BN","structure","involving","all","nodes\nselected","","currently","","at","","each","","iteration.","","And","","hence,","","GGSL","","is\ntime-consuming","or","infeasible","when","the","size","of","a","BN","is","large.\nIn","summary,","when","we","apply","existing","local","and","global","BN\nstructure","","learning","","algorithms","","to","","any","","part","","of","","BN","","structure\nlearning,","","local","","methods","","are","","inaccurate","","and","","global","","methods\nTABLE","I\nSUMMARY","OF","NOTATIONS\nSymbolMeaning\nUa","variable","set\nX,","Y,","Ta","variable\nx,","ya","value","of","a","variable\nQa","regular","queue","(first","in,","first","out)\nZ,Sa","conditioning","set","withinU\nX⊥⊥Y|ZXis","conditionally","independent","ofYgivenZ\nX6⊥⊥Y|ZXis","conditionally","dependent","onYgivenZ\nPC\nT\nparents","and","children","ofT\nSP\nT\nspouses","ofT\nSP\nT\n(X)a","subset","of","spouses","ofT,","and","each","node","inSP\nT\n(X)\nhas","a","common","childXwithT\nVa","queried","variable","set","of","variables\nSep\nT\n[X]a","set","thatd-separatesXfromT\n|.|the","size","of","a","set\nSU(X;Y)the","correlation","betweenXandY\nare","","inefficient.","","Thus","","in","","this","","paper,","","we","","attempt","","to","","solve","","the\nproblem","of","any","part","of","BN","structure","learning.\nIII.","","NOTATIONS","ANDDEFINITIONS\nIn","the","following,","we","will","introduce","the","relevant","definitions\nand","theorems.","Table","I","provides","a","summary","of","the","notations\nused","in","this","paper.\nDefinition","1","(Conditional","Independence)[27]","Two","vari-\nablesXandYare","","conditionally","","independent","","givenZ,","","iff\nP(X=x,Y=y|Z=z)","=P(X=x|Z=z)P(Y=\ny|Z=z).\nDefinition","2","(Bayesian","Network)[27]","LetPbe","a","discrete\njoint","probability","distribution","of","a","set","of","random","variablesU\nvia","","a","","directed","","acyclic","","graph","","(DAG)G.","","We","","call","","the","","triplet\n<U,G,P",">a","","Bayesian","","Network","","(BN)","","if<U,G,P",">\nsatisfies","","theMarkov","","Condition:","","every","","variable","","inUis\nconditionally","","independent","","of","","its","","non-descendant","","variables\ngiven","its","parents.\nMarkov","","condition","","enables","","us","","to","","recover","","a","","distributionP\nfrom","a","known","DAGGin","terms","of","conditional","independence\nrelationships.\nDefinition","","3","","(D-Separation)[27].","","A","","pathpbetweenX\nandYgivenZ⊆U\\{X∪Y}is","open,","iff","(1)","every","collider\nonpis","inZor","has","a","descendant","inZ,","and","(2)","no","other","non-\ncollider","","variables","","onpare","","inZ.","","If","","the","","pathpis","","not","","open,\nthenpis","","blocked.","","Two","","variablesXandYared-separated\ngivenZ,","iff","every","path","fromXtoYis","blocked","byZ.\nIf","","two","","variablesXandYare","","d-separated","","relative","","to","","a\nset","","of","","variablesZin","","a","","BN,","","such","","a","","setZwould","","be","","called\na","","separating","","set","","ofXfromY,","","then","","they","","are","","conditionally\nindependent","","givenZin","","all","","probability","","distributions","","where\nthis","BN","can","represent.\nDefinition","","4","","(Faithfulness)[9].","","A","","Bayesian","","network","","is\npresented","by","a","DAGGand","a","joint","probability","distributionP\nover","a","variable","setU.Gis","faithful","toPiff","every","conditional\nindependence","present","inPis","entailed","byGand","the","Markov\ncondition.Pis","","faithful","","iff","","there","","exists","","a","","DAGGsuch","","that\nGis","faithful","toP.\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20204\nThe","","faithfulness","","condition","","enables","","us","","to","","recover","","a","","DAG\nGfrom","a","distributionPto","completely","characterizeP.\nDefinition","","5","","(V-Structure)[27].","","The","","triplet","","of","","variables\nX,Y,","andZforms","a","V-structure","if","nodeZhas","two","incoming\nedges","fromXandY,","formingX→Z←Y,","andXis","not\nadjacent","toY.\nZis","a","collider","ifZhas","two","incoming","edges","fromXand\nYin","a","path,","respectively.\nDefinition","","6","","(Markov","","Blanket)[27]","","Under","","the","","faith-\nfulness","","assumption,","","given","","a","","target","","variableT,","","the","","Markov\nblanket","ofTis","unique","and","consists","of","parents,","children,","and\nspouses","(other","parents","of","the","children)","ofT.\nTheorem","1[9]","Under","the","faithfulness","assumption,X∈U\nandY∈U.","","IfXandYare","","adjacent,","","thenX6⊥⊥Y|S,\n∀S⊆U\\{X∪Y}.\nTheorem","","2[9]","","Under","","the","","faithfulness","","assumption,X∈\nU,Y∈U,","andZ∈U.","IfX,Y,","andZforms","the","V-structure\nX→Z←Y,","","thenX⊥⊥Y|SandX6⊥⊥Y|{S∪Z},\n∀S⊆U\\{X∪Y∪Z}.Xis","a","spouse","ofY.\nUnder","","the","","faithfulness","","assumption,","","Theorem","","1","","presents\nthe","property","of","PC,","and","Theorem","2","presents","the","property","of\nspouses","in","an","MB.\nTheorem","","3Symmetry","constraint.[28]","","Under","","the","","faith-\nfulness","","assumption,","","ifX∈PC\nY\nexists,","","thenY∈PC\nX\nholds.\nIV.","","MISSINGV-STRUCTURES","IN\nEXPAND-BACKTRACKING\nIn","","this","","section,","","we","","first","","give","","the","","definition","","of","","Expand-\nBacktracking","","in","","Section","","IV-A,","","and","","then","","use","","two","","examples\nto","analyze","the","missing","V-structures","in","Expand-Backtracking\nin","Section","IV-B.\nA.","","Definition","of","Expand-Backtracking\nIn","","this","","subsection,","","we","","first","","summarize","","the","","main","","ideas\nof","","local","","BN","","structure","","learning","","algorithms,","","then","","give","","the\ndefinition","of","the","Expand-Backtracking.\nLocal","BN","structure","learning","aims","to","discover","and","distin-\nguish","the","parents","and","children","of","a","target","variable,","and","thus\nthe","","local","BN","","structure","","learning","algorithms","","are","","only","","able","to\nlearn","","a","","part","","of","","a","","BN","","structure","","around","","the","","target","","to","","a","","depth\nof","","1.","","Moreover,","","existing","","local","","algorithms","","are","","constraint-\nbased,","","because","","score-based","","local","","methods","","need","","to","","learn","","a\nBN","","structure","","involving","","all","","nodes","","selected","","currently","","at","","each\niteration,","which","is","time-consuming.\nAs","constraint-based","algorithms,","local","BN","structure","learn-\ning","","algorithms","","first","","find","","a","","local","","structure","","of","","a","","target","","node\nusing","the","following","three","steps.","Then,","since","the","parents","and\nchildren","of","the","target","sometimes","cannot","be","distinguished","in\nthe","","learned","","local","","structure,","","the","","local","","algorithms","","recursively\napply","these","three","steps","to","the","target’s","neighbors","for","gradually\nexpanding","","the","","learned","","local","","structure,","","until","","the","","parents","","and\nchildren","of","the","target","node","are","distinguished.\n1)","","Skeleton","","identification.Use","","standard","","local","","discovery\nalgorithm","to","construct","the","local","BN","skeleton","of","a","target\nnode.\nFig.","","3.","","","","The","","Markov","","blanket","","(in","","blue)","","of","","nodeTcomprisesAandB\n(parents),DandF(children),","andC(spouse).\n(a)","","Collider","","Vstructure","","(Tis","","a","","collider","","in","","the","","V-structure),","","and","","(b)","","non-\ncollider","V-structure","(Tis","not","a","collider","in","the","V-structure).\n2)","","V-structure","discovery.Discover","V-structures","in","the","local\nBN","skeleton.\n3)","","Edge","","orientation.Orient","","as","","many","","edges","","as","","possible\ngiven","the","V-structures","in","the","learned","part","of","BN","skele-\nton,","","to","","get","","a","","part","","of","","BN","","structure","","around","","the","","target\nnode.\nSpecifically,","","in","","the","","edge","","orientation","","step,","","given","","the","","dis-\ncovered","V-structures,","local","BN","structure","learning","algorithms\norient","","the","","edges","","not","","only","","in","","the","","local","","skeleton","","of","","a","","target\nnode,","","but","","also","","the","","skeleton","","outside","","the","","local","","skeleton,","","to\nbacktrack","the","edges","into","the","parents","and","children","of","the","target\nnode","for","distinguishing","them.\nTo","facilitate","the","next","step","in","presentation","and","analysis,","we\ngive","","the","","definition","","of","","the","","learning","","process","","of","","the","","local","","BN\nstructure","learning","algorithms","as","follows.\nDefinition","","7","","(Expand-Backtracking)Under","","the","","faith-\nfulness","","assumption,","","existing","","local","","BN","","structure","","learning\nalgorithms","first","learn","a","local","structure","of","a","target","node,","then\nexpand","","the","","learned","","local","","structure","","and","","backtrack","","the","","edges\nto","","distinguish","","parents","","and","","children","","of","","the","","target","","node.","","We\ncall","this","learning","process","Expand-Backtracking.\nThus,","V-structure","discovery","plays","a","crucial","role","in","Expand-\nBacktracking.","However,","when","the","local","BN","structure","learn-\ning","","algorithms","","are","","Expand-Backtracking,","","they","","ignore","","the\ncorrectness","","","of","","","the","","","V-structures","","","found","","","(i.e.,","","","V-structures\nmissed).","","Since","","the","","edge","","orientation","","step","","is","","based","","on","","the\nV-structure","discovery","step,","missing","V-structures","in","Expand-\nBacktracking","will","cause","a","cascade","of","false","edge","orientations\nin","the","obtained","structure.\nB.","","Analysis","of","missing","V-structures","in","Expand-Backtracking\nIn","this","subsection,","we","first","define","two","types","of","V-structures\nin","an","MB,","then","give","the","examples","to","demonstrate","which","type\nof","V-structures","cannot","be","correctly","identified","when","the","local\nBN","structure","learning","algorithms","are","Expand-Backtracking.\nDefinition","8","(Collider","V-structure","and","Non-collider","V-\nstructure)Under","the","faithfulness","assumption,","there","are","two\ntypes","of","the","V-structure","included","in","the","MB","ofT,","1)","collider\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20205\nFig.","4.","","","(a)","The","ALARM","Bayesian","network;","(b)","an","example","of","using","PCD-by-PCD","to","find","a","part","of","an","Alarm","Bayesian","network","structure","around","node\n10","to","a","depth","of","2;","(c)","an","example","of","using","CMB","to","find","a","part","of","an","Alarm","Bayesian","network","structure","around","node","26","to","a","depth","of","2.\nThe","","red","","’X’","","symbol","","denotes","","the","","falsely","","oriented","","edges,","","the","","blue","","node","","is","","the","","node","","that","","needs","","to","","find","","local","","structure","","at","","each","","iteration,","","the","","number","","in\nparentheses","represents","the","level","of","iterations","of","an","algorithm,","and","’···’","means","omitted","correctly","oriented","iterations.\nV-structure:Tis","","a","","collider","","in","","the","","V-structure,","","and","","2)","","non-\ncollider","V-structure:Tis","not","a","collider","in","the","V-structure.\nDefinition","8","gives","two","types","of","the","V-structures","included\nin","","an","","MB,","","as","","illustrated","","in","","Fig.","","3.","","Thus,","","whether","","collider\nV-structures","or","non-collider","V-structures","cannot","be","correctly\nidentified","in","the","V-structure","discovery","step,","it","will","cause","the\nfalse","edge","orientations","in","the","obtained","structure.","Below,","we\ngive","","the","","examples","","of","","the","","missing","","V-structures","","in","","Expand-\nBacktracking","","using","","two","","representative","","local","","BN","","structure\nlearning","algorithms.\n1)","","","Missing","","","collider","","","V-structures:","","PCD-by-PCD","","[21]\nis","","a","","state-of-the-art","","local","","BN","","structure","","learning","","algorithm,\nwhich","","recursively","","uses","","standard","","PC","","algorithm","","to","","find","","PCs\nand","V-structures.","","However,","PCD-by-PCD","","only","finds","","the","V-\nstructures","","connecting","","the","","node","","with","","its","","spouses","","at","","each\niteration,","","and","","hence,","","PCD-by-PCD","","only","","finds","","non-collider\nV-structures","","leading","","to","","missing","","some","","collider","","V-structures\nat","each","iteration.\nIn","the","following,","under","the","faithfulness","and","correct","inde-\npendence","","tests","","assumption,","","we","","use","","PCD-by-PCD","","to","","find","","a\npart","","of","","an","","ALARM","","[29]","","BN","","structure","","around","","node","","10","","to\na","","depth","","of","","2,","","as","","illustrated","","in","","Fig.","","4","","(b).","","Before","","giving","","the\nexample","step","by","step,","to","make","the","process","easier","for","readers\nto","","understand,","","as","","shown","","in","","Fig.","","5,","","we","","first","","give","","a","","detailed\ndescription","","of","","the","","three","","Meek-rules","","[24]","","used","","by","","PCD-by-\nPCD","in","edge","orientation","step","as","follows:\nR1","","No","","new","","V-structure.OrientY−ZintoY→Z\nwhenever","","there","","is","","a","","directed","","edgeX→Ysuch","","that\nXandZare","not","adjacent;\nR2","","Preserve","","","acyclicity.OrientX−ZintoX→Z\nwhenever","there","is","a","chainX→Y→Z;\nR3","","Enforce","","3-fork","","V-structure.OrientX−YintoX→\nYwhenever","","there","","are","","two","","chainsX−Z→Yand\nX−W→Ysuch","thatZandWare","not","adjacent.\n1st","iteration:PCD-by-PCD","finds","PC","of","10.","PCD-by-PCD\nuses","","symmetry","","constraint","","to","","generate","","undirected","","edges,","","for\nexample,","","PCD-by-PCD","","generates","","undirected","","edgeA−B\nonly","ifAbelongs","to","the","PC","ofBand","B","also","belongs","to","the\nFig.","5.","","","Three","Meek-rules","for","edge","orientations.\nPC","ofA.","Since","PC","of","10","is{11,35},","but","PCs","of","11","and","35\nare","initialized","as","empty","sets","and","can","only","be","discovered","in\nthe","","next","","iterations,","","then","","10","","does","","not","","belong","","to","","the","","PCs","","of\n11","","and","","35,","","and","","there","","are","","no","","undirected","","edges","","generated","","in\nthis","iteration.\n2nd","iteration:PCD-by-PCD","finds","PC","of","11.","Since","PC","of\n10","","is{11,35}and","","PC","","of","","11","","is{10,12},","","then","","10","","belongs\nto","","the","","PC","","of","","11","","and","","11","","also","","belongs","","to","","the","","PC","","of","","10,","","and\nPCD-by-PCD","","generates","","undirected","","edge","","10-11.","","There","","are\nno","V-structures","generated","in","this","iteration,","so","PCD-by-PCD\ndoes","not","need","to","orient","edges.\n3rd","iteration:PCD-by-PCD","finds","PC","of","35,","then","generates\nundirected","","edge","","10-35.","","Since","","the","","non-collider","","V-structure\n11→10←35is","discovered,","PCD-by-PCD","orient","the","non-\ncollider","V-structure,","and","there","are","no","other","undirected","edges\ncan","be","oriented","by","using","Meek-rules.\n4th","iteration:PCD-by-PCD","finds","PC","of","12,","then","generates\nundirected","edges","12-11","and","12-35.","Since","PCD-by-PCD","only\ndiscovers","non-collider","V-structure","at","each","iteration,","it","misses\nthe","","collider","","V-structure11→12←35.","","And","","there","","are","","no\nother","undirected","edges","can","be","oriented","by","using","Meek-rules.\n5th","iteration:PCD-by-PCD","finds","PC","of","9,","and","generates\nundirected","","edge","","9-35.","","Then","","there","","are","","no","","new","","V-structures\ngenerated","and","no","other","undirected","edges","can","be","oriented","by\nusing","Meek-rules.\n6th-9th","","iterations:PCD-by-PCD","","iteratively","","finds","","PCs","","of\n34,","36,","8,","and","13,","and","PCD-by-PCD","correctly","orients","edges\nin","these","iterations,","so","we","omit","them.\n10th","","iteration:PCD-by-PCD","","finds","","PC","","of","","15,","","then","","gen-\nerates","undirected","edge","15-34,","and","discovers","non-collider","V-\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20206\nstructure15→34←13.","","Finally,","","according","","to","","theR1of\nMeek-rules,","","PCD-by-PCD","","backtracks","","the","","edges34→35,\n35→12,35→36,","and12→11.","Thus,","the","edge12→11\nis","falsely","oriented.\n2)","","Missing","","non-collider","","V-structures:","CMB","[22]","is","an-\nother","state-of-the-art","local","BN","structure","learning","algorithm,\nwhich","recursively","uses","standard","MB","algorithm","to","find","MBs\nand","","tracks","","the","","conditional","","independence","","changes","","to","","find\nV-structures.","","However,","","CMB","","only","","finds","","the","","V-structures\nincluded","in","the","PC","of","the","target","at","each","iteration.","Thus,","CMB\nonly","","finds","","collider","","V-structures","","and","","then","","misses","","some","","non-\ncollider","V-structures","at","each","iteration.\nIn","","the","","following,","","under","","the","","faithfulness","","and","","correct","","in-\ndependence","","tests","","assumption,","","we","","use","","CMB","","to","","find","","a","","part\nof","","an","","ALARM","","BN","","structure","","around","","node","","26","","to","","a","","depth","","of\n2,","","as","","illustrated","","in","","Fig.","","4","","(c).","","Moreover,","","CMB","","tracks","","the\nconditional","","independence","","changes","","in","","edge","","orientation","","step,\nwhich","is","similar","to","the","three","Meek-rules","[22].\n1st","","iteration:CMB","","finds","","MB","","of","","26","","and","","generates","","undi-\nrected","","edges","","using","","PC","","of","","26.","","Then","","CMB","","discovers","","the\ncollider","","V-structures25→26←30,30→26←17,","","and\n25→26←17,","","and","","there","","are","","no","","other","","undirected","","edges\ncan","","be","","oriented","","by","","tracking","","the","","conditional","","independence\nchanges.\n2nd","iteration:CMB","finds","MB","of","17,","then","generates","undi-\nrected","edge","17-31,","and","there","are","no","other","undirected","edges\ncan","","be","","oriented","","by","","tracking","","the","","conditional","","independence\nchanges.\n3rd","","iteration:CMB","","finds","","MB","","of","","25","","and","","generates","","undi-\nrected","edges","using","PC","of","25.","Since","CMB","only","finds","collider\nV-structures","","at","","each","","iteration,","","it","","misses","","the","","non-collider\nV-structure25→31←17.","","Then","","there","","are","","no","","other\nundirected","edges","can","be","oriented","by","tracking","the","conditional\nindependence","changes.\n4th","","iteration:CMB","","finds","","MB","","of","","30","","and","","generates","","undi-\nrected","edges","using","PC","of","30.","Since","CMB","discovers","collider\nV-structure27→30←29,","","CMB","","orients","","the","","collider","","V-\nstructure.","","Then","","according","","to","","the","","conditional","","independence\nchanges,","CMB","executes","the","same","way","as","theR1of","the","Meek-\nrules","","to","","backtrack","the","","edges30→31,31→25,31→17,\n25→18,25→24,","and25→32.","Thus,","the","edges31→25\nand31→17are","falsely","oriented.\nSummary:","","Local","","BN","","structure","","learning","","algorithms","","miss\nV-structures","","in","","Expand-Backtracking,","","and","","thus","","they","","en-\ncounter","","the","","false","","edge","","orientation","","problem","","when","","learning\nany","part","of","a","BN","structure.","If","we","do","not","tackle","the","missing\nV-structures","","in","","Expand-Backtracking,","","many","","edges","","may","","be\nfalsely","oriented","during","the","edge","orientation","step,","leading","to\nlow","accuracy","of","any","part","of","BN","structure","learning.\nClearly,","","to","","tackle","","the","","missing","","V-structures","","in","","Expand-\nBacktracking","when","learning","any","part","of","a","BN","structure,","we\nneed","","to","","correctly","","identify","","both","","of","","non-collider","","V-structures\nand","collider","V-structures","in","the","current","part","of","a","BN","skeleton\nat","each","iteration.\nV.","","THE","PROPOSEDAPSLANDAPSL-FSALGORITHMS\nThis","section","presents","the","proposed","any","part","of","BN","struc-\nture","learning","algorithms,","APSL","in","Section","V-A","and","APSL-\nFS","in","Section","V-B.\nA.","","APSL:","Any","Part","of","BN","Structure","Learning\nWith","","the","","analysis","","of","","missing","","V-structures","","in","","Expand-\nBacktracking","in","Section","IV,","we","present","the","proposed","APSL\n(A\nny","Part","of","BN","Structure","Learning)","algorithm,","as","described\nin","Algorithm","1.","APSL","recursively","finds","both","of","non-collider\nV-structures","","(Step","","1:","","Lines","","9-26)","","and","","collider","","V-structures\n(Step","2:","Lines","28-36)","in","MBs,","until","all","edges","in","the","part","of\na","BN","structure","around","the","target","node","are","oriented","(Step","3:\nLines","38-58).\nFig.","6.","","","Four","types","of","relationships","between","two","variables.\nAPSL","defines","an","adjacency","matrixGof","a","DAG,","to","detect\nthe","relationship","among","all","the","variables.","InG,","the","four","types\nof","the","relationship","between","any","two","variablesAandBare\nshown","in","Fig.","6,","as","follows:\n(a)AandBare","","not","","adjacent⇒G(A,B)","=","0and\nG(B,A)","=","0.\n(b)AandBare","adjacent","but","cannot","determine","their","edge\ndirection⇒G(A,B)","=","1andG(B,A)","=","1.\n(c)AandBare","adjacent","andA→B⇒G(A,B)","=−1\nandG(B,A)","=","0.\n(d)AandBare","","adjacent","","andA←B⇒G(A,B)","=","0\nandG(B,A)","=−1.\nAPSL","","first","","initializes","","the","","queried","","variable","","setVto","","an\nempty","set","and","initializes","the","queueQ,","pre-storing","the","target\nvariableT.","Then,","the","next","three","steps","will","be","repeated","until\nall","edges","in","the","part","of","a","BN","structure","aroundTto","a","depth\nofKare","","oriented,","","or","","the","","size","","ofVequals","","to","","that","","of","","the\nentire","variable","setU,","orQis","empty.\nStep","","1:","","Find","","non-collider","","V-structures(Lines","","9-26).\nAPSL","first","pops","the","first","variableAfrom","the","queueQ,","and\nthen","uses","MB","discovery","algorithms","to","find","the","MB","(i.e.,","PC\nand","","spouse)","","ofA.","","APSL","","will","","first","","find","","the","","PC","","and","","spouse\nofTsinceTis","pre-stored","inQ.","Then,","APSL","pushes","the","PC\nofAintoQto","recursively","find","the","MB","of","each","node","in","the\nPC","ofAin","the","next","iterations,","and","storesAinVto","prevent\nrepeated","learning.","Finally,","APSL","generates","undirected","edges\nby","","using","","the","","PC","","ofA(Lines","","16-20),","","and","","orients","","the","","non-\ncollider","","V-structures","","by","","using","","the","","spouses","","ofA(Lines","","21-\n26).\nAt","","Line","","13,","","the","","MB","","discovery","","algorithm,","","we","","use","","is\na","","constraint-based","","MB","","method,","","such","","as","","MMMB","","[23]","","or\nHITON-MB","[25],","because","this","type","of","MB","methods","do","not\nrequire","a","lot","of","memory.","Moreover,","these","MB","methods","can\nsave","","the","","discovered","","PCs","","to","","avoid","","repeatedly","","learning","","PC\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20207\nAlgorithm","","1:APSL\nInput:D:","Data,T:","Target,K:","a","given","depth;\nOutput:G:","a","part","of","a","BN","structure","aroundT;\n1V=∅;\n2Q={T};\n3G=zeros(|U|,|U|);\n4layer\nnum=","1;\n5layernodes(layernum)","=T;\n6i=","1;\n7repeat\n8/*Step1",":Find","non-colliderV-structures*/\n9A=Q.pop;\n10ifA∈V","then\n11continue;\n12end\n13[PC\nA\n,SP\nA\n]","=GetMB(D,A)\n14V=V∪{A};\n15Q.push(PC\nA\n);\n16foreachB∈PC\nA\ndo\n17ifG(A,B)","=","0&G(B,A)","=","0then\n18G(A,B)","=","1,G(B,A)","=","1;\n19end\n20end\n21foreachB∈PC\nA\ndo\n22foreachC∈SP\nA\n(B)do\n23G(A,B)","=−1,G(B,A)","=","0;\n24G(C,B)","=−1,G(B,C)","=","0;\n25end\n26end\n27/*Step2",":Find","collider","V-structures*/\n28foreveryX,Y∈PC\nA\ndo\n29ifX⊥⊥Y|Zfor","someZ⊆PC\nX\nthen\n30Sep\nX\n[Y]","=Z;\n31ifX6⊥⊥Y|Sep\nX\n[Y]∪{A}then\n32G(X,A)","=−1,G(A,X)","=","0;\n33G(Y,A)","=−1,G(A,Y)","=","0;\n34end\n35end\n36end\n37/*Step3",":Orient","edges*/\n38updateGby","using","Meek","rules",";\n39i=i−1;\n40ifi=","0then\n41layernum=layernum+","1;\n42foreachX∈layer\nnodes(layernum−1)do\n43layernodes(layernum)","=\nlayer\nnodes(layernum)∪PC\nX\n;\n44end\n45i=|layernodes(layernum)\\V|;\n46end\n47iflayer\nnum",">","Kthen\n48breakflag=1;\n49foreachX∈layernodes(K)do\n50ifcan","findG(PC\nX\n,X)","=","1then\n51breakflag=0;\n52break;\n53end\n54end\n55ifbreak\nflagthen\n56break;\n57end\n58end\n59until|V|=|U|,","orQ=∅;\n60ReturnG;\nsets","during","any","part","of","BN","structure","learning,","since","they","find\nspouses","from","the","PC","of","each","variable","in","the","target’s","PC.","Line\n17","","aims","","to","","prevent","","the","","already","","oriented","","edges","","from","","being\nre-initialized","as","undirected","edges.layer\nnumrepresents","the\nnumber","of","layers,","starting","from","1.","Thus,","the","number","of","layers\nis","","one","","more","","than","","the","","corresponding","","number","","of","","depths,","","for\nexample,","when","the","number","of","depths","is","2,","the","corresponding\nnumber","of","layers","is","3.layer\nnodesstores","the","nodes","of","each\nlayer.\nStep","2:","Find","collider","V-structures(Lines","28-36).","APSL\nfinds","","collider","","V-structures","","in","","the","","PC","","ofA.","","If","","two","","variables\nXandYin","the","PC","ofAare","conditionally","independent,","that\nis,","they","are","not","adjacent","owing","to","Theorem","1.","But","these","two\nvariables","are","conditionally","dependent","given","the","union","of","the\ncolliderAand","their","separating","set,","then","the","triple","of","nodes\nX,Y,","","andAcan","","form","","collider","","V-structure","","ofAowing","","to\nTheorem","2,X→A←Y.\nStep","3:","Orient","edges(Lines","38-58).","Based","on","the","oriented\nnon-collider","","V-structures","","and","","collider","","V-structures,","","APSL\nuses","","Meek-rules","","to","","orient","","the","","remaining","","undirected","","edges\n(Line","","38).","","The","","purpose","","of","","Lines","","40-46","","is","","to","","control","","the\nnumber","","of","","layers","","of","","recursion.","","Specifically,ireduced","","by","","1\nat","each","iteration,","andi=","0means","that","all","the","nodes","in","this\nlayer","have","been","traversed,","then","ASPL","begins","to","traverse","the\nnodes","at","the","next","layer","in","the","next","iterations.","From","Lines","47-\n58,","APSL","determines","whether","all","edges","in","the","part","of","a","BN\nstructure","","aroundTare","","oriented.","","When","","the","","edges","","between\nthe","layer","ofKandK+1","of","a","part","of","a","BN","structure","around\nTare","","all","","oriented,","","APSL","","terminates","","and","","outputs","","the","","part\nof","a","BN","structure","aroundT.","Some","edges","with","a","number","of\nlayers","less","thanKare","not","oriented","because","these","edges","can\nnever","be","oriented","due","to","the","existence","of","Markov","equivalence\nstructures","[30].\nTheorem","4Correctness","of","APSLUnder","the","faithfulness\nand","","correct","","independence","","tests","","assumption,","","APSL","","finds","","a\ncorrect","part","of","a","BN","structure.\nProofUnder","","the","","faithfulness","","and","","correct","","independence\ntests","assumption,","we","will","prove","the","correctness","of","APSL","in\nthree","steps.\n1)","Step","1","finds","all","and","only","the","non-collider","V-structures.\nA","","standard","","MB","","discovery","","algorithm","","finds","","all","","and","","only","","the\nPC","and","spouses","of","a","target","node.","APSL","uses","the","MB","method\nto","find","PC","and","spouses","of","the","nodes","that","need","to","be","found.\nThen,","using","the","found","PCs,","APSL","constructs","a","part","of","a","BN\nskeleton","","with","","no","","missing","","edges","","and","","no","","extra","","edges.","","Using\nthe","found","spouses,","APSL","finds","all","and","only","the","non-collider\nV-structures.\n2)","Step","2","finds","all","and","only","the","collider","V-structures.APSL\nfinds","collider","V-structures","in","PCs.","First,","APSL","uses","Theorem\n1","to","confirm","that","there","is","no","edge","between","two","nodesXand\nYin","the","PC","ofA(the","target","node","at","each","iteration).","Then,\nowing","","to","","Theorem","","2,","","if","","the","","colliderAmakesXandY\nconditionally","","dependent,X6⊥⊥Y|Sep\nX\n[Y]∪{A},","","thenX\nandYare","","each","","other’s","","spouses","","with","","the","","common","","childA,\nand","forms","a","collider","V-structureX→A←Y.","Since","APSL\nconsiders","any","two","nodes","in","the","PCs","and","their","common","child,\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20208\nFig.","7.","","(a)","An","example","of","using","APSL","to","find","a","part","of","an","Alarm","Bayesian\nnetwork","structure","around","node","10","to","a","depth","of","2;","(b)","an","example","of","using\nAPSL","to","find","a","part","of","an","Alarm","Bayesian","network","structure","around","node\n26","to","a","depth","of","2.\nThe","","red","","’X’","","symbol","","denotes","","the","","edges","","that","","local","","BN","","structure","","learning\nalgorithm","","falsely","","orients","","but","","APSL","","correctly","","orients,","","the","","blue","","node","","is","","the\ntarget","node","during","each","iteration,","the","number","in","parentheses","represents","the\nlevel","of","iterations,","and","’···’","means","omitted","iterations.\nAPSL","finds","all","and","only","the","collider","V-structures.\n3)","Step","3","finds","a","correct","part","of","a","BN","structure.Based","on\nthe","part","of","a","BN","skeleton","with","all","non-collider","V-structures\nand","collider","V-structures,","APSL","uses","Meek-rules","to","recover\nthe","part","of","a","skeleton","to","a","correct","part","of","a","structure,","some\nedges","","cannot","","be","","oriented","","due","","to","","the","","existence","","of","","Markov\nequivalence","","structures.","","Finally,","","APSL","","terminates","","when","","the\npart","of","a","structure","expands","to","a","given","depth,","and","thus","APSL\nfinds","a","correct","part","of","a","BN","structure.\u0004\nTracing","APSLTo","further","validate","that","our","algorithm","can\ntackle","missing","V-structures","in","Expand-Backtracking,","we","use\nthe","same","examples","in","Fig.","4","to","trace","the","execution","of","APSL.\nCase","1:As","shown","in","Fig.","7","(a),","APSL","finds","the","collider\nV-structure","of","10","at","the","1st","iteration,11→10←35.","Then,\nat","the","2nd","iteration,","APSL","finds","the","non-collider","V-structure\nof","11,11→12←35,","which","is","missed","by","PCD-by-PCD.\nCase","2:As","shown","in","Fig.","7","(b),","At","the","1st","iteration,","APSL\nfinds","the","collider","V-structures","of","26.","And","at","the","2nd","iteration,\nAPSL","finds","the","non-collider","V-structure","of","17,25→26←\n17,","which","is","missed","by","CMB.\nB.","","APSL-FS:","APSL","using","Feature","Selection\nIn","","this","","section,","","we","","will","","propose","","an","","efficient","","version","","of\nAPSL","by","using","feature","selection.\nAPSL","uses","a","standard","MB","discovery","algorithm,","MMMB\nor","","HITON-MB,","","for","","MB","","discovery.","","However,","","the","","standard\nPC","discovery","algorithms,","MMPC","[23]","and","HITON-PC","[25]\n(used","","by","","MMMB","","and","","HITON-MB,","","respectively),","","need","","to\nperform","","an","","exhaustive","","subset","","search","","within","","the","","currently\nselected","variables","as","conditioning","sets","for","PC","discovery,","and\nthus","they","are","computationally","expensive","or","even","prohibitive\nwhen","the","size","of","the","PC","set","of","the","target","becomes","large.\nFeature","","selection","","is","","a","","common","","dimensionality","","reduction\ntechnique","and","plays","an","essential","role","in","data","analytics","[31],\n[32],","[10].","Existing","feature","selection","methods","can","be","broadly\ncategorized","into","embedded","methods,","wrapper","methods,","and\nfilter","methods","[33].","Since","filter","feature","selection","methods","are\nfast","","and","","independent","","of","","any","","classifiers,","","they","","have","","attracted\nmore","attentions.\nIt","","has","","been","","proven","","in","","our","","previous","","work","","[34]","","that","","some\nfilter","feature","selection","methods","based","on","mutual","information\nprefer","","the","","PC","","of","","the","","target","","variable.","","Furthermore,","","these\nmethods","","use","","pairwise","","comparisons","","[35]","","(i.e.,","","unconditional\nindependence","","","tests)","","","to","","","remove","","","false","","","positives","","","with","","","less\ncorrelations,","","they","","can","","find","","the","","potential","","PC","","of","","the","","target\nvariable","","without","","searching","","for","","conditioning","","set,","","and","","thus\nimproving","the","efficiency","of","PC","discovery.\nThus,","","to","","address","","the","","problem","","exists","","in","","APSL","","for","","PC\ndiscovery,","","we","","use","","a","","filter","","feature","","selection","","method","","based\non","","mutual","","information","","instead","","of","","the","","standard","","PC","","discov-\nery","","algorithm.","","However,","","the","","feature","","selection","","method","","we\nuse","","cannot","","find","","spouses","","for","","edge","","orientations.","","Because","","the\nfeature","","selection","","method","","uses","","pairwise","","comparisons","","rather\nthan","","conditional","","independence","","tests","","[35],","","it","","cannot","","find","","the\nseparating","sets","which","is","the","key","to","finding","spouses","[6].\nStandard","PC","discovery","algorithms","find","separating","sets","to\nmake","a","target","variable","and","the","other","variables","conditionally\nindependent,","","only","","the","","variables","","in","","the","","PC","","of","","the","","target\nare","always","conditionally","dependent","on","the","target","[6].","Thus,\nstandard","PC","discovery","algorithms","find","PC","and","separating","sets\nsimultaneously.","However,","these","algorithms","are","computation-\nally","expensive","in","finding","separating","sets","since","they","need","to\nfind","","the","","separating","","sets","","of","","all","","variables","","independent","","of","","the\ntarget.","Instead,","it","is","only","necessary","to","find","the","separating","sets\nof","the","variables","in","the","PC","of","each","variable","in","the","target’s","PC\nset,","as","spouses","of","the","target","variable","exist","only","there.\nThus","in","this","subsection,","based","on","using","feature","selection\nfor","","PC","","discovery,","","we","","propose","","an","","efficient","","Markov","","blanket\ndiscovery","","algorithm","","for","","spouses","","discovery,","","called","","MB-FS\n(M\narkov","Blanket","discovery","by","Feature","Selection).","Moreover,\nwe","use","MB-FS","instead","of","the","standard","MB","discovery","algo-\nrithm","for","MB","discovery","in","APSL","to","improve","the","efficiency,\nand","we","call","this","new","any","part","of","BN","structure","learning","algo-\nrithm","APSL-FS","(APSL","using","F\neature","Selection),","an","efficient\nversion","","of","","APSL","","using","","feature","","selection.","","In","","the","","following,\nwe","will","go","into","details","about","using","feature","selection","for","PC\ndiscovery","and","MB","discovery,","respectively.\n(1)","","PC","","discovery:We","","choose","","a","","well-established","","feature\nselection","method,","Fast","Correlation-Based","Filter","(FCBF)","[35],\nfor","PC","discovery","because","the","size","of","the","PC","of","each","variable\nin","a","BN","is","not","fixed.","FCBF","specifies","a","thresholdδto","control\nthe","number","of","potential","PC","of","the","target","variable,","instead","of\nspecifying","the","number","of","the","PC","in","advance.\nAs","illustrated","in","Algorithm","2,","FCBF","first","finds","a","potential\nPC","of","the","target","variable","from","the","entire","variable","set","whose\ncorrelations","","with","","the","","target","","are","","higher","","than","","the","","threshold\n(Lines","","1-6).","","Then,","","FCBF","","uses","","pairwise","","comparisons","","to\nremove","","false","","positives","","in","","the","","potential","","PC","","to","","get","","the","","true\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","20209\nAlgorithm","","2:FCBF\nInput:D:","Data,T:","Target,δ:","Threshold;\nOutput:","PC\nT\n:","PC","ofT;\n1S=∅;\n2foreachX∈U\\{T}do\n3ifSU(X;T)>","δthen\n4S=S∪X;\n5end\n6end\n7OrderSin","descendingSU(X;T)value;\n8i=","1;\n9whilei","<=|S|do\n10j=i+","1;\n11whilej","<=|S|do\n12ifSU(S(i);S(j))>","SU(S(j);T)then\n13S(j)","=∅;\n14else\n15j=j+","1;\n16end\n17end\n18i=i+","1;\n19end\n20PC\nT\n=S;\n21ReturnPC\nT\n;\nAlgorithm","","3:MB-FS\nInput:D:","Data,T:","Target,δ:","Threshold;\nOutput:[PC\nT\n,SP\nT\n]:","MB","ofT;\n1PC\nT\n=","FCBF(D,T,δ);\n2foreachX∈PC\nT\ndo\n3PC\nX\n=","FCBF(D,X,δ);\n4foreachY∈PC\nX\ndo\n5ifT⊥⊥Y|Zfor","someZ⊆PC\nT\nthen\n6Sep\nT\n[Y]","=Z;\n7ifT6⊥⊥Y|Sep\nT\n[Y]∪{X}then\n8SP\nT\n(X)","=SP\nT\n(X)∪{Y};\n9end\n10end\n11end\n12end\n13Return","[PC\nT\n,SP\nT\n];\nPC","(Lines","7-20).\n(2)","MB","discovery:As","illustrated","in","Algorithm","3,","MB-FS\nfirst","","uses","","FCBF","","to","","find","","the","","PC","","of","","the","","target","","variableT,\nand","","uses","","FCBF","","to","","find","","the","","PC","","of","","each","","variable","","in","","theT’s\nPC","","as","","the","","candidate","","spouses","","ofT.","","Then,","","MB-FS","","finds","","the\nseparating","set","from","the","subsets","of","the","PC","ofT,","to","makeT\nand","the","variableYin","the","candidate","spouses","are","conditionally\nindependent.","Finally,","ifTandYare","conditionally","dependent\ngiven","the","union","of","the","separating","set","and","their","common","child\nX,Yis","a","spouse","ofTowing","to","Theorem","2.\nVI.","","EXPERIMENTS\nIn","","this","","section,","","we","","will","","systematically","","evaluate","","our","","pre-\nsented","","algorithms.","","In","","Section","","VI-A,","","we","","describe","","the","","data\nsets,","","comparison","","methods,","","and","","evaluation","","metrics","","in","","the\nexperiments.","","Then","","in","","Section","","VI-B","","and","","VI-C,","","we","","evaluate\nour","","algorithms","","with","","local","","BN","","structure","","learning","","algorithms\nand","global","BN","structure","learning","algorithms,","respectively.\nTABLE","II\nSUMMARY","OF","BENCHMARKBNS\nNum.Num.Max","In/out-Min/Max\nNetworkVarsEdgesDegree|PCset|\nChild20252/71/8\nInsurance27523/71/9\nAlarm37464/51/6\nChild102002572/71/8\nInsurance102705565/81/11\nAlarm103705704/71/9\nA.","","Experiment","setting\nTo","","evaluate","","the","","APSL","","and","","APSL-FS","","algorithms,","","we","","use\ntwo","groups","of","data","generated","from","the","six","benchmark","BNs\nas","shown","in","Table","II\n2\n.","One","group","includes","10","data","sets","each\nwith","","500","","data","","instances,","","and","","the","","other","","group","","also","","contains\n10","data","sets","each","with","1,000","data","instances.\nWe","","compare","","the","","APSL","","and","","APSL-FS","","algorithms","","with","","7\nother","","algorithms,","","including","","2","","local","","BN","","structure","","learning\nalgorithms,","PCD-by-PCD","[21]","and","CMB","[22],","and","5","global\nBN","","structure","","learning","","algorithms,","","GS","","[12],","","MMHC","","[13],\nSLL+C","[26],","SLL+G","[26],","and","GGSL","[19].\nThe","","implementation","","details","","and","","parameter","","settings","","of","","all\nthe","algorithms","are","as","follows:\n1)","","PCD-by-PCD,","CMB,","GS,","MMHC\n3\n,","APSL,","and","APSL-\nFS","","are","","implemented","","in","","MATLAB,","","SLL+C/G\n4\nand\nGGSL","are","implemented","in","C++.\n2)","","The","","conditional","","independence","","tests","","areG\n2\ntests","","with\nthe","statistical","significance","level","of","0.01,","the","constrained\nMB","","algorithm","","used","","by","","APSL","","is","","HITON-MB","","[25],\nand","","the","","threshold","","of","","the","","feature","","selection","","method\nFCBF","[35]","used","by","APSL-FS","is","0.05.\n3)","","In","","all","","Tables","","in","","Section","","VI,","","the","","experimental","","results\nare","shown","in","the","format","ofA±B,","whereArepresents\nthe","","average","","results,","","andBis","","the","","standard","","deviation.\nThe","best","results","are","highlighted","in","boldface.\n4)","","All","experiments","are","conducted","on","a","computer","with","an\nIntel","Core","i7-8700","3.20","GHz","with","8GB","RAM.\nUsing","the","BN","data","sets,","we","evaluate","the","algorithms","using\nthe","following","metrics:\n•Accuracy.","","We","","evaluate","","the","","accuracy","","of","","the","","learned\nstructureusingAr\nPrecision,ArRecall,and\nArDistance.TheArPrecisionmetricdenotes\nthe","","","number","","","of","","","correctly","","","predicted","","","edges","","","in","","","the\noutput","","","","divided","","","","by","","","","the","","","","number","","","","of","","","","true","","","","edges\ninatestDAG,whiletheAr\nRecallmetric\nrepresentsthenumberofcorrectlypredicted\nedges","","","in","","","the","","","output","","","divided","","","by","","","the","","","number","","","of\npredicted","","edges","","in","","the","","output","","of","","an","","algorithm.","","The\n2\nThe","","public","","data","","sets","","are","","available","","athttp://pages.mtu.edu/∼\nlebrown/supplements/mmhc\npaper/mmhcindex.html.\n3\nThe","","","codes","","","of","","","MMHC","","","in","","","MATLAB","","","are","","","available","","","athttp:\n//mensxmachina.org/en/sof","tware/probabilistic−graphical−\nmodel−toolbox/.\n4\nThe","","codes","","of","","SLL+C","","and","","SLL+G","","in","","C++","","are","","available","","athttps:\n//www.cs.helsinki.f","i/u/tzniinim/uai2012/.\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","202010\nTABLE","III\nARDISTANCE,","ARPRECISION,","ARRECALL,ANDRUNTIME(IN","SECONDS)ON","LEARNING","A","PART","OFBNSTRUCTURES","TO","A","DEPTH","","OF1USING\nDIFFERENT","DATA","SIZES(A±B:AREPRESENTS","THE","AVERAGE","RESULTS","WHILEBIS","THE","STANDARD","","DEVIATION.","THE","BEST","RESULTS","ARE\nHIGHLIGHTED","IN","","BOLDFACE.)\nSize=500Size=1,000\nNetworkAlgorithmArDistanceArPrecisionArRecallRuntimeArDistanceArPrecisionArRecallRuntime\nChild\nPCD-by-PCD\n0.57±0.550.66±0.420.56±0.390.17±0.080.46±0.470.69±0.350.67±0.340.25±0.14\nCMB0.54±0.520.61±0.380.65±0.390.63±0.240.39±0.500.73±0.360.73±0.360.67±0.38\nAPSL0.63±0.480.55±0.340.57±0.370.12±0.060.45±0.500.70±0.360.68±0.360.18±0.06\nASPL-FS0.37±0.460.80±0.320.70±0.350.03±0.020.37±0.460.83±0.320.70±0.350.03±0.03\nInsurance\nPCD-by-PCD\n0.90±0.380.45±0.350.33±0.280.16±0.150.70±0.460.64±0.380.43±0.320.23±0.20\nCMB0.81±0.440.49±0.360.40±0.330.36±0.220.77±0.430.52±0.340.42±0.310.56±0.37\nAPSL0.83±0.380.48±0.340.38±0.250.10±0.090.51±0.360.76±0.300.59±0.270.14±0.10\nASPL-FS0.66±0.500.67±0.430.48±0.330.05±0.060.85±0.480.49±0.420.36±0.320.07±0.06\nAlarm\nPCD-by-PCD0.61±0.570.60±0.420.56±0.410.21±0.220.50±0.550.69±0.400.63±0.400.29±0.27\nCMB0.65±0.590.58±0.440.53±0.420.32±0.330.58±0.580.62±0.420.58±0.410.24±0.19\nAPSL0.53±0.570.66±0.420.63±0.400.17±0.160.41±0.490.75±0.360.70±0.360.23±0.20\nASPL-FS0.61±0.550.61±0.410.55±0.400.07±0.090.51±0.550.69±0.410.62±0.390.07±0.09\nChild10\nPCD-by-PCD0.91±0.490.38±0.380.35±0.352.03±3.290.73±0.550.51±0.410.48±0.402.46±3.73\nCMB0.60±0.470.60±0.360.60±0.362.41±2.610.55±0.490.62±0.360.63±0.361.98±2.06\nAPSL0.68±0.490.52±0.370.56±0.380.83±1.620.48±0.450.66±0.330.69±0.341.05±2.16\nASPL-FS0.53±0.530.70±0.400.59±0.380.08±0.060.47±0.520.75±0.390.63±0.370.15±0.11\nInsurance10\nPCD-by-PCD0.85±0.410.45±0.330.38±0.311.33±4.150.72±0.430.58±0.360.44±0.301.22±3.93\nCMB0.82±0.390.46±0.310.42±0.311.49±1.300.68±0.410.57±0.330.50±0.312.06±1.84\nAPSL0.71±0.380.54±0.310.50±0.300.50±1.230.54±0.400.67±0.310.61±0.310.84±2.56\nASPL-FS0.71±0.400.66±0.370.42±0.291.09±1.860.60±0.400.79±0.350.48±0.300.34±0.32\nAlarm10\nPCD-by-PCD\n0.83±0.510.50±0.430.38±0.365.55±9.420.72±0.530.59±0.420.45±0.374.91±9.64\nCMB\n0.81±0.530.47±0.420.42±0.391.42±1.480.70±0.550.57±0.420.49±0.400.92±0.87\nAPSL\n0.70±0.480.56±0.390.49±0.363.16±6.210.55±0.480.69±0.370.59±0.365.19±8.97\nASPL-FS0.68±0.480.61±0.390.49±0.350.82±1.860.65±0.510.65±0.410.49±0.361.48±2.64\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(a)","Rank","of","Ar_Distance\nPCD−by−PCD\nCMB\nAPSL\nAPSL−FS\nCD\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(b)","Rank","of","Time\nCMB\nPCD−by−PCD\nAPSL\nAPSL−FS\nCD\nFig.","8.","","","Crucial","difference","diagram","of","the","Nemenyi","test","of","ArDistance","and","Runtime","on","learning","a","part","of","BN","structures","(Depth=1).\nArDistance","","","metric","","","is","","","the","","","harmonic","","","average","","","of\nthe","","","Ar\nPrecision","","","and","","","ArRecall,ArDistance","","=\n√\n(1−ArPrecision)\n2\n+","(1−Ar\nRecall)\n2\n,where\nthe","lower","Ar\nDistance","is","better.\n•Efficiency.","We","report","running","time","(in","seconds)","as","the\nefficiency","measure","of","different","algorithms.","The","running\ntime","of","feature","selection","is","included","in","the","total","running\ntime","of","our","method.\nB.","","Comparison","of","our","methods","with","local","methods\nIn","this","subsection,","using","six","BNs,","we","compare","our","meth-\nods","","with","","the","","local","","methods","","on","","learning","","a","","part","","of","","a","","BN\nstructure","","around","","each","","node","","to","","a","","depth","","of","","1,","","Tables","","III\nsummarizes","the","detailed","results.\nIn","","efficiency.","","PCD-by-PCD","","uses","","symmetry","","constraint","","to\ngenerate","","undirected","","edges,","","then","","it","","finds","","more","","PCs","","than\nAPSL,","","and","","thus","","it","","is","","slower","","than","","APSL.","","CMB","","spends\ntime","","tracking","","conditional","","independence","","changes","","after","","MB\ndiscovery,","so","it","is","inferior","to","APSL","in","efficiency.","APSL-FS\ndoes","not","need","to","perform","an","exhaustive","subset","search","within\nconditioning","","sets","","for","","PC","","discovery,","","then","","it","","is","","much","","faster\nthan","APSL.\nIn","","accuracy.","","The","","symmetry","","constraint","","used","","by","","PCD-\nby-PCD","","may","","remove","","more","","true","","nodes,","","leading","","to","","a","","low\naccuracy","","of","","PCD-by-PCD.","","CMB","","uses","","entire","","MB","","set","","as\nthe","","conditioning","","set","","for","","tracking","","conditional","","independence\nchanges,","so","it","is","also","inferior","to","APSL","in","accuracy.","APSL-FS\ndoes","not","use","conditioning","set","for","independence","tests,","then","it\nreduces","the","requirement","of","data","samples,","and","more","accurate\nthan","APSL","on","samll-sized","sample","data","sets.\nTo","","further","","evaluate","","the","","accuracy","","and","","efficiency","","of","","our\nmethods","","against","","local","","methods,","","we","","conduct","","the","","Friedman\ntest","","at","","a","","5%","","significance","","level","","under","","the","","null","","hypothesis,\nwhich","","states","","that","","whether","","the","","accuracy","","and","","efficiency","","of\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","202011\n123456\n0.4\n0.6\n0.8\n1\n1.2\n1.4\nNetwork\n(a)","Ar_Distance,","Size=500\nAr_Distance\n123456\n0\n10\n20\n30\n40\n50\nNetwork\n(b)","Runtime,","Size=500\nRuntime\n","\n","\nGS\nMMHC\nSLL+C\nSLL+G\nGGSL\nAPSL\nAPSL−FS\n123456\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\n1\n1.1\nNetwork\n(c)","Ar_Distance,","Size=1,000\nAr_Distance\n123456\n0\n10\n20\n30\n40\n50\n60\nNetwork\n(d)","Runtime,","Size=1,000\nRuntime\n","\n","\nGS\nMMHC\nSLL+C\nSLL+G\nGGSL\nAPSL\nAPSL−FS\nFig.","9.","","","The","experimental","results","of","learning","a","part","of","BN","structures","to","a","depth","of","3","using","different","data","sizes","(the","labels","of","the","x-axis","from","1","to","6","denote\nthe","BNs.","1:","Child.","2:","Insurance.","3:","Alarm.","4:","Child10.","5:","Insurance10.","6:","Alarm10,","and","all","figures","use","the","same","legend).\n123456\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n1.4\n1.6\nNetwork\n(a)","Ar_Distance,","Size=500\nAr_Distance\n123456\n0\n10\n20\n30\n40\n50\nNetwork\n(b)","Runtime,","Size=500\nRuntime\n","\n","\nGS\nMMHC\nSLL+C\nSLL+G\nGGSL\nAPSL\nAPSL−FS\n123456\n0.2\n0.4\n0.6\n0.8\n1\n1.2\nNetwork\n(c)","Ar_Distance,","Size=1,000\nAr_Distance\n123456\n0\n10\n20\n30\n40\n50\nNetwork\n(d)","Runtime,","Size=1,000\nRuntime\n","\n","\nGS\nMMHC\nSLL+C\nSLL+G\nGGSL\nAPSL\nAPSL−FS\nFig.","10.","","","The","experimental","results","of","learning","a","part","of","BN","structures","to","a","depth","of","5","using","different","data","sizes","(the","labels","of","the","x-axis","from","1","to","6","are\nthe","same","as","those","in","Fig.","10,","and","all","figures","use","the","same","legend).\n123456\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n1.4\n1.6\nNetwork\n(a)","Ar_Distance,","Size=500\nAr_Distance\n123456\n0\n10\n20\n30\n40\n50\nNetwork\n(b)","Runtime,","Size=500\nRuntime\n","\n","\nGS\nMMHC\nSLL+C\nSLL+G\nGGSL\nAPSL\nAPSL−FS\n123456\n0.2\n0.4\n0.6\n0.8\n1\n1.2\nNetwork\n(c)","Ar_Distance,","Size=1,000\nAr_Distance\n123456\n0\n10\n20\n30\n40\n50\nNetwork\n(d)","Runtime,","Size=1,000\nRuntime\n","\n","\nGS\nMMHC\nSLL+C\nSLL+G\nGGSL\nAPSL\nAPSL−FS\nFig.","11.","","","The","experimental","results","of","learning","a","part","of","BN","structures","to","a","depth","of","the","maximum","depth","using","different","data","sizes","(the","labels","of","the","x-axis\nfrom","1","to","6","are","the","same","as","those","in","Fig.","10,","and","all","figures","use","the","same","legend).\nAPSL","","and","","APSL-FS","","and","","that","","of","","PCD-by-PCD","","and","","CMB\nhave","","no","","significant","","difference.","","Both","","of","","the","","null","","hypotheses\nof","ArDistance","and","Runtime","are","rejected,","the","average","ranks\nof","ArDistance","for","PCD-by-PCD,","CMB,","APSL,","and","APSL-\nFS","","are","","1.54,","","2.17,","","3.04,","","and","","3.25,","","respectively","","(the","","higher\nthe","","average","","rank,","","the","","better","","the","","performance","","in","","accuracy),\nand","the","average","ranks","of","Runtime","for","PCD-by-PCD,","CMB,\nAPSL,","and","APSL-FS","are","1.75,","1.58,","2.83,","3.83,","respectively\n(the","","higher","","the","","average","","rank,","","the","","better","","the","","performance","","in\nefficiency).\nThen,","","we","","proceed","","with","","the","","Nemenyi","","test","","as","","a","","posthoc\ntest.","With","the","Nemenyi","test,","the","performance","of","two","methods\nis","significantly","different","if","the","corresponding","average","ranks\ndiffer","","by","","at","","least","","the","","critical","","difference.","","With","","the","","Nemenyi\ntest,","","both","","of","","the","","critical","","differences","","of","","Ar\nDistance","","and\nRuntime","are","up","to","1.35.","Thus,","we","can","observe","that","APSL-FS\nis","significantly","more","accurate","than","PCD-by-PCD,","and","APSL-\nFS","is","significantly","more","efficient","than","both","of","PCD-by-PCD\nCMB","on","learning","a","part","of","a","BN","structure","to","a","depth","of","1.\nWe","plot","the","crucial","difference","diagram","of","the","Nemenyi","test\nin","Fig.","8.\nTABLE","IV\nFIVE","NODES","WITH","THE","LARGESTPCSET","ON","EACHBN\nNetworkSelected","five","nodes\nChild2,","6,","7,","9,","11\nInsurance2,","3,","4,","5,","8\nAlarm13,","14,","21,","22,","29\nChild1012,","52,","92,","132,","172\nInsurance10164,","166,","191,","193,","245\nAlarm1013,","23,","66,","103,","140\nC.","","Comparison","of","our","methods","with","global","methods\nIn","","this","","subsection,","","we","","compare","","our","","methods","","with","","the\nglobal","","methods","","on","","learning","","a","","part","","of","","a","","BN","","structure","","to","","a\ndepth","of","3,","5,","and","the","maximum","depth,","respectively.\nIn","","Fig.","","9-11,","","we","","plot","","the","","results","","of","","Ar\nDistance","","and\nRuntime","of","APSL","and","APSL-FS","against","global","methods","on\nlearning","","part","","of","","BN","","structures","","around","","the","","five","","nodes","","with\nthe","","largest","","PC","","set","","on","","each","","BN","","to","","a","","depth","","of","","3,","","5,","","and","","the\nmaximum,","respectively.","The","selected","five","nodes","of","each","BN\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","202012\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(a)","Rank","of","Ar_Distance\nGS\nAPSL\nAPSL−FS\nMMHC\nCD\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(b)","Rank","of","Time\nMMHC\nGS\nAPSL\nAPSL−FS\nCD\nFig.","12.","","","Crucial","difference","diagram","of","the","Nemenyi","test","of","ArDistance","and","Runtime","on","learning","a","part","of","BN","structures","(Depth=3).\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(a)","Rank","of","Ar_Distance\nGS\nAPSL\nAPSL−FS\nMMHC\nCD\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(b)","Rank","of","Time\nMMHC\nGS\nAPSL\nAPSL−FS\nCD\nFig.","13.","","","Crucial","difference","diagram","of","the","Nemenyi","test","of","ArDistance","and","Runtime","on","learning","a","part","of","BN","structures","(Depth=5).\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(a)","Rank","of","Ar_Distance\nGS\nAPSL\nAPSL−FS\nMMHC\nCD\n11.522.533.54\n0\n1\n2\n3\n4\n5\n(b)","Rank","of","Time\nMMHC\nGS\nAPSL\nAPSL−FS\nCD\nFig.","14.","","","Crucial","difference","diagram","of","the","Nemenyi","test","of","ArDistance","and","Runtime","on","learning","a","part","of","BN","structures","(Depth=max).\nare","","shown","","in","","Table","","IV.","","Since","","SLL+C,","","SLL+G,","","and","","GGSL\ncannot","generate","any","results","onChild10,Insurance10,","and\nAlarm10due","to","memory","limitation,","we","only","plot","the","results\nof","them","onChild,Insurance,","andAlarm.\nIn","","efficiency.","","When","","learning","","a","","part","","of","","BN","","structures","","to\ndepths","","of","","3","","and","","5,","","since","","APSL","","and","","APSL-FS","","do","","not","","need\nto","","find","","the","","entire","","structures,","","they","","are","","faster","","than","","the","","global\nBN","","structure","","learning","","algorithms.","","When","","learning","","a","","part","","of\nBN","","structures","","to","","a","","depth","","of","","the","","maximum","","depth,","","both","","of\nour","","methods","","and","","global","","methods","","need","","to","","find","","the","","entire\nstructure.","However,1)Although","GS","uses","GSMB,","an","efficient\nMB","discovery","algorithm","without","searching","for","conditioning\nset,","","to","","find","","MB","","of","","each","","node,","","it","","still","","takes","","extra","","time","","to\nsearch","for","conditioning","set","during","V-structure","discovery.","So\nGS","","is","","slightly","","inferior","","to","","APSL","","in","","efficiency.2)May","","be\nusing","","conditional","","independence","","tests","","is","","faster","","than","","using\nscore","functions","for","edge","orientations,","then","MMHC","is","slower\nthan","APSL.3)As","for","SLL+C,","SLL+G,","and","GGSL,","the","score-\nbased","","MB/PC","","methods","","used","","by","","them","","need","","to","","learn","","a","","local\nBN","","structure","","involving","","all","","nodes","","selected","","currently","","at","","each\niteration,","","so","","they","","are","","time-consuming","","on","","small-sized","","BNs,\nand","","infeasible","","on","","large-sized","","BNs.4)Clearly,","","APSL-FS","","is\nmore","efficient","than","APSL.\nIn","","accuracy.","","When","","learning","","a","","part","","of","","BN","","structures","","to\ndepths","of","3","and","5,","since","global","methods","consider","the","global\ninformation","","of","","the","","structures,","","the","","accuracy","","of","","our","","methods\nis","","lower","","that","","of","","global","","methods","","except","","for","","GS.","","Because\nthe","","GSMB","","(used","","by","","GS)","","require","","a","","large","","number","","of","","data\nsamples,","","and","","its","","heuristic","","function","","also","","leads","","to","","a","","low","","MB\ndiscovery","","accuracy.","","When","","learning","","a","","part","","of","","BN","","structures\nto","a","depth","of","the","maximum","depth,1)since","the","same","reason\nof","","GS","","when","","learning","","to","","a","","depth","","of","","3","","and","","5,","","GS","","is","","inferior\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","202013\nto","our","methods","in","accuracy.2)MMHC","uses","score","functions\nfor","edge","orientations,","it","can","also","remove","false","edges","in","the\nlearned","","skeleton,","","while","","APSL","","can","","only","","orient","","edges","","in","","the\nlearned","skeleton","using","conditional","independence","tests,","then\nMMHC","","is","","more","","accurate","","than","","APSL.3)As","","for","","SLL+C,\nSLL+G,","","and","","GGSL,","","since","","they","","involve","","all","","nodes","","selected\ncurrently","","at","","each","","iteration,","","they","","are","","slightly","","more","","accurate\nthan","other","methods","on","small-sized","BNs,","but","cannot","generate\nany","","results","","on","","large-sized","","BNs.4)Similarly,","","APSL-FS","","is\nmore","accurate","than","APSL.\nTo","","further","","evaluate","","the","","accuracy","","and","","efficiency","","of","","our\nmethods","","against","","global","","methods,","","we","","conduct","","the","","Friedman\ntest","","at","","a","","5%","","significance","","level","","under","","the","","null","","hypothesis.\nSince","","SLL+C,","","SLL+G,","","and","","GGSL","","fail","","on","","the","","large-sized\nBN","","data","","sets,","","we","","do","","not","","compare","","our","","methods","","with","","them\nusing","the","Friedman","test.\n1)","Depth=3.","Both","of","the","null","hypotheses","of","Ar\nDistance\nand","Runtime","are","rejected,","the","average","ranks","of","Ar\nDistance\nfor","GS,","MMHC,","APSL,","and","APSL-FS","are","1.08,","3.42,","2.71,\nand","2.79,","respectively,","and","the","average","ranks","of","Runtime","for\nGS,","MMHC,","APSL,","and","APSL-FS","are","2.08,","1.08,","2.83,","and\n4.00,","respectively.","Then,","With","the","Nemenyi","test,","both","of","the\ncritical","","differences","","of","","Ar\nDistance","","and","","Runtime","","are","","up","","to\n1.35.","","Thus,","","we","","can","","observe","","that","","APSL","","and","","APSL-FS","","are\nsignificantly","","more","","accurate","","than","","GS","","and","","significantly","","more\nefficient","","than","","MMHC,","","and","","APSL-FS","","is","","significantly","","more\nefficient","","than","","GS","","on","","learning","","a","","part","","of","","a","","BN","","structure","","to","","a\ndepth","","of","","3.","","We","","plot","","the","","crucial","","difference","","diagram","","of","","the\nNemenyi","test","in","Fig.","12.\n2)","Depth=5.","Similar","to","the","results","in","Depth=3,","the","average\nranks","of","Ar\nDistance","for","GS,","MMHC,","APSL,","and","APSL-FS\nare","1.08,","3.46,","2.50,","and","2.96,","respectively,","and","the","average\nranks","","of","","Runtime","","for","","GS,","","MMHC,","","APSL,","","and","","APSL-FS\nare","2.25,","1.08,","2.67,","and","4.00,","respectively.","With","the","critical\ndifferences","","of","","ArDistance","","and","","Runtime","","are","","up","","to","","1.35,\nwe","","can","","observe","","that","","APSL","","and","","APSL-FS","","are","","significantly\nmore","accurate","than","GS","and","significantly","more","efficient","than\nMMHC,","","and","","APSL-FS","","is","","significantly","","more","","efficient","","than\nGS","on","learning","a","part","of","a","BN","structure","to","a","depth","of","5.","We\nplot","","the","","crucial","","difference","","diagram","","of","","the","","Nemenyi","","test","","in\nFig.","13.\n3)Depth=max.Similarly,theaverageranksof\nAr\nDistance","","","for","","","GS,","","","MMHC,","","","APSL,","","","and","","","APSL-FS\nare","1.04,","3.13,","2.92,","and","2.92,","respectively,","and","the","average\nranks","","of","","Runtime","","for","","GS,","","MMHC,","","APSL,","","and","","APSL-FS\nare","2.38,","1.08,","2.54,","and","4.00,","respectively.","With","the","critical\ndifferences","","of","","Ar\nDistance","","and","","Runtime","","are","","up","","to","","1.35,\nwe","","can","","observe","","that","","APSL","","and","","APSL-FS","","are","","significantly\nmore","accurate","than","GS","and","significantly","more","efficient","than\nMMHC,","","and","","APSL-FS","","is","","significantly","","more","","efficient","","than\nGS","","on","","learning","","a","","part","","of","","a","","BN","","structure","","to","","a","","depth","","of","","the\nmaximum.","","We","","plot","","the","","crucial","","difference","","diagram","","of","","the\nNemenyi","test","in","Fig.","14.\nVII.","","CONCLUSION\nIn","","this","","paper,","","we","","present","","a","","new","","concept","","of","","Expand-\nBacktracking","to","describe","the","learning","process","of","the","exsiting\nlocal","BN","structure","learning","algorithms,","and","analyze","the","miss-\ning","V-structures","in","Expand-Backtracking.","Then","we","propose\nan","","efficient","","and","","accurate","","any","","part","","of","","BN","","structure","","learning\nalgorithm,","","APSL.","","APSL","","learns","","a","","part","","of","","a","","BN","","structure\naround","","any","","one","","node","","to","","any","","depth,","","and","","tackles","","missing\nV-structures","","in","","Expand-Backtracking","","by","","finding","","both","","of\ncollider","","V-structures","","and","","non-collider","","V-structures","","in","","MBs\nat","each","iteration.","In","addition,","we","design","an","any","part","of","BN\nstructure","learning","algorithm","using","feature","selection,","APSL-\nFS,","to","improve","the","efficiency","of","APSL","by","finding","PC","without\nsearching","for","conditioning","sets.\nThe","","extensive","","experimental","","results","","have","","shown","","that","","our\nalgorithms","","achieve","","higher","","efficiency","","and","","better","","accuracy\nthan","","state-of-the-art","","local","","BN","","structure","","learning","","algorithms\non","","learning","","any","","part","","of","","a","","BN","","structure","","to","","a","","depth","","of","","1,\nand","achieve","higher","efficiency","than","state-of-the-art","global","BN\nstructure","","learning","","algorithms","","on","","learning","","any","","part","","of","","a","","BN\nstructure","to","a","depth","of","3,","5,","and","the","maximum","depth.\nFuture","","research","","direction","","could","","focus","","on","","using","","mutual\ninformation-based","feature","selection","methods","for","V-structure\ndiscovery","","without","","searching","","for","","conditioning","","sets,","","because\nperforming","an","exhaustive","subset","search","within","PC","for","finding\nV-structures","is","time-consuming.\nREFERENCES\n[1]","","J.","","Pearl,","","“Morgan","","kaufmann","","series","","in","","representation","","and","","reasoning,”\nProbabilistic","","reasoning","","in","","intelligent","","systems:","","Networks","","of","","plausible\ninference.","San","Mateo,","CA,","US:","Morgan","Kaufmann,","1988.\n[2]","","G.","","F.","","Cooper,","","“A","","simple","","constraint-based","","algorithm","","for","","efficiently\nmining","observational","databases","for","causal","relationships,”Data","Mining\nand","Knowledge","Discovery,","vol.","1,","no.","2,","pp.","203–224,","1997.\n[3]","","I.","","Guyon,","","C.","","Aliferiset","","al.,","","“Causal","","feature","","selection,”","","inComputa-\ntional","methods","of","feature","selection.","","","","Chapman","and","Hall/CRC,","2007,\npp.","75–97.\n[4]","","C.","","F.","","Aliferis,","","A.","","Statnikov,","","I.","","Tsamardinos,","","S.","","Mani,","","and","","X.","","D.\nKoutsoukos,","","“Local","","causal","","and","","markov","","blanket","","induction","","for","","causal\ndiscovery","and","feature","selection","for","classification","part","ii:","Analysis","and\nextensions,”Journal","of","Machine","Learning","Research,","vol.","11,","no.","Jan,\npp.","235–284,","2010.\n[5]","","I.","Tsamardinos","and","C.","F.","Aliferis,","“Towards","principled","feature","selec-\ntion:","relevancy,","filters","and","wrappers.”","inAISTATS,","2003.\n[6]","","C.","","F.","","Aliferis,","","A.","","Statnikov,","","I.","","Tsamardinos,","","S.","","Mani,","","and","","X.","","D.\nKoutsoukos,","","“Local","","causal","","and","","markov","","blanket","","induction","","for","","causal\ndiscovery","","and","","feature","","selection","","for","","classification","","part","","i:","","Algorithms\nand","","empirical","","evaluation,”Journal","","of","","Machine","","Learning","","Research,\nvol.","11,","no.","Jan,","pp.","171–234,","2010.\n[7]","","Z.","","Ling,","","K.","","Yu,","","H.","","Wang,","","L.","","Liu,","","W.","","Ding,","","and","","X.","","Wu,","","“Bamb:","","A\nbalanced","","markov","","blanket","","discovery","","approach","","to","","feature","","selection,”\nACM","","Transactions","","on","","Intelligent","","Systems","","and","","Technology","","(TIST),\nvol.","10,","no.","5,","pp.","1–25,","2019.\n[8]","","H.","Wang,","Z.","Ling,","K.","Yu,","and","X.","Wu,","“Towards","efficient","and","effective\ndiscovery","","of","","markov","","blankets","","for","","feature","","selection,”Information\nSciences,","vol.","509,","pp.","227–242,","2020.\n[9]","","P.","","Spirtes,","","C.","","N.","","Glymour,","","and","","R.","","Scheines,Causation,","","prediction,\nand","search.","","","","MIT","press,","2000.\n[10]","","K.","","Yu,","","L.","","Liu,","","J.","","Li,","","W.","","Ding,","","and","","T.","","Le,","","“Multi-source","","causal\nfeature","selection,”IEEE","transactions","on","pattern","analysis","and","machine\nintelligence,","vol.","DOI:","10.1109/TPAMI.2019.2908373,","2019.\n[11]","","S.","","Andreassen,","","A.","","Rosenfalck,","","B.","","Falck,","","K.","","G.","","Olesen,","","and","","S.","","K.\nAndersen,","","“Evaluation","","of","","the","","diagnostic","","performance","","of","","the","","expert\nemg","","assistant","","munin,”Electroencephalography","","and","","Clinical","","Neuro-\nphysiology/Electromyography","and","Motor","Control,","vol.","101,","no.","2,","pp.\n129–144,","1996.\n[12]","","D.","","Margaritis","","and","","S.","","Thrun,","","“Bayesian","","network","","induction","","via","","local\nneighborhoods,”","","inAdvances","","in","","neural","","information","","processing","","sys-\ntems,","2000,","pp.","505–511.\n\nIEEE","TRANSACTIONS","ON","CYBERNETICS,","VOL.","14,","NO.","8,","AUGUST","202014\n[13]","","I.","Tsamardinos,","L.","E.","Brown,","and","C.","F.","Aliferis,","“The","max-min","hill-\nclimbing","","bayesian","","network","","structure","","learning","","algorithm,”Machine\nlearning,","vol.","65,","no.","1,","pp.","31–78,","2006.\n[14]","","J.-P.","","Pellet","","and","","A.","","Elisseeff,","","“Using","","markov","","blankets","","for","","causal\nstructure","","learning,”Journal","","of","","Machine","","Learning","","Research,","","vol.","","9,\nno.","Jul,","pp.","1295–1342,","2008.\n[15]","","J.","","Pearl,","","“Fusion,","","propagation,","","and","","structuring","","in","","belief","","networks,”\nArtificial","intelligence,","vol.","29,","no.","3,","pp.","241–288,","1986.\n[16]","","D.","M.","Chickering,","D.","Heckerman,","and","C.","Meek,","“Large-sample","learn-\ning","","of","","bayesian","","networks","","is","","np-hard,”Journal","","of","","Machine","","Learning\nResearch,","vol.","5,","no.","Oct,","pp.","1287–1330,","2004.\n[17]","","M.","","Scanagatta,","","","G.","","Corani,","","","C.","","P.","","","de","","Campos,","","and","","","M.","","Zaffalon,\n“Learning","","treewidth-bounded","","bayesian","","networks","","with","","thousands","","of\nvariables,”","","inAdvances","","in","","neural","","information","","processing","","systems,\n2016,","pp.","1462–1470.\n[18]","","D.","Vidaurre,","C.","Bielza,","and","P.","Larra\n","̃\nnaga,","“Learning","an","l1-regularized\ngaussian","","bayesian","","network","","in","","the","","equivalence","","class","","space,”IEEE\nTransactions","on","Systems,","Man,","and","Cybernetics,","Part","B","(Cybernetics),\nvol.","40,","no.","5,","pp.","1231–1242,","2010.\n[19]","","T.","","Gao,","","K.","","Fadnis,","","and","","M.","","Campbell,","","“Local-to-global","","bayesian\nnetwork","structure","learning,”","inInternational","Conference","on","Machine\nLearning,","2017,","pp.","1193–1202.\n[20]","","T.","","Gao","","and","","Q.","","Ji,","","“Efficient","","score-based","","markov","","blanket","","discovery,”\nInternational","","Journal","","of","","Approximate","","Reasoning,","","vol.","","80,","","pp.","","277–\n293,","2017.\n[21]","","J.","","Yin,","","Y.","","Zhou,","","C.","","Wang,","","P.","","He,","","C.","","Zheng,","","and","","Z.","","Geng,","","“Partial\norientation","","and","","local","","structural","","learning","","of","","causal","","networks","","for","","pre-\ndiction,”","inCausation","and","Prediction","Challenge,","2008,","pp.","93–105.\n[22]","","T.","Gao","and","Q.","Ji,","“Local","causal","discovery","of","direct","causes","and","effects,”\ninAdvances","","in","","Neural","","Information","","Processing","","Systems,","","2015,","","pp.\n2512–2520.\n[23]","","I.","","Tsamardinos,","","C.","","F.","","Aliferis,","","and","","A.","","Statnikov,","","“Time","","and","","sample\nefficient","discovery","of","markov","blankets","and","direct","causal","relations,”","in\nProceedings","of","the","ninth","ACM","SIGKDD","international","conference","on\nKnowledge","discovery","and","data","mining.","","","","ACM,","2003,","pp.","673–678.\n[24]","","C.","Meek,","“Causal","inference","and","causal","explanation","with","background\nknowledge,”","inProceedings","of","the","Eleventh","conference","on","Uncertainty\nin","","artificial","","intelligence.Morgan","","Kaufmann","","Publishers","","Inc.,","","1995,\npp.","403–410.\n[25]","","C.","","F.","","Aliferis,","","I.","","Tsamardinos,","","and","","A.","","Statnikov,","","“Hiton:","","a","","novel\nmarkov","","blanket","","algorithm","","for","","optimal","","variable","","selection,”","","inAMIA\nannual","","symposium","","proceedings,","","vol.","","2003.American","","Medical\nInformatics","Association,","2003,","pp.","21–25.\n[26]","","T.","Niinimki","and","P.","Parviainen,","“Local","structure","discovery","in","bayesian\nnetworks,”","","in28th","","Conference","","on","","Uncertainty","","in","","Artificial","","Intelli-\ngence,","UAI","2012;","Catalina","Island,","CA;","United","States;","15","August","2012\nthrough","17","August","2012,","2012,","pp.","634–643.\n[27]","","J.","","Pearl,Probabilistic","","reasoning","","in","","intelligent","","systems:","","networks","","of\nplausible","inference.","","","","Elsevier,","2014.\n[28]","","T.","","","Gao","","","and","","","Q.","","","Ji,","","","“Efficient","","","markov","","","blanket","","","discovery","","","and","","","its\napplication,”IEEE","","transactions","","on","","cybernetics,","","vol.","","47,","","no.","","5,","","pp.\n1169–1179,","2017.\n[29]","","I.","","A.","","Beinlich,","","H.","","J.","","Suermondt,","","R.","","M.","","Chavez,","","and","","G.","","F.","","Cooper,\n“The","","alarm","","monitoring","","system:","","A","","case","","study","","with","","two","","probabilistic\ninference","","techniques","","for","","belief","","networks,”","","inAIME","","89.Springer,\n1989,","pp.","247–256.\n[30]","","X.","Xie,","Z.","Geng,","and","Q.","Zhao,","“Decomposition","of","structural","learning\nabout","","directed","","acyclic","","graphs,”Artificial","","Intelligence,","","vol.","","170,","","no.\n4-5,","pp.","422–439,","2006.\n[31]","","I.","","Guyon","","and","","A.","","Elisseeff,","","“An","","introduction","","to","","variable","","and","","feature\nselection,”Journal","of","machine","learning","research,","vol.","3,","no.","Mar,","pp.\n1157–1182,","2003.\n[32]","","K.","","Yu,","","X.","","Wu,","","W.","","Ding,","","and","","J.","","Pei,","","“Scalable","","and","","accurate","","online\nfeature","","selection","","for","","big","","data,”ACM","","Transactions","","on","","Knowledge\nDiscovery","from","Data","(TKDD),","vol.","11,","no.","2,","pp.","1–39,","2016.\n[33]","","X.","","Wu,","","K.","","Yu,","","W.","","Ding,","","H.","","Wang,","","and","","X.","","Zhu,","","“Online","","feature\nselection","","with","","streaming","","features,”IEEE","","transactions","","on","","pattern\nanalysis","","and","","machine","","intelligence,","","vol.","","35,","","no.","","5,","","pp.","","1178–1192,\n2013.\n[34]","","K.","","Yu,","","L.","","Liu,","","and","","J.","","Li,","","“A","","unified","","view","","of","","causal","","and","","non-causal\nfeature","selection,”arXiv","preprint","arXiv:1802.05844,","2018.\n[35]","","L.","Yu","and","H.","Liu,","“Efficient","feature","selection","via","analysis","of","relevance\nand","","redundancy,”Journal","","of","","machine","","learning","","research,","","vol.","","5,","","no.\nOct,","pp.","1205–1224,","2004."],"doc20":["\n\nA","Two-Stage","Variable","Selection\nApproach","for","Correlated","High\nDimensional","Predictors\nZhiyuan","Li*\nEmail:","li3z3@mail.uc.edu\nDepartment","of","EECS,","University","of","Cincinnati\nAbstract\nWhen","fitting","statistical","models,","some","predictors","are","often","found","to","be\ncorrelated","with","each","other,","and","functioning","together.","Many","group","variable\nselection","methods","are","developed","to","select","the","groups","of","predictors","that","are\nclosely","related","with","the","continuous","or","categorical","response.","","These","existing\nmethods","usually","assume","the","group","structures","are","well","known.","","For","exam-\nple,","variables","with","similar","practical","meaning,","or","dummy","variables","created\nby","a","categorical","data.","","However,","in","practice,","it","is","impractical","to","know","the\nexact","group","structure,","especially","when","the","variable","dimensional","is","large.\nAs","a","result,","the","group","variable","selection","results","may","be","affected.","","To","solve\nthe","challenge,","we","propose","a","two-stage","approach","which","combines","a","variable\nclustering","stage","and","a","group","variable","stage","for","the","group","variable","selection\nproblem.","","The","variable","clustering","stage","uses","information","from","the","data","to\nfind","","a","","group","","structure,","","which","","improves","","the","","performance","","of","","the","","existing\ngroup","variable","selection","methods.","","For","ultrahigh","dimensional","data,","where\nthe","predictors","are","much","larger","than","observations,","we","incorporated","a","vari-\nable","screening","method","in","the","first","stage","and","shows","the","advantages","of","such\napproach.","","In","this","article,","we","compared","and","discussed","the","performance","of\nfour","existing","group","variable","selection","methods","under","different","simulation\nmodels,","","with","","and","","without","","the","","variable","","clustering","","stage.","","","The","","two-stage\nmethod","shows","a","better","performance,","in","terms","of","the","prediction","accuracy,\nas","well","as","in","the","accuracy","to","select","active","predictors.","","An","athlete","data","is\nalso","used","to","show","the","advantages","of","the","proposed","method\n1","","","","Introduction\nRegression","and","classification,","two","highly","utilized","methods","in","supervise","learn-\ning,","are","conducted","to","perform","a","functional","relationship","between","response","and\npredictors","(or","variables).","","They","are","widely","applied","predicting","the","new","observa-\ntion","outcomes","and","to","select","the","important","variables.","","When","building","a","regression\nor","classification","model,","a","simpler","model,","in","other","words,","a","model","with","less","vari-\nables,","is","easier","to","be","interpreted.","","In","addition,","removing","unimportant","variables\ncan","also","reduce","the","model","loss,","risk","of","over","fitting","and","further","improve","the","pre-\ndiction","performance.","","Variables","selection","is","a","method","to","explore","the","important\n1\narXiv:2103.13357v1","","[stat.ME]","","24","Mar","2021\n\nvariables","that","related","the","response,","it","has","been","applying","in","both","industry","and\nresearch","","institute.","","","In","","usual","","regression","","set","","up,","","we","","assume","","each","","variables","","are\nindependent","and","the","general","linear","regression","model","is","defined","by\nY=Xβ+\u000f(1.1)\nwhereY∈R\nn×1\nis","the","response","vector,Xis","the","predictor","matrix","corresponding\nto","the","p","predictors.","Without","loss","of","generality,","we","assumeYandXare","centered.\nβ∈R\np×1\nis","the","coefficient","vector,β\ni\n∈βand\u000f∈R\nn×1\nis","a","random","error","with\nmean0and","varianceσ\n2\nI.","","The","ordinary","least","squares","(OLS)","method","estimates\nβby","minimizing","the","residual","sum","square","(RSS)","as","follows\nˆ\nβ=","argmin\nβ\n{||Y−Xβ||\n2\n2\n}(1.2)\nwhereL(β)","","=||Y−Xβ||\n2\n2\nis","","the","","loss","","function,","","and||","·","||\n2\nstands","","for","","the\nL\n2\nnorm.","","","Based","","on","","function","","(1.2),","","an","","unbiased","","estimator\nˆ\nβcan","","be","","solved\nforβ,","","such","","that,\nˆ\nβ=","","(X\nT\nX)\n−1\nX\nT\nY.","","","","For","","binary","","classification","","problem,\nletX\ni\n=","","(X\n11\n,X\n12\n,···,X\n1p\n)\nT\n⊆X,","","whereX=","","(X\n1\n,X\n2\n,···,X\nn\n)\nT\nfor\ni=","1,2,···n,","andY\ni\n∈{0,1}∼Binomial(n,p)","andY\ni\n∈Y,","wherep[Y\ni\n=","1|X\ni\n]\nis","the","probability","that","the","response","belongs","to","the","category","1","forith","observation.\nHence,","the","logistic","model","is","defined","as\nlog(\np[Y\ni\n=","1|X\ni\n]\n1−p[Y\ni\n=","1|X\ni\n]\n)","=X\nT\ni\nβfori=","1,2,···,n(1.3)\nwhere","the","coefficient","estimator\nˆ\nβis","estimated","by","minimizing","the","loss","function,\nwhich","is","defined","as\nL(β)","=−\n1\nn\nlog{\nn\n∏\ni=1\n[p(Y\ni\n=","1|X\ni\n)]\nY\ni\n[1−p(Y\ni\n=","1|X\ni\n)]\n1−Y\ni\n}(1.4)\nand","","the","","Gradient","","Descent","","or","","Newton’s","","Method","","can","","be","","applied","","to","","solve","","the\noptimal","solution","for\nˆ\nβin","function","(1.4).\nIn","practice,\nˆ\nβtrends","to","be","inaccurate","when","the","variables","are","correlated","to\neach","other.","","Therefore,","selecting","the","important","variables","in","equations","(1.1)","and\n(1.3)","becomes","a","majority","problem.","","It","is","the","same","as","deciding","which","coefficients\nshould","","be","","set","","to","","zero","","inβ.","","","A","","simple","","approach","","is","","to","","make","","a","","hypothesis","","test\nfor","each","variable","by","producing","an","ANOVA","table","and","eliminate","the","insignificant\nvariables.","","However,","","ANOVA","is","valid","only","when","the","variables","are","orthogonal,\nand","it","does","not","essentially","solve","the","multicollinearity","issue.","","Several","traditional\napproaches,","such","as","the","best","subset","regression,","which","was","proposed","by","Hocking\nand","Leslie","[1967],","can","be","applied.","","In","the","best","subset","regression,","some","popular\nmodel","selection","criterion,","such","as","Akaike","Information","Criterion","(AIC),","Bayesian\nInformation","Criterion","(BIC),","Coefficient","of","Determination","(R\n2\n),","have","been","fre-\nquently","applied","to","evaluate","each","candidate","model","and","choose","the","best","model\nassociated","","with","","the","","optimal","","score.","","","The","","best","","subset","","regression","","performs","","very\naccurate","","but","","it","","only","","works","","well","","when","","the","","number","","of","","predictors","","is","","relatively\nsmall.","","The","reason","is","that,","the","time","complexity","for","the","best","subset","regression","is\nO(2\nn\n),","and","it","increasingly","cost","a","big","amount","of","computational","work","with","the\nnumber","of","predictors","increases.","","Another","popular","variable","selection","method","is\n2\n\nstepwise","methods,","for","example,","the","forward","selection","or","backward","elimination,\nwhich","was","proposed","by","Efroymson","[1966].","","It","has","been","applied","widely","to","select\nthe","individual","variables","due","to","its","great","performance","criterion","in","terms","of","ac-\ncuracy","and","fast","computation.","","However,","the","stepwise","approach","was","classified","to\ngreedy","algorithms,","and","it","trends","to","attaches","local","optimizer","instead","of","the","global\noptimizer.\nIn","","modern","","statistics","","studies,","","with","","the","","fast","","growth","","of","","computing","","power","","on\nstorage","","of","","database","","and","","data","","warehouse,","","massive","","and","","ultrahigh","","dimensional\ndatasets","normally","exist","in","various","fields,","such","as","social","media,","economics,","and\nmedicine.","","Several","recent","studies","(Hoerl","and","Kennard","[1970],","Foster","and","George\n[1994],","Tibshirani","[1996],","Efron","et","al.","[2004],","Zou","and","Hastie","[2005])","have","been\nconducted","and","showed","that","the","traditional","best","subset","regression","methods","are\nlack","of","stability,","especially","when","the","number","of","predictors","are","greater","than","the\nnumber","","of","","observations.","","","Hoerl","","and","","Kennard","","[1970]","","proposed","","the","","Ridge","","and\nintroduced","the","shrinkage","idea.","","Tibshirani","[1996]","proposed","the","famous","Lasso","to\nperform","variable","selection","and","it","displayed","great","performance","on","both","estimation\naccuracy","and","computation","efficiency.","","After","Lasso","had","been","introduced,","many\nmethods","follow","similar","shrinkage","idea","were","also","developed.","","For","example,","Fan\nand","Li","[2001]","proposed","the","Smoothly","Clipped","Absolute","Deviation","(SCAD)","and\nZhang","et","al.","[2010]","proposed","the","Minimax","Concave","Penalty","(MCP)","to","solve","the\nOracle","properties","issue","in","Lasso.","","Meanwhile,","Zou","and","Hastie","[2005]","proposed\nthe","Elastic","Net","approach","and","overcame","the","disadvantage","that","Lasso,","SCAD","and\nMCP","all","ignore","the","correlation","between","the","predictors.\nIn","","high","","dimensional","","data,","","the","","predictors","","usually","","are","","correlated","","with","","each\nother","","and","","functioning","","together","","in","","groups.","","","The","","groups","","are","","usually","","called","","fac-\ntors","or","components.","","Although","individual","variable","selection","methods","like","Lasso,\nSCAD","and","MCP","achieve","excellent","variable","selection","performance,","for","variables\nwith","a","group","structure,","they","will","usually","randomly","choose","one","of","them","and","pe-\nnalize","all","the","other","coefficients","to","zero.","","This","characteristic","can","provide","simple\nand","","sparse","","solution,","","however,","","it","","is","","unfavorable,","","since","","intuitively","","one","","want","","to\nkeep","all","the","predictors","inside","a","group","active","if","they","functioning","together.","","To\nsolve","","this","","problem,","","Yuan","","and","","Lin","","[2006]","","proposed","","a","","group","","variable","","selection\nmethod","that","is","called","group","Lasso.","","It","penalizes","the","group","coefficients","based","on\nthe","Lasso","penalty.","","This","method","assumes","the","group","structure","of","the","predictors\nare","known","in","advance.","","Follow","similar","idea,","extended","SCAD","and","MCP","penalties\nand","","proposed","","group","","SCAD","","and","","group","","MCP","","methods.","","","In","","addition,","","consider-\ning","the","possibility","that","only","few","predictors","in","a","group","are","truly","active,","Simon\net","al.","[2013]","proposed","the","sparse","group","Lasso","method,","which","adds","an","additional\npenalty","term","based","on","group","Lasso,","and","this","allow","sparsity","on","both","groups","and\nindividual","variables","with","a","group.\nA","regular","challenge","for","the","current","existing","group","variable","selection","models\nis","that","the","researchers","need","to","have","a","prior","knowledge","of","group","structure","among\nvariables.","","Such","information","is","usually","obtained","based","on","prior","research","in","the\ncertain","field,","data","are","collected","in","groups,","or","variables","are","dummy","variables","of\na","categorical","predictor.","","Therefore,","researchers","usually","need","to","pre-define","which\nvariables","should","be","defined","as","a","group.","","However,","it","is","too","subjective","sometimes\nto","determine","the","group","structure","based","on","how","data","is","collected,","since","the","vari-\nables","may","have","other","unknown","relationship.","","It","is","also","impractical","to","know","the\ngrouping","information","if","the","predictor","dimensional","is","quite","large.","","In","addition,\nin","","many","","research","","projects,","","one","","of","","the","","goals","","of","","the","","analysis","","is","","to","","discover","","the\n3\n\nrelationship","and","group","structures","among","the","predictors","and","see","how","they","are\nrelated","with","the","response.","","Therefore,","it","is","not","possible","to","know","a","valid","group\ninformation","","in","","advance.","","","Due","","to","","above","","mentioned","","issues,","","letting","","the","","data","","it-\nself","show","the","group","structure","seems","make","sense.","","In","other","words,","","we","can","find\nthe","group","structure","before","fitting","a","group","variable","selection","model.","","This","idea\nwas","","introduced","","by","","Park","","et","","al.","","[2007],","","who","","proposed","","a","","method","","that","","combines\nhierarchical","clustering","and","Lasso","to","solve","the","challenge","of","having","more","predic-\ntors","than","observations,","Tolo","̧si","and","Lengauer","[2011]","also","applied","the","clustering\nmethod,","which","refer","to","Park","et","al.","[2007],","for","classification","problem","in","high","cor-\nrelation","of","genomics","dataset.","","In","group","regularization","model,","B","̈uhlmann","et","al.\n[2013]","proposed","the","cluster","group","Lasso","(CGL)","to","identify","the","group","structure\nfor","group","Lasso","by","utilizing","the","noveland","bottom-up","agglomerative","clustering","al-\ngorithm","based","on","canonical","correlations.","","Gauraha","and","Parui","[2017]","introduced\na","","pre-selection","","method","","using","","elastic","","net","","+","","CGL","","for","","high","","dimension","","variable\nspace.","","A","further","","challenge","with","the","group","","clustering","is","that","both","continuous\nand","","categorical","","predictors","","exist,","","a","","method","","that","","can","","simultaneously","","deal","","with\nthese","two","types","of","variables","is","preferred.\nIn","","this","","paper,","","we","","propose","","a","","two-stage","","group","","variable","","selection","","approach\nbased","on","variable","clustering","to","select","the","optimal","group","structure","in","the","first\nstage","and","group","variable","selection","as","the","second","stage.","","For","dataset","with","much\nhigher","","number","","of","","predictors","","than","","the","","observations,","","we","","edit","","the","","first","","stage","","by\napplying","","a","","variable","","screening","","method","","first","","to","","quickly","","get","","a","","subset","","containing\nactive","","predictors,","","then","","apply","","the","","regular","","grouping","","algorithm.","","","Another","","goal\nof","this","paper","is","to","compare","the","performance","of","various","group","variable","selection\nmethods","for","both","continuous","and","categorical","responses,","under","various","model","set\nup.","","The","paper","is","organized","as","follows:","","Section","2","introduces","variable","selection,\ngroup/sparse","group","variable","selection","methods,","variable","clustering","and","variable\nscreening","algorithms.","The","proposed","two-stage","group","variable","selection","method","is\nintroduced","and","discussed","in","Section","3.","Simulation","examples","to","compare","different\ngroup","variable","selection","methods","as","well","as","the","proposed","approach","are","included\nin","Section","4.","","Section","5","contains","an","example","of","real","data","analysis.","","Discussion\nand","conclusions","are","in","Section","6.\n2","","","","Method\n2.1","","","","Individual","Variable","Selection","for","Regression\nWe","first","overview","some","existing","variable","selection","methods","for","regression","and\nclassification.","","Consider","a","regression","model","as","in","equation","(1.1),","","the","following\nmethods","follow","the","idea","to","penalize","the","regression","coefficients","based","on","different\npenalty","functions.\n2.1.1","","","","Lasso\nThe","Lasso","is","proposed","by","Tibshirani","[1996]","to","perform","variable","selection","and\nparameter","estimation,","and","the","estimator","is","defined","as","follows:\nˆ\nβ\nLasso\n(λ)","=","argmin\nβ\n{||Y−Xβ||\n2\n2\n+\np\n∑\ni=1\nλ||β\ni\n||\n1\n}(2.1)\n4\n\nwhereλ≥0","","is","","a","","tuning","","parameter,||·||\n1\nstands","","for","","theL\n1\nnorm","","andXis\na","","centered","","and","","scaled","","matrix.","","","When","","variables","","are","","strongly","","correlated,","","Lasso\nregression","likely","selects","one","variable","from","the","correlated","variables,","","and","coeffi-\ncients","for","the","remaining","variables","are","decayed","to","0.","","The","sparsity","in","the","solution\nis","","introduced","","by","","theL\n1\nnorm.","","","If","","theλin","","function","","(2.1)","","is","","larger,","","the","","more\ncoefficients","in","the","Lasso","estimator\nˆ\nβ\nLasso\n(λ)","will","be","shrunk","to","0.","","What","is","more,\nifλ→","∞,","","then\nˆ\nβ\nLasso\n→0,","","and","","it","","leads","","to","","an","","empty","","or","","null","","model.","","","The\nmost","popular","solutions","for","estimating","parameters","in","Lasso","is","the","Least","Angle\nRegression","(LARS;","Efron","et","al.","[2004])","and","Coordinate","Descent","(Friedman","et","al.\n[2010])\n2.1.2","","","","SCAD","and","MCP\nTo","adjust","the","excessive","shrinkage","power","based","onL\n1\nnorm","for","Lasso,","Fan","and\nLi","[2001]","proposed","a","non-convex","function,","Smoothly","Clipped","Absolute","Deviation\n(SCAD),","with","the","estimator","defined","as\nˆ\nβ\nSCAD\n(λ,γ)","=","argmin\nβ\n{||Y−Xβ||\n2\n2\n+\np\n∑\ni=1\nP\nSCAD\nλ,γ\n(||β\ni\n||\n1\n)}(2.2)\nwith","the","penalty","functionP\nSCAD\nλ,γ\n(·),","such","that\nP\nSCAD\nλ,γ\n(w)","=\n\n\n\n\n\nλ|w|,|w|≤λ;\n2γ|w|−w\n2\n−λ\n2\n2(γ−1)\n,","","λ","<|w|<","γλ;\n(γ+1)λ\n2\n2\n,|w|≥γλ;\nwhereγ",">2","andλ",">0","are","the","tuning","parameters,","and","Fan","suggestedγ=","3.7.\nThe","","penalty","","function","","from","","SCAD","","is","","a","","non-convex","","function","","and","","can","","strongly\nshrink","the","small","regression","coefficients","but","shrink","the","large","coefficients","weakly.\nThe","Minimax","Concave","Penalty","(MCP)","is","another","non-convex","function,","which\nwas","","proposed","","by","","Zhang","","et","","al.","","[2010],","","and","","it","","solved","","the","","estimation","","under","","the\napproximate","unbiasedness","and","find","a","solution","for","concavity","computational","chal-\nlenge","","with","","minimum","","penalty.","","","The","","coefficient","","estimator","","for","","MCP","","penalty","","is\ndefined","as\nˆ\nβ\nMCP\n(λ,γ)","=","argmin\nβ\n{||Y−Xβ||\n2\n2\n+\np\n∑\ni=1\nP\nMCP\nλ,γ\n(||β\ni\n||\n1\n)}(2.3)\nwith","the","penalty","functionP\nMCP\nλ,γ\n(·),","such","that\nP\nMCP\nλ,γ\n(w)","=\n{\nλ|w|−\nw\n2\n2γ\n,|w|≤γλ;\nγλ\n2\n2\n,|w|>","γλ;\nwhereγ",">1","andλ",">0","are","the","tuning","parameters.","","The","idea","of","SCAD","and","MCP\nis","very","similar.","","Both","SCAD","and","MCP","enjoy","a","strong","performance","on","Oracle\nproperties","in","terms","of","on","unbiasedness,","sparsity","and","continuity,","which","the","Lasso\nmethod","does","not","achieve.\n5\n\nComparing","between","SCAD","and","MCP,","we","typically","compare","their","derivative\nof","the","penalty,","which","are","defined","as","follows\nP\n′\nSCAD\nλ,γ\n(w)","=\n\n\n\n\n\nλ,|w|≤λ;\nγλ−|w|\nγ−1\n,","","λ","<|w|<","γλ;\n0,|w|≥γλ\nand\nP\n′\nMCP\nλ,γ\n(w)","=\n{\n(λ−\n|w|\nγ\n)sign(x),|w|≤γλ;\n0,|w|>","γλ\nFigure","1","displays","that","SCAD","and","MCP","starts","using","same","penalization","rate\nas","Lasso’s,","then","reduce","the","rate","down","to","0","as","the","size","of","coefficient","increases.\nBesides,","MCP","starts","to","decrease","the","penalization","rate","immediately","to","0","while\nSCAD","keeps","the","same","rate","with","the","Lasso’s","before","decreasing.\nFigure","1:","","Penalization","Rate","for","Lasso,","MCP,","SCAD\n6\n\n2.2","","","","Individual","Variable","Selection","in","Classification\nFor","classification","problem,","we","can","apply","the","same","penalty","from","Lasso,","SCAD\nand","MCP.","The","coefficient","estimator\nˆ\nβcan","be","defined","as\nˆ\nβ\nLasso\n(λ)","=","argmin\nβ\n{L(β)","+\np\n∑\ni=1\nλ||β\ni\n||\n1\n}\nˆ\nβ\nSCAD\n(λ,γ)","=","argmin\nβ\n{L(β)","+\np\n∑\ni=1\nP\nSCAD\nλ,γ\n(||β\ni\n||\n1\n)}\nˆ\nβ\nMCP\n(λ,γ)","=","argmin\nβ\n{L(β)","+\np\n∑\ni=1\nP\nMCP\nλ,γ\n(||β\ni\n||\n1\n)}\nwhereL(β)","is","the","loss","function","follows","(1.4),","parametersλ,γand","penalty","func-\ntionsP\nSCAD\nλ,γ\n(·),P\nMCP\nλ,γ\n(·)","","enjoy","","the","","same","","properties","","in","","regression","","cases","","from\nsection","2.1.\n2.3","","","","Group","Variable","Selection","in","Regression\nFor","the","predictors","and","responseXandY,","suppose","the","predictor","variables","are\nseparated","intoKgroups.","","Thus,","matrixXcan","be","written","as","(X\n1\n,X\n2\n,···,X\nK\n),\nwhereX\nk\n=","(X\nk1\n,X\nk2\n,···,X\nkp\nk\n),","fork=","1,2,3...,K,","andp\nk\nbe","the","group","size\nfor","thek-th","group.","","The","correspondingp×1","coefficient","vectorβcan","thus","be\nrepresented","as","(β\n1\n,β\n2\n,···,β\nK\n),","withβ\nT\nk\n=","(β\nk1\n,β\nk2\n,···,β\nkp\nk\n).","","Suppose","the\nn×1","error","vector\u000f∼N(0,σ\n2\nI),","regression","model","with","group","structure","can","be\nrewritten","as\nY=\nK\n∑\nk=1\nX\nk\nβ\nk\n+\u000f(2.4)\n2.3.1","","","","Group","Lasso\nThe","group","lasso","was","proposed","by","Yuan","and","Lin","[2006],","it","assumes","that","each\ngroup","are","orthonormal","of","the","model","matrices.","","The","coefficient","estimator","of","group\nLasso","is","defined","as\nˆ\nβ\ngrLasso\n(λ)","=","argmin\nβ\n{||Y−\nK\n∑\nk=1\nX\nk\nβ\nk\n||\n2\n2\n+λ\nK\n∑\nk=1\n√\np\nk\n||β\nk\n||\n2\n}(2.5)\nwhereλ≥0","is","a","tuning","parameter","to","control","the","number","of","groups.","The","function\n(2.5)","is","a","convex","function","so","that","the","global","optimizer","solution","exist.","","To","find\nthe","solution","for","group","Lasso,","","Yuan","and","Lin","[2006]","proposed","the","group","LARS\nalgorithm","","based","","on","","LARS.","","Futhermore,","","Breheny","","and","","Huang","","[2009]","","proposed\nthe","Locally","Coordinate","Decent","(LCD)","based","on","Coordinate","Decent.","","Choosing\na","large","value","ofλcan","screen","out","entire","group","variables","while","a","low","value","ofλ\ncan","include","all","group","variables","into","the","model.","","In","other","words,","ifλ→∞,","then\nˆ\nβ\ngrLasso\n→0,","and","leads","to","a","null","model;","ifλ=","0,","then\nˆ\nβ\ngrLasso\n=\nˆ\nβ\nOLS\n.\nThe","group","Lasso","requires","prior","knowledge","about","the","group","structure,","if","each\ngroup","only","contains","one","variable,","i.e.,K=p,","then","group","Lasso","will","be","reduced\n7\n\nto","","Lasso;","","if","","there","","only","","exist","","one","","group,","","i.e,K=","","1,","","then","","group","","Lasso","","will\nbe","reduced","to","Ridge","regression.","","If","it","reduces","to","ridge","regression,","group","Lasso\ncannot","","screen","","out","","any","","variables,","","since","","the","","penalty","","function","","usedL\n2\nnorm","","on\nthe","subspace","for","each","groups.","","Even","though","the","group","Lasso","enjoys","very","good\nvariable","selection","performance,","as","an","extension","of","Lasso,","group","Lasso","does","not\nhave","Oracle","properties.\n2.3.2","","","","Group","SCAD","and","Group","MCP\nFollow","","similar","","group","","variable","","selection","","idea","","as","","above","",",","","Wang","","et","","al.","","[2007]\nproposed","the","group","SCAD,","and","Huang","et","al.","[2012]","proposed","the","group","MCP\nbased","on","the","SCAD","and","MCP","penalty","respectively,","and","the","estimator","is","defined\nas","follows\nˆ\nβ\ngrSCAD\n(λ,γ)","=","argmin\nβ\n{||Y−\nK\n∑\nk=1\nX\nk\nβ\nk\n||\n2\n2\n+λ\nK\n∑\nk=1\nP\nSCAD\nλ,γ\n(||β\nk\n||\n2\n)}(2.6)\nˆ\nβ\ngrMCP\n(λ,γ)","=","argmin\nβ\n{||Y−\nK\n∑\nk=1\nX\nk\nβ\nk\n||\n2\n2\n+λ\nK\n∑\nk=1\nP\nMCP\nλ,γ\n(||β\nk\n||\n2\n)}(2.7)\nwhere","both","tuning","parametersλ,γand","penalty","functionsP\nSCAD\nλ,α\n(·),P\nMCP\nλ,α\n(·)","are\ncorresponding","to","the","properties","of","SCAD","and","MCP,","respectively.","","Both","group\nSCAD","","and","","group","","MCP","","solved","","the","","weakness","","of","","biased","","estimation","","from","","group\nLasso,","and","achieves","the","oracle","properties.\n2.3.3","","","","Sparse","Group","Variable","Selection\nIn","the","above","mentioned","group","variable","selection","models,","the","penalty","function\nis","","computed","","by","","the","","sum","","ofL\n2\nnorm","","of","","group","","variables.","","","Similar","","to","","Lasso,","","it\ncan","set","the","coefficient","of","some","groups","to","0,","","and","similar","to","Ridge,","","it","can","only\nshrink","the","coefficients","within","a","group","but","never","set","any","one","of","them","to","0.","","This\nindicates","that","individual","variables","within","a","group","are","not","able","to","be","selected","for\ngroup","variable","selection","methods.","","However,","in","practice,","although","there","maybe\nhigh","correlation","among","the","variables","within","a","group,","only","a","few","variables","are\ntruly","related","with","the","response.","","To","allow","group","variable","selection","methods","to\nselect","","individual","","variables","","within","","some","","groups,","","the","","sparse","","group","","penalty","","has\nbeen","","introduced.","","","This","","method","","combines","","two","","penalty","","function","","to","","achieve","","a\ndouble-layered","variable","selection,","where","one","of","the","layer","is","to","penalize","the","group\nvariables","and","the","other","is","to","penalize","individual","variables","within","some","groups.\nThe","general","form","of","double-layered","penalty","function","can","be","defined","as\nF\nλ\n(β)","=λ\n1\nK\n∑\nk=1\nP\n1\n(||β\nk\n||\n2\n)","+λ\n2\nK\n∑\nk=1\np\nK\n∑\np\nk\n=1\nP\n2\n(||β\nkp\nk\n||\n1\n)(2.8)\nwhereP\n1\n(·)","is","to","control","the","group","coefficient,","andP\n2\n(·)","is","to","control","the","indi-\nvidual","coefficient","within","some","groups.\nSimon","et","al.","[2013]","proposed","an","extended","version","of","group","Lasso","method,\nso-called","","sparse","","group","","Lasso.","","","This","","method","","combined","","Lasso","","and","","group","","Lasso\nthrough","adding","an","additionalL\n1\nnorm","penalty","from","Lasso","to","each","group.","","The\n8\n\ncoefficient","estimator","of","the","sparse","group","Lasso","is","defined","as\nˆ\nβ\nSGL\n(λ)","=","argmin\nβ\n{||Y−\nK\n∑\nk=1\nX\nk\n||\n2\n2\n+λ\n1\nK\n∑\nk=1\n||β\nk\n||\n2\n+λ\n2\n||β||\n1\n}(2.9)\nwhereλ\n1\n,λ\n2\n≥0","are","the","tuning","parameters.","","In","equation","(2.9),","the","first","penalty\ntermλ\n1\n∑\nK\nk=1\n||β\nk\n||\n2\ncontrols","the","group","sparsity","and","the","second","penalty","term\nλ\n2\n||β||\n1\ncontrols","the","variable","sparsity","within","some","certain","groups.","","The","penalty\nof","sparse","group","Lasso","can","be","considered","as","involving","both","penalty","terms","from\ngroup","Lasso","and","Lasso,","such","that,","ifλ\n1\n=","0,λ\n2\n>0,","then\nˆ\nβ\nSGL\n(λ)","=\nˆ\nβ\nLasso\n(λ),\nand","","ifλ\n1\n>0,λ\n2\n=","","0,","","then\nˆ\nβ\nSGL\n(λ)","","=\nˆ\nβ\ngrLasso\n(λ).","","","Besides,","","equation","","(2.9)\nis","","a","","convex","","function","","since","","it","","is","","sum","","of","","convex","","function","","with","","both","","Lasso","","and\ngroup","Lasso","penalties.","","Therefore,","this","method","obtains","a","global","optimizer","and\nachieves","","efficient","","computation","","for","","its","","estimated","","coefficients.","","","Because","","sparse\ngroup","Lasso","is","combined","by","group","Lasso","and","Lasso,","","where","none","of","them","has\nOracle","properties,","thus,","it","also","does","not","have","Oracle","properties.\n2.4","","","","Group","Variable","Selection","in","Classification\nFor","classification","problems,","for","example,","when","the","response","vectorYis","bi-\nnary,","the","classification","model","with","group","structures","can","be","rewritten","as\nlog(\np[Y\ni\n=","1|X\ni\n]\n1−p[Y\ni\n=","1|X\ni\n]\n)","=\nK\n∑\nk=1\nX\nT\nik\nβ\nk\n(2.10)\nSimilar","to","section","2.2,","the","coefficient","estimators","for","group","Lasso,","group","SCAD,\ngroup","MCP","and","sparse","group","Lasso","are","defined","as","follows\nˆ\nβ\ngrLasso\n(λ)","=","argmin\nβ\n{L(β)","+λ\nK\n∑\nk=1\n√\np\nk\n||β\nk\n||\n2\n}\nˆ\nβ\ngrSCAD/grMCP\n(λ,γ)","=","argmin\nβ\n{L(β)","+λ\nK\n∑\nk=1\nP\nSCAD/MCP\nλ,γ\n(||β\nk\n||\n2\n)}\nˆ\nβ\nSGL\n(λ)","=","argmin\nβ\n{L(β)","+λ\n1\nK\n∑\nk=1\n||β\nk\n||\n2\n+λ\n2\n||β||\n1\n}\n2.5","","","","Variable","Clustering","with","PCAMIX\nThe","goal","of","variable","clustering","is","to","group","a","set","of","variables","into","some","ho-\nmogeneous","groups","and","is","therefore","variable","clustering","can","seek","for","a","meaningful\ngroup","structures.","","Chavent","et","al.","[2011]","proposed","a","hierarchical","variable","cluster-\ning","algorithm","that","can","perform","cluster","analysis","among","the","variables","based","on\na","PCAMIX","(Kiers","[1991])","method.","","The","algorithm","can","be","operated","on","variable\nclustering","with","no","restriction","on","quantitative","or","qualitative","variables,","and","is","a\nflexible","version","of","Principle","Component","Analysis","(PCA).\n2.5.1","","","","PCAMIX","Calculation","Algorithm\nConsider","a","set","ofk\n1\nquantitative","variables","and","a","set","ofk\n2\nqualitative","vari-\nables,","denoted","asAandB,","andnis","the","number","of","observations","inAandB,\n9\n\nsuch","","that,A\nn×k\n1\n={a\n1\n,a\n2\n,a\n3\n,...,a\nk\n1\n}andB\nn×k\n2\n={b\n1\n,b\n2\n,b\n3\n,...,b\nk\n2\n}.","","","The\ndetail","information","of","variable","clustering","is","followed","on","next","sections.","","DefineD\nis","the","indicator","matrix","ofB,","","Σ","is","the","diagonal","matrix","of","each","categories","fre-\nquency","inB,","andΦ=I−\n1\nT\n1\nn\nis","the","centering","operator,","whereIis","a","identity\nmatrix","and1is","the","vector","with","unit","1","entries.","","Thus,","the","algorithm","of","PCAMIX\nis","defined","as\nAlgorithm","1PCAMIX\n1:input:A,B,n\n2:A←A−11\nT\nAn\n−1\n.StandardizeA\n3:B←ΦDΣ\n−\n1\n2\n.StandardizeB\n4:W\nk\n←\n1\n√\nn\nA|B.CONCATAandB\n5:SolveW\nk\n=UΛV\nT\n.SVD","onW\nk\n6:return:U,Λ,V.A","matrix","of","PC","scores\n2.5.2","","","","Homogeneity\nDefine","a","partition","setK\nM\nis","a","partition","of","M","clusters","fromk\n1\n+k\n2\nvariables,\nsuch","","that,K\nM\n={C\n1\n,C\n2\n,C\n3\n,...,C\nM\n},","","whereC\nm\nis","","themth","","cluster","","inK\nM\n.\nThus,","the","homogeneity","within","clusterC\nm\nis","defined","as\nH(C\nm\n)","=λ\nm\n1\n(2.11)\nwhereλ\nm\n1\nis","the","first","eigenvalues","inΛof","PCAMIX","(Section","2.5.1)","applied","to\nclusterC\nm\n.","","The","homogeneity","H","of","partitionK\nM\nis","defined","as","is","defined","as","sum\nof","all","the","homogeneities","of","its","clusters,","such","that\nH(K\nM\n)","=\nM\n∑\nm=1\nH(C\nm\n)","=\nM\n∑\nm=1\nλ\nm\n1\n(2.12)\nThe","homogeneityH(C\nm\n)","has","maximum","value","when","all","the","variables","withinC\nm\nbring","the","same","information.\n2.5.3","","","","Hierarchical","Variable","Clustering","Algorithm\nSuppose","we","have","a","datasetD\nn×k\n,","","where","n","is","the","number","of","observations,\nk","","is","","the","","number","","of","","variables,","","andA,Bare","","the","","two","","clusters","","ofD\nn×k\n.","","","The\ndissimilarity","D","of","clustersAandBis","defined","as\nD(A,B)","=H(A)","+H(B)−H(A∪B)","=λ\nA\n1\n+λ\nB\n1\n−λ\nA∪B\n1\n(2.13)\nHence,","the","algorithm","of","hierarchical","variable","clusteringclustcan","be","defined","as\n2.5.4","","","","Rand","Index","(RI)","and","Adjusted","Rand","Index","(ARI)\nA","traditional","criterion","for","measuring","the","accuracy","of","clustering","is","the","Rand\nIndex","(RI),","which","was","proposed","by","Rand","[1971].","","Consider","a","set","of","n","elements\n10\n\nAlgorithm","2Hierarchical","Variable","Clustering\n1:input:D\nn×k\n2:C\nm\n←{},Q←〈〉.","Q,c\nm\n:","","set","operator\n3:whilek",">0do.At","least","one","cluster\n4:C←{C\nk\n2\n}.Cases","ofkchoose","2\n5:for","each(c\n1\n,c\n2\n)⊆Cdo\n6:d←D(c\n1\n,c\n2\n).Dissimilarity","ofc\n1\nandc\n2\n7:Q〈d〉","←(c\n1\n,c\n2\n).Insertd,","(c\n1\n,c\n2\n)","intoQ\n8:(c\na\n,c\nb\n)←Q〈min(d)〉.Take","minimum","value\n9:C\nm\n←C\nm\n∪(c\na\n,c\nb\n).Insert","(c\na\n,c\nb\n)","intoC\nm\n10:C[(c\na\n,c\nb\n)]←C[c\na\n∪c\nb\n].Replace{c\na\n,c\nb\n}\n11:k←k−1.Now","we","have","k-1","variables\n12:return:C\nm\n.The","partition","of","a","cluster\nW={w\n1\n,w\n2\n,...,w\nn\n},","defineX={x\n1\n,x\n2\n,...,x\nS\n}represents","the","true","informa-\ntion","of","categories","andY={y\n1\n,y\n2\n,...,y\nJ\n}represents","the","clusters","forX,\n∪\nS\ns=1\nx\ns\n=∪\nJ\nj=1\ny\nj\n=W\nx\ns\n∩x\ns\n′\n=y\nj\n∩y\nj\n′\n=∅\nwhere","1≤s6=s\n′\n≤Sand","1≤j6=j\n′\n≤J.","","Suppose","the","True","Positive","(TP)\nis","the","pairs","of","element","inXand","also","inY,","and","the","True","Negative","(TN)","is","the\npairs","of","element","not","inXand","also","not","inY.","","The","Rand","Index","(RI)","is","defined","as\nRI","=\nTP+TN\nC\nn\n2\n(2.14)\nwhereC\nn\n2\nis","the","total","combination","of","pairs","elements,","and","RI∈[0,1],","the","larger\nsize","of","RI,","the","better","performance","of","clustering.\nEven","though","Rand","Index","(RI)","can","be","measured","the","outcomes","of","clustering,\nfor","two","stochastic","partitions,","the","expected","value","of","them","must","be","greater","than\nor","","equal","","to","","zero,","","which","","is","","not","","a","","constant","","value.","","","Hubert","","and","","Arabie","","[1985]\nproposed","the","Adjusted","Rand","Index","(ARI)","based","on","generalized","hypergeometric\ndistribution,","and","it","is","defined","as\nARI","=\nRI−E(RI)\nmax(RI)−E(RI)\n(2.15)\nSupposen\nij\ninWis","the","number","of","elements","that","are","also","inXandY.","","Thus,\nthe","expression","of","TP+TN","can","be","simplified","as\n∑\ni,j\nC\nn\nij\n2\nandE(\n∑\ni,j\nC\nn\nij\n2\n)","=\n∑\ni\nC\nn\ni.\n2\n∑\nj\nC\nn\n.j\n2\nC\nn\n2\n.","","After","some","algebra","works,","Hubert","and","Arabie","[1985]","simplified\nARI","as\nARI","=\n∑\ni,j\nC\nn\nij\n2\n−[\n∑\ni\nC\nn\ni.\n2\n∑\nj\nC\nn\n.j\n2\n]/C\nn\n2\n[\n∑\ni\nC\nn\ni.\n2\n+\n∑\nj\nC\nn\n.j\n2\n]/2−[\n∑\ni\nC\nn\ni.\n2\n∑\nj\nC\nn\n.j\n2\n]/C\nn\n2\nThe","expected","value","of","ARI","is","zero","since","the","range","of","ARI","lies","on","[−1,1].","","There-\nfore,","the","values","that","can","be","taken","on","ARI","has","wider","range","than","it","on","RI.","Hence,\nARI","is","preferred","than","RI","to","measure","the","clustering","performance.\n11\n\n2.5.5","","","","Stability","of","Variable","Clustering\nSupposem∈Mis","the","optimal","number","of","clusters","fromM={2,3,...,p−1}\nin","","a","","datasetD\nn×p\n.","","","The","","optimal","","number","","of","","clustersmis","","determined","","by","","the\nmean","of","ARI","fromJtimes","of","the","bootstrap","withnsample","for","each","time.","","The\nalgorithm","of","findingmis","defined","as","(Note:","","Suppose","a","functioncutreehas","been\nproduced","to","cut","the","dendrogram)\nAlgorithm","3Stability","of","Clustering\n1:input:D\nn×p\n,J\n2:Q←[","","].","Q:","","An","array","for","mean","of","ARI\n3:C\nm\n←clust(D\nn×p\n).Initial","hierarchy\n4:fori←2,3,...,k−1do\n5:q←[","","].","q:","","An","array","for","ARI\n6:forj←1,2,3...,Jdo\n7:C\nij\n←cutree(C\nm\n,i).Cut","dendrogram\n8:q[j]←ARI(C\nij\n,C\nm\n).Compute","ARI\n9:Q[i]←Avg(q).Compute","the","avergae","of","ARI\n10:return:","","index","of","max(Q)\nTherefore,","","following","the","algorithms","of","the","variable","clustering,","","the","steps","of\nvariable","","clustering","","can","","be","","clearly","","expressed","","as","","Figure","","2,","","which","","displays","","the\nflow","task","of","clustering.","","Each","general","step","has","been","shown","and","discussed","from\nAlgorithm","1-3","in","above","sections.\nStart:","","Data","(pclusters)\nPerform","Hierarchical","clustering\nFor","each","possible","cluster","size,takeJbootstrap\nsamples","ofnobservations,","get","dendrograms\nCompare","the","partitions","of","theseJ\ndendrograms","with","initial","hierarchy","via","ARI\nCut","dendrogram","based","on","stability\nEnd:","","The","cluster","output\nFigure","2:","","Flow","Task","of","Variable","Clustering\n3","","","","Two-Stage","Group","Variable","Selection\nWe","propose","a","two-stage","approach","for","group","variable","selection","in","both","regres-\nsion","and","classification","models.","The","first","stage","involves","variable","clustering","via","the\nPCAMIX","hierarchical","clustering","method,","and","the","second","stage","if","the","traditional\ngroup","variable","selection","approaches.","","This","method","works","well","if","the","the","number\nof","predictors","is","relatively","small.","","When","the","number","of","predictors","is","much","larger\n12\n\nthan","the","number","of","observations,","especially","for","ultrahigh","dimensional","data,","the\nvariable","clustering","could","be","computational","expensive","and","inaccurate,","especially\nfor","stability","of","variable","clustering,","which","involves","the","bootstrap","procedure.","","To\ndeal","with","such","challenge,","we","adjust","the","first","stage","by","first","using","variable","screen-\ning","methods","to","keep","a","small","subset","of","the","predictors,","then","conduct","the","variable\nclustering.","","Specifically,","we","use","a","distance","correlation","based","variable","screening\nmethod","","(DC-SIS,","","Li","","et","","al.","","[2012])","","which","","will","","be","","introduced","","in","","more","","detail","","in\nSection","3.1.","","The","following","is","the","two-stage","group","variable","selection","algorithm.\nAlgorithm","4Two-Stage","Group","Variable","Selection\ninput:Dataset","(X\nn×p\n,Y\nn×1\n)\nsteps:\nstage","1:\ncase","1:p\u001dn\n1.","Perform","DC-SIS","on","dataset","(X\nn×p\n,Y\nn×1\n),","denoted","it","asX\nn×q\n,","whereq∈p.\n2.","","Perform","the","hierarchical","variable","clustering.\n3.","","Choose","a","optimal","number","of","clusters","based","on","clustering","stability,","denoted\nclusters","asC\n1\n,C\n2\n,···,C\nm\n.\ncase","2:p","<","n\n1.","","Skip","step","1","instage","1and","repeat","step","2-3.\nstage","2:\n1.","","Run","group","regularization","modelMwith","group","structureC\n1\n,C\n2\n,···,C\nm\n.\n2.\nˆ\nX\nn×l\nis","a","set","of","selected","variables,l∈q.\nreturn\nˆ\nX\nn×l\n3.1","","","","Variable","Screening\nIn","ultrahigh","dimensional","data,","where","the","number","of","predictors","are","extremely\nlarge,","the","regularization","models","may","not","be","precisely","performed","because","of","the\ncomputational","expensive","and","stability","of","algorithm.","","Variable","screening,","which\nis","also","known","as","variable","pre-selection,","such","as","genomics","data,","can","sufficiently\nreduce","the","variable","dimension","to","help","with","the","performance","in","terms","of","variable\nselection.\n3.1.1","","","","Sure","Independence","Screening","(SIS)\nSure","","screening","","represents","","the","","variables","","after","","applying","","variable","","screening.\nFan","","and","","Lv","","[2008]","","proposed","","a","","correlation","","learning","","method","","based","","on","","Pearson\ncorrelation,","such","that\nρ\nx,y\n=\n∑\nn\ni\n(x\ni\n−","̄x)(y\ni\n−","̄y)\n√\n∑\nn\ni\n(x\ni\n−","̄x)\n√\n∑\nn\ni\n(y\ni\n−","̄y)\n(3.1)\nnamed","as","Sure","Independence","Screening","(SIS),","to","reduce","the","dimension","of","pre-\ndictors","space","based","on","Pearson","correlation.","","The","general","procedure","of","SIS","is","to\nrank","the","Pearson","correlation","between","each","predictorsXand","responseY,","then\ncompute","the","minimum","model","size","that","include","all","active","variables,","denoted","as\nS.","","The","smaller","value","ofS,","the","better","performance","of","screening.\n13\n\n3.1.2","","","","Distance","Correlation","-","Sure","Independence","Screening","(DC-SIS)\nIn","","nonlinear","","cases,","","even","","Pearson","","correlation","","is","","0,","","there","","are","","no","","sufficient\nevidences","","to","","determine","","two","","random","","variables","","are","","independent.","","","Sz","́ekely","","et","","al.\n[2007]","introduced","the","distance","correlation","to","address","the","deficiency","of","Pearson\ncorrelation.","","","Define","","the","","distance","","correlation","","of","","two","","random","","vectorsuandv\ndenoted","asη\nu,v\n,","such","that\nˆη\nu,v\n=\nˆ\ndcov(u,v)\n√\nˆ\ndcov(u,u)\nˆ\ndcov(v,v)\n(3.2)\nwhere\nˆ\ndcov(u,v)","=\nˆ\nS\n1\n+\nˆ\nS\n2\n−2\nˆ\nS\n3\n,","and\nˆ\nS\n1\n,\nˆ\nS\n2\n,\nˆ\nS\n3\nare","defined","as\nˆ\nS\n1\n=\n1\nn\n2\nn\n∑\ni=1\nn\n∑\nj=1\n||u\ni\n−u\nj\n||\np\n||v\ni\n−v\nj\n||\nq\nˆ\nS\n2\n=\n1\nn\n2\nn\n∑\ni=1\nn\n∑\nj=1\n||u\ni\n−u\nj\n||\np\n1\nn\n2\nn\n∑\ni=1\nn\n∑\nj=1\n||v\ni\n−v\nj\n||\nq\nˆ\nS\n3\n=\n1\nn\n2\nn\n∑\ni=1\nn\n∑\nj=1\nn\n∑\nl=1\n||u\ni\n−u\nl\n||\np\n||v\nj\n−v\nl\n||\nq\nwhereq,prepresents","the","dimensions","of","u","and","v,","","respectively.","","From","equation\n(3.2),\nˆ\ndcov(u,v)","=","0","if","and","only","if","two","random","vectorsuandvare","independent.\nLi","et","al.","[2012]","proposed","a","distance","correlation","learning","method","that","combines\ndistance","correlation","and","SIS,","so","called","Distance","Correlation","-","Sure","Independence\nScreening","(DC-SIS).","The","algorithm","of","DC-SIS","are","very","similar","to","SIS,","it","uses\ndistance","","correlation","","as","","a","","criterion","","for","","ranking","","instead","","of","","Pearson","","correlation.\nHence,","the","general","algorithm","of","variable","screening","is","defined","as\nAlgorithm","5Variable","Screening\n1:input:X\nn×p\n,Y\nn×1\n2:Q←[","","].","Q:","","An","array\n3:F←[f\n1\n,f\n2\n,f\n3\n,...,f\np\n].","F:","","Variable","name\n4:d←k\nn\nlog(n)\n.","k",">0\n5:fori←1,2,3,...,pdo.x\nn×i\n⊆X\nn×p\n6:Q[i]←ρ\nx\nn×i\n,Y\nn×1\nor","","ˆη\nn×i,Y\nn×1\n.","ρor","ˆη\n7:W←Q|F.CONCAT","Q","and","F\n8:W←Sort(W).SortWbyQwith","descending\n9:return:W[:d].Output","topdth","rows\n4","","","","Simulation","Studies\nIn","this","section,","we","numerically","explore","the","expediency","of","two-stage","variable\nselection","","method,","","as","","well","","as","","to","","compare","","the","","performance","","of","","different","","group\nvariable","selection","methods.","","We","consider","five","simulation","settings","with","unequal\ndimensions","of","feature","space","to","compare","the","performance","of","regularization","models\n14\n\nwith","different","grouping","information.","In","simulation","studies,","we","generate","a","dataset\nfrom","the","linear","model","(1.1)","and","logistic","model","(1.3)","with","block","diagonal","matrices\nand","variables","in","each","block","are","correlated.","","The","regression","noise","for","linear","model\nis","denoted","by\u000f∼N(0,σ\n2\n),","whereσ\n2\nis","chosen","with","signal-to-noise","ratio","equals\n1.8","(adopted","from","Yuan","and","Lin","[2006])","for","each","regression","case.","","We","denote\nsome","notations","of","metric","for","reporting,","and","they","are","defined","as\na.","","We","consider","the","root","mean","square","error","(RMSE)","as","the","prediction","per-\nformance","in","regression","problem,","which","is","defined","as\nRMSE","=\n√\n√\n√\n√\n1\nn\nn\n∑\ni=1\n(Y\ni\n−\nˆ\nY\ni\n)(4.1)\nwherenis","the","number","of","observations,y\ni\nand","","ˆy\ni\nrepresent","the","true","value","and\npredicted","value","of","response,","individually.","","We","also","consider","the","accuracy,","sensi-\ntivity,","specificity","and","the","area","under","the","curve","(AUC)","as","prediction","performance\nin","classification","problem.\nb.","","The","another","sensitivity","and","specificity","as","measure","of","variable","selection\nperformance","are","defined","as\nSensitivity","=\n|U∩\nˆ\nU|\n|T|\n(4.2)\nSpecificity","=\n|V∩\nˆ\nV|\n|T|\n(4.3)\nwhereU={i:β\ni\n6=","","0,i=","","1,2,···,p},\nˆ\nU={i:\nˆ\nβ\ni\n6=","","0,i=","","1,2,···,p},\nV={i:β\ni\n=","","0,i=","","1,2,···,p},\nˆ\nV={i:\nˆ\nβ\ni\n=","","0,i=","","1,2,···,p},","","and\nT={i:β\ni\n,i=","1,2,···,p}.\nWe","compare","each","simulation","with","two","different","cases","that","case","1","is","designed\nas","randomly","define","a","grouping","information","with","equal","group","size","while","case","2","is\nwith","applying","two-stage","variable","selection.","","We","run","50","bootstraps","for","choosing\noptimal","ARI","for","stability","of","variable","clustering","and","repeat","each","simulation","500\ntimes","through","parallel","computing","and","report","the","several","average","of","prediction\nmeasures,","variable","selection","performance","and","computational","time","from","10-fold\ncross","validation.","We","use","R","to","do","the","computational","work","for","each","simulation,","the\nR","packages","of","“ClustOfVar”","(Chavent","et","al.","[2011])","and","“energy”","(Rizzo","et","al.\n[2019])","are","applied","for","variable","clustering","and","variable","screening","and","“grpreg”\n(Breheny","","et","","al.","","[2020])","","and","","“SGL”","","(Simon","","et","","al.","","[2018])","","are","","applied","","for","","each\ngroup","regularization","model.\n4.1","","","","Simulation","1:","","Dimension(100×30)\nWe","generate","then×pdimensional","predictorX∼MV","N(0,Σ\np×p\n)","withn=\n100","andp=","30,","and","Σ\np×p\nis","a","diagonal","block","matrix","betweenX\ni\nandX\nj\nbeing\nρ\n|i−j|\n,","whereρis","a","sequence","from","0.1","to","0.9","by","0.05.","","Each","block","is","independent\nwith","its","sizeS={3,4,4,3,4,3,4,3,2}.","","ResponseYis","simulated","from","equation\n(2.4)","corresponding","to","the","true","active","groupsG={G\nT\n1\n,G\nT\n2\n,G\nT\n4\n,G\nT\n5\n,G\nT\n6\n,G\nT\n9\n},\n15\n\nwhereG\ni\n⊆Gis","defined","as\nG\n1\n={β\n1\n,β\n2\n,β\n3\n}={0.1,0,8}\nG\n2\n={β\n4\n,β\n5\n,β\n6\n,β\n7\n}={0.4,0.3,0.2,7}\nG\n4\n={β\n12\n,β\n13\n,β\n14\n}={4,5,6}\nG\n5\n={β\n15\n,β\n16\n,β\n17\n,β\n18\n}={3,0,0.5,0}\nG\n6\n={β\n19\n,β\n20\n,β\n21\n}={0.2,0.4,0.6}\nG\n9\n={β\n29\n,β\n30\n}={9,10}\nThe","","results","","of","","simulation","","1","","are","","summarized","","in","","figure","","3-5.","","","We","","notice","","that\neven","though","model","with","random","group","structure","achieves","higher","a","sensitivity\nscore","than","the","model","with","applying","two-stage","variable","selection,","they","achieve","a\nrelative","low","score","for","specificity.","Hence,","we","observe","that","the","group","regularization\nmodel","with","random","group","structure","does","not","correctly","remove","the","inactive","vari-\nables","instead","it","tends","to","build","a","full","model.","","However,","the","model","with","applying\ntwo-stage","variable","selection","achieve","a","solid","specificity","score","and","an","acceptable\nsensitivity","","score,","","where","","group","","Lasso","","and","","group","","MCP","","have","","highest","","sensitivity\nand","specificity,","respectively.","","Figure","2-3","are","also","indicated","each","model","tends","to\ncorrectly","remove","more","inactive","variables","with","correlation","increases","after","apply-\ning","two-stage","variable","selection.","","We","also","notice","that","the","RMSE","of","each","model\ndecreases","with","","correlation","increases,","","and","each","model","with","","applying","","two-stage\nvariable","selection","achieves","lower","RMSE","than","them","with","random","group","struc-\nture.","","In","general,","the","sparse","group","Lasso","has","best","performance","than","others","in\nterms","of","lowest","RMSE.\nFigure","3:","","Sensitivity","of","Variable","Selection","Performance\n16\n\nFigure","4:","","Specificity","of","Variable","Selection","Performance\nFigure","5:","","RMSE","with","10-fold","Cross","Validation\n4.2","","","","Simulation","2:","","Dimension(100×50)\nIn","","this","","section,","","we","","consider","","to","","simulate","","a","","dataset","","involving","","both","","contin-\nuous","","and","","discrete","","variables.","","","Suppose","","each","","group","","sizeSis","","defined","","asS=\n{6,7,8,9,10,10},","andS\n1\n,S\n2\n⊆S,","such","thatS\n1\n={6,8,10},S\n2\n={7,9,10}and\n|S\ni\n|=\n∑\ns∈S\ni\ns.","","VariablesX\nn×|S\n1\n|\nare","generated","with","same","method","as","simulation\n1","while","variablesX\nn×|S\n2\n|\nare","defined","as","block","variableX\ni∈S\n2\n=","(U\ni∈S\n2\n+W)/\n√\n2\n(refer","to","Yuan","and","Lin","[2006]),","","whereUandWare","independently","generated\nfrom","","a","","standard","","normal","","distribution.","","","We","","define","","three","","types","","of","","variable","","with\n17\n\nrepeat","order","ofS,","they","are","generated","as","continuous,","discrete","and","mix","(continu-\nous","and","discrete)","where","the","discrete","variables","are","trichotomized","if","it","is","smaller\nthan\n1\n3\nquantile,","between\n1\n3\nand\n2\n3\n,","larger","than\n2\n3\nfrom","continuous","variables","and\nmix","variables","are","following","one","by","one","repeat","order.","","ResponseYis","generated\nfrom","equation","(2.4)","with","the","true","active","groupsG={C\nT\n1\n,C\nT\n3\n,C\nT\n4\n,C\nT\n6\n},","and","we\ndefineG\ni\n⊆Gas\nG\n1\n={β\n1\n,β\n2\n,β\n3\n,β\n4\n,β\n5\n,β\n6\n}\nG\n3\n={β\n14\n,β\n16\n,β\n18\n,β\n20\n}\nG\n4\n={β\n23\n,β\n24\n,β\n25\n,β\n26\n,β\n27\n,β\n28\n}\nG\n6\n={β\n46,I(1)\n,β\n48,I(2)\n,β\n50,I(2)\n}\nwhereβ\ni\n∼U(−5,5)","andI(·)","is","the","indicate","function","represented","for","discrete\nvariables.","","We","repeat","same","cases","as","simulation","1","and","report","each","performance\nmeasurement","with","typical","correlationsρ={0.2,0.5,0.8}.\nThe","","results","","of","","simulation","","2","","are","","displayed","","in","","table","","1.","","","We","","end","","with","","a","","very\nsimilar","conclusion","as","it","in","simulation","1","that","model","with","two-stage","variable","se-\nlection","is","performed","better","than","it","with","random","group","structure","because","of","lower\nRMSE.","For","the","model","with","two-stage","strategy,","highest","sensitivity","and","specificity\nscore","a","given","by","the","group","Lasso","and","group","MCP,","respectively.","","The","group","MCP\nalso","achieves","lowest","RMSE","comparing","with","others.\n4.3","","","","Simulation","3:","","Dimension(100×150)\nWe","consider","simulation","3","with","same","process","as","simulation","2","but","we","extend\nthe","number","of","group","ofSby","repeating","three","times","and","is","therefore","the","number","of\ndimension","are","higher","than","the","number","of","observation,","i.e,p",">","n.","","We","set","active\ntrue","active","groups","asG={G\nT\n1\n,G\nT\n3\n,G\nT\n4\n,G\nT\n6\n,G\nT\n12\n,G\nT\n18\n},","andG\ni\n⊆G,","which","is\ndefined","as\nG\n1\n={β\n1\n,β\n2\n,β\n3\n}\nG\n3\n={β\n14\n,β\n16\n,β\n18\n}\nG\n4\n={β\n23\n,β\n24\n,β\n25\n,β\n26\n,β\n27\n,β\n28\n}\nG\n6\n={β\n46,I(1)\n,β\n48,I(2)\n,β\n50,I(2)\n}\nG\n12\n={β\n91\n,β\n93\n,β\n95\n,β\n100,I(1)\n}\nG\n18\n={β\n150,I(1)\n,β\n150,I(2)\n}\nwhereβ\ni\n∼U(−7,7)","andI(·)","represents","the","indicate","function","same","as","the","one\nin","simulation","2.\nTable","2","displays","the","performance","of","simulation","3.","","We","find","that","the","models\ntend","to","blindly","remove","most","of","variables.","","Hence,","the","performance","of","variable","se-\nlection","becomes","impractical","in","terms","of","selection","correctness","and","computational\ntime","","(table","","5)","","since","","variable","","clustering","","is","","not","","performing","","well","","with","","datasets\nhaving","a","relatively","large","dimension.\n4.4","","","","Simulation","4:","","Dimension(200×2000)\nIn","this","example,","we","investigate","a","simulation","on","ultrahigh","dimension","of","vari-\nable","","space.","","","The","","variable","","clustering","","method","","does","","not","","perform","","well","","for","","large\n18\n\nTable","1:","","Performance","Measure","for","Simulation","2\nModelρRMSESensitivitySpecificity\ncase","1:model","with","random","equal","size","group\ngrLasso\n0.20.87","(0.04)0.69","(0.08)0.58","(0.11)\n0.50.87","(0.04)0.68","(0.10)0.59","(0.11)\n0.80.87","(0.04)0.68","(0.10)0.60","(0.09)\ngrSCAD\n0.20.91","(0.06)0.65","(0.30)0.67","(0.15)\n0.50.90","(0.06)0.66","(0.28)0.66","(0.15)\n0.80.89","(0.05)0.74","(0.19)0.63","(0.10)\ngrMCP\n0.20.91","(0.06)0.64","(0.30)0.67","(0.16)\n0.50.91","(0.06)0.65","(0.30)0.67","(0.15)\n0.80.89","(0.05)0.73","(0.20)0.63","(0.11)\nSGL\n0.20.83","(0.04)0.61","(0.10)0.68","(0.12)\n0.50.81","(0.03)0.56","(0.11)0.72","(0.11)\n0.80.81","(0.04)0.53","(0.10)0.74","(0.11)\ncase","2:model","with","two-stage","strategy\ngrLasso\n0.20.71","(0.06)0.71","(0.18)0.65","(0.18)\n0.50.70","(0.03)0.71","(0.20)0.71","(0.18)\n0.80.69","(0.03)0.80","(0.11)0.70","(0.16)\ngrSCAD\n0.20.66","(0.08)0.57","(0.22)0.79","(0.14)\n0.50.65","(0.04)0.54","(0.21)0.83","(0.10)\n0.80.65","(0.04)0.72","(0.17)0.78","(0.10)\ngrMCP\n0.20.67","(0.08)0.56","(0.24)0.79","(0.16)\n0.50.66","(0.04)0.54","(0.21)0.83","(0.10)\n0.80.65","(0.04)0.72","(0.18)0.78","(0.10)\nSGL\n0.20.70","(0.03)0.61","(0.10)0.68","(0.11)\n0.50.70","(0.04)0.56","(0.11)0.72","(0.11)\n0.80.69","(0.03)0.53","(0.10)0.74","(0.12)\nnumber","of","variables,","we","consider","to","apply","the","second","case","in","two-stage","variable\nselection.","","The","datasetX\nn×p\n∼MV","N(0,Σ\np×p\n),","wheren=","200","andp=","2000\nare","generated","with","same","setting","as","it","in","simulation","1","but","with","larger","group","sizeS\nfor","each","group,","such","thatS={6,7,8,9,10,10}\n40\n(repeat","40","times)","The","response\nYis","generated","corresponding","to","the","active","true","groupG={G\nT\n1\n,G\nT\n3\n,G\nT\n5\n,G\nT\n6\n},\nandGis","defined","as\nG\n1\n={c\n1\nβ\n1\n,c\n2\nβ\n2\n,c\n3\nβ\n3\n,c\n4\nβ\n4\n,c\n5\nβ\n5\n,c\n6\nβ\n6\n}\nG\n3\n={c\n15\nβ\n15\n,c\n16\nβ\n16\n,c\n17\nβ\n17\n}\nG\n5\n={c\n31\nβ\n31\n,c\n32\nβ\n32\n,c\n33\nβ\n33\n}\nG\n6\n={c\n46\nβ\n46\n,c\n47\nβ\n47\n,c\n48\nβ\n48\n}\nWe","chooseβ\nj\n=","(−1)\nW\n(η+|Z|),c\nj\n∼U(0.5,3)","andc\nj\nβ\nj\n∈G(adopted","from","Li\net","al.","[2012]),","whereW∼Bernoulli(0,4),Z∼N(0,1)","andη=","4log(n)/\n√\nn.\nFigure","6","and","7","depict","the","selection","performance","with","correlation","increasing\nin","","terms","","of","","sensitivity,","","specificity","","and","","RMSE.","","The","","performance","","for","","applying\ntwo-stage","","variable","","selection","","appears","","much","","more","","robust","","than","","the","","performance\nwith","random","group","structure.","","Particularly,","the","specificity","for","each","model","with\napplying","two-stage","is","overlapped","because","of","excellent","performance","on","correctly\nremoving","inactive","variables,","while","the","model","with","random","structure","displays","a\n19\n\nTable","2:","","Performance","Measure","for","Simulation","3\nModelρRMSESensitivitySpecificity\nmodel","with","two-stage","strategy\ngrLasso\n0.20.98","(0.15)0.23","(0.12)0.89","(0.10)\n0.50.95","(0.12)0.25","(0.12)0.88","(0.11)\n0.80.94","(0.13)0.27","(0.11)0.86","(0.12)\ngrSCAD\n0.20.93","(0.15)0.11","(0.09)0.96","(0.03)\n0.50.99","(0.13)0.17","(0.09)0.95","(0.04)\n0.80.95","(0.12)0.13","(0.13)0.94","(0.05)\ngrMCP\n0.20.94","(0.15)0.08","(0.08)0.97","(0.04)\n0.50.89","(0.15)0.14","(0.10)0.96","(0.04)\n0.80.88","(0.12)0.11","(0.12)0.94","(0.05)\nSGL\n0.20.85","(0.07)0.25","(0.08)0.83","(0.07)\n0.50.84","(0.08)0.26","(0.07)0.83","(0.07)\n0.80.84","(0.08)0.32","(0.08)0.80","(0.06)\nlarge","heteroscedasticity","on","its","variability.","","The","density","of","sensitivity","and","speci-\nficity","in","figure","5","also","indicate","that","there","is","less","statistical","dispersion","for","the","model\nwith","applying","two-stage","than","the","model","with","random","group","structure.","","Besides,\nthe","","models","","with","","applying","","two-stage","","have","","lower","","RMSE","","than","","its","","with","","random\ngroup","structure,","","and","we","notice","that","the","group","Lasso","with","applying","two-stage\nvariable","selection","achieves","the","best","overall","performance","comparing","to","others","in\nterms","of","these","three","measurements.\nFigure","7:","","RMSE","with","10-fold","Cross","Validation\n4.5","","","","Simulation","5:","","Dimension(200×400)\nIn","this","simulation","setting,","we","consider","the","performance","of","group","regulariza-\ntion","models","in","classification","problem.","","The","structure","information","of","variableX\nwithρ=","","0.2,0.5","","and","","0.8,","","and","","the","","active","","groups","","information","","are","","determined\nfollowing","same","setting","in","simulation","4","but","with","different","group","sizeS,","such","that\nS={6,7,8,9,10,10}×8","(repeat","8","times).","","The","responseY(refer","to","Sheng","and\n20\n\nFigure","6:","","Performance","Measurement","for","Simulation","4\nYin","[2013])","is","defined","as\nP(Y=","1|X)","=\nexp{g(Xcβ)}\n1","+","exp{g(Xcβ)}\ng(Xcβ)","=\nexp{5Xcβ−2}\n1","+","exp{5Xcβ−3}\n−1.5\nwherecβare","the","active","coefficients","in","simulation","4.\nTable","","3","","and","","table","","4","","display","","the","","performance","","of","","simulation","","5.","","","We","","come\nup","","with","","same","","conclusion","","as","","it","","in","","regression","","type","","that","","the","","model","","with","","two-\nstage","","variable","","selection","","has","","better","","performance","","than","","the","","model","","with","","random\nequal","","size","","group","","in","","terms","","of","","each","","prediction","","measure","","in","","table","","4","","and","","variable\nselection","performance","in","table","3.","","In","two-stage","case,","","group","MCP","achieves","the\nbest","","performance","","based","","on","","highest","","AUC","","score","","and","","excellent","","performance","","of\nvariable","selection.\n21\n\nTable","3:","","Performance","of","Variable","Selection","for","Simulation","5\nModelρSensitivitySpecificity\ncase","1:model","with","random","equal","size","group\ngrLasso\n0.20.48","(0.10)0.92","(0.06)\n0.50.51","(0.13)0.89","(0.05)\n0.80.59","(0.12)0.86","(0.06)\ngrSCAD\n0.20.46","(0.12)0.90","(0.07)\n0.50.53","(0.12)0.90","(0.06)\n0.80.56","(0.12)0.88","(0.07)\ngrMCP\n0.20.46","(0.12)0.89","(0.07)\n0.50.53","(0.12)0.90","(0.06)\n0.80.55","(0.11)0.89","(0.07)\nSGL\n0.20.51","(0.11)0.85","(0.09)\n0.50.57","(0.11)0.85","(0.07)\n0.80.61","(0.11)0.84","(0.08)\ncase","2:","","model","with","two-stage\ngrLasso\n0.20.55","(0.09)0.90","(0.02)\n0.50.58","(0.09)0.92","(0.02)\n0.80.65","(0.08)0.93","(0.02)\ngrSCAD\n0.20.52","(0.10)0.91","(0.01)\n0.50.57","(0.10)0.92","(0.01)\n0.80.62","(0.08)0.93","(0.01)\ngrMCP\n0.20.52","(0.08)0.93","(0.02)\n0.50.58","(0.08)0.93","(0.02)\n0.80.62","(0.08)0.94","(0.01)\nSGL\n0.20.59","(0.08)0.87","(0.05)\n0.50.60","(0.08)0.89","(0.05)\n0.80.65","(0.07)0.90","(0.05)\n22\n\nTable","4:","","Prediction","Performance","for","Simulation","5\nModelAccuracySensitivitySpecificityAUC\nρ=","0.2\ncase","1:","","model","with","random","equal","size","group\ngrLasso0.56","(0.10)0.48","(0.11)0.59","(0.11)0.58","(0.11)\ngrSCAD0.53","(0.11)0.50","(0.12)0.57","(0.11)0.60","(0.10)\ngrMCP0.55","(0.10)0.49","(0.12)0.58","(0.12)0.61","(0.13)\nSGL0.52","(0.13)0.52","(0.11)0.53","(0.12)0.59","(0.11)\ncase","2:","","model","with","two-stage\ngrLasso0.61","(0.08)0.56","(0.08)0.64","(0.08)0.64","(0.08)\ngrSCAD0.61","(0.09)0.53","(0.10)0.68","(0.09)0.65","(0.08)\ngrMCP0.60","(0.08)0.53","(0.09)0.68","(0.08)0.63","(0.08)\nSGL0.63","(0.07)0.61","(0.08)0.62","(0.10)0.62","(0.07)\nρ=","0.5\ncase","1:","","model","with","random","equal","size","group\ngrLasso0.55","(0.11)0.47","(0.12)0.59","(0.11)0.57","(0.12)\ngrSCAD0.56","(0.11)0.49","(0.10)0.60","(0.12)0.58","(0.12)\ngrMCP0.56","(0.12)0.49","(0.11)0.60","(0.11)0.61","(0.11)\nSGL0.58","(0.10)0.50","(0.11)0.61","(0.10)0.60","(0.12)\ncase","2:","","model","with","two-stage\ngrLasso0.62","(0.08)0.57","(0.09)0.65","(0.08)0.63","(0.08)\ngrSCAD0.63","(0.07)0.55","(0.11)0.68","(0.10)0.65","(0.07)\ngrMCP0.65","(0.08)0.59","(0.09)0.70","(0.11)0.68","(0.09)\nSGL0.62","(0.07)0.62","(0.11)0.61","(0.11)0.66","(0.07)\nρ=","0.8\nModelAccuracySensitivitySpecificityAUC\ncase","1:","","model","with","random","equal","size","group\ngrLasso0.56","(0.12)0.51","(0.13)0.60","(0.11)0.65","(0.12)\ngrSCAD0.59","(0.11)0.48","(0.11)0.62","(0.12)0.63","(0.11)\ngrMCP0.57","(0.11)0.47","(0.12)0.63","(0.12)0.65","(0.11)\nSGL0.60","(0.11)0.55","(0.11)0.61","(0.11)0.65","(0.10)\ncase","2:","","model","with","two-stage\ngrLasso0.66","(0.09)0.61","(0.08)0.69","(0.08)0.70","(0.07)\ngrSCAD0.66","(0.08)0.59","(0.10)0.71","(0.09)0.71","(0.09)\ngrMCP0.67","(0.08)0.64","(0.09)0.72","(0.10)0.71","(0.09)\nSGL0.65","(0.07)0.63","(0.08)0.66","(0.10)0.69","(0.07)\n1\nAccuracy,","Sensitivity","and","Specificity","are","measured","based","on","0.5\n(default)","decision","cutoff.\n23\n\n4.6","","","","Computation","Time\nIn","this","section,","we","report","the","computing","time","for","each","simulation","with","with\none","correlation","and","repeating","500","times.","","The","computation","work","is","performed\nthrough","high","performance","computing","(HPC)","in","Miami","Redhawk","Cluster,","and\ntable","5","displays","the","computing","time","for","each","simulation.","","Miami","University","HPC\ncluster","contains","26","compute","nodes,","","each","node","has","24","CPU","cores,","","and","a","node\nwith","24","cores","is","used","for","the","simulations.","We","report","the","user,","system","and","elapsed\ntime,","where","the","user","and","system","stands","for","the","total","time","of","the","OS","from","user\nand","elapsed","stands","for","the","real","time","once","the","running","process","was","started.","","We\nnoticed","that","when","number","of","variables","close","top=","150,","","the","computing","time\nbecomes","","relative","","long","","if","","only","","apply","","for","","variable","","clustering,","","instead","","two-stage\nstrategy","with","pre-screening","and","variable","clustering","can","efficiently","improve","the\ncomputing","time","for","large","number","of","variable","space.\nTable","5:","","Computing","Time","for","500","Runs","(Unit:","","Second)\nSimulationDimensionUserSystemElapsed\ncase","1:model","with","random","equal","size","group\n1100×3042.80.925.6\n2100×50102.32.3116.2\n3100×150302.22.5428.1\n4200×20001729.32.85466.5\n5200×400709.42.62422.7\ncase","2:model","with","two-stage\n1100×30461.31.2503.4\n2100×502022.86.42173.4\n3100×1507626.324.39415.0\n4200×20001493.2","","","","3.5","","","","1637.3\n5200×400178.0","","","","1.17","","","","233.8\n1\nBold","font","represents","the","time","for","pre-screening","+","clustering.\n2\nIntel","Xeon","Gold","6126","2.6","GHZ","processors,","96","GB","of","memory.\n5","","","","Real","Data","Analysis\n5.1","","","","Background\nThe","dataset","is","supported","by","Cincinnati","Children’s","Hospital","Medical","Center\nand","was","also","analyzed","in","Paterno","et","al.","[2010].","","The","goal","is","to","use","biomechan-\nical","","measures","","to","","identify","","will","","the","","athletes","","who","","recover","","the","","anterior","","cruciate\nligament","reconstruction","(ACLR)","went","on","suffer","a","second","anterior","cruciate","Liga-\nment","(ACL)","injury.","","The","original","dataset","consists","118","patients","and","135","variables,\nand","we","try","to","predict","whether","patient","is","suffered","a","second","ACL","injury,","and","the\nratio","of","the","response","is","92","(suffered","second","ACL","injury):26","(not","suffered","second\nACL","injury).","","We","apply","the","group","variable","selection","methods","for","classification.\n5.2","","","","Feature","Extraction","and","Engineering\nWe","","removed","","some","","meaningless","","variables","","that","","are","","sharing","","the","","same","","infor-\nmation","","for","","the","","response","","and","","some","","variables","","with","","large","","missing","","values","","for","","the\n24\n\nfirst","data","preprocessing","step.","","Next,","we","omitted","all","remaining","observations","with\nmissing","values","and","encoding","a","few","variables","with","discrete","structure.","","Finally,","we\nover-sampled","dataset","by","applying","Synthetic","Minority","Over-sampling","Technique\n(SMOTE),","which","was","proposed","by","Chawla","et","al.","[2002],","for","balancing","the","re-\nsponse","value.","","The","SMOTE","Algorithm","can","be","simply","defined","with","four","steps.\nThere","","are","","100","","patients","","with","","129","","variables","","with","","the","","ratio","","of","","response","","value","","is\nAlgorithm","6Synthetic","Minority","Over-sampling","Technique","(SMOTE)\ninput:a","minority","class","vector\nsteps:\n1:Set","a","sampling","ratioNbased","on","imbalance","ratio.\n2:For","each","samplexin","the","minority","class,","find","itsknearest","neighbors","using\nthe","Euclidean","distance\n3:For","each","minority","sample","pointx,","randomly","select","a","sample","point","from","k\nnearest","neighbors,","denoted","it","as","ˆx\n4:For","each","ˆx,","generate","a","new","sample","point","based","onx\nnew\n=x−R\n(0,1)\n(ˆx−x)\nreturnsynthetic","minority","class","samples\n76:24","after","omitting","all","the","missing","value","but","without","using","SMOTE.","The","num-\nber","of","patients","are","increased","to","152","with","76:76","for","response","value","if","applying\nwith","SMOTE.\n5.3","","","","Modeling\nWe","compared","the","model","performance","for","known","group","structure","and","two-\nstage","","approach","","in","","terms","","of","","prediction","","and","","variable","","selection.","","","We","","split","","data\ninto","train","set","(70%)","and","test","set","(30%),","where","the","train","set","is","used","to","find","the\noptimal","","tuning","","parameterλwith","","10-fold","","cross","","validation,","","and","","the","","test","","set","","is\nfor","measuring","the","prediction","for","different","models.","","We","also","compared","the","model\nperformance","for","original","dataset","and","the","dataset","with","applying","SMOTE","on","train\nset","and","report","the","selected","variables.\nTable","6","displays","the","prediction","performance","in","terms","of","accuracy,","sensitivity,\nspecificity","and","also","the","area","under","the","curve","(AUC)","for","based","on","10-fold","cross\nvalidation","for","each","model.","","We","notice","that","each","prediction","measurements","for","the\ndataset","with","SMOTE","are","performed","better","than","the","original","dataset.","","Compare\nto","the","prediction","measurement","for","case","1","and","case","2,","the","models","with","two-stage\napproach","are","normally","achieved","higher","score","than","the","model","with","known","group\nstructure.","","","In","","general,","","the","","group","","MCP","","has","","the","","best","","prediction","","performance\nbased","on","highest","score","of","AUC","(83%).","","Table","7","and","table","8","show","the","variables\nthat","are","selected","by","different","models","for","the","balanced","response","(SMOTE)","and\nimbalanced","response.","","We","observed","that","there","are","9","variables","(with","checkmark)\nare","commonly","selected","by","all","the","models","with","two-stage","approach","in","table","7,\nwhile","only","4","variables","are","commonly","selected","in","table","8.","","For","the","model","with\nknown","group","structure","in","both","table","7","and","table","8,","only","sparse","group","Lasso","can\nselect","partial","variables","from","the","group","of","biomechanical","variables,","","since","other\nmodels","can","only","select","a","group","of","variables","rather","than","individual","variables.\n25\n\nTable","6:","","Prediction","Measurements","for","10-fold","Cross","Validation\nModelAccuracySensitivitySpecificityAUC\nbalanced","response:","","oversampling","data","with","SMOTE\ncase","1:","","known","group","structure\ngrLasso0.710.630.760.72\ngrSCAD0.630.640.630.70\ngrMCP0.640.610.690.69\nSGL0.680.640.700.71\ncase","2:","","two-stage\ngrLasso0.740.690.830.79\ngrSCAD0.720.670.810.78\ngrMCP0.790.720.830.83\nSGL0.720.710.770.76\nimbalanced","response:","","original","data\ncase","1:","","known","group","structure\ngrLasso0.750.280.910.67\ngrSCAD0.730.140.910.65\ngrMCP0.730.140.910.65\nSGL0.690.380.790.69\ncase","2:","","two-stage\ngrLasso0.760.001.000.73\ngrSCAD0.750.010.970.71\ngrMCP0.750.010.970.71\nSGL0.650.630.660.75\n1\nAccuracy,","","Sensitivity","and","Specificity","are","measured","based","on","0.5\n(default)","decision","cutoff.\nTable","7:","","Selected","Variables","with","Over-sampled","Data\nbalance","response:","","oversampling","data\ncase","1:","","known","group","structure\nGroupgrLassogrSCADgrMCPSGL\nInjury","Information","(4)+\n∗\n+\n2\nComponent","Score","(6)+\n∗\n+\n∗\n+\n∗\n+\n3\nHop","Testing","(8)+\n1\nIsometric","Strength","(7)+\n2\nIsokinetic","Strength","(25)+\n∗\n+\n5\nKnee","Laxity","(7)+\n1\nPostural","Stability","(11)+\n∗\n+\n2\nBiomechanical","Variables","(61)+\n13\ncase","2:","","two-stage\nVariablegrLassogrSCADgrMCPSGL\nNormUnHipMomPROXIMALZIMP10X\n1\nX\n1\nX\n1\nX\n1\nNormUninvHipMomentPROXIMALZIMP10X\n1\nX\n1\nX\n1\nX\n1\nNormUnHipMomPROXIMALYIMP10X\n1\nX\n1\nX\n1\nInHipMomentPROXIMALZMINLANDX\n2\nX\n2\nX\n2\nX\n2\nHipUNX\n3\nX\n3\nX\n3\nX\n3\nDiffKneeFrontalPlaneAngYROMLANDX\n4\nX\n4\nX\n4\nX\n4\nDiffKneeFPAngYROMLANDX\n4\nX\n4\nX\n4\nX\n4\nInKneeVelDEFAULTZICX\n5\nX\n5\nX\n5\nMaleX\n6\nX\n6\nX\n6\nX\n6\nInHipMomentPROXIMALXICX\n7\nInHipPowerDISTALXICX\n7\nInHipAngleDEFAULTYMAXLANDX\n8\nX\n8\nInHipAngleDEFAULTYMINLANDX\n8\nX\n8\nInHipAngleDEFAULTYICX\n8\nInAnkleAngleDEFAULTYICX\n9\nX\n9\nX\n9\nX\n9\nInHipMomentPROXIMALZIC\nInAnkleMomentPROXIMALZMAXLAND\nInKneeMomentPROXIMALYMAXLAND\nInAnkleAngleDEFAULTXMAXLAND\nTrHavgUNX\n13\nSHavgUNX\n13\nX\n13\nKOOSqolINVX\n14\nX\n14\nX\n14\nX\n14\nLSI180extNorm\n1\n+\n∗\nand","+\nk\nindicate","selecting","all","variables","or","number","ofkvariables,","respectively.X\nk\nindicates","selecting","the","variable","ink\nth\ngroup.\n2\n(k)","indicates","the","number","of","variables","within","a","group.\n3\nVariables","are","ranked","by","distance","correlation.\n26\n\nTable","8:","","Selected","Variables","with","Original","Data\nimbalance","response:","","original","data\ncase","1:","","known","group","structure\nGroupgrLassogrSCADgrMCPSGL\nInjury","Information","(4)+\n∗\n+\n2\nComponent","Score","(6)+\n∗\n+\n∗\n+\n∗\n+\n3\nHop","Testing","(8)\nIsometric","Strength","(7)+\n∗\n+\n3\nIsokinetic","Strength","(25)+\n∗\n+\n7\nKnee","Laxity","(7)+\n1\nPostural","Stability","(11)+\n∗\n+\n2\nBiomechanical","Variables","(61)+\n17\ncase","2:","","two-stage\nVariablegrLassogrSCADgrMCPSGL\nDiffKneeFrontalPlaneAngYROMLANDX\n1\nX\n1\nX\n1\nX\n1\nDiffKneeFPAngYROMLANDX\n1\nX\n1\nX\n1\nX\n1\nInHipMomentPROXIMALYMAXLANDX\n1\nX\n1\nX\n1\nInKneeMomentPROXIMALYMAXLANDX\n1\nX\n1\nX\n1\nNormUninvHipMomentPROXIMALZIMP10X\n2\nX\n2\nX\n2\nX\n2\nNormUnHipMomPROXIMALZIMP10X\n3\nX\n3\nPSapsdIN\nInHipMomentPROXIMALZMINLAND\nHipUNX\n5\nPeakTorqueUNX\n5\nTrHavgUN\nInKneeVelDEFAULTZICX\n6\nInAnkleVelDEFAULTZIC\nLSIPTNormX\n7\nX\n7\nX\n7\nISO300extINVNormX\n8\nKOOSqolINVX\n9\nX\n9\nX\n9\nX\n9\n1\n+\n∗\nand","+\nk\nindicate","selecting","all","variables","or","number","ofkvariables,","respectively.X\nk\nindicates","selecting","the","variable","ink\nth\ngroup.\n2\n(k)","indicates","the","number","of","variables","within","a","group.\n3\nVariables","are","ranked","by","distance","correlation.\n6","","","","Discussion","and","Summary\nIn","this","paper","we","compared","the","model","performance","for","group","Lasso,","group\nSCAD,","group","MCP","and","sparse","group","Lasso.","","The","first","three","group","variable","se-\nlection","models,","can","only","select","a","group","of","variables","rather","than","each","individual\nvariables,","","while","","sparse","","group","","Lasso","","can","","select","","individual","","variables","","and","","group\nof","","variables,","","simultaneously.","","","Hence","","sparse","","group","","Lasso","","will","","be","","more","","suitable\nfor","variable","sparsity.","","Comparing","to","group","Lasso,","group","SCAD","and","group","MCP\nuse","the","nonconvex","penalty","and","achieves","the","Oracle","properties","in","terms","of","unbi-\nasedness","and","continuity.","","The","regular","group","variable","selection","methods","have","the\ndisadvantage","of","requiring","the","prior","knowledge","of","group","structure","information,\nwhich","is","a","challenging","work","for","a","raw","data","or","high","dimensional","data.","","To","deal\nwith","","this","","challenge","","we","","introduced","","a","","two-stage","","variable","","selection.","","","The","","cluster\ngroup","variable","selection","theoretically","solves","the","problem","by","seeking","for","a","best\ngroup","","structure","","before","","fitting","","the","","model,","","but","","it","","is","","also","","impractical","","for","","large\ndimension","of","variable","space","because","of","high","computational","expensive","and","low\naccuracy.","","Hence,","variable","screening","is","necessary","through","pre-selecting","the","im-\nportant","variables","from","large","variable","space","before","variable","clustering,","","since","it\nimproves","the","model","performance","in","terms","of","prediction,","variable","sparsity","and\n27\n\nspeed","of","computing.","","Our","future","work","will","be","focus","on","revising","the","algorithm","of\nvariable","clustering,","since","the","original","algorithm","belongs","to","unsupervised","learn-\ning,","","we","will","involve","a","response","variable","to","turn","the","algorithm","into","supervised\nlearning","","and","","compare","","the","","performance","","for","","them.","","","We","","will","","also","","improve","","the\ncomputing","speed","of","variable","clustering","through","applying","parallel","computing.\nIn","","this","","paper,","","comparing","","to","","traditional","","approach,","","the","","proposed","","two-stage\nvariable","selection","method","has","excellent","performance","on","variable","selection","in","high\ndimensional","variable","space,","especially","for","strong","correlated","variable","structure.\nWe","","discussed","","each","","model","","schemes","","and","","algorithm","","of","","variable","","clustering,","","and\nvariable","pre-screening","from","the","aspect","of","both","theory,","computational","studies","and\nreal","data","example.","","We","displayed","that","two-stage","approach","reduce","the","dimension\nof","variable","space,","save","the","computing","time","in","variable","clustering","and","increasing\nprediction","","accuracy","","and","","stability","","of","","variable","","selection.","","","Two-stage","","approach\ncomplements","","the","","shortcoming","","of","","traditional","","group","","variable","","selection","","methods\nand","researchers","can","apply","this","method","and","select","the","different","penalty","items","by\nadjusting","the","parameters","based","on","different","research","purpose.\n7","","","","Acknowledgement\nWe","would","like","to","thank","for","Cincinnati","Children’s","Hospital","Medical","Center\nfor","providing","the","real","dataset","for","analysis.\nReferences\nPatrick","Breheny","and","Jian","Huang.","Penalized","methods","for","bi-level","variable","selec-\ntion.Statistics","and","its","interface,","2(3):369,","2009.\nPatrick","Breheny,","Yaohui","Zeng,","and","Maintainer","Patrick","Breheny.","","Package","‘gr-\npreg’.CRAN","Documentation,","2020.\nPeter","","B","̈uhlmann,","","Philipp","","R","̈utimann,","","Sara","","van","","de","","Geer,","","and","","Cun-Hui","","Zhang.\nCorrelated","variables","in","regression:","","clustering","and","sparse","estimation.Journal\nof","Statistical","Planning","and","Inference,","143(11):1835–1858,","2013.\nMarie","","Chavent,","","Vanessa","","Kuentz,","","Benoˆıt","","Liquet,","","and","","L","","Saracco.","","Clustofvar:\nAn","r","package","for","the","clustering","of","variables.arXiv","preprint","arXiv:1112.0295,\n2011.\nNitesh","","","V","","","Chawla,","","","Kevin","","","W","","","Bowyer,","","","Lawrence","","","O","","","Hall,","","","and","","","W","","","Philip\nKegelmeyer.","","","Smote:","","synthetic","","minority","","over-sampling","","technique.Journal\nof","artificial","intelligence","research,","16:321–357,","2002.\nBradley","Efron,","Trevor","Hastie,","Iain","Johnstone,","Robert","Tibshirani,","et","al.","","Least\nangle","regression.The","Annals","of","statistics,","32(2):407–499,","2004.\nMA","","Efroymson.","","","Stepwise","","regression–a","","backward","","and","","forward","","look.Florham\nPark,","New","Jersey,","1966.\nJianqing","Fan","and","Runze","Li.","","Variable","selection","via","nonconcave","penalized","likeli-\nhood","and","its","oracle","properties.Journal","","of","","the","","American","","statistical","","Associa-\ntion,","96(456):1348–1360,","2001.\n28\n\nJianqing","","Fan","","and","","Jinchi","","Lv.","","","Sure","","independence","","screening","","for","","ultrahigh","","di-\nmensional","feature","space.Journal","","of","","the","","Royal","","Statistical","","Society:","","Series","","B\n(Statistical","Methodology),","70(5):849–911,","2008.\nDean","P","Foster","and","Edward","I","George.","","The","risk","inflation","criterion","for","multiple\nregression.The","Annals","of","Statistics,","pages","1947–1975,","1994.\nJerome","","Friedman,","","Trevor","","Hastie,","","and","","Rob","","Tibshirani.","","","Regularization","","paths\nfor","","generalized","","linear","","models","","via","","coordinate","","descent.Journal","","of","","statistical\nsoftware,","33(1):1,","2010.\nNiharika","","Gauraha","","and","","Swapan","","K","","Parui.","","","Pre-selection","","in","","cluster","","lasso","","meth-\nods","","for","","correlated","","variable","","selection","","in","","high-dimensional","","linear","","models.","","","In\nDKB/KIK@","KI,","pages","43–55,","2017.\nRonald","","R","","Hocking","","and","","RN","","Leslie.","","","Selection","","of","","the","","best","","subset","","in","","regression\nanalysis.Technometrics,","9(4):531–540,","1967.\nArthur","E","Hoerl","and","Robert","W","Kennard.","","Ridge","regression:","","Biased","estimation\nfor","nonorthogonal","problems.Technometrics,","12(1):55–67,","1970.\nJian","Huang,","Patrick","Breheny,","and","Shuangge","Ma.","","A","selective","review","of","group\nselection","in","high-dimensional","models.Statistical","science:","","a","review","journal","of\nthe","Institute","of","Mathematical","Statistics,","27(4),","2012.\nLawrence","Hubert","and","Phipps","Arabie.","","Comparing","partitions.Journal","of","classi-\nfication,","2(1):193–218,","1985.\nHenk","AL","Kiers.","Simple","structure","in","component","analysis","techniques","for","mixtures\nof","qualitative","and","quantitative","variables.Psychometrika,","56(2):197–212,","1991.\nRunze","Li,","Wei","Zhong,","and","Liping","Zhu.","Feature","screening","via","distance","correlation\nlearning.Journal","","of","","the","","American","","Statistical","","Association,","","107(499):1129–\n1139,","2012.\nMee","Young","Park,","Trevor","Hastie,","and","Robert","Tibshirani.","Averaged","gene","expres-\nsions","for","regression.Biostatistics,","8(2):212–227,","2007.\nMark","V","Paterno,","Laura","C","Schmitt,","Kevin","R","Ford,","Mitchell","J","Rauh,","Gregory","D\nMyer,","Bin","Huang,","and","Timothy","E","Hewett.","","Biomechanical","measures","during\nlanding","","and","","postural","","stability","","predict","","second","","anterior","","cruciate","","ligament","","in-\njury","after","anterior","cruciate","ligament","reconstruction","and","return","to","sport.The\nAmerican","journal","of","sports","medicine,","38(10):1968–1978,","2010.\nWilliam","M","Rand.","","Objective","criteria","for","the","evaluation","of","clustering","methods.\nJournal","of","the","American","Statistical","association,","66(336):846–850,","1971.\nMaria","L","Rizzo,","Gabor","J","Szekely,","and","Maintainer","Maria","Rizzo.","Package","‘energy’.\nCRAN","Documentation,","2019.\nWenhui","Sheng","and","Xiangrong","Yin.","","Direction","estimation","in","single-index","models\nvia","distance","covariance.Journal","of","Multivariate","Analysis,","122:148–161,","2013.\nNoah","Simon,","Jerome","Friedman,","Trevor","Hastie,","and","Robert","Tibshirani.","A","sparse-\ngroup","lasso.Journal","of","computational","and","graphical","statistics,","22(2):231–245,\n2013.\n29\n\nNoah","","Simon,","","Jerome","","Friedman,","","Trevor","","Hastie,","","Rob","","Tibshirani,","","and","","Main-\ntainer","Noah","Simon.","","Package","‘sgl’.CRAN","Documentation,","2018.\nG","́abor","J","Sz","́ekely,","Maria","L","Rizzo,","Nail","K","Bakirov,","et","al.","","Measuring","and","testing\ndependence","by","correlation","of","distances.The","annals","of","statistics,","35(6):2769–\n2794,","2007.\nRobert","Tibshirani.","","Regression","shrinkage","and","selection","via","the","lasso.Journal","of\nthe","Royal","Statistical","Society:","","Series","B","(Methodological),","58(1):267–288,","1996.\nLaura","","Tolo","̧si","","and","","Thomas","","Lengauer.","","","Classification","","with","","correlated","","features:\nunreliability","of","feature","ranking","and","solutions.Bioinformatics,","27(14):1986–\n1994,","2011.\nLifeng","Wang,","Guang","Chen,","and","Hongzhe","Li.","Group","scad","regression","analysis","for\nmicroarray","time","course","gene","expression","data.Bioinformatics,","","23(12):1486–\n1494,","2007.\nMing","","Yuan","","and","","Yi","","Lin.","","","Model","","selection","","and","","estimation","","in","","regression","","with\ngrouped","variables.Journal","of","the","Royal","Statistical","Society:","","Series","B","(Statis-\ntical","Methodology),","68(1):49–67,","2006.\nCun-Hui","Zhang","et","al.","Nearly","unbiased","variable","selection","under","minimax","concave\npenalty.The","Annals","of","statistics,","38(2):894–942,","2010.\nHui","Zou","and","Trevor","Hastie.","Regularization","and","variable","selection","via","the","elastic\nnet.Journal","of","the","royal","statistical","society:","","series","B","(statistical","methodology),\n67(2):301–320,","2005.\n30"],"doc16":["\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nSalim","I.","Amoukou\n1","2\nNicolas","J-B.","Brunel\n1","3","4\nTangi","Sala\n","̈\nun\n4\nAbstract\nWhile","Shapley","Values","(SV)","are","one","of","the","gold\nstandard","for","interpreting","machine","learning","models,\nwe","show","that","they","are","still","poorly","understood,","in\nparticular","in","the","presence","of","categorical","variables\nor","of","variables","of","low","importance.","","For","instance,\nwe","show","that","the","popular","practice","that","consists\nin","summing","the","SV","of","dummy","variables","is","false\nas","it","provides","wrong","estimates","of","all","the","SV","in\nthe","model","and","implies","spurious","interpretations.\nBased","","on","","the","","identification","","of","","null","","and","","active\ncoalitions,","and","a","coalitional","version","of","the","SV,","we\nprovide","a","correct","computation","and","inference","of\nimportant","variables.","Moreover,","a","Python","library\n1\nthat","computes","reliably","conditional","expectations\nand","SV","for","tree-based","models,","is","implemented\nand","compared","with","state-of-the-art","algorithms","on\ntoy","models","and","real","data","sets.\n1.","Introduction\nThe","explainability","and","interpretability","of","Machine","Learning\n(ML)","models","are","now","central","topics","in","Machine","Learning\nResearch","","due","","to","","their","","increasing","","ubiquity","","in","","Industry,\nBusiness,","Sciences","and","Society.","As","ML","models","are","usually\nconsidered","as","black-box","models,","","scientists,","","practitioners\nand","citizens","call","for","the","development","of","tools","that","could\nprovide","","better","","insights","","in","","the","","important","","variables","","in","","a\nprediction,","or","in","identifying","biases","for","some","individuals,","or\nsub-groups.","Typically,","standard","global","importance","measures\nsuch","as","permutation","importance","measures","are","not","sufficient\nfor","","explaining","","individual","","or","","local","","predictions","","and","","new\nmethodologies","","are","","developed","","in","","the","","very","","active","","field","","of\nExplainable","AI","(XAI).","Indeed,","","various","local","importance\nmeasures","","have","","been","","proposed","","with","","a","","particular","","focus\non","","model-agnostic","","methods","","that","","can","","be","","applied","","to","","the\nmost","successful","ML","models,","typically","ensemble","methods\n1\nLaMME,","","University","","of","","Paris","","Saclay,","","France\n2\nStellantis\n3\nENSIIE,Evry,France\n4\nQuantmetry,Paris,France.\nCorrespondence","to:","Nicolas","Brunel<nicolas.brunel@ensiie.fr>.\n1\nAll","","the","","experiments","","and","","simulations","","can","","be","","reproduced\nwith","the","publicly","available","libraryActive","Coalition","of","Variables\nwww.github.com/salimamoukou/acv00\n(such","as","random","forests,","gradient","boosted","trees)","and","deep\nlearning.","The","most","used","are","for","instance","Partial","Dependence\nPlot","(Friedman,","2001),","Individual","Conditional","Expectation\n(Goldstein","","et","","al.,","","2015),","","and","","local","","feature","","importance\nattribution","","measures","","such","","as","","Local","","Surrogate","","(LIME)\n(Ribeiro","et","al.,","2016).","","With","the","same","objective","in","mind,\nthe","Shapley","Values","(Shapley,","1953),","a","concept","primarily\ndeveloped","in","Cooperative","Game","Theory,","has","been","adapted\nto","XAI","for","evaluating","the","”fair”","contribution","of","a","variable\nX\ni\n=x\ni\nin","a","prediction","(Strumbelj","&","Kononenko,","2010;\nLundberg","&","Lee,","2017).","The","Shapley","Values","(SV)","are","now\nmassively","used","for","identifying","important","variables","at","a","local\nand","a","global","scale.","As","remarked","in","(Lundberg","et","al.,","2020b),\na","lot","of","importance","measures","aim","at","analyzing","the","behavior\nof","a","prediction","modelfbased","onpfeaturesX\n1\n,...,X\np\nby\nconsidering","reduced","predictors.","Typically,","for","any","group","of\nvariablesX\nS\n=","(X\ni\n)\ni∈S\n,","with","any","subsetS⊆J1,pKand\nreference","distributionQ\nS,x\n,","reduced","predictors","are","defined\nas\nf\nS\n(x\nS\n),E\nQ\nS,x\n[f(x\nS\n,X\n","̄\nS\n)].(1.1)\nMost","","often,","","","the","","distributionQ\nS,x\nis","","the","","conditional\ndistribution","or","the","marginal","distribution","ofX\n","̄\nS\n.","The","SV","for\nlocal","interpretability","atxhave","been","introduced","in","(Lundberg\n&","Lee,","2017)","and","are","based","on","a","cooperative","game","with\nvalue","functionv(f;S),f\nS\n(x\nS\n).","Then,","for","any","coalition\nof","variablesC⊆J1,pKandk∈J1,p−|C|K,","we","denote","the\nsetS\nk\n(C)","={S⊆J1,pK\\C||S|=k}:","the","Shapley","Value\n(SV)","of","the","coalitionCis","defined","as\nφ\nC\n(f;x)=\n1\np−|C|+","1\np−|C|\n∑\nk=0\n1\n(\np−|C|\nk\n)\n∑\nS∈S\nk\n(C)\n(f\nS∪C\n(x\nS∪C\n)−f\nS\n(x\nS\n)))(1.2)\nThe","definition","1.2","of","the","SV","is","a","straightforward","extension\nof","the","standard","SV","of","a","single","variable","(or","player)","to","a","group\nof","variables,","the","standard","SV","is","recovered","withC={i}\nfori∈J1,pK.","We","remark","that","this","more","general","definition\nof","SV","is","rarely","used","in","practice,","and","is","different","from","the\nSHAP","interaction","values","that","also","consider","groups","(pairs)","of\nvariables,","but","for","estimating","the","interaction","effect","between\nfeatures.","This","is","not","our","objective","and","we","focus","on","the","fact\nthat","eq.","(1.2)","can","solve","problems","related","to","the","computation\nof","the","SV","of","categorical","variables,","or","the","computation","of","SV\narXiv:2103.13342v2","","[stat.ML]","","25","Mar","2021\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nin","the","presence","of","non-important","variables.\nThese","","latter","","shortcomings","","are","","relatively","","new","","and","","differ\nfrom","","other","","well-known","","criticisms","","addressed","","to","","SV","","in\nXAI.","One","of","the","current","active","debate","is","about","the","causal\ninterpretation","of","Shapley","Values,","see","for","instance","(Heskes\net","","al.,","","2020;","","Janzing","","et","","al.,","","2020;","","Chen","","et","","al.,","","2020).\nTechnically,","this","problem","revolves","around","the","choice","of","the\ndistributionQ\nS,x\nused","for","computing","the","reduced","predictor:\nthe","initial","definition","of","SV","for","XAI","uses","the","conditional\nprobability","in","order","to","define","the","so-called","observational","SV.\nThe","alternative","is","partly","motivated","and","justified","by","causal\ninference,","and","uses","the","marginal","distributionQ\nS,x\n=P\nX\n","̄\nS\n.\nOur","analysis","covers","both","cases.\nAnother","common","classical","criticism","is","about","the","effective\nestimation","of","the","expectations","needed","in","the","SV","computation\nthat","","is","","statistically","","challenging","","and","","combined","","with","","a\nexponential","","complexity.","","","Current","","approaches","","might","","use\nsynthetic","observations","generated","by","a","distribution","different\nfrom","the","original","dataset","(Lundberg","&","Lee,","2017;","Aas","et","al.,\n2020).","This","typically","happens","when","general","ML","models","are\nconsidered:","while","we","acknowledged","that","it","is","an","important\nproblem,","we","focus","in","that","paper","on","tree-based","models","as\nthe","computational","cost","can","be","made","polynomial","and","the\nstatistical","","problem","","is","","easier","","to","","address","","(Lundberg","","et","","al.,\n2020b).","Indeed,","we","propose","a","statistically","principled","way\nof","","estimating","","the","","reduced","","predictors","","in","","that","","setting.","","","In\naddition,","we","show","that","a","better","estimation","of","the","conditional\nexpectations","implies","better","estimates","of","the","SV:","although","it\nmight","be","obvious,","we","show","that","such","kind","of","inaccuracies\ncan","have","a","predominant","role","in","the","estimation","of","Shapley\nvalues","and","might","cause","spurious","interpretations.","Our","paper\nis","organized","as","follows.\nIn","section","2,","we","address","the","theoretical","computation","of","SV\nfor","categorical","variables","when","we","use","standard","encodings,\nwhich","motivates","the","use","of","equation","(1.2).","","In","particular,\nwe","","show","","that","","the","","true","","SV","","of","","the","","categorical","","variable","","is\ndifferent","","from","","the","","sum","","of","","SV","","of","","encoded","","variables.","","","In\norder","to","illustrate","our","point,","we","consider","toy","models","whose\nexact","SV","are","in","closed-form.","In","section","3,","we","address","the\nstatistical","","and","","efficient","","estimation","","of","","reduced","","predictors\nand","Shapley","Values","in","order","to","analyze","real-world","models.\nWe","compare","our","estimators","with","reference","estimators","on\nsimulated","data.","In","section","4,","we","elaborate","on","the","concept","of\nSame","Decision","Probability","(SDP)","(Wang","et","al.,","2020)","as","a\nway","to","identify","the","group","of","most","influential","variables.","We\nshow","that","the","Shapley","Values","and","the","additive","explanation\ncan","be","severely","altered","by","the","presence","of","non-important\nvariables.","In","addition,","we","show","that","the","computation","of","the\nSDP","enables","to","identify","two","groups","of","variables:","the","active\ncoalition","with","important","variables,","and","the","null","coalition","that\ngathers","non-important","variables.","We","can","define","a","new","game\nwhich","provide","better","and","insightful","additive","explanations\nthanks","to","the","new","corresponding","Shapley","Values.","In","section\n5,","we","show","that","the","SDP","and","active","coalitions","can","be","used\nfor","defining","a","global","feature","importance","score","that","exhibits\npromising","results,","so","that","we","can","establish","a","link","between\nlocal","and","global","explanations.","Finally,","we","give","a","short","wrap-\nup","and","some","directions","of","future","works.\n2.","Multiple","ways","of","computing","the","Shapley\nvalue","of","categorical","variables\n2.1.","The","Shapley","value","of","a","categorical","variable\nIn","this","part,","we","show","how","to","properly","handle","the","SV","of\na","","categorical","","variable","","after","","encoding.","","","","For","","the","","sake","","of\nsimplicity,","","we","","consider","","the","","case","","of","","two","","variablesX=\n(X,Y)whereX∈","X","⊆Ris","a","quantitative","variable","and\nY=","1,...,Kis","a","categorical","variable.","The","SV","gives","the\ndecomposition\nf(x,y)−E\nP\n[f(X,Y)]","=φ\nX\n(f;x,y)","+φ\nY\n(f;x,y)\n(2.1)\nA","direct","application","of","eq.","","(2.1)","gives","for","allx∈Rand\nY∈{1,...,K}.\n\n\n\n\n\nφ\nX\n(f;x,y)","","=\n1\n2\n(E[f(X,Y)|X=x]−E[f(X,Y)])\n+\n1\n2\n(f(x,y)−E[f(X,Y)|Y=y])\nφ\nY\n(f;x,y)","","=\n1\n2\n(E[f(X,Y)|Y=y]−E[f(X,Y)])\n+\n1\n2\n(f(x,y)−E[f(X,Y)|X=x])\n(2.2)\nThe","role","of","variableX,Yare","symmetric","and","the","categorical\nor","","quantitative","","nature","","of","","the","","variable","","does","","not","","have","","any\nimpact","on","the","computation","of","SV.","Nevertheless,","categorical\nvariables","are","very","often","not","processed","in","this","way","during","the\ntraining","of","statistical","or","machine","learning","models.","Indeed,\nthe","","variableYis","","encoded","","in","","a","","more","","tractable","","way","","by\nintroducing","the","dummy","variables:\nY\nk\n=\n{\n1,ifY=k\n0otherwise\n.(2.3)\nWhen","the","dummy","variables","are","introduced","in","the","model,\nwe","can","compute","their","Shapley","Values.","Difficulties","appear\nwhen","we","want","to","relate","the","SV","of","the","dummiesY\nk\n,","k=\n1,...,K−1to","","the","","SV","","of","","the","","variableYas","","defined\nas","","in","","eq.(2.2).In","","order","","to","","establish","","this","","link,","","we\nintroduce","more","notations.","","","LetC:y7→(y\n1\n,...,y\nK−1\n)\nbe","the","encoding","transformation,Y\n1:K−1\n=C(Y),\n","̃\nPthe\ndistribution","","of(X,Y\n1:K−1\n)onX","×\n∏\nK−1\nk=1\n{0,1}\n:\n","̃\nPis\nthe","image","probability","ofPinduced","byC.","","","The","function\nf:X","×","{1,...,K}","−→Rdefines","","a","","function\n","̃\nf:\nX","×\n∏\nK−1\nk=1\n{0,1}−→Rsuch","that\nf(X,Y),\n","̃\nf(X,Y\n1\n,...,Y\nK−1\n).\nThe","","","function\n","̃\nfis","","","not","","","completely","","","defined","","","for","","","all\n(y\n1\n...,y\nK−1\n)∈\n∏\nK−1\nk=1\n{0,1}and","","is","","only","","defined\n","̃\nP\n-\nalmost","everywhere","because","of","the","deterministic","dependence\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\n∑\nK−1\nk=1\nY\nk\n≤1induced","by","the","dummy","transformationC\n(2.3).","","","Consequently,","","we","need","to","extend\n","̃\nfto","the","whole\nspaceX","×\n∏\nK−1\nk=1\n{0,1}by","setting\n","̃\nf(x,y\n1\n,...y\nK−1\n)","=","0\nas","soon","as\n∑\nK−1\nk=1\ny\nk\n>1.\nFor","the","predictor\n","̃\nf(X,Y\n1\n,...,Y\nK−1\n),","we","can","compute","the\nSV","ofX,Y\n1\n,...,Y\nK−1\nand","obtain","the","decomposition\n","̃\nf(x,y\n1:K−1\n)−E\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)\n]\n=φ\nindiv\nX\n(\n","̃\nf;x,y\n1:K−1\n)","+\nK−1\n∑\nk=1\nφ\ny\nk\n(\n","̃\nf;x,y\n1:K−1\n)(2.4)\nwhereφ\nk\n(\n","̃\nf;x,y\n1:K−1\n)are","","the","","SV","","of","","the","","variableY\nk\ncomputed","","with","","distribution\n","̃\nP.","","","By","","definition","","of\n","̃\nf,","","we\nhave\n","̃\nf(x,y\n1:K−1\n)","=f(x,y)andE\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)\n]\n=\nE\nP\n[f(X,Y)].","This","implies","the","equality\nφ\nX\n(f;x,y)","+φ\nY\n(f;x,y)","=φ\nindiv\nX\n(\n","̃\nf;x,y\n1:K−1\n)\n+\nK−1\n∑\nk=1\nφ\ny\nk\n(\n","̃\nf;x,y\n1:K−1\n)\n(2.5)\nIn","","general,φ\nY\n(f;x,y)6=\n∑\nK−1\nk=1\nφ\ny\nk\n(\n","̃\nf;x,y\n1:K−1\n)\n,","","in\nparticular","because","SV","depends","on","the","number","of","variables.\nIndeed,","we","show","in","the","next","proposition","thatφ\nY\n(f;x,y)","=\nφ\nC\n(\n","̃\nf;x,y\n1:K−1\n)whereCis","","the","","coalition","","of","","variables\n(Y\n1\n,...,Y\nK−1\n).\nProposition","2.1.\nFor","allx∈X,","and","ify\n1:K−1\n=C(y)then\n{\nφ\nC\n(\n","̃\nf;x,y\n1:K−1\n)=φ\nY\n(f;x,y)\nφ\ncoal\nX\n(\n","̃\nf;x,y\n1:K−1\n)","","","","=φ\nX\n(f;x,y)\n(2.6)\nWe","","refer","","to","","Appendix","","A","","for","","detailed","","derivations.In\ngeneral,","","for","","cooperative","","games,","","the","","SV","","of","","a","","coalition\nφ\nC\n(\n","̃\nf;x,y\n1:K−1\n)is","different","from","the","sum","of","individual\nShapley","","effects\n∑\nk∈C\nφ\ny\nk\n(\n","̃\nf;x,y\n1:K−1\n)\n.We","","remark\nthat","","we","","can","","compute","","two","","different","","SV","","forXwhen","","we\nuse","","the","","encoded","","predictor\n","̃\nf:φ\ncoal\nX\n(\n","̃\nf;x,y\n1:K−1\n)\nand\nφ\nindiv\nX\n(\n","̃\nf;x,y\n1:K−1\n).","These","two","SV","are","different","in","general\nas","they","involve","different","number","of","variables","and","different\nconditional","expectations.","","Proposition","2.1","shows","that","we\nshould","preferφ\ncoal\nX\n(\n","̃\nf;x,y\n1:K−1\n)toφ\nindiv\nX\n(\n","̃\nf;x,y\n1:K−1\n),\nasφ\ncoal\nX\nis","equal","to","the","theoretical","SV","given","in","eq.","(2.2).","For\nthis","reason,","we","denote","for","simplicityφ\nX\n(\n","̃\nf;x,y\n1:K−1\n).\n2.2.","Coalition","or","Sum:","numerical","comparisons\nWe","","give","","numerical","","examples","","illustrating","","the","","differences\nbetween","coalition","or","sum","and","corresponding","explanations.\n2.2.1.","TOY","MODEL\nWe","consider","a","linear","predictorf,","with","categorical","and","3\ncontinuous","variables(X\n0\n,X\n1\n,X\n2\n),","defined","asf(X,Y)","=\nB\nY\nXwithX|Y=y∼","N(μ\ny\n,Σ\ny\n)andP(Y=y)","=π\ny\n,\nY∈","{a,b,c}.","","The","values","of","the","parameters","used","in","our\nexperiments","are","found","in","Appendix","D.\nIn","figure","1,","we","remark","that","the","SV","change","considerably","for\na","single","observation.","The","sign","changes","given","the","encoding\n(dummies,","One-Hot-Encoding","-","OHE)","and","is","often","different\nfrom","the","sign","of","the","true","SV","ofYwithout","encoding.","We","can\nalso","note","important","differences","in","the","SV","of","the","quantitative\nvariableX.\nFigure","1.SV","","with","","or","","without","","encoding","","(OHE","","-","","Dummies)","","for\nobservationx=","[−1.15,3.50,−1.28],y=a.\nIn","order","to","provide","a","global","overview","of","the","difference,","we\ncompute","the","SV","ofYon","100","observations,","by","varying","the\nfirst","variableX\n0\non","a","regular","grid","in[−4,2].","","We","observe\nin","figure","2","very","high","discrepancies","between","the","different\nencoding","and","the","true","SV","of","Y.","Moreover,","the","distribution","of\ndiscrepancies","is","highly","skewed","and","non-uniform","on","the","grid,\nwhich","makes","it","unpredictable,","and","difficult","to","anticipate","in\npractice.\nFigure","2.SV","of","the","categorical","variable","of","different","observations\nwithX\n0\n∈[−4,2]andY=a.\n2.2.2.","CENSUSINCOMEDATA\nWe","use","UCI","Adult","Census","Dataset","(Dua","&","Graff,","2017).","We\nkeep","only","4","highly-predictive","categorical","variables:","Marital\nStatus,","","Workclass,","","Race,","","Education","","and","","use","","a","","Random\nForest","","which","","has","","a","","test","","accuracy","","of86%.","","","We","","compare\nthe","SV","by","taking","the","coalition","or","sum","of","the","modalities.\nSV","are","computed","with","algorithm","1","described","in","(Lundberg\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\net","al.,","2020a).","","","In","the","rest","of","the","paper,","","this","estimator","is\ndenoted","SHAP","as","it","is","the","backbone","implementation","used","in\nthe","Python","library","SHAP\n2\n.","In","figure","3,","we","see","differences\nFigure","3.Difference","between","the","absolute","value","of","SV:","coalition\n(left)","vs","sum","(right)","of","dummies","of","individual","with","modalities:\nMarried,","local","gov,","others,","1rst-4th.\nbetween","the","absolute","value","of","SV","with","coalition","and","sum.\nThe","ranking","of","the","variables","changes,","e.g.","Education","goes\nfrom","important","with","sum","to","not","important","with","the","coalition.\nWe","also","compute","the","proportion","of","order","inversion","over","5000\nobservations","choose","randomly.","The","ranking","of","variables","is\nchanged","in10%of","the","cases.","Note","that","this","difference","may\nincrease","or","diminish","depending","on","the","data.\n3.","Shapley","values","in","tree-based","models\nThe","","computation","","of","","the","","SV","","uses","","all","","the","","conditional\nexpectationsE[f(X)|X\nS\n],S⊆J1,pK.While","","it","","is\ndifficult","","in","","general,","","the","","paper","","(Lundberg","","et","","al.,","","2020b)\nintroduce","a","recursive","algorithm","that","reads","sequentially","and\nrecursively","the","different","nodes.","In","section","3.2,","we","show","that\nthe","estimates","and","results","obtained","can","be","far","from","the","true\nexpectations.","Hence,","we","suggest","a","straightforward","Plug-In\nestimator","of","the","true","conditional","expectations","that","is","more\naccurate.\n3.1.","Closed-form","expressions","for","reduced","predictors\nWith","","","tree-structured","","","models,","","","we","","","can","","","have","","","efficient\nalgorithms","","","for","","","computing","","","in","","","closed-form","","","conditional\nexpectations","and","SV.","We","assume","thatfis","estimated","from\nthe","dataD=","(x\ni\n,z\ni\n)\n1≤i≤n\n,","and","we","show","how","we","compute\nf\nS\n(x\nS\n).","","We","assume","that","we","have","a","regression","tree","with\nMleafsL\n1\n,...,L\nM\nbased","on","the","variablesX\n1\n,...,X\np\n(continuous","or","qualitative),","the","functionfcan","be","a","predictor\nor","any","function","estimated","with","a","tree:\nf(x)","=\nM\n∑\nm=1\nf\nm\n1\nL\nm\n(x).\n2\nhttps://github.com/slundberg/shap,","","TreeExplainer","","uses","","an\naccelerated","version","of","algorithm","1.\nThe","reduced","predictor","is\nf\nS\n(x\nS\n)","=\nM\n∑\nm=1\nf\nm\nQ\nS,x\n(L\nm\n)\nshowing","that","the","only","challenge","is","the","computation","of","the\nprobabilitiesQ\nS,x\n(L\nm\n).\nEstimation","","of","","conditional","","probabilityFor","","simplicity,\nwe","assume","thatQ\nS,x\n=P(·|X\nS\n=x\nS\n)with","computable\nconditional","densitiesp(x\n","̄\nS\n|x\nS\n)\nQ\nS,x\n(L\nm\n)","=P\nX\n(L\nm\n|X\nS\n=x\nS\n)","=\n∫\nL\nm\np(x\n","̄\nS\n|x\nS\n)dx\n","̄\nS\nThe","","leaf","","can","","be","","written","","asL\nm\n=\n∏\np\ni=1\n[a\nm\ni\n,b\nm\ni\n](with\n−∞","≤a\nm\ni\n<","b\nm\ni\n≤+∞\n).","","It","is","useful","to","partition","the\nleaf","according","to","the","coalitionS:L\nm\n=L\nS\nm\n×L\n","̄\nS\nm\nwith\nL\nS\nm\n=\n∏\ni∈S\n[a\nm\ni\n,b\nm\ni\n]andL\n","̄\nS\nm\n=\n∏\ni∈\n","̄\nS\n[a\nm\ni\n,b\nm\ni\n].","For","each\nconditionX\nS\n=x\nS\n,","we","introduce","the","set","of","compatible\nleaves","for","eachx=","(x\nS\n,x\n","̄\nS\n)\nC(S,x)","=\n{\nm∈[1...M]|x\nS\n∈L\nS\nm\n}\nmeaning","","that","","we","","only","","need","","to","","compute","","the","","conditional\nprobabilities","for","the","compatible","leafs,","and","we","have\nP\nX\n(L\nm\n|X\nS\n=x\nS\n)","=\n{\n0ifm","/∈C(S,x)\n∫\nL\n","̄\nS\nm\np(x\n","̄\nS\n|x\nS\n)dx\n","̄\nS\nifm∈C(S,x)\nIf","we","make","no","assumption","on","the","shape","of","the","distribution\np(x)norp(x\n","̄\nS\n|x\nS\n)\nas","","(Aas","","et","","al.,","","2020),","","we","","need","","to\nestimateP\nX\n(L\nm\n|X\nS\n=x\nS\n)directly","from","the","data","setD.\nWhen","","all","","the","","variables","","are","","categorical,","","we","","can","","estimate\ndirectly","by","empirical","conditional","frequencies.","","","Indeed,","","a\nstraightforward","estimation","is","based","onN(x\nS\n):","the","number\nof","observations","such","thatX\nS\n=x\nS\n(across","all","the","leaves\nof","the","tree)","andN(L\nm\n,x\nS\n):","the","number","of","observations","in\nleafL\nm\nthat","satisfies","the","conditionX\nS\n=x\nS\n.","We","have\nP\nX\n(L\nm\n|X\nS\n=x\nS\n)","=\nN(L\nm\n,x\nS\n)\nN(x\nS\n)\n.\nHowever,","this","estimator","can","have","a","high","variance","when","there\nis","a","small","number","of","observations","in","the","leaf","satisfying","these\nconditions.","In","order","to","avoid","this","problem,","we","replace","the\ncondition{X\nS\n=x\nS\n}by","the","condition\n{\nX\nS\n∈L\nS\nm\n}\n.","We\nhave\nP\nX\n(\nL\nm\n∣\n∣\nX\nS\n∈L\nS\nm\n)\n=\nN(L\nm\n)\nN(L\nS\nm\n)\nwhere\n•N(L\nm\n)is","the","number","of","observations","in","the","leafL\nm\n•N(L\nS\nm\n)\nis","the","number","of","observations","satisfying","the\nconditionsx\nS\n∈L\nS\nm\nacross","all","the","leaves","of","the","tree.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nWhen","the","variablesX\nS\nare","quantitative,","the","computation\nbecomes","more","challenging,","and","a","standard","approach","is","to\nuse","kernel","smoothing","estimators","(with","Parzen-Rosenblatt\nkernels).","","The","main","drawback","of","this","approach","is","the","low\nrate","of","convergence","in","high","dimensions,","and","the","need","to\nchoose","adaptively","an","appropriate","bandwidth,","which","might\nadd","","complexity","","and","","instability","","to","","the","","whole","","estimation\nprocedure.","We","propose","to","overcome","this","by","replacing","the\ncondition{X\nS\n=x\nS\n}by","the","condition\n{\nX\nS\n∈L\nS\nm\n}\n.","As\nin","the","categorical","case,","we","introduce","a","bias","for","the","estimation\nof","the","conditional","in","order","to","improve","the","variance.","In","both\ncases,","we","use","the","same","empirical","estimator","of","the","conditional\nprobability,","i.e\nP\nX\n(L\nm\n|X\nS\n=x\nS\n)'P\nX\n(\nX\n","̄\nS\n∈L\n","̄\nS\nm\n∣\n∣\nX\nS\n∈L\nS\nm\n)\n'\nN(L\nm\n)\nN(L\nS\nm\n)\n(3.1)\nConsequently,","the","reduced","predictor","could","be","approximated\nby\n∑\nm∈C(S,x)\nf\nm\nN(L\nm\n)\nN(L\nS\nm\n.","","However,","our","estimator","of","the\nconditional","probabilities","does","not","sum","to","one,","i.e\n∑\nm∈C(S,x)\nN(L\nm\n)\nN(L\nS\nm\n)\n6=","1\nbecause","the","denominatorN(L\nS\nm\n)\nvaries","withm.","We","correct\nthe","","estimated","","probabilities","","by","","re-normalizing","","them","","with\nZ(S,x)","=\n∑\nm∈C(S,x)\nN(L\nm\n)\nN(L\nS\nm\n)\n.\nHence,","our","final","estimate","of","the","reduced","predictor","is\nˆ\nf\nS\n(x\nS\n)","=\n∑\nm∈C(S,x)\nf\nm\nN(L\nm\n)\nZ(S,x)×N(L\nS\nm\n)\n(3.2)\nand","it","should","be","compared","to","the","truef\nS\n(x\nS\n).","We","see","that\nthe","essential","challenge","in","the","computation","of","the","restricted\nestimator","is","the","identification","of","the","set","of","compatible","leaves\nC(S,x).\n3.2.","Comparisons","of","the","different","estimators\nTo","compare","the","different","estimators,","we","need","a","model","where\nconditional","expectations","can","be","calculated","exactly.","IfX∼\nN(μ,Σ)\nthenX\n","̄\nS\n|X\nS\nis","also","multivariate","gaussian","with\nexplicit","mean","vectorμ\n","̄\nS|S\nand","covariance","matrixΣ\n","̄\nS|S\n,","see\nAppendix","A.\nLet","assume","we","have","a","sampleD={(x\ni\n,z\ni\n),i=","1,...,n}\ngenerated","by","a","linear","regression","model","withX∈R\n3\na\nGaussian","variable","and","targetZ=B\nt\nX.\nWe","use","a","highly","accurate","decision","tree","regressor","trained\nonDwithn=","","","10000,","","parameters","","can","","be","","found","","in\nAppendix","D.","Since","we","know","the","law","ofX,","we","compute\nE[f(X)|X\n2\n=x\n2\n]exactly","","over","","a","","regular","","grid","","of100\nFigure","4.Estimation","of","expectationE[f(X)|X\n2\n]with","different\nobservations","withX\n0\n∈[−4,4].\nforx\n0\n∈[−5,5]and","a","Monte-Carlo","estimator","(MC)","by\nresampling10000observations.","","","","We","","compare","","this","","two\nestimators","with","SHAP","and","the","Plug-In","estimator","defined\nin","equation","3.2.","Not","surprisingly,","we","observe","in","figure","4","that\nthe","MC","estimator","and","the","true","expectation","are","both","equal.\nThe","SHAP","estimator","has","very","large","discrepancies,","while","the\nPlug-In","estimator","is","very","close","to","the","truth.\nSince","","the","","computation","","of","","SV","","uses","","all","","the","","conditional\nexpectationsE[f(X)|X\nS\n=x\nS\n],S⊆J1,pK,","we","can","use\nit","to","highlight","the","overall","differences","between","the","estimators.\nWe","","give","","in","","figure","","5","","the","","SV","","of","","200","","obervations","","for","","the\ndifferent","estimators","and","we","compare","them","with","the","Shapley\nvalues","computed","with","the","exact","probabilities","and","plot","the\n`\n1\nnorm","of","their","differences.","This","emphasizes","the","results","in\nfigure","4.\nFigure","5.Errors","","distribution","","between","","the","","true","","SV","","with","","exact\nexpectation","and","the","corresponding","algorithm","(SHAP,","Plug-In,","MC)\nover","200","new","observations","generated","byP\nX\n.\n4.","Identifying","Active","and","Null","coalitions\nIn","general,","we","are","not","only","interested","in","computing","feature\nimportanceφ\ni\n(f,x),","we","also","want","to","identify","the","group","of\nvariablesX\ni\n,i∈Sthat","best","explainsxand","the","group","of\nuniformative","variablesX\ni\n,i∈\n","̄\nS.","Therefore,","several","papers\n(Zaeri-Amirani","et","al.,","2018;","Cohen","et","al.,","2007;","Sun","et","al.,\n2012)","suggest","to","use","SV","as","a","heuristic","for","feature","selection,\nbut","as","proved","in","(Ma","&","Tourani,","2020),","the","magnitude","of\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nSV","of","variables","do","not","necessarily","correspond","to","relevant\nvariables.","","Here,","we","split","the","set","of","variables","as","an","active\ncoalition","(composed","of","important","variables)","and","the","null\ncoalition,","composed","of","the","variables","with","a","low","influence","of\nthe","predictionf(x).","Then","we","show","that","the","SV","computed\nonly","for","the","variables","in","the","active","set","are","better","estimates","of\nthe","effect","of","the","corresponding","variables","on","the","prediction.\n4.1.","Same","Decision","Probability\nOur","methodology","for","identifying","the","most","important","features\nis","based","on","the","Same","Decision","Probability","(SDP)","criterion,\nintroduced","in","(Chen","et","al.,","2012).","In","particular,","we","extend\nthe","work","of","(Wang","et","al.,","2020)","to","the","regression","case,","and\nwe","derive","an","efficient","way","to","approximate","the","SDP","for","tree-\nbased","models.\nDefinition","4.1.(Same","Decision","Probability","of","a","classifier).\nLetf:X","−→[0,1]a","","probabilistic","","predictor","","and","","its\nclassifierC(x)","","=1\nf(x)≥T\nwith","","threshold","","T,","","the","","Same\nDecision","Probability","of","coalitionS⊂J1,pK,","","w.r.tx=\n(x\nS\n,x\n","̄\nS\n)is\nSDP\nS\n(C;x)","=P(C(x\nS\n,X\n","̄\nS\n)","=C(x)|X\nS\n=x\nS\n)\nSDP","gives","the","probability","to","keep","the","same","decisionC(x)\nwhen","we","do","not","observe","the","variablesX\n","̄\nS\n.","","","The","higher\nis","the","probability,","","the","better","is","the","explanation","based","on\nS.","","Therefore,","we","want","to","identify","theminimalsubset","of\nfeatures","such","that","the","classifier","makes","the","same","decision\nwith","high","probabilityπ,","given","only","them.","More","formally:\nDefinition","4.2.\n(Sufficient","Coalition).","","GivenCa","binary\nclassifier,","an","observationx=","(x\nS\n,x\n","̄\nS\n),S,S\n?\nπ\n(x)is","a\nSufficient","Coalition","for","probabilityπif:\n1.SDP\nS\n?\nπ\n(x)\n(C;x)≥π\n2.","","No","subsetZofS\n?\nπ\n(x)satisfiesSDP\nZ\n(f;x)≥π\nIn","order","to","find","the","coalitionS\n?\nπ\n(x)\n,","we","need","to","be","able","to\ncompute","the","SDP","for","any","subsetS.","","However,","computing\nthe","SDP","is","known","to","be","computationally","hard.","Even","for","a\nsimple","Naive","Bayes","model","and","classifier,","computing","SDP\nis","NP-hard","(Chen","et","al.,","2013).","Consequently,","approximate\ncriterion","based","on","expectations","instead","of","probabilities","have\nbeen","introduced","see","(Wang","et","al.,","2020).","","In","that","section,\nwe","show","that","we","can","compute","exactly","and","efficiently","the\nSame","Decision","Probability","in","tree-based","model","by","relying\non","reduced","predictors.\nProposition","","4.1.Letfa","probabilistic","predictor","and","its\nbinary","","classifierCwith","","threshold","","T,Q\nS,x\nthe","","law","","of\nX\n","̄\nS\n|X\nS\n=x\nS\n,","","then","","theSDP\nS\n(f;x)can","","be","","written\nexplicitly","with","the","reduced","predictor:\nSDP\nS,x\n=\nd−d\n−\nd\n+\n−d\n−\n(4.1)\nWhered=E\nQ\nS,x\n[f(x\nS\n,X\n","̄\nS\n)],d\n+\n=\nE\nQ\nS,x\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)≥T]]andd\n−\n=\nE\nQ\nS,x\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)<","T].\nThe","proof","can","be","found","in","Appendix","A.\nIn","the","case","of","the","regression,","the","SDP","and","sufficient","coalition\ncan","be","defined","straightforwardly","and","we","can","obtain","the","same\nkind","of","decomposition","as","in","proposition","4.1.\nDefinition","","","","4.3.(Same","","","","Decision","","","","Probability","","","","of","","","","a\nregressor).\nLetf:X","−→","Za","","regressor,","","the","","Same\nDecision","Probability","at","leveltof","coalitionS⊂J1,pK,","w.r.t\nx=","(x\nS\n,x\n","̄\nS\n)is\nSDP\nS\n(f;x,t)","=P(d(f(x\nS\n,X\n","̄\nS\n),f(x))≤t|X\nS\n=x\nS\n)\nIn","a","regression","setting,","the","SDP","gives","the","probability","to","stay\nclose","to","the","same","predictionf(x)at","levelt,","when","we","do","not\nobserve","variablesX\n","̄\nS\n.\nProposition","","4.2.\nLetfbe","","a","","regressor,Q\nS,x\nthe","","law\nX\n","̄\nS\n|X\nS\n=x\nS\n,","","then","theSDP\nS\n(f;x,t)can","be","written\nexplicitly","as:\nSDP\nS\n(f;x,t)","=\nd\n+\n−d\nd\n+\n−d\n−\n(4.2)\nWhered=E\nQ\nS,x\n[d(f(x\nS\n,X\n","̄\nS\n),f)],d\n+\n=\nE\nQ\nS,x\n[d(f(x\nS\n,X\n","̄\nS\n),f)|d(f(x\nS\n,X\n","̄\nS\n),f)>","t]\nand\nd\n−\n=E\nQ\nS,x\n[d(f(x\nS\n,X\n","̄\nS\n),f)|d(f(x\nS\n,X\n","̄\nS\n),f)≤t].\nThe","proof","can","be","found","in","Appendix","A.\nPropositions","4.1","and","4.2","are","useful","for","computing","effectively\nthe","SDP","for","a","model.","In","particular,","prop.","4.1","shows","that","it\ncan","be","accurately","estimated","with","the","reduced","predictors","and\nthe","Plug-In","estimators","(3.2).","In","the","case","of","the","regression,","the\ncomputation","of","the","SDP","is","not","as","straightforward","for","general\ndistanced(·,·).","Nevertheless,","ifdis","the","Euclidean","distance\nandfa","tree-based","model,","we","can","compute","efficiently","the\nSDP","with","eq.","","(4.2)","by","exploiting","the","tree","structure","of","the\nmodel","that","partition","the","feature","space.\nProposition","4.3.Letf(x)","=\n∑\nM\nm=1\nf\nm\n1\nL\nm\n(x)\nbe","a","tree\nfunction,Q\nS,x\nis","the","conditional","law","givenX\nS\n=x\nS\n.","The\nconditional","expectation","of","the","Euclidean","distance","can","be\ncomputed","with","the","Plug-In","estimator","3.2:\nE\nQ\nS,x\n[d(f(x\nS\n,X\n","̄\nS\n),f)]","=E\nQ\nS,x\n[\n(\n∑\nm\nf\nm\n1\nL\nm\n(x)−f)\n2\n]\n=\n∑\nm\nf\n2\nm\nP\nQ\nS,x\n[\nL\nm\n(x)\n]\n+f\n2\n−2f\n∑\nm\nf\nm\nP\nQ\nS,x\n[\nL\nm\n(x)\n]\n(4.3)\nThe","probabilityP\nQ\nS,x\n[\nL\nm\n(x)\n]\nis","approximated","by\nN(L\nm\n)\nN(L\nS\nm\n)\n.\nWe","can","adapt","eq.","","","(4.3)","to","compute","all","","the","terms","in","the\ndecomposition","(4.2)","ofSDP\nS\n(f;x,t).","We","can","also","extend\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nthis","result","to","tree-ensemble","models","like","Random","Forest,","see\nAppendix","A.\nBased","on","the","computation","of","the","SDP","of","any","coalition","given\nby","the","previous","propositions,","we","can","derive","an","algorithm","that\nfinds","the","Sufficient","Coalitions","for","probabilityπi.eS\n?\nπ\n(x).\nUnlike","SV","computation,","we","don’t","have","to","compute","all","the\nconditional","expectations","for","all","subsets","in","order","to","find","the\ncoalitionS\n?\nπ\n.","We","use","a","greedy","algorithm","that","computes","the\nSDPs","for","subsets","of","increasing","sizes","(starting","from","1)","until\nwe","find","a","minimal","subset","satisfying","the","Sufficient","Coalition\nconditions.","The","algorithm","is","described","in","Algorithm","1","and\ndefines","the","functionreturnSubsets(x,","size)that","returns","all\nsubsets","of","lengthsizeofx.\nAlgorithm","1Find","Sufficient","Coalition\nInput",":x,π\nn=length(x)\nfind=False\nbestSdp=−1\nforsize=","1tondo\nforS⊂returnSubsets(x,","size)do\nsdp","=SDP\nS\n(x,f)\nifsdp≥πandsdp≥bestSdpthen\nbestSdp","=","sdp\nS\n?\nπ\n=S\nfind","=","True\nend","if\nend","for\niffind","=","Truethen\nreturnS\n?\nπ\nend","if\nend","for\n4.2.","Active","Shapley","values\nIn","general,","the","top","ranked","SV","do","not","necessarily","correspond\nto","relevant","variables","(Ma","&","Tourani,","2020).","However,","the\nnotion","of","SDP","allows","us","to","identify","these","variables:S\n?\nπ\nis","the","set","of","active","features","such","that","the","model","make","the\nsame","decision","with","high","probabilityπas","on","the","full","example\nxandN\nπ\n(x)is","the","set","of","remaining","variables.","","Since","the\nvariables","inN\nπ\n(x)are","not","important","for","the","prediction,","we\ndon’t","have","to","involve","them","in","the","computation","of","SV.","But\nwe","can","still","use","the","SV","to","highlight","the","individual","effects","of\nimportant","variables.","We","introduce","a","new","XAI","game","where\nthe","SV","of","variables","inN\nπ\n(x)are","fixed","to","zero.\nDefinition","4.4.(Active","Shapley","values).Letfa","model,x\nan","instance,S\n?\nπ\n(x)the","Sufficient","Coalition","of","levelπofx,\nN\nπ\n(x)is","the","set","of","remaining","variables","(the","Null","Coalition).\nWe","define","the","new","cooperative","game","with","value","functionv\n?\ndefined","for","allSinS\n?\nπ\n(x),","such","that\nv\n?\n(f;S),f\nS∪N\nπ\n(x)\n(x\nS∪N\nπ\n(x)\n)\nandv\n?\n(f;∅)","=E[f(X)].","","For","all","the","variablesX\ni\ninS\n?\nπ\n,\nwe","define","the","new","Shapley","value","as\nφ\n?\ni\n(f;x)","=\n1\n|S\n?\nπ\n|\n|S\n?\nπ\n|−1\n∑\nk=0\n1\n(\n|S\n?\nπ\n|−1\nk\n)\n∑\nS∈S\nk\n(S\n?\nπ\n(x)))\nv\n?\n(S∪i)−v\n?\n(S)\nRemark4.1.This","","game","","is","","different","","from","","the","","standard\ngame","1.2","because","we","consider","only","the","reduced","predictors\nobtained","by","conditioning","with","the","coalitionN\nπ\n(x).","","","We\nkeep","the","same","referenceφ\n?\n0\n(f;x)","=E[f(X)],","such","that\nwe","keep","explaining","the","same","differencef(x)−E[f(X)]\nby","the","additive","explanation","(accuracy)","formula.\nExamples:\nLet","us","assume","that","we","have","a","predictive","model\nbuilt","on","the","toy","model","of","Section","2.2.1","with","six","variables\n(X\n0\n,...,X\n4\n,Y),","and","we","have","a","highly","accurate","decision\ntree.","Parameters","of","the","model","can","be","found","in","Appendix","D.\nWe","choose","an","observation","in","classY=bwhere","the","relevant\nvariables","areX\n0\n,X\n1\n,X\n2\n,Y:","indeed","the","coefficientsB\nb\nare\n[9,5,−8,0,0].\nIn","figure","6,","we","observe","that","relevant","variables","are","indeed\nfound","in","the","Sufficient","Coalition.","In","applications,","we","found\nthatπ=","","90%gives","","relevant","","coalitions.","","","Therefore,","","we\nFigure","6.SDP","","for","","the","","Sufficient","","Coalition","","(blue)","","found","","by\nAlgorithm","","","1","","","withπ=","","","0.9,","","","","for","","","observationx=\n[2.06,2.01,−0.90,−1.91,−3.70],y=a.The","","remaining\nvariables","are","the","Null","Coalition","with","corresponding","SDP","in","orange.\ncompute","the","Active","SV","based","on","the","Sufficient","Coalition.\nWe","","observe","","in","","left","","part","","of","","figure","","7","","that","","we","","recover","","the\nindividual","","effects","","of","","the","","important","","variables","","and","","they\nare","consistent","with","the","importance","order","of","the","variables\nwhereas","classic","SV","decomposition","wrongly","findX\n3\nas","the\nmost","important","variable,","see","right","figure","7.\nFigure","7.Left","","figure:","","","","SVφ\n?\ni\ncomputed","","with","","the","","Sufficient\nCoalition","given","in","figure","6.","Right","figure:","SVφ\ni\ncomputed","with","all\nthe","variables.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\n5.","From","local","to","global","explanations","with","SDP\nIn","","this","","section,","","we","","show","","that","","the","","SDP","","gives","","a","","natural\nway","to","go","from","local","to","global","variable","importance","scores:\nwe","interpret","the","task","of","computing","a","global","score","as","the\nstability","across","the","data","set","of","the","selection","process","of","the\nSufficient","Coalition.","By","analogy","with","the","stability","selection\nprocess","introduced","in","(Meinshausen","&","B\n","̈\nuhlmann,","2010)\nand","advocated","in","(Yu","&","Kumbier,","2020),","we","introduce","the\nfollowing","definition:\nDefinition","5.1.(SDP-Global).LetX=","(X\n1\n,...,X\np\n)be\nfeatures","with","lawPand","a","predictorf.","","The","Global","SDP\nimportance","ofX\ni\nis","defined","as:\nSDP\nglobal\n(X\ni\n)","=E\nP\n[\n1\nX\ni\n∈S\n?\nπ\n(x)\n]\nHence,","","a","","variable","","with","","a","","high","","SDP-global","","appears","","very\noften","","in","","the","","Sufficient","","Coalitions","","across","","all","","the","","dataset.\nWe","consider","now","a","synthetic","simple","Bayesian","model","that\npossesses","a","causals","structure","where","we","can","challenge","the\naccuracy","of","the","inference","of","important","variables.\nExplanations","based","on","SDP\nWe","use","an","accurate","decision\ntree","trained","on","LUCAS","(LUCAS),","a","dataset","generated","by\ncausal","Bayesian","networks","with","12","binary","variables.","","The\ngraph","is","drawn","in","figure","8","and","we","provide","the","probability\ntable","in","Appendix","D.","We","want","to","explain","an","observation","with\nFigure","8.The","target","variable","is","shaded","in","purple.","The","nodes","in","dark\ngreen","constitute","the","Markov","blanket","of","the","target","variable.\na","well-defined","ground","truth.","We","know","from","the","probability\ntables","that","if","Smoking,","Genetic,","Coughing","are","False,","the\nprobability","of","having","Cancer","is","very","low.","","So,","we","should\nhave","these","three","variables","in","the","Sufficient","Coalition:","this","is\nwhat","we","can","observe","in","figure","9.","The","example","below","shows\nFigure","9.Sufficient","coalition","of","an","observation","that","has","Smoking,\nGenetic,","Coughing","at","False.\nthat","we","are","able","to","identify","the","group","of","variables","that","drive\nthe","occurrence","of","a","cancer.","As","we","see","feature","importance\nas","a","stability","property","accross","the","dataset,","we","propose","to\ncompute","the","stability","of","Sufficient","Coalitions","defined","as","(5.1)\nin","different","strata.","Natural","strata","to","consider","are","obviously\ndefined","by","the","response","variable{Y=k},k=","0,1.","","The\ncorresponding","global","SDP","are","given","in","figure","5.","","For","the\nnegative","","class,","","it","","uses","","mainly","","Smoking,","","Coughing","","and\nGenetic","whereas","for","the","positive","class","is","based","on","many\nmore","","variables.","","","We","","can","","have","","a","","more","","robust","","estimation\nof","the","individual","explanations,","while","we","still","have","a","high-\nlevel","overlook","of","the","important","variables","across","the","data","set.\nHence","we","are","able","to","aggregate","the","local","explanations","in\norder","to","get","a","global","explanation.","","This","aggregation","is","not\nadditive","but","is","based","on","the","frequencies.","","We","think","that","is\nan","important","benefit","of","SDP","over","Shapley","values.","Indeed,\nwe","have","seen","that","the","additive","explanations","based","on","SV","are\nhighly","influenced","by","non-important","variables:","this","makes\nthe","summation","of","(absolute)","SV","over","all","the","data","set","prone\nto","errors","and","misunderstandings.","We","have","also","shown","that\nwe","can","have","better","results","by","conditioning","with","the","Null\nCoalition.\nFigure","10.Global","SDP","given\nY=","0.\nFigure","11.Global","SDP","given\nY=","1.\n6.","Conclusion\nAn","","important","","finding","","of","","this","","work","","is","","the","","central","","role","","of\nthe","reduced","predictors,","","and","the","ability","to","compute","them\nefficiently","under","statistical","and","computational","constraints.\nWe","have","shown","that","we","can","estimate","them","in","a","principled\nway","for","tree-based","models.","Thanks","to","their","computation,","we\nare","able","to","propose","solutions","to","practical","important","problems\nin","XAI.","The","same","decision","probability","appears","to","be","a","useful\nand","tractable","tool","for","intelligibility.","","","An","interesting","path\nto","follow","is","to","relate","the","different","concepts","in","XAI","with\nSDP","and","the","various","Shapley","Values.","","In","particular,","when\nperforming","counter-factual","analysis,","the","definition","of","SDP\nimplies","that","it","is","more","efficient","to","look","for","a","counter-factual\nexample","by","changing","the","variablesX\ni\n,i∈S\n?\nπ\n(x),","rather\nthan","the","variables","inN\nπ\n(x).","An","other","open","question","in","SDP\nis","the","choice","oftandπthat","might","depend","on","the","context\nand","the","corresponding","admissible","error.","A","natural","choice","is\nto","relatetto","the","prediction","variance,","that","can","be","estimated\nby","resampling","techniques","(Barber","et","al.,","2019).\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nReferences\nAas,","K.,","Jullum,","M.,","and","Løland,","A.","Explaining","individual\npredictions","when","features","are","dependent:","More","accurate\napproximations","to","shapley","values,","2020.\nBarber,","R.","F.,","Candes,","E.","J.,","Ramdas,","A.,","and","Tibshirani,\nR.","J.","","","Predictive","inference","with","the","jackknife+.arXiv\npreprint","arXiv:1905.02928,","2019.\nChen,","","H.,","","Janizek,","","J.","","D.,","","Lundberg,","","S.,","","and","","Lee,","","S.-I.\nTrue","to","the","model","or","true","to","the","data?arXiv","preprint\narXiv:2006.16234,","2020.\nChen,","S.,","Choi,","A.,","and","Darwiche,","A.","","The","same-decision\nprobability:","A","new","tool","for","decision","making.","2012.\nChen,","S.,","Choi,","A.,","and","Darwiche,","A.","An","exact","algorithm","for\ncomputing","the","same-decision","probability.","IJCAI","’13,","pp.\n2525–2531.","AAAI","Press,","2013.","ISBN","9781577356332.\nCohen,","S.","B.,","Dror,","G.,","and","Ruppin,","E.","","Feature","selection\nvia","","coalitional","","game","","theory.Neural","","Comput.,","","19(7):\n1939–1961,","","2007.","","","doi:","","10.1162/neco.2007.19.7.1939.\nURLhttps://doi.org/10.1162/neco.2007.\n19.7.1939.\nDua,","D.","and","Graff,","C.","","UCI","machine","learning","repository,\n2017.","URLhttp://archive.ics.uci.edu/ml.\nFriedman,","J.","H.","Greedy","function","approximation:","A","gradient\nboosting","machine.Ann.","Statist.,","29(5):1189–1232,","10\n2001.","","","doi:","","10.1214/aos/1013203451.","","","URLhttps:\n//doi.org/10.1214/aos/1013203451.\nGoldstein,","","A.,","","Kapelner,","","A.,","","Bleich,","","J.,","","and","","Pitkin,","","E.\nPeeking","","inside","","the","","black","","box:","","","Visualizing","","statistical\nlearning","with","plots","of","individual","conditional","expectation.\nJournal","of","Computational","and","Graphical","Statistics,","24\n(1):44–65,","2015.\nHeskes,","T.,","Sijben,","E.,","Bucur,","I.","G.,","and","Claassen,","T.","Causal\nshapley","values:","Exploiting","causal","knowledge","to","explain\nindividual","predictions","of","complex","models.","In","Larochelle,\nH.,","","Ranzato,","","M.,","","Hadsell,","","R.,","","Balcan,","","M.,","","and","","Lin,\nH.","(eds.),Advances","in","Neural","Information","Processing\nSystems","33:","Annual","Conference","on","Neural","Information\nProcessing","Systems","2020,","NeurIPS","2020,","December","6-12,\n2020,","virtual,","2020.","","URLhttps://proceedings.\nneurips.cc/paper/2020/hash/\n32e54441e6382a7fbacbbbaf3c450059-Abstract.\nhtml.\nJanzing,","","D.,","","Minorics,","","L.,","","and","","Bl\n","̈\nobaum,","","P.Feature\nrelevance","","quantification","","in","","explainable","","ai:","","","A","","causal\nproblem.InInternational","","Conference","","on","","Artificial\nIntelligence","and","Statistics,","pp.","2907–2916.","PMLR,","2020.\nLUCAS,","","D.Lucas","","(lung","","cancer","","simple","","set)","","dataset.\nhttp://www.causality.inf.ethz.ch/data/LUCAS.html.\nLundberg,","","S.","","M.","","and","","Lee,","","S.-I.","","","A","","unified","","approach","","to\ninterpreting","model","predictions.","","In","Guyon,","I.,","Luxburg,\nU.","V.,","Bengio,","S.,","Wallach,","H.,","Fergus,","R.,","Vishwanathan,\nS.,","and","Garnett,","R.","(eds.),Advances","in","Neural","Information\nProcessing","Systems","30,","pp.","4765–4774.","2017.\nLundberg,","","S.","","M.,","","Erion,","","G.,","","Chen,","","H.,","","DeGrave,","","A.,\nPrutkin,","J.","M.,","Nair,","B.,","Katz,","R.,","Himmelfarb,","J.,","Bansal,\nN.,","","and","","Lee,","","S.-I.","","","From","","local","","explanations","","to","","global\nunderstanding","","with","","explainable","","ai","","for","","trees.Nature\nmachine","intelligence,","2(1):56–67,","2020a.\nLundberg,","","S.","","M.,","","Erion,","","G.,","","Chen,","","H.,","","DeGrave,","","A.,\nPrutkin,","J.","M.,","Nair,","B.,","Katz,","R.,","Himmelfarb,","J.,","Bansal,\nN.,","","and","","Lee,","","S.-I.","","","From","","local","","explanations","","to","","global\nunderstanding","","with","","explainable","","ai","","for","","trees.Nature\nMachine","Intelligence,","2(1):2522–5839,","2020b.\nMa,","S.","and","Tourani,","R.","Predictive","and","causal","implications","of\nusing","shapley","value","for","model","interpretation.","In","Le,","T.","D.,\nLiu,","L.,","Zhang,","K.,","Kiciman,","E.,","Cui,","P.,","and","Hyv\n","̈\narinen,\nA.","(eds.),Proceedings","of","the","2020","KDD","Workshop","on\nCausal","","Discovery","","(CD@KDD","","2020),","","San","","Diego,","","CA,\nUSA,","24","August","2020,","","volume","127","ofProceedings","of\nMachine","Learning","Research,","pp.","23–38.","PMLR,","2020.\nURLhttp://proceedings.mlr.press/v127/\nma20a.html.\nMeinshausen,","","N.","","and","","B\n","̈\nuhlmann,","","P.","","","Stability","","selection.\nJournal","","of","","the","","Royal","","Statistical","","Society:","","","","Series","","B\n(Statistical","Methodology),","72(4):417–473,","2010.\nRibeiro,","M.","T.,","Singh,","S.,","and","Guestrin,","C.","","”","why","should\ni","trust","you?”","explaining","the","predictions","of","any","classifier.\nInProceedings","of","the","22nd","ACM","SIGKDD","international\nconference","on","knowledge","discovery","and","data","mining,","pp.\n1135–1144,","2016.\nShapley,","","","L.","","S.Greedy","","function","","approximation:","","","","A\ngradient","","","boosting","","","machine.Contribution","","","to","","","the\nTheory","","of","","Games,","","2:307–317,","","1953.URLhttps:\n//www.rand.org/content/dam/rand/pubs/\nresearch_memoranda/2008/RM670.pdf.\nStrumbelj,","E.","and","Kononenko,","I.","","An","efficient","explanation\nof","individual","classifications","using","game","theory.Journal\nof","Machine","Learning","Research,","11:1–18,","01","2010.","","doi:\n10.1145/1756006.1756007.\nSun,","","X.,","","Liu,","","Y.,","","Li,","","J.,","","Zhu,","","J.,","","Liu,","","X.,","","and","","Chen,","","H.\nUsing","cooperative","game","theory","to","optimize","the","feature\nselection","problem.Neurocomputing,","97:86–93,","2012.","doi:\n10.1016/j.neucom.2012.05.001.","","URLhttps://doi.\norg/10.1016/j.neucom.2012.05.001.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nWang,","E.,","Khosravi,","P.,","and","Van","den","Broeck,","G.","","Towards\nprobabilistic","","sufficient","","explanations.InExtending\nExplainable","","AI","","Beyond","","Deep","","Models","","and","","Classifiers\nWorkshop","at","ICML","(XXAI),","2020.\nYu,","B.","and","Kumbier,","K.","Veridical","data","science.Proceedings\nof","the","National","Academy","of","Sciences,","117(8):3920–3929,\n2020.\nZaeri-Amirani,","M.,","Afghah,","F.,","and","Mousavi,","S.","A","feature\nselection","method","based","on","shapley","value","to","false","alarm\nreduction","in","icus","a","genetic-algorithm","approach.","volume\n2018,","pp.","319–323,","07","2018.","doi:","10.1109/EMBC.2018.\n8512266.\n\nSupplementary","Materials",":\nThe","Shapley","value","of","coalition","of","variables","provides","better","estimates\nMarch","26,","2021\nThis","document","is","organized","as","follows:\nA.Proofs\nB.Fast","Algorithm","for","the","computation","of","Shapley","Values\nC.Individual","Shapley","Values","for","dummy","variables\nD.Experimental","details\nE.Plug-In","estimator","of","Marginal","expectation\n11\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nA","Proofs\nThis","section","gathers","all","the","proofs","of","the","propositions","and","claims","of","the","main","paper.\n2.","Multiple","ways","of","computing","the","Shapley","value","of","categorical","variables\n2.1.","The","Shapley","value","of","a","categorical","variable\nProposition","2.1.For","allx∈X,","and","ify\n1:K−1\n=C(y)then\n{\nφ\nC\n(\n","̃\nf;x,y\n1:K−1\n)","","","","=φ\nY\n(f;x,y)\nφ\nX\n(\n","̃\nf;x,y\n1:K−1\n)","","","","=φ\nX\n(f;x,y)\n(2.1)\nProof.\nAs","we","consider","only","doable(x,y\n1:K−1\n),","then∃!y∈{1,...,K}such","thatC(y)","=y\n1:K−1\n.","We","have","the","coalition\nC={1,...,K−1},","and","number","of","variablesp=K,","meaning\nφ\n{1,...,K−1}\n(\n","̃\nf;x,y\n1:K−1\n)","=\n1\n2\n{\n1\n(\n1\n0\n)\n∆(\n","̃\nf;∅,C)","+\n1\n(\n1\n1\n)\n∆(\n","̃\nf;{X},C)\n}\nwhere\n∆(\n","̃\nf;∅,C)","=E\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)|Y\n1:K−1\n=y\n1:K−1\n]\n−E\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)|∅\n]\n=E\nP\n[\n","̃\nf(X,C(Y))|Y=y\n]\n−E\nP\n[\n","̃\nf(X,C(Y))\n]\n=E\nP\n[f(X,Y)|Y=y]−E\nP\n[f(X,Y)]\nIndeed\nE\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)|Y\n1:K−1\n=y\n1:K−1\n]\n=\n∫\n","̃\nf(x,y\n1:K−1\n)dP(x|y\n1:K−1\n)\n=\n∫\n","̃\nf(x,y\n1:K−1\n)\ndP(x,y\n1:K−1\n)\nP(y\n1:K−1\n)\n=\n∫\n","̃\nf(x,C(y))\ndP(x,C(y))\nP(C(y))\n=\n∫\nf(x,y)\ndP(x,y)\nP(y)\nIn","addition,\n∆(\n","̃\nf;{X},C)","=E\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)|X=x,Y\n1:K−1\n=y\n1:K−1\n]\n−E\n","̃\nP\n[\n","̃\nf(X,Y\n1:K−1\n)|X=x\n]\n=\n","̃\nf(x,y\n1:K−1\n)−E\nP\n[\n","̃\nf(X,C(Y))|X=x\n]\n=\n","̃\nf(x,C(y))−E\nP\n[\n","̃\nf(X,C(Y))|X=x\n]\n=f(x,y)−E\nP\n[f(X,y)|X=x]\nφ\n{1,...,K−1}\n(\n","̃\nf;x,y\n1:K−1\n)","=\n1\n2\n(E\nP\n[f(X,Y)|Y=y]−E\nP\n[f(X,Y)])\n+\n1\n2\n(f(x,y)−E\nP\n[f(X,y)|X=x])\nWe","can","recognize","that","we","have","exactlyφ\n{1,...,K−1}\n(\n","̃\nf;x,y\n1:K−1\n)","","=φ\nY\n(f;x,y).","","From","Equation","2.1,","we","derive","that\nφ\nX\n(\n","̃\nf;x,y\n1:K−1\n)","=φ\nX\n(f;x,y).\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\n4.","Identifying","Active","and","Null","coalitions\n4.1.","Same","Decision","Probability\nProposition","4.1.\nLetfa","probabilistic","predictor","and","its","binary","classifierCwith","threshold","T,Q\nS,x\nthe","law","ofX\n","̄\nS\n|X\nS\n=x\nS\n,\nthen","theSDP\nS\n(f;x)can","be","written","explicitly","with","the","reduced","predictor:\nSDP\nS\n(f;x)","=\nE\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)]−E\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)<","T]\nE\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)≥T]−E\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)<","T]\n(4.1)\nProof.First","note","thatSDP\nS\n(f;x)","=P\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)≥T]\nE\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)]","=E\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)<","T]P\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)<","T]\n+E\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)|f(x\nS\n,X\n","̄\nS\n)≥T]P\nX\n","̄\nS\n|X\nS\n=x\nS\n[f(x\nS\n,X\n","̄\nS\n)≥T]\nRearranging","the","terms","leads","to","equation","4.1.","The","proof","of","Proposition","4.3","is","similar.\nProposition","4.2.Let","a","tree","function","define","asf(x)","=\n∑\nM\nm=1\nf\nm\n1\nL\nm\n(x),Q\nS,x\nthe","law","ofX\n","̄\nS\n|X\nS\n=x\nS\n.","We","can","compute\nthe","conditional","expectation","of","the","euclidean","distance","with","our","Plug-In","estimator:\nE\nQ\nS,x\n[d(f(x\nS\n,X\n","̄\nS\n),f)]","=E\nQ\nS,x\n[\n(\n∑\nm\nf\nm\n1\nL\nm\n(x)−f)\n2\n]\n=\n∑\nm\nf\n2\nm\nP\nQ\nS,x\n[\nL\nm\n(x)\n]\n+f\n2\n−2f\n∑\nm\nf\nm\nP\nQ\nS,x\n[\nL\nm\n(x)\n]\nHence,","we","can","approximateP\nQ\nS,x\n[\nL\nm\n(x)\n]\n'\nN(L\nm\n)\nN(L\nS\nm\n)\nas","in","Equation","3.1.\nProof.Since","the","leaves","form","a","partition","of","the","space,","we","can","unfold","the","equation","without","holding","the","double","terms",":\nE\nQ\nS,x\n[d(f(x\nS\n,X\n","̄\nS\n),f)]","=E\nQ\nS,x\n[\n(\n∑\nm\ny\nm\n1\nL\nm\n(x)−f)\n2\n]\n=\n∑\nm\ny\n2\nm\nP\nQ\nS,x\n[\nL\nm\n(x)\n]\n+f\n2\n−2f\n∑\nm\ny\nm\nP\nQ\nS,x\n[\nL\nm\n(x)\n]\nProposition","","4.3.For","","any","","Random","","Forest","","regressorF(x)","","=\n∑\nB\nb=1\nf\nb\n(x)\nB\nwithf\nb\n(x)","","=\n∑\nM\nb\nm=1\nf\nm,b\n1\nL\nm,b\n(x)\n,","","the\nconditional","expectation","of","the","Euclidean","distance","is","equal","to\nE\nX\n","̄\nS\n|X\nS\n=x\nS\n[\n(\n∑\nb\nf\nb\n(x)\nB\n−f)\n2\n]\n=f\n2\n+\nB\n∑\nb=1\nM\nb\n∑\nm=1\n(\n1\nM\n2\nf\n2\nm,b\n−\n2f\nM\nf\nm,b\n)P\nX\n","̄\nS\n|X\nS\n=x\nS\n(L\nm,b\n)\n+\n1\nM\n2\nB\n∑\nb,l=1b6=l\nM\nb\n∑\ni=1\nM\nl\n∑\nj=1\nf\nm,b\nf\nb,l\nP\nX\n","̄\nS\n|X\nS\n=x\nS\n(L\ni,b\n(x)∩L\nj,l\n(x))\nRemark4.1.We","have","an","additional","term","that","we","need","to","estimate","and","approximateP\nX\n","̄\nS\n|X\nS\n=x\nS\n(L\ni,b\n(x)∩L\nj,l\n(x))\n,","but","we\ncan","still","use","the","Plug-In","estimator","to","compute","it.","Indeed,\nP\nX\n","̄\nS\n|X\nS\n=x\nS\n(L\ni,b\n(x)∩L\nj,l\n(x))≈P(L\ni,b\n(x)∩L\nj,l\n(x)|x\nS\n∈L\nS\ni,b\n∩L\nS\nj,l\n)\n≈\nN(L\ni,b\n(x),L\nj,l\n(x))\nN(L\nS\ni,b\n,L\nS\nj,l\n)\n(4.2)\nWhere\n•N(L\ni,b\n(x),L\nj,l\n(x))is","the","number","of","observations","in","the","leafL\ni,b\n(x)andL\nj,l\n(x)\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\n•N(L\nS\ni,b\n,L\nS\nj,l\n)is","the","number","of","observations","satisfying","the","conditionsx\nS\n∈L\nS\ni,b\n∩L\nS\nj,l\nacross","all","the","leaves","of","the","tree.\nProposition","4.4.IfX∼N(μ,Σ),","thenX\n","̄\nS\n|X\nS\n=x\nS\nis","also","multivariate","gaussian","with","meanμ\n","̄\nS|S\nand","covariance","matrix\nΣ\n","̄\nS|S\nequal:\nμ\n","̄\nS|S\n=μ\n","̄\nS\n+","Σ\n","̄\nS,S\nΣ\n−1\nS,S\n(x\nS\n−μ\nS\n)andΣ\n","̄\nS|S\n=","Σ\n","̄\nS\n","̄\nS\n−Σ\n","̄\nSS\nΣ\n−1\nSS\nΣ\nS,\n","̄\nS\nB.","Fast","Algorithm","for","the","computation","of","Shapley","Values\nIn","section","3.1.","of","the","main","paper,","we","have","introduced","a","plug-in","estimator","of","the","conditional","expectation\nf\nS\n(x\nS\n)","=\nM\n∑\nm=1\nf\nm\nP\nX\n(L\nm\n|X\nS\n=x\nS\n)\nthat","is","based","on","an","approximation","of","the","conditional","expectation","by","event{X\nS\n=x\nS\n}by","a","conditional","expectation","based\non","event{X\nS\n∈L\nS\nm\n}.","For","sake","of","notational","simplicity,","we","have","denotedL\nS\nm\nand","we","have","removed","the","dependence","onx,\nbut","we","insist","on","the","fact","that","we","still","haveL\nS\nm\n=L\nS\nm\n(x).","Thanks","to","this","approximation,","we","can","propose","a","straightforward\nestimate","based","on","empirical","frequencies,","but","we","focus","here","on","the","computational","efficiency","offered","by","this","approximation.","It\nis","well-known","that","the","complexity","of","the","computation","of","a","Shapley","value","is","exponential","as","we","need","to","compute2\np\ndifferent\ncoalitions","for","each","observationx.","We","show","below","that","the","complexity","can","be","made","much","lower","as","it","is","not","exponential","in\nthe","total","number","of","of","variablep,","but","it","is","exponential","in","the","depth","of","the","tree.\nIndeed,","we","are","interested","in","computing","the","predictor\n","̃\nf\nS\n(x\nS\n)","=\nM\n∑\nm=1\nf\nm\nP\nX\n(\nL\nm\n|X\nS\n∈L\nS\nm\n(x)\n)\nthat","can","be","used","for","defining","a","new","cooperative","game","based","on","the","value","function\nS7→","̃v(f,S),\n","̃\nf\nS\n(x\nS\n).\nFor","any","coalitionC,","our","estimate","of","the","Shapley","valueφ\nC\n(x)is","the","Shapley","value","of","the","cooperative","game","̃v(f,S)defined\nas\n","̃\nφ\nC\n(\n","̃\nf;x)","=\n1\np−|C|+","1\np−|C|\n∑\nk=0\n1\n(\np−|C|\nk\n)\n∑\nS∈S\nk\n(C)\n(\n","̃\nf\nS∪C\n(x\nS∪C\n)−\n","̃\nf\nS\n(x\nS\n)\n)\n(4.3)\nWe","show","in","the","next","proposition","that","the","game","̃vcan","be","split","into","the","sum","of","smaller","games","(we","consider","onlyC={i}in\nthe","proposition,","but","it","remains","true","for","any","coalitionC).\nProposition","4.5.Letf(x)","=\n∑\nM\nm=1\nf\nm\n1\nL\nm\n(x)\nbe","a","tree","based","onpvariablesX=","(X\n1\n,...,X\np\n).","","We","introduce","for\neach","leafL\nm\nthe","set","of","variablesS\nm\nused","in","the","tree","path","defining","the","leafL\nm\n.","For","any","variableX\ni\n,","the","SVφ\ni\n(x)can","be\ndecomposed","into","the","sum","ofMcooperative","games","defined","on","each","leafL\nm\n,","and","we","have\n","̃\nφ\ni\n(x)","=\nM\n∑\nm=1\n","̃\nφ\nm\ni\n(x)\nwhere\n","̃\nφ\nm\ni\n(x)is","a","reweighted","version","of","the","Shapley","Value","of","the","cooperative","game","with","value","function\n","̃v(f,S)","=P\nX\n(\nL\nm\n|X\nS\n∈L\nS\nm\n(x)\n)\n.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nProof.By","definition,","we","have","for","a","single","variable\n","̃\nφ\ni\n(x)","=\n1\np\n∑\nS⊆[p]\\{i}\n(\np−1\n|S|\n)\n−1\n(\n","̃\nf\nS∪i\n(x\nS∪i\n)−\n","̃\nf\nS\n(x\nS\n)\n)\n=\n1\np\n∑\nS⊆[p]\\{i}\n(\np−1\n|S|\n)\n−1\n(\nM\n∑\nm=1\nf\nm\n[\nP(L\nm\n|X\nS∪i\n∈L\nS∪i\nm\n)−P(L\nm\n|X\nS\n∈L\nS\nm\n]\n)\n=\n1\np\nM\n∑\nm=1\n∑\nS\n′\n⊆S\nm\n\\{i}\n[(\np−1\n|S\n′\n|\n)\n−1\nf\nm\n[\nP(L\nm\n|X\nS\n′\n∪i\n∈L\nS\n′\n∪i\nm\n)−P(L\nm\n|X\nS\n′\n∈L\nS\n′\nm\n)\n]\n+\n∑\nZ6=∅,Z⊆\nS\nm\n∪i\n(\np−1\n|Z|+|S\n′\n|\n)\n−1\nf\nm\n[\nP(L\nm\n|X\nS\n′\n∪Z∪i\n∈L\nS\n′\n∪Z∪i\nm\n)−P(L\nm\n|X\nS\n′\n∪Z\n∈L\nS\nm\n∪Z\nm\n)\n]\n]\nHowever,","ifZ⊆\n","̄\nS\nm\n,S⊆S\nm\n:\nP\nX\n(L\nm\n|X\nZ∪S\n∈L\nZ∪S\nm\n)","=P\nX\n(L\nm\n|X\nS\n∈L\nS\nm\n).(4.4)\nWe","shall","remark","that","the","identity","of","eq.","","(4.4)","is","not","true","anymore","if","we","consider","the","conditional","probabilityX\nS\n=x\nx\n).\nTherefore,","the","SV\n","̃\nφ\ni\n(x)can","be","rewrite","as:\n","̃\nφ\ni\n(x)","=\n1\np\nM\n∑\nm=1\n∑\nS\n′\n⊆S\nm\n\\{i}\n[(\np−1\n|S\n′\n|\n)\n−1\nf\nm\n[\nP(L\nm\n|X\nS\n′\n∪i\n∈L\nS\n′\n∪i\nm\n)−P(L\nm\n|X\nS\n′\n∈L\nS\n′\nm\n)\n]\n+\n∑\nZ6=∅,Z⊆S\nm\n∪i\n(\np−1\n|Z|+|S\n′\n|\n)\n−1\nf\nm\n[\nP(L\nm\n|X\nS\n′\n∪i\n∈L\nS\n′\n∪i\nm\n)−P(L\nm\n|X\nS\n′\n∈L\nS\n′\nm\n)\n]\n]\n=\n1\np\nM\n∑\nm=1\n∑\nS\n′\n⊆S\nm\n\\{i}\n[(\np−1\n|S\n′\n|\n)\n−1\n+\n∑\nZ6=∅,Z⊆\nS\nm\n∪i\n(\np−1\n|Z|+|S\n′\n|\n)\n−1\n]\nf\nm\n[\nP(L\nm\n|X\nS\n′\n∪i\n∈L\nS\n′\n∪i\nm\n)−p(L\nm\n|X\nS\n′\n∈L\nS\n′\nm\n)\n]\n]\n,\nM\n∑\nm=1\n","̃\nφ\nm\ni\n(x)\nEach","term\n","̃\nφ\nm\ni\n(x)\nintroduced","in","the","sum","is","a","re-weighted","Shapley","value","of","the","cooperative","game","defined","in","each","leafL\nm\nwith","the","variablesS\nm\nand","associated","to","the","value","functionP(L\nm\n|X\nS\n′\n∈L\nS\n′\nm\n)\n,","for","all","coalitionS\n′\n⊆S\nm\n.","As","shown","above,\nit","is","not","the","standard","Shapley","Value","as","we","considerpvariables","in","the","normalisation","(and","not|S\nm\n|,","and","we","need","to","take","into\naccount","the","additional","contributions","of","the","coalitions","that","partly","overlapsS\nm\nand\n","̄\nS\nm\n:","this","adds","the","additional","constant\n∑\nZ6=∅,Z⊆S\nm\n∪i\n(\np−1\n|Z|+|S\n′\n|\n)\n−1\n.\nA","straightforward","algorithm","for","computing","SV","has","a","complexityO(p×tree-depth×2\np\n)(calledBrute","Force","Algorithm):\nwe","havepvariables,2\np\ngroups","of","variables","to","consider","each","time,","and","we","need","to","go","down","into","the","tree.","Instead,","we","suggest\nto","compute","SV","leaf","by","leaf","thanks","to","equation","(eq.4.5).In","that","case,","the","computation","of","the","SV","for","thepvariables","is","done","by\nsumming","overMgames","(leafs),","each","of","them","having","a","number","of","variables|S\nm\n|lower","thantree-depth.","Consequently,\nthe","complexity","isO(p×M×2\ntree-depth\n)in","worst","cases.\nTheMulti-Games","algorithmimproves","dramatically","the","computational","complexity","astree-depthis","often","much","lower\nthanp.","Moreover,","the","algorithm","is","linear","in","the","number","of","observations","where","we","want","to","compute","the","SV.\nThe","algorithm","is","describes","below,","we","use","the","following","notationsN(L\n∅\nm\n)","=\n∑\nM\nm=1\nN(L\nm\n)and1\nL\n∅\nm\n(x\n∅\n)","=","1.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nAlgorithm","2Multi-Games","Algorithm-","Compute","SV","in","the","worst","case","inO(p×M×2\ntree-depth\n)\nInputs",":x,f(x)","=\n∑\nM\nm=0\nf\nm\n1\nL\nm\n(x)\np=length(x)\nφ=zeros(p)\nform=","1toMdo\nfori∈[p]do\nifi","/∈S\nm\nthen\ncontinue;/\n*\nskip","to","next","variable\n*\n/\nend\nforS⊆S\nm\ndo\nφ[i]+","=\n(\n(\np−1\n|S|\n)\n−1\n+\n∑\np−|S\nm\n|\nk=1\n(\np−1\nk+|S|\n)\n−1\n)(\n1\nL\nS∪i\nm\n(x\nS∪i\n)\nN(L\nm\n)\nN(L\nS∪i\nm\n)\n−1\nL\nS\nm\n(x\nS\n)\nN(L\nm\n)\nN(L\nS\nm\n)\n)\nend\nend\nend\nreturnφ\nRemark4.2.The","algorithm","can","be","vectorized","in","order","to","compute","SV","of","several","observations","at","the","same","time.\nC","Individual","Shapley","values","for","dummy","variables\nWe","give","some","partial","results","for","the","Shapley","Values","of","the","modalitiesY=k,","based","on","the","dummy","encoding","considered","in\nsection","2.","","Indeed","equation","2.4","introducesφ\nk\n(\n","̃\nf,x,y\n1:K−1\n),","and","proposition","2.1","claims","that","their","sum","is","different","in","all\ngenerality","of","the","SV","ofY.","","In","this","section,","we","give","a","deeper","insight","into","these","values","and","show","that","are","related","multiple\ncomparisons","between","modalities.\nWe","compute","the","Shapley","Value","at","point(x,y=i)","=","(x,0,0,...,1,...,0)","=","(x,C(y)):","","for","ease","of","notation,","we","set\nY\n0\n=X,","and","we","compute","also","the","Shapley","valuesφ\nk\n(\n","̃\nf;x,y\n1:K−1\n)fork=","1,...,K−1.","","We","recall","that","we","need","to\ncompute\n1\nK\nK−1\n∑\nk=0\n1\n(\nK−1\nk\n)\n∑\nZ⊆J1..KK\\i\n|Z|=k\n∆(\n","̃\nf;Z,i).\nwhere∆denotes","the","difference","between","the","value","function","evaluated","atZ∪{i}andZ.","If","we","examine","the","terms∆(\n","̃\nf;Z,i),\nthe","computation","needs","to","take","into","account","ifX=Y\n0\nis","part","of","the","conditioning","variable","of","not.","Indeed,","we","have","for","each\nk≥1,\n∑\nZ⊆J0..K−1K\\i\n|Z|=k\n∆(\n","̃\nf;Z,i)","=\n∑\nZ⊆J1..K−1K\\i\n|Z|=k\n∆(\n","̃\nf;Z,i)","+\n∑\nZ\n′\n⊆J1..K−1K\\i\n|Z\n′\n|=k−1\n∆(\n","̃\nf;Z\n′\n∪{0},i).(1.5)\nWe","start","by","computing","the","first","term","in","the","right","hand","side,","and","it","involves","only","the","dummies,","and","not","the","quantitative\nvariable.\nProposition","1.1\n(Computation","of","Contributions","in","Shapley","withoutX).We","compute","the","Shapley","values","of","the","variableY\ni\n,","when","we","have","the","observations(x,y\n1:K−1\n)","=","(x,C(i))fori∈{1,...,K}.","We","consider","anyZ\n′\n⊆J1..K−1K\\i,","with\n|Z\n′\n|=k≥1andZ\n′\n={j\n1\n,...,j\nk\n}.","In","that","case,\n∆(\n","̃\nf;Z,i)","=E\nP\n[f(X,Y)|Y=i]−E\nP\n[f(X,Y)|Y","/∈{j\n1\n,...,j\nk\n}](1.6)\nProof.\nWe","haveY\ni\n=","1⇔Y=i,","and","forZ\n′\n⊆J1..K−1K\\{0,i},","we","considerZ\n′\n={j\n1\n,...,j\nk\n},","with1≤j\n1\n<···<\nj\nk\n≤K−1,\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nE\n","̃\nP\n[\n","̃\nf(Y\n0\n,Y\n1:K−1\n)|Y\nj\n1\n=","0,...,Y\nj\nk\n=","0,Y\ni\n=","1\n]\n=E\n","̃\nP\n[\n","̃\nf(Y\n0\n,Y\n1:K−1\n)|Y\ni\n=","1\n]\n=E\n","̃\nP\n[\n","̃\nf(Y\n0\n,C(Y))|Y\ni\n=","1\n]\n=E\nP\n[f(Y\n0\n,Y)|Y=i]\nbecause","for","allj\n1\n,...,j\nk−1\n6=i,","we","have{Y\nj\n1\n=","0,...,Y\nj\nk\n=","0,Y\ni\n=","1}={Y\ni\n=","1}.\nMoreover,\nE\n","̃\nP\n[\n","̃\nf(Y\n0\n,Y\n1:K−1\n)|Y\nj\n1\n=","0,...,Y\nj\nk\n=","0\n]\n=E\nP\n[\n","̃\nf(Y\n0\n,C(Y))|Y6=j\n1\n,...,j\nk\n]\nHence","forZ⊆J1..K−1K\\i,","we","have\n∆(\n","̃\nf;Z,i)","=E\nP\n[f(X,Y)|Y=i]−E\nP\n[f(X,Y)|Y","/∈{j\n1\n,...,j\nk\n}].\nThe","second","term","of","the","right","hand","side","is","given","below.\nProposition","1.2(Computation","of","Contributions","in","Shapley","withX).We","compute","the","Shapley","values","only","for","the","variableY\ni\n,","when","we","have","the","observations","doable(x,y\n1:K−1\n)","=","(x,C(i))fori∈{1,...,K}.","We","consider","anyZ\n′\n⊆J1..K−1K\\i,\nwith|Z\n′\n|=k−1≥1,","andZ\n′\n={j\n1\n,...,j\nk−1\n}.","In","that","case,\n∆(\n","̃\nf;Z\n′\n∪{0},i)","=E\nP\n[f(X,Y)|X=x,Y=i]−E\nP\n[f(X,Y)|X,Y","/∈{j\n1\n,...,j\nk−1\n}](1.7)\nProof.\nWe","assume","that","we","have","a","subset|Z\n′\n|=k−1,","such","thatZ\n′\n⊆J1..K−1K\\i.","This","means","thatZ\n′\n={j\n1\n,...,j\nk−1\n},\nwith1≤j\n1\n,...,j\nk−1\n≤K−1.","We\nE\n","̃\nP\n[\n","̃\nf(Y\n0\n,Y\n1:K−1\n)|Y\n0\n=x,Y\nj\n1\n=","0,...,Y\nj\nk−1\n=","0,Y\ni\n=","1\n]\n=E\n","̃\nP\n[\n","̃\nf(Y\n0\n,Y\n1:K−1\n)|Y\n0\n=x,Y\ni\n=","1\n]\n=E\nP\n[\n","̃\nf(Y\n0\n,C(Y))|Y\n0\n=x,Y=i\n]\n=E\nP\n[f(Y\n0\n,C(Y))|Y\n0\n=x,Y=i]\nand\nE\n","̃\nP\n[\n","̃\nf(Y\n0\n,Y\n1:K−1\n)|Y\n0\n=x,Y\nj\n1\n=","0,...,Y\nj\nk−1\n=","0\n]\n=E\nP\n[\n","̃\nf(Y\n0\n,C(Y))|Y\n0\n=x,Y","/∈{j\n1\n,...,j\nk−1\n}\n]\n=E\nP\n[f(Y\n0\n,Y)|Y\n0\n=x,Y","/∈{j\n1\n,...,j\nk−1\n}]\nFinally,","we","can","give","several","examples","of","the","different","increments","involved","in","the","Shapley","values","of","each","variableXorY\nk\n.","If\nk=","0,","thenZ\n′\n=∅and\n∆(\n","̃\nf;Z\n′\n,i)","=","∆(\n","̃\nf;∅,i)","=E\nP\n[f(X,Y)|Y=i]−E\nP\n[f(X,Y)]\nIfk=","1,","thenZ\n′\n={0}orZ\n′\n={j}6={i},\n∆(\n","̃\nf;Z\n′\n,i)","=","∆(\n","̃\nf;","0,i)","=E\nP\n[f(X,Y)|X=x,Y=i]−E\nP\n[f(X,Y)|X=x]\n∆(\n","̃\nf;Z\n′\n,i)","=","∆(\n","̃\nf;{j},i)","=E\nP\n[f(X,Y)|Y=i]−E\nP\n[f(X,Y)|Y6=j]\nFork=K−1,Z\n′\n={1,...K−1},\n∆(\n","̃\nf;{1,...K−1},i)","=E\nP\n[f(X,Y)|X=x,Y=i]−E\nP\n[f(X,Y)|X=x,Y6=i]\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nThe","propositions","1.1","and","1.2","show","that","the","individual","Shapley","value","for","the","variable","(modality)Y\ni\nis","a","weighted","mean","of","the\ndifference","between","classeiand","group","of","classes:\n{\nE\nP\n[f(X,Y)|Y=i]−E\nP\n[f(X,Y)|Y","/∈{j\n1\n,...,j\nk\n}]\nE\nP\n[f(X,Y)|X=x,Y=i]−E\nP\n[f(X,Y)|X,Y","/∈{j\n1\n,...,j\nk−1\n}]\nFinally,","we","can","also","compute","the","Shapley","values","of","the","other","variablesY\nj\nat","point(x,y=i),","forj6=i.","In","that","case,","the\ndifference∆(\n","̃\nf;Z\n′\n,j),j6=iare","of","the","type","of\n\n\n\n\n\n\n\n\n\nE\nP\n[f(X,Y)|Y","/∈{j,j\n1\n,...,j\nk\n}]−E\nP\n[f(X,Y)|Y","/∈{j\n1\n,...,j\nk\n}]\nE\nP\n[f(X,Y)|Y=i]−E\nP\n[f(X,Y)|Y=i]\nE\nP\n[f(X,Y)|X=x,Y","/∈{j,j\n1\n,...,j\nk\n}]−E\nP\n[f(X,Y)|X,Y","/∈{j\n1\n,...,j\nk−1\n}]\nE\nP\n[f(X,Y)|X=x,Y=i]−E\nP\n[f(X,Y)|X,Y=i]\nThe","Shapley","values","computes","a","mean","of","the","difference","between","different","aggregation","of","modalities,","that","contains","or","not","the\nvariable","of","interest.\nAs","a","conclusion","of","this","part,","we","see","that","the","individual","Shapley","valuesφ\nk\n(\n","̃\nf;x,y\n1:K−1\n)perform","a","multiple","comparison","of\nthe","means","obtained","by","aggregating","the","classes","or","modalities","in","various","ways,","looking","at","the","presence","or","not","of","the","modality\nk.","These","differences","of","means","have","weights\n1\n(\nK−1\nk\n)\nwherekis","basically","the","number","of","classes","of","the","variableYthat","we\naggregate.\nConsequently","the","sum\n∑\nK\nk=1\nφ\nk\n(\n","̃\nf;x,y\n1:K−1\n)is","clearly","different","from","the\nφ\nY\n(f;x,y)","=\n1\n2\n(E[f(X,Y)|Y=y]−E[f(X,Y)])","+\n1\n2\n(f(x,y)−E[f(X,Y)|X=x]).\nThis","latter","has","a","much","more","global","analysis","that","aims","at","measuring","how","the","meanE[f(X,Y)|Y=y]in","the","various","classes\nchanges","w.r.tE[f(X,Y)],","while","the","individual","Shapley","focus","on","the","difference","between","subgroups","of","classes.\nD","EXPERIMENTAL","SETTINGS\nAll","","our","","experiments","","are","","reproducible","","and","","can","","be","","found","","on","","the","","github","","repositoryActive","","Coalition","","of","","Variables,\nwww.github.com/salimamoukou/acv00.\n1.1.","Toy","model","of","Section","2.2.1\nRecall","that","the","model","is","a","linear","predictor","with","categorical","variables","define","asf(X,Y)","=B\nY\nXwithX|Y=y∼N(μ\ny\n,Σ\ny\n)\nandP(Y=y)","=π\ny\n,Y∈{a,b,c}.\nFor","the","experiments","in","Figure","1","and","2,","we","setπ\ny\n=\n1\n3\n,μ\ny\n=","0∀y∈{a,b,c}.","We","use","a","random","matrices","generated","from","a\nWishart","distribution.","The","covariance","matrices","are:\nΣ\na\n=\n\n\n0.41871254−0.7900613610.46956991\n−0.790061361.90865098−0.82571655\n0.46956991−0.825716550.95835472\n\n\n,Σ\nb\n=\n\n\n0.553260810.11811951−0.70677924]\n0.118119512.73312979−2.94400196\n−0.70677924−2.944001964.22105088\n\n\n,Σ\nc\n=\n\n\n9.28599661.128726462.4224434\n1.128726460.92891237−0.14373393\n2.4224434−0.143733931.81601676\n\n\nfory∈{a,b,c}respectively.\nThe","coefficients","areB\na\n=","[1,3,5],B\nb\n=","[−5,−10,−8],B\nc\n=","[6,1,0]and","the","selected","observation","in","figure","1","values","is\nx=","[−1.15151515,3.50850731,−1.28257141,1.,0.,0.]\n1.2.","Model","trained","on","Census","Data","of","Section","2.2.2\nThe","parameters","of","the","Random","Forest","used","in","this","section","are:","estimators=2,","max","depth=15,","min","samples","leaf=10,","random\nstate=2021.","It","has","an","accuracy","of86%and","was","trained","on","4","variables:","Education,","Marital","Status,","Race,","Workclass.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\n1.3.","Linear","model","of","Section","3.1.1\nThe","","dataD=","","(x\ni\n,z\ni\n)\n1≤i≤n\nare","","generated","","from","","a","","linear","","regressionZ=B\nt\nXwithX∼","N(μ,Σ)whereμ=","","0,\nΣ","=\n\n\n3.29170917−1.056682553.13134267\n−1.056682557.1972724−3.26516336\n3.13134267−3.265163363.72558998\n\n\n,B=","[0.5,10,−4],n=","10000.\nWe","used","a","decision","tree","onDwith","the","following","parameters:","min","samples","leaf=10,","random","state=2877.","The","Mean","Squared\nError","(MSE)","are","MSE=","1.546on","Test","Set","and","MSE=","0.934on","Training","Set.\n1.4.","Toy","model","of","Section","4.2\nModel","is","same","as","1.1","with","the","following","parameters:π\ny\n=\n1\n3\n,μ\ny\n=","0∀y∈{a,b,c}.","For","covarianceΣ\ny\n,","we","used","a","random\nmatrix","generated","from","a","Wishart","distribution.","The","values","used","are:\n\n\n\n\n\n\n7.060217346.254370960.93988464−2.63006016−5.05313408\n6.254370967.111693253.60447888−1.09159294−6.70063316\n0.939884643.604478885.982345482.26837008−4.07866549\n−2.63006016−1.091592942.268370082.338537750.66676669\n−5.05313408−6.70063316−4.078665490.666766697.54928006\n\n\n\n\n\n\n,\n\n\n\n\n\n\n1.10024448−2.05714423−0.70124936−0.543614270.35289562\n−2.057144236.55691981−0.671235572.23271169−0.73350145\n−0.70124936−0.671235572.47842554−0.234109551.11591119\n−0.543614272.23271169−0.234109551.264655080.3616061\n0.35289562−0.733501451.115911190.36160613.12144679\n\n\n\n\n\n\n,\n\n\n\n\n\n\n4.392822351.470653984.22447202−1.94787456−1.41195954\n1.470653982.536225870.47361504−1.261555451.02024204\n4.224472020.473615045.13977882−2.17268713−3.02963689\n−1.94787456−1.26155545−2.172687132.0891941.39065915\n−1.411959541.02024204−3.029636891.390659153.29291599\n\n\n\n\n\n\nfory∈{a,b,c}respectively.","‘\nThe","coefficients","are:B\na\n=","[9,5,−8,0,0],B\nb\n=","[0,0,−6,−8,−9],B\nc\n=","[4,9,13,0,0]and","the","selected","observation","in\nfigure","6","isx=","[2.0601348,2.00732006,−0.90904155,−1.91465107,−3.7068906,1.,0].\nWe","use","a","decision","tree","with","the","following","parameters:","min","samples","leaf=5,","min","samples","split=10,","max","depth=20,","random\nstate=2021.","The","MSE","=","26.407,","and","on","Test","set,","MSE=","8.643","on","Training","set.\n1.5.","Model","used","for","Lucas","Dataset","in","Section","5\nIn","figure","13","and","14","we","can","find","the","graph","and","the","probabilities","defining","the","Bayesian","network","associated","to","the","Lucas\nDataset.","We","use","a","decision","tree","with","the","following","parameters:","min","samples","leaf=20,","random","state=212.","The","accuracy","is\n0.9230919439227646","on","Training","set","and","0.9127666666666667","on","Test","set.","The","observation","used","in","figure","9","is:\nFigure","12.Observation","used","in","figure","9\n1.6.","Comparisons","of","calculation","time","of","SV","estimates","with","Brute-force","and","Multi-Games\nWe","show","below","the","elapsed","time","take","to","compute","the","SV","for","one","observation","with","Brute-force","and","Multi-Games,","with","an\nincreasing","number","of","variablespfor","a","single","decision","tree","withtree-depth=","15trained","on","dataset","of","sizen=","20000\ngenerated","by","the","toy","model.Nis","the","number","of","observations","where","the","Shapley","valuesφ\ni\n(f,x)are","computed.\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\nN11111111000\nM4561715878575875601976186198748\nDimension","p45678910200\nElapsed","time","SV","(Brute","Force)3.38","sec34","sec4.4","min26.6","min4.7","hours+∞+∞+∞\nElapsed","time","SV","(Multi-Game)13.05","sec44","sec1.5","min2.4","min5.57","min12.25","min18.20","min1","hour\nFigure","13.Bayesian","","","network","","","that","","","represents","","","the","","","causal\nrelationships","between","variablesFigure","14.Probabilities","table","used","to","generate","Data\nE","Plug-In","estimator","of","Marginal","expectation\nAs","we","have","indicated","in","the","paper,","the","Shapley","Values","can","be","computed","with","different","probabilityQ\nS,x\n.","","In","that","section,\nwe","show","that","when","we","use","the","marginal","distribution","(as","in","the","so-called","interventional","case),","the","previous","estimators","for\ntree-based","models","can","be","adapted","straightforwardly.\nWe","consider","then","decision","tree\nf(x)","=\nM\n∑\nm=1\nf\nm\n1\nL\nm\n(x)\nand","remark","that","the","Marginal","Shapley","coefficients","involve","the","computations","of","the","marginal","expectationsE\nP\n[1\nL\nm\n(X\n","̄\nZ\n,x\nZ\n)]\nfor","any","subgroup","of","variablesZ.","","On","real","data,","we","need","to","compute","the","conditional","expectations,","but","we","use","the","Tree\n\nThe","Shapley","Value","of","coalition","of","variables","provides","better","explanations\napproximations","in","order","to","replace\nE\nP\n[1\nL\nm\n(X\n","̄\nZ\n,x\nZ\n)]","=\n∫","∫\n1\nL\nm\n(u\n","̄\nZ\n,x\nZ\n)p(u\n","̄\nZ\n,u\nZ\n)du\n","̄\nZ\ndu\nZ\n=\n∫","∫\n1\nL\nm\n(u\n","̄\nZ\n,x\nZ\n)p(u\nZ\n|u\n","̄\nZ\n)p(u\n","̄\nZ\n)du\nZ\ndu\n","̄\nZ\n=\n∫\n{\n∫\np(u\nZ\n|u\n","̄\nZ\n)du\nZ\n}\n1\nL\nm\n(u\n","̄\nZ\n,x\nZ\n)p(u\n","̄\nZ\n)du\n","̄\nZ\n=\n∫\n1\nL\nm\n(u\n","̄\nZ\n,x\nZ\n)p(u\n","̄\nZ\n)du\n","̄\nZ\nThis","means","that","we","just","need","the","marginal","distributions","of","the","variablesX\n","̄\nZ\nin","order","to","compute","the","expectations","of","the","leaf.\nIn","the","case","of","quantitative","data,","the","leaf","can","be","writtenL\nm\n=\n∏\np\ni=1\n[a\nm\ni\n,b\nm\ni\n],","and","we","have","by","definition\n∃k∈Z,","x\nk\n/∈[a\nk\n,b\nk\n]","","=⇒1\nL\nm\n(u\n","̄\nZ\n,x\nZ\n)","=","0\nWe","define","the","set","of","leafs","compatible","with","conditionX\nZ\n=x\nZ\nas\nC(Z,x)","=\n{\nm∈[1...M]|L\nm\n=\np\n∏\ni=1\n[a\nm\ni\n,b\nm\ni\n],∀k∈Z,x\nk\n∈[a\nm\nk\n,b\nm\nk\n]\n}\nWe","write","form∈C(Z,x),L\nm\n=L\n","̄\nZ\nm\n×L\nZ\nm\n,","withL\n","̄\nZ\nm\n=\n∏\ni∈\n","̄\nZ\n[a\nm\ni\n,b\nm\ni\n]andL\nZ\nm\n=\n∏\ni∈Z\n[a\nm\ni\n,b\nm\ni\n],","this","means","that","for\nallm∈C(Z,x)we","have\nE\nP\n[1\nL\nm\n(X\n","̄\nZ\n,x\nZ\n)]","=E\nP\n[\n1\nL\n","̄\nZ\nm\n(X\n","̄\nZ\n)\n]\nAs","an","approximation,","the","conditional","probability","form∈C(Z,x)is","computed","as\nE\nP\n[\n1\nL\n","̄\nZ\nm\n(X\n","̄\nZ\n)\n]\n=P\n(\nX\ni\n∈[a\nm\ni\n,b\nm\ni\n],i∈\n","̄\nZ\n)\n'\nN(L\n","̄\nZ\nm\n)\nN\nwhereN(L\n","̄\nZ\nm\n)is","the","number","of","observations","in","the","(partial)","leafL\n","̄\nZ\nm\n.","As","a","consequence","we","have\nE\nP\n[f(X\n","̄\nZ\n,x\nZ\n)]","=\nM\n∑\nm=1\nˆy\nm\nE\nP\n[1\nL\nm\n(X\n","̄\nZ\n,x\nZ\n)]\n=\n∑\nm∈C(Z,x)\nˆy\nm\nE\nP\n[1\nL\nm\n(X\n","̄\nZ\n,x\nZ\n)]\n=\n∑\nm∈C(Z,x)\nˆy\nm\nE\nP\n[\n1\nL\n","̄\nZ\nm\n(X\n","̄\nZ\n)\n]\n'\n∑\nm∈C(Z,x)\nˆy\nm\nN(L\n","̄\nZ\nm\n)\nN"],"doc19":["\n\nAnticipating","synchronization","with","machine","learning\nHuawei","Fan,\n1\nLing-Wei","Kong,\n2\nYing-Cheng","Lai,\n2\nand","Xingang","Wang\n1,∗\n1\nSchool","of","Physics","and","Information","Technology,","Shaanxi","Normal","University,","Xi’an","710062,","China\n2\nSchool","of","Electrical,","Computer,","and","Energy","Engineering,\nArizona","State","University,","Tempe,","Arizona","85287,","USA\n(Dated:","March","25,","2021)\nIn","applications","of","dynamical","systems,","situations","can","arise","where","it","is","desired","to","predict","the","onset","of","synchro-\nnization","as","it","can","lead","to","characteristic","and","significant","changes","in","the","system","performance","and","behaviors,","for\nbetter","or","worse.","","In","experimental","and","real","settings,","the","system","equations","are","often","unknown,","raising","the","need","to\ndevelop","a","prediction","framework","that","is","model","free","and","fully","data","driven.","","We","contemplate","that","this","challenging\nproblem","can","be","addressed","with","machine","learning.","","In","particular,","exploiting","reservoir","computing","or","echo","state\nnetworks,","we","devise","a","“parameter-aware”","scheme","to","train","the","neural","machine","using","asynchronous","time","series,\ni.e.,","in","the","parameter","regime","prior","to","the","onset","of","synchronization.","","A","properly","trained","machine","will","possess\nthe","power","to","predict","the","synchronization","transition","in","that,","","with","a","given","amount","of","parameter","drift,","","whether\nthe","system","would","remain","asynchronous","or","exhibit","synchronous","dynamics","can","be","accurately","anticipated.","","We\ndemonstrate","the","machine-learning","based","framework","using","representative","chaotic","models","and","small","network","sys-\ntems","that","exhibit","continuous","(second-order)","or","abrupt","(first-order)","transitions.","","A","remarkable","feature","is","that,","for\na","network","system","exhibiting","an","explosive","(first-order)","transition","and","a","hysteresis","loop","in","synchronization,","the\nmachine","learning","scheme","is","capable","of","accurately","predicting","these","features,","including","the","precise","locations","of\nthe","transition","points","associated","with","the","forward","and","backward","transition","paths.\nI.","","INTRODUCTION\nAs","a","universal","phenomenon","in","nonlinear","and","complex","dy-\nnamical","","systems,","","synchronization","","has","","attracted","","a","","great","","deal\nof","research","and","a","continuous","interest","[1–3].","","Synchronization\nrepresents","a","kind","of","coherent","motion","that","typically","arises","in\nsystems","of","coupled","dynamical","units","when","the","interaction","or\ncoupling","","among","the","","units","is","","sufficiently","strong.","","","Depending\non","the","specific","form","of","the","coherent","motion,","different","types","of\nsynchronization","can","emerge,","including","complete","chaotic","syn-\nchronization","[4],","phase","synchronization","[5],","and","generalized\nsynchronization","[6].","","The","occurrence","of","synchronization","has\nsignificant","","consequences","","for","","the","","system","","behavior","","and","","func-\ntions.","","An","example","is","the","occurrence","of","epileptic","seizures","in\nthe","","brain","","neural","","system.","","","Specifically,","","a","","widely","","adopted","","as-\nsumption","is","that","hypersynchrony","is","closely","associated","with","the\noccurrence","of","epileptic","seizures","[7],","during","which","the","number\nof","independent","degrees","of","freedom","of","the","underlying","brain","dy-\nnamical","system","is","reduced.","Among","the","extensive","literature","in\nthis","field,","","there","was","demonstration","that","partial","and","transient\nphase","synchrony","can","be","exploited","to","detect","and","characterize\n(but","not","to","predict)","seizure","from","multichannel","brain","data","[8–\n10].","","To","date,","reliable","seizure","prediction","remains","an","unsolved\nproblem.","","In","real-world","situations","such","as","this,","it","is","of","inter-\nest","to","predict","or","anticipate","synchronization","before","its","actual\noccurrence.","","A","daunting","challenge","is","that","it","is","often","impossi-\nble","to","know","the","system","equations","so","any","prediction","attempt\nmust","be","based","on","time","series","data","obtained","before","the","system\nevolves","into","some","kind","of","synchronous","dynamical","state.","","We\nare","thus","motivated","to","ask","the","question:","","given","that","the","system\noperates","","in","","a","","parameter","","regime","","where","","there","","is","","no","","synchro-\nnization,","would","it","be","possible","to","predict,","without","relying","on\n∗\nEmail","address:","wangxg@snnu.edu.cn\nany","model,","the","onset","of","synchronization","based","solely","on","the\ndynamically","incoherent","time","series","measurements","taken","from\nthe","parameter","regime","of","desynchronization?","In","this","paper,","we\narticulate","","a","","machine-learning","","framework","","based","","on","","reservoir\ncomputing","[11,","12]","to","provide","an","affirmative","answer","to","this\nquestion.\nTo","place","our","work","in","a","proper","context,","here","we","offer","a","brief\nliterature","review","of","the","fields","of","synchronization","and","reservoir\ncomputing.\nSynchronization","in","nonlinear","dynamics","and","complex","net-\nworks.In","the","study","of","synchronization,","the","typical","setting","is\ncoupled","dynamical","oscillators,","where","the","bifurcation","or","con-\ntrol","parameter","is","the","coupling","strength","among","the","oscillators.\nA","central","task","is","to","identify","the","critical","point","at","which","a","transi-\ntion","from","desynchronization","to","synchronization","occurs","[1,","2].\nDepending","on","the","dynamics","of","the","oscillators","and","the","coupling\nfunction,","the","system","can","have","a","sequence","of","transitions,","giv-\ning","rise","to","distinct","synchronization","regimes","in","the","parameter\nspace.","For","example,","for","a","system","of","coupled","identical","nonlin-\near","oscillators,","complete","synchronization","can","arise","when","the\ncoupling","exceeds","a","critical","strength","that","can","be","determined","by\nthe","master","stability","function","[13,","14].","Systems","of","nonlinearly\ncoupled","phase","oscillators,","e.g.,","those","described","by","the","classic\nKuramoto","model","[1]","can","host","phase","synchronization","and","the\ncritical","coupling","strength","required","for","the","onset","of","this","type","of\n“weak”","synchronization","can","be","determined","by","the","mean-field\ntheory","[15,","16].","","Synchronization","in","coupled","physical","oscilla-\ntors","was","experimentally","studied","[17,","18].","","A","counter-intuitive\nphenomenon","is","that","adding","connections","can","hinder","network\nsynchronization","of","time-delayed","oscillators","[19].","With","the","de-\nvelopment","of","modern","network","science","in","the","past","two","decades,\nsynchronization","","in","","complex","","networks","","has","","been","","extensively\nstudied","[20],","due","to","the","rich","variety","of","complex","network","struc-\ntures","in","natural","and","engineering","systems","and","the","fundamental\nrole","of","synchronous","dynamics","in","the","system","functioning.","Ear-\nlier","it","was","found","that","small-world","networks,","due","to","their","small\narXiv:2103.13358v1","","[nlin.AO]","","13","Mar","2021\n\n2\nnetwork","diameter","values,","are","more","synchronizable","than","reg-\nular","networks","of","comparable","sizes","[21],","but","heterogeneity","in\nthe","network","structure","presents","an","obstacle","to","synchronization-\n[22].","Subsequently","it","was","found","that","heterogeneous","networks\nwith","weighted","links","can","be","more","synchronizable","than","small-\nworld","and","random","networks","[23].","The","onset","of","chaotic","phase\nsynchronization","","in","","complex","","networks","","of","","coupled","","heteroge-\nneous","oscillators","was","also","studied","[24].","The","interplay","between\nnetwork","","symmetry","","and","","synchronization","","was","","uncovered","","and\nunderstood","[25,","26].","In","complex","networks,","the","transition","from\ndesynchronization","to","synchronization","is","typically","continuous,\ne.g.,","the","synchronization","error","or","the","order","parameter","tends","to\nchange","continuously","through","the","critical","point,","which","is","char-\nacteristic","of","a","second-order","phase","transition.","","However,","stud-\nies","of","networked","systems","of","coupled","phase","oscillators","revealed\nthat,","if","the","network","links","are","weighted","according","to","the","natural\nfrequencies","of","the","oscillators,","the","transition","can","be","abrupt","and\ndiscontinuous,","i.e.,","a","first-order","phase","transition","[27–29].","This\nphenomenon,","known","as","explosive","synchronization,","is","proof","of\nthe","strong","influence","of","network","structure","on","the","collective","dy-\nnamics.\nReservoir","computing","for","predicting","chaotic","systems.The\nidea","and","principle","of","exploiting","reservoir","computing","for","pre-\ndicting","the","state","evolution","of","chaotic","systems","were","first","laid\nout","about","two","decades","ago","[11,","12].","","In","recent","years,","model-\nfree","predication","of","chaotic","systems","using","reservoir","computing\nhas","gained","considerable","momentum","[30–48].","","The","neural","ar-\nchitecture","of","reservoir","computing","consists","of","a","single","hidden\nlayer","of","a","complex","dynamical","network","that","receives","input","data\nand","generates","output","data.","","","In","the","training","phase,","","the","whole\nsystem","is","set","to","the","“open-loop”","mode,","where","it","receives","input\ndata","and","optimizes","its","parameters","to","match","its","output","with","the\ntrue","output","corresponding","to","the","input.","","In","the","standard","reser-\nvoir","computing","setting","[30–48],","the","adjustable","parameters","are\nthose","associated","with","the","output","matrix","that","maps","the","inter-\nnal","","dynamical","","state","","of","","the","","hidden","","layer","","to","","the","","output","","layer,\nwhile","","other","","parameters,","","such","","as","","those","","defining","","the","","network\nand","the","input","matrix,","are","fixed","(the","hyperparameters).","","In","the\nprediction","phase,","the","neural","machine","operates","in","the","“close-\nloop”","mode","where","the","output","variables","are","fed","directly","into\nthe","input,","so","that","the","whole","system","becomes","a","self-evolving\ndynamical","system.","With","reservoir","computing,","the","state","evolu-\ntion","of","chaotic","systems","can","be","accurately","predicted","for","about\nhalf","dozen","Lyapunov","time","-","longer","than","that","can","be","achieved\nusing","the","traditional","methods","of","nonlinear","time","series","analy-\nsis.","","A","result","was","that,","even","reservoir","computing","is","unable","to\nmake","long","term","prediction","of","the","state","evolution","of","a","chaotic\nsystem,","it","is","still","able","to","replicate","the","ergodic","properties","of","the\nsystem","[33].","","","This","feature","makes","it","possible","to","generate","the\nbifurcation","","diagram","","of","","a","","nonlinear","","dynamical","","system","","with-\nout","the","equations","[49].","","More","recently,","","a","“parameter-aware”\nreservoir","computing","scheme","was","articulated","to","predict","critical\ntransitions,","transient","chaos,","and","system","collapse","[50].\nContributions","of","the","present","work.In","","situations","","where\nsynchronization","is","undesired,","such","as","epilepsy,","the","sudden","on-\nset","of","synchronization,","or","a","“synchronization","catastrophe,”","is\nof","concern.","Likewise,","in","alternative","situations","where","synchro-\nnization","is","deemed","desired,","a","sudden","collapse","of","synchroniza-\ntion","is","to","be","avoided.","","It","is","of","interest","to","predict","sudden","onset\nor","collapse","of","synchronization","before","it","occurs.","If","the","detailed\nnetwork","structure","and","system","equations","are","known,","in","princi-\nple","the","prediction","task","is","feasible.","In","real","world","applications,","it\nis","often","the","case","that","the","only","available","information","about","the\nsystem","is","a","set","of","measured","time","series","at","a","number","of","control\nparameter","values","[5,","6].","","For","instance,","in","epilepsy,","the","details\nof","the","brain","neuronal","network","generating","the","seizures","are","un-\nknown,","but","the","EEG","signals","upon","applications","of","controlled\ndrug","doses","can","be","obtained.","In","such","applications,","a","model-free\nand","fully","data-driven","approach","to","predicting","a","synchronization\ncatastrophe","is","needed.","","In","this","regard,","if","the","network","is","sparse\nand","if","the","nodal","dynamical","equations","have","a","simple","mathe-\nmatical","structure,","such","as","those","which","can","be","represented","by\na","small","number","of","power","series","or","Fourier","series","terms,","sparse\noptimization","tailored","to","nonlinear","dynamical","systems","[51–53]\ncan","","be","","employed","","to","","discover","","the","","system","","equations","","so","","as","","to\npredict","the","onset","of","synchronization","[54].\nThe","scheme","of","reservoir","computing","incorporating","a","param-\neter","input","channel","so","that","it","is","able","to","sense","and","track","the","pa-\nrameter","variations","of","the","target","system","[50]","provides","a","solution\nto","the","problem","of","predicting","synchronization","transition.","","The\npurpose","of","this","paper","is","to","demonstrate","that","this","is","indeed","the\ncase.","The","basic","principle","is","that","the","dynamical","“climate”","of","the\ntarget","system,","e.g.,","the","dimension","of","its","chaotic","attractor","[33],\nundergoes","an","abrupt","change","at","the","synchronization","transition\npoint,","and","a","well","trained","parameter-aware","reservoir","comput-\ning","machine","is","able","to","capture","this","“climate”","change.","","To","be\nconcrete,","we","take","the","coupling","strength","as","the","control","param-\neter","whose","value","is","fed","into","the","input","parameter","channel.","The\nrequired","training","constitutes","optimizing","the","reservoir","output\nmatrix","based","on","time","series","collected","from","a","small","number","of\ndistinct","values","of","the","control","parameter","in","the","desynchroniza-\ntion","","regime","","so","","that","","the","","neural","","machines","","learns","","the","","“climate\nchange”","of","the","target","system.","","As","we","will","show,","provided","that\nthe","training","is","successful,","the","machine","is","able","to","predict","a","char-\nacteristic","change","in","the","collective","dynamical","behavior","of","the\ntarget","system","for","any","value","of","the","control","parameter","that","the\ninput","parameter","channel","receives.","","The","scenarios","tested","con-\nsist","of","a","broad","spectrum","of","complex","synchronization","behav-\niors,","including","complete","synchronization","in","coupled","identical\nchaotic","systems","and","explosive","synchronization","in","networks","of\ncoupled","nonidentical","phase","oscillators.","Because","of","the","model-\nfree","nature","of","our","machine-learning","framework","for","synchro-\nnization","","prediction,","","it","","can","","be","","applied","","directly","","to","","real","","world\nsystems.\nII.","","MACHINE-LEARNING","METHOD\nOur","reservoir","computing","machine","consists","of","four","modules:\ntheI/Rlayer","","(input-to-reservoir),","","the","","control","","module,","","the\nhidden","layer","(the","reservoir),","and","theR/Olayer","(reservoir-to-\noutput).","TheI/Rlayer","is","characterized","byW\nin\n,","aD\nr\n×D\nin\n-\ndimensional","matrix","that","maps","the","input","vectoru\nε\n(t)∈R\nD\nin\nto","the","dynamical","network","in","the","reservoir","hidden","layer,","where\nthe","input","vector","is","acquired","from","the","target","system","at","timet\nfor","the","specific","bifurcation","parameter","valueε.","The","elements","of\n\n3\nW\nin\nare","randomly","drawn","from","a","uniform","distribution","within\nthe","range[−σ,σ].","The","control","module","is","characterized","by","the\nvectors=η(t)b,","whereη(t)is","the","time-dependent","control\nparameter","andb∈R\nD\nr\nis","a","bias","vector.","","In","general,","the","con-\ntrol","parameter","is","related","to","the","bifurcation","parameter","of","the","tar-\nget","system","by","a","smooth","function,","where","a","convenient","choice\nis","simplyη(t)","=ε(t).","Effectively,η(t)can","be","regarded","as","an\nadditional","input","component","that","can","be","incorporated","into","the\ninput","vectoru(t),","where","the","elements","ofbare","also","drawn","ran-\ndomly","from","a","uniform","distribution","within","the","range[−σ,σ].\nThe","network","in","the","hidden","layer","consists","ofD\nr\nnonlinear","ele-\nments","(nodes),","whose","dynamics","are","governed","by","the","rule\nr(t+","∆t)","=","(1−α)r(t)","+αtanh[Ar(t)\n+W\nin\nu\nε\n(t)","+ε\nk\n(ε(t)","+ε\nbias\n)b],(1)\nwherer(t)∈R\nD\nr\nis","the","state","vector","of","the","network","at","timet,\n∆tis","the","time","step,αis","a","leakage","parameter,ε\nk\nandε\nbias\nde-\nfine","a","linear","transformation","ofεbefore","input","it","into","the","reser-\nvoir,","andAis","theD\nr\n×D\nr\n-dimensional","matrix","characterizing\nthe","connecting","structure","of","the","hidden","layer","network.","","","With\nprobabilityp,","the","elements","of","matrixAare","set","to","be","zero.","The\nsymmetric,","non-zero","elements","ofAare","drawn","from","a","uniform\ndistribution","within","the","range[−1,1],","and","are","normalized","so","as\nto","make","the","spectral","radius","of","the","matrixρ.","","The","output","layer\nis","characterized","by","aD\nout\n×D\nr\ndimensional","matrixW\nout\n,\nwhich","generates","theD\nout\n-dimensional","output","vectorv(t)via\nv(t+","∆t)","=W\nout\n·f(r(t+","∆t)),(2)\nwheref(r)is","the","output","function","and","we","setD\nin\n=D\nout\n.","The\nelements","of","the","output","matrix","are","to","be","determined","through\ntraining,","where","a","general","rule","is","to","setf(r)","","=rfor","the","odd\nnodes","in","the","reservoir","andf(r)","","=r\n2\nfor","the","even","nodes","so\nas","","to","","enable","","proper","","optimization","","[38].","","","In","","particular,","","differ-\nent","fromW\nin\n,","the","elements","ofW\nout\nare","not","known","a","priori,\nbut","","are","","to","","be","","“learned”","","from","","the","","input","","data","","through","","train-\ning,","","with","","the","","purpose","","to","","find","","the","","proper","","matrixW\nout\nsuch\nthat","the","output","vectorv(t+","∆t)as","calculated","from","Eq.","(2)\nis","","as","","close","","as","","possible","","to","","the","","input","","vectoru(t+","∆t)for\nt=","","(τ+","1)∆t,...,(L−1)∆t,L∆t,","","whereT\n0\n=τ∆tis\nthe","initial","period","discarded","to","remove","the","transient","behavior","in\nreservoir’s","response","to","the","training","signal,","andLis","the","length\nof","the","training","time","series.","","This","can","be","done","[33,","34,","38]","by\nminimizing","a","cost","function","with","respect","toW\nout\n,","which","gives\nW\nout\n=UF\nT\n(FF\nT\n+λI)\n−1\n,(3)\nwhereFis","theD\nr\n×Ldimensional","state","matrix","whosekth\ncolumn","isf(r((τ+k)∆t)),Uis","theD\nin\n×Ldimensional\nmatrix","whosekth","column","isu((τ+k+1)∆t),Iis","the","identity\nmatrix,","andλis","the","ridge","regression","parameter.\nAfter","training,","the","elements","in","matrixW\nout\nare","fixed,","and\nthe","machine","is","ready","for","prediction,","where","we","first","set","the","con-\ntrol","parameter","to","a","specific","value","of","interest","(not","necessarily\nany","of","the","parameter","values","used","in","the","training","phase),","and\nthen","","evolve","","the","","machine","","according","","to","","Eq.","","(1)","","by","","replacing\nu\nε\n(t)withv(t+","∆t).","","Finally,","by","tuningεto","different","val-\nues,","","we","monitor","the","variation","of","the","statistical","properties","of\nthe","reservoir","outputs,","and","predict","the","transition","of","the","system\ndynamics","with","respect","toε.\nThe","main","feature","of","our","reservoir","computing","design","is","that\nthe","input","data","in","the","training","phase","contain","two","components:\n(1)","the","input","vectoru\nε\n(t)representing","the","time","series","mea-\nsured","from","the","target","system","and","(2)","the","bifurcation","parameter\nε(t)under","whichu\nε\n(t)is","obtained,","","whereas","in","the","conven-\ntional","scheme","[30–48],","only","the","first","component","(time","series\nfrom","","a","","fixed","","value","","of","","the","","bifurcation","","parameter)","","is","","present.\nIn","","particular,u\nε\n(t)consists","","ofmsegments","","of","","equal","","length\nT(i.e.,L=mT)","","and,","","for","","each","","segment,","","the","","value","","of","","the\nbifurcation","parameterε(t)is","fixed","so,","overall,ε(t)is","a","step\nfunction","of","time.","","(The","proposed","scheme","is","equally","effective\nwhen","the","segments","are","not","of","equal","length","-","see","Appendix","A.)\nIn","the","predicating","phase,","the","input","vectoru\nε\n(t)is","replaced","by\nv(t)as","in","the","conventional","scheme,","but","the","value","of","the","bi-\nfurcation","parameterε(t)is","still","needed","as","an","input.","Since","our\ngoal","is","to","predict","synchronization","among","a","number","of","coupled\noscillators,","the","coupling","strengthεis","a","natural","choice","for","the\nbifurcation","parameter.\nIII.","","RESULTS\nA.","","Predicting","complete","synchronization","in","coupled","chaotic\nmaps\nWe","consider","the","following","system","of","two","coupled,","identical\nchaotic","maps:\nx\n1,2\n(n+","1)","=F(x\n1,2\n(n))","+ε[H(x\n2,1\n(n))−H(x\n1,2\n(n))],\n(4)\nwherex\n1,2\n(n)denote","the","dynamical","variables","of","the","system\nat","thenth","iteration,F(x)andH(x)are","the","map","and","coupling\nfunctions,","respectively.","As","an","illustrative","example,","we","choose\nthe","one-dimensional","chaotic","logistic","map","defined","on","the","unit\ninterval:F(x)","","=","","4x(1−x),","","and","set","the","coupling","function\nto","beH(x)","","=F(x).","","","The","critical","coupling","value","for","com-\nplete","synchronization","can","be","obtained","using","the","master","stabil-\nity","function","[13,","14],","which","gives","that","complete","synchroniza-\ntion","occurs","for0.25≈ε\n1\n≤ε≤ε\n2\n≈0.75.\nWe","","obtain","","the","","training","","data","","for","","three","","different","","values","","of\nε:","","0.2,","","0.22","","and","","0.24,","","all","","in","","the","","desynchronization","","regime.\nFor","","eachεvalue,","","we","","collect","","the","","state","","variables{u(n)}=\n{x\n1\n(n),x\n2\n(n)}forT=","","2×10\n3\nsuccessive","","time","","steps","","af-\nter","disregarding","a","transient","of10\n3\ntime","steps.","","","The","time","se-\nries","from","the","three","values","ofεare","combined","to","form","a","single\ntime","series","which,","together","with","the","step","functionε(n)of","the\ncoupling","parameter,","are","fed","into","the","reservoir","for","training","that\nyields","the","optimal","output","matrixW\nout\n.","","The","values","of","the","hy-\nperparameters","of","the","reservoir","are(D\nr\n,p,σ,ρ,α,ε\nk\n,ε\nbias\n)","=\n(100,0.2,1,10\n−5\n,1,1,0).","","The","regression","parameter","for","ob-\ntainingW\nout\nisλ=","1×10\n−5\n.\nTo","predict","the","synchronization","transition,","the","trained","reser-\nvoir","computing","machine","must","possess","the","ability","to","sense","the\nchange","in","the","“synchronization","climate”","of","the","target","system.\nFigures","1(a1-d1)","show","the","predicted","return","maps","(black","dots)\nconstructed","","fromx\n1\nfor","","four","","values","","ofε:","","","0.2,","","0.22,","","0.24,\n\n4\nFIG.","1.","Predicted","synchronization","behavior","for","different","values","of","the","bifurcation","parameter","in","coupled","chaotic","maps.","The","system","consists","of","a\npair","of","coupled","chaotic","logistic","maps","with","coupling","parameterεand","respective","dynamical","variablesx\n1\nandx\n2\n.","Top","row","(a1-d1):","the","predicted\n(black","dots)","and","true","(red","dots)","returned","map","constructed","fromx\n1\nforε=","0.2,","0.22,","0.24,","and","0.26,","respectively;","bottom","row","(a2-d2):","","the\npredicted","(black)","and","true","(red)","mutual","relationship","betweenx\n1\nandx\n2\nfor","the","same","set","of","parameter","values,","where","a","diagonal","line","represents\ncomplete","synchronization.\nand","0.26,","respectively,","together","with","the","true","return","maps","(red\ndots).","The","corresponding","plots","of","the","mutual","relation","between\nthe","","two","","maps","","are","","shown","","in","","Figs.","","1(a2-d2).","","","The","","first","","three\nvalues","ofεare","belowε\n1\n,","so","there","is","no","synchronization,","and\nthe","last","value","is","in","the","synchronization","regime.","","The","reservoir\nmachine","predicts","these","behaviors","correctly.","Especially,","as","the\nvalue","ofεis","increased","from","0.2","to","0.26,","the","return","map","gradu-\nally","evolves","into","the","map","functionF(x)","=","4x(1−x)and","the\npoints(x\n1\n,x\n2\n)converges","to","the","diagonal","line,","which","are","char-\nacteristic","","of","","complete","","synchronization.","","","In","","fact,","","statistically\nthe","black","and","red","dots","cannot","be","distinguished,","indicating","the\nsuperior","power","of","the","machine","to","capture","the","collective","dy-\nnamics","of","the","target","system.\nNote","that","the","first","threeεvalues","(0.2,","0.22,","and","0.24)","are\nthe","ones","used","in","training.","","It","may","thus","not","be","surprising","that\nthe","reservoir","is","able","to","predict","correctly","the","distinct","dynam-\nical","","behaviors","","of","","the","","system","","at","","these","","parameter","","values,","","i.e.,\nthere","is","no","synchronization.","","","What","is","remarkable","is","that","the\nlastεvalue","(0.26)","is","totally","“new”","to","the","machine","as","it","has\nnever","been","exposed","to","data","from","this","parameter","value,","yet","it\npredicts,","","still","quite","correctly,","","that","there","is","now","synchroniza-\ntion.","This","means","that","training","at","different","coupling","parameter\nvalues","in","the","desynchronization","regime","has","instilled","into","the\nmachine","the","ability","for","it","to","“sense”","the","“climate”","change","in\nthe","collective","dynamics","of","the","target","system.\nAs","the","reservoir","computing","has","been","trained","to","capture","the\n“climate”","of","the","collective","dynamics","in","the","coupled","chaotic\nmap","system,","it","should","be","able","to","predict","the","synchronization\ntransition.","In","particular,","the","expectation","is","that","it","would","predict\ncorrectly","the","two","ending","points","of","the","synchronization","param-\neter","regime(ε\n1\n,ε\n2\n)at","which","a","transition","to","synchronization\noccurs","depending","on","the","direction","of","parameter","variation.","","To\ndemonstrate","the","successful","prediction","of","the","transition","point\nε\n1\n,","we","fix","the","output","matrixW\nout\nand","increase","theεvalue","sys-\ntematically","from0.18to0.27at","the","step","size∆ε=","1×10\n−3\n.\nFor","eachεvalue,","","we","let","the","machine","generate","a","time","series\nof","lengthT=","1×10\n3\nand","calculate","the","time-averaged","syn-\nchronization","","error∆x=〈|x\n1\n−x\n2\n|〉\nT\n.","","","Figure","","2(a)","","shows\nthe","machine-predicted∆xversusε(red","circles),","","where∆x\ndecreases","","continuously","","forε&0.2and","","becomes","","zero","","for\nε=ε\n1\n≈0.25.","","For","comparison,","the","true","behavior","of∆xis\nalso","included","in","Fig.","2(a),","to","which","the","predicted","result","agrees\nwell","forε&0.2.","","","At","the","opposite","end","of","the","synchroniza-\ntion","regime,","the","reservoir","machine","does","an","equally","good","job\nto","predict","the","transition","to","synchronization","atε\n1\n≈0.75asε\ndecreases","from","a","larger","value,","as","shown","in","Fig.","2(b),","where\nthe","training","data","are","obtained","fromε=","","0.76,0.78and0.8.\nThe","results","in","Fig.","2","are","thus","evidence","that","a","properly","trained\nreservoir","computing","machine","has","the","power","to","accurately","pre-\ndict","the","critical","point","of","transition","to","synchronization.\nThe","performance","of","the","reservoir","machine","in","predicting","the\nsynchronization","transition","is","affected","slightly","by","the","number\nand","locations","of","the","training","parameter","values.","","We","find","that,\ninsofar","","as","","training","","is","","done","","with","","data","","from","","at","","least","","two","","dis-\ntinct","parameter","values,","the","synchronization","transition","can","be\npredicted.","","Training","with","data","from","increasingly","more","values\nof","the","bifurcation","parameter,","","regardless","of","the","order,","","can","in\ngeneral","improve","the","prediction","accuracy.","","Also,","the","closer","the\ntraining","parameter","values","to","the","critical","point,","the","more","accu-\nrate","the","prediction.","","(Details","about","the","effects","of","the","number,\nlocations","","and","","order","","of","","the","","training","","parameter","","values","","on","","the\nprediction","performance","are","provided","in","Appendix","A.)\n\n5\n0.740.760.780.800.82\n0.0\n0.1\n0.2\n0.3\n0.4\nD\nx\ne\n(b)\n","Model\n","RC\ne\n2\n=0.75\n0.180.200.220.240.26\n0.0\n0.1\n0.2\n0.3\n0.4\nD\nx\n","Model\n","RC\n(a)\ne\n1\n=0.25\nFIG.","2.","","Predicting","synchronization","transition","in","coupled","chaotic","lo-\ngistic","maps.","(a)","As","the","coupling","is","strengthened,","the","synchronization\nerror∆xgradually","decreases","to","zero","at","aboutε\n1\n≈0.25.","(b)","The","er-\nror∆xstarts","to","increase","from","zero","at","aboutε\n2\n≈0.75.","The","vertical\ndashed","lines","denote","the","coupling","parameter","values","used","in","generating\nthe","training","data.","","The","machine-predicted","and","true","results","are","repre-\nsented","as","red","circles","and","black","squares,","respectively.","","The","machine\npredicts","correctly","the","transitions","at","both","ends","of","the","synchronization\nparameter","regime(ε\n1\n,","ε\n2\n).\nB.","","Predicting","synchronization","transition","in","coupled","chaotic\nLorenz","oscillators\nThe","system","of","a","pair","of","coupled","identical","chaotic","Lorenz\noscillators","is","given","by\n","̇x\n1,2\n=μ(y\n1,2\n−x\n1,2\n)","+ε(x\n2,1\n−x\n1,2\n),\n","̇y\n1,2\n=x\n1,2\n(β−z\n1,2\n)−y\n1,2\n+ε(y\n2,1\n−y\n1,2\n),(5)\n","̇z\n1,2\n=x\n1,2\ny\n1,2\n−γz\n1,2\n+ε(z\n2,1\n−z\n1,2\n),\nwhere","","the","","parameter","","setting","","is(μ,β,γ)","","=","","(10,28,2)for\nwhich","an","isolated","oscillator","has","a","chaotic","attractor","[55].","Anal-\nysis","based","on","the","master","stability","function","gives","that","complete\nsynchronization","occurs","forε",">","ε\nc\n≈0.42.\nWe","generate","the","training","data","from","three","distinct","values","of\nthe","coupling","parameter","in","the","desynchronization","regime:ε=\n5\nFIG.","","3.","","","","Predicting","","synchronization","","transition","","in","","coupled","","chaotic\nLorenz","oscillators.","","(a1-a3)","Machine-generated","time","evolution","ofx\n1\n(black","trace)","andx\n2\n(red","trace)","for","the","three","training","values","of","the\ncontrol","parameter","in","the","desynchronization","regime:ε=","0.25,","0.3,\nand","","0.35.","","","(a4)","","Predicted","","synchronization","","behavior","","forε=","","0.45.\nThe","","machine","","has","","never","","been","","exposed","","to","","data","","from","","this","","parameter\nvalue,","yet","it","successfully","predicts","synchronization.","(b)","Synchroniza-\ntion","error∆xversusε.","","Red","circles","and","black","squares","represent","the\nmachine-predicted","and","true","results,","respectively.","","The","three","vertical\ndashed","","lines","","indicate","","the","","locations","","of","","the","","three","","training","","parameter\nvalues.\n0.25,0.3and0.35.","For","each","parameter","value,","a","time","series","of\nlengthT=","4×10\n3\nis","collected","at","the","time","step∆t=","0.02,","af-\nter","disregarding","a","transient","phase","of","lengthT\n0\n=","5×10\n3\n.","The\ninput","vectoru(t)≡[x\n1\n(t),y\n1\n(t),z\n1\n(t),x\n2\n(t),y\n2\n(t),z\n2\n(t)]\nT\nand","the","control","parameter","signalε(t)are","fed","into","the","reservoir\nmachine","for","training","the","output","matrixW\nout\n.","","The","hyperpa-\nrameters","of","the","reservoir","are","set","as(D\nr\n,p,σ,ρ,α,ε\nk\n,ε\nbias\n)","=\n(2×10\n3\n,0.2,0.05,0.1,1,1,0),","and","the","regression","parameter\nvalue","isλ=","1×10\n−8\n.\nFigures","","3(a1-a3)","","show","","the","","predicted","","evolution","","of","","the","","dy-\nnamical","variablesx\n1\nandx\n2\nfrom","the","two","oscillators","for","the\nthree","","training","","parameter","","values","","preceding","","the","","onset","","of","","syn-\nchronization.","","The","machine","predicts","correctly","that","there","is","no\nsynchronization","for","these","parameter","values.","","","When","the","cou-\npling","","parameter","","value","","is","","set","","to","","beε=","","0.45(in","","the","","syn-\n\n6\nchronization","","regime),","","the","","machine","","indeed","","predicts","","the","","syn-\nchronous","behavior,","as","shown","in","Fig.","3(a4).","","To","test","if","the","ma-\nchine","can","predict","the","critical","transition","pointε\nc\nfor","synchro-\nnization,","we","increase","the","control","parameter","value","in","the","ma-\nchine","from0.2to0.5systematically","and","calculate","the","time-\naveraged","","synchronization","","error∆x=〈|x\n1\n−x\n2\n|〉\nT\nover","","a\ntime","period","ofT=","1×10\n4\n(after","discarding","transients).","Fig-\nure","3(b)","shows∆xversusε.","","The","machine","predicted","that","the\nsynchronization","error","approaches","zero","forε\nc\n≈0.42,","which","is\nin","good","agreement","with","the","true","value","of","the","transition","point.\nSimilar","","results","","are","","obtained","","for","","alternative","","coupling","","config-\nurations,","","e.g.,","","through","","a","","single","","variable","","or","","a","","cross","","coupling\nscheme","(Appendix","B).\nC.","","Predicting","synchronization","transition","in","coupled","chaotic\nfood-chain","systems\nWe","consider","the","following","mutually","coupled","system","of","two\nfood","chains,","each","with","three-species","[56]:\n","̇x\n1,2\n=x\n1,2\n(1−\nx\n1,2\nK\n)−\na\nc\nb\nc\nx\n1,2\ny\n1,2\nx\n1,2\n+x\n0\n,(6)\n","̇y\n1,2\n=a\nc\ny\n1,2\n[\nb\nc\nx\n1,2\nx\n1,2\n+x\n0\n−1]−\na\np\nb\np\ny\n1,2\nz\n1,2\ny\n1,2\n+y\n0\n+ε(y\n2,1\n−y\n1,2\n),(7)\n","̇z\n1,2\n=a\np\nz\n1,2\n(\nb\np\ny\n1,2\ny\n1,2\n+y\n0\n−1)","+ε(z\n2,1\n−z\n1,2\n),(8)\nwherex\n1,2\n,y\n1,2\n,z\n1,2\nare","","","","the","","","","population","","","","densities\nof","","","the","","","resource,","","","","consumer,","","","","and","","","predator","","","species,","","","","re-\nspectively,","","","in","","","each","","","food","","","chain.We","","","use","","","the","","","param-\neter","","","setting","","","[56]","","","by","","","which","","","each","","","isolated","","","food","","","chain\nis","","","","a","","","","chaotic","","","","oscillator:(K,a\nc\n,b\nc\n,a\np\n,b\np\n,x\n0\n,y\n0\n)=\n(0.99,0.4,2.009,0.08,2.876,0.16129,0.5).Under\nthissetting,completesynchronizationoccursfor\nε",">","ε\nc\n≈8.4×10\n−3\n.\nWe","generate","the","training","data","from","three","distinct","values","of\nthe","coupling","parameter:ε=","4.5×10\n−3\n,5.5×10\n−3\n,","and6.5×\n10\n−3\n,","all","in","the","desynchronization","regime.","For","each","value,","we\ngenerate","a","time","series","of","lengthT=","9,600δtwithδt=","0.5,\nafter","disregarding","the","initialT\n0\n=","8,000steps","to","remove","any\ntransient","behavior.","All","six","dynamical","variables","of","the","coupled\nsystem","","as","","well","","as","","the","","coupling","","strength","","are","","fed","","as","","input","","to\nthe","reservoir","machine.","","The","values","of","the","hyperparameters","of\nthe","reservoir","machine","are","set","as(D\nr\n,p,σ,ρ,α,ε\nk\n,ε\nbias\n)","","=\n(1000,0.695,2.30,1.20,0.27,0.049,1.53),","","","where","","","the","","","ele-\nments","of","the","reservoir","networkAare","sampled","from","a","stan-\ndard","normal","distribution,","and","the","regression","parameter","isλ=\n3×10\n−4\n.\nWe","","use","","the","","trained","","reservoir","","to","","predict","","the","","synchroniza-\ntion","","behaviors","","in","","the","","coupling","","rangeε∈[0.04,0.012],","","by\ncalculating","","the","","time-averaged","","synchronization","","error∆x=\n〈|x\n1\n−x\n2\n|〉\nT\nover","a","time","period","ofT=","2.4×10\n4\nsteps","for\neach","parameter","value","(after","discarding","transients","withT\n0\n=\n4.8×10\n4\nsteps).","Figure","4","shows","that","the","predicted","error","versus\nε(red","circles)","is","quite","close","to","the","true","errors","(black","squares).\nThe","machine","predicted","synchronization","transition","point","agrees\n0.0040.0060.0080.0100.012\n0.00\n0.03\n0.06\n0.09\n0.12\n0.15\nD\nx\ne\n","Model\n","RC\ne\nc\n=8.410\n-3\nFIG.","4.","Predicting","synchronization","transition","in","coupled","chaotic","food\nchains.","","","Shown","are","the","true","synchronization","errors","(black","squares)\nand","the","reservoir’s","predicted","errors","(red","circles)","for","various","values","of\nthe","coupling","strengthε.","The","three","vertical","blue","dashed","lines","indicate\nthe","locations","of","the","training","parameter","values.\nwith","the","true","value","well.","This","is","quite","remarkable","considering\nthat","only","the","time","series","from","the","desynchronization","regime\nare","used","as","the","training","data.\nD.","","Predicting","explosive","synchronization","in","coupled\nnonidentical","phase","oscillators\nThe","","","","route","","","","to","","","","complete","","","","synchronization","","","","treated","","","","in\nSecs.","","","III","A,","","","III","B,","","","and","","","III","C","","","belongs","","","to","","","the","","","category","","","of\nsecond-order","","phase","","transition,","","","where","","a","","physical","","quantity\ncharacterizing","the","degree","of","synchronization","varies","continu-\nously","(albeit","non-smoothly)","through","the","transition","point.","","As\ndemonstrated,","our","machine","learning","scheme","is","fully","capable\nof","predicting","the","transition","in","all","the","cases.","","Another","type","of\nsynchronization","","transition","","that","","has","","been","","extensively","","studied\nis","first-order","phase","transition,","","also","known","as","explosive","syn-\nchronization","[27–29],","","where","the","onset","of","synchronization","is\nabrupt","in","the","sense","that","the","underlying","characterizing","quantity\nchanges","discontinuously","at","the","transition","point.","","The","question\nis","whether","our","machine","learning","scheme","can","predict","explosive\nsynchronization.","Here","we","present","an","affirmative","answer","using\nthe","paradigmatic","system","in","the","literature","[27–29]","for","explosive\nsynchronization:","coupled","nonidentical","phase","oscillators.\nFor","simplicity,","we","consider","a","small","star","network","ofN=","4\nnodes,","","as","shown","in","Fig.","5(a),","","where","the","natural","frequencies\nof","the","peripheral","(leaf)","nodes","are","identical","and","that","of","the","hub\nnode","is","proportional","to","its","degree","[28].","The","network","dynamics\nis","described","by\n","̇\nθ\nl\n=ω+εsin(θ\nh\n−θ\nl\n),\n","̇\nθ\nh\n=k\nh\nω+ε\n3\n∑\nl=1\nsin(θ\nl\n−θ\nh\n),(9)\n\n7\nwherel=","","1,2,3denote","the","leaf","nodes,hdenotes","the","hub\nnode,εis","the","uniform","coupling","strength,","andk\nh\n=","","3is","the\ndegree","of","the","hub","node.","","The","degree","of","network","synchroniza-\ntion","can","be","characterized","by","the","order","parameter\nR=〈|\n1\nN\nN\n∑\nj=1\ne\niθ\nj\n|〉\nT\n,(10)\nwherej=","1,...,Nis","the","node","index,N=","4is","the","network\nsize,|","·","|is","the","module","function,","","and〈·〉\nT\ndenotes","the","time\naverage.\nSettingω=","","1,","","we","increaseεsystematically","from0.3to\n0.8,","","and","","calculate","","the","","dependence","","ofRonεby","","simulating\nEq.","(9).","In","numerical","simulations,","the","initial","conditions","of","the\noscillators","are","randomly","chosen","from","the","range(0,2π]and","the\nintegration","time","step","is∆t=","0.05.","Representative","numerical\nresults","are","shown","in","Fig.","5(b)","(black","solid","squares).","","It","can","be\nseen","that,","at","aboutε\nf\n=","0.55,","the","value","ofRchanges","abruptly\nfrom","","about0.45to","","about0.9-","","the","","feature","","of","","a","","discontinu-\nous,","first-order","transition.","","The","dynamical","origin","of","this","type\nof","explosive","synchronization","lies","in","the","interplay","between","the\nheterogeneity","of","the","network","structure","and","dynamics,","which\noccurs","naturally","in","networks","where","the","node","degree","and","the\nnatural","frequency","are","positively","correlated","[29].","Our","goal","is","to\nuse","the","reservoir","machine","trained","by","the","time","series","from","the\ndesynchronization","states","to","predict","the","critical","couplingε\nf\n.\nThe","data","used","in","training","consist","of","time","series","from","five\nvalues","","ofε,","","all","","inside","","the","","desynchronization","","regime:ε=\n0.4,0.425,0.45,0.475and0.5.For","","eachεvalue,","","we\ncollect","","time","","series","","measurements","","from","","all","","nodes:x\nj\n=\nsin(θ\nj\n)andy\nj\n=","","cos(θ\nj\n).","","","The","","input","","state","","vector","","isu=\n[x\n1\n,y\n1\n,x\n2\n,y\n2\n,x\n3\n,y\n3\n,x\n4\n,y\n4\n]\nT\n,","and","we","choose","the","data","length\nto","be1.5×10\n4\nthat","contains","five","segments","of","measurements,\none","from","each","value","ofε.","These","data,","together","with","the","param-\neter","functionε(t),","","are","fed","into","the","machine","for","determining\nthe","output","matrixW\nout\n.","","The","parameters","of","the","reservoir","are\n(D\nr\n,p,σ,ρ,α,ε\nk\n,ε\nbias\n)","","=","","(1000,0.2,1,1.15,1,1,0),","","and\nthe","regression","parameter","isλ=","1×10\n−10\n.\nIn","the","predicating","phase,","we","increase","the","control","parameter\nεsystematically","","from0.3to0.8with","","the","","step∆ε=","","0.01,\nand","","calculate","","from","","the","","machine","","output","","the","","variation","","of","","the\nsynchronization","","order","","parameterR,","","where","","the","","output","","vec-\ntoru=","","[x\n1\n,y\n1\n,x\n2\n,y\n2\n,x\n3\n,y\n3\n,x\n4\n,y\n4\n]\nT\nis","","transformed","","back\nto","","the","","original","","state","","variables[θ\n1\n,θ\n2\n,θ\n3\n,θ\n4\n]\nT\nthroughθ\ni\n=\narctan(y\ni\n/x\ni\n)","+π/2forx\ni\n≥0andθ\ni\n=","arctan(y\ni\n/x\ni\n)","+π\nforx\ni\n<0.","The","prediction","results","are","shown","in","Fig.","5(b)","(red\nopen","circles).","","It","can","be","seen","that,","","at","aboutε\nrc\nf\n=","","0.56,","","the\nvalue","ofRchanges","suddenly","from","about0.38to","about0.8-\nthe","feature","of","a","first-order","transition.\nA","distinct","feature","of","explosive","synchronization","transitions\nis","that","whenεis","varied","in","the","opposite","direction,","","the","varia-\ntion","","ofRwill","","follow","","a","","different","","path","","-","","the","","phenomenon","","of\nhysteresis","","[27–29].","","","To","","demonstrate","","it,","","we","","decreaseεfrom\n0.8to0.3.","","To","numerically","observe","the","hysteresis","in","this","con-\ntext,","we","apply","small","random","perturbations","of","amplitude5%\nto","the","natural","frequency","of","the","leaf","nodes","[28].","","Figure","5(b)\nshows","","the","","results","","(blue","","solid","","up-triangles),","","where","","the","","back-\nward","and","forward","transition","paths","are","identical","forε",">","ε\nf\n,\n0.30.40.50.60.70.8\n0.2\n0.4\n0.6\n0.8\n1.0\nR\ne\n","Forward-Model\n","Forward-RC\n","Backward-Model\n","Backward-RC\ne\nb\n=0.51\ne\nf\n=0.55\ne\nRC\nf\n=0.56\n(a)\n(b)\nFIG.","5.","","","Predicting","explosive","synchronization","transitions","in","coupled\nnonidentical","phase","oscillators.","","(a)","A","star","network.","","(b)","Synchroniza-\ntion","order","parameterRversus","the","coupling","strengthεfor","the","forward\nand","backward","transition","paths.","","","The","true","transitions","obtained","from\nmodel","simulations","are","represented","by","black","solid","squares","(forward\ntransition)","","and","","blue","","solid","","up-triangles","","(backward","","transition).","","","The\ncorresponding","machine","predictions","are","displayed","as","red","open","circles\n(forward","transition)","and","green","empty","down-triangles","(backward","tran-\nsition).","","The","values","of","the","coupling","parameters","used","to","generate","the\ntraining","data","for","predicting","the","forward","and","backward","transitions","are\nmarked","by","the","black","and","red","arrows,","respectively.\nbut","diverge","from","each","other","forε≤ε\nf\n.","","Particularly,","atε\nf\n,\nwe","haveR≈0.9for","the","backward","path,","whereasR≈0.38\nfor","the","forward","path.","Along","the","backward","path,","asεdecreases\nfromε\nf\n,","","the","","value","","ofRmaintains","","at","","large","","values","","until","","the\ncritical","couplingε\nb\n≈0.51,","whereRis","suddenly","decreased\nfrom","","about0.8to","","about0.4.","","","Sinceε\nb\n<","ε\nf\n,","","a","","hysteresis\nloop","of","width∆ε≡ε\nf\n−ε\nb\nemerges","in","the","parameter","re-\ngionε∈(ε\nb\n,ε\nf\n).","The","dynamical","mechanism","for","the","hystere-\nsis","loop","is","the","bistability","of","the","synchronization","manifold","in\nthis","region,","deemed","as","a","necessary","condition","for","generating","a\nfirst-order","phase","transition","[29].\nTo","","predict","","the","","backward","","transition","","path,","","we","","use","","five","","val-\nues","of","the","coupling","parameter","in","the","strong","synchronization\nregime","to","obtain","the","training","data:ε=","0.65,0.625,0.6,0.575\nand0.55.","","","The","input","vector","is","constructed","in","the","same","way\nas","for","predicting","the","forward","transition,","and","the","hyperparam-\neter","values","are(D\nr\n,p,σ,ρ)","=","(1×10\n3\n,0.2,1,1.15)and","the\n\n8\nregression","parameter","isλ=","","1×10\n−7\n.","","We","decreaseεsys-\ntematically","from0.8to0.3.","","The","dependence","ofRonεpre-\ndicted","by","the","machine","is","shown","in","Fig.","5(b)","(open","green","down-\ntriangles).","","It","can","be","seen","that","the","machine","predictions","agree\nwell","with","the","true","behavior","of","the","backward","transition","where,\nat","the","transition","pointε\nb\n,","the","value","ofRdecreases","suddenly\nfrom","about","0.8","to","about","0.45.\nIV.","","DISCUSSION\nWe","have","articulated","and","tested","a","model-free,","machine","learn-\ning","scheme","to","predict","the","synchronization","transition","in","sys-\ntems","of","coupled","oscillators.","The","machine","is","trained","with","time\nseries","collected","from","a","small","number","of","the","coupling","(control)\nparameter,","all","in","the","desynchronization","regime,","as","well","as","the\nvalue","of","the","control","parameter","itself","through","a","specially","de-\nsigned","input","channel.","","Prediction","is","achieved","by","feeding","any\ndesired","parameter","value","into","the","input","parameter","channel.","","A\nproperly","trained","machine","is","able","to","not","only","reproduce,","","sta-\ntistically,","","the","nature","","of","","the","collective","","dynamics","","at","the","","train-\ning","parameter","values,","but","also","predict,","quantitatively,","how","the\ncollective","dynamics","change","with","respect","to","the","variations","in\nthe","control","parameter.","Examples","demonstrating","the","predictive\npower","of","our","machine","learning","scheme","include","complete","syn-\nchronization","in","coupled","identical","chaotic","oscillators","and","ex-\nplosive","synchronization","in","coupled","nonidentical","phase","oscilla-\ntors.","For","complete","synchronization,","both","the","critical","coupling\nfor","synchronization","and","the","variation","in","the","degree","of","synchro-\nnization","about","the","critical","point","can","be","well","predicted.","For","ex-\nplosive","synchronization,","our","scheme","not","only","predicts","the","for-\nward","and","backward","critical","couplings,","but","also","reproduces","the\nhysteresis","loop","associated","with","a","first-order","transition.","Due","to\nthe","importance","of","synchronization","to","the","functionality","and","op-\neration","in","many","natural","and","man-made","systems,","our","machine\nlearning","method","may","find","broad","applications.\nReservoir","computing","based","prediction","of","chaotic","systems","is\nan","extremely","active","field","of","research","at","the","boundary","between\nnonlinear","dynamics","and","machine","learning","[30–48].","The","main\ncontribution","of","the","present","work","is","the","development","of","a","reser-\nvoir","computing","scheme","to","predict","or","anticipate","synchroniza-\ntion","","in","","systems","","of","","coupled","","nonlinear","","oscillators.","","","Our","","work\nfocuses","on","predicting","the","collective","dynamics","instead","of","the\nstate","evolution,","based","on","the","general","idea","to","view","the","predic-\ntive","power","of","reservoir","computing","as","a","kind","of","ability","to","repli-\ncate","the","dynamical","“climate”","of","the","target","system","[33],","which\nis","gained","through","training","with","time","series","data.","","Inspired","by\nthe","recent","works","on","conducting","training","at","multiple","parameter\nvalues","to","predict","bifurcations","[49,","50],","our","work","adopts","a","sim-\nilar","method","by","training","the","machine","at","a","small","number","of","con-\ntrol","parameter","values","in","the","desynchronization","regime","to","instill\ninto","the","machine","the","ability","to","sense","the","change","in","the","“syn-\nchronization","","climate”","","with","","the","","control","","parameter.","","","With","","the\ndesired","(arbitrary)","value","of","the","control","parameter","fed","into","the\ninput","parameter","channel,","a","well","trained","reservoir","computing\nmachine","is","then","able","to","accurately","predict","the","critical","transi-\ntion","between","desynchronization","and","synchronization,","regard-\nless","of","the","nature","of","the","underlying","transition,","","e.g.,","","second-\norder","or","first-order.\nThe","type","of","collective","dynamics","tested","in","the","present","work\nis","complete","synchronization","between","a","pair","of","coupled","chaotic\noscillators","for","which","the","transition","is","of","the","nature","of","second\norder,","and","the","first","order,","explosive","synchronization","in","a","small\nnetwork.","","To","extend","our","work","to","other","types","of","collective","dy-\nnamics","in","large","complex","systems,","such","as","partial","(cluster)","syn-\nchronization,","","chimera-like","","states","","and","","spiral","","waves,","","is","","worth\npursuing.","","A","difficulty","with","large","systems","is","the","requirement\nto","use","large","reservoir","networks","so","that","the","complexity","of","the\nmachine","can","“overpower”","that","of","the","target","system.","","Quanti-\ntatively,","how","the","size","of","the","reservoir","network","should","be","en-\nlarged","to","accommodate","an","increase","in","the","size","of","the","target\nsystem","as","characterized","by,","","e.g.,","","a","scaling","law,","","remains","un-\nknown","at","the","present.","With","the","use","of","large","reservoir","networks\ncome","the","issues","of","data","requirement","and","computation","over-\nload,","","as","to","train","a","large","reservoir","machine","not","only","requires\nmassive","data","but","also","imposes","a","serious","demand","for","the","com-\nputational","resource.","","One","approach","to","deal","with","this","difficulty\nis","","the","","parallel","","reservoir","","computing","","scheme","","[38,","","41].","","","How-\never,","a","recent","work","revealed","that","the","parallel","scheme","may","fail\nto","sense","and","predict","the","phase","coherence","among","a","pair","of","cou-\npled,","nonidentical","chaotic","oscillators","[47].","It","remains","a","worthy\nissue","to","study","if","the","parallel","scheme","can","be","exploited","to","pre-\ndict","the","collective","dynamics","among","a","large","number","of","coupled\noscillators.\nACKNOWLEDGMENTS\nThis","","work","","was","","supported","","by","","the","","National","","Natural","","Sci-\nence","","Foundation","","of","","China","","under","","the","","Grant","","No.","","11875182.\nThe","work","at","Arizona","State","University","was","supported","by","the\nPentagon","Vannevar","Bush","Faculty","Fellowship","program","spon-\nsored","","by","","the","","Basic","","Research","","Office","","of","","the","","Assistant","","Secre-\ntary","","of","","Defense","","for","","Research","","and","","Engineering","","and","","funded\nby","the","Office","of","Naval","Research","through","Grant","No.","N00014-\n16-1-2828,","and","by","the","Army","Research","Office","through","Grant\nNo.","W911NF2120055.\nAppendix","A:","Robustness","of","reservoir","computing","scheme","for\npredicting","synchronization","transition\n1.","","Effect","of","nonuniform","training","data","on","predication\nperformance\nIn","the","main","text,","the","lengths","of","the","time","series","for","training\nat","different","values","of","the","control","parameter","are","identical.","","For\nexample,","for","the","system","of","a","pair","of","chaotic","logistic","maps","in\nSec.","IIIA,","the","length","of","the","time","series","isT=","2×10\n3\n.","If","time\nseries","of","nonuniform","length","are","used","for","training,","the","predi-\ncation","performance","will","be","not","affected.","To","demonstrate","this,\nwe","calculate","the","machine","predicted","synchronization","error","ver-\nsus","the","coupling","parameter","using","training","time","series","of","length\nT=","1000,2000and3000forε=","0.2,0.22and0.24,","respec-\ntively,","","as","","shown","","in","","Fig.","","6","","(red","","discs).","","","Comparing","","with","","the\nresults","of","from","direct","model","simulations","(black","squares),","we\n\n9\n0.180.200.220.240.26\n0.0\n0.1\n0.2\n0.3\n0.4\n∆\nx\nε\n","Model\n","RC-1\n","RC-2\nFIG.","6.Effect","of","nonuniform","segment","length","on","predication","per-\nformance.","","Shown","is","the","variation","of","the","synchronization","error∆x\nversus","the","coupling","parameterεfor","the","system","of","coupled","chaotic\nlogistic","maps","in","the","main","text.","","The","parameter","values","are","the","same\nas","those","in","Fig.","2(a)","in","the","main","text,","","but","with","nonuniform","length\nof","the","time","series","for","different","values","of","the","training","parameter.","","Red\ndiscs:T=","1000,2000and3000forε=","0.2,0.22and0.24,","respec-\ntively;","blue","triangles:T=","3000,2000and1000forε=","0.2,0.22\nand0.24,","respectively.","","The","black","squares","denote","the","corresponding\nresults","from","the","target","system.","","The","vertical","dashed","lines","denote","the\nvalues","of","the","control","parameter","for","training.\nsee","that","the","reservoir","machine","still","predicts","well","the","transition\nabout","the","critical","point.","Similar","results","are","also","obtained","when\nthe","training","data","have","the","lengthT=","3000forε=","0.20,2000\nforε=","0.22,","and1000forε=","0.24,","as","shown","by","the","blue\ntriangles","in","Fig.","6.","The","observation","is","that,","insofar","as","the","train-\ning","data","set","is","sufficient","(e.g.,>1000),","both","the","critical","point\nand","the","associated","transition","behavior","can","be","well","predicted.\n2.","","Effect","of","order","of","training","at","different","control","parameter\nvalues","on","predication","performance\nIn","our","machine","learning","scheme,","the","training","data","are","gener-\nated","by","combining","the","time","series","acquired","from","different","val-\nues","of","the","control","parameter.","We","find","that","order","of","training","at\nthese","parameter","values","does","not","affect","the","the","predication","per-\nformance.","To","demonstrate","this,","we","use","the","results","in","Fig.","2(a)\nin","the","main","text","as","a","reference","and","obtain","prediction","results\nfor","altered","training","orders.","Since","data","are","obtained","from","three\nvalues","of","the","control","parameterε(0.2,","0.22,","and","0.24),","there\nare","six","distinct","sequences","of","training","order.","","Figure","7","shows\nthe","machine","predicted","synchronization","error∆xversusεfor\nall","six","cases,","together","with","the","true","results","obtained","from","di-\nrect","simulation","of","the","target","system.","","It","can","be","seen","that","dif-\nferent","orders","of","training","lead","to","essentially","the","same","result.","A\nheuristic","reason","is","that,","in","obtaining","the","output","matrixW\nout\n,\nthe","regression","operation","is","conducted","for","the","entire,","combined\n0.180.200.220.240.26\n0.0\n0.1\n0.2\n0.3\n0.4\n∆\nx\nε\n","Model\n","RC-1\n","RC-2\n","RC-3\n","RC-4\n","RC-5\n","RC-6\nFIG.","7.","","Effect","of","the","order","of","training","at","different","control","parameter\nvalues","on","predication","performance.","","The","model","and","parameters","are\nidentical","","to","","those","","in","","Fig.","","2(a)","","in","","the","","main","","text,","","while","","the","","order","","of\ntraining","at","the","three","values","of","the","control","parameter","(ε=","0.2,0.22\nand0.24,","as","indicated","by","the","vertical","dashed","lines)","is","altered.","Shown\nis","the","synchronization","error∆xversusε.","","A","change","in","the","training\norder","has","little","effect","on","the","performance.\ntime","series.","","For","a","linear","regression,","the","orders","by","which","the\ntime","series","are","combined","have","little","effect","on","the","result.\n3.","","Impact","of","training","control","parameter","values","on","predication\nperformance\nFor","","the","","given","","number","","of","","training","","parameter","","values,","","the\ncloser","they","are","to","the","transition","point,","the","better","the","predica-\ntion","performance","will","be.","","To","demonstrate","this,","we","consider\nthe","system","of","coupled","chaotic","Logistic","maps","in","the","main","text\nand","test","the","predication","performance","by","changing","the","values\nofεtoε\nM\n−0.04,ε\nM\n−0.02andε\nM\n,","whereε\nM\nis","below\nthe","synchronization","transition","point","so","that","all","three","parameter\nvalues","are","still","in","the","desynchronization","regime.","We","define","the\nfollowing","prediction","error","about","the","transition","as\n〈∆x\ne\n〉=〈|∆ˆx(ε)−∆x(ε)|〉,\nwhere∆ˆx(ε)and∆x(ε)are","the","synchronization","errors","ob-\ntained","from","model","simulation","and","machine","outputs,","and〈...〉\ndenotes","that","the","results","are","averaged","over","the","range0.245≤\nε≤0.255.","Figure","8","shows〈∆x\ne\n〉versusε\nM\n,","the","largest","train-\ning","parameter","value","chosen","in","the","desynchronization","regime.\nAsε\nM\napproaches","the","critical","point,","the","error〈∆x\ne\n〉decreases\ncontinuously,","indicating","that","choosing","the","training","parameter\nvalues","closer","to","the","critical","point","can","improve","the","prediction.\n\n10\n0.230.240.25\n1.5x10\n-3\n2.0x10\n-3\n2.5x10\n-3\n3.0x10\n-3\n3.5x10\n-3\n〈∆\nx\ne\n〉\nεM\nFIG.","8.","","","Impact","of","training","control","parameter","values","on","predication\nperformance.","","With","the","model","for","Fig.","2(a)","in","the","main","text,","the","val-\nues","of","the","control","parameter","for","training","(ε=","0.2,0.22and0.24)","are\nshifted","by","a","small","amount","toward","the","critical","pointε\n1\n=","0.25.","Shown\nis","the","predication","error〈∆x\ne\n〉versus","the","parameter","value","for","train-\ning,","denoted","asε\nM\n.","","As","the","training","parameter","values","move","closer\nto","the","critical","point","(decreasingε\nM\n),","the","predication","performance","is\ncontinuously","improved.\n23456\n2.4x10\n-3\n2.5x10\n-3\n2.6x10\n-3\n2.7x10\n-3\n2.8x10\n-3\n〈∆\nx\ne\n〉\nm\nFIG.","9.","","Impact","of","the","number","of","training","parameter","values","on","pred-\nication","performance.","","The","model","and","parameter","values","are","identical\nto","those","in","Fig.","2(a)","in","the","main","text,","except","that","the","numbermof\ncontrol","","parameter","","values","","chosen","","to","","obtain","","the","","time","","series","","data","","for\ntraining","now","varies.","Shown","is","the","predication","error〈∆x\ne\n〉versusm.\nAn","increase","inmabove","three","improves","the","predication","performance\nbut","only","slightly,","indicating","that","the","reservoir","computing","machine","is\nalready","able","to","capture","the","dynamical","“climate”","of","the","target","system\nwith","training","conducted","at","three","values","of","the","control","parameter.\n4.","","Impact","of","the","number","of","training","parameter","values","on\npredication","performance\nIncreasing","the","numbermof","control","parameter","values","in","the\ndesynchronization","regime","for","training","can","in","general","improve\nthe","prediction","performance,","but","only","incrementally,","insofar","as\n-20\n0\n20\n-20\n0\n20\n-20\n0\n20\n020406080100\n-20\n0\n20\nx\n1\n,\n2\nx\n1\n,\n2\nx\n1\n,\n2\nx\n1\n,\n2\nt\n(a)","ε=2.0\n(b)","ε=2.5\n(c)","ε=3.0\n(d)","ε=3.8\nFIG.","10.","","Predicting","collective","dynamical","behaviors","arising","from","the\nsystem","of","two","coupled","Lorenz","chaotic","oscillators","under","thexcou-\npling","scheme.","","Shown","is","the","time","evolution","of","the","reservoir","outputs\nx\n1\n(black","curve)","andx\n2\n(red","curve)","for","different","values","of","the","control\nparameter:","","(a)ε=","2.0,","(b)ε=","2.5,","(c)ε=","3.0,","and","(d)ε=","3.8.\nThere","is","no","synchronization","in","the","first","three","cases,","but","there","is","for\nthe","last","case,","in","agreement","with","the","result","of","the","analysis","based","on\nthe","master","stability","function","that","the","oscillators","are","completely","syn-\nchronized","forε",">","ε\nc\n=","3.7.\ntraining","is","conducted","based","on","time","series","data","collected","from\nat","least","two","values","of","the","control","parameter.","","To","demonstrate\nthis,","we","take","the","model","in","Fig.","2(a)","in","the","main","text","and","inves-\ntigate","how","the","value","ofmimpacts","the","predicted","synchroniza-\ntion","error,","For","simplicity,","we","choose","themtraining","parameter\nvalues","from","the","interval[0.20,0.24](including","the","two","ending\npoints).","","Figure","9","shows〈∆x\ne\n〉versusm.","","As","the","value","ofm\nincreases","from2to4,","the","predication","error","is","reduced","but","the\ntrend","slows","down","form",">4,","indicating","that","it","is","generally","not\nnecessary","to","conduct","the","training","for","more","than","three","or","four\nvalues","of","the","control","parameter.\nAppendix","B:","Alternative","types","of","coupling","functions\nThe","coupling","function","can","play","a","role","in","the","synchronization\ndynamics:","changing","the","function","can","alter","the","synchronization\ntype","and","the","critical","point.","","In","the","main","text,","we","treat","the","rel-\natively","simple","setting","of","diagonal","coupling","function,","i.e.,","all\nthe","dynamical","variables","of","the","oscillators","are","diffusively","cou-\npled.","To","test","if","the","machine","learning","scheme","remains","effective\nfor","alternative","types","of","coupling","functions,","we","take","the","model\nof","coupled","chaotic","Lorenz","oscillators","studied","in","the","main","text\n[Fig.","3(a)]","and","evaluate","the","prediction","performance","with","dif-\nferent","coupling","functions.\nWhen","the","oscillators","are","coupled","through","the","variablexof\nthe","Lorenz","oscillator,","the","system","equations","are\n","̇x\n1,2\n=α(y\n1,2\n−x\n1,2\n)","+ε(x\n2,1\n−x\n1,2\n),\n","̇y\n1,2\n=x\n1,2\n(β−z\n1,2\n)−y\n1,2\n,(B1)\n","̇z\n1,2\n=x\n1,2\ny\n1,2\n−γz\n1,2\n.\n\n11\n-20\n0\n20\n-20\n0\n20\n-20\n0\n20\n020406080100\n-20\n0\n20\nx\n1\n,\n2\n(a)","ε=0.4\n(b)","ε=0.6\n(c)","ε=0.8\n(d)","ε=1.2\nx\n1\n,\n2\nx\n1\n,\n2\nx\n1\n,\n2\nt\nFIG.","11.Predicting","collective","dynamical","behaviors","arising","from\nthe","","system","","of","","two","","coupled","","Lorenz","","chaotic","","oscillators","","under","","they\ncoupling","scheme.","","Legends","are","the","same","as","those","in","Fig.","10.","","For","(a)\nε=","0.4,","(b)ε=","0.6,","(c)ε=","0.8,","there","is","no","synchronization,","but\ncomplete","synchronization","occurs","for","(d)ε=","1.2,","in","agreement","with\nthe","prediction","of","the","theoretical","analysis","that","the","oscillators","should\nbe","completely","synchronized","forε",">","ε\nc\n=","3.7.\nWe","use","the","same","parameter","values","as","in","the","main","text.","","","An\nanalysis","of","the","master","stability","function","reveals","that,","for","this\nalternative","coupling","scheme,","the","two","oscillators","will","be","com-\npletely","synchronized","forε",">","ε\nc\n≈3.7.","To","generate","the","train-\ning","data,","we","collect","time","series","from","three","values","of","the","con-\ntrol","parameter:ε=","2.0,2.5and3.0.","","The","parameters","of","the\nreservoir","are(D\nr\n,p,σ,ρ,α,ε\nk\n,ε)","=","(2×10\n3\n,0.2,0.05,1×\n10\n−3\n,1,1,0)and","","the","","regression","","parameter","","isλ=","","10\n−7\n.\nFig.","10","shows","the","prediction","result,","where","the","machine","out-\nput","variablesx\n1\nandx\n2\nare","not","synchronized","forε=","2.0,","2.5,\nand","3.0","[Figs.","10(a-c),","respectively],","but","are","synchronized","for\nε=","3.8[Fig.","10(d)],","in","complete","agreement","with","the","theoret-\nical","analysis.\nWe","next","consider","the","scheme","by","which","theyvariables","of\nthe","oscillators","are","coupled.","The","system","equations","are\n","̇x\n1,2\n=α(y\n1,2\n−x\n1,2\n),\n","̇y\n1,2\n=x\n1,2\n(β−z\n1,2\n)−y\n1,2\n+ε(y\n2,1\n−y\n1,2\n),(B2)\n","̇z\n1,2\n=x\n1,2\ny\n1,2\n−γz\n1,2\n,\nwhere","","the","","two","","oscillators","","are","","completely","","synchronized","","for\nε",">","ε\nc\n≈1.1,","as","predicated","by","the","master","stability","function.\nWe","train","the","reservoir","machine","based","on","data","fromε=","0.4,\n0.6and","","0.8.","","","The","","parameter","","values","","of","","the","","reservoir","","are","","the\nsame","","as","","for","","Figs.","","10(a-d),","","but","","the","","regression","","parameter","","is\nλ=","","10\n−10\n.","","Figure","11","shows","the","predicted","synchronization\nbehavior","between","the","machine","outputsx\n1\nandx\n2\nfor","differ-\nent","values","of","the","control","parameter.","","In","complete","agreement\nwith","","the","","result","","of","","the","","theoretical","","analysis,","","there","","is","","no","","syn-\nchronization","forε=","0.4,","0.6,","and","0.8","[Figs.","11(a-c),","respec-\ntively],","but","the","machine","output","variables","are","synchronized","for\nε=","1.2>","ε\nc\n,","as","shown","in","Fig.","11(d).\nWe","finally","consider","the","cross","coupling","scheme,","i.e.,","variable\nxof","one","oscillator","is","coupled","to","variableyof","the","other.","","The\n-20\n0\n20\n-20\n0\n20\n-20\n0\n20\n020406080100\n-20\n0\n20\nx\n1\n,\n2\nx\n1\n,\n2\nx\n1\n,\n2\nx\n1\n,\n2\nt\n(a)","ε=1.8\n(c)","ε=2.2\n(b)","ε=2.0\n(d)","ε=2.7\nFIG.","12.","","Predicting","collective","dynamical","behaviors","arising","from","the\nsystem","of","two","coupled","Lorenz","chaotic","oscillators","under","the","cross","cou-\npling","","scheme.","","","Legends","","are","","the","","same","","as","those","","in","","Fig.","","10.","","","For","","(a)\nε=","1.8,","(b)ε=","2.0,","(c)ε=","2.28,","there","is","no","synchronization,","but\ncomplete","synchronization","occurs","for","(d)ε=","2.7,","in","agreement","with\nthe","prediction","of","the","theoretical","analysis","that","the","oscillators","should\nbe","completely","synchronized","forε",">","ε\nc\n=","2.6.\nsystem","is","described","by\n","̇x\n1,2\n=α(y\n1,2\n−x\n1,2\n),\n","̇y\n1,2\n=x\n1,2\n(β−z\n1,2\n)−y\n1,2\n+ε(x\n2,1\n−x\n1,2\n),(B3)\n","̇z\n1,2\n=x\n1,2\ny\n1,2\n−γz\n1,2\n.\nFor","this","coupling","scheme,","according","to","the","theoretical","analy-\nsis,","the","two","oscillators","are","completely","synchronized","forε",">\nε\nc\n≈2.6.","","Training","data","are","generated","forε=","","1.8,2.0and\n2.2,","","all","in","the","desynchronization","regime.","","","The","values","of","the\nhyperparameters","of","the","reservoir","and","of","the","regression","param-\neter","are","the","same","as","those","in","Fig.","11.","","","Figure","12","shows","the\npredicted","synchronization","behavior","between","the","reservoir","out-\nputsx\n1\nandx\n2\nfor","different","values","ofε.","There","is","no","synchro-\nnization","forε=","1.8,","2.0,","and","2.2,","as","shown","in","Fig.","12(a-c),\nrespectively,","but","forε=","2.7>","ε\nc\n,","the","machine","predicts","syn-\nchronization,","as","shown","in","Fig.","12(d).","These","machine","predicted\nbehaviors","are","in","full","agreement","with","the","result","of","the","theoreti-\ncal","analysis.\n[1]","","Y.","","Kuramoto,Chemical","Oscillations,","Waves,","and","Turbulence\n(Springer,","Berlin,","1984).\n[2]","","A.","Pikovsky,","M.","Rosenblum,","","","and","J.","Kurths,Synchronization:\nA","Universal","Concept","in","Nonlinear","Science(Cambridge","Univer-\n\n12\nsity","Press,","Cambridge,","2003).\n[3]","","S.","","H.","","Strogatz,Sync:","The","Emerging","Science","of","Spontaneous\nOrder(Hyperion,","New","York,","2003).\n[4]","","L.","M.","Pecora","and","T.","L.","Carroll,","“Synchronization","in","chaotic","sys-\ntems,”","Phys.","Rev.","Lett.64,","821","(1990).\n[5]","","M.","G.","Rosenblum,","A.","S.","Pikovsky,","","and","J.","Kurths,","“Phase","syn-\nchronization","of","chaotic","oscillators,”","Phys.","Rev.","Lett.76,","1804\n(1996).\n[6]","","L.","Kocarev","and","U.","Parlitz,","“Generalized","synchronization,","pre-\ndictability,","and","equivalence","of","unidirectionally","coupled","dynam-\nical","systems,”","Phys.","Rev.","Lett.76,","1816","(1996).\n[7]","","E.","R.","Kandel,","J.","H.","Schwartz,","","","and","T.","M.","Jessell,Principle","of\nNeural","Science,","","3rd","","ed.","","(Appleton","","and","","Lange,","","Norwalk","","CT,\n1991).\n[8]","","Y.-C.","Lai,","M.","G.","Frei,","","","and","I.","Osorio,","“Detecting","and","charac-\nterizing","phase","synchronization","in","nonstationary","dynamical","sys-\ntems,”","Phys.","Rev.","E73,","026214","(2006).\n[9]","","Y.-C.","Lai,","M.","G.","Frei,","I.","Osorio,","","and","L.","Huang,","“Characteriza-\ntion","of","synchrony","with","applications","to","epileptic","brain","signals,”\nPhys.","Rev.","Lett.98,","108102","(2007).\n[10]","","I.","Osorio","and","Y.-C.","Lai,","“A","phase-synchronization","and","random-\nmatrix","","based","","approach","","to","","multichannel","","time-series","","analysis\nwith","application","to","epilepsy,”","Chaos21,","033108","(2011).\n[11]","","H.","Jaeger,","“The","“echo","state”","approach","to","analysing","and","training\nrecurrent","","neural","","networks-with","","an","","erratum","","note,”","","Bonn,","","Ger-\nmany:","German","National","Research","Center","for","Information","Tech-\nnology","GMD","Technical","Report148,","13","(2001).\n[12]","","H.","","Jaeger","","and","","H.","","Haas,","","“Harnessing","","nonlinearity:","","Predicting\nchaotic","systems","and","saving","energy","in","wireless","communication,”\nScience304,","78","(2004).\n[13]","","L.","","M.","","Pecora","","and","","T.","","L.","","Carroll,","","“Master","","stability","","functions\nfor","synchronized","coupled","systems,”","Phys.","Rev.","Lett.80,","2109\n(1998).\n[14]","","L.","","Huang,","","Q.","","Chen,","","Y.-C.","","Lai,","","","and","","L.","","M.","","Pecora,","","“Generic\nbehavior","of","master-stability","functions","in","coupled","nonlinear","dy-\nnamical","systems,”","Phys.","Rev.","E80,","036204","(2009).\n[15]","","S.","Watanabe","and","S.","H.","Strogatz,","“Integrability","of","a","globally","cou-\npled","oscillator","array,”","Phys.","Rev.","Lett.70,","2391","(1993).\n[16]","","E.","Ott","and","T.","M.","Antonsen,","“Low","dimensional","behavior","of","large\nsystems","","of","","globally","","coupled","","oscillators,”","","Chaos18,","","037113\n(2008).\n[17]","","C.","","R.","","S.","","Williams,","","T.","","E.","","Murphy,","","R.","","Roy,","","F.","","Sorrentino,\nT.","Dahms,","","and","E.","Sch\n","̈\noll,","“Experimental","observations","of","group\nsynchrony","","in","","a","","system","","of","","chaotic","","optoelectronic","","oscillators,”\nPhys.","Rev.","Lett.110,","064104","(2013).\n[18]","","C.","Williams,","F.","Sorrentino,","T.","E.","Murphy,","","","and","R.","Roy,","“Syn-\nchronization","states","and","multistability","in","a","ring","of","periodic","os-\ncillators:","","Experimentally","variable","coupling","delays,”","Chaos23,\n143117","(2013).\n[19]","","J.","D.","Hart,","J.","P.","Pade,","T.","Pereira,","T.","E.","Murphy,","","","and","R.","Roy,\n“Adding","","connections","","can","","hinder","","network","","synchronization","","of\ntime-delayed","oscillators,”","Phys.","Rev.","E92,","022804","(2015).\n[20]","","A.","Arenas,","A.","D\n","́\nıaz-Guilera,","J.","Kurths,","Y.","Moreno,","","","and","C.","S.\nZhou,","“Synchronization","in","complex","networks,”","Phy.","Rep.469,\n93","","(2008).\n[21]","","M.","","Barahona","","and","","L.","","M.","","Pecora,","","“Synchronization","","in","","small-\nworld","systems,”","Phys.","Rev.","Lett.89,","054101","(2002).\n[22]","","T.","Nishikawa,","A.","E.","Motter,","Y.-C.","Lai,","","and","F.","C.","Hoppensteadt,\n“Heterogeneity","in","oscillator","networks:","Are","smaller","worlds","eas-\nier","to","synchronize?”","Phys.","Rev.","Lett.91,","014101","(2003).\n[23]","","X.","G.","Wang,","","Y.-C.","Lai,","","","and","C.","H.","Lai,","“Enhancing","synchro-\nnization","","based","","on","","complex","","gradient","","networks,”","","Phys.","","Rev.","","E\n75,","056205","(2007).\n[24]","","F.","Ricci,","R.","Tonelli,","L.","Huang,","","and","Y.-C.","Lai,","“Onset","of","chaotic\nphase","synchronization","in","complex","networks","of","coupled","hetero-\ngeneous","oscillators,”","Phys.","Rev.","E86,","027201","(2012).\n[25]","","L.","M.","Pecora,","F.","Sorrentino,","A.","M.","Hagerstrom,","T.","E.","Murphy,\nand","R.","Roy,","“Cluster","synchronization","and","isolated","desynchro-\nnization","in","complex","networks","with","symmetries,”","Nat.","Commun.\n5,","4079","(2014).\n[26]","","F.","Sorrentino,","L.","M.","Pecora,","A.","M.","Hagerstrom,","T.","E.","Murphy,\nand","R.","Roy,","“Cluster","synchronization","and","isolated","desynchro-\nnization","in","complex","networks","with","symmetries,”","Sci.","Adv.2,\ne1501737","(2016).\n[27]","","J.","","G\n","́\nomez-Garde\n","̃\nnes,","","S.","","G\n","́\nomez,","","A.","","Arenas,","","","and","","Y.","","Moreno,\n“Explosive","synchronization","transitions","in","scale-free","networks,”\nPhys.","Rev.","Lett.106,","128701","(2011).\n[28]","","Y.","Zou,","T.","Pereira,","M.","Small,","Z.","Liu,","","and","J.","Kurths,","“Basin","of\nattraction","determines","hysteresis","in","explosive","synchronization,”\nPhys.","Rev.","Lett.112,","114102","(2014).\n[29]","","S.","","Boccaletti,","","J.","","A.","","Almendral,","","S.","","Guan,","","I.","","Leyva,","","Z.","","Liu,\nI.","Sendi\n","̃\nna-Nadal,","Z.","Wang,","","and","Y.","Zou,","“Explosive","transitions\nin","complex","networks’","structure","and","dynamics:","Percolation","and\nsynchronization,”","Phys.","Rep.660,","1","(2016).\n[30]","","Z.","","C.","","Lipton,","","J.","","Berkowitz,and","","C.","","Elkan,","","“A","","critical","","re-\nview","","of","","recurrent","","neural","","networks","","for","","sequence","","learning,”\narXiv:1506.00019","","(2015).\n[31]","","N.","D.","Haynes,","M.","C.","Soriano,","D.","P.","Rosin,","I.","Fischer,","","and","D.","J.\nGauthier,","","“Reservoir","","computing","","with","","a","","single","","time-delay","","au-\ntonomous","Boolean","node,”","Phys.","Rev.","E91,","020801","(2015).\n[32]","","L.","Larger,","A.","Bayl\n","́\non-Fuentes,","R.","Martinenghi,","V.","S.","Udaltsov,\nY.","K.","Chembo,","","","and","M.","Jacquot,","“High-speed","photonic","reser-\nvoir","","computing","","using","","a","","time-delay-based","","architecture:","","","Mil-\nlion","words","per","second","classification,”","Phys.","Rev.","X7,","011015\n(2017).\n[33]","","J.","Pathak,","Z.","Lu,","B.","R.","Hunt,","M.","Girvan,","","","and","E.","Ott,","“Using\nmachine","","learning","","to","","replicate","","chaotic","","attractors","","and","","calculate\nlyapunov","exponents","from","data,”","Chaos27,","121102","(2017).\n[34]","","Z.","Lu,","J.","Pathak,","B.","Hunt,","M.","Girvan,","R.","Brockett,","","and","E.","Ott,\n“Reservoir","","observers:","","","Model-free","","inference","","of","","unmeasured\nvariables","in","chaotic","systems,”","Chaos27,","041102","(2017).\n[35]","","T.","","","Duriez,","","","S.","","","L.","","","Brunton,and","","","B.","","","R.","","","Noack,Machine\nLearning","Control-Taming","Nonlinear","Dynamics","and","Turbulence\n(Springer,","2017).\n[36]","","Z.","","Lu,","","B.","","R.","","Hunt,","","","and","","E.","","Ott,","","“Attractor","","reconstruction","","by\nmachine","learning,”","Chaos28,","061104","(2018).\n[37]","","J.","Pathak,","A.","Wilner,","R.","Fussell,","S.","Chandra,","B.","Hunt,","M.","Gir-\nvan,","","","Z.","","Lu,and","","E.","","Ott,","","“Hybrid","","forecasting","","of","","chaotic\nprocesses:","","","","Using","","machine","","learning","","in","","conjunction","","with","","a\nknowledge-based","model,”","Chaos28,","041101","(2018).\n[38]","","J.","Pathak,","B.","Hunt,","M.","Girvan,","Z.","Lu,","","and","E.","Ott,","“Model-free\nprediction","of","large","spatiotemporally","chaotic","systems","from","data:\nA","reservoir","computing","approach,”","Phys.","Rev.","Lett.120,","024102\n(2018).\n[39]","","T.","L.","Carroll,","“Using","reservoir","computers","to","distinguish","chaotic\nsignals,”","Phys.","Rev.","E98,","052209","(2018).\n[40]","","K.","","Nakai","","and","","Y.","","Saiki,","","“Machine-learning","","inference","","of","","fluid\nvariables","from","data","using","reservoir","computing,”","Phys.","Rev.","E\n98,","023111","(2018).\n[41]","","R.","S.","Zimmermann","and","U.","Parlitz,","“Observing","spatio-temporal\ndynamics","of","excitable","media","using","reservoir","computing,”","Chaos\n28,","043118","(2018).\n[42]","","T.","Weng,","H.","Yang,","C.","Gu,","J.","Zhang,","","and","M.","Small,","“Synchro-\nnization","","of","","chaotic","","systems","","and","","their","","machine-learning","","mod-\nels,”","Phys.","Rev.","E99,","042203","(2019).\n[43]","","A.","","Griffith,","","A.","","Pomerance,","","","and","","D.","","J.","","Gauthier,","","“Forecasting\nchaotic","systems","with","very","low","connectivity","reservoir","comput-\ners,”","Chaos29,","123108","(2019).\n\n13\n[44]","","J.","Jiang","and","Y.-C.","Lai,","“Model-free","prediction","of","spatiotemporal\ndynamical","systems","with","recurrent","neural","networks:","Role","of","net-\nwork","spectral","radius,”","Phys.","Rev.","Research1,","033056","(2019).\n[45]","","P.","R.","Vlachas,","J.","Pathak,","B.","R.","Hunt,","T.","P.","Sapsis,","M.","Girvan,\nE.","Ott,","","and","P.","Koumoutsakos,","“Forecasting","of","spatio-temporal\nchaotic","dynamics","with","recurrent","neural","networks:","","A","compar-\native","study","of","reservoir","computing","and","backpropagation","algo-\nrithms,”","arXiv","preprint","arXiv:1910.05266","","(2019).\n[46]","","H.","Fan,","J.","Jiang,","C.","Zhang,","X.","Wang,","","and","Y.-C.","Lai,","“Long-term\nprediction","","of","","chaotic","","systems","","with","","machine","","learning,”","","Phys.\nRev.","Research2,","012080","(2020).\n[47]","","C.","Zhang,","J.","Jiang,","S.-X.","Qu,","","and","Y.-C.","Lai,","“Predicting","phase\nand","sensing","phase","coherence","in","chaotic","systems","with","machine\nlearning,”","Chaos30,","083114","(2020).\n[48]","","Y.","Guo,","","H.","Zhang,","","L.","Wang,","","H.","Fan,","","J.","Xiao,","","","and","X.","Wang,\n“Transfer","","learning","","of","","chaotic","","systems,”","","Chaos31,","","011104\n(2021).\n[49]","","R.","Cestnik","and","M.","Abel,","“Inferring","the","dynamics","of","oscillatory\nsystems","","using","","recurrent","","neural","","networks,”","","Chaos29,","","063128\n(2019).\n[50]","","L.-W.","Kong,","H.-W.","Fan,","C.","Grebogi,","","and","Y.-C.","Lai,","“Machine\nlearning","prediction","of","critical","transition","and","system","collapse,”\nPhys.","Rev.","Research3,","013090","(2021).\n[51]","","W.-X.","","Wang,","","R.","","Yang,","","Y.-C.","","Lai,","","V.","","Kovanis,","","","","and","","C.","","Gre-\nbogi,","“Predicting","catastrophes","in","nonlinear","dynamical","systems\nby","compressive","sensing,”","Phys.","Rev.","Lett.106,","154101","(2011).\n[52]","","W.-X.","","Wang,","","R.","","Yang,","","Y.-C.","","Lai,","","V.","","Kovanis,","","","and","","M.","","A.","","F.\nHarrison,","“Time-series-based","prediction","of","complex","oscillator\nnetworks","via","compressive","sensing,”","EPL","(Europhys.","Lett.)94,\n48006","(2011).\n[53]","","W.","Wang,","Y.-C.","Lai,","","and","C.","Grebogi,","“Data","based","identification\nand","prediction","of","nonlinear","and","complex","dynamical","systems,”\nPhys.","Rep.644,","1","(2016).\n[54]","","R.-Q.","Su,","X.","Ni,","W.-X.","Wang,","","and","Y.-C.","Lai,","“Forecasting","syn-\nchronizability","of","complex","networks","from","data,”","Phys.","Rev.","E\n85,","056220","(2012).\n[55]","","E.","N.","Lorenz,","“Deterministic","nonperiodic","flow,”","J.","Atmos.","Sci.\n20,","130","(1963).\n[56]","","K.","McCann","and","P.","Yodzis,","“Nonlinear","dynamics","and","population\ndisappearances,”","Ame.","Naturalist144,","873","(1994)."],"doc7":["\n\narXiv:2103.13883v1","","[cs.LG]","","25","Mar","2021\nRisk","Bounds","and","Rademacher","Complexity","in\nBatch","Reinforcement","Learning\nYaqi","DuanChi","JinZhiyuan","Li\nPrinceton","UniversityPrinceton","UniversityPrinceton","University\nyaqid@princeton.edu","","chij@princeton.edu","","zhiyuanli@cs.princeton.edu\nMarch","26,","2021\nAbstract\nThis","paper","considers","batch","Reinforcement","Learning","(RL)","with","general","value","function","approxima-\ntion.","Our","study","investigates","the","minimal","assumptions","to","reliably","estimate/minimize","Bellman","error,","and\ncharacterizes","the","generalization","performance","by","(local)","Rademacher","complexities","of","general","function\nclasses,","which","makes","initial","steps","in","bridging","the","gap","between","statistical","learning","theory","and","batch","RL.\nConcretely,","we","view","the","Bellman","error","as","a","surrogate","loss","forthe","optimality","gap,","and","prove","the","follow-\nings:","(1)","In","double","sampling","regime,","the","excess","risk","of","Empirical","Risk","Minimizer","(ERM)","is","bounded\nby","the","Rademacher","complexity","of","the","function","class.","(2)","In","the","single","sampling","regime,","sample-efficient\nrisk","minimization","is","not","possible","without","further","assumptions,","regardless","of","algorithms.","However,","with\ncompleteness","assumptions,","the","excess","risk","of","FQI","and","a","minimax","style","algorithm","can","be","again","bounded\nby","the","Rademacher","complexity","of","the","corresponding","functionclasses.","(3)","Fast","statistical","rates","can","be\nachieved","by","using","tools","of","local","Rademacher","complexity.","Ouranalysis","covers","a","wide","range","of","function\nclasses,","including","finite","classes,","linear","spaces,","kernel","spaces,","sparse","linear","features,","etc.\n1","","Introduction\nStatistical","learning","theory,","since","its","introduction","in","thelate","1960’s,","has","become","one","of","the","most","important\nframeworks","in","machine","learning,","to","study","problems","of","inference","or","function","estimation","from","a","given","collec-\ntion","of","data","[\nHastie","et","al.,2009,Vapnik,2013,James","et","al.,2013].","The","development","of","statistical","learning\nhas","led","to","a","series","of","new","popular","algorithms","including","support","vector","machines","[\nCortes","and","Vapnik,1995,\nSuykens","and","Vandewalle,1999],","boosting","[Freund","et","al.,1996,Schapire,1999],","as","well","as","many","successful\napplications","in","fields","such","as","computer","vision","[\nSzeliski,2010,Forsyth","and","Ponce,2012],","speech","recognition\n[\nJuang","and","Rabiner,1991,Jelinek,1997],","and","bioinformatics","[Baldi","et","al.,2001].\nNotably,","in","the","area","of","supervised","learning,","a","considerableamount","of","effort","has","been","spent","on","obtaining\nsharp","risk","bounds.","These","are","valuable,","for","instance,","in","the","problem","of","model","selection—choosing","a","model\nof","suitable","complexity.","Typically,","these","risk","bounds","characterize","the","excess","risk—the","suboptimality","of","the\nlearned","function","compared","to","the","best","function","within","a","given","function","class,","via","proper","complexity","mea-\nsures","of","that","function","class.","After","a","long","line","of","extensive","research","[\nVapnik,2013,Vapnik","and","Chervonenkis,\n2015,Bartlett","et","al.,2005,2006],","risk","bounds","are","proved","under","very","weak","assumptions","which","do","not","require\nrealizability—the","prespecified","function","class","contains","the","ground-truth.","The","complexity","measures","for","gen-\neral","function","classes","have","also","been","developed,","including","but","not","limited","to","metric","entropy","[Dudley,1974],\nVC","dimension","[\nVapnik","and","Chervonenkis,2015]","and","Rademacher","complexity","[Bartlett","and","Mendelson,2002].\n(See","e.g.\nWainwright[2019]","for","a","textbook","review.)\nConcurrently,","batch","reinforcement","learning","[\nLange","et","al.,2012,Levine","et","al.,2020]—a","branch","of","Re-\ninforcement","Learning","(RL)","that","learns","from","offline","data,","hasbeen","independently","developed.","This","paper\n1\n\nconsiders","the","value","function","approximation","setting,","wherethe","learning","agent","aims","to","approximate","the","opti-\nmal","value","function","from","a","restricted","function","class","that","encodes","the","prior","knowledge.","Batch","RL","with","value\nfunction","approximation","provides","an","important","foundation","for","the","empirical","success","of","modern","RL,","and","leads\nto","the","design","of","many","popular","algorithms","such","as","DQN","[\nMnih","et","al.,2015]","and","Fitted","Q-Iteration","with","neural\nnetworks","[\nRiedmiller,2005,Fan","et","al.,2020].\nDespite","being","a","special","case","of","supervised","learning,","batch","RL","also","brings","several","unique","challenges","due\nto","the","additional","requirement","of","learning","the","rich","temporalstructures","within","the","data.","Addressing","these\nunique","challenges","has","been","the","main","focus","of","the","field","so","far","[\nLevine","et","al.,2020].","Consequently,","the","field\nof","statistical","learning","and","batch","RL","have","been","developed","relatively","in","parallel.","","In","contrast","to","the","mild\nassumptions","required","and","the","generic","function","class","allowed","in","classical","statistical","learning","theory,","a","majority\nof","batch","RL","results","[\nMunos","and","Szepesv","́ari,2008,Antos","et","al.,2008,Lazaric","et","al.,2012,Chen","and","Jiang,\n2019]","remain","under","rather","strong","assumptions","which","rarely","hold","in","practice,","and","are","applicable","only","to","a\nrestricted","set","of","function","classes.","This","raises","a","natural","question:","can","we","bring","the","rich","knowledge","in","statistical\nlearning","theory","to","advance","our","understanding","in","batch","RL?\nThis","paper","makes","initial","steps","in","bridging","the","gap","between","statistical","learning","theory","and","batch","RL.\nWe","investigate","the","minimal","assumptions","required","to","reliably","estimate","or","minimize","the","Bellman","error,","and\ncharacterize","the","generalization","performance","of","batch","RL","algorithms","by","(local)","Rademacher","complexities","of\ngeneral","function","classes.","Concretely,","we","establish","conditions","when","the","Bellman","error","can","be","viewed","as","a\nsurrogate","loss","for","the","optimality","gap","in","values.","We","then","bound","the","excess","risk","measured","in","Bellman","errors.\nWe","prove","the","followings:\n•","In","the","double","sampling","regime,","the","excess","risk","of","a","simple","Empirical","Risk","Minimizer","(ERM)","is\nbounded","by","the","Rademacher","complexity","of","the","function","class,under","almost","no","assumptions.\n•","In","the","single","sampling","regime,","without","further","assumptions,","no","algorithm","can","achieve","small","excess\nrisk","in","the","worse","case","unless","the","number","of","samples","scales","up","polynomially","with","respect","to","the","number\nof","states.\n•","In","the","single","sampling","regime,","under","additional","completeness","assumptions,","the","excess","risks","of","Fitted\nQ-Iteration","(FQI)","algorithm","and","a","minimax","style","algorithm","can","be","again","bounded","by","the","Rademacher\ncomplexity","of","the","corresponding","function","classes.\n•","Fast","statistical","rates","can","be","achieved","by","using","tools","of","local","Rademacher","complexity.\nFinally,","we","specialize","our","generic","theory","to","concrete","examples,","and","show","that","our","analysis","covers","a","wide\nrange","of","function","classes,","including","finite","classes,","linearspaces,","kernel","spaces,","sparse","linear","features,","etc.\n1.1","","Related","Work\nWe","restrict","our","discussions","in","this","section","to","the","RL","resultsunder","function","approximation.\nBatch","RLThere","exists","a","stream","of","literature","regarding","finite","sample","guarantees","for","batch","RL","with","value\nfunction","approximation.","Among","the","works,","fitted","value","iteration","[\nMunos","and","Szepesv","́ari,2008]","and","policy\niteration","[\nAntos","et","al.,2008,Farahmand","et","al.,2008,Lazaric","et","al.,2012,Farahmand","et","al.,2016,Le","et","al.,\n2019]","are","canonical","and","popular","approaches.","When","using","a","linear","function","space,","the","sample","complexity\nfor","batch","RL","is","shown","to","depend","on","the","dimension","[\nLazaric","et","al.,2012].","When","it","comes","to","general","function\nclasses,","several","complexity","measures","of","function","class","such","as","metric","entropy","and","VC","dimensions","have","been\n2\n\nused","to","bound","the","performance","of","fitted","value","iteration","and","policy","iteration","[Munos","and","Szepesv","́ari,2008,\nAntos","et","al.,2008,Farahmand","et","al.,2016].\nThroughout","the","existing","theoretical","studies","of","batch","RL,","people","commonly","use","concentrability,","realizabil-\nity","and","completeness","assumptions","to","prove","polynomial","sample","complexity.Chen","and","Jiang[2019]","justify\nthe","necessity","of","low","concentrability","and","hold","a","debate","on","realizability","and","completeness.\nXie","and","Jiang\n[2020a]","develop","an","algorithm","that","only","relies","on","the","realizabilityof","optimal","Q-function","and","circumvents\ncompleteness","condition.","However,","they","use","a","stronger","concentrability","assumption","and","the","error","bound","has\na","slower","convergence","rate.","While","the","analyses","inChen","and","Jiang[2019]","andXie","and","Jiang[2020a]","are","re-\nstricted","to","discrete","function","classes","with","a","finite","number","ofelements,\nWang","et","al.[2020a]","investigate","value\nfunction","approximation","with","linear","spaces.","It","is","shown","thatdata","coverage","and","realizability","conditions","are\nnot","sufficient","for","polynomial","sample","complexity","in","the","linear","case.\nOff-policy","evaluationOff-policy","evaluation","(OPE)","refers","to","the","estimation","of","value","function","given","of-\nfline","data","[\nPrecup,2000,Precup","et","al.,2001,Xie","et","al.,2019,Uehara","et","al.,2020,Kallus","and","Uehara,2020,\nYin","et","al.,2020,Uehara","et","al.,2021],","which","can","be","viewed","as","a","subroutine","of","batch","RL.","Combining","OPE\nwith","policy","improvement","leads","to","policy-iteration-based","or","actor-critic","algorithms","[\nDann","et","al.,2014].","OPE\nis","considered","as","a","simpler","problem","than","batch","RL","and","its","analyses","cannot","directly","translate","to","guarantees","in\nbatch","RL.\nOnline","RLRL","in","online","mode","is","in","general","a","more","difficult","problem","than","batch","RL.","The","role","of","value\nfunction","approximation","in","online","RL","remains","largely","unclear.","It","requires","better","tools","to","measure","the","capacity\nof","function","class","in","an","online","manner.","In","the","past","few","years,","there","are","some","investigations","in","this","direction,\nincluding","using","Bellman","rank","[\nJiang","et","al.,2017]","and","Eluder","dimension","[Wang","et","al.,2020b]","to","characterize\nthe","hardness","of","RL","problem.\n1.2","","Notation\nFor","any","integerK",">0,","let[K]be","the","collection","of1,2,...",",K.","","We","use1[·]to","denote","the","indicator\nfunction.","","For","any","functionq(·)and","any","measureρover","the","domain","ofq,","we","define","normk·k\nρ\nwhere\nkqk\n2\nρ\n:\n=E\nx∼ρ\nq\n2\n(x).","Letρ\n1\nbe","a","measure","overX\n1\nandρ\n2\n(·","|x\n1\n)be","a","conditional","distribution","overX\n2\n.\nDefineρ\n1\n×ρ\n2\nas","a","joint","distribution","overX\n1\n×X\n2\n,","given","by(ρ\n1\n×ρ\n2\n)(x\n1\n,x\n2\n)",":=ρ\n1\n(x\n1\n)ρ\n2\n(x\n2\n|x\n1\n).","For\nany","finite","setX,","let","Unif(X)define","a","uniform","distribution","overX.\n2","","Preliminaries\nWe","consider","the","setting","of","episodic","Markov","decision","processMDP(S,A,H,P,r),","whereSis","the","set","of\nstates","which","possibly","has","infinitely","many","elements;Ais","a","finite","set","of","actions","with|A|=A;His","the\nnumber","of","steps","in","each","episode;P\nh\n(·","|s,a)gives","the","distribution","over","the","next","state","if","actionais","taken\nfrom","statesat","steph∈[H];","andr\nh\n:S×A→[0,1]is","the","deterministic","reward","function","at","steph.\n1\nIn","each","episode","of","an","MDP,","we","start","witha","fixed","initial","states\n1\n.","Then,","at","each","steph∈[H],","the\nagent","observes","states\nh\n∈S,","picks","an","actiona\nh\n∈A,","receives","rewardr\nh\n(s\nh\n,a\nh\n),","and","then","transitions","to","the\nnext","states\nh+1\n,","which","is","drawn","from","the","distributionP\nh\n(·","|s\nh\n,a\nh\n).","Without","loss","of","generality,","we","assume\n1\nWhile","we","study","deterministic","reward","functions","for","notational","simplicity,","our","results","generalize","to","randomized","rewardfunctions.\nNote","that","we","are","assuming","that","rewards","are","in[0,1]for","normalization.\n3\n\nthere","is","a","terminating","states\nend\nwhich","the","environment","willalwaystransit","to","at","stepH+","1,","and","the","episode\nterminates","whens\nend\nis","reached.\nA","(non-stationary,","stochastic)","policyπis","a","collection","ofHfunctions\n\b\nπ\nh\n:S","→∆\nA\n\t\nh∈[H]\n,","where\n∆\nA\nis","the","probability","simplex","over","action","setA.","We","denoteπ\nh\n(·","|s)as","the","action","distribution","for","policy\nπat","statesand","timeh.","LetV\nπ\nh\n:S","→Rdenote","the","value","function","at","stephunder","policyπ,","which","gives\nthe","expected","sum","of","remaining","rewards","received","under","policyπ,","starting","froms\nh\n=s,","until","the","end","of","the\nepisode.","That","is,\nV\nπ\nh\n(s)\n:\n=E\nπ\n\"\nH\nX\nh\n′\n=h\nr\nh\n′\n(s\nh\n′\n,a\nh\n′\n)\n\f\n\f\n\f\n\f\n\f\ns\nh\n=s\n#\n.\nAccordingly,","the","action-value","functionQ\nπ\nh\n:S×A→Rat","stephis","defined","as,\nQ\nπ\nh\n(s,a)\n:\n=E\nπ\n\"\nH\nX\nh\n′\n=h\nr\nh\n′\n(s\nh\n′\n,a\nh\n′\n)\n\f\n\f\n\f\n\f\n\f\ns\nh\n=s,a\nh\n=a\n#\n.\nSince","the","action","spaces,","and","the","horizon,","are","all","finite,","there","always","exists","(see,","e.g.,\nPuterman[2014])\nan","optimal","policyπ\n⋆\nwhich","gives","the","optimal","valueV\n⋆\nh\n(s)","=","sup\nπ\nV\nπ\nh\n(s)for","alls∈Sandh∈[H].\nFor","notational","convenience,","we","take","shorthandsP\nh\n,P\nπ\nh\n,P\n⋆\nh\nas","follows,","where(s,a)is","the","state-action\npair","for","the","current","step,","while(s\n′\n,a\n′\n)is","the","state-action","pair","for","the","next","step,\n[P\nh\nV](s,a)\n:\n=E\n\u0002\nV(s\n′\n)\n\f\n\f\ns,a\n\u0003\n,\n[P\nπ\nh\nQ](s,a)\n:\n=E\nπ\n\u0002\nQ(s\n′\n,a\n′\n)\n\f\n\f\ns,a\n\u0003\n,\n[P\n⋆\nh\nQ](s,a)\n:\n=E\n\u0002\nmax\na\n′\nQ(s\n′\n,a\n′\n)\n\f\n\f\ns,a\n\u0003\n.\nWe","further","define","Bellman","operatorsT\nπ\nh\n,T\n⋆\nh\n:R\nS×A\n→R\nS×A\nforh∈[H]as\n(T\nπ\nh\nQ)(s,a)\n:\n=","(r\nh\n+P\nπ\nh\nQ)(s,a),\n(T\n⋆\nh\nQ)(s,a)\n:\n=","(r\nh\n+P\n⋆\nh\nQ)(s,a).\nThen","the","Bellman","equation","and","the","Bellman","optimality","equation","can","be","written","as:\nQ\nπ\nh\n(s,a)","=","(T\nπ\nh\nQ\nπ\nh+1\n)(s,a),","Q\n⋆\nh\n(s,a)","=","(T\n⋆\nh\nQ\n⋆\nh+1\n)(s,a).\nThe","objective","of","RL","is","to","find","a","near-optimal","policy,","where","thesub-optimality","is","measured","byV\n⋆\n1\n(s\n1\n)−\nV\nπ\n1\n(s\n1\n).","Accordingly,","we","have","the","following","definition","ofǫ-optimal","policy.\nDefinition","2.1(ǫ-optimal","policy).We","say","a","policyπisǫ-optimalifV\n⋆\n1\n(s\n1\n)−V\nπ\n1\n(s\n1\n)≤ǫ.\n2.1","","(Local)","Rademacher","complexity\nIn","this","paper,","we","leverage","Rademacher","complexity","to","characterize","the","complexity","of","a","function","class.","For","a\ngeneric","real-valued","function","spaceF","⊆R\nX\nandnfixed","data","pointsX={x\n1\n,...,x\nn\n}∈X\nn\n,","the","empirical\nRademacher","complexity","is","defined","as\nb\nR\nX\n(F)",":=E\n\"\nsup\nf∈F\n1\nn\nn\nX\ni=1\nσ\ni\nf(x\ni\n)\n\f\n\f\n\f\n\f\n\f\nX\n#\n,\n4\n\nwhereσ\ni\n∼Uniform({−1,1})arei.i.d.Rademacher","random","variables","and","the","expectation","is","taken","with\nrespect","to","the","uncertainties","in{σ\ni\n}\nn\ni=1\n.","Letρbe","the","underlying","distribution","ofx\ni\n.","We","further","define","a\npopulation","Rademacher","complexityR\nρ\nn\n(F)",":=E\nρ\n[\nb\nR\nX\n(F)]with","expectation","taken","over","data","samplesX.\nIntuitively,R\nρ\nn\n(F)measures","the","complexity","ofFby","the","extent","to","which","functions","in","the","classFcorrelate\nwith","random","noiseσ\ni\n.\nThis","paper","further","uses","the","tools","of","local","Rademacher","complexity","to","obtain","results","with","fast","statistical\nrate.","For","a","generic","real-valued","function","spaceF","⊆R\nX\n,","and","data","distributionρ.","LetTbe","a","functional\nT:F","→R\n+\n,","we","study","the","local","Radmacher","complexity","in","the","form","of\nR\nρ\nn\n({f∈F","|T(f)≤r}).\nA","crucial","quantity","that","appears","in","the","generalization","errorbound","using","local","Rademacher","complexity","is","the\ncritical","radius","[\nBartlett","et","al.,2005].","We","define","as","follows.\nDefinition","2.2(Sub-root","function).A","functionψ:R\n+\n→R\n+\nis","sub-root","if","it","is","nondecreasing,","and\nr→ψ(r)/\n√\nris","nonincreasing","forr",">0.\nDefinition","2.3(Critical","radius","of","local","Radmacher","complexity).The","critical","radius","of","the","local","Radmacher\ncomplexityR\nρ\nn\n({f∈","F","|T(f)≤r})is","the","infimum","of","the","setB,","where","setBis","defined","as","follows:","for\nanyr\n⋆\n∈B,","there","exists","a","sub-root","functionψsuch","thatr\n⋆\nis","the","fixed","point","ofψ,","and","for","anyr≥r\n⋆\nwe\nhave\nψ(r)≥R\nρ\nn\n({f∈F","|T(f)≤r}).(1)\nWe","typically","obtain","an","upper","bound","of","this","critical","radius","byconstructing","one","specific","sub-root","function\nψsatisfying","(\n1).\n3","","Batch","RL","with","Value","Function","Approximation\nThis","paper","focuses","on","the","offline","setting","where","the","data","in","form","of","tuplesD={(s,a,r,s\n′\n,h)}are","collected\nbeforehand,","and","are","given","to","the","agent.","In","each","tuple,(s,a)are","the","state","and","action","at","theh\nth\nstep,r\nis","the","resulting","reward,","ands\n′\nis","the","next","state","sampled","fromP\nh\n(·|s,a).","","For","eachh∈[H],","we","have\naccess","tondata,","that","arei.i.dsampled","with","marginal","distributionμ\nh\nover(s,a)at","theh\nth\nstep.","We","denote\nμ=μ\n1\n×μ\n2\n×...×μ\nH\n.","For","eachh∈[H],","we","further","denote","the","marginal","distribution","ofs\n′\nin","tuple\n(s,a,s\n′\n,h)asν\nh\n,","and","letν=ν\n1\n×ν\n2\n×...×ν\nH\n.","Throughout","this","paper,","we","will","consistently","useμandν\nto","only","denote","the","probability","measures","defined","above.\nWe","assume","data","distributionμis","well-behaved","and","satisfies","the","following","assumption.\nAssumption","1(Concentrability).Given","a","policyπ,","letP\nπ\nh\ndenote","the","marginal","distribution","at","time","steph,\nstarting","froms\n1\nand","followingπ.","There","exists","a","parameterCsuch","that\nsup\n(s,a,h)∈S×A×[H]\ndP\nπ\nh\ndμ\nh\n(s,a)≤Cfor","any","policyπ.\nAssumption\n1requires","that","for","any","state-action","pair(s,a),","if","there","exists","a","policyπthat","reaches(s,a)\nwith","some","descent","amount","of","probability,","then","the","chance","that","sample(s,a)appears","in","the","dataset","would\nnot","be","low.","Intuitively,","Assumption\n1ensures","that","the","datasetDis","representative","for","all","the","“reachable”\nstate-action","pairs.","The","assumption","is","frequently","used","in","the","literature","of","batch","RL,","e.g.","equation","(7)","in\n5\n\nMunos[2003],","Definition","5.1","inMunos[2007],","Proposition","1","inFarahmand","et","al.[2010],","Assumption","1\nin\nChen","and","Jiang[2019],","etc.","We","remark","that","Assumption1here","is","the","only","assumption","of","this","paper\nregarding","the","properties","of","the","batch","data.\nWe","consider","the","setting","of","value","function","approximation,","where","at","each","stephwe","use","a","functionf\nh\nin","classF\nh\nto","approximate","the","optimalQ-value","function.","","For","notational","simplicity,","we","denotef:=\n(f\n1\n,···,f\nH\n)∈","FwithF:=F\n1\n×···×F\nH\n.","Since","no","reward","is","collected","in","the(H+","1)\nth\nsteps,","we\nwill","always","use","the","convention","thatf\nH+1\n=","0andF\nH+1\n={0}.","We","assumef\nh\n∈[−H,H]for","any\nf\nh\n∈F\nh\n.","Eachf∈Finduces","a","greedy","policyπ\nf\n={π\nf\nh\n}\nH\nh=1\nwhere\nπ\nf\nh\n(a|s)","=1\nh\na=","arg","max\na\n′\nf\nh\n(s,a\n′\n)\ni\n.\nIn","valued-based","batch","RL,","we","take","the","offline","datasetDas","input","and","output","an","estimated","optimalQ-value\nfunctionfand","the","associated","policyπ\nf\n.","We","are","interested","in","the","performance","ofπ\nf\n,","which","is","measured","by\nsuboptimality","in","values,","i.e.,V\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n).","However,","this","gap","is","highly","nonsmooth","inf,","which","is","similar\nto","the","case","of","supervised","learning","where","the0−1losses","for","classification","tasks","are","also","highly","nonsmooth\nand","intractable.","To","mitigate","this","issue,","a","popular","approachis","to","use","a","surrogate","loss—the","Bellman","error.\nDefinition","3.1(Bellman","error).Under","data","distributionμ,","we","define","theBellman","errorof","functionf=\n(f\n1\n,···,f\nH\n)as\nE(f)",":=\n1\nH\nH\nX\nh=1\nkf\nh\n−T\n⋆\nh\nf\nh+1\nk\n2\nμ\nh\n.(2)\nBellman","errorE(f)appears","in","many","classical","RL","algorithms","including","Bellman","risk","minimization\n(BRM)","[\nAntos","et","al.,2008],","least-square","temporal","difference","(LSTD)","learning","[Bradtke","and","Barto,1996,\nLazaric","et","al.,2012],","etc.\nThe","following","lemma","shows","that","under","Assumption\n1,","one","can","control","the","suboptimality","in","values","by\nthe","Bellman","error.\nLemma","3.2(Bellman","error","to","value","suboptimality).Under","Assumption1,","for","anyf∈F,","we","have","that",",\nV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n)≤2H\np\nC·E(f),(3)\nwhereCis","the","concentrability","coefficient","in","Assumption\n1.\nTherefore,","the","Bellman","errorE(f)is","indeed","a","surrogate","loss","for","the","suboptimality","ofπ\nf\nunder","mild\nconditions.","In","the","next","two","sections,","we","will","focus","on","designing","efficient","algorithms","that","minimize","the\nBellman","error.\n4","","Results","for","Double","Sampling","Regime\nAs","a","starting","point","for","Bellmen","error","minimization,","we","consider","an","empirical","version","ofE(f)computed\nfrom","samples.","A","natural","choice","of","this","empirical","proxy","is","as","follows\nˆ\nL\nB\n(f)",":=\n1\nnH\nX\n(s,a,r,s\n′\n,h)∈D\n\u0000\nf\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n,(4)\n6\n\nwhereV\nf\nh+1\n(s)",":=","max\na∈A\nf\nh+1\n(s,a).","Unfortunately,","the","estimator\nˆ\nL\nB\nis","biased","due","to","the","error-in","variable\nsituation","[\nBradtke","and","Barto,1996].","In","particular,","we","have","the","following","decomposition.\nE(f)","=E\nμ\nˆ\nL\nB\n(f)−\n1\nH\nH\nX\nh=1\nE\nμ\nh\nVar\ns\n′\n∼P\nh\n(·|s,a)\n(V\nf\nh+1\n(s\n′\n)).(5)\nThat","is,","the","Bellman","error","and","the","expectation","of\nˆ\nL\nB\ndiffer","by","a","variance","term.","This","variance","term","is","due\nto","the","stochastic","transitions","in","the","system,","which","is","non-negligible","even","whenfapproximates","the","optimal\nvalue","functionQ\n⋆\n.","A","direct","fix","of","this","problem","is","to","estimate","the","variance","by","double","samples,","where","two\nindependent","samples","ofs\nh+1\nare","drawn","when","being","in","states\nh\n[\nBaird,1995].\nFormally,","in","this","section,","we","consider","the","setting","where","forany(s,a,r,s\n′\n,h)in","datasetD,","there","exists\na","paired","tuple(s,a,r,","̃s\n′\n,h)which","share","the","same","state-action","pair(s,a)at","steph,","whiles\n′\n,","̃s\n′\nbeing","two\nindependent","samples","of","the","next","state.","Such","data","can","be","collected","for","instance","if","a","simulator","is","avaliable,\nor","the","system","allows","an","agent","to","revert","back","to","the","previous","step.","For","simplicity,","we","denote","this","dataset","as\ne\nD={(s,a,r,s\n′\n,","̃s\n′\n,h)}without","placing","additional","constraints.\nWe","construct","the","following","empirical","risk,","which","further","estimates","the","variance","term","in","(\n5)","via","double\nsamples,\nˆ\nL\nDS\n(f)",":=\n1\nnH\nX\n(s,a,r,s\n′\n,","̃s\n′\n,h)∈\n","̃\nD\n\u0014\n\u0000\nf\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n−\n1\n2\n\u0000\nV\nf\nh+1\n(s\n′\n)−V\nf\nh+1\n(","̃s\n′\n)\n\u0001\n2\n\u0015\n.\nWe","can","show","that,","for","any","fixedf∈F,E\nˆ\nL\nDS\n(f)","=E(f),","i.e.,\nˆ\nL\nDS\nis","an","unbiased","estimator","of","the","Bellman\nerror.","Our","algorithm","for","this","setting","is","simply","the","Empirical","Risk","Minimizer","(ERM),","and","we","prove","the\nfollowing","guarantee.\nTheorem","4.1.There","exists","an","absolute","constantc",">0,","with","probability","at","least1−δ,","the","ERM","estimator\nˆ\nf=","arg","min\nf∈F\nˆ\nL\nDS\n(f)satisfies","the","following:\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+cH\n2\nr\nlog(1/δ)\nn\n+c\nH\nX\nh=1\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+R\nν\nh\nn\n(V\nF\nh+1\n)\n\u0001\n.\nHere,","we","use","shorthandV\nF\nh+1\n:={V\nf\nh+1\n|f\nh+1\n∈","F\nh+1\n}for","anyh∈[H].","Theorem\n4.1asserts","that,\nin","the","double","sampling","regime,","simple","ERM","has","its","excess","riskE(\nˆ\nf)−min\nf∈F\nE(f)upper","bounded","by","the\nRademacher","complexity","of","function","class{F\nh\n}\nH\nh=1\n,{V\nF\nh+1\n}\nH\nh=1\nand","a","small","concentration","term","that","scales\nas\n","̃\nO(1/\n√\nn).\nMost","importantly,","we","remark","that","Theorem\n4.1holds","without","any","assumption","on","the","input","data","distribu-\ntion","or","the","properties","of","the","MDP.","Function","classFcan","also","be","completely","misspecificed","in","the","sense","the\noptimal","value","functionQ\n⋆\nmay","be","very","far","fromF.","This","allows","Theorem4.1to","be","widely","applicable","to","a\nlarge","number","of","applications.\nHowever,","a","major","limitation","of","Theorem\n4.1is","its","reliance","on","double","samples.","Double","samples","are","not\navailable","in","most","dynamical","systems","that","have","no","simulatorsor","can","not","be","reverted","back","to","the","previous","step.\nIn","next","section,","we","analyze","algorithms","in","the","standard","single","sampling","regime.\n5","","Results","for","Single","Sampling","Regime\nIn","this","section,","we","focus","on","batch","RL","in","the","standard","single","sampling","regime,","where","each","tuple(s,a,r,s\n′\n,h)\nin","datasetDhas","a","single","next","steps\n′\nfollowing(s,a).","We","first","present","a","sample","complexity","lower","bound","for\n7\n\nminimizing","the","Bellman","error,","showing","that","in","order","to","acheive","an","excess","risk","that","does","not","scale","polynomi-\nally","with","respect","to","the","number","of","states,","it","is","inevitable","tohave","additional","structural","assumptions","on","function\nclassFand","the","MDP.","Then","we","analyze","fitted","Q-iteration","(FQI)","and","a","minimax","estimator","respectively,","under\ndifferent","completeness","assumptions.","In","addition","to","Rademacher","complexity","upper","bounds","similar","to","The-\norem\n4.1,","we","also","utilize","localization","techniques","and","prove","bounds","with","faster","statistical","rate","in","these","two\nschemes.\n5.1","","Lower","bound\nRecall","that","when","double","samples","are","available,","the","excess","risk","of","ERM","estimator","is","controlled","by","Rademacher\ncomplexities","of","function","classes","(Theorem\n4.1).","In","the","single","sampling","regime,","one","natural","question","to","ask\nis","whether","there","exists","an","algorithm","with","a","similar","guarantee","(i.e.","the","excess","risk","is","upper","bounded","by","cer-\ntain","complexity","measure","of","the","function","class).","Unfortunately,","without","further","assumptions,","the","answer","is\nnegative.\nTheorem","5.1.LetAbe","an","arbitrary","algorithm","that","takes","any","datasetDand","function","classFas","input","and\noutputs","an","estimator\nˆ\nf∈","F.","For","anyS∈N\n+\nand","sample","sizen≥0,","there","exists","anS-state,","single-action\nMDP","paired","with","a","function","classFwith|F|=","2such","that","the\nˆ\nfoutput","by","algorithmAsatisfies\nEE(\nˆ\nf)≥min\nf∈F\nE(f)","+","Ω\n","\nmin\n(\n1,\nS\n1/2\nn\n)!\n.(6)\nHere,","the","expectation","is","taken","over","the","randomness","inD.\nTheorem\n5.1reveals","a","fundamental","difference","between","the","single","sampling","regime","and","the","double","sam-\npling","regime.","The","lower","bound","in","inequality","(\n6)","depends","polynomially","onS—the","cardinality","of","state","space,\nwhich","is","considered","to","be","intractably","large","in","the","setting","offunction","approximation.","In","batch","RL","with","single\nsampling,","despite","the","use","of","function","classF,","the","hardness","of","Bellman","error","minimization","is","still","determined\nby","the","size","of","state","space.","This","also","suggests","that","minimizing","Bellman","error","in","the","single","sampling","regime,\nis","intrinsically","different","from","the","classic","supervised","learning","due","to","the","additional","temporal","correlation","struc-\nture","presented","within","the","data.\nWe","remark","that","unlike","most","lower","bounds","of","similar","type","in","prior","works","[\nSutton","and","Barto,2018,Sun","et","al.,\n2019],","which","only","apply","to","certain","restrictive","classes","of","algorithms,","Theorem5.1is","completely","information-\ntheoretic,","and","applies","to","any","algorithm.\nTo","circumvent","the","hardness","result","in","Theorem5.1,","additional","structural","assumptions","are","necessary.","In\nthe","following,","we","provide","statistical","gurantees","for","two","batch","RL","algorithms,","where","different","completeness\nassumptions","onFare","used.\n5.2","","Fitted","Q-iteration","(FQI)\nWe","consider","the","classical","FQI","algorithm.","We","assume","that","function","classF=F\n1\n×...×F\nH\nis","(ap-\nproximately)","closed","under","the","optimal","Bellman","operatorsT\n⋆\n1\n,...,T\n⋆\nH\n,","which","is","commonly","adopted","by","prior\nanalyses","of","FQI","[\nMunos","and","Szepesv","́ari,2008,Chen","and","Jiang,2019].\nAssumption","2.There","existsǫ",">0such","that,","for","allh∈[H],sup\nf\nh+1\n∈F\nh+1\ninf\nf\nh\n∈F\nh\nkf\nh\n−T\n⋆\nh\nf\nh+1\nk\n2\nμ\nh\n≤ǫ.\nThe","FQI","algorithm","is","closely","related","to","approximate","dynamicprogramming","[\nBertsekas","and","Tsitsiklis,\n1995].","It","starts","by","setting\nˆ\nf\nH+1\n:=","0and","then","recursively","computes","Q-value","functions","ath=H,H−\n8\n\nAlgorithm","1FQI\n1:initialize\nˆ\nf\nH+1\n←0.\n2:forh=H,H−1,...,1do\n3:\nˆ\nf\nh\n←arg","min\nf\nh\n∈F\nh\nˆ\nℓ\nh\n(f\nh\n,\nˆ\nf\nh+1\n)",":=\n1\nn\nP\n(s,a,r,s\n′\n,h)∈D\nh\n\u0000\nf\nh\n(s,a)−r−V\nˆ\nf\nh+1\n(s\n′\n)\n\u0001\n2\n.\n4:return\nˆ\nf=","(\nˆ\nf\n1\n,...,\nˆ\nf\nH\n).\n1,...",",1.","Each","iteration","in","FQI","is","a","least","squares","regression","problembased","on","data","collected","at","that","time","step.\nForh∈[H],","we","denoteD\nh\nas","set","of","data","at","theh\nth\nstep.","The","details","of","FQI","are","specified","in","Algorithm\n1.\nIn","the","following","Theorem\n5.2,","we","upper","bound","the","excess","risk","of","the","output","of","FQI","in","terms","ofRademacher\ncomplexity.\nTheorem","5.2(FQI,","Rademacher","complexity).There","exists","an","absolute","constantc",">0,","under","Assumption\n2,","with","probability","at","least1−δ,","the","output","of","FQI\nˆ\nfsatisfies\nE(\nˆ\nf)≤ǫ+c\nH\nX\nh=1\nR\nμ\nh\nn\n(F\nh\n)","+cH\n2\nr\nlog(H/δ)\nn\n.(7)\nWe","remark","that","Assumption\n2immediately","implies","thatmin\nf∈F\nE(f)≤ǫ.","Therefore,","although","the\nminimal","Bellman","errormin\nf∈F\nE(f)does","not","explicitly","appear","on","the","right","hand","side,","inequality","(\n7)","is","still\na","variant","of","excess","risk","bound.\nFor","typical","parametric","function","classes,","the","Rademacher","complexity","scales","asn\n−1/2\n(see","Section\n6).\nTherefore,","Theorem\n5.2guarantees","that","the","excess","risk","decrease","asn\n−1/2\n,","up","to","a","constant","errorǫdue","to\nthe","approximate","completeness","(in","Assumption\n2).","However,","since","Bellman","error","is","the","average","of","squared\nL\n2\n-norms","(Definition\n3.1),","one","may","expect","a","faster","statistical","rate","in","this","setting,","similar","to","the","case","of","linear\nregression.","For","this","reason,","we","take","advantage","of","the","localization","techniques","and","develop","sharper","error\nbounds","in","Theorem5.3.\nTheorem","5.3(FQI,","local","Rademacher","complexity).There","exists","an","absolute","constantc",">0,","under","Assump-\ntion2,","with","probability","at","least1−δ,","the","output","of","FQI\nˆ\nfsatisfies\nE(\nˆ\nf)≤ǫ+c\n√\nǫ·∆","+c∆,where∆",":=H\nH\nX\nh=1\nr\n⋆\nh\n+H\n2\nlog(H/δ)\nn\n.(8)\nHerer\n⋆\nh\nis","the","critical","radius","of","local","Rademacher","complexityR\nμ\nh\nn\n({f\nh\n∈","F\nh\n|","kf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r})with\nf\n†\nh\n:=","arg","min\nf\nh\n∈F\nh\nkf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\nk\nμ\nh\n.\nOn","the","RHS","of","inequality","(\n8),","the","first","termǫmeasures","model","misspecification.","The","other","two","terms\nc(\n√\nǫ·∆+∆)can","be","viewed","as","statistical","errors","since∆→0as","sample","sizen→∞.","For","typical","parametric\nfunction","classes,","the","critical","radius","of","the","local","Rademacher","complexity","scales","asn\n−1\n(see","Section\n6),","which\ndecreases","much","faster","than","standard","Rademacher","complexity.","That","is,","Theorem\n5.3indeed","guarantees","faster\nstatistical","rate","comparing","to","Theorem\n5.2.\nFinally,","we","remark","thatf\n†\nh\nin","Theorem\n5.3depends","on\nˆ\nf\nh+1\nand","therefore","is","random.","We","will","show","later\nin","Section\n6for","many","examples,","the","critical","radius","can","be","upper","bounded","independent","of","the","choice","off\n†\nh\n,\nin","which","case","the","randomness","inf\n†\nh\ndoes","not","affect","the","final","results.\n9\n\n5.3","","Minimax","Algorithm\nThe","(approximate)","completeness","ofFin","Assumption2can","be","stringent","sometimes.","For","instance,","if","there","is\na","new","functionf\nh\nattached","toF\nh\n,","for","the","sake","of","completeness,","we","need","to","enlargeF\nh−1\nby","adding","several\napproximations","ofT\n⋆\nh−1\nf\nh\n.","The","same","goes","forF\nh−2\n,...,F\n1\n.","After","amplifying","the","function","classes","one","by\none","for","each","step,","we","may","obtain","an","exceedingly","largeF.\nTo","avoid","the","issue","above","posted","by","the","completeness","assumptions","onF,","we","introduce","a","new","function\nclassG=G\n1\n×···×G\nH\n,","whereG\nh\nconsists","of","functions","mapping","fromS×Ato[−H,H].","We","assume","that\nfor","eachf\nh+1\n∈","F\nh+1\n,","one","can","always","find","a","good","approximation","ofT\n⋆\nh\nf\nh+1\nin","this","helper","function","class\nG\nh\n.\nAssumption","3.There","existsǫ",">0such","that,","for","allh∈[H],sup\nf\nh+1\n∈F\nh+1\ninf\ng\nh\n∈G\nh\nkg\nh\n−T\n⋆\nh\nf\nh+1\nk\n2\nμ\nh\n≤ǫ.\nAccording","to","(\n5),","we","can","approximate","Bellman","errorE(f)by","subtracting","the","variance","term","from\nˆ\nL\nB\n(f).\nIfg\nh\nis","close","toT\n⋆\nh\nf\nh+1\n,","then\n\u0000\ng\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\naveraged","over","data","provides","a","good","estimator","of\nthe","variance","term.","Following","this","intuition,","we","define","a","new","loss\nˆ\nL\nMM\n(f,g)","",":=\n1\nnH\nX\n(s,a,r,s\n′\n,h)∈D\nh\n\u0000\nf\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n−\n\u0000\ng\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\ni\n.\nThe","minimax","algorithm","[Antos","et","al.,2008,Chen","and","Jiang,2019]","then","computes\nˆ\nf:=","arg","min\nf∈F\nmax\ng∈G\nˆ\nL\nMM\n(f,g).\nNow","we","are","ready","to","state","our","theoretical","guarantees","for","the","minimax","algorithms.\nTheorem","5.4(Minimax","algorithm,","Rademacher","complexity).There","exists","an","absolute","constantc",">0,\nunder","Assumption\n3,","with","probability","at","least1−δ,","the","minimax","estimator\nˆ\nfsatisfies:\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+ǫ+cH\n2\nr\nlog(1/δ)\nn\n+c\nH\nX\nh=1\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+R\nμ\nh\nn\n(G\nh\n)","+R\nν\nh\nn\n(V\nF\nh+1\n)\n\u0001\n.\nAs","is","shown","in","Theorem\n5.4,","the","excess","risk","is","simultaneously","controlled","by","the","Rademacher","complexi-\nties","of{F\nh\n}\nH\nh=1\n,{G\nh\n}\nH\nh=1\nand{V\nF\nh+1\n}\nH\nh=1\n.\nSimilar","to","the","results","for","FQI,","we","can","also","develop","risk","bounds","with","faster","statistical","rate","using","the\nlocalization","techniques.","For","technical","reasons","that","will","be","soon","discussed,","we","introduce","the","following","as-\nsumption,","which","can","be","viewed","a","variant","of","the","concentrability","coefficient","in","Assumption1under","different\ninitial","distributions.\nAssumption","4.For","any","policyπandh∈[H],","letP\nπ\nh,t\n(or\ne\nP\nπ\nh,t\n)","denote","the","marginal","distribution","att",">","h,\nstarting","fromμ\nh\nat","time","steph(or","fromν\nh\n×Unif(A)ath+","1)","and","followingπ.","There","exists","a","parameter\ne\nCsuch","that\nsup\n(s,a)∈S×A\nh∈[H],t>h\n\u0012\ndP\nπ\nh,t\ndμ\nt\n∨\nd\ne\nP\nπ\nh,t\ndμ\nt\n\u0013\n(s,a)≤\ne\nCfor","any","policyπ.\nFor","notational","convenience,","we","define\nf\n†\n=","(f\n†\n1\n,...,f\n†\nH\n)",":=","arg","min\nf∈F\nE(f)andg\n†\nh\n:=","arg","min\ng\nh\n∈G\nh\nkg\nh\n−T\n⋆\nh\nf\n†\nh+1\nk\nμ\nh\n.\nNow","we","are","ready","to","state","the","excess","risk","bound","of","the","minimax","algorithm","in","terms","of","local","Rademacher\ncomplexity","as","follows.\n10\n\nTheorem","5.5(Minimax","algorithm,","local","Rademacher","complexity).There","exists","an","absolute","constantc",">0,\nunder","Assumptions\n3and4,","with","probability","at","least1−δ,","the","minimax","estimator\nˆ\nfsatisfies:\nE(\nˆ\nf)≤min\nf∈F\nE(f)+ǫ+c\nr\n\u0000\nmin\nf∈F\nE(f)+ǫ\n\u0001\n∆","+c∆,(9)\n∆",":=H\n3\nH\nX\nh=1\n\u0014\ne\nC\n\u0000\nr\n⋆\nf,h\n+r\n⋆\ng,h\n+","","̃r\n⋆\nf,h\n\u0001\n+\nq\ne\nCr\n⋆\ng,h\nǫ\n\u0015\n+H\n2\nlog(H/δ)\nn\n.\nwhere\ne\nCis","the","concentrability","coefficient","in","Assumption\n4,","andr\n⋆\nf,h\n,r\n⋆\ng,h\n,","̃r\n⋆\nf,h\nare","the","critical","radius","of","the\nfollowing","local","Rademacher","complexities","respectively:\nR\nμ\nh\nn\n\u0000\b\nf\nh\n∈F\nh\n\f\n\f\nkf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n,\nR\nμ\nh\nn\n\u0000\b\ng\nh\n∈G\nh\n\f\n\f\nkg\nh\n−g\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n,\nR\nν\nh\nn\n\u0000\b\nV\nf\nh+1\n\f\n\f\nf\nh+1\n∈F\nh+1\n,kf\nh+1\n−f\n†\nh+1\nk\n2\nν\nh\n×Unif(A)\n≤r\n\t\u0001\n.\nSimilar","to","Theorem\n5.3,","our","upper","bound","in","(9)","can","also","be","viewed","as","a","combination","of","model","misspec-\nification","error","(min\nf∈F\nE(f)","+ǫ)","and","statistical","error","(c\nq\n\u0000\nmin\nf∈F\nE(f)","+ǫ\n\u0001\n∆","+c∆).","Asn→","∞,","the\nmodel","misspecification","error","is","nonvanishing","and","the","statistical","error","tends","to","zero.","Again","for","typical","para-\nmetric","function","classes,","the","critical","radius","of","the","local","Rademacher","complexity","scales","asn\n−1\n(see","Section\n6),\nand","Theorem\n5.5claims","the","excess","risk","of","the","minimax","algorithm","also","decreases","asn\n−1\nexcept","a","constant\nmodel","misspecification","errorǫ.\nIntuitively,","Assumption4is","required","in","Theorem5.5to","allow","thatE(f)close","toE(f\n†\n)impliesf\nh\nin","the\nneighborhood","off\n†\nh\nfor","each","steph∈[H].","We","conjecture","such","additional","assumption","is","unavoidable","if","we\nwould","like","to","upper","bound","the","excess","risk","using","the","local","Rademacher","complexity","ofF\nh\n,G\nh\nandV\nF\nh+1\nfor\nthe","minimax","algorithm.\nIn","Appendix\nC,","we","present","an","alternative","version","of","Theorem5.3,","which","does","not","require","Assumption4\nbut","bound","the","excess","risk","using","the","local","Rademacher","complexity","of","a","composite","function","class","depending\non","the","loss,F,","andG.","The","alternative","version","recovers","the","sharp","result","in\nChen","and","Jiang[2019]","when","the\nfunction","classesFandGboth","have","finite","elements.\nFinally,","our","upper","bounds","for","the","minimax","algorithm","containRadermacher","complexities","of","the","function\nclassV\nF\n.","We","can","conveniently","control","them","using","the","Radermacher","complexities","of","function","classFas\nfollows.\nProposition","5.6.LetFbe","a","set","of","functions","overS×Aandρbe","a","measure","overS.","We","have","the","following\ninequality,\nR\nρ\nn\n(V\nF\n)≤\n√\n2AR\nρ×Unif(A)\nn\n(F),\nwhereAis","the","cardinality","of","the","setA.\n6","","Examples\nBelow","we","give","four","examples","of","function","classes,","each","with","anupper","bound","on","Rademacher","complexity,\nas","well","as","the","critical","radius","of","the","local","Rademacher","complexity.","Throughout","this","section","we","use","notation\nr\n⋆,ρ\nn\n(F,f\no\n)to","denote","the","critical","radius","of","local","Rademacher","complexityR\nρ\nn\n({f∈F","|kf−f\no\nk\n2\nρ\n≤r}).\n11\n\nFunction","class","with","finite","element.First,","we","consider","the","function","classFwith|F|<∞.","Under","the\nnormalization","thatf∈[0,H]for","anyf∈F,","we","have","the","following.\nProposition","6.1.For","function","classFdefined","above,","for","any","data","distributionρand","any","anchor","function\nf\no\n∈F:\nR\nρ\nn\n(F)≤2Hmax\n\u001a\nr\nlog|F|\nn\n,\nlog|F|\nn\n\u001b\n,","","","r\n⋆,ρ\nn\n(F,f\no\n)≤\n2Hlog|F|\nn\n.\nLinear","functions.Letφ:S","×","A","→R\nd\nbe","the","feature","map","to","ad-dimensional","Euclidean","space,","and\nconsider","the","function","classF","⊂","{w\n⊤\nφ|w∈R\nd\n,kwk","≤H}.","Under","the","normalization","thatkφ(s,a)k","≤1\nfor","any(s,a),","we","have\nProposition","6.2.For","linear","function","classFdefined","above,","for","any","data","distributionρand","any","anchor\nfunctionf\no\n∈F:\nR\nρ\nn\n(F)≤H\nr\n2d\nn\n,","","","r\n⋆,ρ\nn\n(F,f\no\n)≤\n2d\nn\n.\nFunctions","in","RKHS.Consider","a","Reproducing","Kernel","Hilbert","Space","(RKHS)Hassociated","with","a","positive\nkernelk:","(S×A)×(S×A)→R.","Suppose","thatk\n\u0000\n(s,a),(s,a)\n\u0001\n≤1for","any(s,a)∈S×A.","Consider","the\nfunction","classF","⊆","{f∈","H|kfk\nK\n≤H},","herek·k\nK\ndenotes","the","RKHS","norm.","Define","an","integral","operator\nT:L\n2\n(ρ)→L\n2\n(ρ)as\nTf:=E\n(s,a)∼ρ\n\u0002\nk\n\u0000\n·,(s,a)\n\u0001\nf(s,a)\n\u0003\n.\nSuppose","thatE\n(s,a)∼ρ\n\u0002\nk\n\u0000\n(s,a),(s,a)\n\u0001\u0003\n<+∞.","Let\n\b\nλ\ni\n(T)\n\t\n∞\ni=1\nbe","the","eigenvalues","ofT,","arranging","in","a\nnonincreasing","order.","Then\nProposition","6.3.For","kernel","function","classFdefined","above,","for","any","data","distributionρand","any","anchor\nfunctionf\no\n∈F:\nR\nρ\nn\n(F)≤H\nv\nu\nu\nt\n2\nn\n∞\nX\ni=1\n1∧\n\u0000\n4λ\ni\n(T)\n\u0001\n,","","","r\n⋆,ρ\nn\n(F,f\no\n)≤2","min\nj∈N\n\n\n\nj\nn\n+H\nv\nu\nu\nt\n2\nn\n∞\nX\ni=j+1\nλ\ni\n(T)\n\n\n\n.\nSparse","linear","functions.Letφ:S×A→R\nd\nbe","the","feature","map","to","ad-dimensional","Euclidean","space,","and\nconsider","the","function","classF","⊂{w\n⊤\nφ|w∈R\nd\n,kwk\n0\n≤s}.","Assume","that","when(s,a)∼ρ,φ(s,a)satisfies\na","Gaussian","distribution","with","covarianceΣ.","Assumekfk\nρ\n≤Hfor","anyf∈","F.","Furthermore,","denoteκ\ns\n(Σ)\nto","be","the","upper","bound","such","thatκ\ns\n(Σ)≥λ\nmax\n(M)/λ\nmin\n(M)for","any","matrixMthat","is","as×sprincipal\nsubmatrix","ofΣ.","Then\nProposition","6.4.There","exists","an","absolute","constantc",">0,","for","sparse","linear","function","classFdefined","above,\nassume","the","data","distributionρsatisfies","the","conditions","specified","above,","then","for","any","anchorfunctionf\no\n∈F:\nR\nρ\nn\n(F)≤cH\np\nκ\ns\n(Σ)\nr\nslogd\nn\n,","","","r\n⋆,ρ\nn\n(F,f\no\n)≤c\n2\nκ\ns\n(Σ)·\nslogd\nn\n.\n12\n\nEnd-to-end","results.Finally,","to","obtain","an","end-to-end","result","that","upper","bounds","the","suboptimality","in","val-\nues","for","specific","function","classes","listed","above,","we","can","simplycombine","(a)","the","result","that","upper","bound","the\nvalue","suboptimality","using","the","Bellman","error","(Lemma3.2);","(b)","the","results","that","upper","bound","the","Bellman\nerror","in","terms","of","(local)","Rademacher","complexity","(Theorems\n4.1,5.2-5.5);","(c)","the","upper","bounds","of","(local)\nRademacher","complexity","for","specific","function","classes","(Propositions\n6.1-6.4).\n7","","Conclusion\nThis","paper","studies","batch","RL","with","general","value","function","approximation","from","the","lens","of","statistical","learning\ntheory.","We","identify","the","intrinsic","difference","between","batchreinforcement","learning","and","classical","supervised\nlearning","(Theorem\n5.1)","due","to","the","additional","temporal","correlation","structure","presented","in","the","RL","data.","Under\nmild","conditions,","this","paper","also","provides","upper","bounds","on","the","generalization","performance","of","several","popular\nbatch","RL","algorithms","in","terms","of","the","(local)","Rademacher","complexities","of","general","function","classes.","We","hope\nour","results","shed","light","on","the","future","research","in","further","bridging","the","gap","between","statistical","learning","theory\nand","RL.\nReferences\nA.","Antos,","C.","Szepesv","́ari,","and","R.","Munos.","Learning","near-optimal","policies","with","bellman-residual","minimization\nbased","fitted","policy","iteration","and","a","single","sample","path.Machine","Learning,","71(1):89–129,","2008.\nL.","Baird.","Residual","algorithms:","Reinforcement","learning","with","function","approximation.","InMachine","Learning\nProceedings","1995,","pages","30–37.","Elsevier,","1995.\nP.","Baldi,","S.","Brunak,","and","F.","Bach.Bioinformatics:","the","machine","learning","approach.","MIT","press,","2001.\nP.","L.","Bartlett","and","S.","Mendelson.","Rademacher","and","gaussian","complexities:","Risk","bounds","and","structural","results.\nJournal","of","Machine","Learning","Research,","3(Nov):463–482,","2002.\nP.","L.","Bartlett,","O.","Bousquet,","S.","Mendelson,","et","al.","Local","rademacher","complexities.The","Annals","of","Statistics,\n33(4):1497–1537,","2005.\nP.","L.","Bartlett,","M.","I.","Jordan,","and","J.","D.","McAuliffe.","Convexity,classification,","and","risk","bounds.Journal","of","the\nAmerican","Statistical","Association,","101(473):138–156,","2006.\nD.","P.","Bertsekas","and","J.","N.","Tsitsiklis.","Neuro-dynamic","programming:","an","overview.","InProceedings","of","1995\n34th","IEEE","conference","on","decision","and","control,","volume","1,","pages","560–564.","IEEE,","1995.\nS.","J.","Bradtke","and","A.","G.","Barto.","Linear","least-squares","algorithms","for","temporal","difference","learning.Machine\nlearning,","22(1):33–57,","1996.\nJ.","Chen","and","N.","Jiang.","Information-theoretic","considerations","in","batch","reinforcement","learning.arXiv","preprint\narXiv:1905.00360,","2019.\nC.","Cortes","and","V.","Vapnik.","Support-vector","networks.Machine","learning,","20(3):273–297,","1995.\nC.","Dann,","G.","Neumann,","J.","Peters,","et","al.","Policy","evaluation","withtemporal","differences:","A","survey","and","compari-\nson.Journal","of","Machine","Learning","Research,","15:809–883,","2014.\n13\n\nR.","M.","Dudley.","Metric","entropy","of","some","classes","of","sets","with","differentiable","boundaries.Journal","of","Approxima-\ntion","Theory,","10(3):227–236,","1974.\nJ.","Fan,","Z.","Wang,","Y.","Xie,","and","Z.","Yang.","A","theoretical","analysis","ofdeep","q-learning.","InLearning","for","Dynamics\nand","Control,","pages","486–489.","PMLR,","2020.\nA.","M.","Farahmand,","M.","Ghavamzadeh,","C.","Szepesv","́ari,","and","S.","Mannor.","Regularized","policy","iteration.","Innips,\npages","441–448,","2008.\nA.","M.","Farahmand,","R.","Munos,","and","C.","Szepesv","́ari.","","Error","propagation","for","approximate","policy","and","value\niteration.","InAdvances","in","Neural","Information","Processing","Systems,","2010.\nA.-m.","Farahmand,","M.","Ghavamzadeh,","C.","Szepesv","́ari,","and","S.","Mannor.","","Regularized","policy","iteration","with\nnonparametric","function","spaces.The","Journal","of","Machine","Learning","Research,","17(1):4809–4874,","2016.\nD.","A.","Forsyth","and","J.","Ponce.Computer","vision:","a","modern","approach.","Pearson,,","2012.\nY.","Freund,","R.","E.","Schapire,","et","al.","Experiments","with","a","new","boosting","algorithm.","Inicml,","volume","96,","pages\n148–156.","Citeseer,","1996.\nT.","Hastie,","R.","Tibshirani,","and","J.","Friedman.The","elements","of","statistical","learning:","data","mining,","inference,","and\nprediction.","Springer","Science","&","Business","Media,","2009.\nG.","James,","D.","Witten,","T.","Hastie,","and","R.","Tibshirani.An","introduction","to","statistical","learning,","volume","112.\nSpringer,","2013.\nF.","Jelinek.Statistical","methods","for","speech","recognition.","MIT","press,","1997.\nN.","Jiang,","A.","Krishnamurthy,","A.","Agarwal,","J.","Langford,","and","R.","E.","Schapire.","Contextual","decision","processes\nwith","low","bellman","rank","are","pac-learnable.","InProceedings","of","the","34th","International","Conference","on","Machine\nLearning-Volume","70,","pages","1704–1713.","JMLR.","org,","2017.\nB.","H.","Juang","and","L.","R.","Rabiner.","","Hidden","markov","models","for","speechrecognition.Technometrics,","33(3):\n251–272,","1991.\nN.","Kallus","and","M.","Uehara.","","Double","reinforcement","learning","for","efficient","off-policy","evaluation","in","markov\ndecision","processes.Journal","of","Machine","Learning","Research,","21(167):1–63,","2020.\nS.","Lange,","T.","Gabel,","and","M.","Riedmiller.","Batch","reinforcement","learning.","InReinforcement","learning,","pages\n45–73.","Springer,","2012.\nA.","Lazaric,","M.","Ghavamzadeh,","and","R.","Munos.","Finite-sample","analysis","of","least-squares","policy","iteration.Jour-\nnal","of","Machine","Learning","Research,","13:3041–3074,","2012.\nH.","Le,","C.","Voloshin,","and","Y.","Yue.","Batch","policy","learning","under","constraints.","InInternational","Conference","on\nMachine","Learning,","pages","3703–3712.","PMLR,","2019.\nM.","Ledoux","and","M.","Talagrand.Probability","in","Banach","Spaces:","isoperimetry","and","processes.","Springer","Science\n&","Business","Media,","2013.\nS.","Levine,","A.","Kumar,","G.","Tucker,","and","J.","Fu.","Offline","reinforcement","learning:","Tutorial,","review,","and","perspectives\non","open","problems.arXiv","preprint","arXiv:2005.01643,","2020.\n14\n\nA.","Maurer.","A","vector-contraction","inequality","for","rademachercomplexities.","InInternational","Conference","on\nAlgorithmic","Learning","Theory,","pages","3–17.","Springer,","2016.\nS.","Mendelson.","Geometric","parameters","of","kernel","machines.","InInternational","Conference","on","Computational\nLearning","Theory,","pages","29–43.","Springer,","2002.\nV.","Mnih,","K.","Kavukcuoglu,","D.","Silver,","A.","A.","Rusu,","J.","Veness,","M.","G.","Bellemare,","A.","Graves,","M.","Riedmiller,\nA.","K.","Fidjeland,","G.","Ostrovski,","et","al.","Human-level","control","through","deep","reinforcement","learning.nature,\n518(7540):529–533,","2015.\nR.","Munos.","Error","bounds","for","approximate","policy","iteration.","InICML,","volume","3,","pages","560–567,","2003.\nR.","Munos.","Performance","bounds","in","lp-norm","for","approximate","value","iteration.SIAM","journal","on","control","and\noptimization,","46(2):541–561,","2007.\nR.","Munos","and","C.","Szepesv","́ari.","Finite-time","bounds","for","fitted","value","iteration.Journal","of","Machine","Learning\nResearch,","9(May):815–857,","2008.\nD.","Precup.","Eligibility","traces","for","off-policy","policy","evaluation.Computer","Science","Department","Faculty","Publi-\ncation","Series,","page","80,","2000.\nD.","Precup,","R.","S.","Sutton,","and","S.","Dasgupta.","Off-policy","temporal-difference","learning","with","function","approxima-\ntion.","InICML,","pages","417–424,","2001.\nM.","L.","Puterman.Markov","decision","processes:","discrete","stochastic","dynamic","programming.","John","Wiley","&\nSons,","2014.\nM.","Riedmiller.","Neural","fitted","q","iteration–first","experiences","with","a","data","efficient","neural","reinforcement","learning\nmethod.","InEuropean","Conference","on","Machine","Learning,","pages","317–328.","Springer,","2005.\nR.","E.","Schapire.","A","brief","introduction","to","boosting.","InIjcai,","volume","99,","pages","1401–1406.","Citeseer,","1999.\nW.","Sun,","N.","Jiang,","A.","Krishnamurthy,","A.","Agarwal,","and","J.","Langford.","Model-based","rl","in","contextual","decision\nprocesses:","Pac","bounds","and","exponential","improvements","over","model-free","approaches.","InConference","on\nLearning","Theory,","pages","2898–2933.","PMLR,","2019.\nR.","S.","Sutton","and","A.","G.","Barto.Reinforcement","learning:","An","introduction.","MIT","press,","2018.\nJ.","A.","Suykens","and","J.","Vandewalle.","Least","squares","support","vector","machine","classifiers.Neural","processing","letters,\n9(3):293–300,","1999.\nR.","Szeliski.Computer","vision:","algorithms","and","applications.","Springer","Science","&","Business","Media,","2010.\nM.","Uehara,","J.","Huang,","and","N.","Jiang.","Minimax","weight","and","q-function","learning","for","off-policy","evaluation.","In\nInternational","Conference","on","Machine","Learning,","pages","9659–9668.","PMLR,","2020.\nM.","Uehara,","M.","Imaizumi,","N.","Jiang,","N.","Kallus,","W.","Sun,","and","T.","Xie.","","Finite","sample","analysis","of","mini-\nmax","offline","reinforcement","learning:","Completeness,","fast","rates","and","first-order","efficiency.arXiv","preprint\narXiv:2102.02981,","2021.\nR.","van","Handel.","Probability","in","high","dimension.","Technical","report,","PRINCETON","UNIV","NJ,","2014.\n15\n\nV.","Vapnik.The","nature","of","statistical","learning","theory.","Springer","science","&","business","media,","2013.\nV.","N.","Vapnik","and","A.","Y.","Chervonenkis.","On","the","uniform","convergence","of","relative","frequencies","of","events","to","their\nprobabilities.","InMeasures","of","complexity,","pages","11–30.","Springer,","2015.\nR.","Vershynin.","","","Introduction","to","the","non-asymptotic","analysisof","random","matrices.arXiv","preprint\narXiv:1011.3027,","2010.\nM.","J.","Wainwright.High-dimensional","statistics:","A","non-asymptotic","viewpoint,","volume","48.","Cambridge","Uni-\nversity","Press,","2019.\nR.","Wang,","D.","P.","Foster,","and","S.","M.","Kakade.","What","are","the","statistical","limits","of","offline","rl","with","linear","function\napproximation?arXiv","preprint","arXiv:2010.11895,","2020a.\nR.","Wang,","R.","R.","Salakhutdinov,","and","L.","Yang.","Reinforcement","learning","with","general","value","function","approx-\nimation:","Provably","efficient","approach","via","bounded","eluder","dimension.Advances","in","Neural","Information\nProcessing","Systems,","33,","2020b.\nT.","Xie","and","N.","Jiang.","","","Batch","value-function","approximation","with","only","realizability.arXiv","preprint\narXiv:2008.04990,","2020a.\nT.","Xie","and","N.","Jiang.","Q*","approximation","schemes","for","batch","reinforcement","learning:","A","theoretical","comparison.\narXiv","preprint","arXiv:2003.03924,","2020b.\nT.","Xie,","Y.","Ma,","and","Y.-X.","Wang.","Towards","optimal","off-policy","evaluation","for","reinforcement","learning","with\nmarginalized","importance","sampling.arXiv","preprint","arXiv:1906.03393,","2019.\nM.","Yin,","Y.","Bai,","and","Y.-X.","Wang.","Near","optimal","provable","uniformconvergence","in","off-policy","evaluation","for\nreinforcement","learning.arXiv","preprint","arXiv:2007.03760,","2020.\nA","","Proof","of","Results","for","Double","Sampling","(Theorem\n4.1)\nThroughout","the","supplementary","materials,","we","omit","the","subscriptρin","population","Rademacher","complexty\nR\nρ\nn\n(·)if","the","distribution","is","clear","from","the","context.\nIn","this","part,","we","prove","Theorem\n4.1in","Section4.","We","first","define","some","auxiliary","notations","to","simplify","the\nwriting.","We","divide","the","dataset\ne\nDinto\ne\nD=\ne\nD\n1\n∪...∪\ne\nD\nH\n,","where\ne\nD\nh\nconsists","ofnindependent","sample\ntuples","collected","at","theh\nth\ntime","step.","Forf\nh\n,g\nh\n∈F\nh\n,","denote\nℓ\nDS\n(g\nh\n,f\nh\n)(s,a,r,s\n′\n,","̃s\n′\n)",":=\n\u0000\ng\nh\n(s,a)−r−V\nf\nh\n(s\n′\n)\n\u0001\n2\n−\n1\n2\n\u0000\nV\nf\nh\n(s\n′\n)−V\nf\nh\n(","̃s\n′\n)\n\u0001\n2\n.\nDefine","an","expected","valueE\nμ\nh\nℓ\nDS\n(g\nh\n,f\nh\n)",":=E\n\u0002\nℓ\nDS\n(g\nh\n,f\nh\n)(s,a,r,s\n′\n,","̃s\n′\n)\n\u0003\nwith(s,a)∼μ\nh\n,r=r\nh\n(s,a),\ns\n′\n,","̃s\n′\ni.i.d.\n∼P\nh\n(·|s\nh\n,a\nh\n)and","its","empirical","version\nˆ\nℓ\nDS\n(g\nh\n,f\nh\n)",":=\n1\nn\nP\n(s,a,r,s\n′\n,","̃s\n′\n,h)∈\n","̃\nD\nh\nℓ\nDS\n(g\nh\n,f\nh\n)(s,a,r,s\n′\n,","̃s\n′\n).\nIt","is","easy","to","see","thatE\nμ\nh\nℓ\nDS\n(g\nh\n,f\nh\n)","=kg\nh\n−T\n⋆\nh\nf\nh\nk\n2\nμ\nh\n.","For","anyf=","(f\n1\n,...,f\nH\n)∈F,","we","have\nL\nDS\n(f)",":=\n1\nH\nH\nX\nh=1\nℓ\nDS\n(f\nh\n,f\nh+1\n),E\nμ\nL\nDS\n(f)","=E(f)and\nˆ\nL\nDS\n(f)",":=\n1\nH\nH\nX\nh=1\nˆ\nℓ\nDS\n(f\nh\n,f\nh+1\n),\n16\n\nwheref\nH+1\n:=","0.","Note","that","the","loss","function\nˆ\nL\nDS\n(f)is","an","empirical","estimation","ofE(f).\nTheorem\n4.1provides","an","upper","error","bound","for","the","BRM","estimator\nˆ\nf=","arg","min\nf∈F\nˆ\nL\nDS\n(f),","of","which\nthe","proof","is","given","below.\nTheorem","4.1.There","exists","an","absolute","constantc",">0,","with","probability","at","least1−δ,","the","ERM","estimator\nˆ\nf=","arg","min\nf∈F\nˆ\nL\nDS\n(f)satisfies","the","following:\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+cH\n2\nr\nlog(1/δ)\nn\n+c\nH\nX\nh=1\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+R\nν\nh\nn\n(V\nF\nh+1\n)\n\u0001\n.\nProof","of","Theorem\n4.1.We","apply","the","uniform","concentration","inequalites","in","LemmaG.1.","Letf\n†\nbe","a","min-\nimizer","of","the","Bellman","error","within","the","function","classF,i.e.f\n†\n∈arg","min\nf∈F\nE(f).","","By","noting","that\nL\nDS\n(f)∈\n\u0002\n−2H\n2\n,4H\n2\n\u0003\n,","we","have","with","probabliity","at","least1−δ,\nE\nμ\nL\nDS\n(\nˆ\nf)−E\nμ\nL\nDS\n(f\n†\n)≤\n\u0000\nˆ\nL\nDS\n(\nˆ\nf)−\nˆ\nL\nDS\n(f\n†\n)\n\u0001\n+","2R\nn\n\u0000\b\nL\nDS\n(f)\n\f\n\f\nf∈F\n\t\u0001\n+","6H\n2\nr\n2","log(2/δ)\nn\n.(10)\nWe","use","the","relationsE\nμ\nL\nDS\n(\nˆ\nf)","=E(\nˆ\nf),E\nμ\nL\nDS\n(f\n†\n)","=E(f\n†\n)","=","min\nf∈F\nE(f)and\nˆ\nL\nDS\n(\nˆ\nf)≤\nˆ\nL\nDS\n(f\n†\n)and\nreduce","eq.","(\n10)","to\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+","2R\nn\n\u0000\b\nL\nDS\n\f\n\f\nf∈F\n\t\u0001\n+","6H\n2\nr\n2","log(2/δ)\nn\n.(11)\nIt","then","remains","to","simplify","the","form","of","Rademacher","complexityR\nn\n\u0000\b\nL\nDS\n(f)\n\f\n\f\nf∈F\n\t\u0001\n.\nDue","to","the","sub-additivity","of","Rademacher","complexity,","we","have\nR\nn\n\u0000\b\nL\nDS\n(f)\n\f\n\f\nf∈F\n\t\u0001\n≤\n1\nH\nH\nX\nh=1\nR\nn\n\u0000\n{ℓ\nDS\n(f\nh\n,f\nh+1\n)|f\nh\n∈F\nh\n,f\nh+1\n∈F\nh+1\n}\n\u0001\n.(12)\nIn","order","to","tackle","the","termR\nn\n\u0000\n{ℓ\nDS\n(f\nh\n,f\nh+1\n)|f\nh\n∈","F\nh\n,f\nh+1\n∈","F\nh+1\n}\n\u0001\non","the","right","hand","side,","we","apply\nthe","vector-form","contraction","property","of","Rademacher","complexity","in","Lemma\nG.7.","By","letting\n","̃\nφ\nh,1\n:=f\nh\n(s,a),\n","̃\nφ\nh,2\n:=r\nh\n+V\nf\nh+1\n(s\n′\n)and\n","̃\nφ\nh,3\n:=r\nh\n+V\nf\nh+1\n(","̃s\n′\n),\nwe","can","write\nℓ\nDS\n(f\nh\n,f\nh+1\n)","=\n1\n2\n\u0000\n","̃\nφ\nh,1\n,\n","̃\nφ\nh,2\n,\n","̃\nφ\nh,3\n\u0001\n⊤\n","̃\nA\n\n\n","̃\nφ\nh,1\n","̃\nφ\nh,2\n","̃\nφ\nh,3\n\n\nwith\n","̃\nA=\n\n\n2−2","","","0\n−2","","","1","","","1\n0","","","1−1\n\n\n.\nSince","the","spectral","normk\n","̃\nAk\n2\n≤4and\n\r\n\r\n\u0000\n","̃\nφ\nh,1\n,\n","̃\nφ\nh,2\n,\n","̃\nφ\nh,3\n\u0001\n⊤\n\r\n\r\n2\n≤\n√\n3Hdue","to","the","boundedness","off\nh\nandT\n⋆\nh\nf\nh+1\n,","we","find","thatℓ\nDS\n(f\nh\n,f\nh+1\n)is","(4\n√\n3H)-Lipschitz","with","respect","to","the","vector\n\u0000\n","̃\nφ\nh,1\n,\n","̃\nφ\nh,2\n,\n","̃\nφ\nh,3\n\u0001\n⊤\n.\nLemma\nG.7then","implies\nR\nn\n\u0000\b\nℓ\nDS\n(f\nh\n,f\nh+1\n)\n\f\n\f\nf\nh\n∈F\nh\n,f\nh+1\n∈F\nh+1\n\t\u0001\n≤10H\n\u0010\nR\nn\n\u0000\b\n","̃\nφ\nh,1\n\t\u0001\n+R\nn\n\b\n","̃\nφ\nh,2\n\t\u0001\n+R\nn\n\b\n","̃\nφ\nh,3\n\t\u0001\n\u0011\n.\n(13)\n17\n\nRecalling","thats\n′\nand","̃s\n′\narei.i.d.conditioned","on(s,a),","we","use","the","sub-additivity","of","Rademacher","complexity\nand","find","that\nR\nn\n\u0000\b\n","̃\nφ\nh,1\n\t\u0001\n≤R\nμ\nh\nn\n(F\nh\n)\nR\nn\n\u0000\b\n","̃\nφ\nh,2\n\t\u0001\n=R\nn\n\u0000\b\n","̃\nφ\nh,3\n\t\u0001\n≤R\nn\n({r\nh\n})+R\nν\nh\nn\n(V\nF\nh+1\n),\n(14)\nwhereν\nh\nis","the","marginal","distribution","ofs\n′\nin","theh\nth\nstep.","Note","that{r\nh\n}is","a","singleton,","therefore,R\nn\n({r\nh\n})","=\n0.","It","follows","from","eqs.","(\n13)","and","(14)","that\nR\nn\n\u0000\b\nℓ\nDS\n(f\nh\n,f\nh+1\n)\n\f\n\f\nf\nh\n∈F\nh\n,f\nh+1\n∈F\nh+1\n\t\u0001\n≤10H\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+","2R\nν\nh\nn\n(V\nf\nh+1\n)\n\u0001\n.(15)\nCombining","eqs.","(\n12)","and","(15),","we","learn","that\nR\nn\n\u0000\b\nL\nDS\n(f)\n\f\n\f\nf∈F\n\t\u0001\n≤10\nH\nX\nh=1\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+","2R\nν\nh\nn\n(V\nF\nh+1\n)\n\u0001\n.(16)\nPlugging","eq.","(\n16)","into","eq.","(11),","we","finish","the","proof.\nB","","Proof","of","Results","for","FQI","(Theorems5.2and5.3)\nIn","this","section,","we","analyze","the","FQI","estimator","defined","in","Algorithm\n1.","For","anyf\nh\n∈","F\nh\nandf\nh+1\n∈","F\nh+1\n,\nwe","denote\nℓ(f\nh\n,f\nh+1\n)(s,a,r,s\n′\n)",":=\n\u0000\nf\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n,(17)\ntherefore,\nˆ\nℓ\nh\n(f\nh\n,f\nh+1\n)",":=\n1\nn\nP\n(s,a,r,s\n′\n,h)∈D\nh\nℓ(f\nh\n,f\nh+1\n)(s,a,r,s\n′\n).","Note","that","each","iteration","in","FQI","solves\nan","empirical","loss","minimization","problem\nˆ\nf\nh\n:=","arg","min\nf\nh\n∈F\nh\nˆ\nℓ\nh\n(f\nh\n,\nˆ\nf\nh+1\n).","The","empirical","loss\nˆ\nℓ\nh\n(f\nh\n,\nˆ\nf\nh+1\n)\napproximates\nE\nμ\nh\nℓ(f\nh\n,\nˆ\nf\nh+1\n)","=E\n\u0002\nℓ(f\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\n(s,a)∼μ\nh\n,s\n′\n∼P\nh\n(·|s,a)\n\u0003\n=kf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\nk\n2\nμ\nh\n+E\nμ\nh\nVar\ns\n′\n∼P\nh\n(·|s,a)\n(V\nˆ\nf\nh+1\n(s\n′\n)).\nRecall","that\nf\n†\nh\n=","arg","min\nf\nh\n∈F\nh\nkf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\nk\nμ\nh\n.(18)\nf\n†\nh\nminimizesE\nμ\nh\nℓ(f\nh\n,\nˆ\nf\nh+1\n).\nIn","the","sequel,","we","develop","upper","bounds","for","Bellman","errorE(\nˆ\nf)based","on","(local)","Rademathcer","complex-\nities.\nB.1","","Analyzing","FQI","with","Rademacher","Complexity","(Theorem\n5.2)\nTheorem","5.2(FQI,","Rademacher","complexity).There","exists","an","absolute","constantc",">0,","under","Assumption\n2,","with","probability","at","least1−δ,","the","output","of","FQI\nˆ\nfsatisfies\nE(\nˆ\nf)≤ǫ+c\nH\nX\nh=1\nR\nμ\nh\nn\n(F\nh\n)","+cH\n2\nr\nlog(H/δ)\nn\n.(7)\n18\n\nProof","of","Theorem5.2.By","LemmaG.1,","with","probability","at","least1−δ,","for","anyf\nh\n∈F\nh\n,\nE\nμ\nh\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−E\nμ\nh\nℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)≤\n\u0000\nˆ\nℓ\nh\n(f\nh\n,\nˆ\nf\nh+1\n)−\nˆ\nℓ\nh\n(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\u0001\n+","2R\nn\n\u0000\b\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\nf\nh\n∈F\nh\n\t\u0001\n+","4H\n2\nr\n2","log(2/δ)\nn\n,\n(19)\nwheref\n†\nh\nis","defined","in","eq.","(\n18)","and","we","have","usedℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)∈[−2H\n2\n,2H\n2\n].\nSpecifically,","we","takef\nh\n=\nˆ\nf\nh\nin","eq.","(\n19).","","Due","to","the","optimality","of\nˆ\nf\nh\n,","we","have\nˆ\nℓ\nh\n(\nˆ\nf\nh\n,\nˆ\nf\nh+1\n)≤\nˆ\nℓ\nh\n(f\n†\nh\n,\nˆ\nf\nh+1\n).","We","further","use","the","relation\nk\nˆ\nf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\nk\n2\nμ\nh\n=\n\u0000\nE\nμ\nh\nℓ(\nˆ\nf\nh\n,\nˆ\nf\nh+1\n)−E\nμ\nh\nℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\u0001\n+kf\n†\nh\n−T\n⋆\nh\nˆ\nf\nh+1\nk\n2\nμ\nh\n.(20)\nand","Assumption\n2.","It","follows","that\n\r\n\r\nˆ\nf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n≤2R\nn\n\u0000\b\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\nf\nh\n∈F\nh\n\t\u0001\n+","4H\n2\nr\n2","log(2/δ)\nn\n+ǫ.(21)\nWe","now","simplify","the","Rademacher","complexity","term","in","eq.","(\n21).","Due","to","the","symmmetry","of","Rademacher\nrandom","variables,","we","haveR\nn\n\u0000\b\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\nf\nh\n∈","F\nh\n\t\u0001\n=R\nn\n\u0000\b\nℓ(f\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\nf\nh\n∈","F\nh\n\t\u0001\n.\nWe","also","note","that","the","loss","functionℓis","(4H)-Lipschitz","in","its","first","argument.","In","fact,","since|f\nh\n|","≤Hfor","all\nf\nh\n∈F\nh\nandr+V\nˆ\nf\nh+1\n(s\n′\n)∈[−H,H],","it","holds","that","for","anyf\nh\n,f\n′\nh\n∈F\nh\n,\n\f\n\f\nℓ(f\nh\n,\nˆ\nf\nh+1\n)(s,a,r,s\n′\n)−ℓ(f\n′\nh\n,\nˆ\nf\nh+1\n)(s,a,r,s\n′\n)\n\f\n\f\n=|f\nh\n(s,a)−f\n′\nh\n(s,a)|\n\f\n\f\nf\nh\n(s,a)","+f\n′\nh\n(s,a)−2r−2V\nˆ\nf\nh+1\n(s\n′\n)\n\f\n\f\n≤4H|f\nh\n(s,a)−f\n′\nh\n(s,a)|.\n(22)\nAccording","to","the","contraction","property","of","Rademacher","complexity","(see","Lemma\nG.6),","we","have\nR\nn\n\u0000\b\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\nf\nh\n∈F\nh\n\t\u0001\n=R\nn\n\u0000\b\nℓ(f\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\nf\nh\n∈F\nh\n\t\u0001\n≤2HR\nμ\nh\nn\n(F\nh\n).(23)\nPlugging","eq.","(\n23)","into","eq.","(21)","and","applying","union","bound,","we","find","that","with","probability","at","least1−δ,\nE(\nˆ\nf)","=\n1\nH\nH\nX\nh=1\n\r\n\r\nˆ\nf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n≤8\nH\nX\nh=1\nR\nμ\nh\nn\n(F\nh\n)","+","4H\n2\nr\n2","log(2H/δ)\nn\n+ǫ,\nwhich","completes","the","proof.\nB.2","","Analyzing","FQI","with","Local","Rademacher","Complexity","(Theorem5.3)\nTheorem","5.3(FQI,","local","Rademacher","complexity).There","exists","an","absolute","constantc",">0,","under","Assump-\ntion\n2,","with","probability","at","least1−δ,","the","output","of","FQI\nˆ\nfsatisfies\nE(\nˆ\nf)≤ǫ+c\n√\nǫ·∆","+c∆,where∆",":=H\nH\nX\nh=1\nr\n⋆\nh\n+H\n2\nlog(H/δ)\nn\n.(8)\nHerer\n⋆\nh\nis","the","critical","radius","of","local","Rademacher","complexityR\nμ\nh\nn\n({f\nh\n∈","F\nh\n|","kf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r})with\nf\n†\nh\n:=","arg","min\nf\nh\n∈F\nh\nkf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\nk\nμ\nh\n.\n19\n\nProof","of","Theorem5.3.Recall","that","we","have","shown","in","eq.","(22)","thatℓ(f,g)is","(4H)-Lipchitz","in","its","first","argu-\nmentf.","Under","Assumption\n2,","forf\n†\nh\nshown","in","eq.","(18),","we","have\nVar\n\u0002\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\u0003\n≤E\n\u0002\u0000\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\u0001\n2\n\u0003\n≤16H\n2\nE\nh\n\f\n\f\nf\nh\n(s\nh\n,a\nh\n)−f\n†\nh\n(s\nh\n,a\nh\n)\n\f\n\f\n2\ni\n=16H\n2\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nμ\nh\n≤32H\n2\n\u0010\n\r\n\r\nf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n+\n\r\n\r\nf\n†\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n\u0011\n=32H\n2\nh\u0010\n\r\n\r\nf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n−\n\r\n\r\nf\n†\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n\u0011\n+","2\n\r\n\r\nf\n†\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\ni\n≤32H\n2\n\u0010\nE\nμ\nh\n\u0002\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\u0003\n+","2ǫ\n\u0011\n.\nWhen","applying","Theorem\nG.3,","we","are","supposed","to","take","a","sub-root","function","larger","than\nψ\nFQI\n(r)",":=","32H\n2\nR\nn\nn\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\n\f\nf\nh\n∈F\nh\n,32H\n2\n\u0010\nE\n\u0002\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\u0003\n+2ǫ\n\u0011\n≤r\no\n.\nNote","that\nψ\nFQI\n(r)≤32H\n2\nR\nn\n\u0010n\nℓ(f\nh\n,\nˆ\nf\nh+1\n)−ℓ(f\n†\nh\n,\nˆ\nf\nh+1\n)\n\f\n\f\n\f\nf\nh\n∈F\nh\n,16H\n2\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nμ\nh\n≤r\no\u0011\n≤128H\n3\nR\nn\n\u0010n\nf\nh\n−f\n†\nh\n\f\n\f\n\f\nf\nh\n∈F\nh\n,16H\n2\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nμ\nh\n≤r\no\u0011\n=128H\n3\nR\nn\n\u0010n\nf\nh\n∈F\nh\n\f\n\f\n\f\n16H\n2\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nμ\nh\n≤r\no\u0011\n≤128H\n3\nψ\nh\n\u0010\nr\n16H\n2\n\u0011\nwhereψ\nh\nis","a","sub-root","function","satisfyingψ\nh\n(r)≥","R\nn\n\u0000\b\nf\nh\n∈","F\nh\n\f\n\f\nkf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\nand","the","positive\nfixed","pointr\n⋆\nh\nofψ\nh\nis","the","corresponding","critical","radius.","In","the","second","inequality,","we","have","used","the","contrac-\ntion","property","of","Rademacher","complexity","(see","Lemma\nG.6)","and","the","Lipschitz","continuity","ofℓ.","The","equality","in\nthe","last","line","is","due","to","the","symmetry","of","Rademacher","random","variables.","According","to","Lemma\nG.5,","the","positive\nfixed","point","of128H\n3\nψ\nh\n\u0000\nr\n16H\n2\n\u0001\nis","upper","bounded","by1024H\n4\nr\n⋆\nh\n.\nWe","apply","eq.","(\n90)","in","TheoremG.3and","use","the","eq.","(20)","and\nˆ\nℓ\nh\n(\nˆ\nf\nh\n,\nˆ\nf\nh+1\n)≤\nˆ\nℓ\nh\n(f\n†\nh\n,\nˆ\nf\nh+1\n).","It","follows","that\nfor","a","fixed","parameterθ,","with","probability","at","least1−δ,\n\r\n\r\nˆ\nf\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n−\n\r\n\r\nf\n†\nh\n−T\n⋆\nh\nˆ\nf\nh+1\n\r\n\r\n2\nμ\nh\n≤cH\n2\nr\n⋆\nh\n+\ncH\n2\nlog(1/δ)\nn\n+c(θ−1)\n\u0012\nH\n2\nr\n⋆\nh\n+c\nH\n2\nlog(1/δ)\nn\n\u0013\n+\n2ǫ\nθ−1\n,\nwherec",">0is","a","universal","constant.","By","union","bound","and","Assumption\n2,","we","have\nE(\nˆ\nf)≤ǫ+cH\nH\nX\nh=1\nr\n⋆\nh\n+cH\n2\nlog(H/δ)\nn\n+c(θ−1)\n\u0012\nH\nH\nX\nh=1\nr\n⋆\nh\n+\nH\n2\nlog(1/δ)\nn\n\u0013\n+\n2ǫ\nθ−1\n.\nWe","further","takeθ:=","1","+\n√\nǫ\n2H\n\u0000\n1\nH\nP\nH\nh=1\nr\n⋆\nh\n+\nlog(H/δ)\nn\n\u0001\n−\n1\n2\nand","find","that\nE(\nˆ\nf)≤ǫ+cH\nH\nX\nh=1\nr\n⋆\nh\n+cH\n2\nlog(H/δ)\nn\n+c\nv\nu\nu\nt\nǫ\n\u0010\nH\nH\nX\nh=1\nr\n⋆\nh\n+H\n2\nlog(1/δ)\nn\n\u0011\n,\nwhich","completes","the","proof.\n20\n\nC","","Proof","of","Results","for","Minimax","Algorithm","(Theorems5.4,5.5andC.1)\nIn","this","part,","we","prove","the","statistical","guarantees","for","minimax","algorithm","in","Section\n5.3.\nNotationsWe","first","introduce","some","notations","that","will","be","used","later","in","the","analyses.","For","any","vector-valued\nfunctionf=","(f\n1\n,...,f\nH\n)∈L\n2\n(μ\n1\n)×...×L\n2\n(μ\nH\n),","we","denotekfk\nμ\n:=\nq\n1\nH\nP\nH\nh=1\nkf\nh\nk\n2\nμ\nh\nfor","short.\nParallel","to","the","optimal","Bellman","operatorT\n⋆\nh\n,","we","defineT\n†\nh\nand\nb\nT\nh\nas\nT\n†\nh\nf\nh+1\n:=","arg","min\ng\nh\n∈G\nh\nkg\nh\n−T\n⋆\nh\nf\nh+1\nk\nμ\nh\nand\nb\nT\nh\nf\nh+1\n:=","arg","min\ng\nh\n∈G\nh\n1\nn\nX\n(s,a,r,s\n′\n,h)∈D\nh\n\u0000\ng\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n.\nLetT\n⋆\n,T\n†\n,\nb\nTbe","their","vector","form,","given","by\nT\n⋆\nf:=(T\n⋆\n1\nf\n2\n,...,T\n⋆\nH\nf\nH+1\n),\nT\n†\nf:=(T\n†\n1\nf\n2\n,...,T\n†\nH\nf\nH+1\n),\nb\nTf:=(\nb\nT\n1\nf\n2\n,...,\nb\nT\nH\nf\nH+1\n),\n(24)\nfor","anyf∈F.\nSimilar","to","the","definition","ofℓin","eq.","(\n17),","for","anyg\nh\n∈G\nh\n∪F\nh\nandf\nh+1\n∈F\nh+1\n,","we","take\nℓ(g\nh\n,f\nh+1\n)(s,a,r,s\n′\n)","=\n\u0000\ng\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n.\nFor","anyf∈F,g∈F","∪Gand{(s\nh\n,a\nh\n,r\nh\n,s\n′\nh\n)}\nH\nh=1\n∈(S","×A×R×S)\nH\n,","let\nℓ(g,f)(·)",":=\n1\nH\nH\nX\nh=1\nℓ(g\nh\n,f\nh+1\n)(s\nh\n,a\nh\n,r\nh\n,s\n′\nh\n)","=\n1\nH\nH\nX\nh=1\n\u0000\ng\nh\n(s\nh\n,a\nh\n)−r\nh\n−V\nf\nh+1\n(s\n′\nh\n)\n\u0001\n2\n.\nDenote\nE\nμ\nℓ(g,f)",":=\n1\nH\nH\nX\nh=1\nE\nμ\nh\nℓ(g\nh\n,f\nh+1\n)","=\n1\nH\nH\nX\nh=1\nE\n\u0002\nℓ(g\nh\n,f\nh+1\n)(s,a,r,s\n′\n)\n\f\n\f\n(s,a)∼μ\nh\n,s\n′\n∼P\nh\n(·|s,a)\n\u0003\n=kg−T\n⋆\nfk\n2\nμ\n+\n1\nH\nH\nX\nh=1\nE\nμ\nh\nVar\ns\n′\n∼P\nh\n(·|s,a)\n(V\nf\nh+1\n(s\n′\n))\nand\nˆ\nℓ(g,f)",":=\n1\nH\nH\nX\nh=1\nˆ\nℓ\nh\n(g\nh\n,f\nh+1\n)","=\n1\nnH\nX\n(s,a,r,s\n′\n,h)∈D\n\u0000\ng\nh\n(s,a)−r−V\nf\nh+1\n(s\n′\n)\n\u0001\n2\n.\nThe","loss","function","in","minimax","algorithm","then","can","be","written","as\nL\nMM\n(f,g)",":=ℓ(f,f)−ℓ(g,f),\nE\nμ\nL\nMM\n(f,g)",":=E\nμ\nℓ(f,f)−E\nμ\nℓ(g,f)\nˆ\nL\nMM\n(f,g)",":=\nˆ\nℓ(f,f)−\nˆ\nℓ(g,f).\n(25)\nNote","thatE\nμ\nL\nMM\n(f,g)","=kf−T\n⋆\nfk\n2\nμ\n−kg−T\n⋆\nfk\n2\nμ\n=E(f)−kg−T\n⋆\nfk\n2\nμ\n.\n21\n\nWith","our","newly-defined","notations,","we","formulate","the","minimax","estimator","as\nˆ\nf=","arg","min\nf∈F\nmax\ng∈G\nˆ\nL\nMM\n(f,g)","=","arg","min\nf∈F\nˆ\nL\nMM\n(f,\nb\nTf).(26)\nIn","the","analysis","of","minimax","algorithm,","we","takef\n†\nas","the","function","inFthat","minimizes","the","Bellmen","risk,\ni.e.\nf\n†\n:=","arg","min\nf∈F\nE(f).\nMain","results\nTheorem","5.4(Minimax","algorithm,","Rademacher","complexity).There","exists","an","absolute","constantc",">0,\nunder","Assumption\n3,","with","probability","at","least1−δ,","the","minimax","estimator\nˆ\nfsatisfies:\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+ǫ+cH\n2\nr\nlog(1/δ)\nn\n+c\nH\nX\nh=1\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+R\nμ\nh\nn\n(G\nh\n)","+R\nν\nh\nn\n(V\nF\nh+1\n)\n\u0001\n.\nTheorem","5.5(Minimax","algorithm,","local","Rademacher","complexity).There","exists","an","absolute","constantc",">0,\nunder","Assumptions\n3and4,","with","probability","at","least1−δ,","the","minimax","estimator\nˆ\nfsatisfies:\nE(\nˆ\nf)≤min\nf∈F\nE(f)+ǫ+c\nr\n\u0000\nmin\nf∈F\nE(f)+ǫ\n\u0001\n∆","+c∆,(9)\n∆",":=H\n3\nH\nX\nh=1\n\u0014\ne\nC\n\u0000\nr\n⋆\nf,h\n+r\n⋆\ng,h\n+","","̃r\n⋆\nf,h\n\u0001\n+\nq\ne\nCr\n⋆\ng,h\nǫ\n\u0015\n+H\n2\nlog(H/δ)\nn\n.\nwhere\ne\nCis","the","concentrability","coefficient","in","Assumption\n4,","andr\n⋆\nf,h\n,r\n⋆\ng,h\n,","̃r\n⋆\nf,h\nare","the","critical","radius","of","the\nfollowing","local","Rademacher","complexities","respectively:\nR\nμ\nh\nn\n\u0000\b\nf\nh\n∈F\nh\n\f\n\f\nkf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n,\nR\nμ\nh\nn\n\u0000\b\ng\nh\n∈G\nh\n\f\n\f\nkg\nh\n−g\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n,\nR\nν\nh\nn\n\u0000\b\nV\nf\nh+1\n\f\n\f\nf\nh+1\n∈F\nh+1\n,kf\nh+1\n−f\n†\nh+1\nk\n2\nν\nh\n×Unif(A)\n≤r\n\t\u0001\n.\nAside","from","Theorems\n5.4and5.5,","we","also","have","an","alternative","statistical","guarantee","forE(\nˆ\nf)using","local\nRademacher","complexity","for","composite","functionL\nMM\n(f,T\n†\nf).","See","Theorem\nC.1below.\nTheorem","C.1(Minimax","algorithm,","local","Rademacher","complexity,","alternaltive).There","exists","an","absolute\nconstantc",">0,","under","Assumption\n3,","with","probability","at","least1−δ,","the","minimax","estimator\nˆ\nfsatisfies:\nE(\nˆ\nf)≤min\nf∈F\nE(f)+ǫ+c\nr\n\u0000\nmin\nf∈F\nE(f)+ǫ\n\u0001\n∆","+c∆,(27)\n∆",":=H\n2\nr\n⋆\nL\n+H\nH\nX\nh=1\nr\n⋆\ng,h\n+H\n2\nlog(H/δ)\nn\n.\nwherer\n⋆\nL\nandr\n⋆\ng,h\nare","the","critical","radius","of","the","following","local","Rademacher","complexities","respectively:\nR\nμ\nh\nn\n\u0000\b\nL\nMM\n(f,T\n†\nf)\n\f\n\f\nf∈F,E\n\u0002\nL\nMM\n(f,T\n†\nf)\n2\n\u0003\n≤r\n\t\u0001\n,\nR\nμ\nh\nn\n\u0000\b\ng\nh\n∈G\nh\n\f\n\f\nkg\nh\n−g\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n.\n22\n\nIn","contrast","to","Theorem5.5,","TheoremC.1does","not","rely","on","the","additional","Assumption4.","In","general,","Theo-\nrem\nC.1provides","a","tighter","upper","bound","forE(\nˆ\nf)than","Theorem5.5when","the","function","class\n\b\nL\nMM\n(f,T\n†\nf)\n\f\n\f\nf∈\nF\n\t\nhas","a","clear","structure","andr\n⋆\nL\nis","easy","to","estimate.","For","instance,","this","is","the","case","if","bothfandGhave","finite","el-\nements.","Based","on","TheoremC.1,","we","can","recover","the","sharp","results","for","finite","function","classesinChen","and","Jiang\n[2019].\nAssumption\n3used","in","our","analysis","of","minimax","algorithm","can","be","relaxed","to:\n“There","exist","constantsǫ",">0andζ∈[0,1)such","thatinf\ng∈G\nkg−T\n⋆\nfk\n2\nμ\n≤ǫ+ζE(f)for","anyf∈F.”\nIn","this","way,","we","only","need","a","high-quality","approximation","ofT\n⋆\nfinGwhenflies","within","a","neighborhood\nof","the","optimal","Q-function.","We","can","easily","generalize","our","analyses","to","this","case.","However,","in","order","to","avoid\nunnecessary","clutter,","we","stick","to","the","current","Assumption3.\nProof","outlineOur","analyses","in","this","section","are","devoted","to","the","proofs","of","Theorems\n5.4,5.5andC.1.\n1.","We","first","translate","the","estimation","ofE(\nˆ\nf)into","deriving","uniform","concentration","bounds","for\nˆ\nL\nMM\n(f,T\n†\nf)−\nˆ\nL\nMM\n(f\n†\n,T\n†\nf\n†\n)and\nˆ\nℓ(g,f)−\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)(Lemma\nC.2in","AppendixC.1).","The","error","decomposition\nlemma","is","shared","among","the","proofs","of","Theorems\n5.4,5.5andC.1.\n2.","We","then","develop","the","desired","uniform","concentration","boundsusing","Rademacher","complexities","(Ap-\npendixC.2)","and","local","Rademacher","complexities","(AppendixC.3)","separately.","In","particular,","when","tack-\nling\nˆ\nL\nMM\n(f,T\n†\nf)−\nˆ\nL\nMM\n(f\n†\n,T\n†\nf\n†\n),","we","have","two","alternative","analyses","involving","local","Rademacher\ncomplexities","of","different","types","of","function","classes.","One","leads","to","Theorem5.5and","the","other","results","in\nTheorem\nC.1.\n3.","In","Appendix\nC.4,","we","integrate","the","error","decomposition","result","and","uniform","concentration","bounds,","and\nfinish","the","proofs","of","theorems.\nC.1","","Error","Decomposition\nWe","provide","a","decomposition","of","the","Bellman","errorE(\nˆ\nf)and","upper","bound","the","error","using","some","uniform\nconcentration","inequalities.\nLemma","C.2(Error","decomposition).Suppose","there","existα",">0andErr\nf\n,Err\ng\n>0such","that","the","following\nconcentration","inequailities","hold","simultaneously.\n1.","For","anyf∈F,\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤α\n\u0000\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0001\n+Err\nf\n.(28)\n2.","For","anyg∈G,\nE\nμ\nℓ\n\u0000\ng,f\n†\n\u0001\n−E\nμ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n≤α\n\u0000\nˆ\nℓ\n\u0000\ng,f\n†\n\u0001\n−\nˆ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\u0001\n+Err\ng\n.(29)\nThen","under","Assumption\n3,","the","Bellman","error","satisfies\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+Err\nf\n+Err\ng\n+ǫ.(30)\n23\n\nProof.By","definition","of","functionE\nμ\nL\nMM\n(f,g)in","eq.","(25),","we","find","that","for","anyf∈F,\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n=E\nμ\nℓ(f,f)−E\nμ\nℓ(T\n†\nf,f)","=kf−T\n⋆\nfk\n2\nμ\n−kT\n†\nf−T\n⋆\nfk\n2\nμ\n=E(f)−kT\n†\nf−T\n⋆\nfk\n2\nμ\n.\nWe","learn","from","Assumption\n3thatkT\n†\nf−T\n⋆\nfk\n2\nμ\n≤ǫfor","anyf∈F,","therefore,\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n=E(f)−E(f\n†\n)−kT\n†\nf−T\n⋆\nfk\n2\nμ\n+kT\n†\nf\n†\n−T\n⋆\nf\n†\nk\n2\nμ\n≥E(f)−E(f\n†\n)−ǫ,\n(31)\nwhich","implies\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+\n\u0010\nE\nμ\nL\nMM\n\u0000\nˆ\nf,T\n†\nˆ\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n\u0011\n+ǫ.\nBy","virtue","of","eq.","(\n28),\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+α\n\u0010\nˆ\nL\nMM\n\u0000\nˆ\nf,T\n†\nˆ\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n\u0011\n+Err\nf\n+ǫ.(32)\nIn","the","following,","we","leverage","eq.","(\n29)","to","estimate\nˆ\nL\nMM\n\u0000\nˆ\nf,T\n†\nˆ\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n.\nWe","use","the","definition","ofL\nMM\nand","find","that\nˆ\nL\nMM\n\u0000\nˆ\nf,T\n†\nˆ\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n=\nˆ\nℓ(\nˆ\nf,\nˆ\nf)−\nˆ\nℓ(T\n†\nˆ\nf,\nˆ\nf)−\nˆ\nℓ(f\n†\n,f\n†\n)","+\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)\n=\n\u0000\nˆ\nL\nMM\n\u0000\nˆ\nf,\nb\nT\nˆ\nf\n\u0001\n+\nˆ\nℓ(\nb\nT\nˆ\nf,\nˆ\nf)\n\u0001\n−\nˆ\nℓ(T\n†\nˆ\nf,\nˆ\nf)−\n\u0000\nˆ\nL\nMM\n\u0000\nf\n†\n,\nb\nTf\n†\n\u0001\n+\nˆ\nℓ(\nb\nTf\n†\n,f\n†\n)\n\u0001\n+\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)\n=\n\u0000\nˆ\nL\nMM\n\u0000\nˆ\nf,\nb\nT\nˆ\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,\nb\nTf\n†\n\u0001\u0001\n+\n\u0000\nˆ\nℓ(\nb\nT\nˆ\nf,\nˆ\nf)−\nˆ\nℓ(T\n†\nˆ\nf,\nˆ\nf)\n\u0001\n−\n\u0000\nˆ\nℓ(\nb\nTf\n†\n,f\n†\n)−\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)\n\u0001\n.\n(33)\nSince(f,g)",":=","(\nˆ\nf,\nb\nT\nˆ\nf)solves","the","minimax","optimizaiton","problem","eq.","(\n26),","we","have\nˆ\nL\nMM\n\u0000\nˆ\nf,\nb\nT\nˆ\nf\n\u0001\n≤\nˆ\nL\nMM\n\u0000\nf\n†\n,\nb\nTf\n†\n\u0001\n.","Due","to","the","optimality","of\nb\nT,","it","also","holds","that\nˆ\nℓ(\nb\nT\nˆ\nf,\nˆ\nf)≤\nˆ\nℓ(T\n†\nˆ\nf,\nˆ\nf).","To","this","end,","eq.","(\n33)\nreduces","to\nˆ\nL\nMM\n\u0000\nˆ\nf,T\n†\nˆ\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤−\n\u0000\nˆ\nℓ(\nb\nTf\n†\n,f\n†\n)−\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)\n\u0001\n.(34)\nAdditionally,","eq.","(\n29)","implies\nˆ\nℓ(\nb\nTf\n†\n,f\n†\n)−\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)≥α\n−1\n\u0010\nE\nμ\nℓ\n\u0000\nb\nTf\n†\n,f\n†\n\u0001\n−E\nμ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n\u0011\n−α\n−1\nErr\ng\n.\nNote","thatE\nμ\nℓ\n\u0000\nb\nTf\n†\n,f\n†\n\u0001\n−E\nμ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n=k\nb\nTf\n†\n−T\n⋆\nf\n†\nk\n2\nμ\n−kT\n†\nf\n†\n−T\n⋆\nf\n†\nk\n2\nμ\nandk\nb\nTf\n†\n−T\n⋆\nf\n†\nk\nμ\n≥\nkT\n†\nf\n†\n−T\n⋆\nf\n†\nk\nμ\nby","definition","ofT\n†\n,","therefore,\nˆ\nℓ(\nb\nTf\n†\n,f\n†\n)−\nˆ\nℓ(T\n†\nf\n†\n,f\n†\n)≥−α\n−1\nErr\ng\n.\nIt","then","follows","from","eq.","(\n34)","that\nˆ\nL\nMM\n\u0000\nˆ\nf,T\n†\nˆ\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤α\n−1\nErr\ng\n.(35)\nCombining","eq.","(\n32)","and","eq.","(35),","we","obtain","eq.","(30).\n24\n\nC.2","","Analyzing","Minimax","Algorithm","with","Rademacher","Complexity\nIn","what","follows,","we","develop","uniform","concentration","inequalities","eqs.","(28)","and","(29)","using","Rademacher","com-\nplexities.\nLemma","C.3.With","probability","at","least1−δ,\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤\n\u0000\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0001\n+Err\nf\nfor","anyf∈F,\nwhere\nErr\nf\n:=c\nH\nX\nh=1\n\u0000\nR\nμ\nh\nn\n(F\nh\n)","+R\nμ\nh\nn\n(G\nh\n)","+R\nν\nh\nn\n(V\nF\nh+1\n)\n\u0001\n+","4H\n2\nr\n2","log(2/δ)\nn\nfor","some","universal","constantc",">0.\nProof.Note","that\n\f\n\f\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n\f\n\f\n≤8H\n2\n.","We","apply","Lemma\nG.1and","find","that\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤\n\u0000\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0001\n+","2R\nn\n\u0000\b\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n\f\n\f\nf∈F\n\t\u0001\n+","16H\n2\nr\n2","log(2/δ)\nn\n.\nDue","to","the","symmetry","of","Rademacher","random","variables,","we","have\nR\nn\n\u0000\b\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n\f\n\f\nf∈F\n\t\u0001\n=R\nn\n\u0000\b\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\nf∈F\n\t\u0001\n.\nWe","now","use","Lemma\nG.7to","simplify","the","termR\nn\n\u0000\b\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\nf∈F\n\t\u0001\n.\nNote","that\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n=\n1\nH\nH\nX\nh=1\nφ\nh\n(f)\n⊤\nAφ\nh\n(f),whereA:=\n\u0012\n1−1\n−1","","","0\n\u0013\n,\nφ\nh\n(f)",":=\n\u0000\nf\nh\n(s\nh\n,a\nh\n)−T\n†\nh\nf\nh+1\n(s\nh\n,a\nh\n),r\nh\n+V\nf\nh+1\n(s\n′\nh\n)−T\n†\nh\nf\nh+1\n(s\nh\n,a\nh\n)\n\u0001\n⊤\n.\nSincekφ\nh\n(f)k\n2\n≤\n√\n2HandkAk\n2\n=\n√\n5+1\n2\n,","we","learn","thatφ\nh\n(f)\n⊤\nAφ\nh\n(f)is\n\u0000\n√\n5+1\n√\n2\nH\n\u0001\n-Lipschitz","with\nrespect","toφ\nh\n(f).","According","to","Lemma\nG.7,\nR\nn\n\u0000\b\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\nf∈F\n\t\u0001\n=\n1\nH\nH\nX\nh=1\nR\nn\n\u0000\b\nφ\nh\n(f)\n⊤\nAφ\nh\n(f)\n\f\n\f\nf∈F\n\t\u0001\n≤(\n√\n5","+","1)\nH\nX\nh=1\n\u0010\nR\nn\n\u0000\b\nφ\nh,1\n(f)\n\f\n\f\nf∈F\n\t\u0001\n+R\nn\n\u0000\b\nφ\nh,2\n(f)\n\f\n\f\nf∈F\n\t\u0001\n\u0011\n.\nHere,\nR\nn\n\u0000\b\nφ\nh,1\n(f)\n\f\n\f\nf∈F\n\t\u0001\n=R\nn\n\u0000\b\nf\nh\n−T\n†\nh\nf\nh+1\n\f\n\f\nf\nh\n∈F\nh\n,f\nh+1\n∈F\nh+1\n\t\u0001\n≤R\nn\n\u0000\b\nf\nh\n−g\nh\n\f\n\f\nf\nh\n∈F\nh\n,g\nh\n∈G\nh\n\t\u0001\n≤R\nμ\nh\nn\n(F\nh\n)","+R\nμ\nh\nn\n(G\nh\n),\nR\nn\n\u0000\b\nφ\nh,2\n(f)\n\f\n\f\nf∈F\n\t\u0001\n=R\nn\n\u0000\b\nr\nh\n+V\nf\nh+1\n−T\n†\nh\nf\nh+1\n\f\n\f\nf\nh+1\n∈F\nh+1\n\t\u0001\n≤R\nν\nh\nn\n(V\nF\nh+1\n)","+R\nn\n\u0000\b\nT\n†\nh\nf\nh+1\n\f\n\f\nf\nh+1\n∈F\nh+1\n\t\u0001\n≤R\nν\nh\nn\n(V\nF\nh+1\n)","+R\nμ\nh\nn\n(G\nh\n).\nIntegrating","the","pieces,","we","finish","the","proof","of","Lemma\nC.3.\n25\n\nLemma","C.4.With","probability","at","least1−δ,","for","anyg∈G,\nE\nμ\nℓ\n\u0000\ng,f\n†\n\u0001\n−E\nμ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n≤\n\u0000\nˆ\nℓ\n\u0000\ng,f\n†\n\u0001\n−\nˆ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\u0001\n+Err\ng\n,\nwhere\nErr\ng\n:=","8\nH\nX\nh=1\nR\nμ\nh\nn\n(G\nh\n)","+","4H\n2\nr\n2","log(2/δ)\nn\n.\nProof.Note","that\n\f\n\f\nℓ(g,f\n†\n)−ℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n\f\n\f\n≤2H\n2\n.","By","Lemma\nG.1,","with","probability","at","least1−δ,","for","any\ng∈G,\nE\nμ\nℓ\n\u0000\ng,f\n†\n\u0001\n−E\nμ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n≤\n\u0000\nˆ\nℓ\n\u0000\ng,f\n†\n\u0001\n−\nˆ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\u0001\n+","2R\nn\n\u0000\b\nℓ(g,f\n†\n)−ℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n\f\n\f\ng∈G\n\t\u0001\n+","4H\n2\nr\n2","log(2/δ)\nn\n.\n(36)\nWe","observe","that\nR\nn\n\u0000\b\nℓ(g,f\n†\n)−ℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n\f\n\f\ng∈G\n\t\u0001\n=R\nn\n\u0000\b\nℓ(g,f\n†\n)\n\f\n\f\ng∈G\n\t\u0001\n≤\n1\nH\nH\nX\nh=1\nR\nn\n\u0000\b\nℓ(g\nh\n,f\n†\nh+1\n)\n\f\n\f\ng\nh\n∈G\nh\n\t\u0001\n.\n(37)\nSimilar","to","eq.","(\n22),","we","can","show","thatℓ(g\nh\n,f\n†\nh+1\n)is","(4H)-Lipschitz","with","respect","tog\nh\n,","therefore,\nR\nn\n\u0000\b\nℓ(g\nh\n,f\n†\nh+1\n)\n\f\n\f\ng\nh\n∈G\nh\n\t\u0001\n≤4HR\nμ\nh\nn\n(G\nh\n).(38)\nCombining","eq.","(\n36)","-","eq.","(38),","we","complete","the","proof.\nC.3","","Analyzing","Minimax","Algorithm","with","Local","Rademacher","Complexity\nIn","this","part,","LemmasC.5andC.6are","devoted","to","the","uniform","concentration","of\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\nand","Lemma\nC.7is","concerned","with\nˆ\nℓ\n\u0000\ng,f\n†\n\u0001\n−\nˆ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n.","The","proof","of","TheoremC.1uses","LemmasC.5\nandC.7,","while","Theorem5.5uses","LemmasC.6andC.7.\nConcentration","inequality","eq.","(\n28),\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\nLemma\nC.5below","will","be","used","as\na","buiding","block","of","the","proof","of","Theorem\nC.1.\nLemma","C.5.There","exists","a","universal","constantc",">0such","that","under","Assumption\n3,","for","any","fixed","parameter\nθ",">1,","with","probability","at","least1−δ,","we","have\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤\nθ\nθ−1\n\u0000\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0001\n+Err\nf\n(39)\nfor","anyf∈F,","with\nErr\nf\n:=cθH\n2\nr\n⋆\nL\n+cθH\n2\nlog(1/δ)\nn\n+\nc\nθ−1\n\u0000\nE(f\n†\n)","+ǫ\n\u0001\n.\n26\n\nProof.We","consider","using","TheoremG.3to","analyze","the","concentration","of\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n.\nSimilar","to","eq.","(\n22),","we","can","show","that","for","anyf∈F,\n\f\n\f\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\n≤2\nH\nX\nh=1\n\f\n\f\nf\nh\n(s\nh\n,a\nh\n)−T\n†\nh\nf\nh+1\n(s\nh\n,a\nh\n)\n\f\n\f\n.\nBy","Cauchy-Schwarz","inequality,\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n2\n\u0003\n≤4H\n2\n\r\n\r\nf−T\n†\nf\n\r\n\r\n2\nμ\n≤8H\n2\n\u0010\n\r\n\r\nf−T\n⋆\nf\n\r\n\r\n2\nμ\n+\n\r\n\r\nT\n†\nf−T\n⋆\nf\n\r\n\r\n2\nμ\n\u0011\n≤8H\n2\n\u0000\nE(f)","+ǫ\n\u0001\n,\n(40)\nwhere","we","have","used","Assumption\n3.","It","follows","that\nVar\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n≤E\n\u0002\n(L\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n)\n2\n\u0003\n≤2E\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n2\n\u0003\n+","2E\n\u0002\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n2\n\u0003\n≤16H\n2\n\u0000\nE(f)","+E(f\n†\n)","+","2ǫ\n\u0001\n.\nWe","also","learn","from","eq.","(\n31)","that\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n≥E(f)−E(f\n†\n)−ǫ.(41)\nWe","combine","eq.","(\n40)","and","eq.","(41)","and","find","that\nVar\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n≤16H\n2\n\u0000\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0002\nf\n†\n,T\n†\nf\n†\n\u0003\u0003\n+","2E(f\n†\n)","+","3ǫ\n\u0001\n.\nWe","now","apply","Theorem\nG.3and","aim","to","find","a","sub-root","functionψ\nL\nsuch","thatψ\nL\n(r)≥\ne\nψ(r)for\ne\nψ(r)",":=16H\n2\nR\nn\n\u0010n\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n\f\n\f\n\f\nf∈F,\n16H\n2\n\u0000\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n+","2E(f\n†\n)","+","3ǫ\n\u0001\n≤r\no\u0011\n=16H\n2\nR\nn\n\u0010n\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\n\f\nf∈F,\n16H\n2\n\u0000\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n+","2E(f\n†\n)","+","3ǫ\n\u0001\n≤r\no\u0011\n.\n(42)\nNote","that","by","eqs.","(\n40)","and","(41),","we","have\n16H\n2\n\u0000\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n+","2E(f\n†\n)","+","3ǫ\n\u0001\n≥2E\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n2\n\u0003\n,\ntherefore,\ne\nψ(r)≤16H\n2\nR\nn\n\u0010n\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\n\f\nf∈F,2E\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n2\n\u0003\n≤r\no\u0011\n≤16H\n2\nψ\nL\n\u0010\nr\n2\n\u0011\n,\nwhere\nψ\nL\n(r)","=R\nn\n\u0010n\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\n\f\nf∈F,E\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n2\n\u0003\n≤r\no\u0011\n.\nLetr\n⋆\nL\nbe","the","positive","fixed","point","ofψ\nL\n.","Lemma\nG.5implies","the","positive","fixed","point","of","mappingr7→\n16H\n2\nψ\nL\n\u0000\nr/2\n\u0001\nis","upper","bounded","by128H\n4\nr\n⋆\nL\n.","We","then","obtain","eq.","(\n39)","by","applying","eq.","(90)","in","TheoremG.3.\n27\n\nWhile","LemmaC.5above","uses","the","local","Rademacher","complexity","of","a","composite","functionL\nMM\n(f,T\n†\nf),\nLemma\nC.6below","provides","an","alternative","concentration","inequality","for\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n,\nwhich","involves","the","complexities","ofF\nh\n,G\nh\nandV\nF\nh+1\n.\nLemma","C.6.Suppose","Assumptions\n3and4hold.","There","exists","a","universal","constantc",">0such","that","for","any\nfixed","parameterθ",">1,","with","probability","at","least1−δ,\nE\nμ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−E\nμ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\n≤\nθ\nθ−1\n\u0000\nˆ\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−\nˆ\nL\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0001\n+Err\nf\n(43)\nfor","anyf∈F,","with\nErr\nf\n:=cθ\ne\nCH\n3\nH\nX\nh=1\n\u0010\nr\n⋆\nf,h\n+r\n⋆\ng,h\n+er\n⋆\nf,h+1\n+\nq\nǫr\n⋆\ng,h\n/\ne\nC\n\u0011\n+cθH\n2\nlog(1/δ)\nn\n+\nc\nθ−1\n\u0000\nE(f\n†\n)","+ǫ\n\u0001\n.\nHere,\ne\nCis","the","concentrability","coefficient","in","Assumption\n4.\nProof.In","this","proof,","we","estimate","the","critical","radius","of\ne\nψ(r)in","eq.","(\n42)","in","an","alternative","way.","In","particular,\nwe","use","parametersr\n⋆\nf,h\n,r\n⋆\ng,h\nander\n⋆\nf,h\ndefined","in","the","statement","of","Theorem\n5.5.","The","key","step","is","to","upper\nbound\ne\nψ(r)by","the","local","Rademacher","complexitiesR\nμ\nh\nn\n\u0000\b\nf\nh\n∈","F\nh\n\f\n\f\nkf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n,R\nμ\nh\nn\n\u0000\b\ng\nh\n∈\nG\nh\n\f\n\f\nkg\nh\n−g\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\nandR\nν\nh\nn\n\u0000\b\nV\nf\nh+1\n\f\n\f\nf\nh+1\n∈F\nh+1\n,kf\nh+1\n−f\n†\nh+1\nk\n2\nν\nh\n×Unif(A)\n≤r\n\t\u0001\n.\nWe","take","a","shorthandF(r)",":=\n\b\nf∈F\n\f\n\f\n16H\n2\n\u0000\nE\n\u0002\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n+2E(f\n†\n)+3ǫ\n\u0001\n≤r\n\t\nand","rewrite\ne\nψ(r)as\ne\nψ(r)","=","16H\n2\nR\nn\n\u0000\b\nL\nMM\n\u0000\nf,T\n†\nf\n\u0001\n\f\n\f\nf∈F(r)\n\t\u0001\n.","Similar","to","Lemma\nC.3,","one","can","show\nthat","there","exists","a","univeral","constantc",">0such","that\ner≤cH\n2\nH\nX\nh=1\n\u0000\nψ\nh,1\n(r)","+ψ\nh,2\n(r)","+ψ\nh,3\n(r)\n\u0001\n.\nwhereψ\nh,1\n(r)",":=R\nμ\nh\nn\n\u0000\b\nf\nh\n\f\n\f\nf∈","F(r)\n\t\u0001\n,ψ\nh,2\n(r)",":=R\nμ\nh\nn\n\u0000\b\nT\n†\nh\nf\nh+1\n\f\n\f\nf∈","F(r)\n\t\u0001\nandψ\nh,3\n(r)",":=\nR\nν\nh\nn\n\u0000\b\nV\nf\nh+1\n\f\n\f\nf∈F(r)\n\t\u0001\n.","In","the","sequel,","we","simplifyψ\nh,1\n,ψ\nh,2\nandψ\nh,3\n.\nFor","anyf∈F(r),","due","to","eq.","(\n41),","we","have\n\r\n\r\n(f−T\n⋆\nf)−(f\n†\n−T\n⋆\nf\n†\n)\n\r\n\r\n2\nμ\n≤2\n\r\n\r\nf−T\n⋆\nf\n\r\n\r\n2\nμ\n+","2\n\r\n\r\nf\n†\n−T\n⋆\nf\n†\n\r\n\r\n2\nμ\n=","2E(f)","+","2E(f\n†\n)\n≤2E\n\u0002\nL\nMM\n\u0002\nf,T\n†\nf\n\u0003\n−L\nMM\n\u0000\nf\n†\n,T\n†\nf\n†\n\u0001\u0003\n+","4E(f\n†\n)","+","2ǫ≤\nr\n8H\n2\n.\nWe","use","Lemma\nF.1and","find","that","under","Assumptions3and4,","for","anyf∈F,\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nμ\nh\n≤\ne\nCr\n8\n,\n\r\n\r\nT\n†\nh\nf\nh+1\n−T\n†\nh\nf\n†\nh+1\n\r\n\r\n2\nμ\nh\n≤\n\u0000\n\r\n\r\nT\n⋆\nh\nf\nh+1\n−T\n⋆\nh\nf\n†\nh+1\n\r\n\r\nμ\nh\n+","2\n√\nǫ\n\u0001\n2\n≤2\n\r\n\r\nT\n⋆\nh\nf\nh+1\n−T\n⋆\nh\nf\n†\nh+1\n\r\n\r\n2\nμ\nh\n+","8ǫ≤\ne\nCr\n4\n+","8ǫ,\n\r\n\r\nf\nh+1\n−f\n†\nh+1\n\r\n\r\n2\nν\nh\n×Unif(A)\n≤\ne\nCr\n8\n.\n28\n\nIt","follows","that\nψ\nh,1\n(r)","=R\nμ\nh\nn\n\u0000\b\nf\nh\n\f\n\f\n\f\nf∈F(r)\n\t\u0001\n≤R\nμ\nh\nn\n\u0010n\nf\nh\n∈F\nh\n\f\n\f\n\f\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nμ\nh\n≤\ne\nCr\n8\no\u0011\n,\nψ\nh,2\n(r)","=R\nμ\nh\nn\n\u0000\b\nT\n†\nh\nf\nh+1\n\f\n\f\nf∈F(r)\n\t\u0001\n≤R\nμ\nh\nn\n\u0010n\ng\nh\n∈G\nh\n\f\n\f\n\f\n\r\n\r\ng\nh\n−T\n†\nh\nf\n†\nh+1\n\r\n\r\n2\nμ\nh\n≤\ne\nCr\n4\n+","8ǫ\no\u0011\n,\nψ\nh,3\n(r)","=R\nν\nh\nn\n\u0000\b\nV\nf\nh+1\n\f\n\f\nf∈F(r)\n\t\u0001\n≤R\nν\nh\nn\n\u0010n\nV\nf\nh+1\n\f\n\f\n\f\nf\nh+1\n∈F\nh+1\n,\n\r\n\r\nf\nh+1\n−f\n†\nh+1\n\r\n\r\n2\nν\nh\n×Unif(A)\n≤\ne\nCr\n8\no\u0011\n.\nRecall","thatr\n⋆\nf,h\n,r\n⋆\ng,h\nander\n⋆\nf,h+1\nare","respectively","the","fixed","points","of\nψ\nf,h\n(r)","=R\nμ\nh\nn\n\u0000\b\nf\nh\n∈F\nh\n\f\n\f\n\r\n\r\nf\nh\n−f\n†\nh\nk\n2\nμ\nh\n≤r\n\t\u0001\n,\nψ\ng,h\n(r)","=R\nμ\nh\nn\n\u0000\b\ng\nh\n∈G\nh\n\f\n\f\n\r\n\r\ng\nh\n−T\n†\nh\nf\n†\nh+1\nk\n2\nμ\nh\n≤r\n\t\u0001\nand\ne\nψ\nf,h\n(r)","=R\nν\nh\nn\n\u0000\b\nV\nf\nh+1\n\f\n\f\nf\nh+1\n∈F\nh+1\n,\n\r\n\r\nf\nh+1\n−f\n†\nh+1\n\r\n\r\n2\n","̃μ\nh+1\n≤r\n\t\u0001\n.\nAccording","to","Lemma\nG.5,","the","positive","fixed","points","ofψ\nh,1\n,ψ\nh,2\nandψ\nh,3\nare","upper","bounded","by8\ne\nCr\n⋆\nf,h\n,\n4\ne\nCr\n⋆\ng,h\n+\nq\n32ǫ\ne\nCr\n⋆\ng,h\nand8\ne\nCer\nf,h\n,","therefore,","the","critical","radiuser\n⋆\nof\ne\nψ(r)satisfies\ner\n⋆\n≤c\n2\nH\n4\n","\nH\nX\nh=1\n\u0010\nq\n8\ne\nCr\n⋆\nf,h\n+\nq\n4\ne\nCr\n⋆\ng,h\n+\n4\nq\n32ǫ\ne\nCr\n⋆\ng,h\n+\nq\n8\ne\nCer\n⋆\nf,h\n\u0011\n!\n2\n≤c\n′\ne\nCH\n5\nH\nX\nh=1\n\u0010\nr\n⋆\nf,h\n+r\n⋆\ng,h\n+er\n⋆\nf,h\n+\nq\nǫr\n⋆\ng,h\n/\ne\nC\n\u0011\n,\nwherec,c\n′\n>0are","universal","constants.\nWe","then","apply","eq.","(\n90)","in","TheoremG.3and","obtain","eq.","(43).\nConcentration","inequality","eq.","(29),\nˆ\nℓ\n\u0000\ng,f\n†\n\u0001\n−\nˆ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\nLemma","C.7.Suppose","Assumption\n3holds.","Then","there","exists","a","universal","constantc",">0such","that","for","any\nfixed","parameterθ",">1,","with","probability","at","least1−δ,\nE\nμ\nℓ\n\u0000\ng,f\n†\n\u0001\n−E\nμ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n≤\nθ\nθ−1\n\u0000\nˆ\nℓ\n\u0000\ng,f\n†\n\u0001\n−\nˆ\nℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\u0001\n+Err\ng\n,(44)\nwithErr\ng\n:=cθH\nH\nX\nh=1\nr\n⋆\ng,h\n+cθH\n2\nlog(H/δ)\nn\n+\ncǫ\nθ−1\n.\nProof.Note","that\nℓ\n\u0000\ng,f\n†\n\u0001\n−ℓ\n\u0000\nT\n†\nf\n†\n,f\n†\n\u0001\n=\n1\nH\nH\nX\nh=1\n\u0000\nℓ(g\nh\n,f\n†\nh+1\n)−ℓ\n\u0000\nT\n†\nh\nf\n†\nh+1\n,f\n†\nh+1\n\u0001\u0001\n.\nWe","can","analyze","the","concentration","ofℓ(g\nh\n,f\n†\nh+1\n)−ℓ\n\u0000\nT\n†\nh\nf\n†\nh+1\n,f\n†\nh+1\n\u0001\nin","a","way","similar","to","Theorem\n5.3.","It\nfollows","that","for","anyh∈[H],","with","probability","at","least1−δ,\nE\nμ\nℓ(g\nh\n,f\n†\nh+1\n)−E\nμ\nℓ\n\u0000\nT\n†\nh\nf\n†\nh+1\n,f\n†\nh+1\n\u0001\n≤\nθ\nθ−1\n\u0000\nˆ\nℓ(g\nh\n,f\n†\nh+1\n)−\nˆ\nℓ\n\u0000\nT\n†\nh\nf\n†\nh+1\n,f\n†\nh+1\n\u0001\u0001\n+","8c\n1\nθH\n2\nr\n⋆\ng,h\n+","(2c\n2\n+","8c\n3\nθ)H\n2\nlog(1/δ)\nn\n+\n2ǫ\nθ−1\n,\n29\n\nfor","anyg\nh\n∈","G\nh\n,","wherec\n1\n,c\n2\n,c\n3\nare","the","constants","in","TheoremG.3.","By","union","bound,","we","can","further","derive\neq.","(\n44).\nC.4","","Proof","of","Theorems5.4,5.5andC.1\nProof","of","Theorem5.4.Combining","LemmasC.2toC.4,","we","obtain","Theorem5.4.\nProof","of","Theorems5.5andC.1.Plugging","Lemmas","LemmasC.5andC.7into","LemmaC.2yields","that","with\nprobability","at","least1−δ,\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+ǫ+cθH\n2\n","\nr\n⋆\nL\n+\n1\nH\nH\nX\nh=1\nr\n⋆\ng,h\n+\nlog(H/δ)\nn\n!\n+\nc\nθ−1\n\u0000\nE(f\n†\n)","+ǫ\n\u0001\nfor","a","universal","constantc",">0.","By","letting\nθ:=","1","+\ns\nE(f\n†\n)","+ǫ\ncH\n2\n\u0000\nr\n⋆\nL\n+\n1\nH\nP\nH\nh=1\nr\n⋆\ng\nh\n+\nlog(H/δ)\nn\n\u0001\n,\nwe","have\nE(\nˆ\nf)≤min\nf∈F\nE(f)","+ǫ+cH\n2\n","\nr\n⋆\nL\n+\n1\nH\nH\nX\nh=1\nr\n⋆\ng\nh\n+\nlog(H/δ)\nn\n!\n+cH\nv\nu\nu\nt\n\u0000\nmin\nf∈F\nE(f\n†\n)","+ǫ\n\u0001\n","\nr\n⋆\nL\n+\n1\nH\nH\nX\nh=1\nr\n⋆\ng\nh\n+\nlog(H/δ)\nn\n!\n,\nwhich","finishes","the","proof","of","TheoremC.1.\nSimilarly,","by","combining","Lemmas\nC.2,C.6andC.7,","we","prove","Theorem5.5.\nD","","Examples","(Propositions6.1to6.4)\nIn","this","part,","we","provide","estimates","for","the","(local)","Rademacher","complexities","of","four","special","function","spaces,\nnamely","function","class","with","finite","elements,","linear","functionspace,","kernel","class","and","sparse","linear","space.","The\nresults","presented","here","slightly","generalize","Propositions\n6.1to6.4.\nD.1","","Function","class","with","finite","elements","(Proposition\n6.1)\nLemma","D.1(Full","version","of","Proposition\n6.1).SupposeFis","a","discrete","function","class","with|F|<∞and\nf∈[0,D]for","anyf∈F.","Then","for","any","distributionρ,\nR\nρ\nn\n(F)≤2Dmax\n\u001a\nr\nlog|F|\nn\n,\nlog|F|\nn\n\u001b\n.(45)\nFor","any","functionf\n◦\nwith","range","in[0,D],","we","have\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤ψ(r),whereψ(r)",":=","2","max\n\u001a\nr\nrlog|F|\nn\n,\nDlog|F|\nn\n\u001b\n.(46)\nψis","a","sub-root","function","with","positive","fixed","point\nr\n⋆\n=\n2(D∨2)","log|F|\nn\n.\n30\n\nWe","remark","that","Proposition6.1is","a","corollary","of","LemmaD.1withD:=H.\nIn","order","to","prove","Lemma\nD.1,","we","first","present","a","preliminary","lemma","that","will","be","used","later.See\nLemma\nD.2.\nLemma","D.2.Suppose","a","random","variableXsatisfies|X|≤DandE[X]","=","0.","Then","for","anyλ",">0,","we","have\nE[e\nλX\n]≤exp\n\u001a\nλ\n2\nVar[X]\n\u0012\ne\nλD\n−1−λD\nλ\n2\nD\n2\n\u0013\u001b\n.(47)\nProof.Note","thatX≤Dand","the","mappingx7→\ne\nx\n−1−x\nx\n2\nis","nondecreasing,","therefore,\ne\nλX\n−1−λX\nλ\n2\nX\n2\n≤\ne\nλD\n−1−λD\nλ\n2\nD\n2\n.","It","follows","that\nE[e\nλX\n]","=","1","+λE[X]","+λ\n2\nE\n\u0014\nX\n2\n\u0012\ne\nλX\n−1−λX\nλ\n2\nX\n2\n\u0013\u0015\n≤1","+λ\n2\nVar[X]\n\u0012\ne\nλD\n−1−λD\nλ\n2\nD\n2\n\u0013\n,(48)\nwhere","we","have","used","the","factE[X]","=","0.","Since1","+x≤e\nx\nfor","anyx∈R,","eq.","(\n48)","implies","eq.","(47).\nWe","are","now","ready","to","prove","LemmaD.1.\nProof","of","Lemma\nD.1.We","can","easily","see","that","eq.","(45)","is","a","corollary","of","eq.","(46)","by","lettingf\n◦\n=","0andr=D\n2\n,\ntherefore,","we","focus","on","proving","eq.","(\n46).","By","definition","of","Rademacher","complexity","and","the","symmetry","of\nRademacher","variables,","we","have\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n=R\nρ\nn\n\u0000\b\nf−f\n◦\n∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n=Emax\n(\n1\nn\nn\nX\ni=1\nσ\ni\n\u0000\nf(X\ni\n)−f\n◦\n(X\ni\n)\n\u0001\n\f\n\f\n\f\n\f\nf∈F,kf−f\n◦\nk\n2\nρ\n≤r\n)\n.\nFor","anyλ",">0,","it","holds","that\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n=\n1\nλn\nElog","","","max\nf∈F:\nkf−f\n◦\nk\n2\nρ\n≤r\nexp\n(\nλ\nn\nX\ni=1\nσ\ni\n\u0000\nf(X\ni\n)−f\n◦\n(X\ni\n)\n\u0001\n)\n≤\n1\nλn\nElog\nX\nf∈F:\nkf−f\n◦\nk\n2\nρ\n≤r\nexp\n(\nλ\nn\nX\ni=1\nσ\ni\n\u0000\nf(X\ni\n)−f\n◦\n(X\ni\n)\n\u0001\n)\n≤\n1\nλn\nlog\nX\nf∈F:\nkf−f\n◦\nk\n2\nρ\n≤r\nEexp\n(\nλ\nn\nX\ni=1\nσ\ni\n\u0000\nf(X\ni\n)−f\n◦\n(X\ni\n)\n\u0001\n)\n,\n(49)\nwhere","the","last","line","is","due","to","Jensen’s","inequality.","Since(σ\n1\n,X\n1\n),...,(σ\nn\n,X\nn\n)arei.i.d.samples,\nEexp\n(\nλ\nn\nX\ni=1\nσ\ni\n\u0000\nf(X\ni\n)−f\n◦\n(X\ni\n)\n\u0001\n)\n=\n\u0010\nEexp\n\b\nλσ\n1\n\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\t\n\u0011\nn\n.(50)\nNote","that\n\f\n\f\nσ\n1\n\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\n\f\n\f\n≤DandE\n\u0002\nσ\n1\n\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\u0003\n=","0sinceE[σ\n1\n]","=","0.","For","anyf∈F\nsuch","thatkf−f\n◦\nk\n2\nρ\n≤r,","we","haveVar\n\u0002\nσ\n1\n\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\u0003\n=E\n\u0002\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\n2\n\u0003\n=kf−f\n◦\nk\n2\nρ\n≤r.\nWe","apply","Lemma\nD.2and","derive","that\nEexp\n\b\nλσ\n1\n\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\t\n≤exp\n\u001a\nλ\n2\nr\n\u0012\ne\nλD\n−1−λD\nλ\n2\nD\n2\n\u0013\u001b\n.(51)\n31\n\nCombining","eqs.","(49)","to","(51),","we","obtain\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤\n1\nλn\nlog\nX\nf∈F:\nkf−f\n◦\nk\n2\nρ\n≤r\n\u0010\nEexp\n\b\nλσ\n1\n\u0000\nf(X\n1\n)−f\n◦\n(X\n1\n)\n\u0001\t\n\u0011\nn\n≤\n1\nλn\nlog\n","\n|F|exp\n\u001a\nnλ\n2\nr\n\u0012\ne\nλD\n−1−λD\nλ\n2\nD\n2\n\u0013\u001b\n!\n=\nlog|F|\nλn\n+λr\n\u0012\ne\nλD\n−1−λD\nλ\n2\nD\n2\n\u0013\n.\n(52)\nForr≥\nD\n2\nlog|F|\nn\n,","by","lettingλ:=\nq\nlog|F|\nrn\n,","eq.","(\n52)","impliesR\nρ\nn\n\u0000\b\nf∈","F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤\n2\nq\nrlog|F|\nn\n,","where","we","have","used","the","fact\ne\nx\n−1−x\nx\n2\n≤1for","anyx≤1.","When0≤r","<\nD\n2\nlog|F|\nn\n,","by","letting\nλ:=\n1\nD\n,","eq.","(\n52)","ensuresR\nn\n\u0000\b\nf∈F\n\f\n\f\nP(f−f\n◦\n)\n2\n≤r\n\t\u0001\n≤\n2Dlog|F|\nn\n.","Integrating","the","pieces,","we","complete\nthe","proof","of","eq.","(\n46).\nIt","is","easy","to","see","that","the","right","hand","side","of","eq.","(\n46)","is","a","sub-root","function","with","positive","fixed","point\n2(D∨2)","log|F|\nn\n.\nD.2","","Linear","Space","(Proposition6.2)\nLemma","D.3(Full","version","of","Proposition\n6.2).Letφ:S","×A","→R\nd\nbe","a","feature","map","tod-dimensional\nEuclidean","space","andρbe","a","distribution","overS","×A.","Consider","a","function","class\nF=\n\b\nf=w\n⊤\nφ\n\f\n\f\nw∈R\nd\n,kfk\n2\nρ\n≤B\n\t\n,\nwhereB",">0.","It","holds","that\nR\nρ\nn\n(F)≤\nr\n2Bd\nn\n.\nFor","anyf\n◦\n∈F,","we","have\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤ψ(r),whereψ(r)",":=\nr\n2rd\nn\n.\nψis","sub-root","and","has","a","positive","fixed","point\nr\n⋆\n=\n2d\nn\n.\nProposition\n6.2in","Section6is","a","corollary","to","LemmaD.3.","In","Proposition6.2,","conditionskwk","≤H\nandkφ(s,a)k","≤1ensurekfk\n∞\n≤Hforf=w\n⊤\nφand","thereforekfk\n2\nρ\n≤H\n2\n.","By","lettingB:=H\n2\nin\nLemmaD.3,","we","obtain","Proposition6.2.\nProof","of","Lemma\nD.3.LemmaD.3can","be","viewed","as","a","consequence","of","LemmaD.4in","AppendixD.3.","Without\nloss","of","generality,","suppose","thatφis","orthonormal","inL\n2\n(ρ),","that","is,\nR\nS×A\nφ\ni\n(s,a)φ\nj\n(s,a)ρ(s,a)dsda=\n(\n1ifi=j,\n0ifi6=j.\nDefine","a","kernel","functionk\n\u0000\n(s,a),(s\n′\n,a\n′\n)\n\u0001\n=φ(s,a)\n⊤\nφ(s\n′\n,a\n′\n).","The","RKHS","associated","with\nkernelkis","the","linear","space","spanned","byφendorsed","with","inner","producthf,f\n′\ni\nK\n:=w\n⊤\nw\n′\nforf=φ\n⊤\nw,\n32\n\nf\n′\n=φ\n⊤\nw\n′\n.","In","this","way,","we","havek·k\nρ\n=k·k\nK\n.","For","anyf∈","F,kfk\n2\nρ\n≤Bimplieskfk\nK\n≤\n√\nB.","We\napply","the","results","in","Lemma\nD.4withD=\n√\nB.","It","follows","thatR\nρ\nn\n(F)≤\nq\n2B\nn\nP\n∞\ni=1\n1∧(4λ\ni\n)≤\nq\n2Bd\nn\nandR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤\nq\n2\nn\nP\n∞\ni=1\nr∧\n\u0000\n4Bλ\nk\n\u0001\n≤\nq\n2rd\nn\nsinceλ\ni\n=","0fori",">","d.\nD.3","","Kernel","Class","(Proposition6.3)\nWe","now","consider","kernel","class,","that","is,","a","sphere","in","an","RKHSHassociated","with","a","positive","definite","kernel\nk:X×X","→R.","In","our","paper,X=S×A.","Letρbe","a","distribution","overX.","We","are","interested","in","Rademacher\ncomplexities","of","function","class\nF=\n\b\nf∈H\n\f\n\f\nkfk\nK\n≤D,kfk\n2\nρ\n≤B\n\t\n.(53)\nHere,k·k\nK\ndenotes","the","RKHS","norm","andD,B≥0are","some","constants.","Suppose","thatE\nρ\nk(X,X)<∞for\nX∼ρ.","We","define","an","integral","operatorT:L\n2\n(ρ)→L\n2\n(ρ)as\nTf=\nZ\nk(·,y)f(y)ρ(y)dy.\nIt","is","easy","to","see","thatTis","positive","semidefinite","and","trace-class.","","Let{λ\ni\n}\n∞\ni=1\nbe","the","eigenvalues","ofT,\narranging","in","a","nonincreasing","order.","By","using","these","eigenvalues,","we","have","an","estimate","for","(local)","Rademacher\ncomplexities","ofFin","Lemma\nD.4below.\nLemma","D.4(Full","version","of","Proposition\n6.3).For","function","classFdefined","in","eq.(53),","we","have\nR\nρ\nn\n(F)≤\nv\nu\nu\nt\n2\nn\n∞\nX\ni=1\nB∧(4D\n2\nλ\ni\n).(54)\nLetf\n◦\nbe","an","arbitrary","function","inF.","The","local","Rademacher","complexity","aroundf\n◦\nsatisfies\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤ψ(r),whereψ(r)",":=\nv\nu\nu\nt\n2\nn\n∞\nX\ni=1\nr∧\n\u0000\n4D\n2\nλ\ni\n\u0001\n.(55)\nψis","a","sub-root","function","with","positive","fixed","point\nr\n⋆\n≤2","min\nj∈N\n\n\n\nj\nn\n+D\nv\nu\nu\nt\n2\nn\n∞\nX\ni=j+1\nλ\ni\n\n\n\n.(56)\nIn","Proposition\n6.3,","we","assume","thatk(x,x)≤1for","anyx∈Xandkfk\nK\n≤Hfor","anyf∈F.","It","is","then\nguaranteed","that|f(x)|=\n\f\n\f\nhf,k(·,x)i\nK\n\f\n\f\n≤kfk\nK\n\r\n\r\nk(·,x)\n\r\n\r\nK\n=kfk\nK\np\nk(x,x)≤H,","which","further","implies\nkfk\n2\nρ\n≤H\n2\n.","To","this","end,","Proposition\n6.3is","a","consequence","of","lemmaD.4by","takingD:=HandB:=H\n2\n.\nWe","remark","on","the","rate","ofr\n⋆\nwith","respect","to","sample","sizen.","Firstly,","it","is","evident","thatr\n⋆\n.n\n−\n1\n2\n.","When\nλ\ni\n.i\n−α\nforα",">1,r\n⋆\nh\nhas","ordern\n−\nα\n1+α\nwhich","is","typical","in","nonparametric","estimation.","When","the","eigenvalues\n{λ\ni\n}\n∞\ni=1\ndecay","exponentially","quickly,i.e.λ\ni\n.exp(−βi\nα\n)forα,β",">0,r\n⋆\ncan","be","of","ordern\n−1\n(logn)\n1/α\n.\nOur","proof","of","Lemma\nD.4is","based","on","a","classical","result","shown","in","TheoremD.5.\n33\n\nTheorem","D.5(Theorem","41","inMendelson[2002]).For","everyr",">0,","we","have\nR\nρ\nn\n\u0000\b\nf∈H\n\f\n\f\nkfk\nK\n≤1,kfk\n2\nρ\n≤r\n\t\u0001\n≤\nv\nu\nu\nt\n2\nn\n∞\nX\ni=1\nr∧λ\ni\n.\nNow","we","are","ready","to","prove","Lemma\nD.4.\nProof","of","Lemma\nD.4.Since","eq.","(54)","is","a","corollary","of","eq.","(55)","by","settingr=B,","we","only","consider","eqs.","(55)\nand","(\n56).\nDue","to","the","symmetry","of","Rademacher","random","variables,\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n=R\nρ\nn\n\u0000\b\nf−f\n◦\n\f\n\f\nf∈F,kf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n.(57)\nSincekfk\nK\n≤Dimplieskf−f\n◦\nk\nK\n≤2D,","we","haveF","⊆\n\b\nf∈H\n\f\n\f\nkf−f\n◦\nk\nK\n≤2D\n\t\n.","It","follows","that\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤R\nρ\nn\n\u0000\b\nf−f\n◦\n\f\n\f\nf∈H,kf−f\n◦\nk\nK\n≤2D,kf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n=R\nρ\nn\n\u0000\b\nf∈H\n\f\n\f\nkfk\nK\n≤2D,kfk\n2\nρ\n≤r\n\t\u0001\nf\n′\nh\n:=f\nh\n/(2D)\n=","","","","2D·R\nρ\nn\n\u0012\u001a\nf\n′\n∈H\n\f\n\f\n\f\n\f\nkf\n′\nk\nK\n≤1,kf\n′\nk\n2\nρ\n≤\nr\n4D\n2\n\u001b\u0013\n,\nwhere","we","have","used","the","translational","symmetry","of","RKHSH.","We","apply","Theorem\nD.5and","derive","that\nR\nρ\nn\n\u0000\b\nf∈F\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤2D\nv\nu\nu\nt\n2\nn\n∞\nX\ni=1\nr\n4D\n2\n∧λ\ni\n=\nv\nu\nu\nt\n2\nn\n∞\nX\ni=1\nr∧\n\u0000\n4D\n2\nλ\ni\n\u0001\n=ψ(r).\nIt","is","evident","thatψis","sub-root.","In","the","following,","we","estimate","the","positive","fixedpointr\n⋆\nofψ.\nIfr≤r\n⋆\n,","thenr≤ψ(r),","which","implies\nr\n2\n≤\n2\nn\n∞\nX\ni=1\nr∧\n\u0000\n4D\n2\nλ\ni\n\u0001\n≤\n2\nn\n","\njr+","4D\n2\n∞\nX\ni=j+1\nλ\ni\n!\nfor","anyj∈N.\nSolving","the","quadratic","inequality","yields\nr≤\n2j\nn\n+","2D\nv\nu\nu\nt\n2\nn\n∞\nX\ni=j+1\nλ\ni\nfor","anyj∈N.\nIt","ensures","that\nr\n⋆\n≤2","min\nj∈N\n\n\n\nj\nn\n+D\nv\nu\nu\nt\n2\nn\n∞\nX\ni=j+1\nλ\ni\n\n\n\n.\nD.4","","Sparse","Linear","Class","(Proposition6.4)\nLetφ:S×A→R\nd\nbe","ad-dimensional","feature","map","andρbe","a","distribution","overS×A.","We","are","interested\nin","function","class\nF\ns\n=\n\b\nf=w\n⊤\nφ\n\f\n\f\nw∈R\nd\n,kwk\n0\n≤s,kfk\n2\nρ\n≤B\n\t\n.\nIn","the","following,","we","provide","an","estimate","for","(local)","Rademacher","complexities","ofF\ns\nbased","on","the","trans-\nportationT\n2\ninequality.","Proposition\n6.4would","be","a","special","case","of","our","result","in","this","part","since","Gaussian\ndistributions","always","satisfyT\n2\ninequality.\n34\n\nNotationsWe","denote","byα⊆[d]an","index","set","withselements.","LetI:=\n\b\nα⊆[d]\n\f\n\f\n|α|=s\n\t\n.","Note","that\n|I|≤d\ns\n.","For","anyα∈I,","letφ\nα\nbe","the","subvector","ofφwithφ\nα\n:=","(φ\nα\n1\n,φ\nα\n2\n,...,φ\nα\ns\n)\n⊤\n.","Denote","covariance\nmatrixΣ",":=E\nρ\n\u0002\nφφ\n⊤\n\u0003\n∈R\nd×d\n.","LetΣ\nα\n:=E\nρ\n\u0002\nφ\nα\nφ\n⊤\nα\n\u0003\n∈R\ns×s\nbe","the","principal","submatrix","ofΣwith","indices\ngiven","byα.\nWe","use","Orlicz","normsk·k\nψ\n1\nandk·k\nψ\n2\nin","the","spaces","of","random","variables.","For","a","real-valued","random\nvariableX,","definekXk\nψ\n1\n:=","inf\n\b\nc",">0\n\f\n\f\nE[exp(|X|/c)−1]≤1\n\t\nandkXk\nψ\n2\n:=","inf\n\b\nc",">0\n\f\n\f\nE[exp(X\n2\n/c\n2\n)−1]≤1\n\t\n.","For","a","random","vectorX∈R\nd\n,","definekXk\nψ\n1\n:=","sup\nu∈S\nd−1\nku\n⊤\nXk\nψ\n1\nand\nkXk\nψ\n2\n:=","sup\nu∈S\nd−1\nku\n⊤\nXk\nψ\n2\n.\nFor","any","positive","semidefinite","(PSD)","matrixM∈R\nd×d\n,","letM\n†\ndenote","its","Moore–Penrose","inverse","and\n√\nM\n†\n∈R\nd×d\nbe","the","unique","PSD","matrix","such","that\n\u0000\n√\nM\n†\n\u0001\n2\n=M\n†\n.","We","define","aM\n†\n-weighted","vector","norm\nk·k\nM\n†\naskxk\nM\n†\n=\n√\nx\n⊤\nM\n†\nx:=\n\r\n\r\n√\nM\n†\nx\n\r\n\r\n2\nfor","anyx∈R\nd\n.\nFor","any","two","distributionsμandνon","a","same","metric","space(X,d),","we","say","a","measurep(X,Y)overX×X\nis","a","coupling","ofμandνif","the","marginal","distributions","ofpareμandνrespectively,i.e.p(·,X)","=μand\np(X,·)","=ν.","Thequadratic","Wasserstein","metricofμandνis","defined","as\nW\n2\n(μ,ν)",":=inf\np(X,Y)∈C(μ,ν)\np\nE[d(X,Y)\n2\n],\nwhereC(μ,ν)is","the","collection","of","all","couplings","ofμ,ν.\nMain","resultsBefore","the","statement","of","main","results,","we","first","introduce","the","notion","ofT\n2\nproperty.","","See\nDefinition\nD.6below.\nDefinition","D.6(T\n2\n(σ)distribution).Suppose","that","a","probability","measureρon","metric","space(X,d)satisfy","the\nquadratic","transportation","cost(T\n2\n)","inequality\nW\n2\n(ρ,ν)≤\np\n2σ\n2\nKL(ν,ρ)for","all","measuresνonX,\nthen","we","sayρis","aT\n2\n(σ)distribution.\nWe","remark","thatT\n2\nis","a","broad","class","that","contains","many","common","distributions","as","special","cases.","For","ex-\nample,","Gaussian","distributionN(·,M)satisfiesT\n2\n\u0000\np\nkMk\n2\n\u0001\n-inequality.","Strongly","log-concave","distributions\nareT\n2\n.","Supposeρis","a","continuous","measure","with","a","convex","and","compact","support","set.","If","its","smallest","density","is\nlower","bounded","within","the","support,","thenρisT\n2\n.\nWe","have","an","estimate","of","the","(local)","Rademacher","complexities","ofF\ns\nin","Lemma\nD.7.\nLemma","D.7(Full","version","of","Proposition\n6.4).Suppose","that","forX∼ρ,","the","distribution","ofφ\nα\n(X)∈R\ns\nsatisfiesT\n2\n\u0000\nσ(α)\n\u0001\n-inequality","for","anyα∈","I.","Letσ\n2\nmin\n(α)be","the","smallest","positive","eigenvalue","ofΣ\nα\n=\nE\nρ\n\u0002\nφ\nα\nφ\n⊤\nα\n\u0003\n.","Letη\ns\nbe","a","constant","such","thatη\ns\n≥σ(α)/σ\nmin\n(α)for","anyα∈","I.","There","exists","a","universal\nconstantc",">0such","that","whenn≥cslogd,\nR\nρ\nn\n(F\ns\n)≤c(1","+η\ns\n)\nr\nBslogd\nn\n.\nMoreover,","whenn≥cslogd,","for","anyf\n◦\n∈F\ns\n,","the","local","Rademacher","complexity","ofF\ns\nsatisfies\nR\nρ\nn\n\u0000\b\nf∈F\ns\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n≤ψ(r),withψ(r)",":=c\n√\nr(1","+η\ns\n)\nr\nslogd\nn\n.\nHere,ψ(r)is","a","sub-root","function","with","a","unique","positive","fixed","point\nr\n⋆\n=c\n2\n(1","+η\ns\n)\n2\n·\nslogd\nn\n.\n35\n\nWhenφ(X)follows","a","non-degenerated","Gaussian","distribution","with","covariance","matrixΣ∈R\nd×d\n,","we\nhaveσ(α)≤\np\nλ\nmax\n(Σ\nα\n).","SinceE\nρ\n\u0002\nφ\nα\nφ\n⊤\nα\n\u0003\n\u0017Σ\nα\n,","it","also","holds","thatσ\nmin\n(α)","=\nq\nλ\nmin\n\u0000\nE\nρ\n\u0002\nφ\nα\nφ\n⊤\nα\n\u0003\u0001\n≥\np\nλ\nmin\n(Σ\nα\n).","According","to","LemmaD.7,","we","take","a","parameterκ\ns\n(Σ)such","thatκ\ns\n(Σ)≥λ\nmax\n(Σ\nα\n)/λ\nmin\n(Σ\nα\n)≥\n1for","allα∈I.","In","this","way,","the","result","in","Lemma\nD.7holds","forη\ns\n=\np\nκ\ns\n(Σ)and","reduces","to","Proposition\n6.4.\nProof","of","main","resultsIn","the","sequel,","we","prove","Lemma\nD.7.","We","first","present","some","preliminary","results.\nLemma","D.8.For","arbitrary","random","variablesX\n1\n,X\n2\n,...,X\nm\n≥0(m≥2)","satisfyingkX\ni\n1\n{|X\ni\n|≤R}\nk\nψ\n2\n≤\nκ\n2\nandkX\ni\n1\n{|X\ni\n|>R}\nk\nψ\n1\n≤κ\n1\nfori=","1,2,...",",mand","some","parameterR≥1,","we","have\nEmax\n1≤i≤m\nX\ni\n≤c\n\u0010\nκ\n2\np\nlogm+m(κ\n1\n+R)e\n−cR/κ\n1\n\u0011\n,\nwherec",">0is","a","universal","constant.\nProof.We","first","note","thatE\n\u0002\nmax\n1≤i≤m\nX\ni\n\u0003\n≤U+VwithU:=E\n\u0002\nmax\n1≤i≤m\nX\ni\n1\n{X\ni\n≤R}\n\u0003\nandV:=\nE\n\u0002\nmax\n1≤i≤m\nX\ni\n1\n{|X\ni\n|≥R}\n\u0003\n.","In","what","follows,","we","analyzeUandVseparately.\nBy","definition","ofψ\n2\n-norm","and","our","assumption\n\r\n\r\nX\ni\n1\n{|X\ni\n|≤R}\n\r\n\r\nψ\n2\n≤κ\n2\n,","we","haveE\n\u0002\nexp(X\n2\ni\n1\n{|X\ni\n|≤R}\n/κ\n2\n2\n)−\n1\n\u0003\n≤1fori=","1,2,...",",m.","It","follows","that\nE\n\u0014\nmax\n1≤i≤m\nX\n2\ni\n1\n{|X\ni\n|≤R}\nκ\n2\n2\n\u0015\nJensen’s\ninequality\n≤logE\n\u0014\nmax\n1≤i≤m\nexp\n\u0010\nX\n2\ni\n1\n{|X\ni\n|≤R}\nκ\n2\n2\n\u0011\n\u0015\n≤log\n","\nm\nX\ni=1\nE\n\u0014\nexp\n\u0010\nX\n2\ni\n1\n{|X\ni\n|≤R}\nκ\n2\n2\n\u0011\n\u0015\n!\n≤log(2m)≤2","logm.\nTherefore,","by","Jensen’s","inequalityU=E\n\u0002\nmax\n1≤i≤m\nX\ni\n1\n{|X\ni\n|≤R}\n\u0003\n≤\nq\nE\n\u0002\nmax\n1≤i≤m\nX\n2\ni\n1\n{|X\ni\n|≤R}\n\u0003\n≤\nκ\n2\n√\n2","logm.\nRecall","thatkX\ni\n1\n{|X\ni\n|>R}\nk\nψ\n1\n≤κ\n1\n,","which","implies","there","exists","a","universal","constantc≥1such","that\nP\n\u0000\n|X\ni\n|1\n{|X\ni\n|≥R}\n>","t\n\u0001\n≤ce\n−ct/κ\n1\n.","Using","this","fact,","we","find","that\nV≤E\n\u0014\nmax\n1≤i≤m\n|X\ni\n|1\n{|X\ni\n|>R}\n\u0015\n=\n\u0012\nZ\nR\n0\n+\nZ\n∞\nR\n\u0013\nP\n\u0010\nmax\n1≤i≤m\n|X\ni\n|1\n{|X\ni\n|>R}\n≥t\n\u0011\ndt\n=RP\n\u0010\nmax\n1≤i≤m\n|X\ni\n|1\n{|X\ni\n|>R}\n≥R\n\u0011\n+\nZ\n∞\nR\nP\n\u0010\nmax\n1≤i≤m\n|X\ni\n|1\n|X\ni\n|>R}\n≥t\n\u0011\ndt\nunion\nbound\n≤mRP\n\u0000\n|X\ni\n|1\n{|X\ni\n|>R}\n≥R\n\u0001\n+m\nZ\n∞\nR\nP\n\u0000\n|X\ni\n|1\n{|X\ni\n|>R}\n≥t\n\u0001\ndt\n≤mR·ce\n−cR/κ\n1\n+m\nZ\n∞\nR\nce\n−ct/κ\n1\ndt=cmRe\n−cR/κ\n1\n+mκ\n1\ne\n−cR/κ\n1\n≤cm(κ\n1\n+R)e\n−cR/κ\n1\n.\nIntegrating","the","pieces,","we","finish","the","proof.\nLemma","D.9.LetX\n1\n,X\n2\n,...,X\nn\n∈R\nd\nbe","i.i.d.","random","vectors","satisfyingT\n2\n(σ)-inequality","andE[X\n1\nX\n⊤\n1\n]","=\nM∈R\nd×d\n.","Suppose","thatn≥d.","Letσ\n1\n,σ\n2\n,...,σ\nn\nbe","Rademacher","random","variables","independent","of\nX\n1\n,X\n2\n,...,X\nn\n.","ThenY:=\n\r\n\r\n1\nn\nP\nn\nk=1\nσ\nk\nX\nk\n\r\n\r\nM\n†\nsatisfies\n\r\n\r\n|Y−E[Y]|1\n\b\n|Y−E[Y]|≤\n\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\t\n\r\n\r\nψ\n2\n≤c\n\u0012\n1\n√\nn\n+σ\nr\nkM\n†\nk\n2\nn\n\u0013\n36\n\nand\n\r\n\r\n|Y−E[Y]|1\n\b\n|Y−E[Y]|>\n\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\t\n\r\n\r\nψ\n1\n≤c\n\u0012\n1\nn\n+\nσ\np\nkM\n†\nk\n2\nn\n\u0013\n.\nProof.We","take","shorthandsX:=","[X\n1\n,X\n2\n,...,X\nn\n]∈R\nd×n\n,σ:=","(σ\n1\n,...,σ\nn\n)\n⊤\n∈R\nn\nand","rewriteYas\nY=\n1\nn\nkXσk\nM\n†\n.","Note","thatY−EY=\n\u0000\nY−E\nσ\n[Y|X]\n\u0001\n+\n\u0000\nE\nσ\n[Y|X]−EY\n\u0001\n.","In","the","following,","we\nanalyze","these","two","terms","separately.\nNote","that∇\nσ\nY=n\n−1\nkXσk\n−1\nM\n†\nX\n⊤\nM\n†\nXσandk∇\nσ\nYk\n2\n≤n\n−1\n\r\n\r\n√\nM\n†\nX\n\r\n\r\n2\n,","therefore,Yis","(n\n−1\n\r\n\r\n√\nM\n†\nX\n\r\n\r\n2\n)-\nLipschitz","with","respect","toσin","the","Euclidean","norm.","","Moreover,Yis","convex","inσand","the","Rademacher\nrandom","variables","are","independent","and","bounded.","We","use","Talagrand’s","inequality","(See","Theorem","4.20","and\nCorollary","4.23","in\nvan","Handel[2014].)","and","obtain","that","there","exists","a","universal","constantc",">0such","that\nP\n\u0010\n\f\n\f\nY−E\nσ\n[Y|X]\n\f\n\f\n≥t\n1\nn\n−1\n\r\n\r\n√\nM\n†\nX\n\r\n\r\n2\n\f\n\f\n\f\nX\n\u0011\n≤ce\n−ct\n2\n1\nfor","anyt\n1\n>0.(58)\nWe","next","consider","the","concentration","of\n\r\n\r\n√\nM\n†\nX\n\r\n\r\n2\n.","For","random","vectorX,","we","define\nkXk\nψ\n2\n:=","","","","sup\nu∈R\nd\n,kuk\n2\n≤1\nku\n⊤\nXk\nψ\n2\n.\nSinceXsatisfiesT\n2\n(σ)-inequality,","according","to","Gozlan’s","theorem","(Theorem","4.31","in\nvan","Handel[2014]),\nwe","find","that\n\r\n\r\n√\nM\n†\n(X−EX)\n\r\n\r\nψ\n2\n≤cσ\np\nkM\n†\nk\n2\nfor","some","universal","constantc",">0.","Additionally,","we\nhave\n\r\n\r\n√\nM\n†\nEX\n\r\n\r\n2\n≤\nq\n\r\n\r\nE\n\u0002\n√\nM\n†\nXX\n⊤\n√\nM\n†\n\u0003\n\r\n\r\n2\n=","1.","Therefore,\n\r\n\r\n√\nM\n†\nX\n\r\n\r\nψ\n2\n≤\n\r\n\r\n√\nM\n†\n(X−EX)\n\r\n\r\nψ\n2\n+\n\r\n\r\n√\nM\n†\nEX\n\r\n\r\n2\n≤1","+cσ\np\nkM\n†\nk\n2\n.","We","now","apply","Theorem","5.39","inVershynin[2010]","and","obtain","that\nP\n\u0010\n\r\n\r\n√\nM\n†\nX\n\r\n\r\n2\n≥\n√\nn+c(\n√\nd+t)\n\r\n\r\n√\nM\n†\nX\n\r\n\r\nψ\n2\n\u0011\n≤ce\n−ct\n2\n,\nwhich","further","implies\nP\n\u0010\n\r\n\r\n√\nM\n†\nX\n\r\n\r\n2\n≥\n√\nn+c\n\u0000\n√\nd+t\n2\n\u0001\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\n\u0011\n≤ce\n−ct\n2\n2\nfor","allt\n2\n>0.(59)\nCombining","eq.","(\n58)","and","eq.","(59),","we","learn","that\nP\n\u0010\n\f\n\f\nY−E\nσ\n[Y|X]\n\f\n\f\n≥t\n1\nn\n−\n1\n2\n+ct\n1\nn\n−1\n\u0000\n√\nd+t\n2\n\u0001\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\n\u0011\n≤c\n\u0000\ne\n−ct\n2\n1\n+e\n−ct\n2\n2\n\u0001\n.(60)\nAs","for","the","second","termE\nσ\n[Y|X]−EY,","we","use","theT\n2\n(σ)property","of","sample","distribution","and","Gozlan’s\ntheorem","(Theorem","4.31","in\nvan","Handel[2014]).","We","first","show","thatE\nσ\n[Y|X]is\nq\nkM\n†\nk\n2\nn\n-Lipschitz","with\nrespect","to","Frobenius","normk·k\nF\n.","In","fact,\n\f\n\f\nE\nσ\n[Y|X]−E\nσ\n[Y|X\n′\n]\n\f\n\f\n=\n1\nn\n\f\n\f\nE\nσ\nkXσk\nM\n†\n−E\nσ\nkX\n′\nσk\nM\n†\n\f\n\f\n≤\n1\nn\nE\nσ\n\f\n\f\nkXσk\nM\n†\n−kX\n′\nσk\nM\n†\n\f\n\f\n≤\n1\nn\nE\nσ\n\r\n\r\n(X−X\n′\n)σ\n\r\n\r\nM\n†\n≤\n1\nn\nq\nkM\n†\nk\n2\nkX−X\n′\nk\n2\nE\nσ\nkσk\n2\n≤\nr\nkM\n†\nk\n2\nn\nkX−X\n′\nk\nF\n.\nWe","then","apply","Gozlan’s","theorem","and","find","that","there","exists","a","universal","constantc",">0such","that\nP\n","\n\f\n\f\nE\nσ\n[Y|X]−E[Y]\n\f\n\f\n≥t\n1\nσ\nr\nkM\n†\nk\n2\nn\n!\n≤ce\n−ct\n2\n1\nfor","anyt\n1\n>0.(61)\n37\n\nIntegrating","eq.","(60)","and","eq.","(61)","and","using","the","conditionn≥d,","we","find","that\nP\n\u0010\n\f\n\f\nY−E[Y]\n\f\n\f\n≥t\n1\nn\n−\n1\n2\n\u0000\n1","+cn\n−\n1\n2\nt\n2\n\u0001\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\n\u0011\n≤c\n\u0000\ne\n−ct\n2\n1\n+e\n−ct\n2\n2\n\u0001\n.\nIf0≤t\n1\n≤\n√\nn,","then","by","lettingt\n2\n=\n√\nn,","we","have\nP\n\u0010\n\f\n\f\nY−E[Y]\n\f\n\f\n≥ct\n1\nn\n−\n1\n2\n\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\n\u0011\n≤ce\n−ct\n2\n1\n.\nOtherwise,","whent\n1\n>\n√\nn,","we","taket\n2\n=t\n1\nand","obtain\nP\n\u0010\n\f\n\f\nY−E[Y]\n\f\n\f\n≥ct\n2\n1\nn\n−1\n\u0000\n1","+σ\np\nkM\n†\nk\n2\n\u0001\n\u0011\n≤ce\n−ct\n2\n1\n.\nWe","then","finish","the","proof","by","combining","these","two","cases.\nWe","are","now","ready","to","prove","LemmaD.7.\nProof","of","Lemma\nD.7.Note","thatR\nρ\nn\n\u0000\b\nf∈","F\ns\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\n=R\nρ\nn\n\u0000\b\nf−f\n◦\n\f\n\f\nf∈","F\ns\n,kf−f\n◦\nk\n2\nρ\n≤\nr\n\t\u0001\n≤","R\nρ\nn\n\u0000\b\nf∈","F\n2s\n\f\n\f\nkfk\n2\nρ\n≤r\n\t\u0001\n.","Therefore,","we","can","easily","obtain","upper","bounds","forR\nρ\nn\n\u0000\b\nf∈","F\ns\n\f\n\f\nkf−f\n◦\nk\n2\nρ\n≤r\n\t\u0001\nby","analyzingR\nρ\nn\n\u0000\b\nf∈","F\ns\n\f\n\f\nkfk\n2\nρ\n≤r\n\t\u0001\n.","To","this","end,","in","the","following,","we","focus","on","the\nlocal","Rademacher","complexity\nR\nρ\nn\n\u0000\b\nf∈F\ns\n\f\n\f\nkfk\n2\nρ\n≤r\n\t\u0001\n.\nTo","simplify","the","notation,","we","writex:=","(s,a).","Note","that\nR\nρ\nn\n\u0000\b\nf∈F\ns\n\f\n\f\nkfk\n2\nρ\n≤r\n\t\u0001\n=Esup\n(\n1\nn\nK\nX\nk=1\nσ\nk\nf(x\nk\n)\n\f\n\f\n\f\n\f\nf∈F,kfk\n2\nρ\n≤r\n)\n=Esup\n(\n1\nn\nn\nX\nk=1\nσ\nk\nφ\nα\n(x\nk\n)\n⊤\nw\n\f\n\f\n\f\n\f\nα∈I,w∈R\ns\n,w\n⊤\nΣ\nα\nw≤r\n)\n.\nWe","fixα,{σ\nk\n}\nn\nk=1\nand{x\nk\n}\nn\nk=1\nand","then","optimizew∈R\ns\n.","","Sincex\nk\n∈supp(ρ),","one","always","has\n1\nn\nP\nK\nk=1\nσ\nk\nφ\nα\n(x\nk\n)∈range(Σ\nα\n)with","probability","one.","The","supremum","is","therefore","acheived","at\nw:=\n√\nrΣ\n†\nα\n\u0002\n1\nn\nP\nn\nk=1\nσ\nk\nφ\nα\n(x\nk\n)\n\u0003\n\r\n\r\n1\nn\nP\nn\nk=1\nσ\nk\nφ\nα\n(x\nk\n)\n\r\n\r\nΣ\n†\nα\n.\nIt","follows","that\nR\nρ\nn\n\u0000\b\nf∈F\ns\n\f\n\f\nkfk\n2\nρ\n≤r\n\t\u0001\n=\n√\nrEmax\nα∈I\nY\nα\n,whereY\nα\n:=\n\r\n\r\n\r\n\r\n\r\n1\nn\nn\nX\nk=1\nσ\nk\nφ\nα\n(x\nk\n)\n\r\n\r\n\r\n\r\n\r\nΣ\n†\nα\n.\nWe","further","upper","bound","the","local","Rademacher","complexity","by\nR\nρ\nn\n\u0000\b\nf∈F\ns\n\f\n\f\nkfk\n2\nρ\n≤r\n\t\u0001\n≤\n√\nr\n\u0012\nmax\nα∈I\nE[Y\nα\n]\n|\n{z}\nE\n1\n+E\nh\nmax\nα∈I\n\u0000\nY\nα\n−E[Y\nα\n]\n\u0001\ni\n|\n{z}\nE\n2\n\u0013\n.(62)\nIn","the","following,","we","estimate","the","two","terms","in","the","right","hand","side","of","eq.","(\n62)","separately.\n38\n\nDefineσ:=","(σ\n1\n,...,σ\nn\n)\n⊤\n∈R\nn\nandΦ\nα\n:=\n\u0002\nφ\nα\n(x\n1\n),...,φ\nα\n(x\nn\n)\n\u0003\n∈R\ns×n\n.","We","reformY\nα\nas\nY\nα\n=n\n−1\nkΦ\nα\nσk\nΣ\n†\nα\n.","It","follows","that\nE[Y\n2\nα\n]","=\n1\nn\n2\nE\n\u0002\nkΦ\nα\nσk\n2\nΣ\n†\nα\n\u0003\n=\n1\nn\n2\nE\n\u0002\n(Φ\nα\nσ)\n⊤\nΣ\n†\nα\n(Φ\nα\nσ)\n\u0003\n=\n1\nn\n2\nE\n\u0002\nTr(Σ\n†\nα\nΦ\nα\nσσ\n⊤\nΦ\n⊤\nα\n)\n\u0003\n.\nWe","use","the","relations\n1\nn\nE\n\u0002\nΦ\nα\nΦ\n⊤\nα\n\u0003\n=","Σ\nα\nandE[σσ\n⊤\n]","=I\ns\nwhereI\nr\nrepresents","the","identity","matrix","inR\ns×s\n.\nThe","inequality","above","is","then","reduced","to\nE[Y\nα\n]≤\np\nE[Y\n2\nα\n]≤\n1\n√\nn\np\nrank(Σ\nα\n)≤\nr\ns\nn\n.(63)\nTo","this","end,","we","haveE\n1\n≤\np\ns/n.\nNow","we","focus","onE\n2\n.","Sinceφ\nα\n(x)satisfiesT\n2\n\u0000\nσ(α)\n\u0001\n-inequality.","Applying","Lemma\nD.9,","we","find","that","if\nn≥s,\n\r\n\r\n|Y\nα\n−E[Y\nα\n]|1\n\b\n|Y\nα\n−E[Y\nα\n]|≤\n\u0000\n1","+σ(α)/σ\nmin\n(α)\n\u0001\t\n\r\n\r\nψ\n2\n≤\nc\n√\nn\n\u0012\n1","+\nσ(α)\nσ\nmin\n(α)\n\u0013\n≤\nc\n√\nn\n(1","+η\ns\n)\nand\n\r\n\r\n|Y\nα\n−E[Y\nα\n]|1\n\b\n|Y\nα\n−E[Y\nα\n]|>\n\u0000\n1+σ(α)/σ\nmin\n(α)\n\u0001\t\n\r\n\r\nψ\n1\n≤\nc\nn\n\u0012\n1+\nσ(α)\nσ\nmin\n(α)\n\u0013\n≤\nc\nn\n(1+η\ns\n).\nWe","further","use","Lemma\nD.9and","obtain\nEmax\nα∈I\n|Y\nα\n−E[Y\nα\n]|≤c(1","+η\ns\n)\n\u0010\nn\n−\n1\n2\np\nlog|I|+|I|e\n−cn\n\u0011\n≤c(1","+η\ns\n)\n\u0010\nn\n−\n1\n2\np\nslogd+","exp\n\u0000\n−cn+slogd\n\u0001\n\u0011\n.\nIfn≥c\n′\nslogdfor","some","sufficiently","large","constantc\n′\n,","then\nE\n2\n=Emax\nα∈I\n\f\n\f\nY\nα\n−E[Y\nα\n]\n\f\n\f\n≤c(1","+η\ns\n)\nr\nslogd\nn\n.(64)\nPlugging","eqs.","(\n63)","and","(64)","into","eq.","(62),","we","complete","our","proof.\nE","","Proof","of","Lower","Bound","(Theorem5.1)\nIn","this","section,","we","will","prove","a","stronger","version","of","Theorem\n5.1,","which","is","TheoremE.1.","In","TheoremE.1,\nwe","show","that","in","the","same","setting","as","Theorem\n5.1,","even","if","additionally","assuming","Assumption1holds","with\nC=","1,","i.e.,μ\nh\nis","the","true","marginal","distribution","of","the","single-action","MDP,and","the","algorithm","knows{μ\nh\n}\nH\nh=1\n,\nit","still","takesΩ(\n√\nS\nε\n2\n)samples","for","the","learning","algorithmAto","achieveεoptimality","gap","for","Bellman","error.","This\nfurther","justifies","the","necessity","of","Assumption\n2and","Assumption3in","the","single","sampling","regime.\nTheorem","5.1.LetAbe","an","arbitrary","algorithm","that","takes","any","datasetDand","function","classFas","input","and\noutputs","an","estimator\nˆ\nf∈","F.","For","anyS∈N\n+\nand","sample","sizen≥0,","there","exists","anS-state,","single-action\nMDP","paired","with","a","function","classFwith|F|=","2such","that","the\nˆ\nfoutput","by","algorithmAsatisfies\nEE(\nˆ\nf)≥min\nf∈F\nE(f)","+","Ω\n","\nmin\n(\n1,\nS\n1/2\nn\n)!\n.(6)\nHere,","the","expectation","is","taken","over","the","randomness","inD.\n39\n\nTheorem","E.1.For","anyε","<0.5andS≥2,","there","is","a","family","of","single-action,S+5-state","MDPs","(H=","3)","with\nthe","same","underlying","distributionsμ\nh\n(satisfying","Assumption\n1withC=","1)","and","the","same","reward","function\n(thus","the","MDPs","only","differ","in","probabiilty","transition","matrices)","and","a","function","classFof","size2,","such","that","all\nlearning","algorithmAthat","takesnpairs","of","states(s,a,r,s\n′\n)and","output","a","value","function","inFmust","suffer\nΩ(ε\n2\n)expected","optimality","gap","in","terms","of","mean-squared","bellman","error","w.r.tμifn=O(\n√\nS\nε\n2\n).\nMathematically,","it","means","for","any","learning","algorithmA,","there","is","a","single-action,S+5-state","MDP","defined\nabove,","such","that","forD=∪\nh\n{(s\ni\n,a\ni\n,r\ni\n,s\n′\ni\n,h)}\nn\ni=1\nsampled","fromMandμ,","ifn=O(\n√\nS\nε\n2\n),","we","have\nE\nD\n[E\nM\n(A(D))]≥min\nf∈F\nE\nM\n(f)","+","Ω(ε\n2\n).\nBelow","we","will","prove","Theorem\nE.1.","To","better","illustrate","the","idea","of","the","hard","instance,","we","will","first","prove\na","slightly","weaker","version","withC=","2(Theorem\nE.2)","in","AppendixE.1and","in","AppendixE.2we","will","prove\nTheorem\nE.1by","slightly","twisting","the","proof","in","AppendixE.1.\nE.1","","Warm-up","withC=","2\nWe","construct","the","hard","instances","for","single","sampling","in","the","following","way.\nHard","Instance","Construction:We","first","generate","a","uniform","random","bitc∈","{−1,1},","and","a","Radamacher\nvectorσ∈","{±1}\nS\n.","For","eachc,σ,","we","define","MDPM\nε\nc,σ\n=","(S,A,H,P\nε\nc,σ\n,r)below,","where0<","ε","<0,5.\nThe","claim","is","the","distribution","ofM\nε\nc,σ\nserves","as","the","distribution","of","hard","instances.","Note","that","onlyP\nε\nc,σ\nin","the\ntuple","definingM\nε\nc,σ\ndepends","oncandσ.","Here","the","probability","transition","matrixM\nε\nc,σ\nis","the","same","for","all\nh=","1,2,...",",H.\nLetS={s\nstart\n}∪{1,...,S}∪{t\nj,k\n}\nj,k∈{−1,1}\n,H=","2,|A|=","1and","the","initial","state","iss\nstart\n.","Since\nthere’s","only","one","action,","below","we","will","just","drop","the","dependence","on","action","and","thus","simplify","the","notation.\nWe","will","always","define","the","probability","transition","matrix","in","the","way","such","that","in","the2nd","step,","we","will","reach\nsome","state","among1,...,Sand","in","the3rd","step,","we","will","reach","some","state","amongt\nj,k\n.\nFunction","class:F={f\n1\n,f\n−1\n},","wheref\nc\n(s\nstart\n)","=\n1\n2\n,f\nc\n(i)","=\n1\n2\n,∀1≤i≤Sandf\nc\n(t\nj,k\n)","=\nkmax(c,j)+1\n2\n,\n∀c,j,k∈{±1}.","Compared","to","the","notation","in","the","main","paper,","we","drop","the","dependency","onhforf∈F.","This\nis","because","the","MDP","will","reach","a","disjoint","set","of","states","for","eachsteph(see","below).\nProbability","Transition","Matrix:We","define","the","probability","transition","matrix","below.","Specifically,","fori∈\n{1,...",",S}andj,k∈{±1},P\nε\nc,σ\n(t\nj,k\n|i)≡\nP\nε\nc,σ\ni\n(t\nj,k\n)",":=","0.25(1","+εkmax(−c,j)σ\ni\n).\nFrom\nTo\ns\nstart\ni(i=","1,...,S)t\nj,k\ns\nend\ns\nstart\n0\n1\nS\n00\ni(i=","1,...,S)00P\nε\nc,σ\ni\n(t\nj,k\n)",":=","0.25(1","+εkmax(−c,j)σ\ni\n)\n0\nt\nj,k\n0001\nTable","1:","Probability","Transition","MatrixP\nε\nc,σ\nfor","MDPM\nε\nc,σ\n.","Starting","froms\nstart\n,","the","process","terminates","as","it\nreachess\nend\nin","the4th","step.\n40\n\n(a)","Illustration","of","the3-stage,","single","action","MDP.","Each","state\ncan","be","visited","for","at","most","oneh=","1,2,3.ris","the","reward\nfor","each","state.(action","omitted","since","there’s","only","one)\n(b)","Illustration","off\n1\nandf\n−1\n.","They","only\ndiffer","ont\n−1,1\nandt\n−1,−1\n.","Forh=","3,","the\nBellman","errorkf\nc\n′\n−T\n3\nc,σ\nf\nc\n′\nk\n2\n2,μ\n3\n=","0.5,\nregardless","ofc\n′\nandc.\n(c)","Illustration","ofP\nε\n1,σ\ni\n.","Whenc=","1,","there","are","two","different","but","equally","likely","types\nof","statei,","depending","on","their","probability","transition","matrix","for","the","next","step.\n(d)","Illustration","ofP\nε\n−1,σ\ni\n.","Whenc=","1,","there","are","two","different","but","equally","likely","types\nof","statei,","depending","on","their","probability","transition","matrix","for","the","next","step.\nFigure","1:","Graphical","illustration","of","the","hard","instancesM\nε\nc,σ\n.","As","shown","in","Equation","(\n65),","the","total","Bellman\nerror","is","only","determined","by","the","Bellman","error","forh=","2,","which","is","equal","to","optimal","error","+\nε\n2\n12\n1[c6=c\n′\n]iff\nc\n′\nis","the","returned","function.","The","main","idea","of","the","proof","is","to","showit’s","difficult","to","guesscvia","the","observed","dataset\nDifDonly","contains","single-sampled","data.","As","a","sanity","check,","for","anycand","sample(i,t\nj,k\n),","ifσ\ni\nunif\n∼","{±1},\nthe","marginal","distribution","oft\nj,k\nis","always","uniform,","but","for","double","sampling","of","form(i,t\nj,k\n,t\nj\n′\n,k\n′\n),","we","can\ndecidecby","simply","looking","at","histogram","of(t\nj,k\n,t\nj\n′\n,k\n′\n).\n41\n\nReward","Function:r(s\nstart\n)","=","0,r(i)","=","0,∀1≤i≤S,r(t\nj,k\n)","=\nj+1\n2\n,∀j,k∈{−1,1}.\nUnderlying","distribution:We","define","the","underlying","distribution","for","batch","dataμasμ\n2\n(i)","=\n1\nS\nand\nμ\n3\n(t\nj,k\n)","=\n1\n4\n,","we","can","check","that","Assumption\n1is","satisfied","withC=","2asε","<0.5.","DefineT\n1\nc,σ\n,T\n2\nc,σ\n,T\n3\nc,σ\nbe\nthe","Bellman","operator","ofM\nε\nc,σ\n,","we","have∀σ∈{−1,1}\nS\n,∀c,c\n′\n∈{−1,1},\nkf\nc\n′\n−T\n3\nc,σ\nf\nc\n′\nk\n2\n2,μ\n3\n=kf\nc\n′\n−rk\n2\n2,μ\n3\n=\nP\n\u0002\nj6=kmax(c\n′\n,j)\n\u0003\n=","0.5,\nkf\nc\n′\n−T\n2\nc,σ\nf\nc\n′\nk\n2\n2,μ\n2\n=\n\r\n\r\n\r\n\r\n\r\nX\nj,k∈{±1}\nP\nc,σ\n(t\nj,k\n|i)f\nc\n′\n(t\nj,k\n)\n\r\n\r\n\r\n\r\n\r\n2\n2,μ\n2\n=\n1\n64\n\r\n\r\n\r\n\r\nX\nj,k\nεσ\ni\nk\n2\nmax(j,c)","max(j,−c\n′\n)\n\r\n\r\n\r\n\r\n2\n2,μ\n2\n=\nε\n2\n4\n1\n\u0002\nc6=c\n′\n\u0003\n,\nkf\nc\n′\n−T\n1\nc,σ\nf\nc\n′\nk\n2\n2,μ\n3\n=kf\nc\n(s\nstart\n)−f\nc\n(i)k\n2\n2,μ\n1\n=","0.\nThus\nE\nc,σ\n(f\nc\n′\n)≡E\nM\nc,σ\n(f\nc\n′\n)","=\n1\n3\n3\nX\nh=1\nkf\nc\n′\n−T\nh\nc,σ\nf\nc\n′\nk\n2\n2,μ\nh\n=\n1\n3\n(0.5","+\nε\n2\n4\n1\n\u0002\nc6=c\n′\n\u0003\n).(65)\nFrom","eq.","(\n65)","we","can","see","minimizing","Bellman","error","in","this","case","is","equivalent","to","predict−c.","And\nany","algorithm","predictscwrongly,","i.e.,","outputsf\nc\n′\nwithc\n′\n6=cwith","constant","probability,","will","sufferΩ(ε\n2\n)\nexpected","optimality","gap.","More","specifically,","we","can","show","thatfor","randomσ,","it’s","information-theoretically\nhard","to","predictccorrectly","givenD,","which","leads","to","the","following","theorem.\nTheorem","E.2.Forc\niid\n∼","{−1,1},σ\niid\n∼","{−1,1}\nS\n,D=∪\n3\nh=1\n{(s\ni\n,a\ni\n,r\ni\n,s\n′\ni\n,h)}\nn\ni=1\nsampled","fromM\nε\nc,σ\nand\nμ,","we","have","for","any","learning","algorithmAwithn=O(\n√\nS\nε\n2\n)samples,\nE\nc,σ\nE\nD\n[E\nc,σ\n(A(D))]≥E\nc,σ\n\u0014\nmin\nc\n′\n∈{−1,1}\nE\nc,σ\n(f\nc\n′\n)\n\u0015\n+","Ω(ε\n2\n).\nOr","equivalently","(and","more","specifically),","if","we","view\ne\nA(D)as","the","modified","version","ofA,","whose","range","is\n{−1,1}and","satisfiesA=f\nc\nwithc=\ne\nA(D).","Then","we","have\nE\nc,σ\nE\nD\nh\n1\nh\ne\nA(D)6=c\nii\n≥Ω(ε\n2\n).\nTowards","proving","Theorem\nE.2,","we","need","the","following","lower","bound,","whereμ\n2\n◦P\nε\nc,σ\nis","defined","as","the\njoint","distribution","of(s,s\n′\n),","wheres∼μ\n2\nands\n′\n∼P\nc,σ|s\n.","Note","that","whenε=","0,P\n0\nc,σ\n(·","|i)becomes\nuniform","distribution","for","every1≤i≤S,","and","thus","is","independent","ofc,σ,","which","could","be","denoted","byP\n0\ntherefore.\nLemma","E.3.Ifn≤0.1\nS\n0.5\nε\n2\n,","thenkE\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n−\n\u0000\nμ\n2\n◦P\n0\n\u0001\nn\nk\nTV\n≤0.1,","for","allc∈{−1,1}.\nProof.For","convenience,","we","denote\n\u0000\nμ\n2\n◦P\n0\n\u0001\nn\nbyPandE\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\nbyQ.","By","Pinsker’s","inequality,\nwe","havekP−Qk\nTV\n≤\np\n2KL(P,Q),","for","any","distributionP,Q.","Thus","it","suffices","to","upper","boundKL(P,Q)\nby0.05.\n42\n\nWe","defineE\ni\nas","a","random","subset,","i.e.,E\ni\n={l|1≤l≤n,s\nl\n=i},","givenD={(s\ni\n,s\n′\ni\n)}\nn\ni=1\n.","Then","for\nbothE\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\nand\n\u0000\nμ\n2\n◦P\n0\n\u0001\nn\n,s\n1\n,...,s\nn\nare","i.i.d.","distributed","byμ\n2\n.","Note","that\nQ(s\n′\n1\n,...,s\n′\nn\n|s\n1\n,...,s\nn\n)\n=\nX\nσ∈{−1,1}\nS\np(σ)Q(s\n′\n1\n,...,s\n′\nn\n|s\n1\n,...,s\nn\n,σ)\n=\nX\nσ∈{−1,1}\nS\nS\nY\ni=1\np(σ\ni\n)\nS\nY\ni=1\nQ(s\n′\nE\ni\n|E\ni\n,σ\ni\n)\n=\nS\nY\ni=1\n\n\nX\nσ\ni\n∈{−1,1}\np(σ\ni\n)Q(s\n′\nE\ni\n|E\ni\n,σ\ni\n)\n\n\n,\n(66)\nand\nP(s\n′\n1\n,...,s\n′\nn\n|s\n1\n,...,s\nn\n)","=\nS\nY\ni=1\nP(s\n′\nE\ni\n|E\ni\n).\n(67)\nFor","any","tuple(s\n1\n,...,s\nn\n)and","subsetE⊂","{1,...",",n},","we","defines\nE\nas","the","sub-tuple","ofswith","length\n|E|selected","byE.","DefineP\nE\ni\n,Q\nE\ni\nas","the","distribution","ofs\n′\nE\ni\nconditioned","onE\ni\n.","In","detail,Q\nE\ni\n(s\n′\nE\ni\n)","=\nP\nσ\ni\n∈{−1,1}\np(σ\ni\n)Q(s\n′\nE\ni\n|E\ni\n,σ\ni\n)andP\nE\ni\n(s\n′\nE\ni\n)","=P(s\n′\nE\ni\n|E\ni\n).","Note","that","forQ,s\n′\nE\ni\nare","i.i.d.","conditioned","onE\ni\nandσ\ni\n,","i,.e.,Q(s\n′\nE\ni\n|E\ni\n,σ\ni\n)","=\nQ\nl∈E\ni\nP\nε\nc,σ\ni\n(s\n′\nl\n).","Therefore","the","distributionQ\nE\ni\nonly","depends","on|E\ni\n|,","so","does\nP\nE\ni\n.\nThus","we","can","write","the","KL","divergence","as:\nKL\n\u0000\u0000\nμ\n2\n◦P\n0\n\u0001\nn\n,E\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n\u0001\n=KL(P,Q)","=\nE\nD∼P\n\u0014\nlog\nP(D)\nQ(D)\n\u0015\n=\nE\nD∼P\n\u0014\nlog\nP(s\n′\n1\n,...,s\n′\nn\n|s\n1\n,...,s\nn\n)\nQ(s\n′\n1\n,...,s\n′\nn\n|s\n1\n,...,s\nn\n)\n+","log\nP(s\n1\n,...,s\nn\n)\nQ(s\n1\n,...,s\nn\n)\n\u0015\n=\nE\nD∼P\n\"\nlog\nQ\nS\ni=1\nP(s\n′\nE\ni\n|E\ni\n)\nQ\nS\ni=1\nQ(s\n′\nE\ni\n|E\ni\n)\n+","log\nP(s\n1\n,...,s\nn\n)\nQ(s\n1\n,...,s\nn\n)\n#\n(P(s\n1\n,...,s\nn\n)","=Q(s\n1\n,...,s\nn\n))\n=\nE\nD∼P\n\"\nS\nX\ni=1\nlog\nP\nE\ni\n(s\n′\nE\ni\n)\nQ\nE\ni\n(s\n′\nE\ni\n)\n#\n=\nS\nX\ni=1\nE\nD∼P\n\"\nlog\nP\nE\ni\n(s\n′\nE\ni\n)\nQ\nE\ni\n(s\n′\nE\ni\n)\n#\n.\n(68)\nBy","the","definition","ofPandQ,","givenc∈","±1andε",">0,","we","can","see","that\nE\nD∼P\n\u0014\nlog\nP\nE\ni\n(s\n′\nE\ni\n)\nQ\nE\ni\n(s\n′\nE\ni\n)\n\u0015\nonly","a\nfunction","of|E\ni\n|,","and","we","denote","it","byG\nc,ε\n(|E\ni\n|).","Thus","we","have\n43\n\nKL\n\u0000\u0000\nμ\n2\n◦P\n0\n\u0001\nn\n,E\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n\u0001\n=KL(P,Q)\n=\nS\nX\ni=1\nn\nX\nm=0\nE\nD∼P\n\"\nS\nX\ni=1\nlog\nP\nE\ni\n(s\n′\nE\ni\n)\nQ\nE\ni\n(s\n′\nE\ni\n)\n\f\n\f\n\f\n\f\n\f\n|E\ni\n|=m\n#\nP(|E\ni\n|=m)\n=\nS\nX\ni=1\nn\nX\nm=0\nG\nc,ε\n(m)P(|E\ni\n|=m)\n=S\nn\nX\nm=0\nG\nc,ε\n(m)P(|E\n1\n|=m).\n(69)\nThe","last","step","is","becauseE\ni\nare","i.i.d.","distributed.","For","convenience,","we","will","denoteP(|E\n1\n|=m)by\nP\nN\n(m).\nIt","can","be","shown","thatG\nc,ε\n(m)is","independent","ofc,","and","thus","we","dropcin","the","subscription.","We","could","even\nsimplify","the","expression","ofG\nε\n(m)by","definingR\nσ,ε\n(j)","=","0.5(1","+jσε)over{−1,1}(Forc=","1,","this","is\neffectively","grouping(t\n1,1\n,t\n−1,−1\n)into","a","state,","say1,","and(t\n1,−1\n,t\n−1,1\n)into","another","state,","say−1.)\nG\nε\n(m)","=KL\n","\n(Unif{−1,1})\nm\n,\n\u0000\nR\n′\n−1,ε\n\u0001\nm\n+\n\u0000\nR\n′\n1,ε\n\u0001\nm\n2\n!\n.\nBelow","are","some","basic","properties","ofG\nε\n(m).\n•G\nε\n(0)","=","0.\n•G\nε\n(1)","=","0.\n•G\nε\n(m)≤\n6m\n2\n+m\n8\nε\n4\n+\nm\n2\nε\n4\n1−ε\n2\n≤2mε\n4\n,","forε\n2\n≤\n1\n2\n.\nThe","first","two","properties","can","be","verified","by","direct","calculation,","and","the","third","property","is","proved","in","Lemma\nE.4.\nNow","it","remains","to","calculateP\nN\n(1)and\nE\nP\n\u0002\n|E\n1\n|\n2\n\u0003\n.","We","have\nP\nN\n(1)","=n\n1\nS\n(1−\n1\nS\n)\nn−1\n≤\nn\nS\n(1−\nn\nS\n),\nand\nE\nP\n\u0002\n|E\n1\n|\n2\n\u0003\n=\nE\nP\n\"\n(\nX\ni=1\nn\n1[s\ni\n=","1])\n2\n#\n=\nE\nP\n\n\nn\nX\ni=1\n1[s\ni\n=","1]","+\nn\nX\ni,j=1,ı6=j\n1[s\ni\n=s\nj\n=","1]\n\n\n=\nn\nS\n+\nn(n−1)\nS\n2\n.\nThus","we","conclude","that\nKL(P,Q)","=S\nn\nX\nm=2\nP\nN\n(m)G\nε\n(m)≤S\nn\nX\nm=2\nP\nN\n(m)·2m\n2\nε\n4\n=","2\n\u0000\nn\nX\nm=2\nP\nN\n(m)m\n2\n\u0001\nSε\n4\n=2\n\u0012\nE\nP\n\u0002\n|E\n1\n|\n2\n\u0003\n−P\nN\n(1)\n\u0013\nSε\n4\n=","2\n\u0012\nn(n−1)\nS\n2\n+\nn\n2\nS\n2\n\u0013\nSε\n4\n≤\n4n\n2\nε\n4\nS\n.\nSincen≤0.1\nS\n0.5\nε\n2\n,","we","havekP−Qk\nTV\n≤\np\n2KL(P,Q)≤\n√\n0.08≤0.1,","which","completes","the\nproof.\n44\n\nLemma","E.4.Forε\n2\n≤\n1\n2\n,","we","have\nG\nε\n(m)≤\n6m\n2\n+m\n8\nε\n4\n+\nm\n2\nε\n4\n1−ε\n2\n≤2m\n2\nε\n4\n.\nProof","of","Lemma\nE.4.Letx\n1\n,...,x\nn\ni.i.d.\n∼","{−1,1},","we","have\nG\nε\n(m)","=−\nE\nx\n\"\nlog\n","\nm\nY\ni=1\n(1−x\ni\nε)","+\nm\nY\ni=1\n(1","+x\ni\nε)\n!#\n.\nFor","convenience,","we","define|x|:=|\nP\nm\ni=1\nx\ni\n|.","Note","that\nm\nY\ni=1\n(1−x\ni\nε)","+\nm\nY\ni=1\n(1","+x\ni\nε)","=\n\u0010\n(1−ε)\n|x|\n+","(1","+ε)\n|x|\n\u0011\n(1−ε\n2\n)\nm−|x|\n2\n.\nThus\nG\nε\n(m)","=−\nE\nx\nh\nlog\n\u0010\n(1−ε)\n|x|\n+","(1","+ε)\n|x|\n\u0011i\n−\nm−|x|\n2\nE\nx\n\u0002\nlog(1−ε\n2\n)\n\u0003\n.\nFor","the","first","term,","we","have\n−\nE\nx\nh\nlog\n\u0010\n(1−ε)\n|x|\n+","(1","+ε)\n|x|\n\u0011i\n≤−\nE\nx\n\u0014\nlog\n\u0012\n1","+\n|x|(|x|−1)\n2\nε\n2\n\u0013\u0015\n≤\nE\nx\n\"\n−\n|x|(|x|−1)\n2\nε\n2\n+\n1\n2\n\u0012\n|x|(|x|−1)\n2\nε\n2\n\u0013\n2\n#\n≤\nE\nx\n\u0014\n−\n|x|(|x|−1)\n2\nε\n2\n+\n|x|\n4\n8\nε\n4\n\u0015\n=−\nm\n2\nε\n2\n+\nE\nx\n\u0014\n|x|\n2\n\u0015\nε\n2\n+\n6m\n2\n+m\n8\nε\n4\n.\nFor","the","second","term,","we","have\n−\nE\nx\n\u0002\nlog(1−ε\n2\n)\n\u0003\n=\nE\nx\n\u0014\nlog(1","+\nε\n2\n1−ε\n2\n)\n\u0015\n≤\nε\n2\n1−ε\n2\n=ε\n2\n+\nε\n4\n1−ε\n2\n.\nThusG\nε\n(m)only","containsε\n4\nterms,","i.e.,\nG\nε\n(m)≤\n6m\n2\n+m\n8\nε\n4\n+\nm\n2\nε\n4\n1−ε\n2\n≤2m\n2\nε\n4\n,\nthe","last","step","is","by","assumptionε\n2\n≤\n1\n2\n.\nProof","of","TheoremE.2.In","our","case,","sinceris","known","and|A|=","1,","we","can","simplify","the","each","data","inD\ninto","the","form","of(s,s\n′\n,h).","Further","since","the","probability","transition","matrix","forh=","1andh=","3are","known,\nbelow","we","will","assumeDonly","containsnpairs","of(s,s\n′\n,2),","and","we","will","call","these","states","by{s\ni\n}\nn\ni=1\nand\n45\n\n{s\n′\ni\n}\nn\ni=1\n.","Sincekf\nc\n′\n−T\n3\nc,σ\nf\nc\n′\nk\n1\n2,μ\n2\nandkf\nc\n′\n−T\n3\nc,σ\nf\nc\n′\nk\n1\n2,μ\n2\nare","constant","for","allc,c\n′\n,","we","only","need","to","consider\nkf\nc\n′\n−T\n2\nc,σ\nf\nc\n′\nk\n2\n2,μ\n3\nas","our","loss.\nRecall","we","defineμ\n2\n◦P\nε\nc,σ\nas","the","joint","distribution","of(s,s\n′\n),","wheres∼μ\n2\nands\n′\n∼P\nc,σ|s\n.","Thus","the\ndatasetDcan","be","viewed","as","sampled","fromE\nc,σ\n(μ\n2\n◦P\nc,σ\n)\nn\n,","i.e.,Dis","sampled","from","a","mixture","of","product\nmeasures.\nBy","Lemma\nE.3,","we","know\n\r\n\r\nE\nσ\n\u0000\nμ\n2\n◦P\nε\n1,σ\n\u0001\nn\n−E\nσ\n\u0000\nμ\n2\n◦P\nε\n−1,σ\n\u0001\nn\n\r\n\r\nTV\n≤\n\r\n\r\nE\nσ\n\u0000\nμ\n2\n◦P\nε\n1,σ\n\u0001\nn\n−E\nσ\n\u0000\nμ\n2\n◦P\n0\n\u0001\nn\n\r\n\r\nTV\n+\n\r\n\r\nE\nσ\n\u0000\nμ\n2\n◦P\nε\n−1,σ\n\u0001\nn\n−E\nσ\n\u0000\nμ\n2\n◦P\n0\n\u0001\nn\n\r\n\r\nTV\n≤0.2.\nThus","if","we","denote","the","distribution","ofwidetildeA(D)byX\nc\n,","whereD∼E\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\nandσ∼\n{−1,1}\nS\n,","and\ne\nAcan","be","random,","the","above","inequality","implies\nP\n[X\n−1\n6=X\n1\n]≤0.2,","and","therefore","we","have\nE\nc,σ\nE\nD\n[E\nc,σ\n(A(D))]","=\n1\n2\n(E\nσ,D\n[E\n1,σ\n(A(D))]","+E\nσ,D\n[E\n−1,σ\n(A(D))])\n=\n1\n6\n+\nε\n2\n24\n(\nP\n[X\n1\n6=","1]","+\nP\n[X\n−1\n6=−1])\n=\n1\n6\n+\nε\n2\n24\n(\nP\n[X\n1\n6=","1]","+\nP\n[X\n−1\n6=−1]","+\nP\n[X\n1\n6=X\n−1\n])−\nε\n2\n24\nP\n[X\n1\n6=X\n−1\n]\n≥\n1\n6\n+\nε\n2\n24\n−\nε\n2\n24\nP\n[X\n1\n6=X\n−1\n]\n≥\n1\n6\n+\nε\n2\n24\n−\nε\n2\n24\n×0.2\n=\n1\n6\n+\nε\n2\n30\n=E\nc,σ\n\u0014\nmin\nc\n′\n∈{−1,1}\nE\nc,σ\n(f\nc\n′\n)\n\u0015\n+\nε\n2\n30\n.\n(70)\nE.2","","Proof","of","TheoremE.1\nNow","we","will","prove","TheoremE.1by","slightly","twisting","the","distribution","of","hard","instances","(MDPs)","constructed\nin","the","previous","subsection.\nProof","of","TheoremE.1.W.O.L.G,","we","can","assumeSis","even","andS=","2S\n′\n(o.w.","we","can","just","abandon","one\nstate.)","The","only","modification","from","the","previous","lower","bound","withC=","2is","now","the","distribution","ofσis\ndefined","as","the","conditional","distribution","ofPon\nP\nS\ni=1\n=","0,","i.e.,P\n′\n(σ)","=P(σ|\nP\nS\ni=1\nσ\ni\n=","0),","wherePis\nthe","uniform","distribution","on{−1,1}\nS\n.","The","main","idea","is","that","the","data","distribution","(i.e.,","distribution","of(s,s\n′\n))\nshouldn’t","be","very","different","even","if","we","add","this","additional","‘balancedness’","restriction.","We","further","define","a\nmetricdon{−1,1}\nS\n.","In","detail,","forσ,σ\n′\n∈","{−1,1}\nd\n,","we","defined(σ,σ\n′\n)","=\n∑\nS\ni=1\n|σ\ni\n−σ\n′\ni\n|\n2S\n.","We","have","the\nfollowing","lemma:\n46\n\nLemma","E.5.\nW\nd\n1\n(P,P\n′\n)","=\n1\n2S\nE\nP\n\f\n\f\n\f\n\f\n\f\nS\nX\ni=1\nσ\ni\n\f\n\f\n\f\n\f\n\f\n,(71)\nwhereW\nd\n1\n(P,P\n′\n)is","defined","asmin\nσ∼P,σ\n′\n∼P\n′\nE[d(σ,σ\n′\n)].\nBy","Cauchy","Inequality,","we","have\nW\nd\n1\n(P,P\n′\n)","=\n1\n2S\nE\nP\n\f\n\f\n\f\n\f\n\f\nS\nX\ni=1\nσ\ni\n\f\n\f\n\f\n\f\n\f\n≤\n1\n2S\nv\nu\nu\nt\nE\nP\n","\nS\nX\ni=1\nσ\ni\n!\n2\n=\n1\n2\n√\nS\n(72)\nProof.For","evenS,","we","defineBas","the","set","of","the","“balanced”σ,","i.e.,B={σ|\nP\nS\ni=1\nσ\n′\ni\n=","0}.","For","every\nσ∈","{−1,1}\nS\n,","we","defineQ\nσ\nas","the","uniform","distribution","onU\nσ\n={σ\n′\n|d(σ,σ\n′\n)","=\n|\n∑\nS\ni=1\nσ\ni\n|\n2S\n}∩B,","i.e.\nσ\n′\n∈U\nσ\nif","and","only","ifσ\n′\n∈Bandd(σ,σ\n′\n)","=","min\nσ\n′\n∈B\nd(σ,σ\n′\n).\nNow","we","defineΓ(σ,σ\n′\n)","=P(σ)Q\nσ\n(σ\n′\n).","By","definition","the","marginal","distribution","ofΓonσisP.","By\nsymmetry,","the","marginal","distribution","ofσ\n′\nisP\n′\n.","Thus","by","definition","ofW\n1\n,\nW\nd\n1\n(P,P\n′\n)≤\nE\nσ,σ\n′\n∼Γ\n\u0002\nd(σ,σ\n′\n)\n\u0003\n=\n1\n2S\nE\nP\n\f\n\f\n\f\n\f\n\f\nS\nX\ni=1\nσ\ni\n\f\n\f\n\f\n\f\n\f\n.\nLemma","E.6.\n\r\n\r\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n−\n\u0000\nμ\n2\n◦P\nε\nc,σ\n′\n\u0001\nn\n\r\n\r\nTV\n≤Cε\np\nnd(σ,σ\n′\n).(73)\nProof.First,","note","that\nKL\n\u0000\nμ\n2\n◦P\nε\nc,σ\n,μ\n2\n◦P\nε\nc,σ\n′\n\u0001\n=KL(μ\n2\n,μ\n2\n)","+\nE\ni∼μ\n2\n\u0002\nKL\n\u0000\nP\nε\nc,σ\n(·|i),P\nε\nc,σ\n′\n(·|i)\n\u0001\u0003\n=0","+\nE\ni∼μ\n2\nh\nKL\n\u0010\nP\nε\nc,σ\ni\n,P\nε\nc,σ\n′\ni\n\u0011i\n=\nP\ni∼μ\n2\n\u0002\nσ\ni\n6=σ\n′\ni\n\u0003\n·\n\u0012\n1","+ε\n2\nlog\n1","+ε\n1−ε\n+\n1−ε\n2\nlog\n1−ε\n1","+ε\n\u0013\n=\nP\ni∼μ\n2\n\u0002\nσ\ni\n6=σ\n′\ni\n\u0003\n·εlog\n1","+ε\n1−ε\n=\nP\ni∼μ\n2\n\u0002\nσ\ni\n6=σ\n′\ni\n\u0003\n·\n2ε\n2\n1−ε\n≤4d(σ,σ\n′\n)ε\n2\n.\n(74)\nThus","we","have\n\r\n\r\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n−\n\u0000\nμ\n2\n◦P\nε\nc,σ\n′\n\u0001\nn\n\r\n\r\nTV\n≤\nr\n2KL\n\u0010\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n,\n\u0010\nμ\n2\n◦P\nε\nc,σ\n′\n\u0011\nn\n\u0011\n≤\nr\n2nKL\n\u0010\nμ\n2\n◦P\nε\nc,σ\n,μ\n2\n◦P\nε\nc,σ\n′\n\u0011\n≤ε\np\n8md(σ,σ\n′\n).\n(75)\n47\n\nLetΓ(σ,σ\n′\n)be","the","joint","probabilistic","distribution","on{−1,1}\nS\n×{−1,1}\nS\nwhich","attains","the","eq.","(71).\nTherefore","the","marginal","distribution","ofΓisPandP\n′\n.","And","thus","we","have","for","anyc∈{−1,1},\nk\nE\nσ∼P\n\u0002\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n\u0003\n−\nE\nσ∼P\n′\n\u0002\u0000\nμ\n2\n◦P\nε\nc,σ\n′\n\u0001\nn\n\u0003\nk\nTV\n≤\nE\nσ,σ\n′\n∼Γ\n\u0002\nk\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n−\n\u0000\nμ\n2\n◦P\nε\nc,σ\n′\n\u0001\nn\nk\nTV\n\u0003\n≤\nE\nσ,σ\n′\n∼Γ\nh\nε\np\n8nd(σ,σ\n′\n)\ni\n≤ε\nr\nn\nE\nσ,σ\n′\n∼Γ\n[8d(σ,σ\n′\n)]\n=ε\nq\n8nW\nd\n1\n(P,P\n′\n)\n≤2εn\n0.5\nS\n−0.25\n.\n(76)\nTherefore,","whenn≤\n√\nS\n400ε\n2\n,","for","anyc∈{−1,1},\nk\nE\nσ∼P\n\u0002\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n\u0003\n−\nE\nσ∼P\n′\n\u0002\u0000\nμ\n2\n◦P\nε\nc,σ\n′\n\u0001\nn\n\u0003\nk\nTV\n≤0.1.\nBy","Lemma\nE.3,","we","have\nk\nE\nσ∼P\n′\n\u0002\u0000\nμ\n2\n◦P\nε\n1,σ\n′\n\u0001\nn\n\u0003\n−\nE\nσ∼P\n′\n\u0002\u0000\nμ\n2\n◦P\nε\n−1,σ\n′\n\u0001\nn\n\u0003\nk\nTV\n≤0.1","+","0.1","+","0.1","+","0.1","=","0.4.\nThus","using","the","same","argument","in","eq.","(\n70),","In","detail,","denote","the","distribution","ofA(D)byX\nc\n,","where\nD∼E\nσ\n\u0000\nμ\n2\n◦P\nε\nc,σ\n\u0001\nn\n,σ∼{−1,1}\nS\n,","the","above","inequality","implies\nP\n[X\n−1\n6=X\n1\n]≤0.4,","and","therefore","we\nhave\nE\nc,σ\nE\nD\n[E\nc,σ\n(A(D))]","=\n1\n2\n(E\nσ,D\n[E\n1,σ\n(A(D))]","+E\nσ,D\n[E\n−1,σ\n(A(D))])\n=\n1\n6\n+\nε\n2\n24\n(\nP\n[X\n1\n6=","1]","+\nP\n[X\n−1\n6=−1])\n=\n1\n6\n+\nε\n2\n24\n(\nP\n[X\n1\n6=","1]","+\nP\n[X\n−1\n6=−1]","+\nP\n[X\n1\n6=X\n−1\n])−\nε\n2\n24\nP\n[X\n1\n6=X\n−1\n]\n≥\n1\n6\n+\nε\n2\n24\n−\nε\n2\n24\n×0.4\n=\n1\n6\n+\n1\n40\nε\n2\n=E\nc,σ\n\u0014\nmin\nc\n′\n∈{−1,1}\nE\nc,σ\n(f\nc\n′\n)\n\u0015\n+\nε\n2\n40\n.\n(77)\n48\n\nF","","Auxiliary","Results\nIn","this","section,","we","prove","some","auxiliary","lemmas.","Appendix\nF.1considers","the","relation","between","Bellman","error\nand","suboptimality","in","values","(Lemma\n3.2).","AppendixF.2provides","a","supporting","lemma","used","in","the","proof","of\nTheorem\n5.5.","AppendixF.3presents","a","full","version","of","Proposition5.6.\nF.1","","Connections","between","Bellman","error","and","suboptimality","invalue","(Lemma\n3.2)\nIn","this","part,","we","present","several","possible","ways","to","connect","Bellman","errorE(f)with","the","suboptimality","gap\nV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n).\nVia","concentrability","coefficient\nLemma","3.2(Bellman","error","to","value","suboptimality).Under","Assumption\n1,","for","anyf∈F,","we","have","that",",\nV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n)≤2H\np\nC·E(f),(3)\nwhereCis","the","concentrability","coefficient","in","Assumption\n1.\nLemma\n3.2gives","a","feasible","method","to","upper","boundV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n)withE(f)using","the","concentra-\nbility","coefficient","introduced","in","Assumption\n1.","We","provide","the","proof","of","Lemma3.2below.\nProof","of","Lemma\n3.2.The","proof","of","Lemma3.2is","analogous","to","Theorem","2","inXie","and","Jiang[2020b].","We\nplace","it","here","for","the","self-containedness","of","our","paper.","In","discussions","below,","we","omit","the","subscripthin","policy\nπ\nf\nh\nand","simply","writeπ\nf\nto","ease","the","notation.","We","first","note","that","sinceπ\nf\nis","greedy","w.r.tf,","therefore,\nV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n)≤V\n⋆\n1\n(s\n1\n)−f\n1\n\u0000\ns\n1\n,π\n⋆\n(s\n1\n)\n\u0001\n+f\n1\n\u0000\ns\n1\n,π\nf\n(s\n1\n)\n\u0001\n−V\nπ\nf\n1\n(s\n1\n).(78)\nConsider","any","policyπ.","Sincef\nH+1\n=","0andV\nπ\n1\n(s\n1\n)","=E\n\u0002\nP\nH\nh=1\nr\nh\n\f\n\f\ns\n1\n,π\n\u0003\nby","definition,","we","have\nf\n1\n\u0000\ns\n1\n,π(s\n1\n)\n\u0001\n−V\nπ\n1\n(s\n1\n)","=E\n\"\nH\nX\nh=1\n\u0010\nf\nh\n(s\nh\n,a\nh\n)−E\nπ\nh\n\u0002\nr\nh\n+f\nh+1\n\u0000\ns\nh+1\n,a\nh+1\n\u0001\n\f\n\f\ns\nh\n,a\nh\n\u0003\n\u0011\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\n#\n.\nTherefore,","combined","with","the","factπ\nf\nis","the","greedy","policy","w.r.t.f,","we","can","show","that\nf\n1\n\u0000\ns\n1\n,π\n⋆\n(s\n1\n)\n\u0001\n−V\n⋆\n1\n(s\n1\n)≥E\n\"\nH\nX\nh=1\n\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n(s\nh\n,a\nh\n)\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\n⋆\n#\n,(79)\nf\n1\n(s\n1\n,π\nf\n(s\n1\n))−V\nπ\nf\n1\n(s\n1\n)","=E\n\"\nH\nX\nh=1\n\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n(s\nh\n,a\nh\n)\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\nf\n#\n.(80)\nPlugging","eqs.","(\n79)","and","(80)","into","eq.","(78)","yields\nV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n)≤−E\n\"\nH\nX\nh=1\n\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n(s\nh\n,a\nh\n)\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\n⋆\n#\n+E\n\"\nH\nX\nh=1\n\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n(s\nh\n,a\nh\n)\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\nf\n#\n.\n49\n\nUnder","Assumption1,","by","Cauchy-Swartz","inequality,","it","holds","that","for","any","policyπ:\n\f\n\f\n\f\n\f\n\f\nE\n\"\nH\nX\nh=1\n\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n(s\nh\n,a\nh\n)\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\n#\n\f\n\f\n\f\n\f\n\f\n≤\nv\nu\nu\nt\nH\nH\nX\nh=1\nE\n\"\n\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n2\n(s\nh\n,a\nh\n)\n\f\n\f\n\f\n\f\n\f\ns\n1\n,π\n#\n≤\n√\nCH\nv\nu\nu\nt\n1\nH\nH\nX\nh=1\n\r\n\r\nf\nh\n−T\n⋆\nh\nf\nh+1\n\r\n\r\n2\nμ\nh\n,\nwhich","finishes","the","proof.\nVia","a","weaker","concentrability","assumptionWe","observe","that","Lemma3.2does","not","necessarily","need","an\nassumption","as","strong","as","Assumption\n1.","In","fact,","the","inequalityV\n⋆\n1\n(s\n1\n)−V\nπ\nf\n1\n(s\n1\n)≤2H\np\nC·E(f)still\nholds","if\nE\n\u0002\u0000\nf\nh\n−T\n⋆\nh\nf\nh+1\n\u0001\n(s\nh\n,a\nh\n)\n\f\n\f\ns\n1\n,π\n\u0003\n≤\n√\nC\n\r\n\r\nf\nh\n−T\n⋆\nh\nf\nh+1\n\r\n\r\nμ\nh\nforπ=π\n⋆\norπ=π\nf\nforf∈F.(81)\nIf","the","function","classFandT\n⋆\nF=\n\b\nT\n⋆\nf=","(T\n⋆\n1\nf\n2\n,...,T\n⋆\nH\nf\nH+1\n)\n\f\n\f\nf∈","F\n\t\nhave","good","structures,\nwe","may","have","a","tighter","estimate","of","the","requiredC.","For","illustrative","purpose,","we","take","a","simple","example\nwhereF\nh\nis","a","subset","of","a","finite","dimensional","linear","space","andT\n⋆\nh\nf\nh+1\n∈","F\nh\nfor","anyf\nh+1\n∈","F\nh+1\n.","Let\nφ:S","×","A","→R\nd\nbe","a","basis","ofF\nh\nwithkφ(s,a)k\n2\n≤1.","DefineΣ\nh\n:=E\nμ\nh\n[φφ\n⊤\n]∈R\nd×d\n.","For","any\nf=w\n⊤\nφ∈","F\nh\n,kfk\n∞\n≤","kwk\n2\n≤","kΣ\n1\n2\nh\nwk\n2\np\n1/λ\nmin\n(Σ\nh\n)","=kfk\nμ\nh\np\n1/λ\nmin\n(Σ\nh\n).","Therefore,","eq.","(81)\nholds","forC=","max\nh∈[H]\n{1/λ\nmin\n(Σ\nh\n)}.\nF.2","","Proof","of","Supporting","Lemmas","in","Minimax","Algorithm","Analysis\nLemma","F.1.Suppose","Assumption\n4holds.","Denotef\n†\n:=","min\nf∈F\nE(f).","Forh∈[H],","it","holds","that\n\r\n\r\nf\nh\n−f\n†\nh\n\r\n\r\n2\nρ\nh\n≤\ne\nCH(H−h+","1)\n\r\n\r\n\u0000\nf−T\n⋆\nf\n\u0001\n−\n\u0000\nf\n†\n−T\n⋆\nf\n†\n\u0001\n\r\n\r\n2\nμ\nforρ\nh\n=μ\nh\norν\nh\n×Unif(A),(82)\nand\n\r\n\r\nT\n⋆\nh\nf\nh+1\n−T\n⋆\nh\nf\n†\nh+1\n\r\n\r\n2\nμ\nh\n≤\ne\nCH(H−h)\n\r\n\r\n\u0000\nf−T\n⋆\nf\n\u0001\n−\n\u0000\nf\n†\n−T\n⋆\nf\n†\n\u0001\n\r\n\r\n2\nμ\n.(83)\nProof.1.","Letπ\nf\nbe","the","greedy","policy","associated","withf∈F.","Sincef\nH+1\n=f\n†\nH+1\n=","0,","we","have\nf\nh\n(s,a)−f\n†\nh\n(s,a)","=E\n\"\nH\nX\nτ=h\n\u0014\n\u0010\nf\nτ\n\u0000\ns\nτ\n,a\nτ\n\u0001\n−E\n\u0002\nr\nτ\n+f\nτ+1\n\u0000\ns\nτ+1\n,a\nτ+1\n\u0001\n\f\n\f\ns\nτ\n,a\nτ\n\u0003\n\u0011\n−\n\u0010\nf\n†\nτ\n\u0000\ns\nτ\n,a\nτ\n\u0001\n−E\n\u0002\nr\nτ\n+f\n†\nτ+1\n\u0000\ns\nτ+1\n,a\nτ+1\n\u0001\n\f\n\f\ns\nτ\n,a\nτ\n\u0003\n\u0011\n\u0015\n\f\n\f\n\f\n\f\n\f\ns\nh\n=s,a\nh\n=a,π\nf\n#\n.\n(84)\nNote","that\nE\n\u0002\nr\nτ\n+f\nτ+1\n\u0000\ns\nτ+1\n,π\nf\nτ+1\n(s\nτ+1\n)\n\u0001\n\f\n\f\ns\nτ\n,a\nτ\n\u0003\n=T\n⋆\nτ\nf\nτ+1\n(s\nτ\n,a\nτ\n),\nE\n\u0002\nr\nτ\n+f\n†\nτ+1\n\u0000\ns\nτ+1\n,π\nf\nτ+1\n(s\nτ+1\n)\n\u0001\n\f\n\f\ns\nτ\n,a\nτ\n\u0003\n≤T\n⋆\nτ\nf\n†\nτ+1\n(s\nτ\n,a\nτ\n).\n(85)\nCombining","eqs.","(\n84)","and","(85),","we","learn","that\nf\nh\n(s,a)−f\n†\nh\n(s,a)≤E\n\"\nH\nX\nτ=h\nh\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\ni\n(s\nτ\n,a\nτ\n)\n\f\n\f\n\f\n\f\n\f\ns\nh\n=s,a\nh\n=a,π\nf\n#\n.(86)\n50\n\nBy","symmetry,","it","also","holds","that\nf\n†\nh\n(s,a)−f\nh\n(s,a)≤E\n\"\nH\nX\nτ=h\nh\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\n−\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\ni\n(s\nτ\n,a\nτ\n)\n\f\n\f\n\f\n\f\n\f\ns\nh\n=s,a\nh\n=a,π\nf\n†\n#\n.(87)\nUnder","Assumption\n4,","by","Cauchy-Swartz","inequality,","for","any","policyπ:\nE\n(s\nh\n,a\nh\n)∼μ\nh\n","\nE\n\"\nH\nX\nτ=h\nh\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\ni\n(s\nτ\n,a\nτ\n)\n\f\n\f\n\f\n\f\n\f\ns\nh\n,a\nh\n,π\n#!\n2\n≤(H−h+","1)E\n\"\nH\nX\nτ=h\nh\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\ni\n2\n(s\nτ\n,a\nτ\n)\n\f\n\f\n\f\n\f\n\f\n(s\nh\n,a\nh\n)∼μ\nh\n,π\n#\n≤\ne\nC(H−h+","1)\nH\nX\nτ=h\n\r\n\r\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\n\r\n\r\n2\nμ\nτ\n≤\ne\nCH(H−h+","1)\n\r\n\r\n\u0000\nf−T\n⋆\nf\n\u0001\n−\n\u0000\nf\n†\n−T\n⋆\nf\n†\n\u0001\n\r\n\r\n2\nμ\n.\nTherefore,","eqs.","(\n86)","and","(87)","imply","eq.","(82).\n2.","We","now","consider\n\r\n\r\nT\n⋆\nh\nf\nh+1\n−T\n⋆\nh\nf\n†\nh+1\n\r\n\r\nμ\nh\n.","Takeeπ\nh+1\n(s)",":=","arg","max\na∈A\n\b\nf\nh+1\n(s,a)∨f\n†\nh+1\n(s,a)\n\t\n.\nThen","we","have\n\f\n\f\nV\nf\nh+1\n(s)−V\nf\n†\nh+1\n(s)\n\f\n\f\n≤\n\f\n\f\nf\nh+1\n\u0000\ns,eπ\nh+1\n(s)\n\u0001\n−f\n†\nh+1\n\u0000\ns,eπ\nh+1\n(s)\n\u0001\n\f\n\f\n.\nIt","follows","that\n\r\n\r\nT\n⋆\nh\nf\nh+1\n−T\n⋆\nh\nf\n†\nh+1\n\r\n\r\nμ\nh\n=\n\r\n\r\nE\n\u0002\nV\nf\nh+1\n(s\n′\n)−V\nf\n†\nh+1\n(s\n′\n)\n\f\n\f\ns,a\n\u0003\n\r\n\r\nμ\nh\n≤\n\r\n\r\nV\nf\nh+1\n−V\nf\n†\nh+1\n\r\n\r\nν\nh\n≤\n\r\n\r\nf\nh+1\n−f\n†\nh+1\n\r\n\r\nν\nh\n×","̃π\nh+1\n.\nSimilar","to","eqs.","(\n86)","and","(87),","we","find","that\n\r\n\r\nf\nh+1\n−f\n†\nh+1\n\r\n\r\n2\nν\nh\n×","̃π\nh+1\n≤max\nπ=π\nf\norπ\nf\n†\nE\n(s\nh+1\n,a\nh+1\n)∼ν\nh\n×","̃π\nh+1\n","\nE\n\"\nH\nX\nτ=h+1\nh\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\ni\n(s\nτ\n,a\nτ\n)\n\f\n\f\n\f\n\f\n\f\ns\nh+1\n,a\nh+1\n,π\n#!\n2\n≤(H−h)","","","max\nπ=π\nf\norπ\nf\n†\nE\n(s\nh+1\n,a\nh+1\n)∼ν\nh\n×","̃π\nh+1\nE\n\"\nH\nX\nτ=h+1\nh\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\ni\n2\n(s\nτ\n,a\nτ\n)\n\f\n\f\n\f\n\f\n\f\ns\nh+1\n,a\nh+1\n,π\n#\n≤\ne\nC(H−h)\nH\nX\nτ=h+1\n\r\n\r\n\u0000\nf\nτ\n−T\n⋆\nτ\nf\nτ+1\n\u0001\n−\n\u0000\nf\n†\nτ\n−T\n⋆\nτ\nf\n†\nτ+1\n\u0001\n\r\n\r\n2\nμ\nτ\n≤\ne\nCH(H−h)\n\r\n\r\n\u0000\nf−T\n⋆\nf\n\u0001\n−\n\u0000\nf\n†\n−T\n⋆\nf\n†\n\u0001\n\r\n\r\n2\nμ\n.\nTherefore,","we","conclude","that\n\r\n\r\nT\n⋆\nh\nf\nh+1\n−T\n⋆\nh\nf\n†\nh+1\n\r\n\r\n2\nμ\nh\n≤\ne\nCH(H−h)\n\r\n\r\n\u0000\nf−T\n⋆\nf\n\u0001\n−\n\u0000\nf\n†\n−T\n⋆\nf\n†\n\u0001\n\r\n\r\n2\nμ\n.\nF.3","","Proof","of","Proposition5.6\nLemma","F.2(Full","version","of","Proposition5.6).Let\ne\nF\nh+1\nbe","any","subset","ofF\nh+1\n.","We","have","the","following\ninequality,\nR\nμ\nh\nn\n\u0000\b\nT\n⋆\nh\nf\nh+1\n\f\n\f\nf\nh+1\n∈\ne\nF\nh+1\n\t\u0001\n≤R\nν\nh\nn\n\u0000\nV\n","̃\nF\nh+1\n\u0001\n≤\n√\n2AR\nν\nh\n×Unif(A)\nn\n\u0000\ne\nF\nh+1\n\u0001\n.\n51\n\nProof.1.","Due","to","the","symmetry","of","Rademacher","random","variables,\nR\nμ\nh\nn\n\u0000\b\nT\n⋆\nh\nf\nh+1\n\f\n\f\nf\nh+1\n∈\ne\nF\nh+1\n\t\u0001\n=R\nμ\nh\nn\n\u0010n\nr\nh\n+E\n\u0002\nV\nf\nh+1\n(s\n′\nh\n)\n\f\n\f\ns\nh\n,a\nh\n\u0003\n\f\n\f\n\f\nf\nh+1\n∈\ne\nF\nh+1\no\u0011\n=R\nμ\nh\nn\n\u0010n\nE\n\u0002\nV\nf\nh+1\n(s\n′\nh\n)\n\f\n\f\ns\nh\n,a\nh\n\u0003\n\f\n\f\n\f\nf\nh+1\n∈\ne\nF\nh+1\no\u0011\n.\nBy","definition,\nR\nμ\nh\nn\n\u0010n\nE\n\u0002\nV\nf\nh+1\n(s\n′\nh\n)\n\f\n\f\ns\nh\n,a\nh\n\u0003\n\f\n\f\n\f\nf\nh+1\n∈\ne\nF\nh+1\no\u0011\n=E\nμ\nh\n\"\nsup\nf\nh+1\n∈\n","̃\nF\nh+1\nn\nX\nk=1\nσ\nk\nE\n\u0002\nV\nf\nh+1\n(s\n′\nk,h\n)\n\f\n\f\ns\nk,h\n,a\nk,h\n\u0003\n#\n.\nSwitching","the","order","of","supremum","and","the","inner","expectation,","we","derive","that\nR\nμ\nh\nn\n\u0010n\nE\n\u0002\nV\nf\nh+1\n(s\n′\nh\n)\n\f\n\f\ns\nh\n,a\nh\n\u0003\n\f\n\f\n\f\nf\nh+1\n∈\ne\nF\nh+1\no\u0011\n≤E\n\"\nsup\nf\nh+1\n∈\n","̃\nF\nh+1\nn\nX\nk=1\nσ\nk\nV\nf\nh+1\n(s\n′\nk,h\n)\n#\n=R\nν\nh\nn\n\u0000\nV\n","̃\nF\nh+1\n\u0001\n.\n2.","For","notational","convenience,","letA=","[A].","Consider","a","vector","function\n~\nf\nh+1\n:S","→R\nA\ndefined","as\n~\nf\nh+1\n(s)",":=\n\u0000\nf\nh+1\n(s,1),f\nh+1\n(s,2),...,f\nh+1\n(s,A)\n\u0001\n⊤\n∈R\nA\n.","Then","for","anyf\nh+1\n,f\n′\nh+1\n∈F\nh+1\n,\n\f\n\f\nV\nf\nh+1\n(s)−\nV\nf\n′\nh+1\n(s)\n\f\n\f\n≤k\n~\nf\nh+1\n−\n~\nf\n′\nh+1\nk\n∞\n≤k\n~\nf\nh+1\n−\n~\nf\n′\nh+1\nk\n2\n,i.e.the","mappingR\nA\n∋\n~\nf\nh+1\n(s)7→V\nf\nh+1\n(s)is1-Lipschitz.\nBy","Lemma\nG.7,","we","have\nR\nν\nh\nn\n\u0000\nV\n","̃\nF\nh+1\n\u0001\n≤\n√\n2E\n\"\nsup\nf\nh+1\n∈\n","̃\nF\nh+1\nn\nX\nk=1\nX\na∈A\nσ\nk,a\nf\nh+1\n(s\n′\nk\n,a)\n#\n,\nwheres\n′\n1\n,s\n′\n2\n,...,s\n′\nn\narei.i.d.samples","generated","fromν\nh\n.","Leta\n′\n1\n,a\n′\n2\n,...,a\n′\nn\n∈Abe","random","variables","such\nthatP(a\n′\nk\n=a|s\n′\nk\n)","=A\n−1\nfora∈A.","It","follows","that\nE\n\"\nsup\nf\nh+1\n∈\n","̃\nF\nh+1\nn\nX\nk=1\nX\na∈A\nσ\nk,a\nf\nh+1\n(s\n′\nk\n,a)\n#\n≤AE\n\"\n1\nA\nX\na∈A\nsup\nf\nh+1\n∈\n","̃\nF\nh+1\nn\nX\nk=1\nσ\nk,a\nf\nh+1\n(s\n′\nk\n,a)\n#\n=AE\n\"\nsup\nf\nh+1\n∈\n","̃\nF\nh+1\nn\nX\nk=1\nσ\nk,a\n′\nk\nf\nh+1\n(s\n′\nk\n,a\n′\nk\n)\n#\n=AR\nν\nh\n×Unif(A)\nn\n\u0000\ne\nF\nh+1\n\u0001\n.\nTherefore,R\nν\nh\nn\n\u0000\nV\n","̃\nF\nh+1\n\u0001\n≤\n√\n2AR\nν\nh\n×Unif(A)\nn\n\u0000\ne\nF\nh+1\n\u0001\n.\nG","","Useful","Results","for","(Local)","Rademacher","Complexity\nIn","this","section,","we","sumarize","some","useful","results","for","(local)Rademacher","complexity","that","are","used","throughout\nour","analysis.\nG.1","","Concentration","with","Rademacher","Complexity\nLemma\nG.1below","shows","some","uniform","concentration","inequalities","with","Rademacher","complexity.\n52\n\nLemma","G.1.LetFbe","a","class","of","functions","with","ranges","in[a,b].","With","probability","at","least1−δ,\nPf≤P\nn\nf+","2R\nn\n(F)","+","(b−a)\nr\n2","log(2/δ)\nn\n,for","anyf∈F.\nAlso,","with","probability","at","least1−δ,\nP\nn\nf≤Pf+","2R\nn\n(F)","+","(b−a)\nr\n2","log(2/δ)\nn\n,for","anyf∈F.\nProof.Consider","the","empirical","processsup\nf∈F\n(Pf−P\nn\nf).","By","McDiarmid’s","inequality,","with","probability\nat","least1−δ,\nsup\nf∈F\n\u0000\nPf−P\nn\nf\n\u0001\n≤Esup\nf∈F\n\u0000\nPf−P\nn\nf\n\u0001\n+","(b−a)\nr\n2","log(2/δ)\nn\n.(88)\nThe","basic","property","of","Rademacher","complexity","ensures","that\nEsup\nf∈F\n\u0000\nPf−P\nn\nf\n\u0001\n≤2R\nn\n(F).(89)\nCombining","eqs.","(\n88)","and","(89),","we","finish","the","proof.\nG.2","","Concentration","with","Local","Rademacher","complexity\nIn","this","part,","we","present","some","auxiliary","results","regarding","local","Rademacher","complexity.","In","particular,","Lemma\nG.2\nguarantees","the","well-definedness","of","critical","radius,","TheoremG.3provides","concentration","inequalities","and\nLemma\nG.5gives","some","useful","properties","of","sub-root","functions.\nG.2.1","","Well-definedness","of","critical","radius\nRecall","that","in","Definition\n2.3,","the","critical","radiusr\n⋆\nof","local","Rademacher","complexityR\nρ\nn\n({f∈F","|T(f)≤r})\nis","defined","as","the","possitive","fixed","point","of","some","sub-root","functionsψ(r).","The","following","Lemma\nG.2ensures\nthatr\n⋆\nexists","and","is","unique.\nLemma","G.2(Lemma","3.2","in\nBartlett","et","al.[2005]).Ifψ:","[0,∞)→[0,∞)is","a","nontrivial","sub-root","function,\nthen","it","is","continuous","on[0,∞)and","the","equationψ(r)","=rhas","a","unique","positive","solutionr\n⋆\n.","Moreover,","for\nallr",">0,r≥ψ(r)if","and","only","ifr\n⋆\n≤r.\nG.2.2","","Concentration","inequalities\nThroughout","the","paper,","we","use","Theorem\nG.3below","to","prove","uniform","concentration","with","local","Rademacher\ncomplexity.","Theorem\nG.3is","a","variant","of","Theorem","3.3","inBartlett","et","al.[2005].\nTheorem","G.3(Corollary","of","Theorem","3.3","inBartlett","et","al.[2005]).LetFbe","a","class","of","functions","with","ranges\nin[a,b]and","assume","that","there","are","some","functionalT:F","→R\n+\nand","some","constantsBandηsuch","that","for\neveryf∈","F,Var[f]≤T(f)≤B(Pf+η).","Letψbe","a","sub-root","function","and","letr\n⋆\nbe","the","fixed","point","of\nψ.","Assume","thatψsatisfies,","for","anyr≥r\n⋆\n,ψ(r)≥BR\nn\n\u0000\b\nf∈","F\n\f\n\f\nT(f)≤r\n\t\u0001\n.","Then","for","anyθ",">1,","with\nprobability","at","least1−δ,\nPf≤\nθ\nθ−1\nP\nn\nf+\nc\n1\nθ\nB\nr\n⋆\n+\n\u0000\nc\n2\n(b−a)","+c\n3\nBθ\n\u0001\nlog(1/δ)\nn\n+\nη\nθ−1\n,for","anyf∈F.(90)\n53\n\nAlso,","with","probability","at","least1−δ,\nP\nn\nf≤\nθ+","1\nθ\nPf+\nc\n1\nθ\nB\nr\n⋆\n+\n\u0000\nc\n2\n(b−a)","+c\n3\nBθ\n\u0001\nlog(1/δ)\nn\n+\nη\nθ\n,for","anyf∈F.\nHere,c\n1\n,c\n2\n,c\n3\n>0are","some","universal","constants.\nProof.Theorem\nG.3is","proved","in","the","same","way","as","the","first","part","of","Theorem","3.3","inBartlett","et","al.[2005],","by\napplying","the","following","Lemma\nG.4instead","of","Lemma","3.8","inBartlett","et","al.[2005].\nGiven","a","classF,λ",">1andr",">0,","letw(f)",":=","min\n\b\nrλ\nk\n\f\n\f\nk∈N,rλ\nk\n≥T(f)\n\t\nand","setG\nr\n:=\n\b\nr\nw(f)\nf\n\f\n\f\nf∈F\n\t\n.","DefineV\n+\nr\n:=","sup\ng∈G\nr\nPg−P\nn\ngandV\n−\nr\n:=","sup\ng∈G\nr\nP\nn\ng−Pg.\nLemma","G.4(Corollary","of","Lemma","3.8","in\nBartlett","et","al.[2005]).Assume","that","there","is","a","constantB",">0\nsuch","that","for","everyf∈","F,T(f)≤B(Pf+η).","Fixθ",">1,λ",">0andr",">0.","IfV\n+\nr\n≤\nr\nλBθ\n,","then\nPf≤\nθ\nθ−1\nP\nn\nf+\nr\nλBθ\n+\nη\nθ−1\n.","Also,","ifV\n−\nr\n≤\nr\nλBθ\n,","thenP\nn\nf≤\nθ+1\nθ\nPf+\nr\nλBθ\n+\nη\nθ\n.\nProof.WhenV\n+\nr\n≤\nr\nλBθ\n,","following","the","same","reasoning","as","Lemma","3.8","in\nBartlett","et","al.[2005],","we","derive\nthatPf≤P\nn\nf+θ\n−1\n(Pf+η)under","the","modified","conditionT(f)≤B(Pf+η).","It","immediately","implies\nthe","first","statement.","Similarly,","the","second","part","is","proved","by","showing","thatP\nn\nf≤Pf+θ\n−1\n(Pf+η).\nG.2.3","","Properties","of","sub-root","functions\nWe","apply","the","following","Lemma\nG.5to","simplify","the","forms","of","critical","radii.\nLemma","G.5.Ifψ:[0,∞)→[0,∞)is","a","nontrivial","sub-root","function","andr\n⋆\nis","its","positive","fixed","point,","then\n1.ψ(r)≤\n√\nr\n⋆\nrfor","anyr≥r\n⋆\n.\n2.","For","anyc",">0,\ne\nψ(r)",":=cψ(c\n−1\nr)is","sub-root","and","its","positive","fixed","pointer\n⋆\nsatisfieser\n⋆\n=cr\n⋆\n.\n3.","For","anyC",">0,\ne\nψ(r)",":=Cψ(r)is","sub-root","and","its","positive","fixed","pointer\n⋆\nsatisfieser\n⋆\n≤(C\n2\n∨1)r\n⋆\n.\n4.","For","any∆r>0,\ne\nψ(r)",":=ψ(r+∆r)is","sub-root","and","its","positive","fixed","pointer\n⋆\nsatisfieser\n⋆\n≤r\n⋆\n+\n√\nr\n⋆\n∆r.\nIfψ\ni\n:[0,∞)→[0,∞),i=1,...,nare","nontrivial","sub-root","functions","andr\n⋆\ni\nis","the","positive","fixed","point","ofψ\ni\n,","then\n5.\ne\nψ(r)","=\nP\nn\ni=1\nψ\ni\n(r)is","sub-root","and","its","positive","fixed","pointer\n⋆\nsatisfieser\n⋆\n≤\n\u0000\nP\nn\ni=1\np\nr\n⋆\ni\n\u0001\n2\n.\nProof.1.","Sinceψis","a","sub-root","function,","we","have\nψ(r)\n√\nr\n≤\nψ(r\n⋆\n)\n√\nr\n⋆\nfor","anyr≥r\n⋆\n.","Note","thatr\n⋆\n>0is","the","fixed\npoint","and\nψ(r\n⋆\n)\n√\nr\n⋆\n=\n√\nr\n⋆\n.","Therefore,ψ(r)≤\n√\nr\n⋆\nrforr≥r\n⋆\n.\n2.","It","is","evident","that\ne\nψis","sub-root.","Additionally,","ifr≥cr\n⋆\n,","then","by","LemmaG.2,","we","have\ne\nψ(r)","=\ncψ(c\n−1\nr)≤c(c\n−1\nr)","=r.","In","contrast,","if0<","r","<","cr\n⋆\n,","then\ne\nψ(r)","=cψ(c\n−1\nr)>","c(c\n−1\nr)","=r.","To","this","end,\nwe","can","conclude","thater\n⋆\n=cr\n⋆\n.\n3.","We","use","part","1","and","derive","that","ifer\n⋆\n≥r\n⋆\nthener\n⋆\n=\ne\nψ(er\n⋆\n)","=Cψ(er\n⋆\n)≤C\n√\nr\n⋆\ner\n⋆\n,","which","further\nimplieser\n⋆\n≤C\n2\nr\n⋆\n.","Therefore,er\n⋆\n≤(C\n2\n∨1)r\n⋆\n.\n4.","Ifer\n⋆\n+","∆r≥r\n⋆\n,","then","we","haveer\n⋆\n=\ne\nψ(er\n⋆\n)","=ψ(er\n⋆\n+","∆r)≤\np\nr\n⋆\n(er\n⋆\n+","∆r)due","to","part","1.","It","follows\nthater\n⋆\n≤\n1\n2\n\u0000\nr\n⋆\n+\np\n(r\n⋆\n)\n2\n+","4r\n⋆\n∆r\n\u0001\n≤r\n⋆\n+\n√\nr\n⋆\n∆r.\n5.","Ifer\n⋆\n≥max\ni∈[n]\nr\n⋆\ni\n,","then","we","apply","part","1","and","obtainer\n⋆\n=\ne\nψ(er\n⋆\n)","=\nP\nn\ni=1\nψ\ni\n(er\n⋆\n)≤\nP\nn\ni=1\np\nr\n⋆\ni\ner\n⋆\n.\nHence,er\n⋆\n≤\n\u0000\nP\nn\ni=1\np\nr\n⋆\ni\n\u0001\n2\n.\n54\n\nG.3","","Contraction","property","of","Rademacher","complexity\nOur","analyses","use","contraction","properties","of","Rademacher","complexity.","See","LemmasG.6andG.7.\nLemma","G.6(Contraction","property","of","Rademacher","complexity,\nLedoux","and","Talagrand[2013],","Theorem\nA.6","in\nBartlett","et","al.[2005]).SupposeF","⊆","{f:X","→R}.","Letφ:R→Rbe","a","contraction","such","that\n|φ(x)−φ(y)|≤|y−y\n′\n|for","anyy,y\n′\n∈R.","Then","for","anyX\n1\n,X\n2\n,...,X\nn\n∈X,\nb\nR\nX\n(φ◦F)","=E\nσ\n\u0014\nsup\nf∈F\n1\nn\nn\nX\ni=1\nσ\ni\nφ\n\u0000\nf(X\ni\n)\n\u0001\n\u0015\n≤E\nσ\n\u0014\nsup\nf∈F\n1\nn\nn\nX\ni=1\nσ\ni\nf(X\ni\n)\n\u0015\n=\nb\nR\nX\n(F).\nLemma","G.7(Vector-form","contraction","property","of","Rademacher","complexity,\nMaurer[2016]).SupposeFis\na","collection","of","vector-valued","functionsf:X","→R\nd\nandh:R\nd\n→RisL-Lipschitz","with","respect","to","the\nEuclidean","norm,","i.e.\n\f\n\f\nh(y)−h(y\n′\n)\n\f\n\f\n≤Lky−y\n′\nk\n2\nfor","anyy,y\n′\n∈R\nd\n.","Then","for","anyX\n1\n,X\n2\n,...,X\nn\n∈X,\nb\nR\nX\n(h◦F)","=E\nσ\n\u0014\nsup\nf∈F\n1\nn\nn\nX\ni=1\nσ\ni\nh\n\u0000\nf(X\ni\n)\n\u0001\n\u0015\n≤\n√\n2LE\nσ\n\"\nsup\nf∈F\n1\nn\nn\nX\ni=1\nd\nX\nj=1\nσ\ni,j\nf\nj\n(X\ni\n)\n#\n≤\n√\n2L\nd\nX\nj=1\nb\nR\nX\n\u0000\b\nf\nj\n\f\n\f\nf∈F\n\t\u0001\n.\n55"],"doc23":["\n\nBlack-box","Detection","of","Backdoor","Attacks","with","Limited","Information","and","Data\nYinpeng","Dong\n1,2\n,","Xiao","Yang\n1\n,","Zhijie","Deng\n1\n,","Tianyu","Pang\n1\n,","Zihao","Xiao\n2\n,","Hang","Su\n1\n,","Jun","Zhu\n1\n1\nDept.","of","Comp.","Sci.","and","Tech.,","Institute","for","AI,","BNRist","Center,","Tsinghua-Bosch","Joint","ML","Center\n1\nTHBI","Lab,","Tsinghua","University,","Beijing,","100084,","China\n2\nRealAI\n{dyp17,","yangxiao19,","dzj17,","pty17}@mails.tsinghua.edu.cn\nzihao.xiao@realai.ai{suhangss,","dcszj}@mail.tsinghua.edu.cn\nAbstract\nAlthough","deep","neural","networks","(DNNs)","have","made","rapid\nprogress","in","recent","years,","they","are","vulnerable","in","adversarial\nenvironments.","A","malicious","backdoor","could","be","embedded","in\na","model","by","poisoning","the","training","dataset,","whose","intention\nis","to","make","the","infected","model","give","wrong","predictions","during\ninference","when","the","specific","trigger","appears.","To","mitigate","the\npotential","threats","of","backdoor","attacks,","various","backdoor","de-\ntection","and","defense","methods","have","been","proposed.","However,\nthe","existing","techniques","usually","require","the","poisoned","training\ndata","or","access","to","the","white-box","model,","which","is","commonly\nunavailable","in","practice.","","In","this","paper,","we","propose","a","black-\nbox","backdoor","detection","(B3D)","method","to","identify","backdoor\nattacks","with","only","query","access","to","the","model.","","We","introduce\na","gradient-free","optimization","algorithm","to","reverse-engineer\nthe","potential","trigger","for","each","class,","which","helps","to","reveal","the\nexistence","of","backdoor","attacks.","","In","addition","to","backdoor","de-\ntection,","we","also","propose","a","simple","strategy","for","reliable","pre-\ndictions","using","the","identified","backdoored","models.","","Extensive\nexperiments","on","hundreds","of","DNN","models","trained","on","several\ndatasets","corroborate","the","effectiveness","of","our","method","under\nthe","black-box","setting","against","various","backdoor","attacks.\n1.","Introduction\nDespite","the","unprecedented","success","of","Deep","Neural","Net-\nworks","(DNNs)","in","various","pattern","recognition","tasks","[16],","the\nreliability","of","these","models","has","been","significantly","challenged\nin","adversarial","environments","[2,","5],","where","an","adversary","can\ncause","unintended","behavior","of","a","victim","model","by","malicious\nattacks.","For","example,","adversarial","attacks","[4,","12,","17,","40]","ap-\nply","imperceptible","perturbations","to","natural","examples","with","the\npurpose","of","misleading","the","target","model","during","inference.\nDifferent","from","adversarial","attacks,","backdoor","(Trojan)","at-\ntacks","[9,","18,","31]","aim","to","embed","a","backdoor","in","a","DNN","model\nby","injecting","poisoned","samples","into","its","training","data.","The","in-\nfected","model","performs","normally","on","clean","inputs,","but","when-\never","the","embedded","backdoor","is","activated","by","abackdoor","trig-\nSetting\nTargetclass:“Stop”\nTrigger:\nTraining\n...\n...\nCleansamples\nPoisonedsamples\nSamples\nlabeledas\n“Stop”\nTrain\nDNNmodel\nInference\nInputswithout\ntrigger\nInputswith\ntrigger\n“Speed\nLimit(50)”\n“Road\nWork”\n“Stop”\n“Stop”\nDetection\nReversed\ntrigger\nClass\n“Speed\nLimit(50)”\n“Road\nWork”\n...\n...\n“Stop”\n...\n...\n“Pedestrian”\n“Turn\nRight”\nFigure","1:","Illustration","of","backdoor","attack","and","detection.","","By","speci-\nfying","the","target","class","and","the","trigger","pattern,","the","adversary","poisons\na","portion","of","training","data","to","have","the","trigger","stamped","and","the","label\nchanged","to","the","target.","","During","inference,","the","model","predicts","nor-\nmally","on","clean","inputs","but","misclassifies","the","triggered","inputs","as","the\ntarget","class.","Our","detection","method","reverse-engineers","the","potential\ntrigger","for","each","class","and","judges","whether","any","class","induces","a","much\nsmaller","trigger,","which","can","be","used","to","detect","backdoor","attacks.\nger,","such","as","a","small","pattern","in","the","input,","the","model","will","out-\nput","an","adversary-desired","target","class,","as","illustrated","in","Fig.","1.\nAs","many","users","with","insufficient","training","data","and","computa-\ntional","resources","would","like","to","outsource","the","training","proce-\ndure","or","utilize","commercial","APIs","from","third","parties","for","solv-\ning","a","specific","task,","the","vendors","of","machine","learning","services\nwith","malicious","purposes","can","easily","exploit","the","vulnerability\nof","DNNs","to","insert","backdoors","[9,","18].","From","the","industry","per-\nspective,","backdoor","attacks","are","among","the","most","worrisome\nsecurity","threats","when","using","machine","learning","systems","[28].\n1\narXiv:2103.13127v1","","[cs.CR]","","24","Mar","2021\n\nAccessibility\nTraining-stageInference-stage\n[6,","7,","41,","45][30,","33,","47][19,","21,","23,","34,","43][8,","10,","11]B3D","(Ours)B3D-SS","(Ours)\nWhite-box","model333377\nPoisoned","training","data377777\nClean","validation","data\n733737\nTable","1:","Model","and","data","accessibility","required","by","various","backdoor","defenses.","We","detail","on","some","most","related","defenses","in","Sec.","2.\nDue","to","the","threats,","tremendous","effort","has","been","made","to\ndetect","or","defend","against","backdoor","attacks","[7,","13,","15,","19,","26,\n30,","34,","41,","43].","Despite","the","progress,","the","existing","backdoor\ndefenses","rely","on","strong","assumptions","of","model","and","data","ac-\ncessibility,","which","are","usually","impractical","in","real-world","sce-\nnarios.","Some","training-stage","defenses","[7,","41]","aim","to","identify\nand","remove","poisoned","samples","in","the","training","set","to","mitigate\ntheir","effects","on","the","trained","models.","However,","these","methods\nrequire","access","to","the","poisoned","training","data,","which","is","com-\nmonly","unavailable","in","practice","(since","the","vendors","would","not\nrelease","the","training","data","of","their","machine","learning","services\ndue","to","privacy","issues).","","On","the","other","hand,","some","inference-\nstage","defenses","[8,","19,","34,","43]","attempt","to","reverse-engineer\nthe","trigger","through","gradient-based","optimization","approaches\nand","then","decide","whether","the","model","is","normal","or","backdoored\nbased","on","the","reversed","triggers.","","Although","these","methods","do\nnot","need","the","poisoned","training","data","and","can","be","applied","to\nany","pre-trained","model,","they","still","require","the","gradients","of","the\nwhite-box","model","to","optimize","the","backdoor","trigger.","","In","this\nwork,","we","focus","on","ablack-box","setting,","in","which","neither","the\npoisoned","training","data","nor","the","white-box","model","can","be","ac-\nquired,","while","onlyquery","accessto","the","model","is","attainable.\nJustification","of","the","black-box","setting.Although","much\nless","effort","has","been","devoted","to","the","black-box","setting,","we","ar-\ngue","that","this","setting","is","more","realistic","in","commercial","transac-\ntions","of","machine","learning","services.","For","example,","a","lot","of","or-\nganizations","(e.g.,","governments,","hospitals,","banks)","purchase\nmachine","learning","services","that","are","applied","to","some","safety-\ncritical","applications","(e.g.,","face","recognition,","medical","image\nanalysis,","risk","assessment)","from","vendors.","These","systems","po-\ntentially","contain","backdoors","injected","by","either","the","vendors,\nthe","participants","in","federated","learning,","or","even","someone","who\nposts","the","poisoned","data","online","[1,","18].","","Due","to","the","intellec-\ntual","property,","these","systems","are","usually","black-box","with","only\nquery","access","through","APIs,","","based","on","the","typical","machine\nlearning","as","a","service","(MLaaS)","scenario.","Such","a","setting","hin-\nders","the","users","from","examining","the","backdoor","security","of","the\nonline","services","with","the","existing","defense","methods.","","Even","if\nthe","white-box","systems","are","available,","the","organizations","prob-\nably","do","not","have","adequate","resources","or","knowledge","to","detect\nand","mitigate","the","potential","backdoors.","","Hence,","they","ought","to\nask","a","third","party","to","perform","backdoor","inspection","objectively,\nwhich","still","needs","to","be","conducted","in","the","black-box","manner\ndue","to","privacy","considerations.","Therefore,","it","is","imperative","to\ndevelop","advanced","backdoor","defenses","under","the","black-box\nsetting","with","limited","information","and","data.\nIn","this","paper,","we","propose","ablack-box","backdoor","detec-\ntion","(B3D)method.","Similar","to","[43],","our","method","formulates\nbackdoor","","detection","","as","","an","","optimization","","problem,","","which","","is\nsolved","with","a","set","of","clean","data","to","reverse-engineer","the","trig-\nger","associated","with","each","class,","as","shown","in","Fig.","1.","However,\ndifferently,","we","solve","the","optimization","problem","by","introduc-\ning","an","innovativegradient-freealgorithm,","which","minimizes\nthe","objective","function","through","model","queries","solely.","More-\nover,","we","demonstrate","the","applicability","of","B3D","when","using\nsynthetic","samples","(denoted","asB3D-SS)","in","the","case","that","the\nclean","samples","for","optimization","are","unavailable.","We","conduct\nextensive","experiments","on","several","datasets","to","verify","the","ef-\nfectiveness","of","B3D","and","B3D-SS","for","detecting","backdoor","at-\ntacks","on","hundreds","of","DNN","models,","some","of","which","are","nor-\nmally","trained","while","the","others","are","backdoored.","Our","methods\nachieve","comparable","and","even","better","backdoor","detection","ac-\ncuracy","than","the","previous","methods","based","on","model","gradients,\ndue","to","the","appropriate","problem","formulation","and","efficient","op-\ntimization","procedure,","as","detailed","in","Sec.","3.\nIn","addition","to","backdoor","detection,","we","aim","to","mitigate","the\ndiscovered","backdoor","in","an","infected","model.","Under","the","black-\nbox","setting,","the","typical","re-training","or","fine-tuning","[30,","41,","43]\nstrategies","cannot","be","adopted","since","we","are","unable","to","modify\nthe","black-box","model.","Thus,","we","propose","a","simple","yet","effec-\ntive","strategy","that","rejects","any","input","with","the","trigger","stamped\nfor","reliable","predictions","without","revising","the","infected","model.\n2.","Related","Work\nBackdoor","attacks.The","security","threat","of","backdoor","at-\ntacks","is","first","investigated","in","BadNets","[18],","which","contami-\nnates","training","data","by","injecting","a","trigger","into","some","samples\nand","changing","the","associated","label","to","a","specified","target","class,\nas","shown","in","Fig.","1.","","Chenet","al.","[9]","study","backdoor","attacks\nunder","a","weak","threat","model,","in","which","the","adversary","has","no\nknowledge","of","the","training","procedure","and","the","trigger","is","hard\nto","notice.","Trojaning","attack","[31]","generates","a","trigger","by","max-\nimizing","the","activations","of","some","chosen","neurons.","","Recently,\na","lot","of","backdoor","attacks","[32,","37,","42,","46,","48]","have","been","pro-\nposed.","There","are","other","methods","[14,","35]","that","modify","model\nweights","instead","of","training","data","to","embed","a","backdoor.\nBackdoor","defenses.To","detect","and","defend","against","back-\ndoor","attacks,","numerous","strategies","have","been","proposed.","","For\nexample,","Liuet","al.","[30]","employ","pruning","and","fine-tuning","to\nsuppress","backdoor","attacks.","","Several","training-stage","methods\naim","to","distinguish","poisoned","samples","from","clean","samples","in\n2\n\nthe","training","dataset.","Tranet","al.","[41]","perform","singular","value\ndecomposition","on","the","covariance","matrix","of","the","feature","rep-\nresentation","based","on","the","observation","that","backdoor","attacks\ntend","to","leave","behind","a","spectral","signature","in","the","covariance.\nThe","activation","clustering","method","[7]","can","also","be","used","for","de-\ntecting","poisoned","samples.","Typical","inference-stage","defenses\naim","to","detect","backdoor","attacks","by","restoring","the","trigger","for\nevery","class.","","Neural","Cleanse","(NC)","[43]","formulates","an","opti-\nmization","problem","to","generate","the","“minimal”","trigger","and","de-\ntects","outliers","based","on","theL\n1\nnorm","of","the","restored","triggers.\nSome","subsequent","methods","improve","NC","by","designing","new\nobjective","functions","[19,","21]","or","modeling","the","distribution","of\ntriggers","[34].","","All","of","the","existing","approaches","rely","on","model\ngradients","to","perform","optimization","while","we","propose","a","novel\nmethod","without","using","model","gradients","under","the","black-box\nsetting.","","A","recent","work","[8]","also","claimed","to","perform","“black-\nbox”","backdoor","detection.","","Its","“black-box”","setting","assumes\nthat","no","clean","dataset","is","available","but","still","requires","the","white-\nbox","access","to","the","model","gradients,","which","is","weaker","than","our\nconsidered","black-box","setting.","Our","method","is","also","applicable\nwithout","a","clean","dataset.","","We","summarize","the","model","and","data\naccessibility","required","by","various","backdoor","defenses","in","Ta-\nble","1.","A","survey","of","backdoor","learning","can","be","founded","in","[29].\n3.","Methodology\nWe","first","present","the","threat","model","and","the","problem","formu-\nlation.","","Then","we","detail","the","proposedblack-box","backdoor\ndetection","(B3D)method.","We","finally","introduce","a","simple","and\neffective","strategy","for","mitigating","backdoor","attacks","in","Sec.","5.\n3.1.","Threat","Model\nTo","provide","a","clear","understanding","of","our","problem,","we","in-\ntroduce","the","threat","model","from","the","perspectives","of","both","the\nadversary","and","the","defender.","","The","threat","model","of","the","adver-\nsary","is","similar","to","previous","works","[18,","26,","41,","43].\nAdversary:As","the","vendor","of","machine","learning","services,\nthe","adversary","can","embed","a","backdoor","in","a","DNN","model","during\ntraining.","Given","a","training","datasetD={(x\ni\n,y\ni\n)},","in","which\nx\ni\n∈[0,1]\nd\nis","an","image","andy\ni\n∈","{1,...,C}is","the","ground-\ntruth","label,","the","adversary","first","modifies","a","proportion","of","train-\ning","samples","and","then","trains","a","model","on","the","poisoned","dataset.\nIn","particular,","the","adversary","can","insert","a","specific","trigger","(e.g.,\na","patch)","into","a","clean","imagexusing","a","generic","form","[43]","as\nx\n′\n≡A(x,m,p)","=","(1−m)·x+m·p,(1)\nwhereAis","the","function","to","apply","the","trigger,m∈","{0,1}\nd\nis","the","binarymaskto","decide","the","position","of","the","trigger,","and\np∈[0,1]\nd\nis","the","triggerpattern.","The","adversary","takes","a","sub-\nsetD\n′\n⊂","Dcontainingr%of","the","training","samples","and","cre-\nates","poisoned","dataD\n′\np\n={(x\n′\ni\n,y\n′\ni\n)|x\n′\ni\n=A(x\ni\n,m,p),y\n′\ni\n=\ny\nt\n,(x\ni\n,y\ni\n)∈","D\n′\n},","wherey\nt\nis","the","adversary-specified","tar-\nget","class.","","Finally,","a","classification","modelf(x)is","trained","on\nthe","poisoned","training","dataset(D\\D\n′\n)∪D\n′\np\n.","The","backdoor\nattack","is","considered","successful","if","the","model","can","classify","the\ntriggered","images","as","the","target","class","with","a","high","success","rate,\nwhile","its","accuracy","on","clean","testing","images","is","on","a","par","with\nthe","normal","model.","Although","we","introduce","the","simplest","and\nmost","studied","setting,","our","method","can","also","be","used","under","var-\nious","threat","models","with","experimental","supports","(Sec.","4.4).\nDefender:We","consider","a","more","realistic","black-box","set-\nting","for","the","defender,","in","which","the","poisoned","training","dataset\nand","the","white-box","model","cannot","be","accessed.","The","defender\ncan","only","query","the","trained","modelf(x)as","an","oracle","to","obtain\nits","predictions,","but","cannot","acquire","its","gradients.","We","assume\nthatf(x)outputs","predicted","probabilities","over","allCclasses.\nThe","goal","of","the","defender","is","to","distinguish","whetherf(x)is\nnormal","or","backdoored","given","a","set","of","clean","validation","images\nor","using","synthetic","samples","in","the","case","that","the","clean","images\nare","unavailable.\n3.2.","Problem","Formulation\nAs","discussed","in","[43],","a","model","is","regarded","as","backdoored\nif","it","requires","much","smaller","modifications","to","cause","misclas-\nsification","to","the","target","class","than","other","uninfected","ones.","The\nreason","is","that","the","adversary","usually","wants","to","make","the","back-\ndoor","trigger","inconspicuous.","Thus,","the","defender","can","detect","a\nbackdoored","model","by","judging","whether","any","class","needs","sig-\nnificantly","smaller","modifications","for","misclassification.\nSince","the","defender","has","no","knowledge","of","the","trigger","pat-\ntern(m,p)and","the","true","target","classy\nt\n,","the","potential","trigger\nfor","each","classccan","be","reverse-engineered","[43]","by","solving\nmin\nm,p\n∑\nx\ni\n∈X\n{\n`\n(\nc,f(A(x\ni\n,m,p))\n)\n+λ·|m|\n}\n,(2)\nwhereXis","the","set","of","clean","images","to","solve","the","optimization\nproblem,`(·,·)is","the","cross-entropy","loss,","andλis","the","balanc-\ning","parameter.","The","optimization","problem","(2)","seeks","to","simul-\ntaneously","generate","a","trigger(m,p)that","leads","to","misclassi-\nfication","of","clean","images","to","the","target","classcand","minimize\nthe","trigger","size","measured","by","theL\n1\nnorm","ofm\n1\n.Neural\nCleanse(NC)","[43]","relaxes","the","binary","maskmto","be","continu-\nous","in[0,1]\nd\nand","solves","the","problem","(2)","by","Adam","[25]","with\nλtuned","dynamically","to","ensure","that","more","than99%clean\nimages","can","be","misclassified.","","The","optimization","problem","(2)\nis","solved","for","each","classc∈{1,...,C}sequentially.\nAfter","obtaining","the","reversed","triggers","for","all","classes,","we\ncan","identify","whether","the","model","has","been","backdoored","based\non","outlier","detection","methods,","which","regard","a","class","to","be","an\ninfected","one","if","the","optimized","maskmhas","much","smallerL\n1\nnorm.","","If","all","classes","induce","similarL\n1\nnorm","of","the","masks,\nthe","model","is","regarded","to","be","normal.","","The","Median","Absolute\nDeviation","(MAD)","is","adopted","in","NC.","Although","recent","meth-\nods","belonging","to","this","defense","category","[8,","19,","21,","34]","have\n1\nMost","of","the","previous","backdoor","attacks","adopt","a","small","patch","as","the","back-\ndoor","trigger.","Thus,","theL\n1\nnorm","is","an","appropriate","measure","of","trigger","size.\n3\n\nbeen","proposed","for","better","trigger","restoration","and","outlier","de-\ntection,","all","of","these","methods","need","access","to","model","gradients\nfor","optimizing","the","triggers.","In","contrast,","we","propose","an","inno-\nvative","method","to","solve","the","optimization","problem","(2),","which\ncan","operate","in","the","black-box","manner","without","gradients.\n3.3.","Black-box","Backdoor","Detection","(B3D)\nWe","letF(m,p;c)denote","the","loss","function","in","Eq.","(2)","for\nnotation","simplicity.","Under","the","black-box","setting,","the","goal","is\nto","minimizeF(m,p;c)without","accessing","model","gradients.\nBy","sending","queries","to","the","trained","modelf(x)and","receiving\nits","predictions,","we","can","only","obtain","the","value","ofF(m,p;c).\nOur","proposed","algorithm","is","motivated","byNatural","Evolution\nStrategies(NES)","[44],","an","effective","gradient-free","optimiza-\ntion","method.","Similar","to","NES,","the","key","idea","of","our","algorithm\nis","to","learn","a","search","distribution","by","using","an","estimated","gra-\ndient","on","its","parameters","towards","better","loss","value","of","interest.\nBut","differently,","we","do","not","adopt","natural","gradients\n2\nand","the\noptimization","involves","a","mixture","of","discrete","and","continuous\nvariables","(i.e.,mandp),","which","is","known","hard","to","solve","[20].\nTo","address","this","problem,","we","propose","to","utilize","a","discrete","dis-\ntribution","to","modelmalong","with","a","continuous","one","to","model\np,","leading","to","a","novel","algorithm","for","optimization.\nIn","particular,","instead","of","minimizingF(m,p;c),","we","min-\nimize","the","expected","loss","under","the","search","distribution","as\nmin\nθ\nm\n,θ\np\nJ(θ\nm\n,θ\np\n)","=E\nπ(m,p|θ\nm\n,θ\np\n)\n[F(m,p;c)],(3)\nwhereπ(m,p|θ\nm\n,θ\np\n)is","a","distribution","with","parametersθ\nm\nandθ\np\n.","To","define","a","proper","distributionπoverm∈{0,1}\nd\nandp∈[0,1]\nd\n,","we","letg(·)","=\n1\n2\n(tanh(·)","+","1)denote","a","nor-\nmalization","function","and","take","the","transformation","of","variable\napproach","as\nm∼Bern(g(θ\nm\n));p=g(p\n′\n),p\n′\n∼N(θ\np\n,σ\n2\n),\n(4)\nwhereθ\nm\n,θ\np\n∈R\nd\n,Bern(·)is","the","Bernoulli","distribution,\nandN(·,·)is","","the","","Gaussian","","distribution","","withσbeing","","its\nstandard","deviation.","By","adopting","the","formulation","in","Eq.","(4),\nthe","constraints","onmandpare","satisfied","while","the","optimiza-\ntion","variablesθ\nm\nandθ\np\nare","unconstrained.","","Therefore,","we\ndo","not","need","to","relaxmto","be","continuous","in[0,1]\nd\nas","the","pre-\nvious","methods","[19,","43]","do","and","can","perform","optimization","in\nthe","discrete","domain.","","The","experiments","also","reveal","different\nbehaviors","between","our","method","and","baselines.\nTo","solve","the","optimization","problem","(3),","we","need","to","esti-\nmate","its","gradients.","Note","thatmandpare","independent,","thus\nwe","","can","","represent","","their","","joint","","distributionπ(m,p|θ\nm\n,θ\np\n)\nbyπ\n1\n(m|θ\nm\n)π\n2\n(p|θ\np\n),","","in","","whichπ\n1\n(m|θ\nm\n)denotes","","the\nBernoulli","distribution","ofmandπ\n2\n(p|θ\np\n)denotes","the","trans-\nformation","of","Gaussian","ofp,","as","defined","in","Eq.","(4).","Hence,","we\ncan","estimate","the","gradients","ofJ(θ\nm\n,θ\np\n)with","respect","toθ\nm\n2\nWe","explain","why","we","do","not","adopt","natural","gradients","in","Appendix","A.\nAlgorithm","1Black-box","backdoor","detection","(B3D)\nInput:A","set","of","clean","imagesX;","a","target","classc;","the","loss","function\nin","Eq.","(2)","denoted","asF(m,p;c);","the","search","distributionπde-\nfined","in","Eq.","(4);","standard","deviation","of","Gaussianσ;","the","number\nof","samplesk;","the","number","of","iterationsT.\nOutput:The","parametersθ\nm\nandθ\np\nof","the","search","distributionπ.\n1:Initializeθ\nm\nandθ\np\n;\n2:fort=","1toTdo\n3:\nˆ\ng\nm\n←0,\nˆ\ng\np\n←0;\n4:Randomly","draw","a","minibatchX\nt\nfromX;\n5:forj=","1tokdo.Estimate","the","gradient","forθ\nm\n6:Drawm\nj\n∼Bern(g(θ\nm\n));\n7:\nˆ\ng\nm\n←\nˆ\ng\nm\n+F(m\nj\n,g(θ\np\n);c)·2(m\nj\n−g(θ\nm\n));\n8:end","for\n9:forj=","1tokdo.Estimate","the","gradient","forθ\np\n10:Draw\u000f\nj\n∼N(0,I);\n11:\nˆ\ng\np\n←\nˆ\ng\np\n+F(g(θ\nm\n),g(θ\np\n+σ\u000f\nj\n);c)·\u000f\nj\n;\n12:end","for\n13:Updateθ\nm\nbyθ\nm\n←Adam.step(θ\nm\n,\n1\nk\nˆ\ng\nm\n);\n14:Updateθ\np\nbyθ\np\n←Adam.step(θ\np\n,\n1\nkσ\nˆ\ng\np\n);\n15:end","for\nandθ\np\nseparately.","To","calculate∇\nθ\nm\nJ(θ\nm\n,θ\np\n),","we","denote\nF\n1\n(m)","=E\nπ\n2\n(p|θ\np\n)\n[F(m,p;c)].","Then","we","have\n∇\nθ\nm\nJ(θ\nm\n,θ\np\n)","=∇\nθ\nm\nE\nπ(m,p|θ\nm\n,θ\np\n)\n[F(m,p;c)]\n=∇\nθ\nm\nE\nπ\n1\n(m|θ\nm\n)\n[F\n1\n(m)]\n=E\nπ\n1\n(m|θ\nm\n)\n[F\n1\n(m)∇\nθ\nm\nlogπ\n1\n(m|θ\nm\n)]\n=E\nπ\n1\n(m|θ\nm\n)\n[\nF\n1\n(m)·2(m−g(θ\nm\n))\n]\n.\nIn","practice,","we","can","obtain","the","estimate","of","the","search","gradient\nby","approximating","the","expectation","overmwithksamples\nm\n1\n,...,m\nk\n∼π\n1\n(m|θ\nm\n).","","There","is","also","an","expectation","in\nF\n1\n(m).","","We","approximate","it","asF\n1\n(m)≈","F(m,g(θ\np\n);c).\nTherefore,","the","gradient∇\nθ\nm\nJ(θ\nm\n,θ\np\n)can","be","obtained","by\n∇\nθ\nm\nJ(θ\nm\n,θ\np\n)≈\n1\nk\nk\n∑\nj=1\nF\n1\n(m\nj\n)·2(m\nj\n−g(θ\nm\n))\n≈\n1\nk\nk\n∑\nj=1\nF(m\nj\n,g(θ\np\n);c)·2(m\nj\n−g(θ\nm\n)).\n(5)\nAs","can","be","seen","from","Eq.","(5),","the","gradient","can","be","estimated\nby","evaluating","the","loss","function","with","random","samples,","which\ncan","be","realized","under","the","black-box","setting","through","queries.\nSimilarly,","we","calculate","the","gradient∇\nθ\np\nJ(θ\nm\n,θ\np\n)as\n∇\nθ\np\nJ(θ\nm\n,θ\np\n)","=∇\nθ\np\nE\nπ\n2\n(p|θ\np\n)\n[F\n2\n(p)]\n=E\n\u000f∼N(0,I)\n[\nF\n2\n(g(θ\np\n+σ\u000f))·\n\u000f\nσ\n]\n,\nwhereF\n2\n(p)","=E\nπ\n1\n(m|θ\nm\n)\n[F(m,p;c)].","","We","reparameter-\nizepbyp=g(p\n′\n)","=g(θ\np\n+σ\u000f),","","where\u000ffollows","the\nstandard","Gaussian","distributionN(0,I)to","make","the","expres-\nsion","clearer.","We","approximateF\n2\n(p)byF(g(θ\nm\n),p;c)and\n4\n\nobtain","the","estimate","of","the","gradient∇\nθ\np\nJ(θ\nm\n,θ\np\n)with","an-\notherksamples\u000f\n1\n,...,\u000f\nk\n∼N(0,I)as\n∇\nθ\np\nJ(θ\nm\n,θ\np\n)≈\n1\nkσ\nk\n∑\nj=1\nF\n2\n(g(θ\np\n+σ\u000f\nj\n))·\u000f\nj\n≈\n1\nkσ\nk\n∑\nj=1\nF(g(θ\nm\n),g(θ\np\n+σ\u000f\nj\n);c)·\u000f\nj\n.\n(6)\nAfter","obtaining","the","estimated","gradients,","we","can","perform\ngradient","descent","to","iteratively","update","the","search","distribution\nparametersθ\nm\nandθ\np\n.","","We","adopt","the","same","strategy","as","NC,\nthat","the","Adam","optimizer","is","used","and","the","hyperparameterλ\nin","Eq.","(2)","is","adaptively","tuned.","We","outline","the","proposed","B3D\nalgorithm","in","Algorithm","1.","","In","Step","4,","we","draw","a","minibatch\nX\nt\nfrom","the","set","of","clean","imagesXand","evaluate","the","loss\nfunctionFbased","onX\nt\n.","Similar","to","NC,","after","we","get","the","re-\nversed","triggers","for","every","classc,","we","identify","outliers","based\non","theL\n1\nnorm","of","the","masks,","and","thereafter","detect","the","back-\ndoored","model","if","any","mask","exhibits","much","smallerL\n1\nnorm.\nThe","details","of","our","adopted","outlier","detection","method","will","be\nintroduced","in","the","experiments.\n3.4.","B3D","with","Synthetic","Samples","(B3D-SS)\nOne","limitation","of","the","B3D","algorithm","as","well","as","the","pre-\nvious","methods","[19,","43]","is","the","dependence","on","a","set","of","clean\nimages,","which","could","be","unavailable","in","practice.","To","perform\nbackdoor","detection","in","the","absence","of","any","clean","data,","a","sim-\nple","approach","is","to","adopt","a","set","of","synthetic","samples.","A","good\nset","of","synthetic","samples","should","satisfy","that","they","are","misclas-\nsified","as","the","target","class","by","adding","the","true","trigger","such","that\nthe","true","trigger","is","a","solution","of","Eq.","(2)","and","there","should","not\nexist","many","solutions","of","Eq.","(2)","such","that","we","can","recover","the\ntrue","trigger","instead","of","obtaining","other","incorrect","ones.\nIn","practice,","the","synthetic","samples","could","be","drawn","from","a\nrandom","distribution","or","created","by","generative","models","based\non","different","datasets.","Besides,","we","need","to","make","these","sam-\nples","well-distributed","over","all","classes","when","classified","by","the\nmodelf(x)because","in","an","extreme","case","that","they","are","mostly\nclassified","as","one","classc,","our","algorithm","would","always","gen-\nerate","a","very","small","trigger","for","classcbased","on","the","problem\nformulation","(2)","no","matter","whethercis","the","target","class","or","not.\nTo","this","end,","we","drawnrandom","imagesX\nc\n:={x\nc\ni\n}\nn\ni=1\nfor\neach","classcand","minimize`(c,f(x\nc\ni\n))with","respect","to","each\nimagex\nc\ni\n,","in","which`(·,·)is","the","cross-entropy","loss.","","There-\nfore,","the","resultant","synthetic","imagex\nc\ni\nwill","be","classified","as\ncbyf(x).","Under","the","black-box","setting,","we","use","a","gradient-\nfree","algorithm","similar","to","Eq.","(6)","to","optimizex\nc\ni\nas\nx\nc\ni\n←x\nc\ni\n−η·\n1\nkσ\nk\n∑\nj=1\n`(c,f(x\nc\ni\n+δ\nj\n))·δ\nj\n,(7)\nwhereηis","the","learning","rate","andδ\n1\n,...,δ\nk\nare","drawn","from\nN(0,I).","The","synthetic","dataset","is","composed","of","the","resultant\nCIFAR-10GTSRBImageNet\nNC","[43]95.0%100.0%96.0%\nTABOR","[19]\n95.5%100.0%95.0%\nB3D","(Ours)97.5%100.0%96.0%\nB3D-SS","(Ours)97.5%100.0%95.5%\nTable","2:","The","backdoor","detection","accuracy","of","NC,","TABOR,","B3D,","and","B3D-\nSS","on","the","CIFAR-10,","GTSRB,","and","ImageNet","datasets.\nimages","for","all","classes","asX=\n⋃\nC\nc=1\nX\nc\n,","which","is","further\nused","for","reverse-engineering","the","trigger","by","Algorithm","1.\n4.","Experiments\nDatasets.We","use","CIFAR-10","[27],","German","Traffic","Sign\nRecognition","Benchmark","(GTSRB)","[39],","and","ImageNet","[36]\ndatasets","to","conduct","experiments.","","On","each","dataset,","we","train\nhundreds","of","models","to","perform","comprehensive","evaluations.\nSome","of","them","are","normally","trained","while","the","others","have\nbeen","embedded","backdoors.","","We","will","detail","the","training","and\nbackdoor","attack","settings","in","Sec.","4.1","for","CIFAR-10,","Sec.","4.2\nfor","GTSRB,","and","Sec.","4.3","for","ImageNet.","Sec.","4.4","shows","the\neffectiveness","of","our","methods","under","various","settings.\nCompared","","methods.We","","compare","","B3D","","and","","B3D-SS\nwith","Neural","Cleanse","(NC)","[43]","and","TABOR","[19],","which","are\ntypical","and","state-of-the-art","methods","based","on","model","gradi-\nents.","","In","B3D","and","B3D-SS,","we","set","the","number","of","samples\nkas50,","","the","standard","deviation","of","Gaussianσas0.1,","","the\nlearning","rate","of","the","Adam","optimizer","as0.05.","","We","provide\nthe","implementation","details","and","more","analyses","on","the","hyper-\nparameters","in","Appendix","B.","The","optimization","is","conducted\nuntil","convergence.","After","obtaining","the","distribution","parame-\ntersθ\nm\nandθ\np\n,","we","could","generate","the","mask","by","discretiza-\ntion","asm=1[g(θ\nm\n)≥0.5]and","the","pattern","asp=g(θ\np\n).\nTo","compare","with","the","baselines,","","we","adopt","the","“soft”","mask\ng(θ\nm\n)in","experiments.","","TABOR","introduces","several","regular-\nizations","to","improve","the","performance","of","backdoor","detection.\nAlthough","our","algorithm","is","based","on","the","problem","formula-\ntion","(2)","similar","to","NC,","it","can","easily","be","extended","to","others\n(e.g.,","TABOR),","which","we","leave","to","future","work.\nOutlier","","detection.Given","","the","","reversed","","triggers","","for","","all\nclasses,","we","calculate","theirL\n1\nnorm","and","perform","outlier","de-\ntection","to","identify","very","small","triggers","(i.e.,","outliers).","We","ob-\nserve","that","the","Median","Absolute","Deviation","(MAD)","adopted\nin","NC","performs","poorly","in","some","cases","due","to","the","assumption\nof","a","Gaussian","distribution,","which","does","not","hold","for","all","cases,\nespecially","when","the","number","of","classesCis","small.","","Hence,\nwe","further","add","a","heuristic","rule","to","identify","small","triggers","by\njudging","whether","theL\n1\nnorm","of","any","mask","is","smaller","than\none","fourth","of","their","median.","","This","method","is","also","applied","to\nNC","to","improve","the","baseline","performance.\nEvaluations.Table","2","shows","the","overall","backdoor","detec-\ntion","accuracy","of","all","methods","on","three","datasets.","","Our","meth-\nods","achieve","comparable","or","even","better","performance","than","the\nbaselines,","while","rely","on","weak","assumptions","(i.e.,","black-box\n5\n\nModelAccuracyASRMethod\nReversed","TriggerDetection","Results\nL\n1\nnormASRCase","ICase","IICase","IIICase","IV\nNormal89.30%N/A\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\n8/50\n4/50\n2/50\n3/50\n42/50\n46/50\n48/50\n47/50\nBackdoored\n(1×1trigger)\n88.35%99.75%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n0.588\n0.672\n0.820\n3.734\n98.76%\n99.11%\n99.29%\n99.98%\n40/50\n36/50\n36/50\n35/50\n9/50\n13/50\n12/50\n15/50\n0/50\n0/50\n0/50\n0/50\n1/50\n1/50\n2/50\n0/50\nBackdoored\n(2×2trigger)\n88.51%100.00%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n1.508\n2.256\n2.310\n2.867\n98.81%\n99.21%\n98.94%\n99.13%\n47/50\n44/50\n47/50\n47/50\n2/50\n3/50\n3/50\n2/50\n0/50\n0/50\n0/50\n0/50\n1/50\n3/50\n0/50\n1/50\nBackdoored\n(3×3trigger)\n88.57%100.00%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n2.264\n2.493\n3.521\n3.856\n98.71%\n98.84%\n98.87%\n96.97%\n49/50\n48/50\n47/50\n47/50\n1/50\n1/50\n2/50\n2/50\n0/50\n0/50\n0/50\n0/50\n0/50\n1/50\n1/50\n1/50\nTable","3:","The","results","of","backdoor","detection","on","CIFAR-10.","","For","normal","and","backdoored","models","with","different","trigger","sizes,","we","show","their","average","accuracy\nand","backdoor","attack","success","rates","(ASR).","For","the","four","backdoor","detection","methods","—","NC,","TABOR,","B3D,","and","B3D-SS,","we","report","theL\n1\nnorm","and","attack\nsuccess","rates","of","the","reversed","trigger","corresponding","to","the","target","class,","as","well","as","the","detection","results","in","four","cases.\nsetting)","for","backdoor","detection,","validating","the","effectiveness\nof","our","methods.","In","addition","to","the","coarse","results,","we","further\nconduct","sophisticated","analyses","of","the","performance","of","differ-\nent","methods","on","each","dataset.","Specifically,","we","consider","four\ncases","of","backdoor","detection","for","an","algorithmA:\n•Case","I:Asuccessfully","identifies","a","backdoored","model\nand","correctly","discovers","the","true","target","class","without","re-\nporting","other","backdoor","attacks","for","uninfected","classes.\n•Case","II:Asuccessfully","identifies","a","backdoored","model\nbut","","discovers","","multiple","","backdoor","","attacks","","for","","both","","the\ntrue","target","class","and","other","uninfected","classes.\n•Case","","III:Awrongly","","identifies","","a","","normal","","model","","as\nbackdoored","or","wrongly","discovers","backdoor","attacks","for\nuninfected","classes","excluding","the","true","target","class","of","a\nbackdoored","model.\n•Case","IV:Asuccessfully","identifies","a","normal","model","or\nwrongly","identifies","a","backdoored","model","as","normal.\nIn","the","following,","we","introduce","the","detailed","experimental\nresults","on","each","dataset.\n4.1.","CIFAR-10\nWe","adopt","the","ResNet-18","[22]","architecture","on","CIFAR-10.\nThe","backdoor","attacks","are","implemented","using","the","BadNets\napproach","[18].","We","consider","the","triggers","of","size1×1,2×2,\nand3×3.","","For","each","size,","we","train50backdoored","models\nusing","different","triggers","and","target","classes","with5models","per\ntarget","class.","The","triggers","are","generated","in","random","positions\nand","have","random","colors.","We","poison10%training","data.","Be-\nsides,","we","also","train50normal","models","with","different","random\nseeds,","resulting","in","a","total","number","of200models.","","We","train\nthem","for200epochs","without","using","data","augmentation.","The\naccuracy","on","the","clean","test","set","and","the","backdoor","attack","suc-\ncess","rates","(ASR)","are","shown","in","Table","3","(column","2-3).\nMaskMask*Pattern\nNC\nB3D\nB3D-SS\nOriginal\n1⇥1\ntrigger\n2⇥2\n3⇥3\ntriggertrigger\nMaskMask*PatternMaskMask*Pattern\nFigure","2:","","Visualization","of","the","original","triggers","and","the","reversed","triggers\noptimized","by","NC,","B3D,","and","B3D-SS","on","CIFAR-10.\nTo","perform","backdoor","detection,","NC,","TABOR,","and","B3D\nadopt","the10,000clean","test","images,","while","B3D-SS","adopts\n1,000synthetic","images","with100per","class.","","In","Table","3,","we\nreport","theL\n1\nnorm","and","the","attack","success","rates","(ASR)","of","the\nreversed","trigger","corresponding","to","the","true","target","class","for","the\nbackdoored","models.","","We","also","report","the","number","of","models\nbelonging","to","the","four","cases","of","backdoor","detection.","In","Fig.","2,\nwe","visualize","the","original","triggers","and","the","reversed","triggers\noptimized","by","NC,","B3D,","and","B3D-SS","with","different","trigger\nsizes.","From","the","results,","we","draw","the","findings","below.\nFirst,","the","reversed","triggers","of","NC","have","smallerL\n1\nnorm\nthan","B3D","and","B3D-SS.","It","is","reasonable","since","NC","performs\ndirect","optimization","using","gradients.","However,","as","NC","relaxes\nthe","maskmto","be","continuous","in[0,1]\nd\n,","the","optimized","masks\nshown","in","Fig.","2","tend","to","have","small","amplitudes.","For","B3D","and\nB3D-SS,","since","we","letmfollow","the","Bernoulli","distribution,\nthe","","optimized","","masks","","have","","values","","closer","","to0(black)","","or1\n(white),","which","is","in","accordance","with","the","formulation","(1).\n6\n\nModelAccuracyASRMethod\nReversed","TriggerDetection","Results\nL\n1\nnormASRCase","ICase","IICase","IIICase","IV\nNormal98.84%N/A\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\n0/43\n0/43\n0/43\n0/43\n43/43\n43/43\n43/43\n43/43\nBackdoored\n(1×1trigger)\n98.74%99.53%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n0.737\n0.543\n0.922\n3.079\n98.90%\n99.24%\n98.86%\n100.00%\n14/43\n19/43\n10/43\n12/43\n29/43\n24/43\n33/43\n31/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\nBackdoored\n(2×2trigger)\n98.79%100.00%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n1.439\n1.783\n2.260\n2.351\n98.75%\n99.15%\n99.04%\n97.96%\n27/43\n22/43\n27/43\n25/43\n16/43\n21/43\n16/43\n18/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\nBackdoored\n(3×3trigger)\n98.79%100.00%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n2.264\n2.764\n3.758\n3.048\n98.71%\n99.22%\n98.87%\n94.87%\n39/43\n35/43\n34/43\n33/43\n4/43\n8/43\n9/43\n10/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\n0/43\nTable","4:","","The","results","of","backdoor","detection","on","GTSRB.","For","normal","and","backdoored","models","with","different","trigger","sizes,","we","show","their","average","accuracy\nand","backdoor","attack","success","rates","(ASR).","For","the","four","backdoor","detection","methods","—","NC,","TABOR,","B3D,","and","B3D-SS,","we","report","theL\n1\nnorm","and","attack\nsuccess","rates","of","the","reversed","trigger","corresponding","to","the","target","class,","as","well","as","the","detection","results","in","four","cases.\nClass:","0Class:","1Class:","2Class:","3Class:","4\nClass:","5Class:","6Class:","7Class:","8Class:","9\nFigure","3:","","Visualization","of","the","reversed","triggers","optimized","by","B3D","for","all\nclasses","on","CIFAR-10.","The","true","target","class","is","0,","but","B3D","reports","two","back-\ndoor","attacks","corresponding","to","class","0","and","9.\nSecond,","as","can","be","seen","from","Table","3,","NC","wrongly","iden-\ntifies","more","normal","models","as","backdoored","(i.e.,8out","of50)\nthan","B3D","and","B3D-SS.","It","is","also","because","that","NC","relaxes","the\nmaskmto[0,1]\nd\n.","","Thus","NC","sometimes","optimizes","a","mask\nwith","smallL\n1\nnorm","for","an","uninfected","class,","which","does","not\nresemble","true","backdoor","patterns","and","is","identified","as","an","out-\nlier","by","MAD.","But","B3D","and","B3D-SS","perform","optimization\nin","the","discrete","domain,","which","are","less","prone","to","this","problem.\nWe","will","further","discuss","this","phenomenon","in","Appendix","C.\nThird,","we","find","that","many","backdoored","models,","especially\nthose","with1×1triggers,","can","be","found","multiple","backdoors\n(i.e.,","Case","II),","as","shown","in","Table","3.","We","verify","that","a","chosen\nbackdoored","model","truly","has","two","backdoors","in","Fig.","3.","So","we\nthink","that","backdoor","attacks","through","data","poisoning","can","not\nonly","affect","the","behavior","of","the","model","corresponding","to","the\ntrue","target","class,","but","also","interfere","other","uninfected","classes.\nFourth,","as","shown","in","Fig.","2,","the","reversed","triggers","can","have\ndifferent","positions","and","patterns","compared","with","the","original\ntriggers.","It","indicates","that","a","backdoored","model","would","learn","a\ndistribution","of","triggers","by","generalizing","the","original","one","[34].\nWe","provide","further","analysis","on","the","effective","input","positions\nof","backdoor","attacks","in","Appendix","D.\n4.2.","GTSRB\nWe","adopt","the","same","model","architecture","(i.e.,","ResNet-18)\nand","backdoor","injection","method","(i.e.,","BadNets)","as","in","CIFAR-\n10.","Since","GTSRB","has43classes,","we","train","one","backdoored\nmodel","for","each","class,","resulting","in43backdoored","models","for\na","specific","trigger","size.","","We","train","another43normal","models\nfor","comparison.","","","These","models","are","trained","for50epochs.\nFor","backdoor","inspection,","NC,","TABOR,","and","B3D","adopt","the\n12,630clean","test","images","for","optimization,","while","B3D-SS\ngenerates4,300synthetic","images","with100per","class.\nThe","detailed","experimental","results","on","the","statistics","of","the\nreversed","triggers","and","the","backdoor","detection","accuracy","are\npresented","in","Table","4.","","The","observations","are","consistent","with\nthose","on","CIFAR-10.","","We","also","find","that","the","backdoor","detec-\ntion","accuracy","achieves100%.","We","think","that","the","perfect","de-\ntection","accuracy","is","partially","a","consequence","of","more","classes\nin","this","dataset,","which","enables","the","outlier","detection","method\nto","correctly","find","outliers","with","more","data","points.\n4.3.","ImageNet\nSince","the","original","ImageNet","dataset","contains","more","than\n14million","images,","it","is","hard","to","train","hundreds","of","models","on\nit.","","Hence,","we","use","a","subset","of10classes,","where","each","class\nhas∼1,300images.","","The","test","set","is","composed","of500im-\nages","with50per","class.","These","images","have","the","resolution","of\n224×224.","We","also","adopt","the","ResNet-18","model.","For","back-\ndoor","attacks,","we","consider","three","pre-defined","patterns","shown\nin","Table","5","of","size15×15as","the","triggers","rather","than","the","ran-\ndomly","generated","triggers.","","Similar","to","the","experimental","set-\ntings","on","CIFAR-10,","we","train50backdoored","models","using\neach","trigger,","in","which5models","per","target","class","are","trained\nwith","the","trigger","stamped","at","random","positions.","For","backdoor\ndetection,","NC,","TABOR,","and","B3D","adopt","the500test","images,\nwhile","B3D-SS","utilizes1,000synthetic","images","generated","by\n7\n\nModelAccuracyASRMethod\nReversed","TriggerDetection","Results\nL\n1\nnormASRCase","ICase","IICase","IIICase","IV\nNormal88.46%N/A\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\n2/50\n1/50\n0/50\n1/50\n48/50\n49/50\n50/50\n49/50\nBackdoored\n(Trigger)\n87.91%99.95%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n62.093\n57.569\n86.083\n120.822\n99.11%\n99.25%\n99.14%\n97.57%\n45/50\n43/50\n43/50\n42/50\n0/50\n0/50\n0/50\n0/50\n0/50\n0/50\n0/50\n0/50\n5/50\n7/50\n7/50\n8/50\nBackdoored\n(Trigger)\n87.52%99.68%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n20.610\n22.035\n23.497\n24.124\n99.12%\n99/24%\n99.09%\n97.15%\n50/50\n47/50\n50/50\n44/50\n0/50\n2/50\n0/50\n6/50\n0/50\n0/50\n0/50\n0/50\n0/50\n1/50\n0/50\n0/50\nBackdoored\n(Trigger)\n87.39%99.94%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n38.701\n37.499\n56.636\n37.253\n99.14%\n99.20%\n99.13%\n97.44%\n48/50\n46/50\n48/50\n49/50\n1/50\n3/50\n1/50\n1/50\n0/50\n0/50\n0/50\n0/50\n1/50\n1/50\n1/50\n0/50\nTable","5:","","The","results","of","backdoor","detection","on","ImageNet.","","For","normal","and","backdoored","models","with","different","triggers,","we","show","their","average","accuracy","and\nbackdoor","attack","success","rates","(ASR).","For","the","dour","backdoor","detection","methods","—","NC,","TABOR,","B3D,","and","B3D-SS,","we","report","theL\n1\nnorm","and","attack\nsuccess","rates","of","the","reversed","trigger","corresponding","to","the","target","class,","as","well","as","the","detection","results","in","four","cases.\nBigGAN","[3],","due","to","the","poor","performance","of","using","random\nnoises","in","the","high-dimensional","image","space","of","ImageNet.\nWe","show","the","backdoor","detection","results","on","ImageNet","in\nTable","5.","","Similar","to","the","results","on","CIFAR-10","and","GTSRB,\nour","proposed","B3D","and","B3D-SS","methods","can","achieve","com-\nparable","performance","with","the","baselines.","","The","reversed","trig-\ngers","also","exhibit","different","visual","appearance","compared","with\nthe","original","triggers,","as","shown","in","Appendix","E.\n4.4.","Ablation","Study","on","More","Settings\nBesides","the","above","experiments,","we","further","demonstrate\nthe","generalizability","of","the","proposed","methods","B3D","and","B3D-\nSS","by","considering","more","settings,","including:\n•Other","backdoor","attacks.We","study","the","blended","injec-\ntion","attack","[9]","and","label-consistent","attack","[42]","to","insert\nbackdoors","besides","BadNets.\n•Different","model","architectures.We","study","a","VGG","[38]\nmodel","architecture","besides","the","ResNet","model.\n•Data","augmentation.We","investigate","the","effects","of","data\naugmentation","for","backdoor","attacks","and","detection.\n•Multiple","infected","classes","with","different","triggers.We\nconsider","the","scenario","that","multiple","backdoors","with","dif-\nferent","target","classes","are","embedded","in","a","model.\n•Single","infected","class","with","multiple","triggers.We","con-\nsider","the","scenario","that","multiple","backdoors","with","a","single\ntarget","class","are","embedded","in","a","model.\nDue","to","the","space","limitation,","","the","complete","experiments","on\nthese","settings","are","deferred","to","Appendix","F.\n5.","Mitigation","of","Backdoor","Attacks\nOnce","a","backdoor","attack","has","been","detected,","we","can","fur-\nther","mitigate","the","backdoor","to","preserve","the","model","utility","for\nusers.","Under","the","studied","black-box","setting,","we","are","unable","to\nCIFAR-10GTSRBImageNet\nSTRIP","[15]0.93320.49370.7126\nKernel","Density","[24]0.95850.98740.9328\nNC","[43]0.99480.99620.9812\nTABOR","[19]0.99370.99530.9842\nB3D","(Ours)0.99580.99460.9806\nB3D-SS","(Ours)\n0.98560.99240.9833\nTable","6:","The","AUC-scores","of","detecting","triggered","inputs","during","inference","on\nthe","CIFAR-10,","GTSRB,","and","ImageNet","datasets.","","We","use","the","metricS(x)\nin","Eq.","(8)","with","the","reversed","triggers","given","by","NC,","TABOR,","B3D,","and","B3D-\nSS,","respectively.","","The","performance","is","compared","with","additional","baselines,\nincluding","STRIP","[15]","and","the","kernel","density","method","[24].\nmodify","the","model","weights,","such","that","the","typical","re-training\nor","fine-tuning","[30,","41,","43]","strategies","cannot","be","utilized.","","In\nthis","section,","we","introduce","a","simple","and","effective","strategy","for\nreliable","predictions","by","rejecting","any","adversary-crafted","input\nwith","the","backdoor","trigger","stamped","during","inference.\nAssume","that","we","have","detected","a","backdoored","modelf(x)\nand","discovered","the","true","target","classy\nt\n.","","The","optimized","trig-\nger","for","the","target","class","is","denoted","as(m,p).","The","basic","intu-\nition","behind","our","method","is","as","follows.","For","a","clean","inputx\nc\nand","a","triggered","inputx\na\ncrafted","by","the","adversary,","the","pre-\ndictions","ofx\nc\nandA(x\nc\n,m,p)by","applying","the","reversed\ntrigger","are","extremely","different,","while","the","predictions","ofx\na\nandA(x\na\n,m,p)are","similar.","","The","rationale","is","that","bothx\na\nandA(x\na\n,m,p)have","the","trigger","stamped","and","are","classified\nas","the","target","classy\nt\nwith","similar","probability","distributions.\nTherefore,","for","an","arbitrary","inputx,","we","let\nS(x)","=D\nKL\n(\nf(x)||f(A(x,m,p))\n)\n(8)\nmeasure","the","similarity","between","the","model","predictionsf(x)\nandf(A(x,m,p)),","whereD\nKL\nis","the","Kullback-Leibler","di-\nvergence.","IfS(x)is","large,xis","probably","a","clean","input,","and\notherwisexhas","the","trigger","stamped,","which","will","be","rejected\nwithout","a","prediction.","Based","on","the","metricS(x),","we","perform\n8\n\nbinary","classification","of","clean","inputs","and","triggered","inputs","on\neach","dataset’s","test","set.","","We","report","the","AUC-scores","averaged\nover","all","backdoored","models","in","Table","6.","","Using","the","reversed\ntriggers","optimized","by","any","method,","the","proposed","strategy","can\nreliably","detect","the","triggered","inputs,","achieving","better","perfor-\nmance","than","alternative","baselines","[15,","24].\n6.","Conclusion\nIn","this","paper,","we","proposed","a","black-box","backdoor","detec-\ntion","(B3D)","method","to","identify","backdoored","models","under","the\nblack-box","setting.","By","formulating","backdoor","detection","as","an\noptimization","problem,","B3D","solves","the","problem","with","model\nqueries","only.","","B3D","can","also","be","utilized","with","synthetic","sam-\nples.","","We","further","introduced","a","simple","and","effective","strategy\nto","mitigate","the","discovered","backdoor","for","reliable","predictions.\nWe","conducted","extensive","experiments","on","several","datasets","to\ndemonstrate","the","effectiveness","of","the","proposed","methods.","Our\nmethods","reach","comparable","or","even","better","performance","than\nthe","previous","methods","based","on","stronger","assumptions.\nReferences\n[1]","","Eugene","","Bagdasaryan,","","Andreas","","Veit,","","Yiqing","","Hua,","","Deborah\nEstrin,","","and","Vitaly","Shmatikov.","","","How","to","backdoor","federated\nlearning.","","","InInternational","","Conference","","on","","Artificial","","Intelli-\ngence","and","Statistics,","pages","2938–2948,","2020.","2\n[2]","","Battista","Biggio","and","Fabio","Roli.","","Wild","patterns:","Ten","years","af-\nter","the","rise","of","adversarial","machine","learning.Pattern","Recog-\nnition,","84:317–331,","2018.","1\n[3]","","Andrew","Brock,","Jeff","Donahue,","and","Karen","Simonyan.","","Large\nscale","","gan","","training","","for","","high","","fidelity","","natural","","image","","synthe-\nsis.","","","InInternational","","Conference","","on","","Learning","","Representa-\ntions","(ICLR),","2019.","8\n[4]","","Nicholas","Carlini","and","David","Wagner.","","Towards","evaluating","the\nrobustness","of","neural","networks.","InIEEE","Symposium","on","Secu-\nrity","and","Privacy","(SP),","pages","39–57,","2017.","1\n[5]","","Anirban","","Chakraborty,","","","Manaar","","Alam,","","","Vishal","","Dey,","","","Anu-\npam","","Chattopadhyay,","","and","","Debdeep","","Mukhopadhyay.Ad-\nversarial","","attacks","","and","","defences:","","","A","","survey.arXiv","","preprint\narXiv:1810.00069,","2018.","1\n[6]","","Alvin","Chan","and","Yew-Soon","Ong.","","Poison","as","a","cure:","","Detect-\ning","&","neutralizing","variable-sized","backdoor","attacks","in","deep\nneural","networks.arXiv","preprint","arXiv:1911.08040,","2019.","2\n[7]","","Bryant","","Chen,","","Wilka","","Carvalho,","","Nathalie","","Baracaldo,","","Heiko\nLudwig,","Benjamin","Edwards,","Taesung","Lee,","Ian","Molloy,","and\nBiplav","","Srivastava.Detecting","","backdoor","","attacks","","on","","deep\nneural","","networks","","by","","activation","","clustering.arXiv","","preprint\narXiv:1811.03728,","2018.","2,","3\n[8]","","Huili","Chen,","Cheng","Fu,","Jishen","Zhao,","and","Farinaz","Koushan-\nfar.","","Deepinspect:","","A","black-box","trojan","detection","and","mitiga-\ntion","framework","for","deep","neural","networks.","","InProceedings","of\nthe","Twenty-Eighth","International","Joint","Conference","on","Artifi-\ncial","Intelligence","(IJCAI),","pages","4658–4664,","2019.","2,","3\n[9]","","Xinyun","Chen,","Chang","Liu,","Bo","Li,","Kimberly","Lu,","and","Dawn\nSong.","","Targeted","backdoor","attacks","on","deep","learning","systems\nusing","","data","","poisoning.arXiv","","preprint","","arXiv:1712.05526,\n2017.","1,","2,","8,","13\n[10]","","Edward","","Chou,","","Florian","","Tramer,","","and","","Giancarlo","","Pellegrino.\nSentinet:","","Detecting","localized","universal","attack","against","deep\nlearning","systems.IEEE","Symposium","on","Security","and","Privacy\nWorkshops","(SPW),","2020.","2\n[11]","","B","","Gia","","Doan,","","Ehsan","","Abbasnejad,","","and","","Damith","","C","","Ranas-\ninghe.","","","","Februus:","","","Input","","purification","","defense","","against","","trojan\nattacks","","on","","deep","","neural","","network","","systems.arXiv","","preprint\narXiv:1908.03369,","2019.","2\n[12]","","Yinpeng","Dong,","Fangzhou","Liao,","Tianyu","Pang,","Hang","Su,","Jun\nZhu,","Xiaolin","Hu,","and","Jianguo","Li.","","","Boosting","adversarial","at-\ntacks","with","momentum.","","InProceedings","of","the","IEEE","Confer-\nence","on","Computer","Vision","and","Pattern","Recognition","(CVPR),\npages","9185–9193,","2018.","1\n[13]","","Min","Du,","Ruoxi","Jia,","and","Dawn","Song.","","","Robust","anomaly","de-\ntection","","and","","backdoor","","attack","","detection","","via","","differential","","pri-\nvacy.","","","InInternational","","Conference","","on","","Learning","","Represen-\ntations","(ICLR),","2020.","2\n[14]","","Jacob","","Dumford","","and","","Walter","","Scheirer.","","","Backdooring","","convo-\nlutional","neural","networks","via","targeted","weight","perturbations.\narXiv","preprint","arXiv:1812.03128,","2018.","2\n[15]","","Yansong","","Gao,","","Change","","Xu,","","Derui","","Wang,","","Shiping","","Chen,\nDamith","C","Ranasinghe,","and","Surya","Nepal.","","Strip:","","A","defence\nagainst","","trojan","","attacks","","on","","deep","","neural","","networks.InPro-\nceedings","of","the","35th","Annual","Computer","Security","Applications\nConference","(ACSAC),","pages","113–125,","2019.","2,","8,","9\n[16]","","Ian","","Goodfellow,","","","Yoshua","","Bengio,","","","and","","Aaron","","Courville.\nDeep","","Learning.MIT","","Press,","","","2016.http://www.\ndeeplearningbook.org.","1\n[17]","","Ian","J","Goodfellow,","Jonathon","Shlens,","and","Christian","Szegedy.\nExplaining","and","harnessing","adversarial","examples.","","","InInter-\nnational","","Conference","","on","","Learning","","Representations","","(ICLR),\n2015.","1\n[18]","","Tianyu","Gu,","Brendan","Dolan-Gavitt,","and","Siddharth","Garg.","Bad-\nnets:","","","Identifying","","vulnerabilities","","in","","the","","machine","","learning\nmodel","supply","chain.arXiv","preprint","arXiv:1708.06733,","2017.\n1,","2,","3,","6\n[19]","","Wenbo","Guo,","","Lun","Wang,","","Xinyu","Xing,","","Min","Du,","","and","Dawn\nSong.","","Tabor:","","A","highly","accurate","approach","to","inspecting","and\nrestoring","","trojan","","backdoors","","in","","ai","","systems.arXiv","","preprint\narXiv:1908.01763,","2019.","2,","3,","4,","5,","6,","7,","8,","11,","13\n[20]","","Momchil","","","Halstrup.Black-box","","","optimization","","","of","","","mixed\ndiscrete-continuous","optimization","problems.","","PhD","thesis,","TU\nDortmund","University,","2016.","4\n[21]","","Haripriya","","Harikumar,","","Vuong","","Le,","","Santu","","Rana,","","Sourangshu\nBhattacharya,","","Sunil","","Gupta,","","and","","Svetha","","Venkatesh.","","","","Scal-\nable","backdoor","detection","in","neural","networks.arXiv","preprint\narXiv:2006.05646,","2020.","2,","3\n[22]","","Kaiming","He,","Xiangyu","Zhang,","Shaoqing","Ren,","and","Jian","Sun.\nDeep","residual","learning","for","image","recognition.","","","InProceed-\nings","of","the","IEEE","Conference","on","Computer","Vision","and","Pattern\nRecognition","(CVPR),","pages","770–778,","2016.","6\n[23]","","Xijie","Huang,","Moustafa","Alzantot,","and","Mani","Srivastava.","Neu-\nroninspect:","Detecting","backdoors","in","neural","networks","via","out-\nput","","explanations.arXiv","","preprint","","arXiv:1911.07399,","","2019.\n2\n9\n\n[24]","","Kaidi","","Jin,","","Tianwei","","Zhang,","","Chao","","Shen,","","Yufei","","Chen,","","Ming\nFan,","Chenhao","Lin,","and","Ting","Liu.","","A","unified","framework","for\nanalyzing","and","detecting","malicious","examples","of","dnn","models.\narXiv","preprint","arXiv:2006.14871,","2020.","8,","9\n[25]","","Diederik","","Kingma","","and","","Jimmy","","Ba.","","","","Adam:","","","A","","method","","for\nstochastic","","optimization.InInternational","","Conference","","on\nLearning","Representations","(ICLR),","2015.","3\n[26]","","Soheil","","Kolouri,","","Aniruddha","","Saha,","","Hamed","","Pirsiavash,","","and\nHeiko","Hoffmann.","Universal","litmus","patterns:","Revealing","back-\ndoor","attacks","in","cnns.","","InProceedings","of","the","IEEE/CVF","Con-\nference","on","Computer","Vision","and","Pattern","Recognition,","pages\n301–310,","2020.","2,","3\n[27]","","Alex","","Krizhevsky","","and","","Geoffrey","","Hinton.","","","Learning","","multiple\nlayers","of","features","from","tiny","images.","","Technical","report,","Uni-\nversity","of","Toronto,","2009.","5\n[28]","","Ram","Shankar","Siva","Kumar,","Magnus","Nystr\n","̈\nom,","John","Lambert,\nAndrew","Marshall,","Mario","Goertzel,","Andi","Comissoneru,","Matt\nSwann,","","and","","Sharon","","Xia.Adversarial","","machine","","learning–\nindustry","","perspectives.arXiv","","preprint","","arXiv:2002.05646,\n2020.","1\n[29]","","Yiming","Li,","Baoyuan","Wu,","Yong","Jiang,","Zhifeng","Li,","and","Shu-\nTao","","Xia.","","","","Backdoor","","learning:","","","A","","survey.arXiv","","preprint\narXiv:2007.08745,","2020.","3\n[30]","","Kang","Liu,","Brendan","Dolan-Gavitt,","and","Siddharth","Garg.","Fine-\npruning:","","","Defending","","against","","backdooring","","attacks","","on","","deep\nneural","networks.","InInternational","Symposium","on","Research","in\nAttacks,","Intrusions,","and","Defenses,","pages","273–294.","Springer,\n2018.","2,","8\n[31]","","Yingqi","","Liu,","","Shiqing","","Ma,","","Yousra","","Aafer,","","Wen-Chuan","","Lee,\nJuan","Zhai,","Weihang","Wang,","and","Xiangyu","Zhang.","","Trojaning\nattack","on","neural","networks.","","InProceedings","of","the","25th","Net-\nwork","and","Distributed","System","Security","Symposium","(NDSS),\n2018.","1,","2\n[32]","","Yunfei","Liu,","Xingjun","Ma,","James","Bailey,","and","Feng","Lu.","","","Re-\nflection","backdoor:","","A","natural","backdoor","attack","on","deep","neu-\nral","networks.","","InEuropean","Conference","on","Computer","Vision\n(ECCV),","2020.","2\n[33]","","Yuntao","Liu,","","Yang","Xie,","","and","Ankur","Srivastava.","","","Neural","tro-\njans.","InIEEE","International","Conference","on","Computer","Design\n(ICCD),","pages","45–48.","IEEE,","2017.","2\n[34]","","Ximing","Qiao,","","Yukun","Yang,","","and","Hai","Li.","","","Defending","neural\nbackdoors","via","generative","distribution","modeling.","InAdvances\nin","Neural","Information","Processing","Systems","(NeurIPS),","pages\n14004–14013,","2019.","2,","3,","7\n[35]","","Adnan","Siraj","Rakin,","Zhezhi","He,","and","Deliang","Fan.","","Tbt:","","Tar-\ngeted","neural","network","attack","with","bit","trojan.","InProceedings","of\nthe","IEEE/CVF","Conference","on","Computer","Vision","and","Pattern\nRecognition","(CVPR),","pages","13198–13207,","2020.","2\n[36]","","Olga","Russakovsky,","Jia","Deng,","Hao","Su,","Jonathan","Krause,","San-\njeev","Satheesh,","Sean","Ma,","Zhiheng","Huang,","Andrej","Karpathy,\nAditya","","Khosla,","","Michael","","Bernstein,","","et","","al.","","","","Imagenet","","large\nscale","visual","recognition","challenge.International","Journal","of\nComputer","Vision,","115(3):211–252,","2015.","5\n[37]","","Aniruddha","Saha,","Akshayvarun","Subramanya,","and","Hamed","Pir-\nsiavash.","","Hidden","trigger","backdoor","attacks.","","InThirty-Fourth\nAAAI","Conference","on","Artificial","Intelligence","(AAAI),","2020.","2\n[38]","","Karen","","Simonyan","","and","","Andrew","","Zisserman.","","","Very","","deep","","con-\nvolutional","networks","for","large-scale","image","recognition.","InIn-\nternational","Conference","on","Learning","Representations","(ICLR),\n2015.","8,","13\n[39]","","Johannes","","Stallkamp,","","","Marc","","Schlipsing,","","","Jan","","Salmen,","","","and\nChristian","Igel.","","Man","vs.","computer:","","Benchmarking","machine\nlearning","algorithms","for","traffic","sign","recognition.Neural","net-\nworks,","32:323–332,","2012.","5\n[40]","","Christian","Szegedy,","Wojciech","Zaremba,","Ilya","Sutskever,","Joan\nBruna,","Dumitru","Erhan,","Ian","Goodfellow,","and","Rob","Fergus.","In-\ntriguing","properties","of","neural","networks.","InInternational","Con-\nference","on","Learning","Representations","(ICLR),","2014.","1\n[41]","","Brandon","Tran,","Jerry","Li,","and","Aleksander","Madry.","Spectral","sig-\nnatures","in","backdoor","attacks.","InAdvances","in","Neural","Informa-\ntion","Processing","Systems","(NeurIPS),","pages","8000–8010,","2018.\n2,","3,","8\n[42]","","Alexander","","","Turner,Dimitris","","","Tsipras,and","","","Aleksander\nMadry.","","","Label-consistent","backdoor","attacks.arXiv","preprint\narXiv:1912.02771,","2019.","2,","8,","13\n[43]","","Bolun","Wang,","Yuanshun","Yao,","Shawn","Shan,","Huiying","Li,","Bi-\nmal","","Viswanath,","","Haitao","","Zheng,","","and","","Ben","","Y","","Zhao.","","","","Neural\ncleanse:","Identifying","and","mitigating","backdoor","attacks","in","neu-\nral","networks.","","InIEEE","Symposium","on","Security","and","Privacy\n(SP),","pages","707–723.","IEEE,","2019.","2,","3,","4,","5,","6,","7,","8,","11,","13\n[44]","","Daan","","Wierstra,","","Tom","","Schaul,","","Tobias","","Glasmachers,","","Yi","","Sun,\nJan","","","Peters,","","","and","","","J\n","̈\nurgen","","","Schmidhuber.Natural","","","evolu-\ntion","","strategies.Journal","","of","","Machine","","Learning","","Research,\n15(27):949–980,","2014.","4,","11\n[45]","","Zhen","Xiang,","David","J","Miller,","and","George","Kesidis.","","A","bench-\nmark","","study","","of","","backdoor","","data","","poisoning","","defenses","","for","","deep\nneural","network","classifiers","and","a","novel","defense.","In2019","IEEE\n29th","International","Workshop","on","Machine","Learning","for","Sig-\nnal","Processing","(MLSP),","pages","1–6.","IEEE,","2019.","2\n[46]","","Yuanshun","Yao,","Huiying","Li,","Haitao","Zheng,","and","Ben","Y","Zhao.\nLatent","backdoor","attacks","on","deep","neural","networks.","","","InPro-\nceedings","of","the","2019","ACM","SIGSAC","Conference","on","Computer\nand","Communications","Security,","pages","2041–2055,","2019.","2\n[47]","","Pu","Zhao,","Pin-Yu","Chen,","Payel","Das,","Karthikeyan","Natesan","Ra-\nmamurthy,","and","Xue","Lin.","Bridging","mode","connectivity","in","loss\nlandscapes","and","adversarial","robustness.","InInternational","Con-\nference","on","Learning","Representations","(ICLR),","2020.","2\n[48]","","Shihao","","Zhao,","","Xingjun","","Ma,","","Xiang","","Zheng,","","James","","Bailey,\nJingjing","","Chen,","","and","","Yu-Gang","","Jiang.","","","Clean-label","","backdoor\nattacks","","on","","video","","recognition","","models.InProceedings","","of\nthe","IEEE/CVF","Conference","on","Computer","Vision","and","Pattern\nRecognition","(CVPR),","pages","14443–14452,","2020.","2\n10\n\nA.","Natural","Gradients\nNatural","Evolution","Strategies","(NES)","[44]","adopt","the","natu-\nral","gradients","for","optimization,","because","[44]","illustrates","that\nthe","plain","search","gradients","make","the","optimization","very","un-\nstable","when","sampling","from","a","Gaussian","distribution","with","the\nlearnable","mean","and","covariance","matrix.","The","natural","gradient\nis","defined","as\n","̃\n∇\nθ\nJ=F\n−1\n∇\nθ\nJ(θ),(9)\nwhereθdenotes","the","search","distribution","parameter","andFis\nFisher","information","matrix","as\nF=E\nπ(·|θ)\n[\n∇\nθ\nlogπ(·|θ)∇\nθ\nlogπ(·|θ)\n>\n]\n.(10)\nIn","our","problem,","we","could","also","calculate","the","Fisher","infor-\nmation","matrices","for","the","search","distributionsπ\n1\n(m|θ\nm\n)and\nπ\n2\n(p|θ\np\n).","Forπ\n1\n(m|θ\nm\n),","we","have\nF=E\nπ\n1\n(m|θ\nm\n)\n[\n∇\nθ\nm\nlogπ\n1\n(m|θ\nm\n)∇\nθ\nm\nlogπ\n1\n(m|θ\nm\n)\n>\n]\n=E\nπ\n1\n(m|θ\nm\n)\n[\n4(m−g(θ\nm\n))(m−g(θ\nm\n))\n>\n]\n=","4·diag","(g(θ\nm\n)(1−g(θ\nm\n))),\nwherediag(·)denotes","the","diagonal","matrix.","If","the","optimiza-\ntion","onθ\nm\nis","nearly","converged,g(θ\nm\n)tends","to","be","close","to0\nor1since","the","maskmsampled","fromBern(g(θ\nm\n))should\nnot","change","dramatically","with","different","tries.","","Therefore,","the\ndiagonal","elements","inFtend","to","be0and","those","ofF\n−1\ntend\nto","be+∞.","Consequently,","the","optimization","would","be","rather\nunstable","if","we","adopt","natural","gradients.\nForπ\n2\n(p|θ\np\n),","note","that","the","variance","of","the","Gaussian","dis-\ntribution","","is","","fixed,","","and","","thus","","the","","Fisher","","information","","matrix\nbecomesI.","","In","this","case,","the","natural","gradients","are","the","same\nas","the","plain","gradients.","","Hence,","we","do","not","adopt","natural","gra-\ndients","for","optimization","in","our","problem.\nB.","Implementation","Details","and","Hyperparame-\nters\nThe","","implementation","","of","","Neural","","Cleanse","","(NC)","","[43]","","is\nbased","on","the","official","source","code\n3\n.","The","source","code","of","TA-\nBOR","[19]","was","not","released","by","the","authors.","","","Thus","we","im-\nplement","TABOR","based","on","another","(unofficial)","implemen-\ntation\n4\n.","","Our","proposed","B3D","follows","a","similar","optimization\nprocess","to","NC","but","replaces","the","white-box","gradients","by","the\nestimated","gradients,","as","detailed","in","Sec.","3.3.","","The","hyperpa-\nrameterλin","Eq.","(2)","is","adjusted","dynamically","according","to\nthe","backdoor","attack","success","rate","of","several","past","optimiza-\ntion","iterations,","which","is","also","based","on","the","implementation\nof","NC.\nIn","B3D","and","B3D-SS,","we","introduce","one","critical","hyperpa-\nrameterk(i.e.,","the","number","of","samples","to","estimate","the","gra-\ndient),","which","can","affect","the","performance","of","backdoor","detec-\ntion.","Ifkis","too","small,","the","estimated","gradient","exhibits","a","large\n3\nhttps://github.com/bolunwang/backdoor.\n4\nhttps://github.com/UsmannK/TABOR.\nvariance,","making","the","optimization","rather","unstable.","","Other-\nwise,","ifkis","too","large,","the","optimization","needs","more","queries\nand","time.","Therefore,","we","need","to","choose","a","suitablekto","have\na","relatively","small","variance","and","make","the","optimization","effi-\ncient.","","So","we","choosek=","50in","the","main","experiments","and\nwe","find","that","usingk∈[20,100]leads","to","similar","results.","The\noptimization","process","is","not","very","sensitive","to","differentk.\nIn","B3D-SS,","we","adopt","a","set","of","synthetic","samples","to","per-\nform","optimization.","","The","quality","of","the","synthetic","samples","is\nalso","a","critical","factor","to","affect","the","performance","of","our","algo-\nrithm.","","There","are","two","important","aspects","—","the","number","of\nsynthetic","samples","and","the","generation","method","of","synthetic\nsamples.","","Intuitively","speaking,","more","synthetic","samples","are\nbeneficial","for","reverse-engineering","the","true","trigger","since","the\noptimization","process","would","not","easily","drop","into","local","min-\nima.","","Empirically,","we","observe","that","using","thousands","of","syn-\nthetic","","samples","","is","","sufficient","","for","","optimization,","","and","","thus","","we\ndo","not","try","to","use","more.","","On","the","other","hand,","the","generation\nmethod","of","synthetic","samples","depends","on","the","datasets.","","For\nCIFAR-10","and","GTSRB,","we","find","that","using","randomly","gener-\nated","samples","from","a","uniform","distribution","can","help","to","restore\nthe","true","trigger.","","But","for","ImageNet,","the","randomly","generated\nsamples","are","not","helpful","since","the","input","dimension","is","much\nhigher.","Therefore,","we","adopt","synthetic","samples","generated","by\nBigGAN","to","perform","optimization.","","We","leave","the","study","on\nmore","choices","of","synthetic","samples","in","future","work.\nC.","Analysis","on","NC","and","B3D","for","Normal","Models\nIn","the","experiments,","we","find","that","NC","wrongly","identifies\nmore","normal","models","as","backdoored","than","B3D","and","B3D-SS,\nespecially","on","CIFAR-10.","We","provide","further","analysis","in","this\nsection.\nFig.","4","shows","an","example","of","the","wrong","identification","of\na","normal","model","by","NC","trained","on","CIFAR-10.","","Because","NC\nrelaxes","the","masks","to","be","continuous","in[0,1]\nd\n,","it","can","be","ob-\nserved","that","the","reversed","mask","by","NC","has","small","amplitude\nbut","covers","a","large","region.","","In","this","example,","class","1","is","iden-\ntified","as","an","infected","class","since","theL\n1\nnorm","of","the","mask","is\nsmaller","than","others","and","is","regarded","as","an","outlier","among","the\nmasks","of","all","classes.","However,","this","mask","does","not","resemble\nthe","masks","of","true","backdoor","patterns.","","In","B3D","and","B3D-SS,\nas","we","adopt","the","Bernoulli","distribution","to","model","the","masks,\nthe","optimized","masks","tend","to","be","close","to1.","","Thus","B3D","and\nB3D-SS","are","less","probable","to","optimize","a","mask","with","much\nsmallerL\n1\nnorm","for","a","specific","class.","","As","a","result,","B3D","and\nB3D-SS","are","less","prone","to","this","problem.\nD.","Effective","Positions","of","Backdoor","Attacks\nAlthough","we","typically","embed","a","backdoor","in","a","model","at","a\nspecific","input","position,","the","reversed","trigger","often","locates","at","a\ndifferent","position","from","the","original","trigger.","","We","deduce","that\nthe","backdoored","model","would","learn","a","distribution","of","triggers\n11\n\nL1","=","37.78L1","=","20.48L1","=","30.10L1","=","36.31L1","=","34.90L1","=","34.67L1","=","37.78L1","=","44.82L1","=","38.19L1","=","31.11\nL1","=","43.08L1","=","31.59L1","=","40.94L1","=","40.71L1","=","47.13L1","=","41.31L1","=","43.91L1","=","56.29L1","=","51.42L1","=","35.01\nClass:","0\nClass:","1\nClass:","2\nClass:","3Class:","4Class:","5Class:","6Class:","7Class:","8Class:","9\nL1","=","53.83L1","=","27.77L1","=","25.57L1","=","34.40L1","=","55.91L1","=","42.79L1","=","31.33L1","=","61.66L1","=","39.86L1","=","38.13\nNC\nB3D\nB3D-SS\nFigure","4:","","Visualization","of","the","reversed","masks","optimized","by","NC,","B3D,","and","B3D-SS","for","all","classes","of","a","normal","model","on","CIFAR-10.","","NC\nwrongly","identifies","the","model","as","backdoored","and","regards","class","1","to","be","the","infected","class.\nModel","1Model","2Model","3Model","4Model","5\nTrigger\nASR\nFigure","5:","","The","original","triggers","and","the","backdoor","attack","success\nrates","(ASR)","by","applying","the","triggers","to","different","positions","in","the\ninput.","In","the","second","row,","the","value","of","the","pixel","represents","the","ASR\nat","each","position,i.e.,","a","white","pixel","represents","the100%ASR","while\na","black","pixel","represents","the0%ASR.\nby","generalizing","the","original","one.","To","validate","it,","we","calculate\nthe","success","rates","of","backdoor","attacks","by","applying","the","trigger\nto","all","input","positions.\nSpecifically,","we","randomly","choose5backdoored","models\non","CIFAR-10","with1×1triggers.","For","each","model,","we","insert\nthe","trigger","into","each","position","of","the","input","and","evaluate","the\nattack","success","rates","(ASR).","We","visualize","the","heat","maps","of\nASR","in","Fig.","5.","","It","can","be","seen","that","a","lot","of","input","positions\nbesides","the","original","one","can","induce","high","ASR.","Thus","we","can\nconclude","that","the","backdoored","model","can","learn","a","distribution\nof","backdoor","triggers","in","various","positions,","and","the","backdoor\ndetection","method","could","converge","to","either","one","from","the","dis-\ntribution,","which","does","not","necessarily","locate","at","the","same","po-\nsition","as","the","original","trigger.\nMaskMask*Pattern\nNC\nB3D\nB3D-SS\nOriginal\nMaskMask*PatternMaskMask*Pattern\nFigure","6:","","Visualization","of","the","original","triggers","and","the","reversed\ntriggers","optimized","by","NC,","B3D,","and","B3D-SS","on","ImageNet.\nE.","Visualization","Results","on","ImageNet\nWe","visualize","the","original","triggers","and","the","reversed","trig-\ngers","optimized","by","NC,","B3D,","and","B3D-SS","on","ImageNet","in\nFig.","6.","","It","can","be","seen","that","the","reversed","triggers","do","not","re-\nsemble","the","original","triggers,","indicating","that","the","backdoored\nmodels","would","automatically","learn","distinctive","features","from\nthe","triggers","rather","than","remembering","the","exact","patterns.\nF.","Experiments","on","More","Settings\nIn","","this","","section,","","we","","provide","","additional","","experiments","","by\nconsidering","more","various","backdoor","attacks","and","training","set-\ntings.","The","results","consistently","demonstrate","the","effectiveness\nof","our","proposed","methods","—","B3D","and","B3D-SS.\n12\n\nAttackAccuracyASRMethod\nReversed","TriggerDetection","Results\nL\n1\nnormASRCase","ICase","IICase","IIICase","IV\nBlended","Injection\n88.36%100.00%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n0.499\n0.640\n0.865\n4.320\n98.77%\n99.00%\n98.99%\n99.99%\n40/50\n37/50\n36/50\n40/50\n10/50\n11/50\n14/50\n10/50\n0/50\n0/50\n0/50\n0/50\n0/50\n2/50\n0/50\n0/50\nLabel-Consistent\n86.70%99.92%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n3.092\n3.291\n3.737\n3.783\n98.72%\n99.19%\n98.92%\n97.81%\n47/50\n46/50\n46/50\n47/50\n0/50\n1/50\n1/50\n3/50\n0/50\n0/50\n0/50\n0/50\n3/50\n3/50\n3/50\n0/50\nTable","7:","The","results","of","backdoor","detection","on","CIFAR-10","against","the","blended","injection","attack","[9]","and","label-consistent","attack","[42].","We","show\nthe","average","accuracy","and","backdoor","attack","success","rates","(ASR)","of","the","backdoored","models.","For","the","four","backdoor","detection","methods","—","NC,\nTABOR,","B3D,","and","B3D-SS,","we","report","theL\n1\nnorm","and","attack","success","rates","of","the","reversed","trigger","corresponding","to","the","target","class,","as\nwell","as","the","detection","results","in","four","cases.\nModelAccuracyASRMethod\nReversed","TriggerDetection","Results\nL\n1\nnormASRCase","ICase","IICase","IIICase","IV\nNormal89.57%N/A\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\nN/A\n1/50\n1/50\n1/50\n3/50\n49/50\n49/50\n49/50\n47/50\nBackdoored\n(1×1trigger)\n88.79%99.64%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n0.980\n1.014\n1.085\n9.247\n98.67%\n99.12%\n98.81%\n99.52%\n41/50\n39/50\n32/50\n25/50\n6/50\n7/50\n14/50\n20/50\n2/50\n0/50\n2/50\n3/50\n1/50\n4/50\n2/50\n2/50\nBackdoored\n(2×2trigger)\n88.86%99.99%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n2.393\n2.475\n2.734\n6.836\n98.69%\n98.98%\n98.90%\n99.18%\n46/50\n43/50\n41/50\n31/50\n3/50\n5/50\n7/50\n18/50\n1/50\n0/50\n2/50\n1/50\n0/50\n2/50\n0/50\n0/50\nBackdoored\n(3×3trigger)\n88.70%100.00%\nNC","[43]\nTABOR","[19]\nB3D","(Ours)\nB3D-SS","(Ours)\n3.448\n3.192\n3.839\n5.906\n98.60%\n99.09%\n98.89%\n96.72%\n44/50\n47/50\n40/50\n34/50\n5/50\n3/50\n7/50\n14/50\n0/50\n0/50\n0/50\n2/50\n1/50\n0/50\n3/50\n0/50\nTable","8:","","The","results","of","backdoor","detection","on","CIFAR-10","with","the","VGG-16","model","architecture.","","For","normal","and","backdoored","models","with\ndifferent","trigger","sizes,","we","show","their","average","accuracy","and","backdoor","attack","success","rates","(ASR).","For","the","four","backdoor","detection","methods\n—","NC,","TABOR,","B3D,","and","B3D-SS,","we","report","theL\n1\nnorm","and","attack","success","rates","of","the","reversed","trigger","corresponding","to","the","target\nclass,","as","well","as","the","detection","results","in","four","cases.\nF.1.","Other","Backdoor","Attacks\nBesides","the","BadNets","approach","used","in","the","main","paper,\nwe","consider","more","backdoor","attacks","including","the","blended\ninjection","attack","[9]","and","the","label-consistent","attack","[42].","The\nblended","injection","attack","adds","a3×3trigger","into","a","random\nposition","of","the","image,","and","performs","a","weighted","average","of\nthe","original","image","and","the","trigger.","","The","blend","ratio","is","set","as\n0.2.","","The","poison","ratio","is10%.","","We","train50models","by","the\nblended","injection","attack.","","The","label-consistent","attack","does\nnot","alter","the","ground-truth","label","of","the","poisoned","input.","","We\nadopt","","the","","adversarial","","manipulation","","approach","","to","","make","","the\noriginal","","context","","hard","","to","","learn,","","as","","proposed","","in","","[42].","","","The\npoison","ratio","is8%of","the","whole","dataset.","","We","also","train50\nmodels","by","the","label-consistent","attack.\nThe","results","of","NC,","TABOR,","B3D,","and","B3D-SS","against\nthe","blended","injection","and","label-consistent","attacks","are","shown\nin","Table","7.","NC","achieves100%and94%detection","accuracy\nagainst","the","two","attacks;","TABOR","achieves96%and94%de-\ntection","accuracy;","","B3D","achieves100%and94%detection\naccuracy;","while","B3D-SS","achieves100%detection","accuracy\nagainst","both","attacks.","","The","results","validate","the","effectiveness\nof","our","proposed","approaches","against","other","backdoor","attacks\nbesides","BadNets.\nF.2.","Different","Model","Architectures\nAlthough","we","study","backdoor","attacks","and","detection","us-\ning","the","ResNet-18","model","in","Sec.","4,","","our","method","can","gen-\nerally","be","applied","when","using","other","model","architectures.","To\nillustrate","this,","we","further","conduct","experiments","on","CIFAR-10\nwith","a","VGG-16","[38]","model.","","The","experimental","settings","are\n13\n\nTrigger","sizeAccuracyASR\n1×194.68%99.67%\n2×2\n94.78%99.99%\n3×395.29%100.00%\nTable","9:","The","accuracy","and","the","backdoor","attack","success","rates","(ASR)\nof","three","backdoored","models","on","CIFAR-10","with","data","augmentation.\nMaskMask*Pattern\nB3D\nOriginal\n1⇥1\ntrigger\n2⇥2\n3⇥3\ntriggertrigger\nMaskMask*PatternMaskMask*Pattern\nFigure","7:","","Visualization","of","the","original","triggers","and","the","reversed\ntriggers","optimized","by","B3D","of","three","backdoored","models","on","CIFAR-\n10","with","data","augmentation.\nFigure","8:","The","backdoor","attack","success","rates","(ASR)","by","applying","the\ntrigger","to","different","positions","in","the","input.","We","study","the","backdoored\nmodel","using","the1×1trigger","on","CIFAR-10","with","data","augmenta-\ntion.\nthe","same","as","the","experiments","in","Sec.","4.1","using","the","ResNet-18\nmodel,","in","which","we","also","train200models","for","evaluations.\nWe","present","the","detailed","results","in","Table","8.","","Overall,","the\nbackdoor","detection","accuracy","achieves98.5%by","NC,96.5%\nby","TABOR,97.0%by","B3D,","and97.5%by","B3D-SS.","The\nresults","on","the","VGG-16","model","consistently","demonstrate","the\neffectiveness","of","the","proposed","methods","B3D","and","B3D-SS,\nwhich","achieve","comparable","performance","with","NC","and","TA-\nBOR.\nF.3.","Data","Augmentation\nThe","previous","experiments","do","not","adopt","data","augmenta-\ntion","during","training.","However,","data","augmentation","is","a","com-\nmon","technique","for","training","DNN","models.","To","investigate","the\neffects","of","data","augmentation","for","backdoor","attacks","and","de-\ntection,","we","provide","further","analysis","in","this","section.\nWe","conduct","experiments","on","CIFAR-10","with","the","ResNet-\n18","model","architecture.","","We","train","one","backdoored","model","for\neach","trigger","size","of1×1,2×2,","and3×3with","data","augmen-\ntation","(i.e.,","horizontal","flips","and","random","crops","from","images\nwith4pixels","padded","on","each","side).","","The","accuracy","and","the\nbackdoor","","attack","","success","","rates","","(ASR)","","of","","these","","models","","are\nshown","in","Table","9.","With","data","augmentation,","the","backdoored\nMaskMask*Pattern\nB3D\nOriginal\nClass:","0\nMaskMask*Pattern\nClass:","1\nFigure","9:","Visualization","of","the","original","trigger","and","the","reversed","trig-\ngers","optimized","by","B3D","of","a","backdoored","model","on","CIFAR-10","with\ntwo","backdoors","targeting","at","class","0","and","1.\nmodels","can","achieve","higher","accuracy","on","clean","test","data","while\npreserving","near100%ASR","for","backdoor","attacks.","","We","then\nuse","B3D","to","perform","backdoor","detection","of","these","three","mod-\nels.","B3D","successfully","identifies","these","models","as","backdoored\nand","correctly","discovers","the","true","target","class.","","We","visualize\nthe","original","triggers","and","reversed","triggers","in","Fig.","7.\nMoreover,","we","suspect","that","using","data","augmentation","can\nmake","the","effective","input","positions","of","backdoor","attacks","much\nmore,","because","the","poisoned","training","samples","are","also","aug-\nmented","such","that","the","trigger","will","locate","at","many","positions","in\nthe","training","data.","Similar","to","the","experiments","in","Appendix","C,\nwe","use","the","backdoored","model","with","the1×1trigger","and\nshow","the","heat","map","of","ASR","of","this","model","in","Fig.","8.","It","can","be\nseen","that","the","trigger","is","effective","at","a","lot","of","positions.\nF.4.","Multiple","Infected","Classes","with","Different","Trig-\ngers\nWe","consider","the","scenario","that","multiple","backdoors","with\ndifferent","target","classes","are","embedded","in","a","model.","We","train","a\nbackdoored","model","on","CIFAR-10","with","two","backdoors","target-\ning","at","class","0","and","1,","respectively.","The","B3D","method","success-\nfully","identifies","both","backdoors,","","with","the","reversed","triggers\nshown","in","Fig.","9.\nF.5.","Single","Infected","Class","with","Multiple","Triggers\nWe","consider","the","scenario","that","multiple","backdoors","with\na","single","target","class","are","embedded","in","a","model.","","We","train","a\nbackdoored","model","on","CIFAR-10","with","two","triggers","both","tar-\ngeting","at","class","0.","","B3D","successfully","identifies","the","existence\nof","backdoor","attacks.","","However,","we","find","that","B3D","can","only\nrestore","the","trigger","according","to","one","backdoor","but","fail","to","re-\ncover","the","trigger","tied","to","the","other.","","We","think","this","is","because\nthat","one","backdoor","is","easier","to","identify","than","the","other","when\nwe","perform","optimization","using","an","objective","function.","It","also\ndoes","not","harm","the","effectiveness","of","B3D","in","pointing","out","the\nexistence","of","backdoored","models.\n14"],"doc10":["\n\nRobust","subgroup","discovery\nDiscovering","subgroup","lists","using","MDL\nHugo","M.","Proen","̧ca·Thomas","B","̈ack\n·Matthijs","van","Leeuwen\nAbstractWe","introduce","the","problem","ofrobust","subgroup","discovery,","i.e.,","finding\na","set","of","interpretable","descriptions","of","subsets","that","1)","stand","out","with","respect","to\none","or","more","target","attributes,","2)","are","statistically","robust,","and","3)","non-redundant.\nMany","attempts","have","been","made","to","mine","eitherlocallyrobust","subgroups","or","to\ntackle","the","pattern","explosion,","but","we","are","the","first","to","address","both","challenges\nat","the","same","time","from","aglobalperspective.\nFirst,","we","formulate","a","broad","model","class","of","subgroup","lists,","i.e.,","ordered","sets","of\nsubgroups,","for","univariate","and","multivariate","targets","that","can","consist","of","nominal\nor","numeric","variables.","This","novel","model","class","allows","us","to","formalize","the","problem\nof","optimal","robust","subgroup","discovery","using","the","Minimum","Description","Length\n(MDL)","principle,","where","we","resort","to","optimal","Normalized","Maximum","Likelihood\nand","Bayesian","encodings","for","nominal","and","numeric","targets,","respectively.","Notably,\nwe","show","that","our","problem","definition","is","equal","to","mining","the","top-1","subgroup","with\nan","information-theoretic","quality","measure","plus","a","penalty","for","complexity.\nSecond,","","as","","finding","","optimal","","subgroup","","lists","","is","","NP-hard,","","we","","propose","","RSD,","","a\ngreedy","heuristic","that","finds","good","subgroup","lists","and","guarantees","that","the","most\nsignificant","subgroup","found","according","to","the","MDL","criterion","is","added","in","each","it-\neration,","which","is","shown","to","be","equivalent","to","a","Bayesian","one-sample","proportions,\nmultinomial,","or","t-test","between","the","subgroup","and","dataset","marginal","target","dis-\ntributions","plus","a","multiple","hypothesis","testing","penalty.","We","empirically","show","on\n54","datasets","that","RSD","outperforms","previous","subgroup","set","discovery","methods\nin","terms","of","quality","and","subgroup","list","size.\nHugo","Manuel","Proen","̧ca\nNiels","Bohrweg","1,","2333","CA","Leiden,","Netherlands\nE-mail:","h.manuel.proenca@liacs.leidenuniv.nl\nThomas","B","̈ack\nNiels","Bohrweg","1,","2333","CA","Leiden,","Netherlands\nE-mail:","t.h.w.baeck@liacs.leidenuniv.nl\nMatthijs","van","Leeuwen\nNiels","Bohrweg","1,","2333","CA","Leiden,","Netherlands\nE-mail:","m.van.leeuwen@liacs.leidenuniv.nl\narXiv:2103.13686v1","","[cs.LG]","","25","Mar","2021\n\n2Hugo","M.","Proen","̧ca","et","al.\nKeywordssubgroup","discovery·subgroup","list·the","Minimum","Description\nLength","(MDL)","principle.\n1","Introduction\nExploratory","Data","Analysis","(EDA)(Tukey,","1977)","aims","at","enhancing","its","prac-\ntitioner","natural","ability","to","recognize","patterns","in","the","data","being","studied.","The\nmore","she","explores","the","more","she","discovers,","but","also","the","higher","the","risk","of","find-\ning","interesting","results","arising","out","of","coincidences,","as,","e.g.,","spurious","relations\nbetween","variables","that","have","no","connection","in","the","real","world.","Intuitively","this\ncorresponds","to","testing","multiple","hypothesis","without","realizing","it.","This","duality","of\nEDA","requires","a","thorough","analysis","of","results","and","highlights","the","need","for","statis-\ntically","robust","techniques","that","allow","us","to","explore","the","data","in","a","responsible","way.\nWhile","EDA","encompasses","all","techniques","referring","to","data","exploration,Subgroup\nDiscovery(SD)","(Kl","̈osgen,","1996;","Atzmueller,","2015)","is","the","subfield","that","is","con-\ncerned","with","discovering","interpretable","descriptions","of","subsets","of","the","data","that\nstand","out","with","respect","to","a","given","target","variable,","i.e.,subgroups.","This","work\naims","at","improving","the","discovery","of","subgroup","lists,","i.e.,","ordered","sets","of","subsets,\nthat","describe","different","regions","of","the","data,","while","being","statistically","robust","by\nthemselves","and","against","multiple","hypothesis","testing.","Two","simple","examples","of\nsubgroup","lists","can","be","found","in","Figures","1","and","2.\nPr(animaltype=···|s)in","%\nsdescriptionn\ns\nMammalFishInvert.BugReptileAmph.Bird\n1backbone","=","no18005644000\n2breathes","=","no1409300700\n3feathers","=","yes20000000100\n4milk","=","no8000050500\n5feathers","=","no41100000000\ndataset","distribution0\n∗\n4113108542\nFig.","1:Zoodataset","subgroup","list","obtained","by","RSD.Zoocontains","one","nominal\ntarget","","variable","","with","","7","","classes,","","101","","instances,","","and","","15","","binary","","and","","1","","numeric\nvariables.n\ns\nrefers","to","the","number","of","instances","covered","by","subgroup","‘s’","defined\nby","‘description’.","Pr(animaltype=∗|s)","denotes","the","estimated","probability","(in\n%)","of","each","class","label","occurring","within","the","subgroup.","The","bottom","row","shows\nthe","marginal","probability","distribution","of","the","dataset.∗concerns","instances","not\ncovered","by","any","of","the","five","subgroups.","For","illustrative","purposes","the","probabilities\ndisplayed","","correspond","","to","","the","","empirical","","probabilities","","in","","the","","data,","","not","","to","","the\nprobabilities","as","would","be","obtained","using","the","appropriate","estimator.\n\nRobust","subgroup","discovery3\nprice(K)\nsdescriptionof","automobile","specificationsn\ns\nˆμˆσ\n1weight","=","heavy","&","consumption-city≤8","km/L11358\n2fuel-type","=","gas","&","consumption-city≥13","km/L4571\n3weight","=","light","&","wheel-base","=","low3591\n4length","=","medium","&","13≤consumption-city≤15","km/L27102\n5peak-rpm","=","medium49163\n6engine-size","=","medium12267\ndataset","overall","distribution18\n∗\n138\nFig.","2:Automobile","import","1985subgroup","list","obtained","with","RSD.","The","dataset\ncontainspriceas","numeric","target","variable,","197","examples,","and","17","variables.","The\ndataset","was","modified,","some","variables","removed","and","others","discretized,","for","ease\nof","presentation.n\ns\nrefers","to","the","number","of","instances","covered","by","subgroup","‘s’\ndefined","by","‘description’,","","ˆμand","","ˆσits","estimated","mean","and","standard","deviation\nfor","the","target","variable","in","thousands","of","dollars","(K).∗concerns","instances","not\ncovered","by","any","of","the","five","subgroups.\nSubgroup","","discovery(SD)","can","be","seen","as","the","exploratory","counterpart","to","rule\nlearning","or","association","rule","mining,","where","the","targets/consequent","of","the","rules\nare","fixed","and","rules","are","ranked","according","to","quality","measures","combining","sub-\ngroup","size","and","deviation","of","the","target","variable(s)","with","respect","to","the","overall\ndistribution","","in","","the","","data.","","In","","its","","traditional","","form,","","subgroup","","discovery","","is","","also\nreferred","to","as","top-ksubgroup","mining","(Atzmueller,","2015),","which","entails","mining\nthektop","ranking","subgroups","according","to","alocalquality","measure","and","a","number\nkselected","by","the","user.","Since","its","conception","subgroup","discovery","has","been","devel-\noped","for","various","types","of","data","and","targets,","e.g.,","nominal,","numeric","(Grosskreutz\nand","R","̈uping,","2009),","and","multi-label","(van","Leeuwen,","2010)","targets.","SD","has","been\napplied","in","a","wide","range","of","different","domains","(Herrera","et","al.,","2011;","Atzmueller,\n2015),","such","as","identifying","the","properties","of","materials","(Goldsmith","et","al.,","2017),\nunusual","consumption","patterns","in","smart","grids","(Jin","et","al.,","2014),","identifying","the\ncharacteristics","of","delayed","flights","(Proen","̧ca","et","al.,","2018),","and","understanding","the\ninfluence","of","pace","in","long","distance","running","(De","Leeuw","et","al.,","2018).\nEven","though","SD","appeals","to","several","domains,","top-kmining","traditionally","suf-\nfers","from","three","main","issues","that","make","it","impractical","for","many","applications:","1)\npoor","efficiency","of","exhaustive","search","for","more","relevant","quality","measures","(Boley\net","","al.,","","2017);","","2)redundancyof","","mined","","subgroups,","","i.e.,","","the","","fact","","that","","subsets\nwith","the","highest","deviation","according","to","a","certainlocalquality","measure","tend","to\ncover","the","same","region","of","the","dataset","with","slight","variations","in","their","description\nof","the","subset","(Van","Leeuwen","and","Knobbe,","2012);","3)","lack","of","generalization","or\nstatistical","robustness","of","mined","subgroups","(van","Leeuwen","and","Ukkonen,","2016).\nIn","this","work","we","focus","on","the","last","two","issues","together:","loweringredundancyby\nfinding","small","lists","of","subgroups","that","describe","the","differences","in","the","data","well;\nand","obtainingstatistically","robustsubgroups.","First,","we","define","what","an","optimal\nsubgroup","","list","","is","","using","","the","","MDL","","principle","","and","","second,","","we","","propose","","a","","greedy\nalgorithm","that","finds","good","subgroup","lists","using","alocalobjective","that","is","equiv-\n\n4Hugo","M.","Proen","̧ca","et","al.\nalent","to","maximizing","a","Bayesian","one-sample","proportions,","multinomial","or","t-test\nbetween","each","subgroup’s","distribution","and","the","dataset","marginal","distribution,\nfor","binary,","nominal","or","numeric","data,","respectively,","plus","a","penalty","for","multiple\nhypothesis","testing.\nIn","recent","years","both","issues","have","been","partially","addressed,","mostly","independent\nof","each","other;","we","next","briefly","discuss","recent","advances","and","limitations.\nIn","","terms","","ofredundancy,","","the","","first","","main","","limitation","","of","","existing","","works","","is","","their\nfocus","on","one","type","of","target","variables,","such","as","binary","targets","(Bosc","et","al.,","2018;\nBelfodil","et","al.,","2019),","nominal","targets(Lavraˇc","et","al.,","2004),","or","numeric","targets\n(Lijffijt","et","al.,","2018),","where","only","DSSD","focuses","on","univariate","and","multivariate\nnominal","and","numeric","targets","(Van","Leeuwen","and","Knobbe,","2012).","The","second\nmain","limitation","is","the","lack","of","an","optimality","criterion","for","subgroup","sets","or","lists,\nwhere","the","only","exception","is","FSSD","(Belfodil","et","al.,","2019).","It","is","important","to\nemphasize","that","some","works","aim","at","finding","sequential","subgroups","or","subgroup\nlists,","while","others","aim","at","finding","unordered","sets","or","subgroupsets.","Subgroup\nlists","are","akin","to","rule","lists","(Proen","̧ca","and","van","Leeuwen,","2020)","in","the","sense","that\neach","subgroup/rule","needs","to","be","interpreted","sequentially","and","they","are","not","al-\nlowed","to","overlap,","while","subgroup","sets","are","allowed","to","overlap.","In","this","work","we\nfocus","solely","on","subgroup","lists,","and","although","previous","works","often","did","not","use\nthis","term","we","retroactively","rename","those","models","that","are","in","fact","subgroup","lists.\nIn","terms","ofstatistical","robustness,","most","existing","approaches","consider","first","min-\ning","the","top-ksubgroups","and","then","post-processing","them","in","terms","of","a","statistical\ntest","to","find","if","the","discovered","subgroups","are","statistically","significant","(Duivesteijn\nand","Knobbe,","2011;","van","Leeuwen","and","Ukkonen,","2016).","More","recently,","Proen","̧ca\net","al.","(2020)","proposed","for","the","first","time","a","global","formulation","of","a","subgroup","list\nfor","numeric","targets","over","the","whole","dataset.","The","approach","is","based","on","the","Mini-\nmum","Description","Length","(MDL)","principle,","taking","into","account","the","variance","of\nthe","subgroup","targets","distribution","to","measure","their","quality.","Our","present","work","is\nan","extension","of","this","approach,","extending","the","MDL","formulation","and","algorithm\nto","","univariate","","and","","multivariate","","nominal","","and","","numeric","","targets;","","we","","discuss","","the\nrelationship","in","more","detail","below.\nFor","an","in-depth","analysis","of","related","work","please","refer","to","Section","2.\nRobust","","subgroup","","discovery.Informally","the","problem","of","robust","subgroup","dis-\ncovery","","is","","to","","define","","and","","find","","thegloballyoptimal","","set","","or","","list","","(i.e.,","","an","","ordered\nset)","of","non-redundant","subgroups","that","together","explain","the","most","relevantlocal\ndeviations","","in","","the","","data","","with","","respect","","to","","specified","","target","","variables.","","As","","finding\nthe","","optimal","","set","","or","","list","","will","","typically","","be","","practically","","infeasible,","","the","","secondary\nproblem","is","to","construct","an","algorithm","that","efficiently","mines","‘good’","subgroup\nsets","or","lists","from","the","data","that","retains","as","much","from","the","statistical","properties\nof","theglobalformulation","as","possible.\nIn","this","work","we","restrict","our","focus","to","findingsubgroup","","lists,","because","1)","they\nwere","one","of","the","first","model","classes","proposed","for","subgroup","set","discovery","(Lavraˇc\net","","al.,","","2004);","","2)","","they","","allow","","for","","an","","optimal","","formulation","","based","","on","","the","","MDL\nprinciple","due","to","its","property","of","unambiguously","partitioning","the","data","into","non-\n\nRobust","subgroup","discovery5\noverlapping","parts;","and","3)","finally,","they","allow","an","ordered","interpretation","of","the\nsubgroups,","i.e.,","from","most","to","least","relevant","discovered","subgroup.\nContributions.We","aim","to","bridge","the","gap","in","the","literature","by","finding","the","best\nnon-redundant","","subgroup","","list","","from","","aglobaldataset","","perspective,","","while","","guar-\nanteeing","thelocalquality","of","the","found","subgroups,","making","the","approach","sta-\ntistically","robust","from","both","perspectives.","Two","examples","of","subgroup","lists","for\nnominal","","and","","numeric","","targets","","can","","be","","seen","","in","","Figures","","1","","and","","2.","","To","","solve","","this\nproblem","","we","","propose","","a","","formal","","definition","","of","","asubgroup","","listand","","employ","","the\nMinimum","Description","Length","(MDL)","(Rissanen,","1978)","principle","to","define","its\noptimality","from","a","global","perspective.","We","provide","this","formalization","for","univari-\nate","and","multivariate","nominal","and","numeric","targets,","and","notably","the","subgroup\nthat","minimizes","the","MDL-optimal","formulation","for","a","subgroup","list","with","one","sub-\ngroup","is","the","same","subgroup","that","would","be","found","by","top-1","subgroup","discovery\nwith","Weighted","Kullback-Leibler","divergence","(WKL)","as","quality","measure.","This\nmakes","it","the","firstglobalformulation","of","subgroup","discovery.\nTo","find","subgroup","lists","we","propose","RSD,","a","heuristic","algorithm","that","combines\nbeam","search","to","find","subgroups","with","greedy","search","to","iteratively","add","the","best\nfound","subgroup","to","the","subgroup","list.","Maximizing","the","MDL","criterion","in","each\niteration","guarantees","that","each","subgroup","added","to","the","list","adheres","to","alocal\nstatistical","test","equivalent","to","a","Bayesian","proportions,","multinomial,","or","t-test","(for\nbinary,","nominal","and","numeric","targets,","respectively)","plus","a","penalty","to","compen-\nsate","for","multiple","hypothesis","testing.\nThis","","work","","is","","an","","extension","","of","","Proen","̧ca","","et","","al.","","(2020),","","in","","which","","we","","introduced\nMDL-based","subgroup","lists","for","univariate","numeric","target","variables","and","SSD++,\na","heuristic","algorithm","for","finding","such","subgroup","lists.","The","current","manuscript\nsignificantly","extends","our","previous","work","by","generalizing","theoretical,","algorith-\nmic,","","and","","empirical","","results","","to","","three","","new","","target","","variable","","types,","","namely","","mul-\ntivariate","","numeric","","targets,","","and","","univariate","","and","","multivariate","","nominal","","targets.\nMoreover,","","we","","provide","","a","","new","","interpretation","","of","","the","","greedy","","gain","","as","","an","","MDL\nequivalent","to","a","Bayesian","factor.\nTo","summarize,","theprimarycontributions","presented","in","this","work—including\nthe","contributions","originally","from","Proen","̧ca","et","al.","(2020),","which","we","indicate","with\na","*","below—are:\n1.Subgroup","list","model","class–","We","define","the","subgroup","list","model","class*\nover","a","tabular","dataset","in","general","(Section","4.1),","providing","aglobalformu-\nlation","","for","","the","","problem","","of","","sequential","","subgroup","","mining,","","and","","in","","particular\nfor","univariate","and","multivariate","nominal","targets","(Section","5),","and","univariate\nnumeric*","and","multivariate","numeric","targets","(Section","6).\n2.Robust","subgroup","lists","using","MDL–","We","define","optimal","subgroup","lists\nusing","the","MDL","principle","(Section","4),","where","we","resort","to","the","optimal","Nor-\nmalized","Maximum","Likelihood","(NML)","encoding","for","nominal","targets","(Sec-\ntion","5)","and","the","Bayesian","encoding","with","non-informative","priors","for","numeric\ntargets*","","(Section","","6).","","Notably,","","we","","show","","that","","this","","problem","","formalization\nis","equivalent","to","the","standard","definition","of","top-1","subgroup","discovery","with\n\n6Hugo","M.","Proen","̧ca","et","al.\nWKL","as","quality","measure","for","the","case","of","a","subgroup","list","with","one","subgroup\n(Section","5.4","for","nominal","targets","and","Section","6.4","for","numeric","targets*).\n3.RSD","","algorithm–","","We","","propose","","theRobust","","Subgroup","","Discoverer(RSD)\nalgorithm","that","combines","beam","search","to","find","subgroups","with","greedy","search\nto","iteratively","add","the","best","found","subgroup","to","the","subgroup","list*","(Section","7).\nWe","","show","","that","","the","","greedy","","objective","","is","","equivalent","","to","","a","","one-sample","","Bayes\nproportions,","","multinomial,","","and","","t-test","","(for","","binary,","","nominal","","and","","numeric*\ntargets,","respectively)","plus","a","penalty","to","compensate","for","multiple","hypothesis\ntesting","(Section","5.5","for","binary","and","nominal","targets,","Section","6.5","for","numeric\ntargets,","and","Section","7.3","for","the","greedy","objective","of","RSD).\n4.Greedy","MDL","algorithms","maximize","local","statistical","test–","We","show\nthat","the","greedy","gain","commonly","used","in","the","MDL","for","pattern","mining","litera-\nture","can","be","interpreted","as","an","MDL","equivalent","to","alocalBayesian","hypothesis\ntest,","a.k.a.","Bayesian","factor,","on","the","likelihood","of","the","data","being","better","fitted\nby","the","greedy","extended","model","versus","the","current","model","plus","a","penalty","for\nthe","extra","model","complexity","(Section","7.3).\nMoreover,","this","work","includes","the","followingsecondarycontributions,","the","details\nof","which","are","all","included","in","the","appendices","for","the","interested","reader:\n5.Normalized","Maximum","Likelihood","for","partition","models–","Derivation\nof","the","Normalized","Maximum","Likelihood","(NML)","optimal","encoding,","a","refined\nMDL","encoding,","for","model","classes","that","partition","the","data","for","nominal","target\nvariables—subgroup","lists,","rule","lists,","trees,","etc.","(Appendix","A).\n6.Bayesian","encoding","of","normal","distributions–","Derivation","of","a","Bayesian\noptimal","encoding","of","normal","distributions","with","non-informative","priors","for\nnumeric","targets*","(Appendix","B).","It","is","shown","that","for","large","number","of","in-\nstances","","it","","converges","","to","","the","","BIC*","","(Appendix","","C).","","Similarly","","to","","the","","NML\nencoding","it","can","be","used","by","any","model","class","that","unambiguously","partitions\nthe","data,","such","as","subgroup","lists,","rule","lists,","trees,","etc.\n7.Dispersion-aware","Weighted","Kullback-Leibler–","We","propose","the","Weighted\nKullback-Leibler","(WKL)","divergence","between","normal","distributions","as","spread-\naware","(dispersion-aware)","quality","measure","for","numeric","targets*","(Appendix","D\nfor","the","derivation","and","formula).\n8.Subgroups","discovery","versus","rule-based","prediction–","We","demonstrate\nthe","","difference","","between","","the","","formal","","objectives","","for","","subgroup","","discovery","","and\npredictive","rule","models,","such","as","classification","rule","lists,","from","the","perspective\nof","our","MDL-based","approach","(Appendix","E).\nStructure","","of","","this","","work.In","","Section","","2","","the","","most","","relevant","","related","","work","","is","","cov-\nered,","together","with","the","main","differences","to","our","approach.","Then,","in","Section","3\nthe","","preliminaries","","are","","presented","","and","","the","","problem","","of","","subgroup","","discovery","","and\nsubgroup","set","discovery","are","defined.","After","that,","in","Section","4","the","Minimum","De-\nscription","Length","(MDL)","principle","is","stated,","the","subgroup","lists","model","class","is\npresented,","the","model","encoding","(akin","to","multiple","hypothesis","testing)","is","defined,\nand","the","general","form","of","the","data","encoding","is","presented.","Then,","in","Sections","5\nand","","6","","the","","specific","","data","","encodings","","for","","numeric","","and","","nominal","","target","","variables\n\nRobust","subgroup","discovery7\nare","defined,","respectively,","together","with","their","respective","statistical","properties\nand","equivalence","to","the","standard","definition","of","subgroup","discovery.","After","that,\nin","Section","7","the","RSD,","a","heuristic","algorithm","to","mine","subgroup","lists","is","defined,\nas","well","as","its","statistical","guarantees","and","time","complexity.","Then,","in","Section","8\nwe","show","the","empirical","results","of","our","proposed","method","when","compared","against\nthe","","state-of-the-art","","algorithms","","for","","univariate","","and","","multivariate","","nominal","","and\nnumeric","","targets","","over","","54","","datasets.","","After","","that,","","in","","Section","","9","","we","","apply","","robust\nsubgroup","discovery","to","find","how","descriptions","of","the","socioeconomic","background\naffects","the","grades","of","engineering","students","in","Colombia.","Finally,","in","Section","10\nthe","main","conclusions","are","presented.\n2","Related","work\nIn","","this","","section","","we","","cover","","work","","related","","to","","our","","proposed","","MDL","","subgroup","","lists,\nin","","four","","categories:subgroup","","discovery;pattern","","mining;rule","","lists;MDL","","for\npattern","mining;","andalgorithmic","implementations.","The","relevance","of","each","topic\nis","as","follows:","subgroup","discovery","directly","relates","to","the","task","at","hand;","pattern\nmining","and","association","rule","mining","are","a","generalizations","of","subgroup","discovery;\nrule","lists","share","the","same","model","structure","as","subgroup","lists;","MDL","for","pattern\nmining","shares","the","same","theory","for","formalizing","the","problem;","and","lastly","we","go\nover","most","of","the","same","works","but","from","an","algorithm","implementation","perspective\nin","order","to","justify","our","algorithmic","choices.\n2.1","Subgroup","discovery\nIn","its","traditional","form,","subgroup","discovery,","also","referred","to","as","top-ksubgroup\nmining","(Atzmueller,","2015),","entails","the","mining","of","thektop","ranking","subgroups\naccording","to","a","quality","measure","and","a","numberkselected","by","the","user.","As","men-\ntioned","","in","","the","","introduction,","","this","","formulation","","suffers","","from","","three","","main","","issues\nthat","make","it","impractical","for","most","applications:","1)","poorefficiency","of","exhaustive\nsearchfor","more","relevant","quality","measures","(Boley","et","al.,","2017);","2)redundancy\nof","","subgroup","","setsmined,","i.e.,","the","fact","that","subsets","with","the","highest","deviation\naccording","to","a","certain","quality","measure","tend","to","cover","the","same","region","of","the\ndataset","with","slight","variations","in","their","description","of","the","subset","(Van","Leeuwen\nand","Knobbe,","2012);","3)","lack","ofstatistical","guaranteesand","generalization","of","mined\nsubgroups","(van","Leeuwen","and","Ukkonen,","2016).","We","will","now","go","over","the","recent\ncontributions","","for","","these","","three","","issues,","","with","","special","","emphasis","","for","","the","","last","","two,\nredundancy","and","statistical","guarantees,","which","our","work","proposes","to","solve.\nEfficient","exhaustive","search.In","the","last","years","several","developments","have","been\nmade","towards","more","efficient","algorithms","for","mining","the","top-ksubgroups.","Lem-\nmerich","et","al.","(2016)","proposed","an","efficient","exhaustive","search","algorithm","for","nu-\nmerical","targets,","Belfodil","et","al.","(2018)","proposed","to","mine","over","numeric","attributes\nwith","guarantees,","and","Boley","et","al.","(2017)","proposed","an","algorithm","that","exhaus-\ntively","mines","subgroups","that","take","into","account","the","dispersion","(deviation)","of","the\n\n8Hugo","M.","Proen","̧ca","et","al.\nsubgroups","target","distribution.","Subgroup","discovery","extension","from","deviations\nof","distributions","of","target","variables","to","deviations","between","models","is","also","called\nExceptional","model","mining","(Leman","et","al.,","2008;","Duivesteijn","et","al.,","2016),","and\ncan","be","applied","to","models","such","as","Bayesian","Networks","(Duivesteijn","et","al.,","2010)\nor","non-parametric","spatio-temporal","patterns","(Du","et","al.,","2020).","Comparing","to\nour","","approach","","these","","works","","do","","not","","take","","into","","account","","the","","redundancy","","of","","the\nsubgroups","found,","and","thus,","the","subgroups","found","tend","to","overlap","in","the","same\nregion","of","the","dataset.\nRedundancy","of","subgroup","sets.To","address","redundancy","among","subgroups","most\npreviously","proposed","approaches","encompass","supervised","pattern","set","mining","(Bring-\nmann","and","Zimmermann,","2007),","and","methods","based","on","relevance","(Großkreutz\net","","al.,","","2012)","","and","","diversity","","(Van","","Leeuwen","","and","","Knobbe,","","2011,","","2012).","","Unlike\ndiversity-based","","methods,","","the","","supervised","","pattern","","set","","mining","","objective","","is","","to\nfind","","a","","fixed","","number","","of","","patterns,","","which","","has","","to","","be","","chosen","","in","","advance,","","while\nrelevance","is","limited","to","non-numeric","targets.","It","is","this","last","group,","the","diversity\nbased","methods","that","share","most","similarities","to","our","work,","i.e.,","the","area","ofSub-\ngroup","Set","Discovery.\nThe","main","approaches","inSubgroup","","Set","","Discoveryare","CN2-SD","(Lavraˇc","et","al.,\n2004),","Diverse","Subgroup","Set","Discovery","(DSSD)","(Van","Leeuwen","and","Knobbe,\n2012),Skylinesof","subgroup","sets","(Van","Leeuwen","and","Ukkonen,","2013),","Monte\nCarlo","Tree","Search","for","Data","Mining","(MCTS4DM)","(Bosc","et","al.,","2018),","Subjec-\ntively","Interesting","Subgroup","Mining","(SISD)","(Lijffijt","et","al.,","2018),","and","FSSD","(Belfodil\net","","al.,","","2019).","","The","","differences","","between","","Subgroup","","Set","","Discovery","","methods","","are\nsummarized","in","Table","1,","with","RSD","","representing","our","approach","and","where","","all\nmethods","are","compared","in","terms","of:","if","they","use","a","list","or","a","set;","the","target","vari-\nables","they","support;","if","they","have","statistical","guarantees;","if","they","have","an","auto-\nmatic","","stopping","","criteria","","(not","","defined","","by","","the","","user);","","and","","if","","they","","have","","a","","global\ndefinition","of","a","subgroup","set","or","list.\nConsidering","","the","","methods","","in","","more","","detail,","","CN2-SD","","(Lavraˇc","","et","","al.,","","2004)","","was\none","of","the","first","methods","to","deal","with","redundancy","and","is","a","direct","adaptation","of\nCN2,","a","classical","rule","learner","and","can","be","applied","to","nominal","target","variables.","It\nuses","a","sequential","approach,","where","in","each","iteration","it","adds","one","subgroup","to","the\nset,","and","then","removes","the","data","covered","by","that","subgroup,","until","no","more","data\ncan","be","covered","in","this","way.","DSSD","(Van","Leeuwen","and","Knobbe,","2012)","developed\na","technique","based","on","a","novel","measure","of","overlap","between","subgroups,","to","itera-\ntively","find","a","set","of","subgroups.","It","can","be","applied","to","single-and-multi-target","nom-\ninal","and","numeric","variables,","with","different","types","of","quality","measures.","Skylines","of\nsubgroup","sets","(Van","Leeuwen","and","Ukkonen,","2013)","proposed","to","directly","account\nfor","quality-diversity","trade-off,","to","find","the","Pareto","optimal","subgroup","sets","of","size\nk.","","MCTS4DM","","(Bosc","","et","","al.,","","2018)","","uses","","Monte","","Carlo","","tree","","search","","to","","improve\nthe","quality","of","the","subgroups","found,","although","it","can","only","be","applied","to","binary\ntarget","variables,","and","to","attributes","of","the","same","type","(all","numeric","or","all","nom-\ninal).","Subjectively","interesting","Subgroup","Discovery","(Lijffijt","et","al.,","2018)","finds\nthe","subjectively","most","interesting","subgroup","for","numeric","target","variables","with\n\nRobust","subgroup","discovery9\nregard","to","the","prior","knowledge","of","the","user,","based","on","an","information-theoretic\nframework","for","formalizing","subjective","interestingness.","By","successively","updat-\ning","the","prior","knowledge","based","on","the","found","subgroups,","it","iteratively","mines","a\ndiverse","set","of","subgroups","that","are","also","dispersion-aware.","FSSD","(Belfodil","et","al.,\n2019)","","is","","a","","more","","recent","","approach","","that","","considers","","the","","‘union’","","of","","all","","subgroups\nas","a","single","pattern","by","forming","a","disjunction","of","subgroups","and","evaluating","its\nquality","and","can","only","be","applied","to","binary","target","variables.","This","approach","is\nsimilar","to","a","sequential","approach","for","mining","subgroups","although","the","individual\ncontributions","of","each","subgroup","are","dissolved","in","the","‘new’","subgroup","formed","by\nthe","disjuction","of","all","subgroups.","like\nthis\nTable","1:","Comparison","of","Subgroup","Set","Discovery","methods","in","terms","of","their","key\nproperties.","From","left","to","right:","model","class","(list","or","set);","types","of","supported","target\nvariables:","binary,","nominal,","numeric","and","multi-target;statisticalguarantees","of\nthe","subgroups","mined;","automaticstoppingcriterion","(not","defined","by","the","user);\nglobalformulation","of","a","subgroup","set/list.\nTarget","variables\nMethodModelbinarynom.num.multiStatisticalStoppingGlobal\nRSDlist3333333\nCN2-SDlist33-----\nDSSDset3333---\nSkylinesset33----3\nMCTS4DMset3------\nSISDset--333--\nFSSDlist3----33\nStatistical","","guarantees.In","terms","of","statistical","guarantees","to","subgroup","discov-\nery,","most","approaches","consider","first","mining","the","top-ksubgroups","and","then","post-\nprocessing","","them","","in","","terms","","of","","a","","test","","to","","find","","subgroups","","that","","are","","statistically\nsignificant","(Duivesteijn","and","Knobbe,","2011;","van","Leeuwen","and","Ukkonen,","2016).\nDuivesteijn","and","Knobbe","(2011)","proposed","to","use","random","permutations","of","the\ntarget","","variable","","with","","respect","","to","","a","","quality","","measure","","to","","evaluate","","how","","the","","dis-\ncovered","","subgroups","","compare","","against","","the","","null","","hypothesis","","generated","","by","","those\npermutations.","Later,","van","Leeuwen","and","Ukkonen","(2016)","discussed","the","concept\nof","significance","for","subgroup","discovery,","and","concluded","that","p-values","should","be\nused","with","caution","as","not","all","false","discoveries","can","be","removed","in","this","way,","as\nthere","will","always","be","random","subsets","with","large","effect","sizes.","An","exception","to\nthis","is","the","work","of","Lijffijt","et","al.","(2018)","(already","mentioned","in","the","last","section),\nwhich","uses","the","maximum","entropy","principle","to","iteratively","find","subgroups","that\nare","","subjectively","","interesting","","against","","a","","user’s","","prior","","knowledge.","","Our","","approach\nstrongly","deviates","from","the","first","two,","as","our","method","tests","for","statistical","guar-\nantees","during","the","mining","process,","it","is","parametric,","as","we","use","categorical","and\nnormal","distributions","to","model","the","targets,","and","also,","through","the","use","of","MDL-\nbased","model","encoding","we","take","into","account","the","concept","of","a","list","of","subgroups\n\n10Hugo","M.","Proen","̧ca","et","al.\nand","penalize","for","all","the","possible","subgroup","lists","that","could","be","discovered","in","the\ndataset.","Regarding","the","last","approach,","even","though","they","also","mine","subgroups\niteratively,","they","lack","a","definition","of","an","optimal","subgroup","set,","and","their","goal","is\nto","model","the","user’s","subjective","knowledge","and","find","regions","in","the","data","that","the\nuser","does","not","know","much","about.\n2.2","Pattern","mining\nPattern","","mining","","and","","association","","rule","","mining","","(Agrawal","","et","","al.,","","1993)","","are","","con-\ncerned","","with","","mining","","items","","that","","co-occur","","together,","","i.e.,","","itemsets","","or","","patterns,\nand","","relationships","","between","","itemsets","","and","","a","","target","","item,","","e.g.,","","a","","class,","","respec-\ntively.","A","key","problem","is","that","they","suffer","from","the","infamouspattern","explosion,\ni.e.,","","they","","tend","","to","","return","","enormous","","amounts","","of","","patterns/rules.","","To","","solve","","this\nproblem,","","many","","approaches","","were","","proposed,","","but","","two","","stand","","out","","in","","relation","","to\nour","work,","namely,","association","rule","classifiers","and","statistical","rule","mining.\nAssociation","","rule","","classifiers.A","simple","way","to","reduce","the","number","of","rules","re-\nturned","is","by","aggregating","association","rules","in","a","set","used","for","classification","and\nusing","a","performance","measure","to","choose","the","best","set.","It","is","relevant","to","notice\nthat","","classifiers","","based","","on","","association","","rule","","mining","","have","","a","","similar","","structure","","to\nrule","lists","and","subgroup","lists,","as","they","tend","to","order","the","rules","sequentially.","The\nbest-known","","techniques","","are","","CBA","","(Ma","","and","","Liu,","","1998)","","and","","CMAR","","(Li","","et","","al.,\n2001),","but","they","tend","to","obtain","large","numbers","of","rules.","Similar","to","rule","lists,","the\naim","of","these","methods","is","to","maximize","the","classification","performance,","and","not\nto","describe","the","deviations","in","the","data.","Another","important","difference","is","that\nthese","methods","tend","to","return","crisp","decisions","instead","of","probabilities","and","can\nin","general","only","be","applied","to","nominal","targets.\nA","similar","class","of","methods","is","that","ofsupervised","pattern","set","mining(Zimmer-\nmann","","and","","Nijssen,","","2014).","","The","","key","","difference","","is","","that","","these","","methods","","do","","not\nautomatically","trade-off","model","complexity","and","classification","accuracy,","requir-\ning","the","analyst","to","choose","the","number","of","patternskin","advance.\nStatistical","","rule","","mining.The","","idea","","of","","mining","","rules","","with","","statistical","","guarantees\nis","appealing","as","it","increases","the","users","trust","in","the","patterns","found","while","at","the\nsame","time","reducing","the","number","of","rules","returned","by","a","miner","(H","̈am","̈al","̈ainen","and\nWebb,","2019).","The","concept","of","statistical","rule","mining","progressed","by","incremen-\ntally","adding","more","statistical","guarantees.","Webb","(2007)","proposed","for","the","first\ntime","mining","of","statistically","significant","patterns,","then","H","̈am","̈al","̈ainen","(2012)","pro-\nposed","KingFisher,","an","efficient","algorithm","to","mine","dependent","rules,","i.e.,","rules\nthat","show","a","dependency","with","respect","to","a","target","in","terms","a","dependency","test\nlike","Fisher’s","exact","test.","After","that,","H","̈am","̈al","̈ainen","and","Webb","(2017)","added","extra\nprocedures","to","remove","spurious","relations","from","the","miner","findings.","Lastly,","the\ncriteria","under","which","causal","rules","can","be","mined","was","defined","and","an","efficient\nalgorithm","","to","","mine","","them","","was","","proposed","","(Budhathoki","","et","","al.,","","2020).","","All","","these\nmethods","focus","on","mining","all","the","possibleindividualstatistically","significant","(or\n\nRobust","subgroup","discovery11\ncausal)","rules","and","not","on","finding","a","set","that","is","non-redundant,","as","is","the","case","of\nSubgroup","Set","Discovery.","In","this","paper,","we","aim","to","accomplish","both","at","the","same\ntime,","","finding","","the","","bestglobalsubgroup","","list","","while","","assuringlocalstatistically\nrobust","subgroups.\n2.3","Rule","lists\nSubgroup","","lists","","could","","be","","regarded","","as","","rule","","lists","","with","","afixeddefault","","rule,","","i.e.,\nthe","last","rule","that","gets","activated","when","no","other","rule","applies","is","fixed","to","‘predict’\nthe","global","distribution","of","the","complete","dataset.","Sections","5.4","and","6.4","show","that\nfixating","the","default","rule","to","the","overall","dataset","distribution","makes","rule","discovery\ntheoretically","equivalent","to","sequential","subgroup","set","discovery.\nRule","lists","have","long","been","successfully","applied","for","classification;","RIPPER","is","one\nof","the","best-known","algorithms","(Cohen,","1995).","Similarly,","decision","trees,","which\ncan","be","easily","transformed","to","rule","lists","(Quinlan,","1987),","have","been","used","exten-\nsively;","CART","(Breiman","et","al.,","1984)","and","C4.5","(Quinlan,","2014)","are","probably","the\nbest-known","","representatives.","","These","","early","","approaches","","represent","","highly","","greedy\nalgorithms","that","use","heuristic","methods","and","pruning","to","find","good","models.\nAlthough","all","algorithms","mentioned","in","this","section","have","some","resemblance","to\nour","","approach,","","their","","main","","goal","","is","","to","","make","","the","","best","","predictions—not","","to","","find\nthe","largest","deviations","in","the","data.","Even","though","the","two","problems","are","clearly\nrelated,","we","emphasize","the","theoretical","difference","between","subgroup","discovery\nand","prediction","in","Appendix","E,","where","the","former","focuses","onlocaldeviations\nand","the","latter","on","agloballyhomogeneous","partition","of","the","data.\nBayesian","rule","lists","and","optimal","decision","lists.Over","the","past","years,","rule","learn-\ning","methods","that","go","beyond","greedy","approaches","have","been","developed","for","binary\nclassification,","i.e.,","Monte-Carlo","search","for","Bayesian","rule","lists","(Letham","et","al.,\n2015;","Yang","et","al.,","2017),","and","branch-and-bound","with","tight","bounds","for","decision\nlists","(Angelino","et","al.,","2017).","Even","though","in","theory","these","approaches","could","be\neasily","extended","to","the","multiclass","scenario,","in","practice","their","algorithms","do","not\nscale","with","the","higher","dimensionality","of","those","search","spaces.","Bayesian","rule","lists\n(Letham","et","al.,","2015;","Yang","et","al.,","2017)","are","the","most","similar","to","our","approach,\nas","they","not","only","provide","probabilistic","predictions","but","also","use","a","similar","formu-\nlation","based","on","Bayesian","statistics.","Nonetheless,","their","focus","is","solely","on","binary\ntargets","and","on","classification","rather","than","subgroup","discovery.\nMDL","","Rule","","lists.More","","recently,","","Proen","̧ca","","and","","van","","Leeuwen","","(2020)","","proposed\nthe","use","of","an","MDL","formulation","of","rule","lists","for","multiclass","classification.","The\nproposed","algorithm","can","be","applied","to","discretized","data,","and","iteratively","adds","the\nbest","rule","from","a","set","of","premined","patterns","found","by","a","frequent","pattern","miner.\nOur","subgroup","lists","offer","an","improved","encoding","for","nominal","targets","by","using\nthe","Normalized","Maximum","Likelihood","(Shtar’kov,","1987),","an","encoding","that","is\noptimal","for","fixed","number","of","examples,","versus","the","asymptotic","optimality","of","the\nprequential","plug-in","code","or","Bayesian","code.","In","terms","of","the","algorithm,","our","new\n\n12Hugo","M.","Proen","̧ca","et","al.\nRSD","algorithm","uses","a","beam","search","to","find","the","rule/subgroup","to","add","at","each\niteration,","which","does","not","require","pre-mined","rules","and","also","supports","numeric\nattributes.","","Aoga","","et","","al.","","(2018)","","also","","proposed","","to","","use","","to","","find","","rule","","lists","","using\nMDL","and","a","set","of","premined","patterns,","although","its","focus","was","on","parsimonious\ndataset","description—versus","deviations","or","even","classification—of","small","trans-\naction","datasets","through","the","use","of","a","heavy","penalization","MDL","encoding","of","data\nand","model.\n2.4","MDL","in","pattern","mining\nIn","the","past,","for","models","similar","to","our","subgroup","lists,","the","MDL","principle","has\nmostly","","been","","embedded","","in","","small","","parts","","of","","predictive","","algorithms","","to","","solve","","the\nproblem","of","overfitting.","Prominent","examples","of","this","are","C4.5","(Quinlan,","2014)\nand","RIPPER","(Cohen,","1995),","which","use","the","MDL","principle","to","prune","overfitting\nmodels,","","and","","help","","generalization.","","Also,","","Zhang","","et","","al.","","(2000)","","used","","the","","MDL\nprinciple","to","choose","the","best","compressing","pattern","for","prediction.\nIn","data","mining,","Krimp","(Vreeken","et","al.,","2011)","was","the","first","method","to","apply","the\nMDL","principle","holistically,","i.e.,","for","the","whole","model","selection","process,","unlike\nprevious","","mentioned","","approaches","","that","","only","","used","","it","","for","","a","","subset","","of","","the","","model\nselection","process.","This","seminal","work","used","a","version","of","crude","MDL,","i.e.,","a","not\ncompletely","optimal","‘two-part’","encoding","of","the","data,","to","find","the","pattern","list","that\ncompressed","a","transaction","dataset","best,","in","order","to","address","thepattern","explosion\nissue","in","pattern","mining.","Recent","works","have","aimed","at","improving","the","encoding\nthrough","the","use","of","refined","MDL","for","encoding","the","data,","i.e.,","an","encoding","that\nenjoys","optimal","properties","at","least","in","expectation","(Gr","̈unwald,","2007).","The","first\nof","such","approaches","was","DiffNorm","(Budhathoki","and","Vreeken,","2015),","which","used\na","prequential","plug-in","code","to","improve","the","encoding","of","transaction","data","and\nrecently","MINT","was","proposed","to","mine","real-valued","patterns","sets","with","a","similar\nencoding(Makhalova","et","al.,","2020).","Although","Krimp,","DiffNorm","and","MINT","are\nused","to","describe","data,","they","aim","at","finding","regularities—not","deviations—and\ndo","not","consider","a","target","variable.","For","an","in-depth","survey","of","MDL","in","pattern\nmining","please","refer","to","the","survey","by","Galbrun","(2020).\nMDL","has","been","used","to","find","optimal","sets","of","association","rules","for","two-view","data\n(Van","Leeuwen","and","Galbrun,","2015)","and","for","tabular","data","(Fischer","and","Vreeken,\n2019).","The","latter","is","the","most","related","to","our","work,","as","it","aims","to","find","rule","sets","that\ndescribe","the","data","well.","Similar","to","Krimp","it","aims","at","finding","all","associations","in\nthe","data","though,","not","at","identifying","deviations","as","we","do,","and","no","specific","target\nvariable(s)","are","defined.\n2.5","Algorithmic","comparison","in","the","literature\nOur","proposed","algorithm","RSD","(presented","in","Section","7)","is","based","on","a","combina-\ntion","of","beam","search","for","candidate","generation","and","greedy","search","for","iteratively\nadding","subgroups","to","the","subgroup","list.","Both","techniques","have","been","widely","em-\nployed","for","similar","problems.\n\nRobust","subgroup","discovery13\nGreedy","","searchhas","","been","","often","","used","","for","","learning","","decision","","trees","","and","","rule","","lists\n(Quinlan,","2014;","Cohen,","1995;","F","̈urnkranz","et","al.,","2012;","Proen","̧ca","and","van","Leeuwen,\n2020),","as","well","as","for","pattern-based","modeling","using","the","MDL","principle","(Vreeken\net","al.,","2011;","Budhathoki","and","Vreeken,","2015;","Van","Leeuwen","and","Galbrun,","2015).\nBeam","","searchhas","been","commonly","used","for","candidate","generation","in","subgroup\ndiscovery","","(Meeng","","and","","Knobbe,","","2011),","","including","","for","","finding","","subgroup","","sets\n(Lavraˇc","et","al.,","2004;","Van","Leeuwen","and","Knobbe,","2012).","We","next","provide","the\nmotivation","for","our","algorithmic","choices,","and","describe","key","similarities","and","dif-\nferences","","compared","","to","","algorithms","","in","","the","","most","","related","","literature:","","1)","","rule","","list\nlearning;","","2)","","subgroup","","set","","discovery;","","and","","3)","","evolutionary","","algorithms","","for","","rule\nlearning.\nAlgorithms","for","finding","rule","lists.The","common","way","to","finding","a","good","rule","list","is\nthrough","heuristic","search","(Cohen,","1995;","F","̈urnkranz","et","al.,","2012;","Proen","̧ca","and","van\nLeeuwen,","2020),","however","recent","works","have","proposed","to","find","optimal","models\nfor","binary","classification","under","specific","conditions","(Yang","et","al.,","2017;","Angelino\net","al.,","2017).","Belong","to","the","former","category,","Proen","̧ca","and","van","Leeuwen","(2020)\nuses","a","Separate","and","Conquer","(SaC)","technique","to","greedily","add","rules,","together\nwith","","Frequent","","Pattern","","Mining","","for","","candidate","","generation.","","In","","this","","paper,","","the\nbeam","search","for","candidate","generation","does","not","require","a","discretized","dataset,\nis","faster,","and","without","large","loss","in","the","quality","of","the","subgroups","found","due","to\ndiscretization","(Meeng","and","Knobbe,","2020).","In","the","latter","category,","of","optimal\nrule","list","discovery,","the","algorithms","were","only","developed","for","binary","classification,\nand","either","require","a","simplification","of","the","rules","in","the","list","to","decision","rules—with\ntrue","or","false","instead","of","probabilities","as","consequent—combined","with","a","simple\nobjective","function,","such","as","accuracy,","that","allows","for","efficient","branch-and-bound\n(Angelino","et","al.,","2017),","or","it","requires","the","dataset","to","be","sparse","and","small,","with\nlarge","minimum","supports","for","the","rules","(above","10%)","and","using","a","convergence\nto","an","optimal","algorithm","such","as","Monte","Carlo","sampling","(Yang","et","al.,","2017).\nNeither","of","these","approaches","can","deal","with","a","variety","of","target","variables","as","our\nproposed","approach","can.\nAlgorithms","","for","","subgroup","","set","","discovery.Both","beam","search","and","greedy","search\nare","commonplace","in","subgroup","set","discovery","(Lavraˇc","et","al.,","2004;","Van","Leeuwen\nand","Knobbe,","2012),","due","to","their","efficiency","and","flexibility","in","being","applied","to\ndifferent","","types","","of","","targets.","","More","","recently,","","Monte","","Carlo","","Tree","","Search","","(MCTS)\nwas","proposed","for","mining","sets","of","subgroups","(Bosc","et","al.,","2018),","although","it","can\nonly","be","applied","to","binary","targets","and","specific","types","of","explanatory","variables.","In\nthe","classical","case","of","mining","top-ksubgroups","without","incorporating","diversity,\nexhaustive","search","is","feasible","(Boley","et","al.,","2017),","but","again","it","is","only","efficient\nfor","specific","types","of","quality","measures","or","targets,","and","does","not","scale","well","for\nfinding","the","best","set","(Van","Leeuwen","and","Knobbe,","2012).","Together","with","the","fact\nthat","the","loss","in","quality","of","using","beam","search","is","almost","negligible","(Meeng","and\nKnobbe,","2020),","exact","algorithms","are","almost","never","used","in","MDL-based","data\nmining,","because","it","is","infeasible","(Vreeken","et","al.,","2011;","Budhathoki","and","Vreeken,\n2015;","Fischer","and","Vreeken,","2019;","Proen","̧ca","and","van","Leeuwen,","2020).\n\n14Hugo","M.","Proen","̧ca","et","al.\nEvolutionary","","algorithms.Global","heuristics,","such","as","evolutionary","algorithms,\nhave","been","applied","to","fuzzy","rule-based","model","learning","(Fernandez","et","al.,","2015),\nand","although","they","could","also","be","applied","here,","we","found","that","the","arguments","in\nfavor","of","a","local","search","approach","were","stronger:","1)","local","heuristics","have","often\nbeen","successfully","applied","for","pattern-based","modeling","using","the","MDL","principle,\nmaking","it","a","natural","approach","to","consider;","2)","local","heuristics","are","typically","faster\nthan","global","heuristics,","as","much","fewer","candidates","need","to","be","evaluated;","3)","global\nheuristics","typically","require","substantially","more","(hyper)parameters","that","need","to\nbe","tuned","(e.g.,","population","size,","selection","and","mutation","operators,","etc.),","while\nlocal","heuristics","have","very","few.\n3","Subgroup","Discovery\nIn","this","section","we","describe","the","basic","notation","and","concepts","of","subgroup","discov-\nery.","Starting","from","data","and","target","types,","we","move","to","subgroups,","their","interpre-\ntation","as","probabilistic","rules,","and","quality","measures","for","individual","subgroups.\nWe","","pay","","specific","","attention","","to","","one","","such","","quality","","measure,","","Weighted","","Kullback-\nLeibler","divergence","(WKL),","because","it","fits","our","information-theoretic","approach\nwell.","Next","we","specify","subgroup","set","discovery,","after","which","we","conclude","the","sec-\ntion","with","a","novel","proposal","for","a","quality","measure","for","subgroup","sets","based","on\nthe","WKL","measure","for","individual","subgroups.\n3.1","Data","and","target","types\nConsider","a","datasetD=","(X,Y)","={(x\n1\n,y\n1\n),(x\n2\n,y\n2\n),...,(x\nn\n,y\nn\n)}ofni.i.d.\ninstances.","Each","instance","(x,y)","is","composed","of","a","vector","of","explanatory","variable\nvaluesxand","a","vector","of","target","variable","valuesy.","Each","observed","explanatory\nvector","","hasmvaluesx=","","[x\n1\n,...,x\nm\n],","","one","","for","","each","","variableX\n1\n,...,X\nm\n.","","The\ndomain","","of","","a","","variableX\nj\n,","","denotedX\nj\n,","","can","","be","","one","","of","","two","","types:","","nominal","","or\nnumeric.","Similarly,","each","observed","target","vector","is","composed","oftvaluesy=\n[y\n1\n,...,y\nt\n],","one","for","each","target","variableY\n1\n,...,Y\nt\n,","with","associated","domainsY\nj\n.\nThe","target","variables","can","be","of","two","types:","numeric,","or","nominal.","In","the","numeric\ncase,","the","domain","isY\nj\n=Rand","in","the","nominal","it","isY\nj\n={1,·,k},","withY\nj\nthe","","set","","of","","classes/categories","","of","","variableY\nj\n.","","For","","the","","complete","","notation","","used\nthroughout","this","work","please","refer","to","Table","2.\nNote","that","we","use","subscripts","on","the","dataset","variables","(D,X,Y,X,Y,x,y)","to\nindicate","column","indices","and","superscripts","for","row","indices.","In","the","case","of","other\nnotation,","such","as","number","of","elementsnor","statisticsμ,σwe","will","not","use","the\nsuperscript","as","it","could","be","confused","with","the","exponentiation","of","that","value.","Also,\nX\ni\n(resp.Y\ni\n)","refers","to","both","the","properties","of","thei\nth\nexplanatory","(resp.","target)\nvariable","and","to","all","the","values","of","this","variable","for","a","specific","column.\nDepending","","on","","the","","type","","and","","number","","of","","targets","","(one","","or","","multiple),","","the","","type\nof","problem","can","be","divided","intofourcategories:1)","","single-nominal;2)","","single-\nnumeric;3)","","multi-nominal;","","and4)","","multi-numeric.","","In","","machine","","learning,","","the\n\nRobust","subgroup","discovery15\nsingle-numeric","case","corresponds","to","regression,","the","single-nominal","to","classifica-\ntion,","and","in","the","case","of","more","than","one","variable","their","multi-target","generaliza-\ntions,","respectively.\n3.2","Subgroups\nA","subgroup,","denoted","bys,","consists","of","adescription(also","intent)","that","defines\nacover(also","extent),","i.e.,","a","subset","of","datasetD.\nSubgroup","description:A","descriptionais","a","Boolean","function","over","all","explana-\ntory","variablesX.","Formally,","it","is","a","functiona\n:\nX\n1\n×···×X\nm\n7→{false,true}.\nIn","our","case,","a","descriptionais","a","conjunction","of","conditions","onX,","each","specifying\na","specific","value","or","interval","on","a","variable.","The","domain","of","possible","conditions","de-\npends","on","the","type","of","a","variable:","numeric","variables","supportgreater","and","less","than\n{≥,≤};","nominal","supportequal","","to{=}.","The","size","of","a","descriptiona,","denoted\n|a|,","is","the","number","of","conditioned","variables","it","contains.\nExample","1:In","Figure","2,","subgroup","1","has","a","description","of","size|a|=","2,","with","one\ncondition","on","a","nominal","variable:{weigth","=","heavy};","and","another","on","a","numeric\nvariable:{consumption-city≤8km/L}.\nSubgroup","cover:The","cover","is","the","bag","of","instances","fromDwhere","the","subgroup\ndescription","holds","true.","Formally,","it","is","defined","by:\nD\na\n={(x,y)∈D|avx}={X\na\n1\n,···,X\na\nm\n,Y\na\n1\n,···,Y\na\nt\n}={X\na\n,Y\na\n},(1)\nwhere","we","useavxto","denotea(x)","=true.","Further,","letn\na\n=|D\na\n|denote","the\ncoverage","of","the","subgroup,","i.e.,","the","number","of","instances","it","covers.\nExample","","2","","(continuation):In","","Figure","","2,","","subgroup","","1","","covers","","11","","instances","","in\nthe","dataset","which","can","be","found","by","conditions","in","its","description,","and","thus","its\ncoverage","is","11.\n3.3","Interpretation","as","probabilistic","rule\nAsD\na\nencompasses","both","the","explanatory","and","target","variables,","the","effect","ofa\non","the","target","variables","can","be","interpreted","as","a","probabilistic","rule.","Regarding","the\nmultiple","target","variables,","we","assume","that","they","areindependent.","This","simplifies\nthe","problem","and","is","a","common","approach","in","multi-label","classification","(Herrera\net","al.,","2016).","Thus,","the","general","form","of","the","rule","is:\na7→y\n1\n∼Dist(\nˆ\nΘ\na\n1\n),···,y\nt\n∼Dist(\nˆ\nΘ\na\nt\n),(2)\nwherey\nj\nis","a","value","of","variableY\nj\n,Distis","a","probability","distribution","(defined\nlater)","and\nˆ\nΘ\na\nj\nis","the","shorthand","for","the","maximum","likelihood","estimation","of","the\n\n16Hugo","M.","Proen","̧ca","et","al.\nTable","2:","Notation","table.\nSymbolDefinition\nD={X,Y}Labelled","dataset.\nXDataset","of","explanatory","variables","ofD.\nXAn","explanatory","variable","ofX.\nXDomain","ofX.\nxA","explanatory","variables","sample","ofX.\nxThe","value","of","samplexfor","variableX.\nYDataset","of","target","variables","ofD.\nYAn","target","variable","ofY.\nYDomain","ofY.\nyA","target","variables","sample","ofY.\nyThe","value","of","sampleyfor","variableY.\n|·|Number","of","elements","in","a","set,","as","e.g.,|D|for","number","of","samples.\niIndex","for","subsetting","by","row.\njIndex","for","subsetting","by","column.\nvA","generic","explanatory","variable.\nkNumber","of","classes","of","a","nominal","target","variable.\nnNumber","of","examples","in","datasetD.\nmNumber","of","explanatory","variables.\ntNumber","of","target","variables.\ndSubscript","associated","with","dataset","distribution","or","defaul","rule.\nMSubgroup","list","model","(including","subgroups","S","and","default","rule).\nSSubgroups","in","model","M.\nωNumber","of","subgroups","inM.\nsA","subgroup.\naDescription","of","a","subgroup.\na\ni\nDescription","of","thei\nth\nsubgroup","in","model","M.\nD\na\n={X\na\n,Y\na\n}Samples","of","datasetDcovered","by","descriptiona.\nn\na\nNumber","of","samples","inD\na\n.n\na\n=|D\na\n|.\nD\ni\n={X\ni\n,Y\ni\n}Samples","of","datasetDcovered","by","thei\nth\nsubgroup","in","model","M.\nn\ni\nNumber","of","samples","inD\ni\n.n\ni\n=|D\ni\n|.\nDist(Θ)Generic","probability","distribution","with","parametersΘ.\nN(μ;σ)Normal","probability","distribution","with","parametersμandσ.\nCat(p\n1\n,···,p\nk\n)Categorical","probability","distribution","withp\ni\nprobability","per","category.\np\ny|c\nProbability","of","categoryygiven","descriptiona,","i.e.,","Pr(y|a)\nμMean","value","parameter.\nσStandard","deviation","parameter.\nˆ\nθMaximum","likelihood","estimation","of","parameterθ.\nq(a)Subgroup","discovery","quality","measure.\nQ(S)Subgroup","set","discovery","quality","measure.\nf(\nˆ\nΘ\na\n,\nˆ\nΘ\nd\n)Function","of","differences","between","distribution\nˆ\nΘ\na\nand\nˆ\nΘ\nd\n.\nαTradeoff","between","subgroup","coverage","and","distribution","difference.\nKLKullback-Leibler","divergence","general","form.\nKL\nCat\nKullback-Leibler","divergence","for","categorical","distributions.\nKL\nμ\nKullback-Leibler","divergence","for","location","distributions.\nKL\nμ,σ\nKullback-Leibler","divergence","for","normal","distributions.\nWKLWeighted","Kullback-Leibler","divergence","general","form.\nSWKLSum","of","Weighted","Kullback-Leibler","divergences.\nL\nN\nUniversal","code","of","integers.\nL\nNML\n(Y\ni\nj\n)Normalized","Maximum","Likelihood","length","of","encoding","of","dataY\ni\nj\n.\nC(n\na\n,k)Multinomial","distribution","complexity","withn\na\npoints","andkcategories.\nL\nBayes\nBayesian","length","of","encoding","with","improper","priors.\nY\ni|2\nThe","two","points","that","make","the","Bayesian","encoding","proper.\nL\nBayes2.0\nBayesian","length","of","encoding","made","proper","with","first","2","points.\nΓ(n)Gamma","function,","the","extension","of","the","factorial","to","real","numbers.\n∆\nβ\nL(D,M⊕s)Compression","gain","of","adding","subgroupsto","modelM.\nβLevel","of","normalization","of","the","compression","gain.\nζSet","of","all","items","(possible","single","conditions)","inX.\nstatsStatistics","of","a","subgroup.\nd\nmax\nBeam","search","maximum","depth","of","search.\nw\nb\nBeam","search","beam","width.\nn\ncut\nNumber","of","cut","points","for","numeric","discretization.\n\nRobust","subgroup","discovery17\nparameters","ofDistover","valuesY\na\nj\n,","i.e.,\nˆ\nΘ\na\nj\n=\nˆ\nΘ\nj\n(Y\na\n).","Thus,y\ni\n∼Dist(\nˆ\nΘ\na\nj\n)\ntells","","us","","that","","the","","values","","of","","variableY\nj\nare","","distributed","","according","","to","","a","","distri-\nbutionDistwith","","parameters\nˆ\nΘ\na\nj\nestimated","","over","","the","","valuesY\na\nj\n.","","The","","vector\nof","all","parameter","values","of","a","rule","is","denoted","byΘ\na\n.","In","our","case,Distcan","be\nacategoricalornormaldistribution","","in","","the","","nominal","","or","","numeric","","target","","case,\nrespectively.","With","respect","to","numeric","targets","other","distributions","could","have\nbeen","chosen,","however","thenormaldistribution","incorporates","some","of","the","most\nrelevant","information","of","the","data","through","mean","and","variance","of","the","data,","it","is\nwell","studied","for","the","regression","problems","(Friedman","et","al.,","2001),","and","can","be\nsolved","in","a","closed","form","from","a","Bayesian","(Jeffreys,","1998)","and","MDL","(Gr","̈unwald,\n2007)","perspective.","For","an","analysis","on","the","direct","use","of","the","numeric","empirical\ndistribution","in","subgroup","discovery","please","refer","to","Meeng","et","al.","(2020).","In","the\nnumeric","case","the","normal","distribution","is","represented","as:N(ˆμ,ˆσ).","In","the","nomi-\nnal","case","the","distribution","isCat(","ˆp\n1\n,···,ˆp\nk\n),","wherekis","the","number","of","classes\n(or","categories)","of","the","corresponding","variable","and","ˆp\nc\nthe","estimated","probability\nfor","classc.\nExample","3","(continuation):Revisiting","theAutomobile","importsubgroup","list","in\nFigure","2,","the","description","and","corresponding","statistics","for","the","second","subgroup\narea={fuel-type","=","gas","&","consumption-city≥13","km/L}and\nˆ\nΘ\na\n2\n={ˆμ=\n7;","ˆσ=","","1},","","respectively,","","where","","the","","units","","are","","thousands","","of","","dollars","","(K).","","This\ncorresponds","to","the","following","normal","probability","distribution:\nprice","(K)∼N(ˆμ=","7;","ˆσ=","1)\nExample","4","(continuation):In","the","case","of","theZoosubgroup","list","in","Figure","1,","the\ndescription","for","the","first","subgroup","isa={feathers","=","yes},","and","its","corresponding\nstatistics","are\nˆ\nΘ\na\n1\n={ˆp\n1\n=","0;","ˆp\n2\n=","0;","ˆp\n3\n=","0.56;","ˆp\n4\n=","0.44;","ˆp\n5\n=","0;","ˆp\n6\n=","0;","ˆp\n7\n=\n0},","where","the","class","labels","1,...,7","correspond","to","the","animal","types","in","the","order\nof","Figure","1.","The","target","variable","follows","the","following","categorical","distribution:\nanimal\ntype∼Cat(","ˆp\n1\n,ˆp\n2\n,ˆp\n5\n,ˆp\n6\n,ˆp\n7\n=","0.00;","ˆp\n3\n=","0.56;","ˆp\n4\n=","0.44)\n3.4","Quality","measures\nTo","assess","the","quality","(or","interestingness)","of","a","subgroup","descriptiona,","a","measure\nthat","scores","subsetsD\na\nneeds","to","be","chosen.","The","measures","used","vary","depending\non","the","target","and","task","(Atzmueller,","2015),","but","in","general","it","has","two","compo-\nnents:","","1)","","representativeness","","of","","the","","subgroup","","in","","the","","data,","","based","","on","","coverage\nn\na\n=|D\na\n|;","and","2)","a","function","of","the","difference","between","statistics","of","the","empir-\nical","target","distribution","of","the","pattern,\nˆ\nΘ\na\n=\nˆ\nΘ(Y\na\n),","and","the","overall","empirical\ntarget","distribution","of","the","dataset,\nˆ\nΘ\nd\n=\nˆ\nΘ(Y).","The","latter","corresponds","to","the\nstatistics","estimated","over","the","whole","data,","e.g.,","in","the","case","of","theAutomobile\nimportsubgroup","list","of","Figure","2","it","is\nˆ\nΘ\nd\n={ˆμ=","13;","ˆσ=","8}and","it","is","estimated\nover","all","197","instances","of","the","dataset.\n\n18Hugo","M.","Proen","̧ca","et","al.\nThe","general","form","of","a","quality","measure","to","be","maximized","is\nq(a)","=","(n\na\n)\nα\nf(\nˆ\nΘ\na\n,\nˆ\nΘ\nd\n),","α∈[0,1],(3)\nwhereαallows","to","control","the","trade-off","between","coverage","and","the","difference","of\nthe","distributions,","andf(\nˆ\nΘ\na\n,\nˆ\nΘ\nd\n)","is","a","function","that","measures","how","different","the\nsubgroup","and","dataset","distributions","are.","As","an","example,","the","most","commonly\nadopted","quality","measure","for","single-numeric","targets","is","Weighted","Relative","Ac-\ncuracy","(WRAcc)(Lavraˇc","et","al.,","1999),","withα=","1","andf(\nˆ\nΘ\na\n,\nˆ\nΘ\nd\n)","=","","ˆμ\na\n−ˆμ\nd\n(the","difference","between","subgroup","and","dataset","averages).\n3.5","Weighted","Kullback-Leibler","divergence\nAnother","commonly","adopted","measure","is","the","Weighted-Kullback","Leibler","diver-\ngence","","(WKL)","","(Van","","Leeuwen","","and","","Knobbe,","","2011).","","This","","is","","also","","the","","measure\nthat","we","consider","throughout","this","work","because","of","1)","its","flexibility","in","terms","of\n(number","and","types","of)","supported","target","variables;","and","2)","its","relationship","to\nthe","MDL","principle","(see","Sections","5.4","and","6.4).\nWKL","is","defined","as","the","Kullback-Leibler","(KL)","divergence","(Kullback","and","Leibler,\n1951)","between","a","subgroup’s","and","dataset","target","distributionKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","lin-\nearly","weighted","by","its","coverage.","Revisiting","Eq.","(3)","this","corresponds","tof(.)","=\nKL(.)","andα=","1.","The","definition","of","WKL","for","a","univariate","target","variableYis\ngiven","by:\nWKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","=n\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n),(4)\nwhereKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","is","the","Kullback-Leibler","divergence","between","subgroup","and\ndataset","for","targetY.","The","KL","divergence","in","Eq.","(4)","depends","on","the","probabilistic\nmodel","","chosen","","to","","describe","","the","","target","","variables.","","In","","its","","general","","form","","the","","KL\ndivergence","can","be","defined","as:\nKL(\nˆ\nΘ\na\nj\n;\nˆ\nΘ\nd\nj\n)","=\n∑\ny∈Y\na\nPr(y|\nˆ\nΘ\na\nj\n)","log\n\n\nPr(y|\nˆ\nΘ\na\nj\n)\nPr(y|\nˆ\nΘ\nd\nj\n)\n\n\n,(5)\nwhere","the","logarithm","is","to","the","base","two","(like","all","logs","in","this","work).","Thus","the\nchoice","of","the","distribution","used","to","describe","the","target","is","of","great","importance","and\nshould","reflect","what","the","analyse","would","like","find","in","the","data.","Now,","depending","of\nthe","type","of","target","we","will","see","show","how","to","computeWKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n).","It","is","easy\nto","see","that","for","multivariate","targets","we","either","use","a","multivariate","distribution,\ne.g.,","a","multivariate","normal","distribution,","or","assume","that","they","areindependent\ntarget","variables,","where","the","total","WKL","turns","out","to","be","just","the","sum","the","WKL\nfor","each","target","variable.\nWe","","will","","now","","provide","","the","","definitions","","of","","WKL","","for","","univariate","","categorical","","and\nnormal","distributions.\n\nRobust","subgroup","discovery19\nWeighted","","Kullback-Leibler","","for","","categorical","","distributions.In","the","case","of","a","uni-\nvariatenominal","targetY,","the","distribution","can","be","uniquely","described","by","a","cate-\ngorical","distribution","with","the","probability","of","each","category\nˆ\nΘ\na\n={ˆp\n1|a\n,...,ˆp\nk|a\n},\nso","that","theKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","of","Eq.","(4)","takes","the","form","of:\nKL\nCat\n(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","=\n∑\nc∈Y\nˆp\nc|a\nlog\n(\nˆp\nc|a\nˆp\nc\n)\n,(6)\nwhere","","ˆp\nc|a\n=","Pr(c|a)","is","the","maximum","likelihood","estimate","of","the","conditional\nprobability","of","the","targetcgiven","the","subgroupa,","and","ˆp\nc\nis","the","marginal","prob-\nability","for","that","category.\nWeighted","","Kullback-Leibler","","for","","normal","","distributions.In","the","case","of","a","univari-\natenumerictargetY,","","many","","distributions","","could","","be","","used","","for","","modelling.","","We\nresort","to","the","normal","distribution","for","its","robustness","and","analytical","properties,\nas","mentioned","before.","Nonetheless,","still","two","possibilities","remain:","a","location","dis-\ntribution\nˆ\nΘ\na\n={μ\na\n}that","only","accounts","for","the","mean,","or","a","‘complete’","normal\ndistribution\nˆ\nΘ\na\n={μ\na\n,σ\na\n}that","accounts","for","the","mean","and","the","variance.","With\nthe","location","distributionKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","equals\n1\n:\nKL\nμ\n(s)","=\n(ˆμ\nd\n−ˆμ\na\n)\n2\nˆσ\nd\n,(7)\nwhile","with","the","normal","distribution","one","obtains:\nKL\nμ,σ\n(s)","=\n[\nlog\nˆσ\nd\nˆσ\na\n+\nˆσ\n2\na\n+","(ˆμ\na\n−ˆμ\nd\n)\n2\n2ˆσ\n2\nd\nloge−\nloge\n2\n]\n.(8)\nNote","that","since","ˆσ\nd\nis","a","constant","for","each","dataset,","there","is","a","strong","resemblance\nbetweenWKL\nμ\n(s)","and","WRAcc,","where","the","only","difference","is","the","square","of","the\ndifference","of","the","means.","Also","notice","thatWKL\nμ,σ\ndirectly","takes","into","account\nthe","variance","of","a","subgroup","and","penalizes","for","a","larger","variance,","whileWKL\nμ\n(s)\n(and","","also","","WRAcc)","","do","","not","","take","","into","","account","","the","","variance,","","and","","thus","","fail","","to\ngive","importance","to","the","spread","of","subgroup","values.","This","is","a","key","point","as","this\nmakes","","a","","quality","","measure","","likeWKL\nμ,σ\n(s)dispersion-aware,","","while","","measures\nlikeWKL\nμ\n(s)","andWRAccare","not.\n3.6","Subgroup","set","discovery\nSubgroup","set","discovery","(Van","Leeuwen","and","Knobbe,","2012)","is","the","task","of","finding\na","set","of","high-quality,","non-redundant","subgroups","that","together","describe","all","sub-\nstantial","deviations","in","the","target","distribution.","That","is,","given","a","quality","function\nQfor","subgroup","sets","and","the","set","of","all","possible","subgroup","setsS,","the","task","is","to\nfind","that","subgroup","setS\n∗\n={s\n1\n,...,s\nk\n}given","byS\n∗\n=","arg","max\nS∈S\nQ(S).","Note\nthatQshould","not","only","take","into","account","the","individual","quality","of","subgroups\n1\nThe","derivations","of","these","formulas","can","be","found","in","Appendix","D.\n\n20Hugo","M.","Proen","̧ca","et","al.\nq(a),","","but","","also","","the","","overlap","","of","","their","","coveragesD\na\nand","","quantify","","the","","contribu-\ntion","of","each","instance","only","once,","as","opposed","to","top-kmining","where","only","their\nindividual","qualities","are","taken","into","account,","i.e.,Q(S)","=\n∑\nq(a).\nIdeally","a","quality","measure","for","subgroup","setsQshould:","1)be","","global,","i.e.,","for","a\ngiven","dataset","it","should","be","possible","to","compare","subgroup","set","qualities","regardless\nof","subgroup","set","size","or","coverage;","2)maximize","","the","","individual","","qualitiesof","the\nsubgroups;","and","3)minimize","redundancyof","the","subgroup","set,","i.e.,","the","subgroups\ncovers","should","overlap","as","little","as","possible","while","ensuring","the","previous","point.\n3.7","A","new","measure","for","subgroup","sets:","the","sum","of","WKL","divergences\nFollowing","the","previous","subsections,","we","extend","the","KL-based","measure","of","Eq.","(4)\nfor","individual","subgroups","to","a","measure","for","subgroup","lists.","That","is,","we","propose\ntheSum","of","Weighted","Kullback-Leibler","divergences(SWKL),","which","can","be","in-\nterpreted","as","the","sum","of","weighted","KL","divergences","for","the","individual","subgroups:\nSWKL(S)","=\n∑\nω\ni=1\nn\ni\nKL(\nˆ\nΘ\ni\nj\n;\nˆ\nΘ\nd\nj\n)\n|D|\n,(9)\nwhereiis","the","index","of","each","subgroup","in","a","subgroup","list","(as","will","be","formalized\nin","","Section","","4),ωis","","the","","number","","of","","subgroups","","inS,","","and|D|is","","the","","number\nof","","instances","","inD.","","The","","latter","","is","","used","","to","","normalize","","the","","measure","","and","","make\nvalues","","comparable","","across","","datasets.","","In","","case","","of","","multiple","","target","","variables","","the\nnormalization","could","also","include","the","number","of","targets,","but","we","do","not","use","this\nin","","this","","work.","","The","","SWKL","","measure","","assumes","","that","","the","","data","","is","","partitioned","","per\nsubgroup","and","is","based","on","the","assumption","that","subgroups","can","be","interpreted\nsequentially","as","a","list,","i.e.,","the","second","subgroup","is","interpreted","as:","the","description\nof","the","second","subgroup","is","active,","while","the","one","of","the","firstis","notactive.\nAn","advantage","of","the","SWKL","measure","is","that","it","can","be","used","for","any","type","of","target\nvariable(s),","as","long","as","they","are","described","by","a","probabilistic","model.","Note","that\ncomputing","SWKL","is","straightforward","for","subgroup","lists,","but","not","for","subgroup\nsetsas","instances","can","be","covered","by","multiple","subgroups.","For","subgroup","sets,","it\nwould","be","necessary","to","explicitly","define","the","type","of","probabilistic","overlap,","e.g.,\nadditive","or","multiplicative","mixtures","of","the","individual","subgroup","models.\nIt","should","be","noted","that","this","measure","only","quantifies","how","well","a","list","of","subgroups\ncapture","the","deviations","in","a","given","dataset","and","is","prone","to","overfitting:","the","higher\nthe","number","of","subgroups,","the","easier","it","is","to","obtain","a","higher","value","as","there","is\nno","penalty","for","the","number","of","subgroups","(or","their","individual","complexities,","for\nthat","matter).","As","such,","SWKL","can","be","seen","as","a","measure","for","‘goodness","of","fit’\nfor","subgroup","lists.","This","turns","out","to","not","be","an","issue","for","our","approach","though,\nas","our","MDL-based","criterion","naturally","penalizes","for","multiple","hypothesis","testing\nand","complexity","of","the","individual","subgroups.","Further,","it","is","neither","an","issue","in\nour","empirical","comparisons","in","Section","8,","as","the","number","of","subgroups","found","was\nsimilar","for","most","algorithms,","rendering","the","SWKL-based","comparison","valid.\n\nRobust","subgroup","discovery21\n4","MDL-based","Subgroup","Set","Discovery\nIn","","this","","section","","we","","formalize","","the","","task","","of","","subgroup","","set","","discovery","","as","","a","","model\nselection","","problem","","using","","the","","Minimum","","Description","","Length","","(MDL)","","principle\n(Rissanen,","1978;","Gr","̈unwald,","2007;","Gr","̈unwald","and","Roos,","2019).","To","this","end","we\nfirst","need","to","define","an","appropriate","model","classM;","as","we","will","explain","next,","we\nusesubgroup","listsas","our","models.","As","we","want","to","find","the","best","model,","the","model\nselection","problem","should","then","be","formalized","using","a","two-part","code","(Gr","̈unwald,\n2007),","i.e.,\nM\n∗\n=","arg","min\nM∈M\nL(D,M)","=","arg","min\nM∈M\n[\nL(Y|X,M)","+L(M)\n]\n,(10)\nwhereL(Y|X,M)","is","the","encoded","length,","in","bits\n2\n,","of","target","variables","data\nYgiven","explanatory","dataXand","modelM,L(M)","is","the","encoded","length,","in\nbits,","of","the","model,","andL(D,M)","is","the","total","encoded","length","and","the","sum","of\nboth","terms.","Intuitively,","the","best","modelM\n∗\nis","the","model","that","results","in","the\nbest","","trade-off","","between","","how","","well","","the","","model","","compresses","","the","","target","","data","","and\nthe","","complexity","","of","","that","","model—thus","","minimizing","","redundancy","","and","","automati-\ncally","selecting","the","best","subgroup","list","size.","This","formulation","is","similar","to","those\npreviously","used","for","two-view","association","discovery","and","multi-class","classifica-\ntion","(Van","Leeuwen","and","Galbrun,","2015;","Proen","̧ca","and","van","Leeuwen,","2020).\nThis","section","is","divided","as","follows.","First,","in","Section","4.1","we","describe","the","details","of\nthe","model","class.","Then,","in","Section","4.2","the","encoding","of","the","model","part","is","shown.\nFinally,","in","Section","4.3","the","high-level","encoding","of","the","data","given","the","model","is\npresented.","The","specific","encoding","of","the","data","given","the","model","for","categorical\nand","normal","distributions","is","given","in","Sections","5","and","6,","respectively.\n4.1","Model","Class:","Subgroup","Lists\nAlthough","Eq.","(10)","provides","aglobalcriterion","that","enables","the","comparison","of\nsubgroup","sets","of","different","sizes,","subgroups","are","descriptions","oflocalphenomena\nand","we","require","eachindividual","subgroup","to","have","high","quality.\nWe","accomplish","this","by","usingsubgroup","listsas","models;","see","Figure","3.","Specifically,\nas","we","are","only","interested","in","finding","subgroups","for","which","the","target","deviates\nfrom","the","overall","distribution,","we","assumeYvalues","to","be","distributed","according\nto\nˆ\nΘ\nd\nby","default","(last","line","in","Figure","3).","For","each","region","in","the","data","for","which\nthe","target","distribution","deviates","from","that","distribution","and","a","description","exists,\na","subgroup","specifying","a","different","distribution\nˆ\nΘ\na\nis","added","to","the","list.\nWe","model","the","empirical","distributions\nˆ\nΘof","nominal","target","variables","with","cat-\negorical","","distributionsCategorical(","ˆp\n1\n,···,ˆp\nk\n),","","and","","numeric","","target","","variables\nby","univariate","normal","distributionsN(ˆμ,ˆσ).","The","categorical","distribution","is","a\nnatural","choice","for","describing","the","probabilities","of","classes","(Letham","et","al.,","2015)\nand","","the","","normal","","distribution","","captures","","two","","properties","","of","","interest","","in","","numeric\n2\nTo","obtain","code","lengths","in","bits,","all","logarithms","in","this","paper","are","to","the","base","2.\n\n22Hugo","M.","Proen","̧ca","et","al.\ns\n1\n:IFa\n1\nvxTHENy\n1\n∼Dist(\nˆ\nΘ\n1\n1\n)···y\nt\n∼Dist(\nˆ\nΘ\n1\nt\n)\n.\n.\n.\ns\nω\n:ELSE","IFa\nω\nvxTHENy\n1\n∼Dist(\nˆ\nΘ\nω\n1\n)···y\nt\n∼Dist(\nˆ\nΘ\nω\nt\n)\ndataset:","","","","ELSEy\n1\n∼Dist(\nˆ\nΘ\nd\n1\n)···y\nt\n∼Dist(\nˆ\nΘ\nd\nt\n)\nFig.","3:","Generic","subgroup","list","modelMwithωsubgroupsS={s\n1\n,...,s\nω\n}and\nt(number","of","target","variables)","distributions","per","subgroup.\nvariables,","i.e.,","center","and","spread,","while","being","robust","to","cases","where","the","data\nviolates","the","normality","assumption","(Gr","̈unwald,","2007).\nOrdering","","the","","rules","","formed","","by","","subgroupsS={s\n1\n,···,s\nω\n}and","","adding","","the\ndataset","rule","at","the","end","(default","rule)","leads","to","a","subgroup","listMof","the","form\nof","","Figure","","3.","","This","","corresponds","","to","","a","","probabilistic","","rule","","list","","withω=|S|sub-\ngroups/rules","","and","","a","","last","","(default)","","rule","","that","","is","","fixed","","to","","the","","overall","","empirical\ndistributions","for","each","target","variable","(Proen","̧ca","and","van","Leeuwen,","2020).","Fix-\ning","the","distribution","of","this","last","‘rule’","is","crucial","and","differentiates","a","subgroup\nlist","from","a","rule","list","as","used","in","classification","and/or","regression","(Proen","̧ca","and\nvan","Leeuwen,","2020),","as","this","enforces","the","discovery","of","a","set","of","subgroups","whose\nindividual","target","distributions","all","substantially","deviate","from","the","overall","target\ndistribution","(dataset","rule).","It","is","shown","in","Section","5.4","for","nominal","targets","and\nin","Section","6.4","for","numeric","targets","that","the","objective","of","finding","a","subgroup","list\nwith","this","format","is","equivalent","to","top-ksubgroup","discovery,","when","finding","sub-\ngroup","lists","with","just","one","subgroup.","A","theoretical","comparison","of","the","difference\nbetween","the","objectives","of","predictive","rule","lists","and","subgroup","lists","is","given","in\nAppendix","E.\n4.2","Model","Encoding\nThe","","next","","step","","is","","to","","define","","the","","two","","length","","functions;","","we","","start","","withL(M).\nFollowing","","the","","MDL","","principle","","(Gr","̈unwald,","","2007),","","we","","need","","to","","ensure","","that","","1)\nall","models","in","the","model","class,","i.e.,","all","subgroup","lists","for","a","given","dataset,","can\nbe","","distinguished;","","and","","2)","","larger","","code","","lengths","","are","","assigned","","to","","more","","complex\nmodels.","To","accomplish","the","former","we","encode","all","elements","of","a","model","that","can\nchange,","","while","","for","","the","","latter","","we","","resort","","to","","two","","different","","codes:","","when","","a","","larger\nvalue","","represents","","a","","larger","","complexity","","we","","use","","the","","universal","","code","","for","","integers\n(Rissanen,","","1983),","","denoted\n3\nL\nN\n,","","and","","when","","we","","have","","no","","prior","","knowledge","","but\nneed","to","encode","an","element","from","a","set","we","choose","the","uniform","code.\nSpecifically,","the","encoded","length","of","a","modelMover","variables","inXis","given","by\nL(M)","=L\nN\n(|S|)","+\n∑\na\ni\n∈S\n\n\nL\nN\n(|a\ni\n|)","+","log\n(\nm\n|a\ni\n|\n)\n+\n∑\nv∈a\ni\nL(v)\n\n\n,(11)\n3\nL\nN\n(i)","=","logk\n0\n+","log\n∗\ni,","where","log\n∗\ni=","logi+","log","logi+...andk\n0\n≈2.865064.\n\nRobust","subgroup","discovery23\nwhere","we","first","encode","the","number","of","subgroups|S|using","the","universal","code\nfor","integers,","and","then","encode","each","subgroup","description","individually.","For","each\ndescription,","first","the","number|a\ni\n|of","variables","used","is","encoded,","then","the","set","of\nvariables","using","a","uniform","code","over","the","set","of","all","possible","combinations","of|a\ni\n|\nfrom","","all","explanatory","","variables,","","and","finally","","the","","specific","","condition","","for","a","","given\nvariable.","As","we","allow","variables","of","two","types,","the","latter","is","further","specified","by\nL(v)","=\n{\nlog|X\nv\n|ifvis","nominal\nL\nN|2\n(|n\nop\n|)","+","logN(n\nop\n,n\ncut\n)","ifvis","numeric\n(12)\nwhere","","the","","code","","for","","each","","variable","","type","","assigns","","code","","lengths","","proportional","","to\nthe","number","of","possible","parts","the","variable’s","domain","can","partition","the","dataset.\nNote","that","this","seems","justified,","as","more","parts","imply","more","potential","spurious\nassociations","with","the","target","that","we","would","like","to","avoid.","Fornominalvariables\nthis","","is","","given","","by","","the","","size","","of","","the","","domain,","","i.e.,","","the","","number","","of","","categories","","in","","a\nnominal","","variable.","","Fornumericvariables","","it","","equals","","the","","number","","of","","operators\nusedL\nN|2\n(|n\nop\n|)\n4\nplus","the","possible","number","of","outcomesN(n\nop\n,n\ncut\n)","given","the\noperators","andn\ncut\ncut","points.","The","number","of","operators","for","numeric","variables\ncan","be","one","or","two,","as","there","can","be","conditions","with","one","(e.g.,x≤2)","or","two\noperators","","(e.g.,","","1≤x≤2),","","which","","is","","a","","function","","of","","the","","number","","of","","possible\nsubsets","","generated","","byn\ncut\ncut","","points.","","Note","","that","","we","","here","","assume","","that","","equal\nfrequency","binning","is","used,","which","means","that","knowingXandn\ncut\nis","sufficient\nto","determine","the","cut","points.\nExample","5","(continuation):Let","us","assume","that","the","subgroup","list","of","theAuto-\nmobileexample","","of","","Figure","","2","","is","","composed","","of","","only","","the","","first","","subgroup.","","In","","that\ncase","","the","","list","","only","","has","","one","","subgroup","","with","","description:{weight","","=","","heavy","","&\nconsumption-city≤8","km/L}.","Taking","into","account","that","the","dataset","has","17\nvariables,|X\nweight\n|=","3","and","only","3","cut","points","were","used","for","numeric","attributes,\nthe","expression","of","the","model","length","is","given","by:\nL(M)","=L\nN\n(1)","+L\nN\n(2)","+","log\n(\n17\n2\n)\n+","log|X\nweight\n|+\n[\nL\nN|2\n(1)","+","log","2n\ncut\n]\n=","1.52","+","2.52","+","7.09","+","1.59","+","0.77","+","2.59\n=","16.08","bits\nIt","is","important","to","note","that","the","length","of","the","model","can","(and","should)","be","a\nreal","number,","as","we","are","only","concerned","with","the","idea","of","compression,","not","with\nmaterialising","and","transmitting","the","actually","encoded","data","(Gr","̈unwald,","2007).\n4\nL\nN|2\nis","the","universal","code","for","integers","with","codes","restricted","ton=","1","or","2.","This","can","be\nobtained","by","applying","the","maximum","entropy","principle","toL\nN\nwhen","it","is","known","that","it","cannot\ntake","values","ofn",">2.\n\n24Hugo","M.","Proen","̧ca","et","al.\n4.3","Data","encoding\nThe","remaining","length","function","is","that","of","the","target","data","given","the","explanatory\ndata","and","model,L(Y|X,M).","In","this","section","we","show","how","to","encode","the","target\ndataYby","dividing","it","into","smaller","subsets","that","can","be","encoded","individually\nand","then","summed","together,","and","why","there","are","different","types","of","data","encoding\nfor","each","of","the","subsets.","The","specifics","of","encoding","nominal","and","numeric","targets\nare","described","in","Sections","5","and","6,","respectively.\nCover","","of","","a","","subgroup","","in","","a","","subgroup","","list.First,","we","observe","that","for","any","given\nsubgroup","list","of","the","form","of","Figure","3,any","individual","instance(x\ni\n,y\ni\n)can","only\nbe","","‘covered’","","by","","one","","subgroup.","","That","","is,","","the","","cover","","of","","a","","subgroupa\ni\n,","","denoted\nD\na\n,","depends","on","the","order","of","the","list","and","is","given","by","the","instances","where","its\ndescription","occurs","minus","those","instances","covered","by","previous","subgroups:\nD\ni\n={X\ni\n,Y\ni\n}={(x,y)∈D|a\ni\nvx∧\n\n\n∧\n∀\ni\n′\n<i\na\ni\n′\n6vx\n\n\n}.(13)\nNext,","letn\ni\n=|D\ni\n|be","the","number","of","instances","covered","by","a","subgroup","(also\nknown","asusage).","In","case","an","instance","(x\ni\n,y\ni\n)","is","not","covered","by","any","subgroup\ns∈Sthen","","it","","is","","‘covered’","","by","","the","","default","","rule.","","The","","instances","","covered","","by","","the\ndefault","ruleD\nd\nare","the","ones","not","covered","by","any","subgroup","(hence","the","name\ndefault","rule)","and","formally","defined","as:\nD\nd\n={X\nd\n,Y\nd\n}={(x,y)∈D|∀\na\ni\n∈M\na\ni\n6vx}.(14)\nNow,","given","that","the","subsets","for","each","subgroup","or","default","rule","and","each","target\nvariable","are","well-defined,","one","can—for","each","of","the","rules","and","targets—estimate\nthe","parameters","of","its","probabilistic","distribution","using","the","maximum","likelihood\nestimator.\nNote","that","this","shows","us","that","a","subgroups\ni\n∈Mis","fully","defined","by","its","descrip-\ntiona\ni\nin","a","datasetD,","and","we","will","interchangeably","refer","to","the","subgroup","by\nits","description","and","to","its","elements","(statistics,","parameters,","distributions,","etc.)\nby","its","indexiwhen","obvious","from","context.\nAs","the","subgroup","list","induces","apartition","","of","","the","","data,","the","total","length","of","the\nencoded","data","can","be","given","by","the","sum","of","itsnon-overlapping","parts:\nL(Y|X,M)","=L(Y\nd\n|Θ\nd\n)","+\n∑\ns\ni\n∈S\nL(Y\ni\n),(15)\nwhereΘ\nd\nis","the","vector","of","parameters","for","each","variableΘ\nd\n1\n,...,Θ\nd\nt\n.","Observe\nthat","","we","","droppedX\na\nas","","these","","are","","not","","necessary","","to","","encodeY\na\nbut","","only","","to\ngenerate","the","partition","of","the","data,","and","also","dropped","the","parametersΘ\ni\nof","the\nsubgroups","as","we","do","not","know","what","are","their","parameters","until","we","see","the","data.\nThis","last","part","will","be","clarified","at","the","end","of","this","section,","where","we","describe\nhow","to","encode","subsets","without","knowing","the","parameters.\n\nRobust","subgroup","discovery25\nAs","","a","","side-note,","","note","","that","","Eq.","","(15)","","concerns","","the","","encoding","","of","","any","","supervised\npartition","of","the","data,","which","allows","to","directly","quantify","the","quality","of","any","tree\nlearning","method—each","such","tree","induces","a","partition","of","the","data.\nEncoding","","data","","oft(assumed)","","independent","","target","","variables.As","","each","","target\nvariable","is","assumed","independent","from","each","other","the","encoding","of","target","data\nis","given","by","the","sum","of","their","individual","encodings:\nL(Y|X,M)","=−log\n\n\nt\n∏\nj=1\nPr(Y\nj\n|X,M)\n\n\n=\nt\n∑\nj=1\nL(Y\nj\n|X,M).(16)\nIntegrating","(15)","and","(16),","one","obtains:\nL(Y|X,M)","=\nt\n∑\nj=1\n\n\nL(Y\nd\nj\n|Θ\nd\nj\n)","+\n∑\ns\ni\n∈S\nL(Y\ni\nj\n)\n\n\n(17)\nTwo","types","of","data","encoding:data","encoding","can","be","separated","in","two","different\ncategories:","1)","withknown","parameters;","and","2)","withunknown","parameters.\n1)","Known","parameters:","when","the","parameters","of","a","distribution","areknown,","one\ncan","encode","the","data","points","directly","using","the","probability","for","those","points","given\nby","the","distribution","with","the","known","parameters.","Thus,","the","encoding","of","points\nY\ni\nj\n(j\nth\nvariable","andi\nth\nsubgroup)","is","equal","to","the","negative","logarithm","of","their\nprobability","given","by","known","parameters\nˆ\nΘ\ni\nj\n:\nL(Y\ni\nj\n|\nˆ\nΘ\ni\nj\n)","=\n∑\ny∈Y\ni\nj\n−log","Pr(y|\nˆ\nΘ\ni\nj\n).(18)\nThis","type","of","code","is","used","in","the","case","of","the","default","rule","of","a","subgroup","list,","as\nthe","parameters\nˆ\nΘ\nd\nj\nare","equal","to","the","marginal","distribution","of","variableY\nj\nand\nare","constant","for","each","dataset.","Note","that","this","is","thekey","","difference","","between","","a\nsubgroup","list","and","a","predictive","rule","list:","the","last","rule","of","a","subgroup","list","is","fixed\nto","the","marginal","distribution,","while","in","the","(predictive)","rule","list","its","parameters\nare","unknown","and","depend","on","the","subsetD\nd\n.\n2)","Unknown","parameters:","when","the","parameters","areunkownwe","need","to","encode\nboth","the","parameter","values","and","the","data","points.","We","have","two","possibilities:","1)\ncrude","","MDL,","","i.e.,","","encoding","","the","","probabilities","","using","","a","","suboptimal","","probability\ndistribution","and","then","applying","the","Shannon-Fano","code,","i.e.,","the","logarithm","of\nthe","empirical","probability","(Shannon,","1948);","or","2)","employ","an","optimal","encoding\nof","both","parameters","of","the","distribution","and","data","points","together","(Gr","̈unwald,\n2007).","In","this","work,","we","employ","optimal","encoding","of","parameters,","as","it","guaran-\ntees","optimality","in","the","sense","that","the","encoding","is","the","best","possible","in","the","worst\ncase","scenario,","i.e.,","in","case","the","sample","of","the","data","is","not","representative","of","the\npopulation.","Three","types","of","optimal","encodings","exist,","which","are,","in","increasing\n\n26Hugo","M.","Proen","̧ca","et","al.\norder","","of","","optimality","","guarantees:","","1)prequential","","plug-in;","","2)Bayesian;","","3)Nor-\nmalized","","Maximum","","Likelihood","","(NML).","While","the","first","two","are","asymptotically\noptimal,","the","NML","encoding","is","optimal","for","fixed","sample","sizes.\nDepending","","on","","the","","target","","type,","","we","","employ","","the","","best","","encoding","","possible","","while\nbeing","computationally","feasible,","i.e.,","we","require","adequate","run-time","for","our","al-\ngorithm.","For","nominal","targets","we","present","a","NML","encoding","for","both","the","prob-\nabilities","of","each","class","and","the","data","points","in","Section","5,","which","is","a","theoretical\nimprovement","over","the","prequential","plug-in","code","that","was","recently","proposed","for\nclassification","rule","lists","by","Proen","̧ca","and","van","Leeuwen","(2020).","For","numeric","tar-\ngets","we","resort","to","a","Bayesian","encoding,","as","recently","proposed","by","Proen","̧ca","et","al.\n(2020),","as","the","NML","code","is","not","computationally","feasible","for","that","case.\nDifference","","between","","subgroup","","lists","","and","","(predictive)","","rule","","lists:Although","both\nsubgroup","lists","and","rule","lists","concern","a","model","class","of","the","form","of","Figure","3,","a\ncrucial","difference","lies","in","the","last","rule","in","the","list,","the","so-called","default","rule.","In\ncase","of","a","subgroup","list","the","default","rule","is","fixed","to","the","marginal","distribution\nof","each","target,","making","its","parametersknownandfixedfor","a","certain","dataset\n(Proen","̧ca","","et","","al.,","","2020).","","In","","case","","of","","a","","rule","","list,","","however,","","the","","last","","rule","","is","","‘free’\nin","the","sense","that","it","depends","on","the","estimate","of","its","subsetY\nd\n(Proen","̧ca","and\nvan","Leeuwen,","2020).","This","may","seem","like","a","subtle","difference,","but","it","allows","to\nfind","subgroups","that","always","differentiate","themselves","from","the","dataset","marginal\ndistribution,","while","it","allows","to","find","predictive","rules","that","maximize","predictive\naccuracy.","A","theoretical","proof","of","their","difference","from","an","MDL","perspective","is\ngiven","in","Appendix","E.\n5","Data","encoding:","nominal","target","variables\nWhen","","the","","data","","have","","one","","or","","more","","nominal","","targets,","","the","","distributions","","in","","the\nprobabilistic","rules","(2)","are","categorical","distributionsCat(Θ),","each","with","a","set","of\nparametersΘ={p\n1\n,···,p\nk\n}representing","thekclasses:\nPr(y=c|p\n1\n,···,p\nk\n)","=p\nc\n,subject","to\nk\n∑\nc=1\np\nc\n=","1.(19)\nThis","implies","a","subgroup","of","the","form:\na7→y\n1\n∼Cat(p\n1\n,···,p\nk\n),···,y\nt\n∼Cat(p\n1\n′\n,···,p\nk\n′\n),\nwherekandk\n′\nare","the","number","of","classesY\n1\nandY\nt\n,","respectively.","To","simplify\nthe","introduction","of","concepts","we","will","assume","we","only","have","one","target","variable\ninY,","and","then","generalize","the","results","to","multiple","variables","at","the","end.","Thus,\nthroughout","this","sectionYbecomesY,","and","the","parameters","of","each","subgroups\ni\nbecome\nˆ\nΘ\ni\n={p\n1|i\n,···,p\nk|i\n}as","there","is","only","one","variable","withkclasses,","where\np\n1|i\nis","the","probability","of","class","1","for","subgroupi,","i.e.,","Pr(c=","1|a\ni\n).","The","general\nform","of","a","subgroup","list","with","one","nominal","target","takes","the","form","of","Figure","4.\n\nRobust","subgroup","discovery27\ns\n1\n:IFa\n1\nvxTHENy∼Cat(","ˆp\n1|1\n,···,ˆp\nk|1\n)\n.\n.\n.\ns\nω\n:ELSE","IFa\nω\nvxTHENy∼Cat(","ˆp\n1|ω\n,···,ˆp\nk|ω\n)\ndataset:ELSEy∼Cat(","ˆp\n1|d\n,···,ˆp\nk|d\n)\nFig.","4:","Generic","subgroup","list","modelMwithωsubgroupsS={s\n1\n,...,s\nω\n}and\na","single","nominal","targetYwithkcategories.\nIn","the","following","sections,","we","will","derive","the","data","encoding","for","subgroup","lists\nwith","categorical","distributions.","First,","in","Section","5.1","we","introduce","the","maximum\nlikelihood","estimators","that","will","be","needed","to","derive","the","MDL","encodings.","Then,\nin","Section","5.2,","it","is","shown","how","to","encode","a","categorical","distribution","when","its\nparameters","are","known,","which","is","the","case","for","the","default","rule","of","a","subgroup","list.\nAfter","that,","in","Section","5.3","it","is","shown","how","to","encode","a","categorical","distribution\nwhen","","the","parameters","","of","","the","distribution","","are","unknown.","Then,","","in","Section","","5.4\nthe","equivalence","between","subgroup","lists","with","only","one","subgroup","and","standard\n(top-k)","subgroup","discovery","is","proven","for","our","MDL-based","approach.","Finally,","in\nSection","5.5,","we","show","the","data","encoding","is","equivalent","to","a","Bayesian","test.\n5.1","Maximum","Likelihood","(ML)","estimation","of","the","parameters\nEach","descriptiona\ni\nuniquely","defines","a","subsetD\ni\ngiven","by","its","cover","Eq.","(13).\nHowever","in","","the","","nominal","case","for","","each","","class","","labelc,","","we","","also","need","","to","","find","its\nsubset","of","the","dataD\nc|i\n,","formally","given","by:\nD\nc|i\n={(x,y)∈D\ni\n|y=c}.(20)\nwhich","allows","us","to","compute","the","usage","over","each","classn\nc|i\n=|D\nc|i\n|.","Now,","we\nare","in","a","position","to","use","the","maximum","likelihood","estimator","for","the","parameters\nˆ\nΘ\ni\nof","each","categorical","distribution","as:\nˆp\nc|i\n=\nn\nc|i\nn\ni\n.(21)\nWe","can","show","how","to","encode","each","subset","of","target","values","with","theknownpa-\nrameters","of","the","distribution—the","default","rule","of","a","subgroup","list—andunknown\nparameters—all","the","subgroups.\n5.2","Encoding","categorical","distributions","withknownparameters\nTo","encode","target","values","withknown","parameters—as","is","the","case","for","the","default\nrule","","of","","a","","subgroup","","list—we","","can","","directly","","use","","Eq.","","(18)","","with","","given","","parameter\nestimates\nˆ\nΘ\nd\n=","ˆp\n1|d\n,···,ˆp\nk|d\n(marginal","distribution","over","the","whole","dataset):\nL(Y\nd\n|ˆp\n1|d\n,···,ˆp\nk|d\n)","=\n∑\nc∈Y\n−n\nc|d\nlog","ˆp\nc|d\n=−`(\nˆ\nΘ\nd\n|Y\nd\n),(22)\n\n28Hugo","M.","Proen","̧ca","et","al.\nwhere`(\nˆ\nΘ\nd\n|Y\nd\n)","is","the","log-likelihood","of","the","parameter","set\nˆ\nΘ\nd\n,","andn\nc|d\ndenotes\nthe","number","of","points","associated","with","each","classccovered","by","default","ruleY\nd\n.\n5.3","Encoding","categorical","distributions","withunknownparameters\nWhen","the","parameters","areunknown—as","is","the","case","for","each","individual","subgroup\ndistribution—we","","will","","employ","","the","","Normalized","","Maximum","","Likelihood","","(NML)\ncode,","","as","","it","","“is","","optimal","","in","","the","","sense","","that","","it","","achieves","","the","","minimax","","optimal\ncodelength","regret”","(Gr","̈unwald,","2007).\nAlthough","","the","","expression","","of","","the","","NML","","code","","can","","be","","daunting,","","its","","intuition","","is\nvery","clear","(Kontkanen","et","al.,","2005),","i.e.,","the","NML","code","is","equivalent","to","first\nencoding","all","maximum","likelihood","estimates","of","sequencesZofn\ni\npoints","based\non","their","likelihoods,","and","then","encoding","dataY\ni\nwith","its","maximum","likelihood\nestimate\nˆ\nΘ\ni\nas","in","Eq.","(22).","Formally,","the","NML","code","length","of","the","subsetY\ni\nis","given","by\n5\n:\nL\nNML\n(Y\ni\n)","=−log\n∏\ny∈Y\ni\nPr(y|\nˆ\nΘ\ni\n)\n∑\nZ∈Y\nn\ni\n∏\nz∈Z\nPr(z|\nˆ\nΘ\nZ\n)\n=\n∑\nc∈Y\n−n\nc|i\nlog","ˆp\nc|i\n+","log\n∑\nZ∈Y\nn\ni\n∏\nz∈Z\nPr(z|\nˆ\nΘ\nZ\n)\n=−`(\nˆ\nΘ\ni\n|Y\ni\n)","+C(n\ni\n,k)\n(23)\nwhereY\nn\ni\nis","the","space","of","all","possible","sequences","ofn\ni\npoints","with","cardinality\nk=|Y|(possible","values","per","point),\nˆ\nΘ\nZ\nis","the","maximum","likelihood","estimate\noverZ,C(n\ni\n,k)","is","the","complexity—as","it","is","called","in","MDL","literature(Gr","̈unwald,\n2007)—of","the","multinomial","distribution","overn\ni\npoints","andkcategories.","Note\nthat","","this","","term","","can","","be","","efficiently","","computed","","in","","sub-linear","","timeO(\n√\ndn\ni\n+k)\nif","approximated","by","a","finite","floating-point","precision","ofddigits","(Mononen","and\nMyllym","̈aki,","2008).\nFinally,","inserting","(22)","and","(23)","in","(17)","we","obtain,","for","the","total","data","encoding\nof","asubgroup","list:\nL(Y|X,M)","=\nt\n∑\nj=1\n\n\nL(Y\nd\nj\n|Θ\nd\n)","+\n∑\ns\ni\n∈S\nL\nNML\n(Y\ni\nj\n)\n\n\n.(24)\nExample","","6","","(continuation):Let","","us","","revisit","","theZoosubgroup","","list","","example","","of\nFigure","1","and","compute","the","length","of","NML","encoding","of","the","first","subgroup.","To\ncompute","","it","","we","","just","","need","","to","","get","","the","","probabilities","","associated","","with","","each","","cate-\ngory","({0;","0;","0.56;","0.44;","0;","0;","0}),","the","number","of","samples","covered","by","each","of","them\n5\nFor","details","on","the","derivation","of","Eq.","23,","please","see","Appendix","A.\n\nRobust","subgroup","discovery29\n({0;","0;","10;","8;","0;","0;","0}),","and","the","total","number","of","categoriesk=|Y|=","7.","Given\nthese,","the","length","of","encoding","of","the","dataY\n1\nis","given","by:\nL\nNML\n(Y\n1\n)","=","(−10","log","0.56−8","log","0.44)","+C(18,7)\n=","17.84","+","10.42\n=","28.26","bits.\n5.4","Relationship","of","MDL-optimal","subgroup","lists","to","WKL-based","SD\nWe","now","investigate","the","relationship","between","finding","a","MDL-optimal","subgroup\nlist","and","WKL-based","top-ksubgroup","discovery.","Remember","that","WKL","is","the\nweighted","Kulback-Leibler","(WKL)","divergence,","an","existing","subgroup","discovery\nmeasure","(van","Leeuwen,","2010)","that","can","be","seen","as","an","information-theoretic","in-\nstance","of","the","general","form","of","a","subgroup","discovery","measure","as","given","in","Eq.","(3);\nwe","described","it","in","more","detail","in","Subsection","3.5.\nAssume","that","we","have","a","single","target","variable","(Yinstead","ofY)","and","a","subgroup\nlist","consisting","of","just","one","subgroupswith","descriptiona(and","the","default","rule).\nNext,","let","us","turn","the","MDL","minimization","problem","into","a","maximization","problem\nby","multiplying","Eq.","(10)","by","minus","one","and","adding","a","constant","(for","each","dataset)\nL(Y|Θ\nd\n)","to","obtain:\ns\n∗\n=","arg","max\ns∈M\n[\nL(Y\nd\n|Θ\nd\n)−L(Y|X,M)−L(M)\n]\n.\nIn","","the","","case","","of","","a","","subgroup","","list","","withone","","subgroupand","","one","","target,","","the","","data\nencoding","","of","","Eq.","","(24)","","can","","be","","substituted","","byL(Y|X,M)","","=L(Y\nd\n|Θ\nd\n)","+\nL\nNML\n(Y\na\n).","Also,","note","thatY\nd\nis","actually","given","by","all","the","points","not","covered\nby","","the","","subgroup","","descriptiona,","","i.e.,Y\n¬a\n.","","Thus,","","we","","can","","further","","develop","","the\nmaximization","problem","to:\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(M)","=\n=L(Y\na\n|\nˆ\nΘ\nd\n)","+\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\nL(Y\n¬a\n|\nˆ\nΘ\nd\n)−L\nNML\n(Y\na\n)−\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\nL(Y\n¬a\n|\nˆ\nΘ\nd\n)−L(M)\n=\n∑\ny∈Y\ns\nlog\nˆp\ny|a\nˆp\ny|d\n−C(n\na\n,k)−L(M)\n=n\na\n∑\nc∈Y\nˆp\nc|a\nlog\n(\nˆp\nc|a\nˆp\nc|d\n)\n−C(n\na\n,k)−L(M)\n=n\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)−C(n\na\n,k)−L(M),\n(25)\nwheren\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","is","the","Weighted","Kulback-Leibler","divergence","from\nˆ\nΘ\na\nto\nˆ\nΘ\nd\n.This","","result","","shows","","that","","finding","","the","","MDL-optimal","","subgroup","","is","","equivalent\nto","","finding","","the","","subgroup","","that","","maximizes","","WKL,","","plus","","two","","extra","","terms:","","one","","that\ndefines","the","complexity","of","the","distributionC(n\na\n,k),","and","another","that","defines","the\ncomplexity","of","the","subgroupL(M).\n\n30Hugo","M.","Proen","̧ca","et","al.\nWhen","","we","","consider","","subgroup","","lists","","having","","more","","than","","one","","subgroup,","","Eq.","","(25)\nsimply","expands","to:\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(M)","=\n∑\na\ni\n∈S\nn\ni\nKL(\nˆ\nΘ\ni\n;\nˆ\nΘ\nd\n)−\n∑\na\ni\n∈S\nC(n\ni\n,k)−L(M)\n=","SWKL(S)−\n∑\na\ni\n∈S\nC(n\ni\n,k)−L(M),\nwhere","","SWKL(S)","","is","","the","","measure","","for","","subgroup","","set","","quality","","that","","we","","proposed\nin","Section","3.6,","and","the","other","terms","penalize","the","complexity","of","the","subgroup\nlist.","The","fact","that","the","MDL-based","objective","for","the","optimal","subgroup","list","can\nbe","formulated","as","subgroup","set","quality","minus","two","terms","for","model","complexity\nclearly","demonstrates","that","our","formalization","naturally","aims","for","subgroup","lists\nof","high","quality","while","penalizing","complexity.\n5.5","Relationship","of","MDL-optimal","subgroup","lists","to","Bayesian","testing\nWe","","will","","now","","show","","how","","our","","MDL","","criterion","","is","","related","","to","","Bayesian","","testing.\nThe","","Bayesian","","alternative","","to","","statistical","","testing","","is","","the","","Bayesian","","factor,","","de-\nnoted","","here","","byK(Jeffreys,","","1998;","","Kass","","and","","Raftery,","","1995).","","The","","Bayesian\nfactor","","compares","","two","","models","","(hypotheses)","","through","","the","","division","","of","","the","","likeli-\nhood","of","the","data","given","each","model","Pr(D|M\n1\n)/Pr(D|M\n2\n),","where","the","more\nlikely","model","dominates.","Notice","that","the","form","that","we","arrived","at","in","the","term\nn\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)−C(n\na\n,k)−L(M)","of","Eq.","(25)","(for","a","list","consisting","of","one","sub-\ngroup)","is","very","similar","to","the","logarithm","of","a","Bayes","factor,","and","indeed","it","can","be\ndecomposed","into:\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(M)","=","log\n(\nPr(Y|X,M)\nPr(Y|\nˆ\nΘ\nd\n)\n)\nL(M)\n=","logK+L(M),\nwhere","","we","","use","","the","","Shannon-Fano","","code","","(Shannon,","","1948)","","to","","transform","","code\nlength","in","bitsL(···)","to","probabilities","Pr(···).","In","practice,","taking","into","account\nL(M)","","(or","","Pr(M))","","is","","equivalent","","to","","using","","the","","posterior","","distributions","","instead\nof","","just","","the","","Bayes","","factor,","","and","","in","","our","","case","","amounts","","to","","a","","penalty","","for","","multiple\nhypothesis","testing.","This","tells","us","that","when","finding","the","first","subgroup","we","are\nindeed","maximizing","an","MDL","version","of","a","Bayesian","factor,","and","thus,","doing","an\nequivalent","Bayesian","proportions","test","(with","a","binary","target)","or","a","multinomial\ntest","(with","a","nominal","target).","When","we","consider","the","problem","of","finding","a","sub-\ngroup","beyond","the","first,","it","is","straightforward","to","observe","that","we","are","testing","each\nsubgroup","inSagainst","the","marginal","distribution","of","the","dataset.\n\nRobust","subgroup","discovery31\n6","Data","encoding:","numeric","target","variables\nWhen","we","have","one","or","more","numeric","target","variables,","the","consequents","of","proba-\nbilistic","rules","as","in","Eq.","(2)","are","now","normal","distributionsN(Θ)","with","parameters\nΘ={μ,σ},","and","take","the","following","form:\nPr(y|μ,σ)","=\n1\n√\n2πσ\n2\nexp\n(\n−\n(y−μ)\n2\n2σ\n2\n)\n,\nwhere","","we","","use","","Pr(y|μ,σ)","","to","","denote","","the","","probability","","density","","function","","(pdf),\nwhich","is","a","slight","abuse","of","notation","that","we","admit","to","unify","the","whole","work.\nThis","translates","to","a","probabilistic","rule","of","the","form:\na7→y\n1\n∼N(ˆμ\na1\n,ˆσ\na1\n),···,y\nt\n∼N(ˆμ\nat\n,ˆσ\nat\n)(26)\nTo","simplify","the","introduction","of","concepts","we","will","again","assume","we","have","only\none","target","variable","inY,","and","generalize","the","results","to","multiple","variables","at","the\nend.","Thus,","throughout","this","sectionYbecomesY,","and","the","parameters","of","each\nsubgroups\ni\nbecomeΘ\ni\n={μ\ni\n,σ\ni\n}as","there","is","only","one","variable.","The","general\nform","of","a","subgroup","list","with","normal","target","distribution","is","given","in","Figure","5.\ns\n1\n:IFa\n1\nvxTHENy∼N(ˆμ\n1\n,ˆσ\n1\n)\n.\n.\n.\ns\nω\n:ELSE","IFa\nω\nvxTHENy∼N(ˆμ\nω\n,ˆσ\nω\n)\ndataset:ELSEy∼N(ˆμ\nd\n,ˆσ\nd\n)\nFig.","5:","Generic","subgroup","list","modelMwithωsubgroupsS={s\n1\n,...,s\nω\n}and\na","single","numeric","targetY.\nIn","","the","","following","","subsections,","","we","","will","","derive","","the","","data","","encoding","","for","","subgroup\nlist","","with","","normal","","distributions.","","First,","","in","","Section","","6.1","","we","","introduce","","the","","maxi-\nmum","likelihood","estimators","that","will","be","needed","to","derive","the","MDL","encodings.\nThen,","in","Section","6.2","we","show","how","to","encode","a","normal","distribution","when","its\nparametersμandσare","known,","such","as","is","the","case","for","the","default","rule","of","a\nsubgroup","list.","After","that,","in","Section","6.3","we","show","how","to","encode","a","normal","dis-\ntribution","using","an","uninformative","prior","when","the","parameters","of","the","distribution\nare","unknown.","Then,","in","Section","6.4","the","equivalence","between","subgroup","lists","with\nonly","one","subgroup","and","standard","(top-k)","subgroup","discovery","is","proven","for","our\nMDL-based","approach.","Finally,","in","Section","6.5,","we","show","the","data","encoding","and\ncorresponding","criterion","are","equivalent","to","a","Bayesian","test.\n6.1","Maximum","Likelihood","(ML)","estimation","of","the","parameters\nEach","descriptiona\ni\nuniquely","defines","a","subsetD\ni\ngiven","by","its","cover","(13),","which\nallows","to","estimate","the","parameters","of","each","normal","distribution","using","the","max-\nimum","likelihood","estimate","overY\ni\n:\n\n32Hugo","M.","Proen","̧ca","et","al.\nˆμ\ni\n=\n1\nn\ni\n∑\ny∈Y\ni\ny,(27)\nˆσ\n2\ni\n=\n1\nn\ni\n∑\ny∈Y\ni\n(y−ˆμ\ni\n)\n2\n,(28)\nwhere","","ˆσ\n2\ni\nis","the","biased","estimator","such","that","the","estimate","timesn\ni\nequals","the\nResidual","","Sum","","of","","Squares,","","i.e.,n\ni\nˆσ\n2\ni\n=\n∑\ny∈Y\na\n(y−ˆμ\ni\n)\n2\n=RSS\ni\n.","","Note","","that\nthe","parameters","of","the","default","rule","of","Figure","5","are","fixed","for","a","dataset","and","thus\ncorrespond","to","estimates","ˆμ\nd\nand","ˆσ\nd\nover","all","target","valuesY.\nAs","","each","","subgroup","","list","","defines","","a","","partition","","of","","the","","data,","","we","","can","","encode","","each\ntarget","","value","","part,Y\ni\norY\nd\n,","","separately","","and","","sum","","them","","to","","obtain","","the","","total\nencoding","ofY.","In","the","case","of","subgroup","lists,","the","last","rule–i.e.,","default","rule—has\nfixed","parameters","equal","to","the","overall","dataset","distribution,","while","the","subgroups\nparameters","are","not","known","in","advance,","and","have","thus","to","be","encoded","together\nwith","the","data","points.\nWe","start","by","showing","how","to","encode","the","subset","of","target","values","with","the","default\n‘rule’—known","parameters","of","the","distribution—and","then","show","how","to","encode\neach","subgroup","subset—unkown","parameters","of","the","distribution.\n6.2","Encoding","normal","distributions","withknownparameters\nThe","","target","","values","","not","","covered","","by","","any","","subgroupY\nd\n,","","as","","defined","","in","","(14),","","are\ncovered","by","the","default","dataset","‘rule’","and","distribution","at","the","end","of","a","subgroup\nlist.","As","the","statistics\nˆ\nΘ\nd\n={ˆμ\nd\n,ˆσ\nd\n}are","known","and","constant","for","a","given","dataset,\none","can","simply","encode","the","instances","using","this","(normal)","distribution,","resulting\nin","encoded","length\nL(Y\nd\n|ˆμ\nd\n,ˆσ\nd\n)","=−log\n\n\n∏\ny∈Y\nd\n1\n√\n2πˆσ\n2\nd\nexp\n(\n(y−ˆμ\nd\n)\n2\n2ˆσ\n2\nd\n)\n\n\n=\nn\nd\n2\nlog","2π+\nn\nd\n2\nlog","ˆσ\n2\nd\n+\n\n\n1\n2ˆσ\n2\nd\n∑\ny∈Y\nd\n(y−ˆμ\nd\n)\n2\n\n\nloge.\n(29)\nThe","first","two","terms","are","normalizing","terms","of","a","normal","distribution,","while","the\nlast","","term","","represents","","the","","Residual","","Sum","","of","","Squares","","(RSS)","","normalized","","by","","the\nvariance","of","the","data.","Note","that","whenY\nd\n=Y,","i.e.,","the","whole","dataset","target,\nRSS","is","equal","ton\nd\nσ\nd\nand","the","last","term","reduces","ton\nd\n/2","loge.\n6.3","Encoding","normal","distributions","withunknownparameters\nIn","contrast","to","the","previous","case,","herewe","","do","","not","","know","","a","","priori","","the","","statistics\ndefining","the","probability","distribution","corresponding","to","the","subgroup,","i.e.,","","ˆμand\n\nRobust","subgroup","discovery33\nˆσare","","not","","given","","by","","the","","model","","and","","thus","","both","","need","","to","","be","","encoded.","","For","","this\nwe","resort","to","the","Bayesian","encoding","of","a","normal","distribution","with","meanμand\nstandard","deviationσunknown,","which","was","shown","to","be","asymptotically","optimal\n(Gr","̈unwald,","2007).","The","optimal","code","length","is","given","by","the","negative","logarithm\nof","a","probability,","and","the","optimal","Bayesian","probability","forY\na\nis","given","by\nL\nBayes\n(Y\ni\n)","=\n−log\n∫\n+∞\n−∞\n∫\n+∞\n0\n(2πσ)\n−\nn\ni\n2\nexp\n\n\n−\n1\n2σ\n2\n∑\ny∈Y\ni\n(y−μ)\n2\n\n\nw(μ,σ)","dμdσ,\n(30)\nwherew(μ,σ)","is","the","prior","on","the","parameters,","which","needs","to","be","chosen.\nChoosing","","the","","prior.The","MDL","principle","requires","the","encoding","to","be","as","unbi-\nased","as","possible","for","any","values","of","the","parameters,","which","leads","to","the","use","of\nuninformative","priors.","The","most","uninformative","prior","is","Jeffrey’s","prior,","which","is\n1/σ\n2\nand","therefore","constant","for","any","value","ofμandσ,","but","unfortunately","its\nintegral","is","undefined,","i.e.,\n∫","∫\nσ\n−2\ndσdμ=∞.","Thus,","we","need","to","1)","constrain\nthe","parameter","space","and","2)","make","the","integral","finite,","which","we","will","do","next","in\nconsecutive","steps.\nOne","","of","","the","","best","","ways","","to","","constrain","","the","","parameter","","space","","without","","biasing","","it,\nis","","by","","multiplying","","Jeffrey’s","","prior","","by","","a","","normal","","prior","","on","","the","","effect","","size,","","i.e.,\nρ=μ/σ∼","N(0,τ)","","(Rouder","","et","","al.,","","2009).","","We","","then","","still","","need","","to","","describeτ\nthough;","the","most","uninformative","choice","would","be","to","use","an","inverse-chi-squared\ndistribution,","which","would","be","equivalent","to","using","a","Cauchy","prior","on","the","effect\nsize","(Rouder","et","al.,","2009).","Unfortunately,","this","would","lead","to","an","open","integral,\nwhich","would","render","the","approach","infeasible","for","cases—like","ours—where","many\ncandidates","need","to","be","tested.","The","second","best","option","is","to","fixτ=","1,","which\ngives","a","tractable","formula","that","is","equivalent","to","introducing","a","virtual","point","and\nconverges\n6\nto","the","Bayes","Information","Criterion","(BIC)","for","largen.","This","is","the\nbest","we","can","do","and","we","proceed","with","this","option.\nNow,","given","the","prior","defined","byρ=μ/σ∼","N(0,1),","the","remaining","question\nis","","how","","we","","can","","make","","the","","integral","","over","","the","","prior","","finite.","","The","","most","","common\nsolution,","","which","","we","","also","","employ,","","is","","to","","usekdata","","points","","fromY\ni\n,","","denoted\nY\ni|k\n,","","to","","create","","a","","proper","","conditional","","priorw(μ,σ|Y\ni|k\n).","","As","","there","","are","","only\ntwo","unknown","parameters,","we","only","need","two","points","hencek=","2","(Gr","̈unwald,\n2007);","for","more","on","the","interpretation","of","such","“priors","conditional","on","initial","data\npoints”,","","see","","Gr","̈unwald","","and","","Roos","","(2019).","","Consequently,","","we","","first","","encodeY\ni|2\nwith","a","non-optimal","code","that","is","readily","available—i.e.,","the","dataset","distribution\nof","Eq.","(29)—and","then","use","the","Bayesian","rule","to","derive","the","total","encoded","length\nofY\ni\nas\nL\nBayes2.0\n(Y\ni\n)","=−log\nP\nBayes\n(Y\ni\n)\nP\nBayes\n(Y\ni|2\n)\nP(Y\ni|2\n|μ\nd\n,σ\nd\n)\n=L\nBayes\n(Y\ni\n)","+L\ncost\n(Y\ni|2\n),\n(31)\n6\nSee","proof","in","Appendix","C.\n\n34Hugo","M.","Proen","̧ca","et","al.\nwhereL\ncost\n(Y\ni|2\n)","=L(Y\ni|2\n|μ\nd\n,σ\nd\n)−L\nBayes\n(Y\ni|2\n)","is","the","extra","cost","incurred\nby","encoding","two","points","non-optimally.","After","some","re-writing\n7\nwe","obtain","the\nencoded","length","of","theyvalues","covered","by","a","subgroupY\ni\nas\nL\nBayes2.0\n(Y\ni\n)","=L\nBayes\n(Y\ni\n)","+L\ncost\n(Y\ni|2\n)\n=","1","+\nn\ni\n2\nlogπ−logΓ\n(\nn\ni\n2\n)\n+\n1\n2\nlog(n\ni\n+","1)","+\nn\ni\n2\nlogn\ni\nˆσ\n2\ni\n+L\ncost\n(Y\ni|2\n),\n(32)\nwhereΓis","the","Gamma","function","that","extends","the","factorial","to","the","real","numbers\n(Γ(n)","=","(n−1)!","for","integern)","and","","ˆμ\ni\nand","","ˆσ\ni\nare","the","statistics","of","Eqs.","(27)\nand","(28),","respectively.","Note","that","forY\ni|2\nany","two","unequal","values","(otherwise\nˆσ\n2\n=","0","andL\nBayes\n(Y\ni|2\n)","=∞)","can","be","chosen","fromY\na\n,","thus","we","choose","them\nsuch","that","they","minimizeL\ncost\n(Y\ni|2\n).","Finally,","inserting","(29)","and","(32)","in","(17)\nwe","obtain","for","the","total","data","encoding","for","asubgroup","list:\nL(Y|X,M)","=\nt\n∑\nj=1\n\n\nL(Y\nd\nj\n|Θ\nd\n)","+\n∑\ns\ni\n∈S\nL\nBayes2.0\n(Y\ni\nj\n)\n\n\n.\nExample","7","(continuation):We","revisit","theAutomobilesubgroup","list","of","Figure","2\nand","find","the","length","of","theBayes2.0","encoding","(Eq.","(32))","of","the","first","subgroup.\nTo","","compute","","it","","we","","need","","to","","get","","the","","statistics","","of","","the","","subgroup","","(\nˆ\nΘ\n1\n={ˆμ\n1\n=\n35;","ˆσ\n1\n=","8}),","the","number","of","samples","it","covers","(n\n1\n=","11),","the","dataset","statistics\n(\nˆ\nΘ\nd\n={ˆμ\nd\n=","13;","ˆσ\nd\n=","8}),","","and","the","","two","","points","","closest","","to","the","","dataset","mean\nY\n1|2\n={14;","31}that","makes","the","encoding","proper","(and","which","are","not","available","in\nthe","example","information).","Assuming","thatL\ncost\n(Y\ni|2\n)","=","0.69bits","for","simplicity,\nthe","length","of","the","encoding","ofY\n1\nis","given","by:\nL\nBayes2.0\n(Y\n1\n)","=1","+\n11\n2\nlogπ−logΓ\n(\n11\n2\n)\n+\n1\n2\nlog(11","+","1)","+\n11\n2\nlog","11·8\n2\n+L\ncost\n(Y\ni|2\n)\n=58.19","+","0.69\n=58.88","bits.\n6.4","Relationship","of","MDL-optimal","subgroup","lists","to","WKL-based","SD\nAs","in","Section","5","we","next","investigate","the","relationship","between","finding","a","MDL-\noptimal","subgroup","list","and","WKL-based","top-ksubgroup","discovery,","but","now","for\nthe","numeric","case.\n7\nThe","full","derivation","of","the","Bayesian","encoding","and","an","in-depth","explanation","are","given","in\nAppendix","B.\n\nRobust","subgroup","discovery35\nFirst,","we","show","that","Eq.","(32)—with","mean","and","variance","unknown—","converges,\nfor","largen,","to","Eq.","(29)—with","mean","and","variance","known—plus","an","additional\nterm.","Using","the","Stirling","approximation","ofΓ(n+","1)∼\n√\n2πn\n(\nn\ne\n)\nn\nleads","to\n8\nL\nBayes2.0\n(Y\na\n)∼\nn\na\n2\nlog","2π+\nn\na\n2\nlog","ˆσ\n2\na\n+\nn\na\n2\nloge+","log\nn\na\ne\n,(33)\nwhere","log\nn\ne\nis","equal","to","the","penalty","term","of","BIC","and","similar","to","the","usual","MDL\ncomplexity","of","a","distribution","(Gr","̈unwald,","2007).\nNow,","we","can","show","that","minimizing","our","MDL","criterion","is","equivalent","to","maxi-\nmizing","a","subgroup","discovery","quality","function","of","the","form","of","Eq","(3).","Focusing\non","","the","","case","","whereM={s}contains","","only","","one","","subgroup","","with","","descriptiona\nand","statistics\nˆ\nΘ\na\n={ˆμ\na\n,ˆσ\na\n},","we","start","withL(Y|X,M)","(Eq.","(10)),","multi-\nply","it","by","minus","one","to","make","it","a","maximization","problem,","and","add","a","constant\nL(Y|ˆμ\nd\n,ˆσ\nd\n),","i.e.,","the","encoded","size","of","the","whole","targetYusing","the","overall\ndistribution","dataset.","We","then","get\ns\n∗\n=","arg","max\ns∈M\n[\nL(Y\nd\n|Θ\nd\n)−L(Y|X,M)−L(M)\n]\n.\nDeveloping","","this","","further,","","the","","subgroupsthat","","maximizes","","this","","expression","","is\nequivalent","to","the","one","that","maximizes\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)\n=L(Y\na\n|\nˆ\nΘ\nd\n)−L\nBayes2.0\n(Y\na\n|X\na\n)−L(M)\n∼\nn\na\n2\nlog\nˆσ\n2\nd\nˆσ\n2\na\n+\n\n\n1\n2ˆσ\n2\nd\n∑\ny\ni\n∈Y\na\n(y\ni\n−ˆμ\nd\n)\n2\n\n\nloge−\nn\na\n2\nloge−logn\na\n−L(M)\n=\nn\na\n2\nlog\nˆσ\n2\nd\nˆσ\n2\na\n+\n[\n∑\ny\ni\n∈Y\na\n(y\ni\n)\n2\n−nˆμ\n2\na\n+nˆμ\n2\na\n−2nˆμ\na\nˆμ\nd\n−ˆμ\nd\n)\n2\n2ˆσ\n2\nd\n]\nloge\n−\nn\na\n2\nloge−logn\na\n−L(M)\n=n\na\n[\nlog\nˆσ\nd\nˆσ\na\n+\nˆσ\n2\na\n+","(μ\na\n−μ\nd\n)\n2\n2ˆσ\n2\nd\nloge−\nloge\n2\n]\n−log(n\na\n)−L(M)\n=n\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)−logn\na\n−L(M),\n(34)\nwheren\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)","","is","","the","","usage-weighted","","Kullback-Leibler","","divergence","","be-\ntween","the","normal","distributions","specified","by","the","respective","parameter","vectors.\nSimilar","","to","","the","","result","","for","","the","","nominal","","target","","in","","Section","","5.4,","","this","","shows","","that\nfinding","","the","","MDL-optimal","","subgroup","","is","","equivalent","","to","","finding","","the","","subgroup","","that\nmaximizes","","the","","weighted","","Kullback-Leibler","","(WKL)","","divergence,","an","existing","sub-\ngroup","","discovery","","quality","","measure","","(van","","Leeuwen,","","2010),plus","","two","","terms.","","The\n8\nThe","complete","derivation","can","be","found","in","the","Appendix","C\n\n36Hugo","M.","Proen","̧ca","et","al.\nfirst","defines","the","complexity","of","the","subgroup","distribution","with","two","parameters,\nthe","","second","","compensates","","for","","multiple","","hypothesis","","testing","","(i.e.,","","the","","number","","of\npossible","subgroups).","When","we","have","a","list","with","multiple","subgroups,","Eq.","(25)\nexpands","to\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(M)∼\n∑\na\ni\n∈S\nn\ni\nKL(\nˆ\nΘ\ni\n;\nˆ\nΘ\nd\n)−\n∑\na\ni\n∈S\nlog(n\ni\n)−L(M)\n=","SWKL(S)−\n∑\na\ni\n∈S\nlog(n\ni\n)−L(M),\nwhere","SWKL(S)","is","the","measure","of","subgroup","set","qualities","that","we","proposed","in\nSection","3.6,","and","the","other","terms","penalize","the","complexity","of","the","subgroup","list.\nDispersion-correction","quality","measure.Importantly,","we","can","observe","from","Eq.","(25)\nthat","the","measure","based","on","the","Kullback-Leibler","divergence","of","normal","distribu-\ntions","is","part","of","the","family","ofdispersion-correctedsubgroup","quality","measures,\nas","it","takes","into","account","both","the","centrality","and","the","spread","of","the","target","values\n(Boley","et","al.,","2017).\n6.5","Relationship","of","MDL-optimal","subgroup","lists","to","Bayesian","testing\nWhen","","we","","have","","only","","one","","subgroupsin","","a","","subgroup","","list,","","the","","data","","encoding\nfor","numeric","targets","of","Eq.","(6.3)","is","equivalent","to","the","negative","logarithm","of","a\nBayes","factor","(G","̈onen","et","al.,","2005;","Rouder","et","al.,","2009).","Indeed,","the","choice","of\nthe","prior","was","based","on","the","Bayesian","one-sample","t-test","by","G","̈onen","et","al.","(2005),\nand","","we","","effectively","","perform","","a","","one-sample","","t-test","","(including","","two","","extra","","terms)\nfor","","each","","subgroup.","","Formally—and","","similar","","to","","the","","nominal","","case","","as","","described\nin","","Section","","5.5—a","","Bayes","","factorK(Jeffreys,","","1998;","","Kass","","and","","Raftery,","","1995)\nis","given","by","the","division","of","the","likelihoods","of","the","data","given","each","hypothesis:\nPr(D|M\n1\n)/Pr(D|M\n2\n).","If","we","use","the","maximization","equivalent","of","Eq.","(34),\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(M)","=","log\n(\nPr(Y|X,M)\nPr(Y|\nˆ\nΘ\nd\n)\n)\nL(M)\n=","logK+L(M),\nwe","can","see","that","we","have","the","Bayes","factor","plus","the","model","encoding.","To","transform\ncode","lengths","in","bitsL(···)","to","probabilities","Pr(···)","we","used","the","Shannon-Fano\ncode","","(Shannon,","","1948),","","which","","states","","that","","the","","best","","encoding","","is","","given","","by","","the\nnegative","logarithm","of","its","probability","for","an","eventA,","i.e.,L(A)","=−log","Pr(A).\nOur","MDL-based","criterion","aims","at","maximizing","a","one-sample","t-test","for","numeric\ntargets","","between","","the","","subgroup","","distribution","","and","","the","","marginal","","distribution","","of\nthe","dataset,","while","taking","into","accountL(M),","which","is","equivalent","to","using","the\nposterior","distribution","and","penalizes","for","multiple","hypothesis","testing.","When","we\naim","to","find","subgroups","beyond","the","first,","it","is","trivial","to","see","that","we","are","testing\neach","subgroup","inSagainst","the","marginal","distribution","of","the","dataset.\n\nRobust","subgroup","discovery37\n7","The","RSD","Algorithm\nIn","this","section","we","propose","theRobust","Subgroup","Discoverer(RSD),","a","heuristic\nalgorithm","to","find","good","subgroup","lists","based","on","the","proposed","MDL","formulation.\nAs","","the","","problem","","of","","finding","","a","","optimal","","subgroup","","list","","is","","NP-hard","","(Mielik","̈ainen\nand","Mannila,","2003)","we","propose","a","heuristic","based","on","the","Separate-and-Conquer\n(SaC)","(F","̈urnkranz,","1999)","strategy","of","iteratively","adding","the","local","best","subgroup\nto","the","list,","combined","with","beam","search","for","candidate","subgroup","generation.\nThe","use","of","greedy","heuristic","approaches","is","common","practice","in","MDL-based","pat-\ntern","mining","(Vreeken","et","al.,","2011;","Proen","̧ca","and","van","Leeuwen,","2020)","and","rule-\nbased","learning","(F","̈urnkranz","et","al.,","2012),","and","beam-search","is","widely","adopted\nfor","its","efficient","generation","of","subgroups","in","subgroup","discovery(Lavraˇc","et","al.,\n2004;","Meeng","and","Knobbe,","2011;","Van","Leeuwen","and","Knobbe,","2012).\nThis","","section","","is","","divided","","as","","follows.","","First,","","in","","Section","","7.1","","we","","give","","a","","high-level\ndescription","of","our","proposed","algorithm","and","motivate","our","choices.","After","that,","in\nSection","","7.2","","the","","quality","","measure","","used","","to","","iteratively","","add","","rules—compression\ngain—is","","presented,","","together","","with","","its","","relationship","","with","","subgroup","","discovery\nquality","","measures.","","Then,","","in","","Section","","7.3","","the","","statistical","","testing","","interpretation\nof","the","compression","gain","is","given.","After","that,","in","Section","7.4","the","beam","search\nfor","candidate","subgroup","generation","is","presented","in","detail.","Then,","in","Section","7.5\nthe","Separate-and-Conquer","RSD","algorithm","is","presented.","Finally,","in","Section","7.6\nthe","time","and","space","complexity","of","the","overall","algorithm","is","given.\n7.1","Algorithm","high-level","description\nThe","algorithm","we","propose","is","a","heuristic","composed","of","two","parts:","we","greedily\nadd","","one","","subgroup","","at","","a","","time","","to","","the","","subgroup","","list,","","for","","which","","candidates","","are\ngenerated","using","beam","search.","More","specifically,","the","greedy","search","algorithm\nstarts","from","an","empty","list,","with","just","a","default","rule","equal","to","the","priors","in","the\ndata,","and","adds","subgroups","according","to","the","well-knownseparate-and-conquer\nstrategy","(F","̈urnkranz","et","al.,","2012):","1)","iteratively","find","and","add","the","subgroup","that\ngives","the","largest","improvement","in","compression;","2)","remove","the","data","covered","by\nthat","rule;","and","3)","repeat","steps","1-2","until","compression","cannot","be","improved.","This\nimplies","thatwe","always","add","subgroups","at","the","end","of","the","list,","but","before","the","de-\nfault","","rule.","Beam","search","is","used","for","candidate","generation","at","each","iteration","to\nfind","the","best","candidate","to","add.","Given","a","beam","widthw\nb\nand","maximum","search\ndepthd\nmax\nit","consists","of:","1)","find","all","items,","i.e.,","all","conditioned","variables","such","as\nx\n1\n<5","orx\n2\n=category,","and","add","the","bestw\nb\nitems","according","to","compression\ngain","(Eq.","(7.2))","as","subgroups","of","size","1","to","the","beam;","2)","refine","all","subgroups","in\nthe","beam","with","all","items","and","add","the","bestw\nb\nto","a","new","empty","beam;","3)","repeat\n2","and","3","until","the","maximum","depthd\nmax\nof","the","beam","is","reached","and","return","the\nbest","subgroup—according","to","the","compression","score—found","in","all","iterations.\nThe","beam","search","algorithm","is","described","in","detail","in","Section","7.4","and","the","greedy\n\n38Hugo","M.","Proen","̧ca","et","al.\nsearch","algorithm","RSD","in","Section","7.5.\nThe","main","reasons","for","using","greedy","search","and","adding","one","subgroup","at","a","time\nare","its","computational","simplicity","and","transparency,","as","it","adds","at","each","iteration\nthe","locally","best","and","most","statistically","significant","subgroup","found","by","the","beam\nsearch.","Further,","in","the","context","of","subgroup","discovery","beam","search","was","empir-\nically","shown","to","be","very","competitive","in","terms","of","quality","when","compared","to","a\ncomplete","search,","while","it","demonstrates","a","considerable","speed-up","(Meeng","and\nKnobbe,","2020).","Also,","its","straightforward","implementation","allows","flexibility","to\neasily","extend","this","framework","to","other","types","of","targets","in","the","future.\n7.2","Compression","gain\nTo","","quantify","","the","","quality","","of","","annexing","","a","","subgroupsat","","the","","end","","(after","","all","","the\nother","subgroups","and","before","the","default","rule)","of","modelM,","denotedM⊕s,","we\nemploy","thecompression","gain:\ns=","arg","max\ns∈∫\n∆\nβ\nL(D,M⊕s)","=","arg","max\ns∈∫\n[\nL(D,M)−L(D,M⊕s)\n(n\ns\n)\nβ\n]\n,","β∈[0,1]\n(35)\nwhereβweighs","","the","","level","","of","","the","","normalization,","","and∆\nβ\nL(D,M⊕s)","","should\nbe","greater","than","zero","for","a","decrease","in","the","encoded","length","fromL(D,M)","to\nL(D,M⊕s).","Considering","the","extremes,","withβ=","1","we","have","thenormalized\ngainfirst","introduced","for","the","classification","setting","by","Proen","̧ca","and","van","Leeuwen\n(2020),","and","forβ=","0","we","have","theabsolute","gainwhich","is","just","the","regular","gain\nused","in","greedy","search","in","previous","MDL-based","pattern","mining","(Vreeken","et","al.,\n2011).\nDeveloping","Eq.","(35)","further","shows","that","the","compression","gain","only","depends","on\nthe","added","subgroups,","as","in","the","specific","case","of","a","subgroup","list","the","default","rule\nis","fixed","and","it","is","the","same","forMandM⊕s:\n∆\nβ\nL(D,M⊕s)","=\nL(Y|X,M)−L(Y|X,M⊕s)\n(n\ns\n)\nβ\n+\nL(M)−L(M⊕s)\n(n\ns\n)\nβ\n=∆\nβ\nL(Y|X,M⊕s)","+∆\nβ\nL(M⊕s),\nwhere∆\nβ\nL(Y|X,M⊕s)","and∆\nβ\nL(M⊕s)","are","the","data","and","model","compression\ngain,","respectively.\nFurthermore,","if","we","note","that","maximizing","the","gain","in","Eq.","(35)","is","equivalent","to\nmaximizing","the","subgroup","discovery","equivalent","objective","of","Eq.","(25)","for","nominal\ntargets","and","Eq.","(34)","for","numeric","targets,","this","means","that","finding","the","subgroup\nthat","maximizes","the","compression","gain","is","the","same","as","finding","the","subgroup","that\n\nRobust","subgroup","discovery39\nmaximizes","the","subgroup","discovery","equivalent","objective:\ns=","arg","max\ns∈∫\n∆\nβ\nL(M⊕s)\n=","arg","max\ns∈∫\nn\ns\nKL(\nˆ\nΘ\ns\n;\nˆ\nΘ\nd\n)\n(n\ns\n)\nβ\n−\nCOMP(n\ns\n,#param)\n(n\ns\n)\nβ\n+∆\nβ\nL(M⊕s)\nwheren\ns\nKL(\nˆ\nΘ\ns\n;\nˆ\nΘ\nd\n)","has","the","general","form","of","a","subgroup","discovery","measure\nof","Eq.","(3),COMP(n\ns\n,#param)","is","the","complexity","associated","with","each","target\nprobability","distribution","(normal","or","categorical),","and∆\nβ\nL(M⊕s)","the","added\nmodel","complexity","of","addings.\nInterpretation","of","hyperparameterβ.The","hyperparameterβrepresents","a","trade-\noff","between","finding","many","subgroups","that","cover","few","instances","or","few","subgroups\nthat","cover","many","instances\n9\n.","In","the","general","form","of","a","subgroup","quality","measure\nof","Eq.","(3),βis","just","given","byβ=","1−α.","We","empirically","show","later","that","the\nnormalized","","gain(β=","1)","usually","achieves","a","better","MDL","score","than","otherβ\nvalues;","this","was","already","known","for","other","measures","from","rule","learning","theory\n(F","̈urnkranz","","et","","al.,","","2012).","","Nonetheless,","","the","","main","","objective","","of","","subgroup","","dis-\ncovery","is","tolocallydescribe","regions","in","the","data","that","strongly","deviate","from","a\ncertain","target.","Thus,","it","is","up","to","the","user","to","specify","what","one","is","looking","for","in\nthe","data:","either","a","more","granular","and","detailed","perspective","(βclose","to","one)","or","a\nmore","general","and","high-level","one","(βclose","to","zero).","Note","that,","for","comparison","to\nother","algorithmswe","will","always","use","the","normalized","gain(β=","1)","except","when\nexplicitly","stated.\n7.3","Statistical","testing","interpretation","of","compression","gain\nThe","","gain","","of","","Eq.","","(7.2)","","shares","","the","","same","","expression","","of","","the","","weighted","","Kullback\nLeibler","divergence","that","was","shown","in","Sections","5.4","and","6.4","to","be","equivalent","to\na","Bayesian","one-sample","proportions/multinominal","test","and","t-test,","respectively.\nThus,","it","too","guarantees","individual","“significance”","for","each","subgroup","according\nto","these","tests.","We","will","now","look","at","this","in","more","detail.\nA","Bayesian","factor","is","an","alternative","to","frequentist","statistical","testing","and","is","given\nby","the","likelihood","of","both","hypotheses","generating","the","data","(Kass","and","Raftery,\n1995):\nlogK=","log\nPr(D|M\n1\n)\nPr(D|M\n2\n)\n,\nwhereM\n1\nandM\n2\nare","two","models","that","we","are","comparing.","Values","of","logKabove\nzero","tell","us","that","there","is","more","evidence","in","favour","of","modelM\n1\n,","while","negative\nvalues","tell","us","the","opposite","(Kass","and","Raftery,","1995).","If","we","look","back","at","the\nexpression","of","the","greedy","gain","in","Eq.","(35),","and","convert","the","encodingL(···)","to\n9\nFor","details","on","the","empirical","analysis","of","differentβvalues","please","refer","to","Appendix","H\n\n40Hugo","M.","Proen","̧ca","et","al.\nprobabilities","Pr(···)","using","the","Shannon-Fano","code:L(A)","=−log","Pr(A)","(Shan-\nnon,","1948);","we","can","see","that","it","takes","exactly","the","same","form","plus","some","extra\nterms:\n∆\nβ\nL(M⊕s)","=","log\n(\nPr(Y|X,M⊕s)\nPr(Y|X,M)\nPr(M⊕s)\nPr(M)\n)\n1\n(n\ns\n)\nβ\n=\nlog","(K·K\nM\n)\n(n\ns\n)\nβ\n,\nwhereK\nM\n=","Pr(M⊕s)/Pr(M)","represents","the","division","of","the","model’s","like-\nlihood","(called","a","prior","in","Bayesian","statistics).","Thus,","we","obtain","an","expression\nwith","three","terms:","the","first,K,","gives","us","an","MDL","equivalent","to","a","Bayesian","factor\nthat","weighs","how","likely","the","data","is","given","each","model","(MorM⊕s);","the","second,\nK\nM\n,","gives","the","likelihood","of","each","model;","and","the","third","is","a","normalizing","term\nto","be","able","to","compare","the","contribution","of","different","subgroups","given","how","much\ndata","they","cover.\nThe","first","conclusion","that","we","can","draw","from","this","is","that","the","subgroup","that","max-\nimizes","the","compression","gain","is","the","one","thatlocallymaximizes","this","statistical\ntest,","i.e.,","it","is","themodeof","this","distribution.","In","the","specific","case","of","subgroup\nlists,","","the","","factor","","termKof","","the","","compression","","gain","","corresponds","","to","","a","","propor-\ntion/multinomial","or","t-test","depending","on","the","type","of","target","variable.","Second,\nthe","termK\nM\ncan","be","seen","as","a","multiple","hypothesis","testing","correction,","as","the\nway","in","whichL(M)","was","developed","puts","more","weight","on","model","structures","that\ncan","","generate","","more","","variants.","","Also,","","it","","should","","be","","noted","","that","","the","","encoding","","of\nL(M)","is","more","subjective","thanL(D|M),","but","it","will","be","an","upper-bound","on","the\nperfect","encoding","forM,","and","can","be","taken","as","a","more","‘conservative’","test.","Third,\nif","the","compression","gain","is","positive","for","a","subgroup,","it","means","that","there","is","more\nevidence","in","favor","of","adding","that","subgroup","than","not.","Fourth,","the","normalizing\nterm","allows","us","to","adjust","the","weight","that","is","given","to","the","data","covered","by","each\nsubgroup.\nIn","summary,","we","can","say","that","the","greedy","gain","based","on","the","compression","gain,\na","","common","","heuristic","","for","","MDL","","in","","pattern","","mining,","","is","","in","","fact","","maximizing","","the\ntest","statistic","of","a","hypothesis","test","and","only","adds","that","subgroup","for","which","most\nevidence","is","available.\n7.4","Beam","search","for","subgroup","generation\nThebeam","search","algorithmfor","subgroup","generation","is","shown","in","Algorithm","1.\nIt","starts","by","discretizing","all","variables","depending","on","their","subsets,","i.e.,","nominal\nwith","","the","","operatorequal","","to(=)","","and","","numeric","","by","","generating","","all","","subsets","","with\nn\ncut\npoints.","","At","","each","","iteration","","thew\nb\nsubgroups","","that","","maximize","","the","","selected\ngain","(Eq.","(35))","are","chosen","and","will","be","expanded","with","all","discretized","variables\nuntil","the","maximum","depthd\nmax\nof","the","description","is","achieved.\nThe","algorithm","accepts","as","inputs","the","datasetD=","(X,Y),","the","number","of","cut\npointsn\ncut\nused","for","equal","frequency","binning","of","numeric","variables,","the","beam\nwidthw\nb\n,","the","maximum","depth","of","search","or","number","of","variables","in","a","subgroup\ndescriptiond\nmax\n,","and","the","indexes","of","the","data","already","covered","by","the","subgroups\n\nRobust","subgroup","discovery41\nalready","present","in","the","subgroup","list,coverage\nS\n.","The","algorithm","is","initialized\nby","filling","thebeamandsubgroupwith","an","empty","subgroup","of","size","zero","(Ln","2\nand","Ln","3,","respectively).","The","algorithm","is","composed","of","three","nested","loops.","In\nshort,","the","first","(outer)","loop","goes","over","each","depth","of","subgroups","generated,","the\nsecond","loop","goes","over","each","candidate","to","extend","for","a","fixed","depth,","and","the","third\n(interior)","loop","goes","over","each","item","used","to","extend","the","candidates.","Now","we","will\ngo","into","more","detail","over","each","loop.\nIn","thefirst","loopthe","depth","is","increased","by","one","(Ln","6),candidatesis","initialized\nwith","thepatternsof","thebeamfrom","the","previous","iteration","(Ln","7),","and","after\nthat","allpatternsare","removed","from","thebeam(Ln","8).","Thesecond","loopiterates\nover","allcandidates(Ln","9)","and","expands","each","of","them","in","the","third","loop","with","all\ntheitemsgenerated","from","the","explanatory","variablesX(Ln","11).","Anitemis","a\nsubgroup","of","size","one","that","can","be","generated","by","logical","conditions","on","one","variable\nX\nj\n∈X.","","If","","variableX\nj\nisnominal,","","each","","item","","is","","a","","condition","","given","","by","","the\nequality","operator","(=)","on","each","category,","e.g.,feathers=yesfrom","Figure","1.","If\nthe","variable","isnumeric,","equal","frequency","binning","with","open","and","closed","intervals\nis","","used","","to","","generate","","all","","possible","","items","","(further","","explained","","at","","the","","end","","of","","this\nparagraph).","Expanding","a","candidatecandto","generate","asubgroup\nnew(Ln","15)\nrequires","","computing","","three","","properties:","","1)","","its","","coverage","","of","","the","","data","","through","","a\nbitwise","","AND","","(Ln","","12);","","2)","","its","","description","","(Ln","","15);","","and","","3)","","its","","statisticsΘ\nnew\n(Ln","","15).","","Its","","score","","is","","computed","","according","","to","","Eq.","","(35)","","(Ln","","16).","","Then","","if","","the\nscore","is","higher","than","the","pattern","with","minimum","score","in","thebeam,","the","latter","is\nreplaced","by","the","higher","scoring","one.","Finally,","if","the","score","is","higher","than","the","score\nofsubgroup,","this","is","replaced.","The","algorithm","terminates","when","the","maximum\nsearch","depth","of","the","subgroups","is","reached","andsubgroupis","returned,","to","be","added\nto","the","subgroup","list","(Ln","21).\nNumeric","discretization.Suppose","a","numeric","variableX\nj\n,","and","a","number","of","cut\npointsn\ncut\n.","Theitemsgenerated","from","this","numeric","variable","are","all","valid","sub-\nsets","","(they","","must","","cover","","at","","least","","one","","instance)","","given","","by","","equal","","frequency","","dis-\ncretization","","with","","open","","and","","closed","","intervals","","forn\ncut\ncut","","points.","","Open","","inter-\nvals","require","one","operator","(≥or≤),","while","closed","intervals","require","two","(≥and\n≤).","As","an","example,","in","the","case","of","a","generic","variableX\nj\nandn\ncut\n=","2,","with\ncutpoint\n1\n=","10","andcutpoint\n2\n=","20","it","generates","fouritemswith","one","opera-\ntor,","i.e.,items\n1op\n={x\nj\n≥10,x\nj\n≤10,x\nj\n≥20,x\nj\n≤20},","and","oneitemwith\ntwo","operators,","i.e.,items\n2op\n={10≤x\nj\n≤20}.\n7.5","The","Robust","Subgroup","Discoverer\nAlgorithm","2","presents","RSD\n10\n,","forRobust","","Subgroup","","Discoverer,","a","greedy","algo-\nrithm","that","starts","with","an","empty","subgroup","list","and","iteratively","adds","subgroups\nuntil","no","more","compression","can","be","gained,","where","compression","is","measured","in\nterms","of","compression","gain","(Eq.","35)","of","adding","a","subgroups.\n10\nOur","implementation","uses","the","rulelist","package","(https://pypi.org/project/rulelist/)\nand","can","be","found","on","GitHub:https://github.com/HMProenca/RuleList\n\n42Hugo","M.","Proen","̧ca","et","al.\nAlgorithm","1Beam","search","for","subgroup","generation\nInput:DatasetD,","number","of","cut","pointsn\ncut\n,","beam","widthw\nb\n,","depth","max.d\nmax\n,","and","data\nalready","covered","by","other","subgroups","inM","coverage\nS\n.\nOutput:subgroup\n1:","","(X,Y)←D\n2:beam←[∅]\n3:subgroup←∅\n4:d←1\n5:whiled≤d\nmax\ndo\n6:d←d+","1\n7:candidates←beam\n8:beam←empty\nlist(size=w\nb\n)\n9:for(cand,coveragecand)∈candidatesdo\n10:coverage\ncand←coveragepattern&coverage\nS\n11:for(item,bitsetitem)∈items(X)do\n12:coveragenew←coverageitem&coveragecand\n13:cand\nnew←cand⊕item\n14:Θ\nnew\n←statistics(Y,coveragenew)\n15:subgroupnew←(candnew,Θ\nnew\n)\n16:score←∆\nβ\nL(D,M⊕subgroup\nnew)\n17:ifscore",">","minscore(beam)then\n18:beam←replace(beam,subgroup\nnew,minscore)\n19:ifscore",">","∆\nβ\nL(D,M⊕subgroup)then\n20:subgroup←replace(subgroup,subgroupnew)\n21:returnsubgroup\nThe","","algorithm","","starts","","by","","taking","","as","","input","","a","","datasetDand","","the","","beam","","search\nparameters,","","namely","","the","","number","","of","","cut","","pointsn\ncut\n,","","the","","width","","of","","the","","beam\nw\nb\n,","and","the","maximum","","depth","of","searchd\nmax\n.","It","initializes","the","rule","","list","with\nthe","","default","","rule,","","based","","on","","the","","dataset","","empirical","","distribution","","(Ln","","1).","","Then,\nwhile","the","beam","search","algorithm","returns","subgroups","that","improve","compression\n(Ln","3),","it","keeps","iterating","over","two","steps:","1)","finding","the","best","subgroup","from","all\ncandidates","generated","in","the","beam","search","(Ln","4);","and","2)","adding","that","subgroup\nto","","the","","end","","of","","the","","model,","","i.e.,","","after","","all","","the","","existing","","subgroups","","in","","the","","model\n(Ln","5).","The","beam","search","returns","the","best","subgroup","on","the","data","not","covered","by\nany","subgroup","already","in","modelM.","When","there","is","no","subgroup","that","improves\ncompression","(non-positive","gain)","the","while","loop","stops","and","the","subgroup","list","is\nreturned.","Note","that","beam","search","is","used","at","each","iteration,","instead","of","only","once\nat","the","beginning,","as","it","can","converge","to","local","optima,","and","running","the","candidate\nsearch","once","would","thus","bias","our","search","to","the","top-ksubgroups","instead","of","the\nbest","at","each","iteration.\n7.6","Time","and","Space","Complexity\nIn","this","section","we","analyze","the","time","and","space","complexity","of","RSD","as","given","in\nAlgorithm","2.","The","algorithm","can","be","divided","in","three","parts:","1)","preprocessing\nof","the","data;","2)","the","Separate","and","Conquer","(SaC)","algorithm;","and","3)","the","beam\nsearch.","Note","that","depending","on","the","type","of","target","we","have","different","complex-\nities","as","each","statistic","requires","different","computations.\n\nRobust","subgroup","discovery43\nAlgorithm","2RSD","algorithm\nInput:DatasetD,","","number","","of","","cut","","pointsn\ncut\n,","","beam","","widthw\nb\n,","","depth","","max.d\nmax\nand\nnormalizationβ\nOutput:Subgroup","listS\n1:M←[Θ\nd\n(Y)]\n2:subgroup←BeamSearch(M,D,w\nb\n,n\ncut\n,d\nmax\n)\n3:while∆\nβ\nL(D,M⊕subgroup)>0do\n4:subgroup←BeamSearch(M,D,w\nb\n,n\ncut\n,d\nmax\n)\n5:M←M⊕subgroup\n6:returnS∈M\n1)","","Preprocessing","","phase.In","","the","","preprocessing","","phase","","all","","the","","coverage","","bitsets\nof","the","items","are","generated,","i.e.,","the","indexes","of","the","instances","covered","by","each\nitem","generated","from","numerical","and","nominal","variables.","The","set","of","all","items","is\nζand","","its","","size","","is","","given","","by|ζ|.","","Thus,","","we","","go","","over","","the","","data","","a","","maximum","","of|ζ|\ntimes,","obtaining","a","time","complexity","ofO(|ζ|n),","and","the","results","are","stored","in\na","dictionary","forO(1)","access.","Also,","there","are","some","constants","that","are","cached\nfor","","a","","fixed","","amount","","the","","first","","time","","they","","are","","computed,","","such","","as","","the","","universal\ncode","of","integersL\nN\n(i),","andΓ(i)","for","the","numeric","target","case,","andC(i)","in","the\ncategorical","case.\n2)","SaC","phase.For","the","SaC","phase,","it","is","clear","that","the","algorithm","runs","the","beam\nsearch|S|times,","and","will","thus","multiply","the","time","complexity","of","the","beam","search\nby|S|.\n3)","","Beam","","search","","phase.For","the","lastd\nmax\n−1","iterations","of","the","loop,","each","of\nw\nb\ncandidates","","in","","the","","beam","","is","","refined","","with","","all|ζ|items,","","which","","gives","","a","","time\ncomplexity","by","itself","ofO(d\nmax\nw\nb\n|ζ|).","Then,","for","each","refinement,","the","algorithm\ncomputes","its","coverage,","statistics","and","score,","where","the","last","two","depend","on","the\nnumber","and","type","of","target.\nThecoverageof","the","refinement","is","the","logical","conjunction","of","two","bitsets,","i.e.,\nthe","bitset","of","the","candidateb\ncand\nand","that","of","the","itemb\nitem\n.","The","computation\nof","this","new","coverage","has","a","time","complexity","ofO(|b\ncand\n|+|b\nitem\n|),","which","in\na","worst","case","equals","a","run","over","the","datasetO(n+n)","=O(n).","Thus","the","time\ncomplexity","of","the","algorithm","is","given","by\nO\n(\n|S|d\nmax\nw\nb\n|ζ|stats\n)\n,\nwherestatsis","the","time","complexity","associated","to","computing","the","statistics","for\none","candidate.","Now,","we","will","analyse","the","specificstatscomplexity","depending\non","the","type","of","target.\nNominal","","target","","variables.Thestatistics","","for","","categorical","","distributionsrequire\nthe","computation","of","the","usage","for","each","class","for","each","target","of","each","subgroup\nrule","and","the","new","default","rule.","Assuming","a","maximum","number","of","classesk(for\nall","target","variables)","andttarget","variables,","then","the","worst","case","for","the","coverage\ngivesO(tnk)","from","which","the","likelihood","can","be","directly","computed.\n\n44Hugo","M.","Proen","̧ca","et","al.\nThenominal","","scorerequires","","the","","computation","","of","","the","","data","","and","","model","","encod-\ning,","from","which","the","data","encoding","dominates.","The","data","encoding","entails","the\ncomputation","","of","","the","","NML","","complexity","","and","","likelihood","","for","","each","","refinement.","","In\ngeneral","the","values","of","the","NML","complexity","are","just","computed","once","and","then\ncached,","","thus","","in","","a","","worst","","case","","where","","one","","requires","","to","","computenvalues","","for\nC(n\ni\n),∀\nn\ni\n=1,...,n\n.","Using","the","approximation","of","Mononen","and","Myllym","̈aki","(2008)\nfor","","its","","computation,","","withO(\n√\n10n\ni\n+k),","","gives","","a","","worst","","case","","complexity","","of\nO(tn(\n√\nn+k)).","This","does","not","depend","on","the","parameters","of","the","beam,","as","the\nlookup","of","these","values","isO(1).","The","likelihood","in","general","dominates","over","this\nterm","as","it","is","computed","for","each","refinement.\nThus","the","total","time","complexity","fornominal","targetsis","given","by:\nO\n(\n|S|d\nmax\nw\nb\n|ζ|tnk+tn(\n√\nn+k)\n)\nNumeric","","target","","variables.Thestatistics","","for","","normal","","distributionsrequire","the\ncomputation","","of","","the","","mean","","and","","variance","","(or","","residual","","sum","","of","","squares)","","for","","the\nrefined","subgroup","and","for","the","default","rule.","The","mean","can","be","computed","inO(n)\nand","given","this","the","variance","can","also","be","computed","inO(n).","Thus,","for","all","the\ntargets","one","obtainsO(tn).\nThenumeric","","scorerequires","","the","","computation","","of","","the","","data","","and","","model","","encod-\ning,","from","which","the","data","encoding","dominates.","The","data","encoding","entails","the\ncomputation","of","the","gamma","function","and","the","direct","use","of","the","statistics.","Simi-\nlar","to","the","NML","complexity,","we","compute","the","values","of","the","gamma","function","as\nneeded","and","cache","them","afterwards.","In","general,","the","computation","of","the","gamma\nfunction","","is","","dominated","","by","","the","","other","","terms","","as","","we","","only","","compute","","it","","at","","mostn\ntimes.\nThus","the","total","time","complexity","fornumeric","targetsis","given","by:\nO\n(\n|S|d\nmax\nw\nb\n|ζ|tn\n)\n.\nNotice","that","this","represents","a","worst","case","scenario","and","that","in","practice","the","direct\nuse","of","bitsets","for","the","computation","of","the","class","usages","in","the","nominal","case","makes\nit","faster","than","its","numeric","counterpart","for","the","same","dataset","size.\nSpace","Complexity.The","main","memory","consumption","resources","of","the","algorithm\nare:","","1)","","the","","items","","storageζ;","","2)","","the","","beam;","","and","","3)","","the","","cached","","constants.","","The\nitem","storage","requires","at","most","the","storage","of|ζ|bitsets,","with","each","bitset","taking\nO(n),","thus","it","totalsO(|ζ|n).","The","beam","savesw\nb\nbitsets","at","a","time,","thus","having\na","space","complexity","ofO(w\nb\nn).","The","cached","values","make","up","a","total","ofnvalues\nbeing","dominated","by","the","items","or","beam","part.","Thus,","depending","of","which","part\ndominates,","the","space","complexity","of","the","algorithm","is\nO(w\nb\nn+|ζ|n).\n\nRobust","subgroup","discovery45\n8","Empirical","evaluation\nIn","this","section","we","will","empirically","validate","our","proposed","problem","formulation\nand","the","RSD\n11\nalgorithm.","To","do","this,","we","will","test","how","varying","the","hyperapa-\nrameters","of","RSD","affects","the","subgroups","found,","and","then","we","will","compare","RSD\nagainst","state-of-the-art","algorithms","in","subgroup","set","discovery.\nThis","section","is","divided","as","follows.","In","Section","8.1","we","evaluate","the","effect","of","chang-\ning","","the","","different","","hyperparameters","","of","","RSD.","","Then,","","in","","Section","","8.2","","we","","present\nthe","setup","for","validating","our","approach,","based","on","algorithms","compared","against,\nand","datasets","and","measures","used","to","evaluate","them.","After","that,","in","Section","8.3,\nthe","","results","","for","","univariate","","and","","multivariate","","nominal","","targets","","are","","presented.\nThen,","in","Section","8.4","the","results","for","univariate","and","multivariate","numeric","tar-\ngets","","are","","shown.","","Finally,","","in","","Section","","8.5","","the","","runtimes","","of","","the","","algorithms","","are\ncompared.","","For","","replication","","of","","the","","experiments","","in","","this","","paper","","please","","refer","","to:\nhttps://github.com/HMProenca/RobustSubgroupDiscovery.\n8.1","Influence","of","RSD","hyperparameters\nHere","we","study","the","effect","of","RSD","hyperparameters","on","the","discovered","subgroup\nlists.","In","order","to","not","overfit","our","hyperparameters","to","the","datasets","and","for","this\nreason","obtain","a","better","performance","than","other","methods,","the","values","of","RSD","hy-\nperparameters","for","the","remaining","of","the","experiments","(besides","this","section)","are\nfixed","at","the","standard","values","of","the","DSSD","implementation","for","the","beam","search,\ni.e.,","","beam","","widthw\nb\n=","","100,","","number","","of","","cut","","pointsn\ncut\n=","","5,","","and","","maximum\nsearch","depthd\nmax\n=","5,","and","to","the","compression","gain","normalization","termβ=","1\n(normalized","gain).","These","values","are","assumed","to","be","enough","to","achieve","conver-\ngence","and","to","obtain","good","subgroup","lists,","and","are","thus","taken","as","thestandard\nvaluesof","RSD.\nNow,","to","evaluate","hyperparameter","influence,","we","vary","one","hyperparameter","value\nat","the","time","while","others","remain","fixed","at","theirstandard","values.","The","results","of\nvarying","the","compression","gain","normalization","hyperparameterβcan","be","seen","in\nAppendix","H;","the","results","of","varying","the","beam","search","hyperparametersw\nb\n,n\ncut\n,\nandd\nmax\ncan","be","found","in","Appendix","I.\nNormalization","termβ.The","results","are","evaluated","in","terms","of","compression","ratio,\nSWKL,","and","number","of","rules.","For","compression","gain","the","results","(as","shown","in\nAppendix","","H)","","are","","similar","","for","","a","","small","","number","","of","","samples","","butβ=","","1","","and","","0.5\nclearly","obtain","better","results","for","larger","datasets.","In","terms","of","SWKL,","normalized\ngain","(β=","1)","is","clearly","better.","On","the","other","hand,","in","terms","of","the","number","of\nrulesβ=","1","can","obtain","one","order","of","magnitude","more","rules","than","the","others,\nespecially","for","larger","datasets.\n11\nOur","implementation","uses","the","rulelist","package","(https://pypi.org/project/rulelist/)\nand","can","be","found","on","GitHub:https://github.com/HMProenca/RuleList\n\n46Hugo","M.","Proen","̧ca","et","al.\nBeam","","search","","hyperparametersw\nb\n,d\nmax\nandn\ncut\n.The","results","are","evaluated\nin","terms","of","compression","ratio","and","average","number","of","conditions","per","subgroup\n(ford\nmax\n).","In","general","increasing","any","of","the","three","values","results","in","better","mod-\nels","","according","","to","","relative","","compression.","","It","","is","","also","","interesting","","to","","note","","that","","for\nmaximum","depths","above","5","it","is","rare","to","have","an","average","number","of","conditions\nabove","4,","backing","up","our","decision","for","the","standard","valued\nmax\n=","5.\n8.2","Setup","of","the","subgroup","quality","performance","comparisons\nIn","this","section","we","evaluate","the","quality","of","our","proposed","method","by","comparing\nit","","to","","the","","state-of-the-art","","approaches","","in","","subgroup","","set","","discovery,","","which","","may\nvary","depending","on","the","type","of","target","variable(s).","The","comparison","takes","three\ndimensions:","1)","thealgorithmsused","to","compare","against;","2)measuresused","to\nevaluate","the","quality","of","the","subgroups","found","by","each","algorithm;","3)","thedatasets\nin","","which","","the","","algorithms","","are","","evaluated.","","We","","now","","discuss","","the","","details","","of","","each\ndimension.\n1)","Algorithms.The","algorithms","we","compared","to","and","their","relevant","character-\nistic","are","listed","in","Table","3.","A","short","description","of","each","is","as","follows:\n1.","","top-k\n12\n-","standard","subgroup","discovery","miner","used","as","benchmark.\n2.","","seq-cover\n12\n-","sequential","covering","as","implemented","in","the","DSSD","implemen-\ntation.\n3.","","CN2-SD\n13\n-","the","classical","sequential","covering","subgroup","discovery","algorithm,\nwhich","is","only","implemented","for","nominal","targets,","and","only","removes","the","ex-\namples","of","the","class","of","interest","already","covered","(not","all","examples","covered,\nas","seq-cover","does).\n4.","","Diverse","Subgroup","Set","Discovery","(DSSD)\n12\n-","diverse","beam","search","for","diverse\nsets","of","subgroups","(Van","Leeuwen","and","Knobbe,","2012).\n5.","","Monte","Carlo","Tree","Search","for","Data","Mining","(MCTS4DM)","-","an","approach","to\nimprove","on","beam","search","to","find","better","subgroups","without","getting","stuck","in\nlocal","optima","(Bosc","et","al.,","2018).\n6.","","FSSD","-","a","sequential","approach","for","subgroup","set","discovery","that","defines","a","set\nas","a","disjunction","of","subgroups","(Belfodil","et","al.,","2019).\nAs","can","be","seen","in","Table","3","most","algorithms","can","only","be","applied","to","single-target\nbinary","problems,","and","besides","RSD","only","top-k,","seq-cover","and","CN2-SD","support\nthe","use","of","Sum","of","Weighted","Kullback-Leibler","(SWKL)","divergence","to","measure\nthe","","quality","","of","","the","","found","","subgroup","","set.","","Thus","","we","","only","","compare","","against","","seq-\ncover","and","CN2-SD,","algorithms","that","output","a","subgroup","list","and","can","be","applied\nto","many","target","types,","and","with","top-kas","reference","of","a","non-diverse","subgroup\ndiscovery","algorithm.","The","algorithms","that","output","sets","do","not","have","a","stopping\ncriterion","","or","","global","","formulation,","","and","","underperform","","in","","terms","","of","","SWKL,","","thus\n12\ntop-k,","seq-cover,","and","DSSD","are","available","in","the","implementation","of","the","DSSD","algorithm\nhttp://www.patternsthatmatter.org/software.php#dssd/\n13\nAvailable","in","the","Orange","data","mining","toolkithttps://orangedatamining.com/\n\nRobust","subgroup","discovery47\nTable","3:","Algorithms","included","in","the","comparison","and","their","functionalities.Qual-\nityrepresents","the","quality","measure","used","to","evaluate","one","single","subgroup,search\nis","the","type","of","search","algorithm","supported,swklshows","if","it","supports","SWKL","to\nmeasure","the","quality","of","a","subgroup","set,outputtells","if","the","subgroups","discovered\nform","a","list","or","a","set,","and","‘3’","and","‘−’","represent","if","that","type","of","target","variable(s)\nis","supported.","MCTS","stands","for","Monte","Carlo","Tree","Search.","*","The","algorithms\nonly","supportWKL\nμ\nfor","numeric","targets","(Eq.","(7)),","i.e.,","a","Weighted","Kullback-\nLeibler","divergency","that","only","takes","into","account","the","mean,","contrary","to","the","one\nused","","by","","RSD","","that","","also","","uses","","the","","variance","","(Eq.","","(8)).","","For","","the","","nominal","","target\ncase","","there","","is","","only","","one","","WKL","","(the","","different","","WKL","","measures","","are","","explained","","in\nSection","3.5).\nnominalnumeric\nAlgorithmqualitysearchoutputswklbin.nom.multisinglemulti\nRSDWKLbeamlist333333\ntop-kWKL\n∗\nμ\nbeamset333333\nseq-coverWKL\n∗\nμ\nbeamlist333333\nCN2-SDentropybeamlist333---\nDSSDWKL\n∗\nμ\nbeamset-33333\nMCTS4DMWKL\n∗\nμ\nMCTSset-3----\nFSSDWRAccDFSlist33----\nthose","comparisons","are","relegated","to","Appendix","G.","As","example,","DSSD","can","indeed\nbe","applied","to","all","types","of","target","variables,","but","the","fact","that","it","uses","weighted\nsequential","covering","makes","it","unsuitable","to","use","the","SWKL,","making","it","unfairly\nunderperform","and","unsuitable","for","a","fair","comparison","(as","shown","in","the","Appendix).\nAlso,","","note","","that","","we","","do","","not","","compare","","with","","machine","","learning","","algorithms","","that\ngenerate","rules","for","classification","or","regression,","such","as","RIPPER","or","CART,","as","the\nrules","generated","aim","at","making","the","best","prediction","possible,","and","not","the","highest\ndifference","from","the","dataset","distribution,","as","shown","theoretically","in","Appendix","E.\nQuality","measures.As","the","quality","of","a","set","is","measured","using","the","SWKL,","the\nmost","appropriate","measure","to","use","is","the","Weighted","Kullback-Leibler","(WKL)","for\nthe","algorithms","that","support","it.","CN2-SD","supports","entropy","which","is","related","to\nWKL.","FSSD","only","supports","WRAcc","at","the","moment.","Note","that","for","the","case","of\nnumeric","targets,","except","RSD,","all","use","a","WKL","that","only","takes","into","account","the\nmean,","given","byWKL\nμ\n(s)","=n\ns\n/ˆσ\nd\n(","ˆμ\nd\n−ˆμ\ns\n)\n2\n,","in","contrast","to","the","deviation-\naware","measure","of","RSD","in","Eq.","34.\nHyperparameters.Most","algorithms","use","beam","search,","thus","only","have","three\nmain","hyperparameters:","the","maximum","depth","of","searchd\nmax\n;","the","width","of","the\nbeamw\nb\n;","","and","","the","","number","","of","","cut","","points","","to","","discretize","","numeric","","explanatory\nvariablesn\ncut\n.","The","larger","the","values","the","better","the","performance","but","the","slower\nthe","algorithms","become,","as","time","complexity","is","linear","to","each","of","them.","To","be","fair\nand","not","over-search","the","hyperparameters,","we","selected","the","default","values","of","the\nDSSD","and","seq-cover","implementation","for","all","beam-search","algorithms:d\nmax\n=","5,\nw\nb\n=","100,n\ncut\n=","5.","For","the","case","of","MCTS4DM,","which","requires","a","larger","set\nof","","hyperparameters,","","only","","the","","number","","of","","iterations","","is","","set,n\niter\n=","","50","000,","","to\n\n48Hugo","M.","Proen","̧ca","et","al.\nensure","good","convergence,","and","the","rest","were","set","as","default.","FSSD","only","requires\nthe","maximum","depth,","which","was","set","at","5.\n2)","Measures.In","order","to","ascertain","the","quality","of","the","subgroup","sets","we","use","three\ndifferent","measures.","The","first","is","our","proposal","to","measure","the","overall","quality","of\nan","ordered","set","of","subgroups,","the","Sum","of","Weighted","Kullback-Leibler","(SWKL),\nas","defined","in","Eq.","(9).","The","other","two","are","the","number","of","subgroups|S|and","the\naverage","number","of","conditions","per","subgroup|a|,","two","commonly","used","measures\nfor","the","interpretability/complexity","of","a","set","of","rules.","These","two","measures","follow\nthe","law","of","parsimony","and","assume","that","fewer","subgroups","with","fewer","conditions\nare","easier","to","understand","by","humans,","which","can","be","an","invalid","assumption","in\nsome","situations.","Nonetheless,","it","is","widely","used","and","its","simple","understanding\ntypically","","make","","for","","a","","good","","proxy","","(Doshi-Velez","","and","","Kim,","","2018).","","In","","machine\nlearning,","algorithms","are","tested","on","their","generalization","to","unseen","data,","which\nis","achieved","by","","multiple","runs","","using","different","","test","sets","","(e.g.,","cross-validation).\nEven","though","this","could","be","of","interest,","subgroup","discovery","is","always","evaluated\non","the","same","dataset,","as","the","goal","is","to","describe","the","current","dataset","well.","For\nthis","reason,","and","for","the","fact","that","existing","implementations","are","not","prepared","to\nuse","a","test","set,","we","follow","the","standard","approach","in","subgroup","discovery","of","only\ntesting","on","the","current","dataset.\n3)","Datasets.For","a","thorough","analysis","we","use","a","total","of","54","datasets—10-univariate\nbinary;","10","univariate","nominal;","9","multivariate","nominal;","15","univariate","numeric;\nand","9","multivariate","numeric—that","are","listed","in","Tables","7","and","8","of","Appendix","F.\nThe","","datasets","","are","","commonly","","used","","benchmarks","","of","","machine","","learning","","and","","sub-\ngroup","discovery,","which","are","publicly","available","from","the","UCI\n14\n,","Keel\n15\nand","MU-\nLAN\n16\nrepositories.","The","datasets","were","selected","to","be","the","most","varied","possible.\nIn","the","case","of","the","nominal","target","datasets","in","Table","7,","the","number","of","targets\nranges","from","1","to","374,","the","classes","from","2","to","28,","the","samples","from","150","to","45","222,\nand","the","variables","from","3","to","1","186.","In","the","case","of","the","numeric","target","datasets\nin","Table","8,","the","number","of","targets","ranges","from","1","to","16,","the","samples","from","154\nto","22","784.","Note","that","we","used","multi-label","datasets","instead","of","multi-nominal","as\nthe","latter","are","not","widely","available.\n8.3","Nominal","target","results\nThe","results","obtained","on","binary,","nominal","and","multi-label","datasets","with","sequen-\ntial","subgroup","set","miners","can","be","seen","in","Table","4,","while","the","results","for","algorithms\nthat","ouput","sets","can","be","found","in","Table","9","in","Appendix","G.","We","can","see","that","overall\nour","algorithm","gets","15","out","of","29","best","results,","compared","with","seq-cover","in","sec-\nond","place","with","13","best","results.","In","terms","of","SWKL","and","per","type","of","data,","RSD\nachieves","the","smallest","ranking","for","binary,","seq-cover","for","nominal,","and","both","are\ntied","for","multi-nominal.","This","small","difference","in","the","results","between","RSD","and\n14\nhttps://archive.ics.uci.edu/ml/\n15\nhttp://www.keel.es/\n16\nhttp://mulan.sourceforge.net/datasets.html\n\nRobust","subgroup","discovery49\nseq-cover","is","important","for","two","reasons.","First,","it","validates","SWKL,","as","it","shows\nthat","seq-cover","is","already","implicitly","maximizing","it","without","knowing","it.","Second,\nit","","shows","","that","","RSD","","can","","obtain","","on","","par","","or","","slightly","","better","","results","","than","","other\nestablished","approaches.","Our","non-diverse","baseline,","top-k,","shows","that","covering\ndifferent","regions","of","the","dataset","is","clearly","important","to","maximize","SWKL.\nRegarding","the","number","of","found","subgroups","we","can","see","that","in","most","cases,","all\nalgorithms","","are","","in","","the","","same","","order","","of","","magnitude,","","with","","some","","clear","","exceptions\nwhere","","RSD","","obtains","","many","","more","","subgroups","","(foradult,nursery,kr-vs-k,","","and\nmediamill).","","These","","results","","can","","be","","explained","","by","","the","","use","","of","","normalized","","gain\n(β=","","1)","","by","","RSD,","","together","","with","","the","","fact","","that","","these","","datasets","","have","","a","","large\nnumber","of","samples,","few","variables,","and/or","a","large","number","of","categories.","First,\nlet","","us","","recall","","that","","the","","normalized","","compression","","gain","","of","","Eq.","","(35)","","is","","composed\nof","","a","","data","","covering","","part","","and","","a","","model","","penalization","","part,","","and","","that","","both","","are\nnormalized","by","the","number","of","instances","covered,","which","gives","an","advantage","to\nsubgroups","","that","","cover","","less","","data","","but","","are","","well-covered","","(only","","one","","category,","","or\nfew","categories).","When","the","datasets","are","larger","and","the","number","of","variables","is\nreasonably","small,","likeadultwith","45","222","examples","and","14","variables,","there","is","a\nlarger","chance","of","finding","more","statistically","“significant”","subgroups,","as","there","can\nbe","more","regions","where","subgroups","only","(or","almost","only)","cover","one","class,","and","the\npenalization","of","the","model","encoding","is","small","as","there","are","not","many","variables.\nOn","the","other","hand,","subgroups","that","cover","more","data","can","more","easily","have","a\nlarger","entropy","in","the","class","label","distribution.","For","example,kr-vs-k,","which","is","a\nreasonably","large","dataset","with","28","056","and","with","18","class","labels,","a","subgroup","that\nonly","covers","one","class","label,","as","opposed","to","covering","many","class","labels,","will","have\na","higher","chance","of","being","chosen.","The","number","of","subgroups","found","can","be","large,\nbut","it","was","shown","in","a","classification","setting","that","they","generalize","well","(Proen","̧ca\nand","van","Leeuwen,","2020).","It","is","interesting","to","note","that","in","the","case","ofcorel-5k,\nRSD","does","not","find","any","“significant”","subgroup","to","add.\nRegarding","the","number","of","conditions","per","subgroup,","the","two","best","performing\nalgorithms","in","terms","of","SWKL,","RSD","and","seq-cover,","tend","to","have","similar","and\nlower","number","of","conditions","than","the","other","algorithms.","Top-k,","only","covering\nthe","same","region,","has","a","tendency","to","be","close","to","the","maximum","depth","of","5.\n8.4","Numeric","target","results\nThe","results","for","the","single-target","and","multi-target","numeric","datasets","can","be","seen\nin","Table","5.","In","general","it","can","be","seen","that","RSD","obtains","the","best","results","for","23\nout","of","25","datasets.","This","is","to","be","expected","as","SWKL","and","RSD","take","into","account\nthe","dispersion/deviation","of","the","subgroup","target","while","top-kand","seq-cover","do\nnot.","This","is","clearly","supported","by","the","normalized","standard","deviation","of","the","first\nsubgroup","found,","where","RSD","tends","to","find","subgroups","with","smaller","deviation\nfor","10","out","of","15","cases.","Comparing","SWKL","results","for","top-kwith","seq-cover","and\nRSD","","shows","","that","","irrespective","","of","","dispersion-aware","","(RSD)","","or","","not","","(seq-cover),\ncovering","different","regions","of","the","data","increases","the","quality","of","the","list","in","terms\nof","SWKL,","validating","the","use","of","our","measure.","It","should","be","noted","that","both","top-\n\n50Hugo","M.","Proen","̧ca","et","al.\nTable","","4:","","Nominal","","target","","results.","","This","","includes","","single-binary,","","single-nominal,\nand","","multi-label,","","separated","","by","","horizontal","","lines","","in","","the","","table","","(top","","to","","bottom).\nThe","","properties","","of","","the","","datasets","","can","","be","","seen","","in","","Table","","7,","","and","","are","","ordered","","in\nascending","number","of:","1)","target","variables;","2)","number","of","classes;","and","3)","number\nof","","samples.","","The","","evaluation","","measures","","are{quality","","of","","the","","subgroup","","set","","swkl;\nnumber","of","subgroups|S|;","and","average","number","of","conditions|a|}.","‘avg.","rank’\nstands","for","the","average","ranking","for","the","respective","target","variable","type,","where","1\nrepresents","the","best","rank.","Note","that","CN2-SD","does","not","work","for","multi-label","case\nand","thus","the","empty","values−.","*as","RSD","produced","no","subgroups","for","corel-5k,\nseq-cover","number","of","subgroups","was","used","as","a","reference.\ntop-kseq-coverCN2-SDRSD\ndatasetsswkl|S|","|a|swkl|S|","|a|swkl|S|","|a|swkl|S|","|a|\nsonar0.24240.96\n0.96\n0.96920.671120.4323\nhaberman0.08150.39\n0.39\n0.392040.181240.0411\nbreastCancer0.37620.801320.801120.82\n0.82\n0.8262\naustralian0.26530.69\n0.69\n0.691330.542430.5552\ntictactoe0.501630.731830.212130.87\n0.87\n0.87162\ngerman0.08450.302240.42\n0.42\n0.424840.1443\nchess0.251730.871320.685130.97\n0.97\n0.97172\nmushrooms0.491240.921111.00\n1.00\n1.003611.00\n1.00\n1.00121\nmagic0.166950.383540.4261630.47\n0.47\n0.47694\nadult0.1110350.277940.43123040.31\n0.31\n0.311034\navg.","rank3.81.93.82.12.42.22.23.82.51.9\n1.9\n1.91.91.5\niris0.53421.45\n1.45\n1.45520.96421.4441\nbalance0.21930.80\n0.80\n0.801930.18330.6993\nCMC0.07730.30\n0.30\n0.303840.274230.2572\npage-blocks0.192150.452620.441240.49\n0.49\n0.49213\nnursery0.928121.362230.87841.63\n1.63\n1.63813\nautomobile0.38541.61\n1.61\n1.611131.54\n1.54\n1.54741.2552\nglass1.01521.55522.14\n2.14\n2.14621.9251\ndermatology0.54922.28\n2.28\n2.28922.12732.1192\nkr-vs-k0.4535150.754340.206151.83\n1.83\n1.833513\nabalone0.261650.622940.604930.74\n0.74\n0.74162\navg.","rank3.72.43.01.6\n1.6\n1.63.02.22.82.33.41.92.41.4\nemotions0.711751.93224−","","−","","−2.68\n2.68\n2.68173\nscene0.394951.85334−","","−","","−3.05\n3.05\n3.05494\nbirds0.49852.02\n2.02\n2.02204−","","−","","−1.5783\nflags0.44542.40\n2.40\n2.40174−","","−","","−1.2152\nyeast0.493551.83555−","","−","","−2.20\n2.20\n2.20355\ngenbase0.881525.51121−","","−","","−5.82\n5.82\n5.82151\nmediamill0.4313151.44605−","","−","","−2.96\n2.96\n2.961315\nCAL5001.461516.91\n16.91\n16.91364−","","−","","−1.2415\ncorel5k\n∗\n5.8114435.39\n5.39\n5.391444−","","−","","−0.0000\navg.","rank2.71.92.71.7\n1.7\n1.72.31.9−1.7\n1.7\n1.71.81.4\nkand","seq-cover","could","in","practice","support","taking","into","account","the","deviation\nbut","that","would","require","several","non-trivial","modifications","in","their","source","code.\n\nRobust","subgroup","discovery51\nTable","","5:","","Numeric","","target","","results.","","This","","includes","","single-numeric","","and","","multi-\nnumeric,","","separated","","by","","a","","horizontal","","line","","in","","the","","table","","(top","","to","","bottom).","","The\nproperties","of","the","datasets","can","be","seen","in","Table","8,","and","are","ordered","in","ascending\nnumber","of:","1)","target","variables;","2)","number","of","classes;","and","3)","number","of","sam-\nples.","The","evaluation","measures","are{quality","of","the","subgroup","set","swkl;","number\nof","subgroups|S|;","normalized","standard","deviation","of","the","first","subgroup","","̃σ\nt1\n;","and\naverage","number","of","conditions|a|}.","‘avg.","rank’","stands","for","the","average","ranking\nfor","the","respective","target","variable","type,","where","1","represents","the","best","ranking.\nNote","","that","","","̃σ\nt1\nis","","not","","shown","","for","","the","","multi-numeric","","case","","as","","it","","is","","not","","easy","","to\nunderstand.\ntop-kseq-coverRSD\ndatasetsswkl","̃σ\nt1\n|S|","|a|swkl","̃σ\nt1\n|S|","|a|swkl","̃σ\nt1\n|S|","|a|\nbaseball0.260.82741.401.222641.86\n1.86\n1.860.0172\nautoMPG80.430.54841.451.852241.57\n1.57\n1.570.1882\ndee0.460.50941.292.012041.35\n1.35\n1.350.3292\nele-10.291.06841.140.942241.22\n1.22\n1.221.2482\nforestFires0.616.842242.730.155743.91\n3.91\n3.917.57223\nconcrete0.280.651841.271.533541.31\n1.31\n1.310.21183\ntreasury0.430.683142.741.462143.85\n3.85\n3.850.01312\nwizmir0.700.312242.153.222642.72\n2.72\n2.720.15222\nabalone0.230.592640.471.6812650.71\n0.71\n0.711.32263\npuma32h0.550.594841.391.687051.44\n1.44\n1.440.29483\nailerons0.241.239841.040.8210541.44\n1.44\n1.440.98984\nelevators0.231.4415840.830.6915051.31\n1.31\n1.311.401584\nbikesharing0.261.0913641.240.929141.70\n1.70\n1.700.021364\ncalifornia0.190.9017440.691.1111651.14\n1.14\n1.140.001744\nhouse0.191.5926940.910.6314352.02\n2.02\n2.022.832695\navg.","rank3.02.11.82.02.02.32.32.71.0\n1.0\n1.01.61.81.3\nedm0.47−550.81−921.88\n1.88\n1.88−52\nenb2.73−4123.54−1928.71\n8.71\n8.71−412\nslump1.38−452.74\n2.74\n2.74−1742.57−43\nsf10.16−352.06\n2.06\n2.06−4741.24−33\nsf20.86−252.29−1840.91\n0.91\n0.91−24\njura0.47−1552.38−2843.52\n3.52\n3.52−153\nosales2.17−45418.09−48326.44\n26.44\n26.44−453\noes976.55−16330.79−19434.36\n34.36\n34.36−164\noes106.56−23329.11−27440.65\n40.65\n40.65−233\nwq0.87−6252.06−47411.14\n11.14\n11.14−624\navg.","rank3.0−1.72.41.7−2.61.81.3\n1.3\n1.3−1.71.8\nRegarding","the","number","of","subgroups,","seq-cover","tends","to","have","more","rules","than\nRSD","for","datasets","with","less","than","5","000","examples,","while","RSD","tends","to","have","more\nfor","higher","number","of","examples.","This","makes","sense","as","there","is","more","evidence","to\nidentify","possible","significant","subgroups.\nRegarding","","the","","number","","of","","antecedents,","","RSD","","tends","","to","","have,","","on","","average,","","one\ncondition","fewer","than","seq-cover","for","single-target","and","a","similar","number","for","the\nmulti-target","case.\n\n52Hugo","M.","Proen","̧ca","et","al.\n8.5","Runtime","comparison\nRuntimes","of","all","algorithms","compared,","i.e.,","top-k,","seq-cover,","CN2-SD,","and","RSD,\nare","shown","in","Figures","6a","and","6b.","In","general,","it","can","be","seen","that","the","runtime\nincreases","with","the","number","of","samples","in","the","dataset","for","a","fixed","data","type.","For\nthe","nominal","datasets","it","seems","that","there","is","an","increase","in","runtime","with","the\nnumber","of","target","variables,","which","does","not","seem","to","happen","for","numeric","targets.\nThis","is","due","to","the","fact","that","for","multivariate","numeric","targets","the","number","of\nsubgroups","found","was,","in","general,","smaller.\nComparing","","the","","algorithms","","against","","each","","other,","","as","","expected,","","top-kwas","","the\nfastest","","algorithm,","","as","","it","","only","","needs","","to","","search","","for","","the","","subgroups","","once,","","while\nthe","others","need","multiple","iterations.\nFor","","nominal","","targets,","","CN2-SD","","was","","the","","slowest","","algorithm,","","which","","stems","","from\nthe","use","of","entropy","as","quality","measure—experiments","with","WRAcc","proved","to\nbe","much","faster.","RSD","seems","to","perform","on","par","with","seq-cover","and","is","often","even\nslightly","faster.\nFor","numeric","targets","RSD","was","one","order","of","magnitude","slower","than","seq-cover.\nOne","possible","reason","is","the","extra","time","to","compute","the","variance,","although","this\ndoes","not","totally","explain","the","difference","between","both","algorithms.","It","seems","that\na","further","study","of","the","numeric","implementation","could","make","for","an","interesting\nresearch","direction.\nsonar\nhaberman\nbreastCancer\naustralian\nTicTacToe\ngerman\nchess\nmushrooms\nmagic\nadult\niris\nbalance\nCMC\npage-blocks\nnursery\nautomobile\nglass\ndermatology\nkr-vs-k\nabalone\nbirds\nCAL500\nCorel5k\nemotions\nflags\ngenbase\nmediamill\nscene\nyeast\n10\n1\n10\n0\n10\n1\n10\n2\n10\n3\n10\n4\n10\n5\nruntime","(seconds)\nRSD\ntop-k\nseq-cover\nCN2-SD\n(a)","Nominal","targets.\nbaseball\nautoMPG8\ndee\nele-1\nforestFires\nconcrete\ntreasury\nwizmir\nabalone\npuma32h\nailerons\nelevators\nbikesharing\ncalifornia\nhouse\nedm\nenb\njura\noes10oes97\nosales\nsf1sf2\nslump\nwq\n10\n0\n10\n1\n10\n2\n10\n3\n10\n4\nruntime","(seconds)\nRSD\ntop-k\nseq-cover\n(b)","Numeric","targets.\nFig.","6:","Runtime","in","seconds","for","all","algorithms","for","each","dataset.","The","black","ver-\ntical","line","divides","the","type","of","datasets,","i.e.,","from","left","to","right:","univariate","binary,\nnominal,","and","multi-label","for","nominal","targets,","and","univariate","and","multivariate\nfor","numeric.\n9","Case","study:","associations","between","socioeconomic","background","and\nuniversity","grades","of","Colombia","Engineering","students\nIn","this","section","we","apply","RSD","to","a","real","use","case","to","assess","its","usefulness","and","limi-\ntations.","To","this","end,","we","aim","at","understanding","how","socioeconomic","factors","affect\n\nRobust","subgroup","discovery53\nthe","grades","of","engineering","university","students","in","Colombia","on","their","national","ex-\nams.","The","dataset","used","to","study","this","is","fully","described","by","Delahoz-Dominguez\net","al.","(2020).","It","contains","socioeconomic","variables","and","grades","in","national","exams\ndone","at","high-school","and","university","level","for","engineering","students","in","Colombia.\nFor","our","specific","case","study","we","have","selected","two","of","their","exam","grades","at","the\nuniversity","for","two","reasons.","First,","the","relationship","between","socioeconomic","vari-\nables","and","university","grades","is","weaker","(than","for","high","school","grades),","thus","more\ninteresting","to","see","if","we","can","find","relations,","and","second,","only","having","two","exams\ngrades","improves","the","visualization","of","the","results.\nDataset.The","","dataset","","used","","is","","composed","","of","","12","412","","samples,","","22","","explanatory\nvariables,","and","2","numeric","target","variables.","The","explanatory","variables","refer","to\nthe","socioeconomic","background","of","the","students","at","the","time","of","high","school,","and\nthey","are","made","of","variables","such","as","parents","level","of","education,","the","household\nincome,","which","type","of","high","school","they","attended,","the","utilities","available","at","home\n(e.g.,","internet","and","television),","and","their","neighborhood","stratum\n17\n.","The","numeric\ntargets","represent","their","grades,","from","0%","to","100%,","in","two","national","university-\nlevel","exams,","namely","quantitative","reasoning","and","English.\nAn","additional","reason","for","selecting","this","dataset","is","that","it","violates","two","of","our\nmodel","","assumptions:","","1)","","the","","target","","variables","","values","","are","","truncated","","between","","0\nand","100,","thus","violating","the","use","of","a","continuous","normal","distribution","to","describe\nthem;","","and","","2)","","the","","target","","variables","","are","","not","","independent,","","as","","suggested","","by","","a\ncorrelation","of","53%.","If","our","approach","is","shown","to","work","despite","these","violations,\nwe","may","consider","this","is","a","good","result.\n9.1","Analysis","of","the","subgroups","obtained","with","RSD\nThe","first","four","subgroups","with","absolute","(β=","0)","and","normalized","(β=","1)","gain\ncan","be","seen","in","Figures","7a","and","7b,","respectively.","The","distributions","of","the","first\ntwo","subgroups","for","both","gains","can","be","seen","in","Figures","8a,","8b,","8c","and","8d.","The\ntwo","extreme","gains","were","used","to","show","that","from","an","user","perspective","it","can","be\ninteresting","to","use","different","gains","depending","on","the","goal","of","the","data","exploration,\ni.e.,","coarse","versus","fine-grained","perspective.\nComparison","of","absolute","and","normalized","gain.Overall,","with","absolute","and","nor-\nmalized","gain","our","method","finds","7","and","34","subgroups","that","cover","a","total","of","84%\nand","92%","of","the","data,","respectively.","Looking","at","Figures","","","8a,","8b,","8c","and","8d,","it\ncan","be","seen","that","normalized","gain","favors","smaller","and","compact","subgroups","that\ndeviate","more","from","the","dataset","distribution,","while","absolute","gain","favors","larger\nsubgroups","that","deviate","less","from","the","dataset","distribution.","These","conclusions\ncan","be","verified","by","noting","that","normalized","gain","subgroups","tend","to","have","a","smaller\n17\nStratum","","","is","","","a","","","classification","","","system","","","unique","","","to","","","Colombia,","","","where","","","districts","","","are\nranked","","","based","","","on","","","their","","","affluence","","","level","","","from","","","1","","","to","","","6,","","","where","","","1","","","is","","","the","","","lowest","","","level\nhttps://www.dane.gov.co/index.php/servicios-al-ciudadano/servicios-informacion/\nestratificacion-socioeconomica(Accessed","on","16","Feb.","2021).\n\n54Hugo","M.","Proen","̧ca","et","al.\nstandard","deviation,","between","5%","and","9%,","while","absolute","gain","has","values","in","the\nsame","order","of","magnitude","of","the","dataset","distribution,","i.e.,","around","23%.\nInterpretation","of","the","results.Both","normalized","and","absolute","gain","results","point\nto","the","fact","that","having","a","‘better’","socioeconomic","background","is","associated","with\nhigher","grades","on","average","in","both","types","of","exams,","and","the","contrary","is","associated\nwith","lower","grades.","This","is","clearer","in","the","absolute","gain","case,","as","each","subgroup\ncovers","more","data.","It","is","noticeable","in","Figure","8b","that","a","subgroup","with","standard\ndeviation","similar","to","the","dataset","leads","to","subgroups","that","are","spread","throughout\nthe","whole","range","of","values.","Nonetheless,","that","subgroup","covers","more","regions","with\nlower","grades","than","the","dataset,","making","it","a","relevant","result","to","understand","the\ndataset","better.\nIn","general,","it","can","be","seen","that","some","conditions","appear","often","in","the","subgroups,\nsuch","ashousehold\nincomeabove","and","below","5","minimum","wages","and","education","of\none","of","parents","equal","or","above","high","school.","It","seems","that","presence","or","absence","of\nthese","variables","is","highly","associated","with","above","or","below","average","performance,\nrespectively.\nLooking","at","specific","subgroups,","it","is","interesting","to","see","that","in","the","4\nth\nsubgroup\nof","the","absolute","gain,","the","Quantitative","reasoning","grade","is","equal","to","the","average\nbehavior","of","the","dataset","(77%),","while","the","English","grade","is","8%","above","average.\nLooking","","at","","the","","subgroups","","with","","normalized","","gain,","","we","","see","","that","","there","","are","","only\nslight","variations","of","their","descriptions","and","that","they","clearly","belong","to","a","similar\nsocioeconomic","","macro","","group","","but","","with","","slight","","differences","","in","","their","","descriptions,\nwhich","corresponds","to","small","differences","on","their","grades","distribution.\nViolation","of","the","model","assumptions.Here","we","can","observe","how","our","method","be-\nhaves","when","some","modeling","assumptions","are","violated.","Regarding","the","truncated\nvalues,","it","seems","that","the","normalized","gain","is","affected","by","grades","around","100","(as\nseen","in","Figures","8c","and","8d)","as","most","of","its","subgroups","capture","these","students,\nwhich","increases","the","average","and","lowers","the","standard","deviation,","making","them\nrank","higher.","Clearly","our","method","was","not","developed","for","target","values","that","are\nhighly","stratified,","but","the","results","seem","to","show","that","it","is","does","not","seem","pro-\nhibitive","to","the","use","RSD","in","these","cases","as","long","as","the","stratification","is","mild","and\nthe","user","takes","into","account","this","fact.\nRegarding","the","independence","assumption,","it","seems","that","the","subgroups","found\nare","still","relevant","although","both","grades","are","almost","always","taken","into","account\ntogether,","i.e.,","as","the","values","are","positively","correlated","it","is","more","likely","to","find\nsubgroups","with","mean","values","that","are","high","or","low","for","both","exams,","but","not","high\nfor","one","and","low","for","the","other.","This","is","expected","as","the","encoding","of","independent\nnormal","distributions","does","not","take","into","account","the","covariance","between","target\nvariables,","and","thus","that","case","is","not","deemed","a","deviation","by","the","current","model\nformulation.\n\nRobust","subgroup","discovery55\nsdescriptionof","a","student","socioeconomic","backgroundn\ns\nQuant.English\n1householdincome≥5","min.","wage","&","publicschool","=","no167687±1688±14\n&","edu\nmother>highschool","&","Microwave","=","yes\n2householdincome<5","min.","wage403172±2554±26\n&","stratum<5","&","public\nschool","=","yes\n3gender","=","M","&","edufather≥highschool147885±1778±20\n&","social\nsupport","=","None","&","stratum>3\n&","publicschool","=","no\n4socialsupport","=","None","&","edufather>highschool99777±2276±19\n&","public\nschool","=","no","&","internet","=","yes\n&","mobile","=","yes\n.\n.\n.\ndataset","distribution1945\n∗\n77±2368±26\n(a)","Subgroup","list","with","absolute","gain","(β=","0).","First","4","subgroups","of","a","total","of","7","and","swkl\n=","0.41\nsdescriptionof","a","student","socioeconomic","backgroundn\ns\nQuant.English\n1householdincome≥5","min.","wage","&","gender","=","M","&3996±592±6\nhousehold\nsize<3","&","edufather>high-school\n&","mobile","=","yes\n2householdincome≥5","min.","wage2396±595±4\n&","schooltype","=","academic","&","occ.mother","=","retired\n&","edufather≥Undergrad\n3householdincome≥5","min.","wage3096±593±6\n&","jobmother","=","independent","&","stratum≥4","&","gender","=","M\n&","jobfather","=","independent\n4jobmother","=","executive","&","stratum≥4","&","mobile","=","yes3293±994±6\n&","jobfather","=","independent","&","publicschool","=","no\n.\n.\n.\ndataset","distribution942\n∗\n77±2368±26\n(b)","Subgroup","list","with","normalized","gain","(β=","1).","First","4","subgroups","of","a","total","of","34","and","swkl\n=","0.52\nFig.","7:Colombia","engineering","studentsperformance","in","Quantitative","Reasoning\nand","English","exams.","The","results","of","Fig.","7a","and","7b","were","obtained","by","RSD","with\nabsolute","","gain(β=","","0)","","andnormalized","","gain(β=","","1).","","The","","dataset","","contains\ntwo","numeric","target","variableQuantitative","","ReasoningandEnglishexams","in","a\n0-100%","scale.","The","dataset","represents","12","412","engineering","students","in","Colom-\nbia,","their","grades","in","university","national","exams","and","their","social-economic","back-\nground.Descriptioncontains","information","regarding","students","socio-enconomic\nbackground,n\ns\nthe","number","of","instances","covered,","Quant.","and","English","the","av-\nerage","grade","and","standard","deviation","in","the","respective","exams.\n∗\nThenof","the\ndataset","is","the","total","number","of","instances","in","the","dataset.\n\n56Hugo","M.","Proen","̧ca","et","al.\n020406080100\nQuantitative","reasoning","grade","(%)\n0\n20\n40\n60\n80\n100\nEnglish","grade","(%)\ndataset\n","dataset\n","dataset\nsubgroup","1\n","subgroup","1\n","subgroup","1\n(a)","1\nst\nsubgroup","withabsolutegain.\n020406080100\nQuantitative","reasoning","grade","()\n0\n20\n40\n60\n80\n100\nEnglish","grade","(%)\ndataset\n","dataset\n","dataset\nsubgroup","2\n","subgroup","2\n","subgroup","2\n(b)","2\nnd\nsubgroup","withabsolutegain.\n020406080100\nQuantitative","reasoning","grade","(%)\n0\n20\n40\n60\n80\n100\nEnglish","grade","(%)\ndataset\n","dataset\n","dataset\nsubgroup","1\n","subgroup","1\n","subgroup","1\n(c)","1\nst\nsubgroup","withnormalizedgain.\n020406080100\nQuantitative","reasoning","grade","(%)\n0\n20\n40\n60\n80\n100\nEnglish","grade","(%)\ndataset\n","dataset\n","dataset\nsubgroup","2\n","subgroup","2\n","subgroup","2\n(d)","2\nnd\nsubgroup","withnormalizedgain.\nFig.","8:","Scatter","plot","of","the","grades","of","students","for","Quantitative","Reasoning","and\nEnglish","exam,","together","with","the","grades","associated","with","the","descriptions","of","the\n1\nst\nand","2\nnd\nwithabsoluteandnormalizedgain.\n\nRobust","subgroup","discovery57\n10","Conclusions\nWe","showed","that","finding","good","subgroup","lists","(ordered","sets)","that","are","both","non-\nredundant","and","statistically","robust,","i.e.,robust","subgroup","discovery,","is","computa-\ntionally","feasible.","To","achieve","this,","we","first","defined","what","a","subgroup","list","is","and\nthen","","proposed","","an","","optimal","","formulation","","of","","subgroup","","lists","","based","","on","","the","","MDL\nprinciple.","We","proposed","a","heuristic","algorithm","dubbed","RSD","that","approximates\nthis","objective","by","means","of","a","greedy","search","that","adds","the","subgroup","that","locally\nminimizes","the","MDL","criteria","to","the","list","in","each","consecutive","iteration.","This","ap-\nproximation","was","shown","to","be","equivalent","to","a","Bayesian","test","(factor)","between\nsubgroup","and","dataset","marginal","target","distributions","plus","a","penalty","for","multiple\nhypothesis","testing,","which","guarantees","that","each","subgroup","added","to","the","list","is\nstatistically","sound.\nThese","assertions","are","supported","by","empirical","evidence","obtained","on","a","varied","set\nof","54","datasets.","In","case","of","nominal","targets","our","method","performed","on","par","in","terms\nof","subgroup","list","quality,","while","obtaining","smaller","lists","with","fewer","conditions.","In\ncase","of","numeric","targets","and","through","the","use","of","a","deviation-aware","measure,","our\nmethod","dominated","in","92%","of","the","cases.\nThrough","","a","","case","","study","","relating","","the","","socioeconomic","","background","","and","","national\nexams","grades","for","Colombia","engineering","university","students,","we","showed","that\nRSD","can","be","flexibly","adapted","to","different","goals","of","the","user.","In","particular,","it","can\nchange","from","afine","grainedperspective","of","the","data","that","finds","many","subgroups\nthat","cover","small","parts","of","the","data","well,","to","acoarseperspective","that","finds","few\nsubgroups","","that","","cover","","large","","parts","","of","","the","","data.","","Also,","","it","","was","","shown","","that","","our\nmethod","is","robust","to","mild","violations","of","our","model","assumptions.\nLimitations.Even","though","the","RSD","algorithm","has","some","appealing","local","sta-\ntistical","properties,","we","do","now","know","how","far","the","found","models","are","from","the\noptimal","","subgroup","","lists","","as","","defined","","by","","the","","global","","MDL","","criteria","","we","","proposed.\nAlso,","it","does","not","scale","very","well","for","numeric","targets,","which","was","to","be","expected\nfrom","the","time","complexity","analysis.","At","the","moment,","multiple","target","variables\nare","","assumed","","to","","be","","independent,","","which","","can","","produce","","erroneous","","results","","when\nthis","","assumption","","is","","violated.","","Preliminary","","experiments","","show","","that","","for","","moder-\nately","correlated","variables","(e.g.,","with","a","correlation","of","0.5)","this","does","not","seem\nto","be","an","issue,","but","there","is","no","quantification","of","its","implications.","Similarly,","for\nnumeric","targets","we","use","a","normal","distribution,","and","several","datasets","violate","this\nassumption,","either","by","behaving","like","a","multi-modal","or","truncated","distribution.\nFuture","","work.The","","main","","lines","","of","","research","","for","","future","","work","","can","","be","","divided","","in\nthree","categories:","1)","extending","subgroup","lists","to","other","target","variables","and/or\ndistributions;","2)","algorithmic","developments;","and","3)","generalize","this","framework\nto","other","model","classes.","In","the","first","category,","an","obvious","extension","would","be","to\ndistributions","that","take","into","account","multiple","dependent","target","variables,","such\nas","multivariate-normal","distributions","for","numeric","targets","and","over","itemsets","for\nthe","nominal","case.","Another","interesting","and","straightforward","development","would\nbe","","the","","extension","","our","","work","","to","","mixed","","targets,","","combining","","both","","nominal","","and\n\n58Hugo","M.","Proen","̧ca","et","al.\nnumeric","variables.","In","the","second","category,","algorithmic","developments","could","go\nfrom","mere","upper-and-lower","bounds","to","improvements","in","search","methods","and\nto","study","the","feasibility","of","global","search","such","as","Markov","Chain","Monte","Carlo\nmethods.","In","the","third","category,","our","approach","could","be","formalized","for","subgroup\nsets,","allowing","for","overlap","between","the","subgroups.\nAcknowledgementsThis","work","is","part","of","the","research","programme","Indo-Dutch","Joint","Re-\nsearch","","Programme","","for","","ICT","","2014","","with","","project","","number","","629.002.201,","","SAPPAO,","","which","","is\n(partly)","financed","by","the","Netherlands","Organisation","for","Scientific","Research","(NWO).\nAppendices\nA","Normalized","Maximum","Likelihood","independence","for\nnon-overlapping","multinomials\nFor","","the","","purposes","","of","","this","","section,","","let","","us","","assume","","that","","we","","have","","a","","datasetD={X,Y}and\nmodelMthat","","forms","","a","","partition","","over","","the","","whole","","data.","","The","","modelMdivides","","the","","dataD\ninωparts,","of","the","form{(X\n1\n,Y\n1\n),···,(X\nω\n,Y\nω\n)}.","Each","part","has","an","associated","categorical\ndistribution","with","estimated","parameters\nˆ\nΘ\ni\nover","the","target","partY\ni\n(as","defined","in","Section","3).\nOur","goal","in","this","section","is","to","show","that","the","NML","encoding","of","a","partition","equals","to","the","sum\nof","the","NML","encoding","of","its","parts:\nL\nNML\n(Y|X,M)","=\nω\n∑\ni=1\nL\nNML\n(Y\ni\n).(36)\nNote","that","in","the","case","of","a","subgroup","list","as","the","default","rule","does","not","require","NML","encoding,\ntheMused","in","this","section","just","represents","the","subgroupsS,","andDjust","represents","the","data\ncovered","by","these.","In","the","case","of","a","tree","or","rule","list,Mrepresents","the","model","that","partitions\nthe","","data","","at","","the","","level","","of","","leaves","","and","","rules","","(including","","default","","rule),","","respectively,","","andDthe\nwhole","dataset.","This","is","done","without","any","loss","of","generality","as","the","separation","property","allows\nus","to","separate","the","encoding","of","the","default","rule","for","a","subgroup","list.\nFirst,","lets","recall","the","definition","of","the","NML","probability","distribution","(Shtar’kov,","1987):\nL\nNML\n(Y|X,M)","=−log\n(\nPr(Y|X;\nˆ\nM(Y|X))\n∑\nZ∈Y\nn\nPr(Z|X;\nˆ\nM(Z|X))\n)\n,\nwhereY\nn\nis","the","set","of","all","possible","sequences","ofnpoints","withk=|Y|categories,\nˆ\nM(Y|X)\nand\nˆ\nM(Z|X)","are","the","models","with","parameters","estimated","according","to","the","maximum","likeli-\nhood","over","the","dataYandZ,","respectively.","Taking","into","account","that","our","data","is","independent\nand","identically","distributed","(i.i.d.),","and","that","our","modelMpartitions","the","data","intoωparts,\nwe","can","further","develop","the","previous","formula","to:\nL\nNML\n(Y|X,M)\ni.i.d.\n=−log\n(\n∏\nn\ni=1\nPr(y\ni\n|x\ni\n;\nˆ\nM(Y|X))\n∑\nZ∈Y\nn\n∏\nn\ni=1\nPr(z\ni\n|x\ni\n;\nˆ\nM(Z|X))\n)\n=−log\n(\n∏\nω\ni\n′\n=1\nPr(Y\ni\n′\n;\nˆ\nΘ(Y\ni\n′\n))\n∑\nZ∈Y\nn\n∏\nω\ni\n′\n=1\nPr(Z\ni\n′\n;\nˆ\nΘ(Z\ni\n′\n))\n)\n=−log\n(\n∏\nω\ni\n′\n=1\nl(\nˆ\nΘ\ni\n′\n|Y\ni\n′\n)\ng(Y,X,M)\n)\n=−log\n\n\nω\n∑\ni\n′\n=1\nl(\nˆ\nΘ\ni\n′\n|Y\ni\n′\n)\n\n\n+","logg(Y,X,M),\n(37)\n\nRobust","subgroup","discovery59\nwherel(\nˆ\nΘ\ni\n′\n|Y\ni\n′\n)","","is","","the","","likelihood","","function","","for","","each","","of","","theωparts","","andg(Y,X,M)","","is","","a\ncomplexity","function","that","depends","on","these","3","variables.\nThe","first","term","is","already","independent","for","each","part,","however","the","second","is","not.\nLet","us","now","look","atg(Y,X,M)","in","the","case","where","we","only","have","one","part","in","the","dataset,","i.e.,\nD\n1\n.","We","will","call","this","term","the","NML","complexity","of","a","multinomial","distribution","and","denote","it\nbyC(n\n1\n,k)","of","one","partD\n1\n={Y\n1\n,X\n1\n},","withn\n1\n=|D\n1\n|andk=Y\nC(n\n1\n,k)","=","log\n\n\n∑\nZ∈Y\nn\n1\nPr(Z\n1\n;\nˆ\nΘ(Z\n1\n))\n\n\n=","log\n\n\n∑\nZ∈Y\nn\n1\nn\n1\n∏\ni=1\nPr(z\ni\n;\nˆ\nΘ(Z\n1\n))\n\n\n=","log\n\n\n∑\nn\n11\n+n\n12\n+...+n\n1k\n=n\n1\nn\n1\n!\nn\n11\n!n\n12\n!...n\n1k\n!\n∏\nc∈Y\n(\nn\n1c\nn\n1\n)\nn\n1c\n\n\n(38)\nwheren\n1c\nis","the","number","of","points","of","categorycinY\n1\n,","and","the","passage","from","the","second\nequality","to","the","last","is","a","property","of","multinomial","distributions","commonly","used","to","make","the\ncomputation","","ofC(n\na\n,k)","","simpler","","(Gr","̈unwald,","","2007).","","It","","is","","interesting","","to","","note","","thatC(n\na\n,k)\nonly","depends","on","the","number","of","points","inY\n1\nand","its","cardinality,","not","on","the","actual","values.\nThis","term,","i.e.,","the","complexity","of","a","multinomial","distribution","overn\n1\npoints","withkpossible\nvalues,","measures","the","likelihood","of","each","possible","sequence.\nTable","","6:","","All","","possible","","sequences","","of","","a","","partition","","of","","fixed","","length","","of","","the","","data","","in\nthree","parts.","Fixed","length","means","that","all","possible","parts","always","have","the","same\namount","of","points,","as","e.g.|A\n1\n|=|A\n2\n|=···=|A\na\n|=n\nA\n.\nPart","1Part","2Part","3\nA\n1\nB\n1\nC\n1\nA\n1\nB\n1\nC\n2\n.\n.\n.\n.\n.\n.\n.\n.\n.\nA\n1\nB\n2\nC\n1\n.\n.\n.\n.\n.\n.\n.\n.\n.\nA\na\nB\nb\nC\nc\nNow","we","must","generalize","from","a","part","to","the","whole","partition","of","the","dataset.","To","illustrate","how\nto","do","this,","let","us","first","look","at","Table","6,","which","shows","an","example","of","all","the","possible","sequences\nin","a","fixed-length","three","part","partition","of","the","data.","Taking","into","account","those","three","parts,","let\nus","look","at","how","the","probabilities","of","all","those","sequences","could","be","computed:\n∑\n∀a,b,c\nPr(A\na\n)","Pr(B\nb\n)","Pr(C\nc\n)","=\n\n\n∑\n∀a\nPr(A\na\n)\n\n\n·\n\n\n∑\n∀b,c\nPr(B\nb\n)","Pr(C\nc\n)\n\n\n=\n\n\n∑\n∀a\nPr(A\na\n)\n\n\n·\n\n\n∑\n∀b\nPr(B\nb\n)\n\n\n·\n\n\n∑\n∀c\nPr(C\nc\n)\n\n\n,\nwhere","this","follows","naturally","from","the","distributive","property","of","the","multiplication.","It","is","easy\nto","see","that","this","generalizes","to","partitions","of","any","number","of","parts.","Thus,","going","back","to","the\ncomplexity","termg(Y,X,M),","we","can","see","that\n\n60Hugo","M.","Proen","̧ca","et","al.\nlogg(Y,X,M)","=","log\n∑\nZ∈Y\nn\nω\n∏\ni\n′\n=1\nPr(Z\ni\n′\n;\nˆ\nΘ(Z\ni\n′\n))\n=","log\nω\n∏\ni\n′\n=1\n∑\nZ\ni\n′\n∈Y\nn\ni\n′\nPr(Z\ni\n′\n;\nˆ\nΘ(Z\ni\n′\n))\n=\nω\n∑\ni\n′\n=1\nlog\n∑\nZ\ni\n′\n∈Y\nn\ni\n′\nPr(Z\ni\n′\n;\nˆ\nΘ(Z\ni\n′\n))\n=\nω\n∑\ni\n′\n=1\nlogC(n\ni\n′\n,k)\n(39)\nSubstituting","this","back","into","Eq.","(37),","we","obtain","what","we","wanted:\nL\nNML\n(Y|X,M)","=−log\n\n\nω\n∑\ni=1\nl(\nˆ\nΘ\ni\n|Y\ni\n)\n\n\n+\nω\n∑\ni=1\nlogC(n\ni\n,k)\n=\nω\n∑\ni=1\nl(\nˆ\nΘ\ni\n|Y\ni\n)","+C(n\ni\n,k)\n=\nω\n∑\ni=1\nL\nNML\n(Y\ni\n)\n(40)\nB","Bayesian","encoding","of","a","normal","distribution","with","mean","and\nstandard","deviation","unknown\nInitially","","this","","derivation","","appeared","","in","","Proen","̧ca","","et","","al.","","(2020)","","but","","for","","completeness","","we","","will\nrepeat","it","here.","For","encoding","a","sequence","of","numeric","valued","i.i.d.","observations","such","asY=\n(y\n1\n,....,y\nn\n),","the","Bayesian","encoding","takes","the","following","form:\nP\nBayes\n(Y)","=\n∫\nΘ\nf(Y|Θ)w(Θ)","dΘ,(41)\nwherefis","","the","","probability","","density","","function","","(pdf),Θis","","the","","set","","of","","parameters","","of","","the","","dis-\ntribution,","","andw(Θ)","","the","","prior","","over","","the","","parameters.","","In","","the","","case","","of","","a","","normal","","distribution\nΘ={μ,σ},","","withμandσbeing","","its","","mean","","and","","standard","","deviation,","","respectively,","","the","","pdf\nf(Y|Θ)","over","a","sequenceYis","the","multiplication","of","the","individual","pdfs,","thus:\nf(Y|μ,σ)","=\n1\n(2π)\nn/2\nσ\nn\nexp\n\n\n−\n1\n2σ\n2\nn\n∑\ni\n(y\ni\n−μ)\n2\n\n\n,(42)\nIn","","order","","not","","to","","bias","","the","","encoding","","for","","specific","","values","","of","","the","","parameters,","","we","","choose","","to","","use\na","normal","prior","on","the","effect","sizeρ=μ/σand","the","constant","Jeffrey’s","prior","of","1/σ\n2\nfor","the\nunknown","parametersμandσ.","Thus,","our","prior","is","given","by:\nw(μ,σ)","=\n1\n√\n2πτσ\n2\nexp\n[\n−\n1\n2σ\n2\nμ\n2\nτ\n2\n]\n.(43)\nPutting","everything","together,","one","obtains:\nP\nBayes\n(Y)","=\n=","(2π)\n−\nn+1\n2\nτ\n−1\n∫\n+∞\n−∞\n∫\n+∞\n0\n1\nσ\nn+2\nexp\n\n\n\n−\n1\n2σ\n2\n\n\nn\n∑\ni\n(y\ni\n−μ)\n2\n+\nμ\n2\nτ\n2\n\n\n\n\n\ndσdμ.\n(44)\n\nRobust","subgroup","discovery61\nThe","integrals","over","the","whole","space","of","the","parametersμandσallow","to","penalize","the","fact","that\nwe","do","not","know","the","statisticsa","","priori,","thus","penalizing","the","fact","that","a","distribution","overn\npoints","could,","by","chance,","have","the","same","statistics","as","the","one","found","in","the","data.","Note","that","this\nprior","choice","is","equal","to","the","one","of","G","̈onen","et","al.","(2005)","for","the","Bayesian","two-sample","t-test,\nwhich","was","shown","to","converge","to","the","Bayes","Information","Criteria","(BIC)","for","largen(Rouder\net","al.,","2009).\nNote","that","using","an","improper","prior","requires","that","we","somehow","make","it","proper,","i.e.,","we","need\nto","","find","","a","","way","","to","","make","","the","","integration","","over","","the","","prior","","finite\n∫","∫\nw(μ,σ)","","=K,whereKis\na","","constant","","value.","","The","","usual","","way","","to","","make","","an","","improper","","prior","","finite","","is","","to","","condition","","on","","the\nkminimum","number","observationsY\n|k\n∈Yneeded","to","make","the","integral","proper","(Gr","̈unwald,\n2007),","which","in","the","case","of","two","unknowns","(μandσ)","isk=","2.","Thus,","instead","of","usingw(μ,σ)\nwe","will","in","practice","be","usingw(μ,σ|Y\n|2\n),","and","using","the","the","chain","rule","and","the","Bayesian\nformula","returns","a","total","encoding","ofYequal","to\nP(Y)","=P\nBayes\n(Y|Y\n|2\n)P(Y\n|2\n)","=\nP\nBayes\n(Y)\nP\nBayes\n(Y\n|2\n)\nP(Y\n|2\n)(45)\nwhereP(Y\n|2\n)","is","a","non-optimal","probability","used","to","defineY\n|2\n={y\n1\n,y\n2\n}that","we","will","define\nlater","andy\n1\n,y\n2\nchosen","in","a","way","that","maximizesP(Y).","Now","that","we","have","all","the","ingredients","to\ndefineP(Y)","we","will","start","by","definingP\nBayes\n(Y)","and","then","choose","the","appropriate","probability\nforP(Y\n|2\n).\nTo","solve","the","first","integral","ofP\nBayes\n(Y)","in","Eq.","(44),","we","integrate","inσand","note","that","the\nformula","is","an","instance","of","the","gamma","function,\nΓ(k)","=\n∫\n+∞\n0\nz\nk−1\ne\n−z\ndz,(46)\nwith","the","corresponding","variable","transformation:\nz=\nA\n2σ\n2\n;\n1\nσ\n=\n2\n1/2\nz\n1/2\nA\n1/2\n;","","dσ=−\nσ\n2z\ndz;A=\n\n\nn\n∑\ni\n(y\ni\n−μ)\n2\n+\nμ\n2\nτ\n2\nρ\n\n\n,(47)\nPerforming","the","variable","transformation","and","noting","that","the","minus","sign","of","dzcancels","with\nthe","reversing","of","the","integral","limits,","we","get:\nP\nBayes\n(Y)","=\n=τ\n−1\nΓ(n/2)2\nn+1\n2\n−1\n(2π)\n−\nn+1\n2\n∫\n+∞\n−∞\n\n\nn\n∑\ni\n(y\ni\n−μ)\n2\n+\n1\nτ\n2\n(0−μ)\n2\n\n\n−\nn+1\n2\ndμ,\n(48)\nwhich","","reveals","","that","","the","","prior","","on","","the","","effect","","sizeρ,","","and","","specifically","","its","","standard","","deviation\nparameterτ,","is","equivalent","to","adding","1/τ\n2\nvirtual","points","to","the","original","data.\nTo","solve","the","integral","inμwe","need","to","introduce","the","statistics","ˆμand","ˆσas","the","values","estimated\nfrom","the","data.","We","define","these","quantities","as:\nˆμ=\n1\nn\nn\n∑\ni\ny\ni\n;","","ˆμ\n′\n=\nn\nn+","1/τ\n2\nˆμ;","","ˆσ\n2\n=\n1\nn\nn\n∑\ni\n(y\ni\n−ˆμ)\n2\n,(49)\nwhere","","ˆμis","the","mean","estimator","overndata","points,","","ˆμ\n′\nis","an","extension","of","the","mean","adding\n1/τ\n2\nvirtual","points,","and","ˆσ\n2\nis","the","estimator","of","the","variance.","Note","that","for","the","variance","the\nbiased","version","withnwas","used","instead","of","withn−1","as","it","allows","to","compute","the","Residual\nSum","of","Squares","(RSS)","directly","byRSS=nˆσ.\n\n62Hugo","M.","Proen","̧ca","et","al.\nFocusing","","now","","on","","the","","interior","","part","","of","","the","","integral","","of","","Eq.","","48","","and","","rewriting","","it","","in","","order","","to\nresemble","the","t-student","distribution,","we","obtain:\n\n\nn\n∑\ni\n(y\ni\n−μ)\n2\n+\n1\nτ\n2\n(0−μ\n2\n)\n\n\n−(n+1)/2\n=\n\n\nn\n∑\ni\n(y\ni\n)\n2\n−(n+","1)ˆμ\n′2\n+","(n+","1)ˆμ\n′2\n−2(n+","1/τ\n2\n)ˆμ\n′\nμ\n2\n+","(n+","1/τ\n2\n)μ\n2\n\n\n−(n+1)/2\n=\n\n\nn\n∑\ni\n(y\ni\n)\n2\n−nˆμ\n2\n+","(n+","1/τ\n2\n)(ˆμ\n′\n−μ)\n2\n\n\n−(n+1)/2\n=\n[\nnˆσ\n2\n+","(n+","1/τ\n2\n)(ˆμ\n′\n−μ)\n2\n]\n−(n+1)/2\n=\n[\nnˆσ\n2\n]\n−(n+1)/2\n[\n1","+\n(n+","1/τ\n2\n)(ˆμ\n′\n−μ)\n2\nnˆσ\n2\n]\n−(n+1)/2\n[\nnˆσ\n2\n]\n−(n+1)/2\n\n\n1","+\n1\nn\n(\nˆμ\n′\n−μ\ns\n2\ns\n)\n2\n\n\n−(n+1)/2\n,\n(50)\nwheres\n2\ns\n=","ˆσ/(n+","1/τ\n2\n)","is","the","“sampling”","variance.","Now,","taking","into","account","the","fact","that\nthe","integral","of","the","t-student","distribution","over","the","whole","space","is","equal","to","one,","and","reshuffling\naround","its","terms","we","get\n∫\n+∞\n−∞\n\n\n1","+\n1\nn\n(\nˆμ\n′\n−μ\ns\ns\n)\n2\n\n\n−\nn+1\n2\ndμ=\nΓ\n(\nn\n2\n)\n√\nπns\ns\nΓ\n(\nn+1\n2\n)\n.(51)\nInserting","this","back","in","Eq.","44","we","obtain:\nP\nBayes\n(Y)","=\n=τ\n−1\nΓ\n(\nn+","1\n2\n)\n2\nn+1\n2\n−1\n(2π)\n−\nn+1\n2\nΓ(\nn\n2\n)\n√\nπns\ns\nΓ(\nn+1\n2\n)\n[\nnˆσ\n2\n]\n−(n+1)/2\n=τ\n−1\n2\n−1\nπ\n−\n(n+1)\n2\nΓ\n(\nn\n2\n)\n1\n√\nn+","1/τ\n2\n[\nnˆσ\n2\n]\n−\nn\n2\n,\n(52)\nReturning","to","the","the","conditional","probability","of","Eq.","(45),","we","see","that","we","still","need","to","define\nP(Y\n|2\n),","the","non-optimal","probability","of","the","first","two-points.","As","in","the","case","of","our","model","class\nwe","assume","that","the","dataset","overall","statistics","are","known,","i.e.,Θ={ˆμ\nd\n,ˆσ\nd\n},","we","will","use","this\ndistribution","to","find","the","probability","of","the","pointsY\n|2\n={y\n1\n,y\n2\n}as",":\nP(Y\n|2\n)","=","log","2π+","log","ˆσ\nd\n+\n\n\n1\n2ˆσ\n2\nd\n2\n∑\ni\n(y\ni\n−ˆμ\nd\n)\n2\n\n\nloge.(53)\n\nRobust","subgroup","discovery63\nFinally,","applying","the","minus","logarithm","base","2","to","all","the","terms","in","Eq","(45)","to","obtain","the","total\ncode","length","in","bits,\nL\nBayes2.0\n(Y)","=−logP\nBayes\n(Y)","+","logP\nBayes\n(Y\n|2\n)−logP(Y\n|2\n)\n=","1","+\nn\n2\nlogπ−logΓ\n(\nn\n2\n)\n+\n1\n2\nlog(n+","1/τ\n2\n)","+\nn\n2\nlog\n(\nnˆσ\n2\nn\n)\n−1−\n2\n2\nlogπ+","0−\n1\n2\nlog(2","+","1/τ\n2\n)−log\n\n\n2\n∑\ni\n(y\ni\n−ˆμ\n2\n)\n2\n\n\n+\n2\n2\nlogπ+","log","ˆσ\nd\n+\n\n\n1\n2ˆσ\n2\nd\n2\n∑\ni\n(y\ni\n−ˆμ\nd\n)\n2\n\n\nloge\n=\nn\n2\nlogπ−logΓ\n(\nn\n2\n)\n+\n1\n2\nlog(n+","1/τ\n2\n)","+\nn\n2\nlog\n(\nnˆσ\n2\nn\n)\n+L\ncost\n(Y\n|2\n),\n(54)\nwhere","","ˆμ\n2\nis","the","estimated","mean","ofy\n1\n,y\n2\nandL\ncost\n(Y\n|2\n)","is","the","extra","cost","incurred","of","not\nbeing","able","to","use","a","refined","encoding","forY\n|2\n.","Now","that","the","length","of","the","encoding","is","defined\nwe","just","need","to","choose","the","two","points.","i.e.,y\n1\n,y\n2\n.","Because","we","want","to","minimize","this","length,\nwe","notice","that","there","are","only","two","terms","that","contribute","to","it","inL\ncost\n(Y\n|2\n),","and","thus","by\nchoosing","","the","","two","","observations","","close","","to","","ˆμ\nd\nwe","","can","","both","","minimize","","the","","encoding","","ofP(Y\n|2\n)\nand","maximizeP\nBayes\n(Y\n|2\n)","for","most","cases.","There","are","exceptions","to","this,","depending","on","the\nrespective","values","ofμ\nd\nandy\n1\n,y\n2\nbut","this","are","not","significant","to","change","the","values","too","much\nand","also","requires","less","computational","search","to","find","the","points.\nC","Bayesian","encoding","convergence","to","BIC","for","largen\nIn","this","section","it","is","shown","that","for","large","number","of","instancesnthe","Bayesian","encoding","of","a\nnormal","distribution","with","unknown","mean","and","standard","deviation","(Eq.","(54))","converges","to","the\nencoding","of","a","normal","distribution","with","mean","and","standard","deviation","known","plus","logn,","i.e.,\nproportional","to","the","definition","of","the","Bayes","Information","Criterion","(BIC).","First","the","encoding\nof","","a","","normal","","distribution","","with","","mean","","and","","standard","","deviation","","known","","overni.i.d.points","","is\nequal","to","the","sum","of","the","individual","encodings:\nL(Y|\nˆ\nΘ)","=\nn\n2\nlog","2π+\nn\n2\nlog","ˆσ\n2\n+\n\n\n1\n2ˆσ\n2\nn\n∑\ni\n(y\ni\n−ˆμ)\n2\n\n\nloge.(55)\nSecond,","we","need","to","use","the","Stirling’s","approximation","of","the","Gamma","function","for","largen:\n−logΓ\n(\nn\n2\n)\n∼−\n1\n2\nlogπ−\n1\n2\nlog","(n−2)−\n(\nn\n2\n−1\n)\nlog\n(\nn\n2\n−1\n)\n+\n(\nn\n2\n−1\n)\nloge,\n(56)\n\n64Hugo","M.","Proen","̧ca","et","al.\nand","finally","we","insert","it","into","Eq.","(54)","and","assumeτ=","1","to","obtain:\nL(Y)∼\n∼1","+\nn−1\n2\nlogπ+\n1\n2\nlog\n(\nn+","1\nn−2\n)\n+\nn\n2\nlog\n(\nnˆσ\n2\nn/2−1\n)\n+\n(\nn\n2\n−1\n)\nloge\n+","log\n(\nn\n2\n−1\n)\n+L\ncost\n(Y\n|2\n)\n∼\nn\n2\nlogπ+\nn\n2\nlog","2ˆσ\n2\n+\n\n\n1\n2ˆσ\n2\nn\n∑\ni\n(y\ni\n−μ)\n2\n\n\nloge+","logn−loge+L\ncost\n(Y\n|2\n)\n=L(Y|\nˆ\nΘ)","+","log\nn\ne\n+L\ncost\n(Y\n|2\n)\n∼\n1\n2\n(\n2L(Y|\nˆ\nΘ)","+","2","logn−2","loge\n)\n=\n1\n2\nBIC,\n(57)\nwhere","","from","","the","","second","","to","","the","","third","","line","","we","","assumed","","largen,","","making","","some","","of","","the","","terms\ndisappear,","","while","","the","","definitionnˆσ\n2\n=\n∑\nn\ni\n(y\ni\n−μ)\n2\nis","","used","","for","making","","the","","third","","term","","of\nthe","third","expression","appear.","From","the","fourth","to","the","fifth","expressions","it","was","assumed","that\nL\ncost\n(Y\n|2\n)","","is","","negligible,","","as","","it","","is","","the","","cost","","of","","not","","being","","able","","to","","encode","","the","","first","","two","","points\noptimally.","For","the","Bayes","information","criterion","we","used","its","standard","definition,\nBIC=−2","ln`(Θ|Y)","+klnn,(58)\nwhere`(Θ|Y)","is","the","likelihood","as","estimated","from","the","data,","andkis","the","number","of","param-\neters,","which","in","our","case","is","2.\nD","Kullback-Leibler","divergence","between","two","normal","distributions\nLet","us","assume","two","normal","probability","distributions,p(x)∼N(μ\np\n,σ\np\n)","andq(x)∼N(μ\nq\n,σ\nq\n).\nThe","Kullback-Leibler","divergence","ofqfrompis:\nKL\nμ,σ\n(p;q)","=\n∫\n+∞\n−∞\np(x)","logp(x)","dx−\n∫\n+∞\n−∞\np(x)","logq(x)","dx\n=E\np\n[\nlogp(x)\n]\n−E\np\n[\nlogq(x)\n]\n=−\n1\n2\n(\nloge+","log","2πσ\n2\np\n)\n+\n1\n2\nlog","2πσ\n2\nq\n+E\np\n[\n(x−μ\nq\n)\n2\n2σ\n2\nq\nloge\n]\n=−\nloge\n2\n+","log\nσ\np\nσ\nq\n+E\np\n[\nx\n2\n−2xμ\nq\n+μ\n2\nq\n2σ\n2\nq\nloge\n]\n=−\nloge\n2\n+","log\nσ\nq\nσ\np\n+\nσ\n2\np\n+μ\n2\np\n−2μ\np\nμ\nq\n+μ\n2\nq\n2σ\n2\nq\nloge\n=−\nloge\n2\n+","log\nσ\nq\nσ\np\n+\nσ\n2\np\n+","(μ\np\n−μ\nq\n)\n2\n2σ\n2\nq\nloge.\n(59)\nNote","that","in","the","specific","case","where","the","Kullback-Leibler","divergence","only","takes","into","account\nthe","means","and","assumes","both","standard","deviations","equal,","i.e.,p(x)∼","N(μ\np\n,σ)","andq(x)∼\nN(μ\nq\n,σ)","one","obtains:\nKL\nμ\n(p;q)","=\n(μ\np\n−μ\nq\n)\n2\n2σ\n2\nloge,(60)\n\nRobust","subgroup","discovery65\nand","the","weighted","version","of","thisKL\nμ\n,","i.e.,WKL\nμ\n=nKL\nμ\n(p;q),","is","similar","to","the","most\ncommon","","subgroup","","discovery","","quality","","functions","","used","","for","","numeric","","targets","","that","","do","","not","","take\ninto","account","the","dispersion","of","the","subgroup,","such","as","the","weighted","relative","accuracy","or","the\nmean-test","(Van","Leeuwen","and","Knobbe,","2012),","which","uses","the","square","root","ofKL\nμ\n.","We","will\ncall","this","measure","the","Weighted","Kullback-Leibler","without","dispersion.\nE","Difference","between","subgroup","discovery","and","rule-based","predictive\nmodels\nIn","this","section","we","show","the","difference","between","the","objective","being","maximized","for","subgroup\ndiscovery","","and","","for","","predictive","","rules.","","We","","do","","this","","through","","the","","comparison","","of","","the","","equivalent\nmaximization","MDL","scores","for","subgroup","lists","and","classification","rule","lists","(Proen","̧ca","and","van\nLeeuwen,","2020)","with","only","one","rule/subgroup—without","loss","of","generality","for","greater","sizes","or\nfor","regression","tasks.","To","differentiate","both","model","classesSLandRLwill","be","used","for","subgroup\nlists","and","classification","rule","lists,","respectively.\nFirst,","lets","recall","the","form","of","a","subgroup","listSLas","given","in","Figure","4:\nsubgroup","1\n:\nifavxtheny∼Cat(\nˆ\nΘ\na\n)\ndataset\n:\nelsey∼Cat(\nˆ\nΘ\nd\n)\nwhere,\nˆ\nΘ\na\nare","the","estimated","parameters","of","subgroup","1","and\nˆ\nΘ\nd\nare","the","estimated","parameters\nof","the","marginal","distribution","of","the","dataset","and","are","thus","constant","for","each","dataset.","On","the\nother","hand,","the","model","form","of","a","classification","rule","listRLtakes","the","following","form:\nrule","1\n:\nifavxthenCat(\nˆ\nΘ\na\n)\ndefault\n:\nelsey∼Cat(\nˆ\nΘ\n¬a\n)\nwhere\nˆ\nΘ\n¬a\nwas","used","to","emphasize","that","the","default","rule","of","a","rule","list","is","not","fixed,","and","is\nequivalent","to","the","‘not","rule","1’.","This","is","the","key","difference","between","between","these","two","types\nof","models,","the","default","rule","is","fixed","to","the","marginal","distribution","of","the","dataset","for","subgroup\nlists,","and","the","default","rule","has","the","distribution","of","the","negative","set","of","the","rules","in","the","list","for\nrule","lists.","It","should","be","noted","that","there","are","many","definitions","of","rule","lists","that","use","a","fixed\nrule,","","however","","having","","a","","variable","","default","","rule","","that","","maximizes","","the","","prediction","","quality","","is","","the\nbest","","representative","","of","","rule","","lists","","and","","of","","the","","objective","","of","","finding","","the","","best","","machine","","learning\nmodel,","i.e.,","returning","the","best","partition","of","the","data","with","the","smallest","error","possible.","Note\nthat","a","decision","tree","is","also","part","of","this","family","of","models","as","any","path","starting","at","the","root","of\nthe","tree","to","one","of","its","leaves","also","forms","a","rule,","and","thus,","a","decision","tree","is","equivalent","to","a","set\nof","disjoint","rules,","i.e.,","none","of","the","rules","described","in","this","way","overlap","on","a","dataset.","For","the\ntype","of","classification","rule","lists","defined","above,","the","encoding","of","the","first","rule","and","default","rule\nis","given","by","Eq.","23","as","for","both","rules","the","parameters","are","unknown.\nThus","the","MDL","score","of","a","rule","list","is","given","by:\nL(D,RL)","=L(Y\na\n|X\na\n)","+L(Y\n¬a\n|X\n¬a\n)","+L(RL),\n(61)\nand","note","that","the","model","encodingL(RL)","=L(SL),","has","both","lists","can","be","described","in","the\nsame","manner.\nFollowing","","the","","same","","steps","","as","","in","","Section","","5.4","","by","","turning","","the","","MDL","","score","","objective","","from","","a\nminimization","to","maximization","by","multiplying","by","minus","one","and","adding","the","constantL(Y\nd\n|\nΘ\nd\n),","we","obtain","the","same","objective","as","in","Eq.","5.4:\nr\n∗\n=","arg","max\ns∈M\n[\nL(Y\nd\n|Θ\nd\n)−L(Y|X,RL)−L(RL)\n]\n,\n\n66Hugo","M.","Proen","̧ca","et","al.\nwhereris","the","rule","that","maximizes","the","objective.","Working","out","this","equation,","maximization\nobjective","of","aclassification","rule","listfor","a","target","variable","ofkclass","labels","is","given","by:\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(RL)\n=L(Y\na\n|\nˆ\nΘ\nd\n)","+L(Y\n¬a\n|\nˆ\nΘ\nd\n)−L(Y\na\n|X\na\n)−L(Y\n¬a\n|X\n¬a\n)−L(RL)\n=n\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)−C(n\na\n,k)","+n\n¬a\nKL(\nˆ\nΘ\n¬a\n;\nˆ\nΘ\nd\n)−C(n\n¬a\n,k)−L(RL),\n(62)\nThis","should","be","contrasted","with","the","maximization","objective","ofsubgroup","listof","Eq.","25,","which\nis","given","by:\nL(Y|\nˆ\nΘ\nd\n)−L(Y|X,M)−L(SL)","=\nn\na\nKL(\nˆ\nΘ\na\n;\nˆ\nΘ\nd\n)−C(n\na\n,k)−L(SL).\nComparing","both","of","the","last","equations","we","can","notice","the","most","important","distinction","between\nsubgroup","discovery","and","classification:","thelocalnature","of","subgroup","discovery","and","theglobal\nnature","of","the","classification","task.","In","other","words,","subgroup","discovery","aims","at","finding","sub-\ngroups","","that","","locally","","maximize","","their","","quality,","","independently","","of","","the","","rest","","of","","the","","dataset,","","and\neven","","though","","rules","","for","","classification","","try","","to","","maximize","","theirlocalquality","","also,","","they","","have","","to\ntake","into","account","the","quality","of","their","negative","set,","i.e.,","a","rule","for","classification","cannot","be\nconsidered","by","its","quality","alone,","it","has","to","be","considered","in","terms","of","itsglobalimpact","in","the\ndataset.","On","the","other","hand,","this","result","also","shows","the","similarity","between","both","tasks","and\nwhere","the","confusion","sometimes","arises,","i.e.,","in","some","particular","cases","the","best","subgroup","can\nbe","also","the","best","rule.","An","example","of","this","would","be","a","dataset","that","is","very","large","(relatively","to\nthe","number","of","observations","covered","by","the","rule),","and","the","best","rule/subgroup","would","cover","a\nsmall","number","of","observations","compared","to","the","rule","formed","by","the","negative","set","of","that","rule,\ni.e.,D\n¬a\n,","as","a","similar","distribution","to\nˆ\nΘ\nd\n,","making\nˆ\nΘ\n¬a\n∼\nˆ\nΘ\nd\n.","Nonetheless,","this","similarity\ndecreases","in","the","case","of","larger","lists,","as","the","default","rule","will","always","represent","what","is","left","and\nin","a","subgroup","list","it","remains","constant","and","representing","what","we","consider","uninteresting.","The\nsame","result","can","be","obtained","for","regression","rule","lists.\n\nRobust","subgroup","discovery67\nF","Datasets","for","empirical","experiments\nThe","","datasets","","selected","","are","","commonly","","used","","in","","machine","","learning","","and","","were","","retrieved","","from\nUCI","(Dua","and","Graff,","2017),","Keel","(Alcal","́a-Fdez","et","al.,","2011),","MULAN","(Tsoumakas","et","al.,\n2011)","repositories.","The","datasets","used","for","nominal","and","numeric","targets","experiments","can","be\nseen","in","Table","7","and","8,","respectively.\nTable","","7:","","Nominal","","targets","","datasets:","","single-binary,","","single-nominal","","and","","multi-\nlabel.","","Dataset","","properties:","","number","","of{target","","variablesT;","","target","","labels|Y|;\nsamples|D|;","type","of","variables","(nominal/numeric)}.\nDatasetT|Y|","","","|D|V(nom./num.)\nsonar12208(0/60)\nhaberman12306(0/3)\nbreastCancer12683(0/9)\naustralian12690(0/14)\nTicTacToe12958(9/0)\ngerman121","000(13/7)\nchess123","196(36/0)\nmushrooms128","124(22/0)\nmagic1219","020(0/10)\nadult1245","222(8/6)\niris13150(0/4)\nbalance13625(0/4)\nCMC131","473(0/9)\npage-blocks155","472(0/10)\nnursery1512","960(7/1)\nautomobile16159(10/15)\nglass16214(0/10)\ndermatology16358(0/34)\nkr-vs-k11828","056(6/0)\nabalone1284","174(1/7)\nemotions62593(0/72)\nscene622407(0/294)\nflags72194(9/10)\nyeast1422417(0/103)\nbirds192645(/258)\ngenbase272662(1186/0)\nmediamill101243","907(0/120)\nCAL5001742502(0/68)\nCorel5k37425000(499/0)\n\n68Hugo","M.","Proen","̧ca","et","al.\nTable","8:","Numeric","targets","datasets:","single-numeric","and","multi-numeric.","Dataset\nproperties:{number","","of","","target","","variablesT;","","minimum","","and","","maximum","","target\nvalues","[min.,max.];","number","of","samples|D|;","number","of","type","of","variables","(nom-\ninal/numeric)}.\nDatasetT[min.;max.]|D|V(nom./num.)\nbaseball1[109;","6100]337(4/12)\nautoMPG81[9;","46.6]392(0/6)\ndee1[0.8;","5.1]365(0/6)\nele-11[80;","7675]495(0/2)\nforestFires1[0;","1091]517(0/12)\nconcrete1[3;","21]1030(0/8)\ntreasury1[29;","90]1049(0/15)\nwizmir1[29;","90]1461(0/9)\nabalone1[1;","29]4177(0/8)\npuma32h1[−0.0867;","0.0898]8192(0/32)\nailerons1[−0.0036;","0]13750(0/40)\nelevators1[0.012;","0.078]16599(0/18)\nbikesharing1[1;","977]17379(2/10)\ncalifornia1[14999;","500001]20640(0/8)\nhouse1[0;","500001]22784(0/16)\nedm2[−1;","1]154(0/16)\nenb2[6.01;","48.03]768(0/8)\nslump3[0;","78]103(0/7)\nsf13[0;","4]323(0/10)\nsf23[0;","8]1066(0/10)\njura3[0.135;","166.4]359(0/15)\nosales12[500;","795000]639(0/413)\nwq14[0;","5]1060(0/16)\noes9716[30;","48890]334(0/263)\noes1016[30;","64560]403(0/298)\n\nRobust","subgroup","discovery69\nG","Empirical","results","of","non-sequential","subgroup","discovery\nalgorithms\nThe","comparison","of","RSD","with","subgroup","set","discovery","algorithms","that","return","sets","(and","not\nlists)","can","be","seen","in","Table","9.\nTable","9:","Single","nominal","target","results","for","non-sequential","methods","plus","RSD.\nThis","includes","single-binary,","single-nominal,","respectively","separated","by","an","hori-\nzontal","line","in","the","table.","The","properties","of","the","datasets","can","be","seen","in","Table","7,\nand","are","ordered","by","number","target","variables,","number","of","classes,","and","number","of\nsamples,","in","this","order.","The","evaluation","measures","are{quality","of","the","subgroup\nset","swkl;","number","of","subgroups|S|;","and","average","number","of","conditions|a|}.","Note\nthat","FSSD","does","not","work","for","single-nominal","case","and","MCTS4DM","only","works\nfor","datasets","with","the","same","type","of","explanatory","variables","and","thus","the","empty\nvalues−.","*as","DSSD","does","have","a","stopping","criteria","the","maximum","number","of\nsubgroups","was","selected","as","the","number","of","subgroups","found","by","RSD,","and","total\noverlapping","subgroups","were","posteriorly","removed.\nDSSDMCTS4DMFSSDRSD\ndatasetsswkl|S|∗","|a|swkl|S|","|a|swkl|S|","|a|swkl|S|","|a|\nsonar0.3325−","","−","","−0.051430.43\n0.43\n0.4323\nhaberman0.08\n0.08\n0.08140.08\n0.08\n0.08130.041130.0411\nbreastCancer0.79630.81640.35690.82\n0.82\n0.8262\naustralian0.50330.54760.3315120.55\n0.55\n0.5552\ntictactoe0.5043−","","−","","−0.20530.87\n0.87\n0.87162\ngerman0.15\n0.15\n0.1545−","","−","","−0.106110.1443\nchess0.76114−","","−","","−0.344150.97\n0.97\n0.97172\nmushrooms0.9734−","","−","","−0.405201.00\n1.00\n1.00121\nmagic0.30403−","","−","","−0.063100.47\n0.47\n0.47694\nadult0.24315−","","−","","−0.001100.31\n0.31\n0.311034\navg.","rank1.81.72.0−","","−","","−3.01.92.91.2\n1.2\n1.22.51.1\niris1.44321.45\n1.45\n1.4543−","","−","","−1.4441\nbalance0.6393−","","−","","−","","−","","−","","−0.69\n0.69\n0.6993\nCMC0.18730.16204−","","−","","−0.25\n0.25\n0.2572\npage-blocks0.36193−","","−","","−","","−","","−","","−0.49\n0.49\n0.49213\nnursery0.9223−","","−","","−","","−","","−","","−1.63\n1.63\n1.63813\nautomobile0.8555−","","−","","−","","−","","−","","−1.25\n1.25\n1.2552\nglass1.55311.1256−","","−","","−1.92\n1.92\n1.9251\ndermatology1.85631.0296−","","−","","−2.11\n2.11\n2.1192\nkr-vs-k0.62133−","","−","","−","","−","","−","","−1.83\n1.83\n1.833513\nabalone0.53143−","","−","","−","","−","","−","","−0.74\n0.74\n0.74162\navg.","rank1.91.21.7−","","−","","−","","−","","−1.1\n1.1\n1.11.91.3\n\n70Hugo","M.","Proen","̧ca","et","al.\nH","Empirical","analysis","of","compression","gain\nIn","","this","","section","","we","","present","","a","","thorough","","comparison","","of","","the","","normalization","","termsβof","","RSD,\nwhereβ=","1","is","thenormalizedgain","andβ=","0","theabsolutegain.","RSD","is","executed","with","the\nsame","parameters","(beam","width,","number","of","cut","points","for","numerical","variables,","and","maximum\ndepth","of","search)","as","in","the","experiments","section,","i.e.,w\nb\n=","100,n\ncut\n=","5,d\nmax\n=","5.","The\ndifferent","types","of","gain","are","compared","for","all","the","benchmark","datasets","described","in","the","paper\nin","terms","of","their","compression","ratio","(defined","later)","in","Figure","9,","Sum","of","Weighted","Kullback-\nLeibler","divergency","(SWKL)","in","Figure","10,","and","number","of","rules","in","Figure","11.","The","compression\nratio","is","the","length","of","the","found","modelL(D,M)","divided","by","the","length","of","encoding","the","data\nwith","the","dataset","distribution","(a","model","without","subroups)L(D|\nˆ\nΘ\nd\n),","and","formally","it","has\nthe","following","form:\nL%","=\nL(D,M)\nL(D|\nˆ\nΘ\nd\n)\n(63)\nsonar\nhaberman\nbreastCancer\naustralian\nTicTacToe\ngerman\nchess\nmushrooms\nmagic\nadult\niris\nbalance\nCMC\npage-blocks\nnursery\nautomobile\nglass\ndermatology\nkr-vs-k\nabalone\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\ncompression","ratio\n=","1(normalized)\n=","0.5\n=","0","(absolute)\n(a)","Univariate","nominal","target.\nbaseball\nautoMPG8\ndee\nele-1\nforestFires\nconcrete\ntreasury\nwizmir\nabalone\npuma32h\nailerons\nelevators\nbikesharing\ncalifornia\nhouse\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\ncompression","ratio\n=","1(normalized)\n=","0.5\n=","0","(absolute)\n(b)","Univariate","numeric","target.\nFig.","9:","Compression","ratio","obtained","withβ=","0","(absolute","gain),β=","0.5,","and\nβ=","1","(normalized","gain).\nsonar\nhaberman\nbreastCancer\naustralian\nTicTacToe\ngerman\nchess\nmushrooms\nmagic\nadult\niris\nbalance\nCMC\npage-blocks\nnursery\nautomobile\nglass\ndermatology\nkr-vs-k\nabalone\n0.00\n0.25\n0.50\n0.75\n1.00\n1.25\n1.50\n1.75\n2.00\nSWKL","(normalized","per","|\nD\n|\n=","1(normalized)\n=","0.5\n=","0","(absolute)\n(a)","Univariate","nominal","target.\nbaseball\nautoMPG8\ndee\nele-1\nforestFires\nconcrete\ntreasury\nwizmir\nabalone\npuma32h\nailerons\nelevators\nbikesharing\ncalifornia\nhouse\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\n3.5\n4.0\nSWKL","(normalized","per","|\nD\n|\n=","1(normalized)\n=","0.5\n=","0","(absolute)\n(b)","Univariate","numeric","target.\nFig.","10:","Normalized","SWKL","obtained","withβ=","0","(absolute","gain),β=","0.5,","and\nβ=","1","(normalized","gain).\n\nRobust","subgroup","discovery71\n100\n200\n300\n400\n=","1(normalized)\n=","0.5\n=","0","(absolute)\nsonar\nhaberman\nbreastCancer\naustralian\nTicTacToe\ngerman\nchess\nmushrooms\nmagic\nadult\niris\nbalance\nCMC\npage-blocks\nnursery\nautomobile\nglass\ndermatology\nkr-vs-k\nabalone\n0\n10\n20\n30\nnumber","of","rules\n(a)","Univariate","nominal","target.\n100\n200\n300\n400\n=","1(normalized)\n=","0.5\n=","0","(absolute)\nbaseball\nautoMPG8\ndee\nele-1\nforestFires\nconcrete\ntreasury\nwizmir\nabalone\npuma32h\nailerons\nelevators\nbikesharing\ncalifornia\nhouse\n0\n10\n20\n30\nnumber","of","rules\n(b)","Univariate","numeric","target.\nFig.","11:","Number","subgroups","obtained","withβ=","0","(absolute","gain),β=","0.5,","and\nβ=","1","(normalized","gain).\nI","Empirical","analysis","of","the","influence","of","the","beam","search\nhyperparameters\nIn","this","section","we","present","a","thorough","comparison","of","the","influence","of","the","hyperparameters\nof","the","beam","search","of","RSD","on","its","results.","As","a","complete","search","over","the","whole","combination\nof","parameters","is","unfeasible","we","present","here","a","exploration","over","the","parameters","used","for","the\nexperimental","","comparison","","in","","the","","paper","","(w\nb\n=","","100,n\ncut\n=","","5,d\nmax\n=","","5),","","i.e.,","","we","","fix","","two\nof","the","parameters","","on","the","aforementioned","","values","and","then","proceed","to","change","the","selected\nparameter","of","interest,","and","we","do","this","for","all","the","3","parameters.","The","line","between","the","dots","of\nthe","same","color","does","not","represent","an","interpolation","and","is","merely","used","to","aid","visualization\nand","suggest","trends.\nNote","on","relative","compression.It","may","seem","that","the","values","of","the","relative","compression","remain\nconstant","but","that","is","an","illusion","due","to","the","scale","of","theyaxis.","As","the","compression","ratio","is\ngiven","by","the","division","of","large","values","(usually","above","the","thousands)","its","value","with","two","decimal\ndigits","can","be","misleading.","Nonetheless,","in","general,","when","zooming","over","the","figures","one","can\ndiscern","a","slight","improvement","(smaller","values)","for","larger","values","of","the","hyperparameters.\n246810\nmaximum","depth\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nrelative","compression\nCMC\nTicTacToe\nabalone\nadult\naustralian\nautomobile\nbalance\nbreastCancer\nchess\ndermatology\ngerman\nglass\nhaberman\niris\nkr-vs-k\nmagic\nmushrooms\nnursery\npage-blocks\nsonar\n(a)","Univariate","nominal","target.\n246810\nmaximum","depth\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\n1.0\nrelative","compression\nabalone\nailerons\nautoMPG8\nbaseball\nbikesharing\ncalifornia\nconcrete\ndee\nele-1\nelevators\nforestFires\nhouse\npuma32h\ntreasury\nwizmir\n(b)","Univariate","numeric","target.\nFig.","","12:","","Compression","","ratio","","obtained","","by","","varying","","the","","maximum","","search","","depth\nfixingw\nb\n=","100,n\ncut\n=","5","andβ=","1","(normalized","gain).","The","black","vertical","line\nrepresents","the","value","used","in","Experiments","section","of","the","paper.\n\n72Hugo","M.","Proen","̧ca","et","al.\n246810\nmaximum","depth\n1.0\n1.5\n2.0\n2.5\n3.0\n3.5\n4.0\naverage","conditions","per","subgroup\nCMC\nTicTacToe\nabalone\nadult\naustralian\nautomobile\nbalance\nbreastCancer\nchess\ndermatology\ngerman\nglass\nhaberman\niris\nkr-vs-k\nmagic\nmushrooms\nnursery\npage-blocks\nsonar\n(a)","Univariate","nominal","target.\n246810\nmaximum","depth\n1\n2\n3\n4\n5\naverage","conditions","per","subgroup\nabalone\nailerons\nautoMPG8\nbaseball\nbikesharing\ncalifornia\nconcrete\ndee\nele-1\nelevators\nforestFires\nhouse\npuma32h\ntreasury\nwizmir\n(b)","Univariate","numeric","target.\nFig.","13:","Average","number","of","conditions","per","subgroup","obtained","by","varying","the\nmaximum","","search","","depth","","fixingw\nb\n=","","100,n\ncut\n=","","5","","andβ=","","1","","(normalized\ngain).","The","black","vertical","line","represents","the","value","used","in","Experiments","section\nof","the","paper.\n10\n0\n10\n1\n10\n2\n10\n3\nbeam","width\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nrelative","compression\nCMC\nTicTacToe\nabalone\nadult\naustralian\nautomobile\nbalance\nbreastCancer\nchess\ndermatology\ngerman\nglass\nhaberman\niris\nkr-vs-k\nmagic\nmushrooms\nnursery\npage-blocks\nsonar\n(a)","Univariate","nominal","target.\n10\n0\n10\n1\n10\n2\n10\n3\nbeam","width\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\nrelative","compression\nabalone\nailerons\nautoMPG8\nbaseball\nbikesharing\ncalifornia\nconcrete\ndee\nele-1\nelevators\nforestFires\nhouse\npuma32h\ntreasury\nwizmir\n(b)","Univariate","numeric","target.\nFig.","","14:","","Compression","","ratio","","obtained","","by","","varying","","the","","beam","","width","","and","","fixing\nd\nmax\n=","","5,n\ncut\n=","","5","","andβ=","","1","","(normalized","","gain).","","The","","black","","vertical","","line\nrepresents","the","value","used","in","Experiments","section","of","the","paper.\n\nRobust","subgroup","discovery73\n2345678910\nnumber","cutpoints\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nrelative","compression\nCMC\nTicTacToe\nabalone\nadult\naustralian\nautomobile\nbalance\nbreastCancer\nchess\ndermatology\ngerman\nglass\nhaberman\niris\nkr-vs-k\nmagic\nmushrooms\nnursery\npage-blocks\nsonar\n(a)","Univariate","nominal","target.\n2345678910\nnumber","cutpoints\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\n1.0\nrelative","compression\nabalone\nailerons\nautoMPG8\nbaseball\nbikesharing\ncalifornia\nconcrete\ndee\nele-1\nelevators\nforestFires\nhouse\npuma32h\ntreasury\nwizmir\n(b)","Univariate","numeric","target.\nFig.","15:","Compression","ratio","obtained","by","varying","the","number","of","cut","points","and\nfixingw\nb\n=","100,d\nmax\n=","5","andβ=","1","(normalized","gain).","The","black","vertical\nline","represents","the","value","used","in","Experiments","section","of","the","paper\n\n74Hugo","M.","Proen","̧ca","et","al.\nReferences\nAgrawal","R,","Imieli","́nski","T,","Swami","A","(1993)","Mining","association","rules","between\nsets","of","items","in","large","databases.","In:","Acm","sigmod","record,","ACM,","vol","22,","pp\n207–216\nAlcal","́a-Fdez","J,","Fern","́andez","A,","Luengo","J,","Derrac","J,","Garc","́ıa","S,","S","́anchez","L,","Herrera\nF","","(2011)","","Keel","","data-mining","","software","","tool:","","data","","set","","repository,","","integration\nof","","algorithms","","and","","experimental","","analysis","","framework.","","Journal","","of","","Multiple-\nValued","Logic","&","Soft","Computing","17\nAngelino","","E,","","Larus-Stone","","N,","","Alabi","","D,","","Seltzer","","M,","","Rudin","","C","","(2017)","","Learning\ncertifiably","","optimal","","rule","","lists.","","In:","","Proceedings","","of","","the","","23rd","","ACM","","SIGKDD\nInternational","Conference","on","Knowledge","Discovery","and","Data","Mining,","ACM,\npp","35–44\nAoga","JO,","Guns","T,","Nijssen","S,","Schaus","P","(2018)","Finding","probabilistic","rule","lists\nusing","the","minimum","description","length","principle.","In:","International","Confer-\nence","on","Discovery","Science,","Springer,","pp","66–82\nAtzmueller","","M","","(2015)","","Subgroup","","discovery.","","Wiley","","Interdisciplinary","","Reviews:\nData","Mining","and","Knowledge","Discovery","5(1):35–49\nBelfodil","A,","Belfodil","A,","Kaytoue","M","(2018)","Anytime","subgroup","discovery","in","nu-\nmerical","","domains","","with","","guarantees.","","In:","","Joint","","European","","Conference","","on","","Ma-\nchine","Learning","and","Knowledge","Discovery","in","Databases,","Springer,","pp","500–\n516\nBelfodil","A,","Belfodil","A,","Bendimerad","A,","Lamarre","P,","Robardet","C,","Kaytoue","M,\nPlantevit","M","(2019)","Fssd-a","fast","and","efficient","algorithm","for","subgroup","set","dis-\ncovery.","In:","Proceedings","of","DSAA","2019\nBoley","M,","Goldsmith","BR,","Ghiringhelli","LM,","Vreeken","J","(2017)","Identifying","con-\nsistent","statements","about","numerical","data","with","dispersion-corrected","subgroup\ndiscovery.","Data","Mining","and","Knowledge","Discovery","31(5):1391–1418\nBosc","G,","Boulicaut","JF,","Ra","̈ıssi","C,","Kaytoue","M","(2018)","Anytime","discovery","of","a","di-\nverse","set","of","patterns","with","monte","carlo","tree","search.","Data","Mining","and","Knowl-\nedge","Discovery","32(3):604–650\nBreiman","L,","Friedman","J,","Stone","CJ,","Olshen","RA","(1984)","Classification","and","re-\ngression","trees.","CRC","press\nBringmann","B,","Zimmermann","A","(2007)","The","chosen","few:","On","identifying","valu-\nable","patterns.","In:","Seventh","IEEE","International","Conference","on","Data","Mining\n(ICDM","2007),","IEEE,","pp","63–72\nBudhathoki","K,","Vreeken","J","(2015)","The","difference","and","the","norm—characterising\nsimilarities","and","differences","between","databases.","In:","Proceedings","of","ECMLP-\nKDD’15,","Springer,","pp","206–223\nBudhathoki","K,","Boley","M,","Vreeken","J","(2020)","Discovering","reliable","causal","rules.\narXiv","preprint","arXiv:200902728\nCohen","WW","(1995)","Fast","effective","rule","induction.","In:","Proceedings","of","the","twelfth\ninternational","conference","on","machine","learning,","pp","115–123\nDe","Leeuw","AW,","Meerhoff","LA,","Knobbe","A","(2018)","Effects","of","pacing","properties","on\nperformance","in","long-distance","running.","Big","Data","6(4):248–261\n\nRobust","subgroup","discovery75\nDelahoz-Dominguez","","E,","","Zuluaga","","R,","","Fontalvo-Herrera","","T","","(2020)","","Dataset","","of\nacademic","performance","evolution","for","engineering","students.","Data","in","Brief","p\n105537\nDoshi-Velez","F,","Kim","B","(2018)","Considerations","for","evaluation","and","generalization\nin","interpretable","machine","learning.","In:","Explainable","and","Interpretable","Models\nin","Computer","Vision","and","Machine","Learning,","Springer,","pp","3–17\nDu","","X,","","Pei","","Y,","","Duivesteijn","","W,","","Pechenizkiy","","M","","(2020)","","Exceptional","","spatio-\ntemporal","behavior","mining","through","bayesian","non-parametric","modeling.","Data\nMining","and","Knowledge","Discovery","34(5):1267–1290\nDua","","D,","","Graff","","C","","(2017)","","UCI","","machine","","learning","","repository.","","URLhttp://\narchive.ics.uci.edu/ml\nDuivesteijn","W,","Knobbe","A","(2011)","Exploiting","false","discoveries–statistical","val-\nidation","","of","","patterns","","and","","quality","","measures","","in","","subgroup","","discovery.","","In:","","2011\nIEEE","11th","International","Conference","on","Data","Mining,","IEEE,","pp","151–160\nDuivesteijn","W,","Knobbe","A,","Feelders","A,","van","Leeuwen","M","(2010)","Subgroup","dis-\ncovery","meets","bayesian","networks–an","exceptional","model","mining","approach.","In:\n2010","IEEE","International","Conference","on","Data","Mining,","IEEE,","pp","158–167\nDuivesteijn","W,","Feelders","AJ,","Knobbe","A","(2016)","Exceptional","model","mining.","Data\nMining","and","Knowledge","Discovery","30(1):47–98\nFernandez","","A,","","Lopez","","V,","","del","","Jesus","","MJ,","","Herrera","","F","","(2015)","","Revisiting","","evolu-\ntionary","fuzzy","systems:","Taxonomy,","applications,","new","trends","and","challenges.\nKnowledge-Based","Systems","80:109–121\nFischer","J,","Vreeken","J","(2019)","Sets","of","robust","rules,","and","how","to","find","them.","In:\nJoint","European","Conference","on","Machine","Learning","and","Knowledge","Discovery\nin","Databases,","Springer,","pp","38–54\nFriedman","J,","Hastie","T,","Tibshirani","R","(2001)","The","elements","of","statistical","learning,\nvol","1.","Springer","series","in","statistics","New","York\nF","̈urnkranz","J","(1999)","Separate-and-conquer","rule","learning.","Artificial","Intelligence\nReview","13(1):3–54\nF","̈urnkranz","","J,","","Gamberger","","D,","","Lavraˇc","","N","","(2012)","","Foundations","","of","","rule","","learning.\nSpringer","Science","&","Business","Media\nGalbrun","E","(2020)","The","minimum","description","length","principle","for","pattern","min-\ning:","A","survey.","arXiv","preprint","arXiv:200714009\nGoldsmith","BR,","Boley","M,","Vreeken","J,","Scheffler","M,","Ghiringhelli","LM","(2017)","Un-\ncovering","structure-property","relationships","of","materials","by","subgroup","discovery.\nNew","Journal","of","Physics","19(1):013031\nG","̈onen","M,","Johnson","WO,","Lu","Y,","Westfall","PH","(2005)","The","bayesian","two-sample\nt","test.","The","American","Statistician","59(3):252–257\nGrosskreutz","H,","R","̈uping","S","(2009)","On","subgroup","discovery","in","numerical","domains.\nData","Min","Knowl","Discov","19(2):210–226\nGroßkreutz","","H,","","Paurat","","D,","","R","̈uping","","S","","(2012)","","An","","enhanced","","relevance","","criterion\nfor","more","concise","supervised","pattern","discovery.","In:","Proceedings","of","the","18th\nACM","SIGKDD","international","conference","on","Knowledge","discovery","and","data\nmining,","pp","1442–1450\nGr","̈unwald","","P,","","Roos","","T","","(2019)","","Minimum","","description","","length","","revisited.","","Interna-\ntional","Journal","of","Mathematics","for","Industry","11(1)\n\n76Hugo","M.","Proen","̧ca","et","al.\nGr","̈unwald","PD","(2007)","The","minimum","description","length","principle.","MIT","press\nH","̈am","̈al","̈ainen","W","(2012)","Kingfisher:","an","efficient","algorithm","for","searching","for","both\npositive","","and","","negative","","dependency","","rules","","with","","statistical","","significance","","mea-\nsures.","Knowledge","and","information","systems","32(2):383–414\nH","̈am","̈al","̈ainen","W,","Webb","GI","(2017)","Specious","rules:","an","efficient","and","effective","unify-\ning","method","for","removing","misleading","and","uninformative","patterns","in","associa-\ntion","rule","mining.","In:","Proceedings","of","the","2017","SIAM","International","Conference\non","Data","Mining,","SIAM,","pp","309–317\nH","̈am","̈al","̈ainen","","W,","","Webb","","GI","","(2019)","","A","","tutorial","","on","","statistically","","sound","","pattern\ndiscovery.","Data","Mining","and","Knowledge","Discovery","33(2):325–377\nHerrera","F,","Carmona","CJ,","Gonz","́alez","P,","Del","Jesus","MJ","(2011)","An","overview","on","sub-\ngroup","discovery:","foundations","and","applications.","Knowledge","and","information\nsystems","29(3):495–525\nHerrera","F,","Charte","F,","Rivera","AJ,","Del","Jesus","MJ","(2016)","Multilabel","classification.\nIn:","Multilabel","Classification,","Springer,","pp","17–31\nJeffreys","H","(1998)","The","theory","of","probability.","OUP","Oxford\nJin","N,","Flach","P,","Wilcox","T,","Sellman","R,","Thumim","J,","Knobbe","A","(2014)","Subgroup\ndiscovery","in","smart","electricity","meter","data.","IEEE","Transactions","on","Industrial\nInformatics","10(2):1327–1336\nKass","RE,","Raftery","AE","(1995)","Bayes","factors.","Journal","of","the","american","statistical\nassociation","90(430):773–795\nKl","̈osgen","W","(1996)","Explora:","A","multipattern","and","multistrategy","discovery","assis-\ntant.","In:","Advances","in","Knowledge","Discovery","and","Data","Mining,","pp","249–271\nKontkanen","P,","Myllym","̈aki","P,","Buntine","W,","Rissanen","J,","Tirri","H","(2005)","An","mdl\nframework","for","data","clustering.","Minimum","p","323\nKullback","S,","Leibler","RA","(1951)","On","information","and","sufficiency.","The","annals","of\nmathematical","statistics","22(1):79–86\nLavraˇc","N,","Flach","P,","Zupan","B","(1999)","Rule","evaluation","measures:","A","unifying","view.\nIn:","International","Conference","on","Inductive","Logic","Programming,","Springer,","pp\n174–185\nLavraˇc","N,","Kavˇsek","B,","Flach","P,","Todorovski","L","(2004)","Subgroup","discovery","with\ncn2-sd.","Journal","of","Machine","Learning","Research","5(Feb):153–188\nvan","Leeuwen","M","(2010)","Maximal","exceptions","with","minimal","descriptions.","Data\nMining","and","Knowledge","Discovery","21(2):259–276\nvan","Leeuwen","M,","Ukkonen","A","(2016)","Expect","the","unexpected–on","the","significance\nof","subgroups.","In:","International","Conference","on","Discovery","Science,","Springer,\npp","51–66\nLeman","","D,","","Feelders","","A,","","Knobbe","","A","","(2008)","","Exceptional","","model","","mining.","","In:\nJoint","","European","","conference","","on","","machine","","learning","","and","","knowledge","","discovery\nin","databases,","Springer,","pp","1–16\nLemmerich","F,","Atzmueller","M,","Puppe","F","(2016)","Fast","exhaustive","subgroup","discov-\nery","with","numerical","target","concepts.","Data","Mining","and","Knowledge","Discovery\n30(3):711–762\nLetham","B,","Rudin","C,","McCormick","TH,","Madigan","D,","et","al.","(2015)","Interpretable\nclassifiers","using","rules","and","bayesian","analysis:","Building","a","better","stroke","predic-\ntion","model.","The","Annals","of","Applied","Statistics","9(3):1350–1371\n\nRobust","subgroup","discovery77\nLi","W,","Han","J,","Pei","J","(2001)","Cmar:","Accurate","and","efficient","classification","based\non","multiple","class-association","rules.","In:","Data","Mining,","2001.","ICDM","2001,","Pro-\nceedings","IEEE","International","Conference","on,","IEEE,","pp","369–376\nLijffijt","J,","Kang","B,","Duivesteijn","W,","Puolamaki","K,","Oikarinen","E,","De","Bie","T","(2018)\nSubjectively","interesting","subgroup","discovery","on","real-valued","targets.","In:","2018\nIEEE","ICDE,","IEEE,","pp","1352–1355\nMa","BLWHY,","Liu","B","(1998)","Integrating","classification","and","association","rule","min-\ning.","","In:","","Proceedings","","of","","the","","fourth","","international","","conference","","on","","knowledge\ndiscovery","and","data","mining\nMakhalova","T,","Kuznetsov","SO,","Napoli","A","(2020)","Mint:","Mdl-based","approach","for\nmining","interesting","numerical","pattern","sets.","arXiv","preprint","arXiv:201114843\nMeeng","M,","Knobbe","A","(2011)","Flexible","enrichment","with","cortana–software","demo.\nIn:","Proceedings","of","BeneLearn,","pp","117–119\nMeeng","M,","Knobbe","A","(2020)","For","real:","a","thorough","look","at","numeric","attributes\nin","subgroup","discovery.","Data","Mining","and","Knowledge","Discovery","pp","1–55\nMeeng","M,","de","Vries","H,","Flach","P,","Nijssen","S,","Knobbe","A","(2020)","Uni-and","multivari-\nate","probability","density","models","for","numeric","subgroup","discovery.","Intelligent\nData","Analysis","24(6):1403–1439\nMielik","̈ainen","","T,","","Mannila","","H","","(2003)","","The","","pattern","","ordering","","problem.","","In:","","Euro-\npean","Conference","on","Principles","of","Data","Mining","and","Knowledge","Discovery,\nSpringer,","pp","327–338\nMononen","T,","Myllym","̈aki","P","(2008)","Computing","the","multinomial","stochastic","com-\nplexity","in","sub-linear","time.","In:","Proceedings","of","the","4th","European","Workshop\non","Probabilistic","Graphical","Models,","pp","209–216\nProen","̧ca","HM,","van","Leeuwen","M","(2020)","Interpretable","multiclass","classification","by\nmdl-based","rule","lists.","Information","Sciences","512:1372–1393\nProen","̧ca","HM,","Klijn","R,","B","̈ack","T,","van","Leeuwen","M","(2018)","Identifying","flight","delay\npatterns","using","diverse","subgroup","discovery.","In:","2018","IEEE","SSCI,","IEEE,","pp\n60–67\nProen","̧ca","","HM,","","Gr","̈unwald","","P,","","B","̈ack","","T,","","van","","Leeuwen","","M","","(2020)","","Discovering\noutstanding","","subgroup","","lists","","for","","numeric","","targets","","using","","mdl.","","arXiv","","preprint\narXiv:200609186\nQuinlan","JR","(1987)","Generating","production","rules","from","decision","trees.","In:","ijcai,\nCiteseer,","vol","87,","pp","304–307\nQuinlan","JR","(2014)","C4.","5:","programs","for","machine","learning.","Elsevier\nRissanen","J","(1978)","Modeling","by","shortest","data","description.","Automatica","14(5)\nRissanen","J","(1983)","A","universal","prior","for","integers","and","estimation","by","minimum\ndescription","length.","The","Annals","of","statistics","pp","416–431\nRouder","JN,","Speckman","PL,","Sun","D,","Morey","RD,","Iverson","G","(2009)","Bayesian","t\ntests","for","accepting","and","rejecting","the","null","hypothesis.","Psychonomic","bulletin\n&","review","16(2):225–237\nShannon","","CE","","(1948)","","A","","mathematical","","theory","","of","","communication.","","Bell","","system\ntechnical","journal","27(3):379–423\nShtar’kov","YM","(1987)","Universal","sequential","coding","of","single","messages.","Problemy\nPeredachi","Informatsii","23(3):3–17\n\n78Hugo","M.","Proen","̧ca","et","al.\nTsoumakas","G,","Spyromitros-Xioufis","E,","Vilcek","J,","Vlahavas","I","(2011)","Mulan:","A\njava","library","for","multi-label","learning.","Journal","of","Machine","Learning","Research\n12:2411–2414\nTukey","JW","(1977)","Exploratory","data","analysis,","vol","2.","Reading,","MA\nVan","Leeuwen","M,","Galbrun","E","(2015)","Association","discovery","in","two-view","data.\nIEEE","Transactions","on","Knowledge","and","Data","Engineering","27(12):3190–3202\nVan","Leeuwen","M,","Knobbe","A","(2011)","Non-redundant","subgroup","discovery","in","large\nand","complex","data.","In:","Joint","European","Conference","on","Machine","Learning","and\nKnowledge","Discovery","in","Databases,","Springer,","pp","459–474\nVan","Leeuwen","M,","Knobbe","A","(2012)","Diverse","subgroup","set","discovery.","Data","Min-\ning","and","Knowledge","Discovery","25(2):208–242\nVan","Leeuwen","M,","Ukkonen","A","(2013)","Discovering","skylines","of","subgroup","sets.","In:\nJoint","European","Conference","on","Machine","Learning","and","Knowledge","Discovery\nin","Databases,","Springer,","pp","272–287\nVreeken","","J,","","Van","","Leeuwen","","M,","","Siebes","","A","","(2011)","","Krimp:","","mining","","itemsets","","that\ncompress.","Data","Mining","and","Knowledge","Discovery","23(1):169–214\nWebb","GI","(2007)","Discovering","significant","patterns.","Machine","Learning","68(1):1–33\nYang","H,","Rudin","C,","Seltzer","M","(2017)","Scalable","bayesian","rule","lists.","In:","Proceed-\nings","of","the","34th","International","Conference","on","Machine","Learning-Volume","70,\nJMLR.","org,","pp","3921–3930\nZhang","X,","Dong","G,","Ramamohanarao","K","(2000)","Information-based","classification\nby","aggregating","emerging","patterns.","In:","IDEAL,","Springer,","pp","48–53\nZimmermann","A,","Nijssen","S","(2014)","Supervised","pattern","mining","and","applications\nto","classification.","In:","Frequent","Pattern","Mining,","Springer"],"doc11":["\n\nExploiting","Class","Similarity","for","Machine","Learning","with","Confidence","Labels","and\nProjective","Loss","Functions\nGautam","Rajendrakumar","Gare\nCarnegie","Mellon","University\nPittsburgh,","USA\ngautam.r.gare@gmail.com\nJohn","Michael","Galeotti\nCarnegie","Mellon","University\nPittsburgh,","USA\njgaleotti@cmu.edu\nAbstract\nClass","labels","used","for","machine","learning","are","relatable","to\neach","other,","with","certain","class","labels","being","more","similar","to\neach","","other","","than","","others","","(e.g.","","images","","of","","cats","","and","","dogs","","are\nmore","","similar","","to","","each","","other","","than","","those","","of","","cats","","and","","cars).\nSuch","","similarity","","among","","classes","","is","","often","","the","","cause","","of","","poor\nmodel","","performance","","due","","to","","the","","models","","confusing","","between\nthem.","","Current","labeling","techniques","fail","to","explicitly","capture\nsuch","similarity","information.","In","this","paper,","we","instead","exploit\nthe","similarity","between","classes","by","capturing","the","similarity","in-\nformation","with","our","novel","confidence","labels.","Confidence","la-\nbels","are","probabilistic","labels","denoting","the","likelihood","of","sim-\nilarity,","","or","","confusability,","","between","","the","","classes.","","","Often","","even\nafter","models","are","trained","to","differentiate","between","classes","in\nthe","feature","space,","the","similar","classes’","latent","space","still","re-\nmains","clustered.","","","We","view","this","type","of","clustering","as","valu-\nable","","information","","and","","exploit","","it","","with","","our","","novel","","projective\nloss","functions.","Our","projective","loss","functions","are","designed","to\nwork","with","confidence","labels","with","an","ability","to","relax","the","loss\npenalty","for","errors","that","confuse","similar","classes.","","We","use","our\napproach","to","train","neural","networks","with","noisy","labels,","as","we\nbelieve","noisy","labels","are","partly","a","result","of","confusability","aris-\ning","from","class","similarity.","","We","show","improved","performance\ncompared","to","the","use","of","standard","loss","functions.","We","conduct\na","detailed","analysis","using","the","CIFAR-10","dataset","and","show\nour","proposed","methods’","applicability","to","larger","datasets,","such\nas","ImageNet","and","Food-101N.\n1.","Introduction\nObjects","","are","","relatable","","to","","each","","other.","","","A","","cat","","bears","","more\nresemblance","to","a","dog","than","to","a","car.","","Such","distinctions","that\ncome","easily","to","us","humans","help","us","understand","even","unseen\nobjects,","but","such","similarities","can","also","be","the","cause","of","con-\nfusion.","Can","you","distinguish","rabbits","from","hares?","Current","AI\nsystems","are","not","immune","to","confusability","arising","from","class\nsimilarities.","[6]","and","[1]","have","shown","that","the","most","confused\nCross-entropy","LossLog-Projection","Loss\n0%","noise","ratio\n80%","noise","ratio\nFigure","1:The","t-SNE","plots","of","trained","models","on","CIFAR-10","using\nCross-entropy","and","Log-Projection","loss,","with","0%","and","80%","asym-\nmetric","noise","ratio","and","trusted","setM=","1k.","Although","cross-entropy\nattempts","to","learn","feature","embeddings","that","differentiate","classes,","we\nobserve","","that","","similar","","classes","","still","","end","","up","","relatively","","closer.","","","This\nsuggests","","thatAI","","models","","have","","a","","natural","","tendency","","to","","learn","","fea-\ntures","that","cluster","according","to","class","similarities.","","A","model","trained\ninstead","withour","proposed","Log-Projection","loss","exploits","rather\nthan","fight","this","natural","clustering,","irrespective","of","the","noise.\nclasses","on","the","ImageNet","dataset","follow","the","WordNet","hierar-\nchy,","implying","that","class","similarity","is","a","contributing","factor","to\npoor","model","performance.\nMachine","learning","systems","are","usually","not","provided","any\nsupervision","on","the","inter-class","similarity,","","as","the","typical","la-\nbels","","used","","for","","machine","","learning","","do","","not","","explicitly","","capture\nsuch","class","similarities.","This","leaves","the","models","to","implicitly\n1\narXiv:2103.13607v1","","[cs.CV]","","25","Mar","2021\n\nCross-entropy","LossLog-Projection","Loss\nAccuracy","(%)Accuracy","(%)\nEpochsEpochs\nFigure","","2:Image","","classification","","results","","on","","CIFAR-10","","with","","80%\nasymmetric","noise","ratio","and","trusted","setM=","1k.","","Labels:\nnoisy\ntrainevaluation.","","The","model","trained","using","confidence","labels","and\nLog-Projection","loss","auto-corrects,","whereas","the","cross-entropy","loss\nleads","to","model","overfitting","on","the","noisy","training","data.\ndiscern","","the","","class","","similarity","","information","","from","","the","","training\ndata","to","distinguish","between","classes,","leading","to","poor","perfor-\nmance.","Several","works","[23,","15],","have","looked","at","this","problem\nby","treating","it","as","a","regularization","issue.","","[23]","presented","soft\nlabels,","a","label","regularization","strategy","wherein","a","fixed","value\nis","assigned","to","all","the","non-target","classes,","but","using","soft","labels\nhas","been","shown","to","actually","lead","to","loss","of","class","similarity\ninformation","[18].\nWe","introduce","confidence","labels","that","explicitly","model","the\ninter-class","similarity","relations","and","thus","provide","models","the\nsupervision","to","learn","such","relations.","","Confidence","labels","are\nprobabilistic","labels","denoting","the","likelihood","of","similarity","(or\nconfusability)","among","the","classes.","We","define","them","as","a","vec-\ntor","","of","","(real","","or","","pseudo)","","probabilities","","of","","each","","possible","","la-\nbel,","which","is","analogous","to","a","neural-network","classifier’s","fi-\nnal","","softmax","","activations.","","","In","","the","","present","","work,","","we","","obtain\nconfidence","labels","on","a","per-class","basis,","either","though","heuris-\ntic","measures","or","by","using","pretrained","models.","","(Future","work\nwill","explore","applying","unique","confidence","labels","per","image\nor","even","per","pixel.)","","","Confidence","labels","are","an","easy","way","of\nintroducing","","a-priori","","inter-class","","similarity","","information","","into\nthe","neural","network","training,","which,","when","coupled","with","our\nnovel","projective","loss","functions,","encourages","both","preserving\nand","learning","the","naturally","occurring","class","distributions.\nMost","of","the","typical","machine","learning","objective","functions\ntry","to","learn","features","that","semi-equally","separate","all","the","classes\ninto","","different","","clusters","","in","","the","","latent","","feature","","space,","","ideally\npulling","apart","all","the","clusters","to","be","orthogonal","to","each","other.\nImplicit","in","prior","approaches","is","the","assumption","that","classes\nare","not","only","distinguishable,","but","that","with","the","right","features,\neach","class","is","equally","distinguishable","from","every","other","class.\nHowever,","these","systems","still","end","up","having","tight","clusters","for\nsimilar","classes,","which","is","suggestive","of","a","naturally-occurring\ndistribution","arising","from","inter-class","similarity","[18],","leading\nus","to","suspect","that","any","attempt","at","“overcoming”","these","natu-\nrally","occurring","distributions","may","be","futile.","","We","further","sus-\npect","that","modifying","the","label","space","to","be","orthogonal","to","each\nother","may","be","incorrect,","especially","when","working","on","open-\nset","classes","[2].","","A","model","that","is","trained","on","a","closed","set","of\nclasses","might","not","appropriately","fit","an","unseen","class","into","its\nlabel","space","when","operating","under","the","assumption","that","every\nclass","is","distinct.\nTo","preserve","the","naturally","occurring","class","similarity","dis-\ntribution,","we","introduce","projective","loss","functions","tailored","to\nwork","with","confidence","labels","with","an","ability","to","relax","the","loss\npenalty","","for","","similar","","classes.","","","Our","","projective","","loss","","functions\npreserve","and","reinforce","the","naturally","occurring","cluster","distri-\nbutions,","such","that","similar","classes","stay","closer","while","still","sep-\narating","dissimilar","classes.","In","contrast,","typical","loss","functions\n(e.g.","","","cross-entropy)","","impartially","","force","","all","","class","","clusters","","to\nmove","apart","(pushing","toward","orthogonality),","without","regard\nto","inter-class","similarity.","","Figure-1,","we","observe","that","similar\nclasses","(e.g.","cat","and","dog)","end","up","being","relatively","closer","ir-\nrespective","of","the","label","distribution","trained","upon.\nSimilarly,","","contrastive","","learning","","approaches","","[10]","","handle\ninter-class","similarity","by","trying","to","bring","the","feature","embed-\ndings","","of","","same-class","","instances","","closer","","while","","moving","","away\nfrom","feature","embeddings","of","different","classes.","This","approach\nis","predicated","on","the","assumption","of","inter-class","dissimilarity,\nthus","ignoring","the","existence","of","inter-class","similarity.","We","be-\nlieve","our","approach","is","the","first","to","explicitly","exploit","the","inter-\nclass","similarity.\nWe","test","our","approach","to","modeling","the","label","space","in","the\nchallenging","setting","of","noisy","labels","(mislabelled","data).","","We\nshow","that","the","mere","usage","of","our","projective","loss","combined\nwith","our","confidence","labels,","without","yet","incorporating","many\nof","the","other","standard","training-enhancement","techniques,","can\nachieve","comparable","performance","to","the","state-of-the-art","sys-\ntems","when","dealing","with","high","label","noise","stemming","form","in-\nter","class","similarity","(i.e.","asymmetric","or","semantic","noise","[13]).\nContributions:Our","","primary","","novel","","ideas","","are","","that","","(A)\nclass-similarity","","information","","should","","be","","exploited","","during\ntraining,","that","(B)","similar","classes","need","not,","and","should","not,","be\nwell","separated","in","latent","feature","space,","and","that","(C)","noisy","la-\nbels","often","occur","as","a","result","of","class","similarity,","which","would\nlead","","naturally","","occurring","","label","","noise","","to","","be","","asymmetrically\nclustered.\nOur","main","technical","contributions","are","(1)","Introducing","our\nnovel","","Confidence","","Labels","","as","","a","","new","","way","","of","","labelling","","data\nbased","on","probabilistic","labels","that","denote","the","likelihood","of\nsimilarity.","","(2)","Methods","for","the","creation","and","generation","of\nconfidence","labels","that","instil","class","similarity","prior","to","model\ntraining.","","","(3)","","A","","novel","","family","","of","","Projective","","loss","","functions\ntailored","to","handle","confidence","labels,","which","reinforce","natu-\nrally","occurring","class","similarity","distributions/relations.","","","(4)\nTraining","","mechanisms","","for","","working","","with","","confidence","","labels\nand","projective","loss","functions.\nOur","","simple,","","but","","effective,","","strategy","","explicitly","","exploits\n\nclass","similarity","information","for","training","more","robustly","with\nnoisy","labels.","It","achieves","significant","robustness","at","high","asym-\nmetric","noise","levels","on","CIFAR-10","[11]","comparable","to","current\nstate-of-the-art","methods,","while","being","a","straightforward","and\nsimple","","strategy","","and","","not","","increasing","","training","","time","","as","","com-\npared","","to","","current","","methods.","","","","We","","also","","show","","improvements\non","large-scale","datasets,","ImageNet","[7]","and","Food101-N","[12],\nwithout","yet","incorporating","many","of","the","“standard”","training-\nenhancement","techniques","such","as","AutoAugment","[5]","and","Co-\nsine","learning","rate","decay","with","warm","restarts","[16].\n2.","Related","Work\nSoft","labels,","which","are","k","sparse","labels","(k6=1)","have","been\nused","in","several","contexts","as","an","alternate","to","one-hot","labels.\n[23]","presented","soft","labels","as","a","label","regularization","strategy\nwherein","a","single","fixed","value","is","assigned","to","all","the","non-target\nclasses.","This","can","be","considered","as","a","special","case","of","our","pro-\nposed","confidence","labels,","where","the","inter","class","similarity","is\nunknown.","","[18]","showed","that","using","such","regularized","soft","la-\nbels","leads","to","the","loss","of","class","similarity","information.","","","(As\nwe","show","in","figure","1,","our","method","preserves","class","similarity\ninformation).","","[25]","made","use","of","the","network","predictions","as\nsoft","labels","for","their","domain","and","task","transfer","learning,","in","or-\nder","to","better","align","source","domain","labels","with","target","domain\nlabels.","","[29]","trained","models","to","match","human","rated","“scenic-\nness”","scores,","","viewed","as","soft","labels.","","","[24]","used","soft","labels\nto","encode","the","randomness","of","ageing","and","proposed","a","“soft\nsoftmax”","loss","function","to","work","with","these","soft","labels.","","As\ncompared","to","these","prior","works,","","our","confidence","labels","can\nbe","viewed","as","soft","labels","encoding","the","label","class","similarity\ninformation,","where","in","we","present","ways","to","exploit","this","simi-\nlarity","information","for","label-noise-robust","learning.\nNoisy","labels.Working","with","noisy","labels","has","been","ex-\ntensively","","researched","","[9,","","31,","","20,","","3,","","12,","","8],","","with","","the","","most\ncommon","techniques","attempting","to","determine","which","training\nsamples","are","wrongly","labeled","in","order","to","regularize","or","down-\nweight","the","loss","of","the","mislabelled","samples","[22,","21]","or","to","de-\ntermine","the","correct","label","by","using","a","trusted","set","of","correctly\nlabeled","data","[31,","27,","8].","Several","mentor-student","curriculum\napproaches","have","also","been","proposed","[9,","14]","where","the","men-\ntor","sets","a","curriculum","for","the","student","to","learn","for","working\nwith","noisy","labels.","","CleanNet","[12]","uses","transfer","learning","to\naddress","noisy","labels","by","learning","features","on","a","trusted","set.\n[22]","proposed","a","meta-learning","algorithm","that","uses","a","trusted\nset","to","reweight","noisy","samples\nThe","label","correction","approaches","have","been","show","to","work\nwell","","even","","at","","high","","noise","","levels","","[31,","","27].","","","[8]","","proposed","","a\nself-learning","approach","to","work","with","noise","labels,","wherein","a\nmodel","is","trained","to","classify","and","perform","label","correction","in\nan","iterative","manner.","[31]","presented","an","effective","technique","of\nDistilling","Effective","Supervision(DES)","using","a","small","high-\nquality","","“probe","","set”","","to","","weight","","and","","relabel","","noisy","","data","","for\nsupervised","training,","achieving","significant","improvements","in\naccuracy","","when","","working","","with","","high","","noise","","levels.","","","Unfortu-\nnately,","their","technique","requires","4x","more","training","time","com-\npared","","to","","normal","","training.","","","[27]","","presented","","a","","meta","","learning\nstrategy","","to","","dynamically","","learn","","soft","","labels.","","","It","","can","","be","","seen\nthat","the","instance","labels","that","emerge","from","their","learning","ap-\nproach","have","the","same","structure","as","the","confidence","labels","that\nwe","independently","developed","and","propose.","","Their","approach\nis","one","of","learned","label","refinement,","for","which","they","continue\nto","use","standard","cross-entropy","loss","when","training","and","learn-\ning/refining","their","soft","labels.\nIn","","certain","","contexts","","it","","may","","be","","dangerous","","to","","automati-\ncally","","refine","","or","","relabel","","the","","training","","data,","","especially","","using\nthe","primary-training","error","metric.","In","particular,some","safety\ncritical","applications","such","as","medicine","or","autonomous","ve-\nhicles","","may","","contain","","rare","","but","","important","","outliers","","that","","must\nbe","preserved,","even","if","they","statistically","appear","to","have","been\nmislabeled.We","argue","that","preserving","outlier","labels","(even\nif","","there","","is","","uncertainty","","as","","to","","whether","","they","","were","","correctly\nlabeled)","is","important","for","long-tail","real","world","distributions,\nwhere","there","will","be","correctly","labelled","outliers","such","as","pa-\ntients","","with","","rare","","diseases","","that","","confound","","their","","symptoms,\ndowned","power","lines","on","the","road","ahead,","or","anything","under\nthe","category","of","“if","it","can","happen,","it","will.”\nRobust","loss","functions.Previously","many","loss","functions\nhave","been","designed","that","introduce","some","form","of","regulariza-\ntion","for","robust","learning.","","[15]","presented","Focal","Loss,","which\ndownweights","the","loss","of","correctly","classified","samples","such\nthat","the","learning","can","take","place","for","the","misclassified","sam-\nples.","(Our","proposed","relaxation","of","the","loss","can","be","viewed","in\nthe","same","spirit.)","","[21]","apply","a","loss","correction","for","scenarios\nwhere","the","inter-class","corruption","probability","is","known.","Sim-\nilar","to","our","approach,","[17]","designed","a","loss","function","more","ca-\npable","of","dealing","with","noisy","labels.","[28]","designed","a","symmet-\nric","cross-entropy","loss","to","address","the","shortcoming","of","cross-\nentropy","loss","wherein","it","overfits","on","easy","classes","and","under-\nlearns","on","hard","classes,","and","they","applied","their","approach","to\nwork","with","noisy","labels.","","Our","proposed","projective","loss","func-\ntions","exploit","the","class","similarity","relation","for","robust","learning.\n[10]","designed","a","loss","function","which","acts","on","the","feature\nembeddings","such","that","feature","embedding","of","objects","belong-\ning","to","same","class","are","closer","than","feature","embeddings","of","dif-\nferent","class","objects.","Our","loss,","takes","this","a","step","further","where\nin","addition","to","making","same","class","embedding","closer","we","make\nthe","feature","embeddings","of","similar","classes","(not","same,","ex","cat\n&","dog)","closer","than","those","of","dissimilar","classes","(such","as","car).\nIn","","contrast","","to","","the","","prior","","work,","","our","","approach","","is","","simple,\ndoes","","not","","increase","","training","","time,","","and","","robustly","","learns","","from\nnoisy","labels","automatically","without","resorting","to","label","refine-\nment","or","relabeling.","","Although","our","approach","benefits","from","a\ntrusted","probe","set,","it","still","learns","effectively","when","all","training\ndata","is","uncertain.","","Our","method","does","not","require","any","addi-\ntional/supplement","learning,","hyper-parameter","tuning,","etc.\n\n3.","Proposed","Method\n3.1.","Confidence","Labels\nWe","define","confidence","labels","as","probabilistic","labels","denot-\ning","the","likelihood","of","similarity","(or","confusability)","among","the\nclasses.","","It","can","be","viewed","as","a","probability-distribution","vec-\ntor","of","the","class","similarity","scores","of","the","object","across","labeling\nclasses,","with","vector","elements","that","sum","to","one.\nTo","introduce","class","similarity","prior","to","model","training,","we\npropose","to","replace","one-hot","labels","with","these","confidence","la-\nbels.","","For","simplicity","when","working","with","typical","one-hot","la-\nbeled","images,","we","currently","constrain","all","instances","of","a","class\nto","have","the","same","confidence","label,","so","that","each","one-hot","vec-\ntor","has","a","corresponding","confidence","label.","Nothing","prevents\nus","from","assigning","independent,","unique","confidence","labels","to\nevery","image,","more","like","the","instance","labels","proposed","in","[27],\nbut","we","argue","that","high-quality","per-image","confidence","labels\nare","better","derived","from","the","input","of","human","experts.\nWe","propose","the","following","simple","methodology","of","defin-\ning","per-class","confidence","labels","based","a","one-hot","labeled","set.\nConsider","the","case","involvingClabel","classes,","for","two","classes\naandbunder","consideration(a,b∈C),","we","assign","a","simi-\nlarity","scoreSbased","on","a","heuristic","H","as:\nS\nab\n=H(a,b)(1)\nNext","we","define","the","similarity","groupG\na\nfor","classA,","as\nthe","classes","which","have","a","similarity","scoreSgreater","than","a\nthresholdτ.\nG\na\n=","[b∈CifS\nab\n>","τ](2)\nWe","define","the","confidence","scoreC\na\n(b)ofafor","classbas:\nC\na\n[b]","=\n{\nsoftmax(S\nab\n),ifb∈G\na\n0,otherwise\n(3)\nWhere","the","softmax","is","taken","over","the","similarity","groupG\na\n.\nConfidence","labelTof","classais","the","collection","of","these\nconfidence","scoresC\na\n.\nThe","heuristicHcan","be","intuitively","defined","as","done","in","sec-\ntion","4.1","or","determined","using","pretrained","models,","as","shown","in\nsection","4.2.2.\nIt","","needs","","to","","be","","noted","","that","","the","","spread","","of","","the","","confidence\nscore","","is","","restricted","","to","","a","","small","","group","","of","","similar","","classes,","","as\nconfusion-inducing","class","similarity","general","exists","between\na","small","subset","of","classesk[6].","So","confidence","labels","are","gen-\nerallyksparse","labels,","but","they","can","be","though","of","as","a","generic\nlabel","","definition.","","","Whenk=","1they","","become","","normal","","one-\nhot","labels,","wherein","the","class","under","consideration","is","totally\ndissimilar","from","every","other","class.","We","term","this","ashard","con-\nfidence","labels.","","On","the","other","hand","the","soft","labels","of","[23]","is\nthe","confidence","label","wherein","the","class","under","consideration\nis","equally","similar","to","all","other","classes.\n3.2.","Projective","Loss","functions\nWe","present","a","family","of","projective","loss","functions","tailored\nfor","confidence","labels,","that","reinforce","the","naturally","occurring\nclass","similarity","with","the","ability","to","relax","the","loss","penalty","for\nsimilar","classes.","The","projective","loss","function","is","based","on","the\ndot","","product","","a.k.a.","","","the","","inner","","product,","","such","","that","","it","","tries","","to\nmaximize","","the","","model","","predictionP(φ)projection","","onto","","the\nconfidence","labelT,","whereφis","the","model","parameters","which\nwe","want","to","optimize.","","","We","introduce","a","relaxation","function\nr(t)which","scales","the","target","labels","in","order","to","relax","the","loss\npenalization","","for","","class","","labels","","which","","are","","less","","confident","","and\nthus","give","the","model","the","added","flexibility","to","make","predictions\nthat","deviate","from","the","labeled","“truth,”","which","is","useful","when\nworking","with","noisy","labels.\nProjection","(P)","Loss:\nL\nP\n=max(0,<","T\nr\n,T\nr\n>−<","T\nr\n,P(φ)>)(4)\ndL\nP\ndφ\n=−<","T\nr\n,\ndP(φ)\ndφ\n>(5)\nLog-Projection","(LP)","Loss:\nL\nLP\n=max(0,log(\n<T\nr\n,T\nr\n>\n<T\nr\n,P(φ)>\n))\n(6)\ndL\nLP\ndφ\n=−\n1\n<T\nr\n,P(φ)>\n<","T\nr\n,\ndP(φ)\ndφ\n>(7)\nwhere,T\nr\n=r(T)(8)\nTo","ensure","numerical","stability","a","small","constant","(1e−08)\nis","added","to","the","loss.\n3.2.1","","","","Loss","Visualization\nFigure-3","depicts","the","projection","loss","function’s","relaxation","re-\ngion","","around","","the","","relaxed","","target","","confidence","","labelT\nr\n.","","","This\ngives","the","model","the","added","flexibility","to","classify","the","object\nas","","either","","more","","like","","class-A","","or","","more","","like","","class-B,","","without\nincurring","any","loss","penalty.\nFigure","3:Projection","loss","relaxation","visualization.\nWe","use","two","relaxation","functions,","first","the","L2-norm","func-\ntion","for","training","samples","that","might","be","inaccurately","labeled,\nand","second","no-relaxation","for","the","non-noisy","trusted","set.\n\nr\nnoisy\n(t)","=||t||\n2\nt(9)\nr\ntrusted\n(t)","=t(10)\nThe","relaxation","lets","the","loss","of","closely","aligned","train","sam-\nples","go","to","zero,","allowing","only","the","gradients","of","the","samples\nwhich","are","clearly","misclassified","to","pass","through.","This","can","be\nrelated","to","the","way","Focal","Loss","and","Symmetric","cross-entropy\nloss","down-weight/regularize","the","gradients","of","the","correctly\nclassified","samples","[15,","28].","The","relaxation","does","raise","a","case\nwhere","the","loss","goes","to","zeros","and","no","further","learning","can","hap-\npen.","","This","could","be","addressed","by","modifying","the","relaxation\nfunctionτ(e.g.","","introducing","a","scaling","parameter).","","We","do\nnot","evaluate","this","case","here,","leaving","it","for","future","exploration.\nOur","projective","loss","function","reinforces","that","classes","of","the\nsame","similarity","group","remain","close","in","latent","feature","space\nwhile","","separating","","dissimilar","","classes.Unlike","","typical","","loss\nfunctions","like","cross-entropy","loss","which","impartially","forces\nall","class","clusters","to","move","apart","(ideally","to","be","orthogonal),\nwithout","regard","to","inter","class","similarity.","Figure-1,\nUsing","the","L2-norm,","less-certain","target","confidence","labels\n(with","lower","maximum","confidence","scores)","are","shrunk","sub-\nstantially","and","subsequently","the","model","is","meagerly","penalized\nif","swaying","away","from","that","training-data’s","uncertain","target\nconfidence","label.","","Similarly,","confidence","labels","with","higher\nconfidence","scores","are","shrunk","by","a","small","factor,","","so","subse-\nquently","","the","","model","","is","","heavily","","penalized","","if","","swaying","","away\nfrom","that","training-data’s","confident","target","label.\nThe","Projection","loss","can","be","related","to","Cosine-Embedding\nLoss,","","but","","unlike","","cosine","","embedding","","which","","tries","","to","","bring\ncloser","the","embeddings","of","samples","belonging","to","a","class","and\npull","apart","the","embedding","of","different","classes,","projection","loss\nworks","on","the","label","space,","wherein","it","tries","to","closely","align","the\nmodel","prediction","class","to","more-confident","(or","typical","one-hot\nencoded)","confidence","labels,","with","the","added","ability","to","relax\nthe","loss","penalty","for","uncertain","confidence","labels.\n3.2.2","","","","Repurposed","Loss","functions\nWe","can","also","repurpose","existing","loss","functions","to","work","with\nconfidence","labels.","For","instance,","the","cross-entropy","loss","(CE)\ncan","be","repurposed","to","work","with","confidence","labels","by","using\nthe","relaxed","confidence","labelT\nr\ninstead","of","normal","one-hot\nlabels,","which","we","termprojection","cross-entropy","(pCE)","loss.\nSimilarly,","","substitution","","ofT\nr\nfor","","one-hot","","labels","","can","","allow\nother","loss","functions","such","as","L1,","MSE,","Focal","Loss,","etc.","","to\nalso","use","confidence","labels.\nL\npCE\n=−\n∑\nT\nr\nlog(P(φ))(11)\n4.","Experiments\nWe","","conduct","","a","","series","","of","","experiments","","on","","the","","CIFAR10\ndataset.","","","We","","begin","","by","","testing","","various","","loss","","functions","","with\nconfidence","labels","in","section","4.1.2,","followed","by","experiments\nevaluating","our","approach","on","various","noise","settings","in","section\n4.1.3.","","","We","","then","","go","","beyond","","CIFAR10,","","performing","","experi-\nments","on","large-scale,","real-world","datasets","in","section","4.2.\n4.1.","CIFAR10","noisy","label","experiments\nThe","","CIFAR10","","[11]","","dataset","","consists","","of","","10","","class","","labels\nwith","certain","class","labels","more","similar","than","others.","We","man-\nually","defined","similarity","scores","for","the","class","labels","following\nthe","same","class-similarity","groupsG\na\nas","[13,","19],","","which","is\nTRUCK⇔AUTOMOBILE,","BIRD⇔AIRPLANE,","DEER\n⇔HORSE,","CAT⇔DOG","and","FROG⇔SHIP.","We","use","the\nconfidence","scoreC\na\n(a)","=","0.6for","the","correct","classaand\nC\na\n(b)","=","0.4for","the","similar","classb,","for","all","CIFAR10","exper-\niments","in","this","paper","unless","indicated","otherwise.\nSimilar","to","[31],","we","make","use","of","a","small","trusted","setM\nwhich","is","a","subset","of","the","training","datasetN,","whereM⊂N\nandM","<<","N.","","We","are","confident","of","thehigh","quality","labels\ninM,","so","we","assign","higher","confidence","values","to","the","trusted\nset,C\na\n(a)","=","0.95for","the","correct","classaandC\na\n(b)","=","0.05\nfor","the","similar","classb.","","However,","this","subset","is","not","used","for\nany","loss","reweighting","or","label","correction","as","conventionally\nused","in","similar","prior","setups","[31];","rather,","we","simply","include\nthe","more","confidentMas","part","of","the","largerNtraining","mix.\nAn","initial","(unreported)","brief","ablation","study","on","labeling\nbinary","relations","indicated","that","confidence","scores","of","0.6","vs\n0.4","work","well","for","noisy","labels","and","that","0.95","vs","0.05","work\nwell","","for","","high-quality","","labels.","","","Accordingly,","","we","","used","","those\nvalues","in","the","experiments","presented","here.\nWe","follow","the","similar","setup","of","symmetric","and","asymmet-\nric","noise","for","the","CIFAR10","dataset","as","conventionally","carried\nout","in","[13,","21,","31].","","Label","transitions","are","parameterized","by\nr∈[0,1]such","that","true","class","and","wrong","class","have","prob-\nability","of1−randr,","","respectively.","","","For,","","the","asymmetric\nnoise","the","wrong","class","is","limited","to","the","similarity","groupG\na\n,\nwhereas","for","the","symmetric","noise,","all","classes","are","likely.","","In\nthe","case","of","confidence","labels,","when","the","wrong","class","is","se-\nlected,","","the","confidence","label","of","the","wrong","class","is","used","in\nplace","of","the","correct-class","confidence","label.\nWe","note","that","our","experiment","sets","up","confidence","labels","to\nbe","less","informative","than","one","hot","labels","for","the","correctness\nof","the","class.","","For","a","noise","levelr,","the","cross-entropy","loss","has\n(1−r)Nsamples","with","high","quality","correct","labels","whereas\nour","projective","loss","has","onlyMsamples","with","high-quality\ncorrect","labels","and(1−r)N−Mlow-quality","correct","labels.\n4.1.1","","","","Implementation","details","and","experimental","setup\nFor","all","the","experiments","on","the","CIFAR10","dataset,","we","evalu-\nate","using","ResNet-34","implemented","with","PyTorch","and","trained\n\nusing","the","stochastic","gradient","descent","algorithm","[4]","with","a\nweight","decay","of5e−4,","set","with","an","initial","learning","rate","of\n0.2.","","The","model","is","trained","on","4","Nvidia","GeForce","GTX","1080\nTi","GPUs","with","a","batch","size","of","256","for","gradient","update","com-\nputation.","","The","ReduceLRonPlateau","learning-rate","scheduler\nwas","used","which","reduces","the","learning","rate","by","a","factor","(0.5)\nwhen","the","performance","accuracy","plateaus,","with","patience","5.\nThe","model","is","trained","for","200","epochs.","","For","the","final","evalua-\ntion,","we","pick","the","best","model","with","the","highest","test-set","accu-\nracy.","","We","report","mean","and","standard","deviation","of","the","scores\nfrom3","independent","runsfor","all","the","experiments,","similar","to\n[31].","We","follow","[10]","for","implementing","ResNet\n1\n.\nTo","present","a","fair,","","base-line","comparison,","","we","do","not","use\nany","advanced","augmentation","techniques","such","as","AutoAug-\nment","[5]","apart","from","standard","RandomResizedCrop","(resized\nto","","32x32)","","and","","RandomHorizonalFlip,","","nor","","do","","we","","use","","any\nspecialized","learning","rate","scheduler","such","as","Cosine","learning\nrate","decay","with","warm","restarts.","","These","and","similar","methods\nhave","been","shown","to","boost","the","scores","further","in","similar","ex-\nperimental","setups","[31],","and","we","suspect","our","methods","would\nlikewise","benefit","from","future","use","of","such","advanced","augmen-\ntation","and","learning-rate","methodologies.\n4.1.2","","","","Comparing","loss","functions","for","Confidence","labels\nWe","","compare","","various","","standard","","loss","","functions","","under","","the\nasymmetric","","noise","","setting.","","","We","","compare","","the","","performance\nof","","cross-entropy","","(CE)","","using","","one-hot","","labels","","with","","L1","","loss,\nMean-squared-error","(MSE)","loss,","repurposed","cross-entropy\nloss","","(pCE)","","and","","the","","proposed","","projection","","(P)","","loss","","and","","log-\nprojection","(LP)","loss,","all","using","the","confidence","labels","instead\nof","one-hot","labels,","with","a","trusted","setMof","1k,","signifying","100\nhigh","quality","confidence","labels","for","each","of","the","10","class.\nTable","1","shows","the","validation","accuracy","for","the","various","loss\nfunctions.","We","observe","at","high","noise","ratio","of","0.8","that","our","pro-\nposed","projective","loss","functions","performs","better","by","a","large\nmargin,","with","the","log-projective","loss","function","performing","the\nbest","for","all","noisy","settings.","","For","the","no","noise","(i.e.","","0","noise","ra-\ntio),","cross-entropy","loss","performs","better,","which","is","evaluated\nin","the","following","section","4.1.3.\n4.1.3","","","","Noisy","label","experiments\nWe","","evaluate","","our","","log-projection","","loss","","for","","the","","various","","noise\nratios","using","trusted","setMof","10K,","1K","and","0.1K,","and","we\ncompare","its","performance","with","cross-entropy","loss.\n4.1.4","","","","Asymmetric","noise\nAsymmetric-noise","","results","","are","","presented","","in","","Table","","2.","","","","We\nobserve","that","the","log-projection","loss","does","significantly","bet-\nter","compared","to","the","baseline","cross-entropy","loss","when","using\n1\nhttps://github.com/HobbitLong/SupContrast\ntrusted","setMof","10k","and","1k.","","With","the","trusted","set","of","0.1K\nthe","performance","drops","below","that","of","cross-entropy","loss","ex-\ncept","for","0.8","noise","ratio","where","it","is","better","than","cross-entropy.\nThis","suggests","that","the","log-projection","loss","needs","a","number","of\nhigh","confidence","labels","to","be","robust","to","noise.\nNot","surprisingly,","for","a","noise","ratio","of","zero","cross-entropy\nloss","performs","the","best.","We","observe","that","the","performance","of\nthe","projection","loss","at","zero","noise","ratio","is","far","worse","compared\nto","the","0.2","noise","ratio.","","It","may","be","that","exclusive","use","of","high\nconfidence","labels","defeats","the","similarity-preserving","capabil-\nities","of","our","approach,","resulting","in","typical","spreading","of","the\nnaturally","occurring","distribution.","","So,","as","the","ratio","of","higher\nconfidence","labels","is","initially","reduced","from","100%,","our","accu-\nracy","actually","improves","over","the","zero","noise","ratio.\nThe","","training","","and","","test","","accuracy","","curves","","for","","the","","log-\nprojection","and","cross-entropy","trained","models","are","shown","in\nfigure","","2,","","at","","0.8","","noise","","ratio","","with","","trusted","","setM=","","1k.","","","We\nsee","that","the","log-projection","model","initially","starts","to","overfit","on\nthe","noisy","training","set","but","gradually","learns","from","the","higher-\nconfidence","labels","which","features","boost","accuracy,","","laying","a\nfoundation","on","which","it","can","learn","additional","relevant","features\nfrom","the","less-confident","labels","and","achieve","higher","validation\naccuracy,","ultimately","“under","fitting”","on","the","noisy","parts","of","the\ntraining","set.","","On","the","other","hand,","cross-entropy","loss","consis-\ntently","","overfits","","on","","the","","noisy","","train","","set.","","","[30]","","found","","in","","their\nexperiments","that","CNN","models","always","overfit","on","the","noisy\nlabels,","andour","log-projection","loss","is","a","potential","solution\nto","this","pervasive","problem","of","overfitting","to","noisy","labels.\nFigure","1","shows","t-SNE","plots","[26]","of","the","trained","models\non","","the","","validation","","set,","","as","","done","","in","","[26].","","","We","","observe","","that\nthe","cross-entropy-loss","trained","model","with","80%","noise,","which\noverfit","on","the","noisy","training","set,","actually","learnt","feature","em-\nbeddings","that","cluster","similar","class","groups","together.","","On","the\nother","hand,","when","operating","with","0%","noise","the","cross-entropy\nmodel","swayed","from","this","natural","distribution,","though","we","can\nstill","see","similar","classes","are","relatively","closer.","","This","suggests\nthat","all","models","may","have","a","natural","tendency","to","learn","features\nthat","cluster","according","to","class","similarity.","Our","proposed","Log-\nProjection","loss","uniquely","embraces","this","natural","distribution\nwhen","training","models,","irrespective","of","the","noise","setting.\n4.1.5","","","","Symmetric","noise\nSymmetric-noise","results","are","presented","in","Table","3.","","Our","log-\nprojection","loss","was","not","designed","for","symmetric","noise,","and\nwe","observe","that","it","does","not","do","as","well","as","it","did","in","the","asym-\nmetric","noise","case.","Log-projection","loss","does","achieve","compa-\nrable","(often","better)","performance","to","baseline","cross-entropy\nloss","when","using","a","large","ratio","of","high","confidence","labels","(M\n=","10k).","","It","may","be","that","our","projection","loss","struggles","to","ex-\nploit","class","similarity","relations","in","uninformative","symmetric\nnoise,","","requiring","a","large","number","of","high","confidence","labels\nto","discover","and","utilize","the","underlying","similarities.","Google’s\n\nTable","1:","","Validation","accuracy","on","CIFAR10","with","Asymmetric","noise","for","various","loss","functions.Mdenotes","the","number","of\ntrusted","(probe)","data","used.1kindicates","100","high","quality","image","labels","per","class.\nLoss","FunctionMNoise","ratio\n00.20.40.8\nCE-RN34-93.99±0.4790.13±0.1585.81±0.9415.18±1.48\npCE-RN341k92.04±0.4288.50±0.4772.67±0.9425.35±3.45\nL1-RN341k90.63±0.4689.80±0.4475.51±5.3425.13±1.74\nMSE-RN341k88.57±1.9384.74±2.9675.25±7.4221.02±0.10\nP-RN341k77.66±0.8886.58±5.4878.81±1.0969.33±7.47\nLP-RN341k90.53±0.1890.60±0.2289.24±0.0978.13±0.73\nTable","2:","Validation","accuracy","on","CIFAR10","with","Asymmetric","noise.Mdenotes","the","number","of","trusted","(probe)","data","used.0.1k\nindicates","10","image","per","class.\nMethodM\nNoise","ratio\n00.20.40.8\nDES","[31]0.1k96.896.5±0.294.9±0.179.3±2.4\nCE-RN34-94.56±0.1690.13±0.1585.81±0.9415.18±1.48\nLP-RN3410k90.26±0.3892.37±0.4891.97±0.5088.51±1.02\nLP-RN341k90.53±0.1890.60±0.2289.24±0.0978.13±0.73\nLP-RN340.1k90.49±0.6288.25±0.4681.92±2.1430.18±5.27\nlabel-weighting/relabeling","approach","[31],","however,","was","the\nbest","performer","for","symmetric","label","noise.\n4.2.","Large-scale","real-world","experiments\nIn","","this","","section,","","we","","experiment","","on","","Food101N","","and","","Im-\nageNet","","datasets,","","which","","are","","both","","large-scale","","datasets.","","","We\nshow","two","approaches","of","our","method:","(1)","a","way","to","automati-\ncally","generate","confidence","labels","using","pretrained","models","in\norder","to","refine","existing","model","performance,","in","section","4.2.2\nand","(2)","we","show","applicability","of","our","approach","in","a","straight-\nforward","setup","without","the","need","of","generating","confidence","la-\nbels","by","directly","operating","on","one-hot","labels,","in","section","4.2.3.\n4.2.1","","","","Implementation","details","and","experimental","setup\nFor","both","the","experiments","on","ImageNet","and","Food101N,","we\nevaluate","using","ResNet-50","implemented","with","PyTorch","and\ntrained","using","the","stochastic","gradient","descent","algorithm","[4]\nwith","a","weight","decay","of5e−4,","set","with","an","initial","learning\nrate","of0.005and0.0005for","Food101N","and","ImageNet","ex-\nperiments","respectively.","","The","model","is","trained","on","10","Nvidia\nGeForce","","RTX","","2080","","Ti","","GPUs","","with","","a","","batch","","size","","of","","1000\nfor","gradient","update","computation.","","The","ReduceLRonPlateau\nlearning-rate","scheduler","was","used","which","reduces","the","learn-\ning","rate","by","a","factor","(0.5)","when","the","performance","accuracy\nplateaus","","on","","the","","test","","set,","","with","","patience","","1.","","","","The","","model","","is\ntrained","for","50","and","20","epochs","for","Food101N","and","ImageNet\nexperiments","respectively.","","For","the","final","evaluation,","we","pick\nthe","best","model","with","the","highest","test","set","accuracy.","Similar","to\nexperiments","in","section","4.1","we","only","make","use","of","normal","aug-\nmentaion","with","image","resized","to","224x224","and","do","not","make\nuse","of","other","standard","training-enhancement","techniques.\n4.2.2","","","","Fine-tuning","existing","models","training\nAn","automated","way","of","generating","confidence","labels","is","to","use\nthe","outputs","of","the","existing","trained","neural","network","architec-\ntures","by","making","use","of","the","trained","model’s","prediction","(soft-\nmax","","last","","layer","","output).","","","A","","weighted","","average","","of","","multiple\ntrained","models","can","be","taken","to","generate","confidence","labels\nwherein","the","weights","are","based","on","the","models","performance\naccuracy.","","This","method","would","be","useful","when","dealing","with\nlarge","","number","","of","","target","","classes","","such","","as","","ImageNet","","dataset\nwhich","has","1000","label","classes,","wherein","manual","confidence\nlabelling","would","be","cumbersome/unwieldy.\nWe","demonstrate","this","on","ImageNet","by","using","the","model’s\nprediction","of","a","trained","ResNet-50","model\n2\n.","","We","define","the\nsimilarity","scoreS\na\nfor","the","classaas","the","average","of","all","the\nmodel","predictions","with","class","labela.","","For","each","classa,","we\nchoose","its","thresholdτ\na\nto","be","the","mean","plus","one","standard\ndeviation","of","the","similarity","scoresS\na\n.","We","thus","obtain","confi-\ndence","labelsC\na\nfor","all","classes","as","defined","in","3.\n2\nTrained","ResNet-50","model","weights","obtained","from","https://pytorch.org/\n\nTable","3:","Validation","accuracy","on","CIFAR10","with","Symmetric","noise.Mdenotes","the","number","of","trusted","(probe)","data","used.0.1k\nindicates","10","images","per","class.\nMethodM\nNoise","ratio\n00.20.40.8\nDES","[31]0.1k96.896.3±0.295.9±0.393.7±0.5\nCE-RN34-94.56±0.1688.75±0.1983.84±1.0341.52±3.31\nLP-RN3410k90.26±0.3888.78±0.2884.15±1.1748.05±5.06\nLP-RN341k90.53±0.1888.52±0.2284.11±0.3532.03±5.60\nLP-RN340.1k90.49±0.6287.82±1.0483.32±0.3329.79±3.83\nWe","further","train","the","model","initialized","with","the","pretrained\nweights","using","these","generated","confidence","labels","using","the\nlog-projection","loss.","","We","use","the","non-noisy","relaxation","func-\ntion","defined","in","10","(r(t)","=t,","i.e.","no","relaxation),","as","ImageNet\nis","predominantly","a","non-noisy","dataset.","","We","do","not","make","use\nof","any","trusted","setMfor","these","experiments.\nThe","","results","","are","","shown","","in","","Table","","4.We","","observe","","that\nthe","baseline","trained","model’s","accuracy","is","further","improved\nby","","training","","the","","model","","using","","confidence","","labels","","and","","log-\nprojection","","loss.","","","We","","nevertheless","","suspect","","that","","the","","gener-\nated","confidence","labels","were","not","representative","of","the","sim-\nilarity","distribution,","as","the","model","used","to","generate","the","labels\nhad","only","76.15%","accuracy.","","Since","ImageNet","is","a","non-noisy\ndataset,","we","carry","out","another","log-projection","training","exper-\niment","using","the","the","one-hot","labels","as","the","confidence","labels,\nas","","shown","","in","","the","","table.","","","We","","see","","substantial","","improvements\nwith","this,","comparable","to","improvements","obtained","using","Au-\ntoAugement","[5].","","The","observed","improvements","are","without\nincorporating","many","“standard”","training-enhancement","tech-\nniques,","so","further","gains","are","presumably","possible.\nTable","4:","Validation","accuracy","on","ImageNet.\nMethodLabel","TypeAccuracy\nAutoAugment","[5]CE-RN50one-hot77.6\nbaselineRN50one-hot76.15\nOursLP-RN50confidence76.59\nOursLP-RN50one-hot76.92\n4.2.3","","","","Food101N","dataset\nIn","","this","","experiment,","","we","","directly","","apply","","our","","projective","","loss\nfunction","on","one-hot","labels,","instead","of","on","confidence","labels.\nWe","follow","the","experimental","setup","of","[8],","wherein","we","train\nthe","model","using","ImageNet","pretrained","weights,","on","all","the","im-\nages","of","Food-101N","dataset","and","evaluate","on","the","test","set","of\nFood-101","dataset","[3].","","We","make","use","of","the","normal","one-hot\nlabels","as","the","confidence","labels","themselves.","","","The","L2-norm\nheuristic","functionHapplied","on","the","one-hot","labels","will","have\na","value","of","1,","signifying","higher","confidence","on","the","labels.","We\ndo","not","use","any","trusted","setMfor","these","experiments.\nThe","experimental","results","are","reported","in","Table","5.","We","ob-\nserve","that","our","approach","achieves","comparable","performance\nto","that","of","the","current","state-of-the-art","technique,","even","when\ndirectly","using","the","one-hot","labels","as","the","confidence","labels,\nand","","without","","any","","loss","","relaxation.We","","note","","that","","directly\ntraining","","the","","model","","without","","pretrained","","ImageNet","","weights\nachieved","lower","accuracy.","We","therefore","show","that","using","our\nprojective","loss","function","does","not","hurt","model","performance","on\nlarge-scale","real-world","datasets,","which","are","inherently","noisy.\nTable","5:","Food101N","experiments.\nMethodAccuracy\nCleanNet","[12]83.59\nSelf-Learning","[8]85.11\nDES","[31]CE-RN5087.57\nOursLP-RN5084.97\n5.","Conclusion\nWe","presented","confidence","labels,","","which","encode","a-priori\ninter-class","similarity","relations","in","order","to","supplement","model\ntraining","with","class","similarity","relations.","","We","also","introduced\na","family","of","projective","loss","functions","that","preserve","the","nat-\nurally","","occurring","","class","","similarity","","distributions,","","tailored","","to\nwork","with","confidence","labels","and","with","the","ability","to","relax","the\nloss","penalty.","We","showed","that","our","simple","approach","achieves\ncomparable","performance","to","the","state-of-the-art","methods","in\nthe","asymmetric","noise","setting.","We","also","showed","potential","im-\nprovements","to","be","gained","using","our","approach","on","real-world\nlarge-scale","ImageNet","and","Food-101N","datasets,","without","yet\nincorporating","many","of","the","“standard”","training-enhancement\ntechniques.","We","plan","to","extend","our","method","to","open-set","learn-\ning","and","few-shot","learning","scenarios.\n\nReferences\n[1]","","Bilal","","Alsallakh,","","Amin","","Jourabloo,","","Mao","","Ye,","","Xiaoming","","Liu,\nand","Liu","Ren.","","Do","convolutional","neural","networks","learn","class\nhierarchy?CoRR,","abs/1710.06501,","2017.","1\n[2]","","Abhijit","Bendale","and","Terrance","E.","Boult.","","","Towards","open","set\ndeep","networks.CoRR,","abs/1511.06233,","2015.","2\n[3]","","Lukas","","Bossard,","","Matthieu","","Guillaumin,","","and","","Luc","","Van","","Gool.\nFood-101","–","mining","discriminative","components","with","random\nforests.","","","In","David","Fleet,","","Tomas","Pajdla,","","Bernt","Schiele,","","and\nTinne","Tuytelaars,","","editors,Computer","Vision","–","ECCV","2014,\npages","446–461,","Cham,","2014.","Springer","International","Publish-\ning.","3,","8\n[4]","","L\n","́\neon","Bottou.","","Large-scale","machine","learning","with","stochastic\ngradient","descent.Proc.","of","COMPSTAT,","01","2010.","6,","7\n[5]","","Ekin","Dogus","Cubuk,","Barret","Zoph,","Dandelion","Man\n","́\ne,","Vijay","Va-\nsudevan,","and","Quoc","V.","Le.","","Autoaugment:","Learning","augmen-\ntation","policies","from","data.CoRR,","abs/1805.09501,","2018.","","3,\n6,","8\n[6]","","Jia","Deng,","Alexander","C.","Berg,","Kai","Li,","and","Li","Fei-Fei.","","What\ndoes","classifying","more","than","10,000","image","categories","tell","us?\nIn","Kostas","Daniilidis,","","Petros","Maragos,","","and","Nikos","Paragios,\neditors,Computer","Vision","–","ECCV","2010,","pages","71–84,","Berlin,\nHeidelberg,","2010.","Springer","Berlin","Heidelberg.","1,","4\n[7]","","J.","","Deng,","","W.","","Dong,","","R.","","Socher,","","L.","","Li,","","Kai","","Li,","","and","","Li","","Fei-\nFei.","","","Imagenet:","","A","large-scale","hierarchical","image","database.\nIn2009","IEEE","Conference","on","Computer","Vision","and","Pattern\nRecognition,","pages","248–255,","2009.","3\n[8]","","Jiangfan","Han,","","Ping","Luo,","","and","Xiaogang","Wang.","","","Deep","self-\nlearning","from","noisy","labels,","2019.","3,","8\n[9]","","Lu","Jiang,","Zhengyuan","Zhou,","T.","Leung,","L.","Li,","and","Li","Fei-Fei.\nMentornet:","","Learning","data-driven","curriculum","for","very","deep\nneural","networks","on","corrupted","labels.","InICML,","2018.","3\n[10]","","Prannay","Khosla,","Piotr","Teterwak,","Chen","Wang,","Aaron","Sarna,\nYonglong","Tian,","Phillip","Isola,","Aaron","Maschinot,","Ce","Liu,","and\nDilip","","Krishnan.Supervised","","contrastive","","learning.arXiv\npreprint","arXiv:2004.11362,","2020.","2,","3,","6\n[11]","","A.","","Krizhevsky.","","","Learning","","multiple","","layers","","of","","features","","from\ntiny","images.","2009.","3,","5\n[12]","","Kuang-Huei","","Lee,","","Xiaodong","","He,","","Lei","","Zhang,","","and","","Linjun\nYang.","Cleannet:","Transfer","learning","for","scalable","image","classi-\nfier","training","with","label","noise.","","","InProceedings","of","the","IEEE\nConference","","on","","Computer","","Vision","","and","","Pattern","","Recognition\n(CVPR),","2018.","3,","8\n[13]","","Junnan","","Li,","","","Yongkang","","Wong,","","","Qi","","Zhao,","","","and","","Mohan","","S.\nKankanhalli.","","","","Learning","","to","","learn","","from","","noisy","","labeled","","data.\nCoRR,","abs/1812.05214,","2018.","2,","5\n[14]","","Q.","Li,","Xiaojiang","Peng,","L.","Cao,","W.","Du,","H.","Xing,","and","Y.","Qiao.\nProduct","image","recognition","with","guidance","learning","and","noisy\nsupervision.Comput.","","Vis.","","Image","","Underst.,","","196:102963,\n2020.","3\n[15]","","Tsung-Yi","Lin,","Priya","Goyal,","Ross","B.","Girshick,","Kaiming","He,\nand","","Piotr","","Doll\n","́\nar.Focal","","loss","","for","","dense","","object","","detection.\nCoRR,","abs/1708.02002,","2017.","2,","3,","5\n[16]","","I.","Loshchilov","and","F.","Hutter.","","","Sgdr:","","Stochastic","gradient","de-\nscent","with","warm","restarts.","InICLR,","2017.","3\n[17]","","Hamed","Masnadi-shirazi","and","Nuno","Vasconcelos.","","On","the","de-\nsign","of","loss","functions","for","classification:","","theory,","","robustness\nto","outliers,","and","savageboost.","","In","D.","Koller,","D.","Schuurmans,\nY.","Bengio,","","and","L.","Bottou,","","editors,Advances","in","Neural","In-\nformation","Processing","Systems","21,","pages","1049–1056.","Curran\nAssociates,","Inc.,","2009.","3\n[18]","","Rafael","","M\n","̈\nuller,","","Simon","","Kornblith,","","and","","Geoffrey","","E.","","Hinton.\nWhen","does","label","smoothing","help?CoRR,","abs/1906.02629,\n2019.","2,","3\n[19]","","Nagarajan","Natarajan,","Ambuj","Tewari,","Inderjit","S.","Dhillon,","and\nPradeep","Ravikumar.","","Learning","with","noisy","labels.","","InNeural\nInformation","Processing","Systems","(NIPS),","dec","2013.","5\n[20]","","Giorgio","Patrini,","Frank","Nielsen,","Richard","Nock,","and","Marcello\nCarioni.","","Loss","factorization,","weakly","supervised","learning","and\nlabel","noise","robustness.CoRR,","abs/1602.02450,","2016.","3\n[21]","","Giorgio","Patrini,","Alessandro","Rozza,","Aditya","Menon,","Richard\nNock,","and","Lizhen","Qu.","","Making","deep","neural","networks","robust\nto","label","noise:","a","loss","correction","approach,","2017.","3,","5\n[22]","","Mengye","","Ren,","","Wenyuan","","Zeng,","","B.","","Yang,","","and","","R.","","Urtasun.\nLearning","","to","","reweight","","examples","","for","","robust","","deep","","learning.\nArXiv,","abs/1803.09050,","2018.","3\n[23]","","Christian","","","Szegedy,","","","","Vincent","","","Vanhoucke,","","","","Sergey","","","Ioffe,\nJonathon","","","Shlens,","","","and","","","Zbigniew","","","Wojna.Rethinking\nthe","","inception","","architecture","","for","","computer","","vision.CoRR,\nabs/1512.00567,","2015.","2,","3,","4\n[24]","","Zichang","Tan,","Shuai","Zhou,","Jun","Wan,","Z.","Lei,","and","S.","Li.","","Age\nestimation","based","on","a","single","network","with","soft","softmax","of\naging","modeling.","InACCV,","2016.","3\n[25]","","Eric","Tzeng,","Judy","Hoffman,","Trevor","Darrell,","and","Kate","Saenko.\nSimultaneous","deep","transfer","across","domains","and","tasks.CoRR,\nabs/1510.02192,","2015.","3\n[26]","","L.J.P.","van","der","Maaten","and","G.E.","Hinton.","","","Visualizing","high-\ndimensional","data","using","t-sne.Journal","of","Machine","Learning\nResearch,","9:2579–2605,","2008.","6\n[27]","","Nidhi","Vyas,","Shreyas","Saxena,","and","Thomas","Voice.","","Learning\nsoft","labels","via","meta","learning,","2020.","3,","4\n[28]","","Yisen","Wang,","","Xingjun","Ma,","","Zaiyi","Chen,","","Yuan","Luo,","","Jinfeng\nYi,","and","James","Bailey.","","","Symmetric","cross","entropy","for","robust\nlearning","with","noisy","labels.CoRR,","abs/1908.06112,","2019.","","3,\n5\n[29]","","Scott","","Workman,","","","Richard","","Souvenir,","","","and","","Nathan","","Jacobs.\nQuantifying","","","and","","","predicting","","","image","","","scenicness.CoRR,\nabs/1612.03142,","2016.","3\n[30]","","Chiyuan","","Zhang,","","Samy","","Bengio,","","Moritz","","Hardt,","","Benjamin\nRecht,","and","Oriol","Vinyals.","","Understanding","deep","learning","re-\nquires","","rethinking","","generalization.CoRR,","","abs/1611.03530,\n2016.","6\n[31]","","Zizhao","Zhang,","Han","Zhang,","Sercan\n","̈\nO.","Arik,","H.","Lee,","and","T.\nPfister.","","","","Distilling","","effective","","supervision","","from","","severe","","label\nnoise.2020","IEEE/CVF","Conference","on","Computer","Vision","and\nPattern","Recognition","(CVPR),","pages","9291–9300,","2020.","","3,","5,\n6,","7,","8"],"doc22":["\n\nThis","work","has","been","submitted","to","the","IEEE","Transactions","on","Pattern","Analysis","and","Machine","Intelligence","for","possible\npublication.","Copyright","may","be","transferred","without","notice,","after","which","this","version","may","no","longer","be","accessible.\nOn","Sequential","Bayesian","Optimization","with\nPairwise","Comparison\nTanya","Ignatenko,Member,","IEEE,Kirill","Kondrashov,Member,","IEEE,Marco","Cox,\nBert","de","Vries,Member,","IEEE\nAbstract—In","this","work,","we","study","the","problem","of","user","preference","learning","on","the","example","of","parameter","setting","for","a","hearing","aid","(HA).\nWe","propose","to","use","an","agent","that","interacts","with","a","HA","user,","in","order","to","collect","the","most","informative","data,","and","learns","user","preferences","for\nHA","parameter","settings,","based","on","these","data.","We","model","the","HA","system","as","two","interacting","sub-systems,","one","representing","a","user","with\nhis/her","preferences","and","another","one","representing","an","agent.","In","this","system,","the","user","responses","to","HA","settings,","proposed","by","the","agent.\nIn","our","user","model,","the","responses","are","driven","by","a","parametric","user","preference","function.","The","agent","comprises","the","sequential\nmechanisms","for","user","model","inference","and","HA","parameter","proposal","generation.","To","infer","the","user","model","(preference","function),","Bayesian\napproximate","inference","is","used","in","the","agent.","Here","we","propose","the","normalized","weighted","Kullback-Leibler","(KL)","divergence","between","true\nand","agent-assigned","predictive","user","response","distributions","as","a","metric","to","assess","the","quality","of","learned","preferences.","Moreover,","our\nagent","strategy","for","generating","HA","parameter","proposals","is","to","generate","HA","settings,","responses","to","which","help","resolving","uncertainty\nassociated","with","prediction","of","the","user","responses","the","most.","The","resulting","data,","consequently,","allows","for","efficient","user","model","learning.\nThe","normalized","weighted","KL-divergence","plays","an","important","role","here","as","well,","since","it","characterizes","the","informativeness","of","the","data","to\nbe","used","for","probing","the","user.","The","efficiency","of","our","approach","is","validated","by","numerical","simulations.\nIndex","Terms—Preference","learning,","KL-divergence,","universal","prediction,","Bayesian","inference,","intelligent","agents\nF\n1","","","","INTRODUCTION\nIn","this","work,","we","study","the","problem","of","preference","learning\non","the","example","of","fitting","a","hearing","aid","(HA).","This","problem\nand","the","corresponding","solution,","however,","are","not","restricted\nto","this","application,","but","make","it","easier","to","motivate","and","reason\nabout","their","properties","and","requirements.\nFitting","and","tuning","of","HAs","has","always","been","considered","a\ntedious","task","of","healthcare","professionals","(HCPs).","Traditional\napproaches","for","fitting","HA","parameters","rely","on","compensation\nof","","a","","user’s","","hearing","","loss,","","based","","on","","audiograms,","","by","","apply-\ning","","rules","","such","","as","","NAL-NL1","","or","","NAL-NL2","","[1].","","These","","rules,\nhowever,","do","not","take","into","account","specific","user","preferences.\nTuning","of","the","HA","parameters","would","happen","at","some","later\nmoment","of","time,","at","an","HCP’s","office,","when","a","user","shares","some\nqualitative","","feedback","","about","","his/her\n1\nexperience","","of","","using\ntheir","HAs","with","the","HCP.","The","tuning","result","heavily","depends\non","the","HCP’s","experience","and","expertise","levels,","and","the","degree\nto","","which","","the","","user","","feedback","","can","","be","","related","","to","","the","","required\ntuning.","In","practice,","due","to","generic","fitting","and","tuning","proce-\ndures,","","HA","","users","","remain","","not","","fully","","satisfied","","with","","the","","result\nthat","","leads","","to","","recurrent","","visits","","to","","HCPs","","or","","less","","frequent","","HA\nuse.","","The","","problem","","of","","finding","","optimal","","personalized","","settings\nfor","HA","parameters","is","therefore","important.","In","this","work,","we\ninvestigate","the","problem","of","an","efficient","automated","search","for\noptimal","","HA","","parameters","","by","","incorporating","","a","","user","","feedback\ninto","","the","","learning","","cycle.","","We","","study","","a","","system","","that","","allows","","to\nlearn","","user","","preferences","","for","","HA","","parameters","","in","","an","","efficient\n•T.","Ignatenko,","K.","Kondrashov,","M.Cox","and","B.","de","Vries","are","with","the","R&D\nGlobal","Research,","GN","Group,","John","F","Kennedylaan","2,","5612","AB","Eindhoven.\nE-mail:","tignatenko@gnhearing.com",".\n1.","Later","in","the","text,","for","compactness,","we","use","“his”","as","a","gender-neutral\npronoun","associated","with","a","“user”",".\nand","","minimally","","obtrusive","","way","","by","","empowering","","the","","user","","to\ntake","direct","decisions","and","have","direct","impact","on","the","tuning\nprocess.","","In","","this","","setting,","","the","","user","","is","","required","","to","","evaluate","","a\nsequence","","of","","pairs","","of","","HA","","setting","","proposals,","","by","","stating","","his\nchoice","for","one","of","the","proposed","settings.\nThe","","problem","","of","","preference","","learning","","for","","HAs","","has","","been\nan","","active","","research","","topic","","in","","the","","past","","years.","","In","","[2],","","prefer-\nence","","learning","","for","","parametric","","user","","preference","","models","","was\nstudied.","","In","","their","","work,","","Thompson","","sampling","","together","","with\nBayesian","approximate","inference","was","used","to","learn","the","user\npreferences","and","cumulative","value","of","the","preference","function\nwas","","used","","to","","assess","","the","","learning","","performance.","","In","","[3],","","the\npreference","function","was","modeled","as","a","Gaussian","process,","and\nthe","learning","process","was","driven","by","the","expected","improve-\nment","criterion","on","the","preference","function.","A","good","overview\nof","","preference","","learning","","using","","Gaussian","","processes","","to","","model\npreference","","functions,","","though","","not","","in","","the","","context","","HA,","","were\npresented","in","[4].","Remarkably,","in","situations","with","preference\nlearning,","","the","","optimal","","user","","preferences","","as","","well","","as","","the","","cor-\nresponding","value","of","the","preference","function","are","unknown.\nTherefore,","in","[3],","the","current","estimate","of","the","user","preference\nfunction","","for","","the","","optimal","","preference","","is","","used","","as","","a","","ground\ntruth,","which","need","not","be","close","to","the","actual","user","preference.\nHence,","","the","","procedure","","does","","not","","guarantee","","convergence","","to\nthe","true","preference.","We","take","a","different","approach","here.","In-\nstead","of","using","estimates","of","unobservable","preference","function\nvalues,","we","concentrate","on","the","information","provided","in","the\nuser","","responses,","","in","","order","","to","","steer","","the","","learning","","process.","","We\ndesign","a","metric","that","can","be","efficiently","used","to","evaluate","the\nlearning","performance","in","the","absence","of","true","user","preference\ninformation.\nOur","","goal","","is","","to","","design","","a","","Bayesian","","optimizer","","for","","user\npreference","learning","of","HA","parameters","from","binary","choices.\n1\narXiv:2103.13192v1","","[cs.LG]","","24","Mar","2021\n\n2\nFig.","1:","A","HA","system,","as","two","interacting","sub-systems,","i.e.,","a\nuser","and","an","agent.","For","each","interaction,","the","agent","generates\ntwo","sets","of","HA","parameter","settings.","The","user","evaluates","these\ntwo","sets,","based","on","his","preferences,","and","provides","the","ranking\nof","the","presented","parameters","(binary","response).\nThis","","optimizer","","has","","to","","find","","the","","optimal","","preferences","","of","","the\nuser","for","HA","parameters,","given","binary","user","responses,","in","as\nfew","trials","as","possible.","Binary","user","responses","correspond","to\nuser","indication","of","his","preference","for","one","of","the","two","presented\nchoices","of","HA","parameters.","Our","approach","is","based","on","a","para-\nmetric","user","preference","model,","proposed","in","[2].","In","this","case,\nthe","","optimal","","preference","","can","","be","","expressed","","as","","the","","location","","of\nthe","maximum","of","the","latent","user","preference","function","that","we\nneed","to","infer.","We","model","the","HA","system","as","two","interacting\nsub-systems,","where","one","sub-system","represents","the","user","with\nhis","preferences","for","HA","parameters","and","the","other","represents\nan","","agent","","that","","probes","","the","","user,","","such","","that","","it","","can","","efficiently\nlearn","","the","","user","","preferences,","","see","","Fig.1.","","The","","agent","","strategy","","is\nbased","on","sequential","reduction","of","uncertainty","about","the","user\nafter","each","interaction","between","the","user","and","the","agent.","This\nuser","uncertainty","metric","is","derived","based","on","the","concepts","of\nuniversal","prediction,","see","e.g.","[5].","This","metric","is","also","used","to\nmonitor","the","learning","process.\nNotations:In","","the","","rest","","of","","the","","text,","","we","","denote","","random\nvariables","","by","","capital","","letters,R,realizations","","or","","observations\nby","small","letters,r,and","vectors","by","bold","letters,r.","Moreover,\nsequences","","are","","denoted","","byr\nn\n1\nand{a,b}\nn\n1\n,","","and","","defined","","as\nr\nn\n1\n={r\n1\n,r\n2\n,...,r\nn\n}and{a,b}\nn\n1\n={{a\n1\n,b\n1\n},{a\n2\n,b\n2\n},...,\n{a\nn\n,b\nn\n}},respectively.\n2","","","","USER","ANDPREFERENCEFUNCTIONMODELING\nWe","start","with","specifying","the","user","model,","which","represents","a\nprobabilistic","description","of","user","responses,","when","comparing\ntwo","","sets","","of","","HA","","parameter","","settings.","","Integral","","parts","","of","","the\nmodel","include","a","user","preference","function","and","a","distribution\nof","the","user","responses","to","the","presented","choices","of","parameters.\nConsider","","a","","vector","","of","","HA","","parameters,","","defined","","on","","aD-\ndimensional","continuous","compact","surface.","In","particular,","pa-\nrametersxare","defined","on","aD-dimensional","hyper-cube,","i.e.,\nx∈[0,1]\nD\n.","","We","can","","always","","guarantee","this","","by","","normalizing\nthe","actual","parameters","by","their","physical","range.","Our","goal","is","to\nfind","optimal","values","of","HA","parameters,","denoted","byθ,for","a\nparticular","user.","Here","we","follow","the","model","setting","of","","[2].\nOur","user","model","is","based","on","two","assumptions:","(1)","a","user\npreference","exists","and","is","described","by","a","unimodal","preference\nfunctionf(·);","","and","","(2)","","a","","user","","can","","be","","uncertain","","about","","his\npreference,","which","can","be","expressed","in","terms","of","an","additive\nrandom","variable.\nIn","","general,","","the","","user","","preference","","function","","is","","unknown.\nWe","","assume","","this","","latent","","preference","","functionf(x;θ,Λ)to\nbe","","a","","parametric","","function","","of","","HA","","parameters,x∈[0,1]\nD\nwith","known","form","but","unknown","shape.","This","shape","is","char-\nacterized","","","bytuning","","","parameters,θ∈[0,1]\nD\nandΛ","","","=\ndiag([λ\n1\n,λ\n2\n,...,λ\nD\n]),λ\nd\n∈R\n+\n,d=","1,2,...,D.","In","particu-\nlar,","the","user","preference","function","is","specified","by","the","following\nfunction\nf(x;θ,Λ)","=−\n√\n(x−θ)\nT\nΛ(x−θ).(1)\nNote","that","the","tuning","parameters","correspond","to","the","location\nof","","the","","optimum","","of","","the","","function,θ,that","","is,","","in","","fact,","","the\noptimal","HA","parameters","for","a","user;","and","to","the","spread","around\nthis","","optimum,Λ,that","","characterizes","","user","","sensitivity","","to","","HA\nparameter","changes,","respectively.","The","tuning","parameters","are\nuser-specific","","and","","need","","to","","be","","learned.","","The","","form","","of","","this\npreference","function","has","an","attractive","property","that","it","allows\nfor","quick","narrowing","of","the","search","space,","see","","[2].\nNext,","in","order","to","model","user","preference","uncertainty,","we\ndefine","a","value","functionu(·)as\nu(x)","=f(x;θ,Λ)","+ε,(2)\nwhere","the","user","uncertainty","errorεis","assumed","to","have","the\nstandard","Gaussian","distribution,","i.e.,\nε∼N(0,1).(3)\nThe","choice","for","this","assumption","is","further","discussed","after","we\nintroduce","the","notion","of","the","user","response.\nConsider","now","a","user","response","to","a","pairwise","comparison\nof","","parameters","","from","","a","","trial,","","defined","","by","","a","","pair{x\nref\n,x\nalt\n},\nwherex\nref\nandx\nalt\nare","the","so-calledreference","and","alternative\nparameter","","proposal,","","respectively.","","We","","call","","reference","","proposal\nx\nref\nto","be","the","highest","rated","proposal","from","the","previous","trial\nand","this","situation","is","challenged","by","the","alternative","proposal\nx\nalt\n,","","in","","the","","given","","trial.","","The","","user","","response","","depends","","on","","his\npreferences","","for","","the","","presented","","HA","","parameters,","","which","","are\ngiven","by","the","value","function","for","these","parameters.","The","user\nresponse,R,takes","values","from{0,1},","where","response1to\na","","trial{x\nref\n,x\nalt\n}indicates","","that","","parameterx\nalt\nis","","preferred\nover","or","is","as","good","asx\nref\n,and0,","otherwise,","i.e.,\nR\n∆\n=\n{\n1,ifx\nalt\n\u0017x\nref\n0,ifx\nref\n\u001fx\nalt\n,(4)\nwhere\u0017denotes","preferred","or","equivalent","to,","and\u001fdenotes\nstrict","preference.\nNow","the","probability","of","a","positive","user","response,","i.e.,","that\nRtakes","on","value1,","in","a","trial{x\nref\n,x\nalt\n},","is","given","by\nPr{R=","1|{x\nref\n,x\nalt\n},f}\n=","","","","Pr{u(x\nalt\n)≥u(x\nref\n)}\n=","","","","Pr{f(x\nalt\n;θ,Λ)","+ε\n′\n≥f(x\nref\n;θ,Λ)","+ε}\n=","","","","Pr{ε−ε\n′\n≤f(x\nalt\n;θ,Λ)−f(x\nref\n;θ,Λ)}\n=","","","","Φ\n(\nf(x\nalt\n;θ,Λ)−f(x\nref\n;θ,Λ)\n√\n2\n)\n=","","","","Φ\n(\nf(x\nalt\n;θ,Λ\n′\n)−f(x\nref\n;θ,Λ\n′\n)\n)\n,(5)\nwhereΦ(·)is","","the","","cumulative","","distribution","","function","","(CDF)\nof","","","the","","","standard","","","Gaussian","","","distribution,","","","andΛ\n′\n=\nΛ\n2\n.\n\n3\nThus,Ris","","a","","Bernoulli","","random","","variable","","with","","parameter\nΦ\n(\nf(x\nalt\n;θ,Λ\n′\n)−f(x\nref\n;θ,Λ\n′\n)\n)\n.Therefore,","","given","","the","","user\npreference","and","response","model,","defined","by","(1)-(5),","the","prob-\nability","","mass","","function","","(PMF)","","of","","a","","user","","response","","to","","a","","trial\n{x\nref\n,x\nalt\n}is","given","by\nP\n(\nr|{x\nref\n,x\nalt\n},f\n)\n=","","","","Φ\n(\nf(x\nalt\n;θ,Λ\n′\n)−f(x\nref\n;θ,Λ\n′\n)\n)\nr\n·\n(\n1−Φ\n(\nf(x\nalt\n;θ,Λ\n′\n)−f(x\nref\n;θ,Λ\n′\n)\n))\n1−r\n=","","","","Φ\n(\nf(x\nalt\n;θ,Λ\n′\n)−f(x\nref\n;θ,Λ\n′\n)\n)\nr\n·Φ\n(\nf(x\nref\n;θ,Λ\n′\n)−f(x\nalt\n;θ,Λ\n′\n)\n)\n1−r\n.(6)\nThis","user","response","model,","which","relates","binary","observations\nto","","the","","continuous","","latent","","function,","","is","","also","","known","","as","","the\nThurstone-Mosteller","","law","","of","","comparative","","judgment","","[6].","","In\nstatistics,","it","is","called","the","binomial-probit","regression","model.\nRemark","","","2.1.Note","","that","","we","","can","","assume","","unit-variance","","of\nthe","","user","","uncertainty","","error","","because","","other","","values","","can","","be\nabsorbed","","by","","the","","preference","","function","","as","","a","","scaling","","factor\nin","the","user","sensitivity.","Indeed,","whenε∼","N(0,β\n−1\n)the\nuser","response","model","becomes\nP\n(\nr|{x\nref\n,x\nalt\n},f\n)\n=","","","","Φ\n(\n(\nf(x\nalt\n;θ,Λ)−f(x\nref\n;θ,Λ)\n)\n√\n2β\n−1\n)\nr\n·Φ\n(\n(\nf(x\nref\n;θ,Λ)−f(x\nalt\n;θ,Λ)\n)\n√\n2β\n−1\n)\n1−r\n=","","","","Φ\n(\nf(x\nalt\n;θ,Λ\n′′\n)−f(x\nref\n;θ,Λ\n′′\n)\n)\nr\n·Φ\n(\nf(x\nref\n;θ,Λ\n′′\n)−f(x\nalt\n;θ,Λ\n′′\n)\n)\n1−r\n,\nwhereΛ\n′′\n=\nβ\n2\n·Λ\n2\n.\nRemark","2.2.Observe","that,","in","this","model,","we","can","re-defineΛ\nasΛ\n′\norΛ\n′′\n.","SinceΛis","an","unknown","parameter,","this","scal-\ning","can","be","applied","without","loss","of","generality.","However,\ncare","","need","","to","","be","","taken","","while","","setting","","the","","priors","","for","","this\nparameter,","taking","into","account","physical","interpretation","of\nHA","parameters","and","thus","possibly","also","re-scaling","hyper\nparameters","of","the","prior","distributions.\nThe","following","definition","summarizes","our","user","model.\nDefinition","2.1","(User","Model).A","user","model","is","defined","by","the\nPMF","","of","","the","","user","","responserto","","a","","trial{x\nref\n,x\nalt\n}and","","is\ngiven","by\nP\n(\nr|x\nref\n,x\nalt\n,f\n)\n=","","Φ\n(\nf(x\nalt\n;θ,Λ\n′\n)−f(x\nref\n;θ,Λ\n′\n)\n)\nr\n·Φ\n(\nf(x\nref\n;θ,Λ\n′\n)−f(x\nalt\n;θ,Λ\n′\n)\n)\n1−r\n,(7)\nwhereΦ(·)is","the","CDF","of","the","standard","normal","distribu-\ntion.","Heref(·;·)is","a","user","preference","function,","given","by\nf(x;θ,Λ)","=−\n√\n(x−θ)\nT\nΛ(x−θ),(8)\nthe","user","response","relation","to","a","trial{x\nref\n,x\nalt\n}is","defined\nby\nR\n∆\n=\n{\n1,ifx\nalt\n\u0017x\nref\n0,ifx\nref\n\u001fx\nalt\n,(9)\nand","","the","","user","","uncertainty","","about","","his","","response","","to","","a","","given\ntrial","is","characterized","by","the","standard","Gaussian","distribu-\ntion:\nε∼N(0,1).(10)\nObserve","that","the","user","model,","defined","as","above,","is","a","para-\nmetric","","model","","of","","the","","user","","preferences","","and","","sensitivity.","","Our\ngoal","is","to","estimate","the","user","preference","parameterθ,based","on\na","sequence","of","trials","and","corresponding","user","responses.","This\nproblem","can","be","seen","as","a","problem","of","finding","the","optimum\nof","","the","","latent","","user","","preference","","function,","","and","","thus","","requires\nlearning","the","function","or,","equivalently,","its","parameters.","Note,\nhowever,","that","sensitivity","parameterΛis,","in","fact,","a","nuisance\nparameter,","","since","","our","","primary","","goal","","is","","learning","","the","","location\nof","","the","","optimum.","","Moreover,","","since","","we","","need","","to","","learn","","user\npreferences","in","as","few","trials","as","possible,","this","learning","problem\nalso","relates","to","the","problem","of","active","learning.","There,","the","goal\nis","to","learn","a","model","efficiently","by","selecting","the","most","relevant\ndata","(trials","in","our","setting).","Observe","that,","given","unimodality\nof","","the","","preference","","function,","","preference","","learning","","is","","also","","an\noptimization","","problem.","","From","","this","","point","","of","","view,","","to","","get","","to\nthe","optimum,","we","need","to","construct","trials","such","that","in","each\ngiven","trial,","an","alternative","proposal","is","better","than","a","reference\nproposal","","with","","high","","probability.","","The","","resulting","","procedure","","is\nthen","similar","in","flavor","to","gradient","ascent.\nIn","the","next","section,","we","define","the","inference","strategy","for\nuser","preference","learning,","but,","first,","we","specify","the","full","model\nfor","our","HA","system","and","its","properties.\n3","","","","HA","SYSTEM","ANDINFERENCESTRATEGY\n3.1","","","","Parameter","Transformation\nBefore","","going","","into","","the","","model","","specification,","","we","","introduce","","a\nHA","parameter","transformation","and","define","the","corresponding\nparameter","vector:\nφ=\n\n\n\n\n\n\n\n\n\n\nα\n1\n.\n.\n.\nα\nD\nγ\n1\n.\n.\n.\nγ\nD\n\n\n\n\n\n\n\n\n\n\n,(11)\nwhere\nα\nd\n=","","","","Φ\n−1\n(θ\nd\n),(12)\nγ\nd\n=","","","","ln(λ\nd\n),","","d=","1,2,...,D,(13)\nandΦ\n−1\n(·)is","the","inverse","of","the","CDF","of","the","standard","Gaus-\nsian","","distribution.","","The","","latter","","non-linear","","monotonic","","trans-\nformation","","guarantees","","that","","the","","values","","of","","parametersθare\nconstrained","","to","","the[0,1]\nD\nhyper-cube","","during","","the","","learning\nprocess,","","while","","we","","operate","","in","","the","","transformed","","continuous\nparameter","","space.","","From","","now","","on,","","we","","also","","assume","","that","","trial\nproposals","","are","","in","","the","","same","","transformed","","domain","","as","","the","","HA\nparameters.","Similarly,","transformation","of","the","user","sensitivity\nhelps","","to","","constrain","","this","","parameter","","to","","the","","positive","","real","","sub-\nspace.","","Further,","","we","","re-define","","the","","preference","","function","","with\nthis","transformed","parameter","vector","as\nf(x;φ)\n∆\n=f(Φ(x);","Φ(α),exp(Γ)),(14)\n\n4\nwhere","","","the","","","transformations","","","are","","","applied","","","component-wise\ntoαandx,","","thus,","","e.g.,Φ(α)denotes","","a","","vectorΦ(α)","","=\n{Φ(α\n1\n),Φ(α\n2\n),...,Φ(α\nD\n)},and","component-wise","to","the","di-\nagonal","ofΛ,thenexp(Γ)is","a","diagonal","matrix","with","elements\nexp(γ\nd\n),","d=","1,2,...,Don","its","diagonal.\n3.2","","","","HA","System","Definition\nOur","goal","is","to","design","an","efficient","system","for","learning","param-\neters","","of","","the","","latent","","user","","preference","","function.","","We","","have","","two\nintegral","","components","","here:","","a","","user","","with","","his","","preferences","","and\nan","agent","or","optimizer","that","interacts","with","the","user","by","offering\nHA","settings.","Therefore,","we","model","the","full","HA","system","as","a\ncombination","of","two","sub-systems,","representing","a","user","and","an\noptimizer,","see","Fig.","1.","In","this","system,","the","user","can","be","seen","as\nan","environment","in","which","the","optimizer","operates.","Different\nsettings","","for","","the","","user","","preference","","function,φ,","","correspond","","to\ndifferent","","users","","or","","environments,","","and","","thus","","different","","user\nmodels.","User","responses","to","the","trials,r,are","observations","of\nthe","","environment.","","Moreover,","","they","","are","","reactions","","to","","the","","HA\nproposal","","trials.","","An","","optimizer","","or","","agent","","is","","a","","part","","of","","the","","HA\nsystem","","that","","interacts","","with","","the","","environment","","by","","generating\ntrials","or","actions","to","which","the","environment","reacts.","The","agent\ngenerates","trials,","according","to","some","objective.","The","objective\nof","","our","","agent","","is","","to","","generate","","trials","","that","","result","","in","","accurate\nestimate","","of","","the","","user","","preferences","","for","","the","","HA","","parameters","","in\nas","little","number","of","trials","as","possible.\nDefinition","","3.1.A","","HA","","system","","is","","defined","","by","","a","","combination\nof","two","interacting","sub-systems{P\na\n,P\nu\n},","an","agent","and","a\nuser,","given","by","a","sequence","ofn=","1,2,...distributions\nP\na\nn\n=p({x\nref\nn\n,x\nalt\nn\n}|φ,r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)(15)\nP\nu\nn\n=P(r\nn\n|φ,r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n}),(16)\nwherep({x\nref\nn\n,x\nalt\nn\n}|φ,r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)is","a","genera-\ntive","","","","PDF","","","","for","","","","trials{x\nref\nn\n,x\nalt\nn\n}in","","","","the","","","","environ-\nmentφ,giventheprevioussequenceofob-\nservations,r\nn−1\n1\n,and","","","","trials,{x\nref\n,x\nalt\n}\nn−1\n1\n;","","","","while\nP(r\nn\n|φ,r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n})is","","a","","generative\nprobability","","of","","the","","response","","in","","this","","environment","","to","","the\nnew","trial{x\nref\nn\n,x\nalt\nn\n},givenr\nn−1\n1\nand{x\nref\n,x\nalt\n}\nn−1\n1\n.\nObserve","that,","for","the","agent,","described","by","(15),","observations\nr\nn−1\n1\nare","","input","","data","","and","","actions{x\nref\nn\n,x\nalt\nn\n}are","","outputs,\nwhile","","for","","the","","user,","","described","","by","","(16),","","the","","situation","","is","","re-\nversed.\nIn","","the","","HA","","system,","","defined","","as","","above,","","trials","","or","","actions\nare","","data","","that","","are","","produced","","by","","the","","agent,","","and","","every","","time\na","trial","is","presented,","the","user","reacts","to","thisgiven","trial.","As","such\nthe","relation","between","trials","and","responses","to","trials","becomes\ncausal.","","Therefore,","","interactions","","between","","the","","user","","and","","the\nagent","are","characterized","by","a","sequence","of","distributions\np(φ),p({x\nref\n1\n,x\nalt\n1\n}|φ),P(r\n1\n|φ,{x\nref\n1\n,x\nalt\n1\n}),\np({x\nref\n2\n,x\nalt\n2\n}|φ,r\n1\n,{x\nref\n1\n,x\nalt\n1\n}),...\n3.3","","","","Agent","Strategy","Design\nGiven","","the","","HA","","system,","","we","","have","","to","","deal","","with","","two","","con-\nnected","","problems.","","One","","problem","","relates","","to","","inference","","of","","the\nparameters","of","the","user","preference","function.","We","look","closely\nat","","this","","problem","","in","","Section","","4.","","Another","","problem","","deals","","with\nefficient","","learning,","","and","","thus","","experimental","","design","","that","","leads\nto","the","limited","but","highly","informative","data","that","can","be","used\nto","","correctly","","perform","","inference.","","From","","this","","point","","of","","view,\nwe","","need","","the","","agent","","to","","generate","","actions","","or","","trials","","that","","result\nin","","inferred","","user","","preference","","under","","which","","behavior","","of","","the\nenvironment","is","the","same","as","its","behavior","under","the","true","user\npreferenceφ.","That","is","the","same","behavior","over","the","history","of\ntaken","","actions","","and","","resulting","","observations.","","In","","what","","follows,\nwe","discuss","and","present","our","agent","design.\n3.3.1","","Agent","Strategy\nObserve","that","behavior","of","the","environment","is","characterized\nby","a","sequence","of","distributions,","given","by","(16),","each","indexed\nby","","the","","trials","","offered","","by","","the","","agent,","","since","","there","","is","","a","","causal\nrelation","between","trials","and","user","responses.","In","order","to","gen-\nerate","","an","","informative","","action,","","the","","agent","","has","","to","","first","","evaluate\nthe","environment,","based","on","its","knowledge","from","the","previous\ninteractions.","Thus,","the","agent","has","to","assign","a","predictive","dis-\ntributionQ(r\nn\n|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n})for","the","next\nresponse,","in","order","to","assess","the","informativeness","of","the","trial\n{x\nref\nn\n,x\nalt\nn\n}.","We","start","with","defining","the","metric","that","is","used","to\nassess","","the","","performance","","of","","the","","agent,","","and","","then","","present","","the\nagent","strategy","that","results","from","optimizing","this","metric.\nThe","","self-information","","loss","","function,","","also","","called","","log-loss,\ngiven","","by−logQ(r\nn\n|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n}),","","char-\nacterizes","the","quality","of","theQ-distribution","assignment.","The\nproblem","","","of","","","probability","","","assignment","","","that","","","minimizes","","","self-\ninformation","","loss","","is","","equivalent","","to","","the","","problem","","of","","universal\nprediction","under","self-information","loss,","see","[5].","In","our","case,\nthough,","prediction","is","not","the","main","goal,","but","rather","a","mecha-\nnism","","to","","assess","","the","","validity","","of","","the","","statistical","","model","","and","","to\nfurther","","collect","","extra","","data","","(generate","","trial","","and","","observe","","the\nresulting","","user","","response)","","that","","can","","be","","used","","to","","improve","","the\nmodel.","","Under","","the","","expected","","self-information","","loss","","criterion,\ni.e.,\nE[−logQ(R\nn\n|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n})],\nwhere","","expectation","","is","","taken","","with","","respect","","to","","the","","generative\nuser","response","distribution","(we","also","call","it","true","user","or","true\nsource","","distribution),","","the","","optimal","","predictive","","assignment","","is\nactually","","the","","assignment","","of","","the","","true","","conditional","","probabil-\nityP(r\nn\n|φ,r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n}).","","Here","","the","","true\nsource","","model","","that","","governs","","generation","","ofr\nn\nbelongs","","to\nthe","","class","","of","","models,","","indexed","","by","","parametersφ,","","given","","by\n{P(·|φ,·),φ∈Ω}.","","This","","true","","probability","","under","","certain\nergodicity","","assumptions","","also","","minimizes","","the","","average","","self-\ninformation","loss\n1\nn\nn\n∑\nl=1\n−logQ(r\nl\n|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n}).(17)\nNote","","that","","sequential","","probability","","assignment","","gives","","rise","","to\nassignment","","of","","the","","probabilityQto","","the","","entire","","observation\nsequencer\nn\n1\nand","then","sequential","probability","assignment","and\nprobability","","assignment","","problems","","for","","the","","whole","","sequence\nunder","self-information","loss","are","equivalent.","The","average","self-\ninformation","loss","for","the","true","source","distribution","is,","in","fact,\nthe","entropy\nH\nn\n(P)","=E[−logP(R\nn\n1\n|φ,{x\nref\n,x\nalt\n}\nn\n1\n)].\nObserve","that","here","we","have","conditioning","on","the","trials,","which\nare","","fixed","","agent’s","","inputs.","","These","","trials{x\nref\n,x\nalt\n}\nn\n1\ncan","","be\n\n5\nmodeled","as","side","information,","see","e.g.","[7],","where","side","infor-\nmation","is","an","additional","information","provided","to","the","agent","at\nthe","beginning","of","the","next","interaction.","In","our","case,","this","side\ninformation","is","a","causal","function","of","previous","interactions,","see\nalso","(15).\nIn","","practice,","","the","","true","","source","","distribution","","is","","often","","un-\nknown,","","and","","we","","have","","an","","extra","","loss,","","associated","","with","","using\nother","","than","","true","","distribution.","","This","","loss,","","which","","is","","coming\non","","top","","of","","the","","minimum","","loss,","","is","","given","","by","","the","","information\ndivergence","betweenPandQ,","also","called","Kullback-Leibler\n(KL)","divergence:\nD\nn\n(P||Q)\n∆\n=E[−logQ(R\nn\n1\n|{x\nref\n,x\nalt\n}\nn\n1\n)−\n(−logP(R\nn\n1\n|φ,{x\nref\n,x\nalt\n}\nn\n1\n))]\n=D(P(R\nn\n1\n|φ,{x\nref\n,x\nalt\n}\nn\n1\n)||Q(R\nn\n1\n|{x\nref\n,x\nalt\n}\nn\n1\n)),\n(18)\nwhere","expectation","is","taken","with","respect","toP.Clearly,","to","be\nable","to","produce","informative","trials,","the","agent","needs","sufficient\nknowledge","","about","","the","","environment,","","and","","therefore","","should\nseek","","a","","probability","","assignmentQthat","","minimizes","","this","","KL-\ndivergence.\nRecall","that","the","agent","performs","universal","prediction","with\nrespect","","to","","an","","indexed","","class","","of","","sources{P(·|φ,·),φ∈Ω}.\nHowever,","sinceφis","unknown,","we","take","an","approach,","which\nhas","","a","","strong","","Bayesian","","flavor,","","to","","assign","","some","","weighting\ndistributionw(φ)onφ.","","Then","","the","","quality","","of","","distribution\nassignmentQwill","be","assessed","by","the","normalized","weighted\nKL-divergence\nD\nn\n(Q,w,{x\nref\n,x\nalt\n})\n∆\n=\n1\nn\n∫\nΩ\nw(φ)D\nn\n(P||Q)dφ.(19)\nNext,","","we","","present","","the","","agent","","strategy","","together","","with","","its\ncharacterization","","and","","then","","show","","why","","this","","is","","an","","efficient\nstrategy.\nAgent","StrategyThe","agent","strategy","for","the","sequential","trial","design\nin","the","HA","system,","defined","by","distributions{P\na\n,P\nu\n},","is","to\n1)apply","the","following","distributions","as","generative","agent","and\npredictive","user","distributions,","respectively:\nP\na\nl\n=p\nl\n=δ(x\nref\nl\n−x\nalt\nl−1\n)\nr\nl−1\n·δ(x\nref\nl\n−x\nref\nl−1\n)\n1−r\nl−1\n·\n∫\np(x\nalt\nl\n,γ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)dγ\nP\nu\nl\n=Q\np,l\n=\n∫\nΩ\np(φ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)\n·P(r\nl\n|φ,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n})dφ,\nforl=","1,2,...,n,","where\np(φ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)\n=\np(φ)p(r\nl−1\n1\n|φ,{x\nref\n,x\nalt\n}\nl−1\n1\n)\n∫\nΩ\np(φ\n′\n)p(r\nl−1\n1\n|φ\n′\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)dφ\n′\nis","a","posterior","distribution","and\n∫\np(x\nalt\nl\n,γ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)dγis","a","marginal","of","the\nlocation","parameter","of","this","posterior;\n2)generate","","the","","corresponding","","sequence","","of","","trials,","","forl=\n2,3,","...,n,","based","on","the","history","of","interactions","with","the\nuser,","according","to","the","following","rule\n{x\nref\nl\n,x\nalt\nl\n}=\narg","max\n{x\nref\n,x\nalt\n}:\nP\na\nl\nI(R;φ|R\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\n,x\nalt\n}),\nwhereI(·;·)is","mutual","information.\nThis","","strategy","","is","","asymptotically","","optimal","","in","","that","","it","","minimizes\nnormalized","","weighted","","KL-divergence.","","Given","","this","","strategy,","","forn\ninteractions,","the","achieved","normalized","weighted","KL-divergence","is\ngiven","by\nD\nn\n(P\nu\n,{x\nref\n,x\nalt\n})","","","","=\n1\nn\nn\n∑\nl=1\nI(R\nl\n;φ|R\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n}).\n3.3.2","","Predictive","User","Response","Distribution\nIn","what","follows,","we","discuss","the","principles","guiding","the","agent\nstrategy.","In","order","to","assign","a","good","predictive","probability,","the\nagent","has","to","findwandQsuch","that","(19)","is","minimized.","One\nway","to","tackle","the","problem","is","to","apply","a","maximin","criterion\nthat","","results","","in","","a","","mixture","","approach","","with","","a","","Bayesian","","flavor,\ni.e.,\nsup\nw\ninf\nQ\nD\nn\n(Q,w,{x\nref\n,x\nalt\n}).(20)\nFor","a","givenw(φ),the","minimizing","distribution","is","given","by\nthe","weighted","distribution\nQ\nw\n(r\nn\n1\n|{x\nref\n,x\nalt\n}\nn\n1\n)","=\n∫\nΩ\nw(φ)P(r\nn\n1\n|φ,{x\nref\n,x\nalt\n}\nn\n1\n)dφ,(21)\nand","","the","","corresponding","","weighted","","divergence","","is","","given","","by\nI\nw\n(R\nn\n1\n;φ|{x\nref\n,x\nalt\n}\nn\n1\n),where","","subscriptwindicates","","that\nsome","weighting","distributionw(φ)is","used.","The","agent,","how-\never,","has","to","assign","the","predictive","probabilities","sequentially,\nafter","every","interaction.","Sequential","assignment","gives","rise","to\nthe","","sequence","","probability","","assignment.","","It","","was","","shown","","in","","[8]\nthat","the","above","mixture","of\n{P(r\nn\n1\n|φ,{x\nref\n,x\nalt\n}\nn\n1\n),φ∈Ω}\ncan","be","represented","by","the","mixture","of","conditional","probability\nfunctions\n{P(r\nn\n|φ,r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n}),φ∈Ω},\nas\nQ\nw\n(r\nn\n|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n})\n=\n∫\nΩ\nw(φ|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)\n·P(r\nn\n|φ,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n})dφ,(22)\nwhere","the","weighting","function","is","a","posterior","distribution","of\nφgivenr\nn−1\n1\nand{x\nref\n,x\nalt\n}\nn−1\n1\n,","i.e.,\nw(φ|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)\n=p(φ|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)\n=\np(φ)p(r\nn−1\n1\n|φ,{x\nref\n,x\nalt\n}\nn−1\n1\n)\n∫\nΩ\np(φ\n′\n)p(r\nn−1\n1\n|φ\n′\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)dφ\n′\n,(23)\n\n6\nwhere","","the","","prior","","on","","the","","user","","preference","","parameters","","is","","in-\ndependent","","of","","trials.","","Moreover,","","the","","performance","","of","","this","","se-\nquential","assignment","is","the","same","as","the","performance","of","the\nassignment","when","the","whole","sequence","is","observed.","The","min-\nimizing","distribution","functionsQ\nw\n,","in","their","turn,","correspond\nto","","the","","normalized","","weighted","","information","","divergence","","given\nby\nD\nn\n(Q\nw\n,{x\nref\n,x\nalt\n})\n=\n1\nn\nn\n∑\nl=1\n∑\nr\nl\n∈{0,1}\n∫\nΩ\np(φ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)\n·P(r\nl\n|φ,r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n})\n·ln\nP(r\nl\n|φ,r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n})\nP(r\nl\n|{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n})\ndφ\n=\n1\nn\nn\n∑\nl=1\nI(R\nl\n;φ|R\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n}).(24)\nHere","we","have","made","a","choice","for","the","weighting","functions","up\nto","","the","","priorp(φ),","","given","","by","","(23).","","This","","is","","a","","sequential","","form\nof","","writing","","outD\nn\n(Q\nw\n,{x\nref\n,x\nalt\n})that","","coincides","","with","","the\nnon-sequential","result","given","byI\nw\n(R\nn\n;φ|{x\nref\n,x\nalt\n}\nn\n1\n).\nNote","that","in","this","universal","prediction","problem,","the","goal\nis","","to","","find","","a","","probability","","assignment","","that","","guarantees","","that\nthe","","predictor","","performs","","well","","for","","allφ.","","The","","supremum","","of\n1/nI\nw\n(R\nn\n;φ|{x\nref\n,x\nalt\n}\nn\n1\n)over","","all","","allowablew(φ)can","","be\ninterpreted","","as","","a","","capacity","","of","","the","","“channel”","","between","","the\nchannel","","outputR\nn\n1\nand","","the","","channel","","inputφwith","","side\ninformation{x\nref\n,x\nalt\n}\nn\n1\n,defined","","by","","the","","class","","of","","sources\n{P(·|φ,·),φ∈Ω}.This","","","capacity","","","is","","","given","","","byC\nn\n∆\n=\n1/nI\nw\n∗\n(R\nn\n;φ|{x\nref\n,x\nalt\n}\nn\n1\n),wherew\n∗\n(·)is","","","the","","","capacity\nachieving","prior,","and","then","it","holds","thatD\nn\n(P||Q\nw\n∗\n)≤nC\nn\n,\n∀φ,","guarantees","in","the","minimax","sense","that\nD\nn\n(P||Q)≥nC\nn\n,(25)\nOn","","the","","other","","hand,","","the","","strong","","converse","","theorem","","of","","[9]\nstates","","that","","under","","self-information","","loss,","","for","","any","","asymptoti-\ncally","","good","","approximation","","ofw\n∗\n(φ),","","there","","is","","a","","remarkable\nconcentration","phenomenon,","stating","that,","for","anyε",">0and\nw\n∗\n-most","values","ofφ,","it","holds","that\nD\nn\n(P||Q)≥(1−ε)nC\nn\n,∀Q.(26)\nThe","practical","problem","is","then","finding","the","capacity","achieving\nprior.","","However,","","the","","result","","in","","[10]","","allowsw(·)to","","be","","an\narbitrary","","weight","","function,","","thus","","telling","","thatQ\nw\nis","","optimal\nforw-most","points","inΩ:\nD\nn\n(P||Q)≥D\nn\n(P||Q\nw\n).(27)\nLet’s","look","at","the","interpretation","of","this","result.","This","capac-\nity","","gives","","information","","on","","the","","richness","","of","","the","","source","","class.\nThe","","capacity-achieving","","weighting","","function","","assigns","","higher\nweights","to","the","regions,","where","the","sources","are","better","discrim-\ninated","and","data","is","more","informative","about","the","parameters;\nand","","lower","","weights","","to","","the","","regions,","","where","","the","","sources","","are\ncloser.","Therefore,","in","the","problem","of","preference","learning,","the\nuse","","of","","posterior","","distribution","","ofφ,","","as","","weighting","","functions,\nhelps","us","to","evaluate","usefulness","of","the","data","generated","by","the\nagent","","for","","inference","","ofφ.","","We","","need","","to","","distinguish","","a","","single\nunknown","source.","Hence,","on","one","hand,","we","aim","at","attaining\nthe","lower","bound","on","the","information","divergence","and,","on","the\nother","","hand,","","at","","finding","","goodw(·)that","","further","","reduces","","this\nbound.","","In","","Section","","4,","","we","","further","","discuss","","approximation","","of\nthe","weighting","distributions","in","their","sequential","form.\n3.3.3","","Generative","Agent","Distribution\nNow","that","we","have","defined","the","predictorQ\nw\nto","be","used","by\nthe","agent","for","HA","system","characterization,","we","need","to","specify\nthe","","generative","","agent","","distribution.","","From","","the","","optimization\npoint","of","view,","the","agent","has","to","generate","the","proposals","that\nlead","to","the","optimal","user","preferences","as","quickly","as","possible.\nThis","","means","","that,","","for","","every","","interaction","","with","","a","","user,","","the\nagent","","has","","to","","provide","","a","","better","","alternative","","than","","a","","reference\nproposal,","","with","","high","","probability.","","This","","can","","be","","seen","","as","","a","","sort\nof","","gradient","","ascent","","method.","","Clearly,","","this","","alternative","","would\ncorrespond","to","the","user","preference","or","the","agent’s","estimate","of\nit.","","Therefore,","","the","","generative","","distribution","","of","","the","","alternative\nproposal","generation","would","coincide","with","the","distribution","of\nthe","optimal","HA","parameter","for","the","user.","This","is","a","marginal\nposterior","distribution","of","location","parameters.\nGiven","","the","","fact","","that","","the","","next","","reference","","proposal","","is","","just\na","","deterministic","","function","","of","","the","","previous","","trial","","and","","user","","re-\nsponse","","to","","it,","","the","","generative","","process","","for","","the","","next","","triallis\ngiven","by\np({x\nref\nl\n,x\nalt\nl\n}|φ,r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)\n∆\n=δ(x\nref\nl\n−x\nalt\nl−1\n)\nr\nl−1\n·δ(x\nref\nl\n−x\nref\nl−1\n)\n1−r\nl−1\n·\n∫\np(x\nalt\nl\n,γ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)dγ,(28)\nwherep(x\nalt\nl\n,γ|r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n)coincides","","with","","an","","ex-\npanded","","version","","of","","posterior","","(23).","","Thus,","","the","","agent","","gen-\nerative","","distribution","","functionsp\na\nl\nare","","given","","by","","(28),","","for\nl=","2,3,...,n.\n3.3.4","","Trial","Design\nNext,","we","look","at","the","problem","of","trial","generation","from","a","data\ninformativeness","","point","","of","","view.","","The","","agent","","trial","","generation\nprocess","is","given","by","(28).","The","trials,","generated","by","the","agent,\nresult","in","user","responses,","characterized","by","the","predictorQ\nw\n,\nwhich","","performance","","is","","given","","by","","the","","normalized","","weighted\ninformation","divergence","(24).","As","discussed","above,","this","infor-\nmation","","divergence","","tells","","us","","how","","well","","data","","helps","","to","","distin-\nguish","the","source,","i.e.,","the","individual","user","preferenceφ.As\nsuch,","we","can","also","interpret","this","performance","measure","as","the\nagent","uncertainty","about","the","user.\nFor","","the","","normalized","","weighted","","information","","divergence,\ntrials","","serve","","as","","a","","causal","","side","","information","","and","","are","","given\nvalues","produced","by","the","agent.","The","generative","agent","distri-\nbution","provides","the","“direction”","of","the","data","being","sought","for.\nHowever,","","to","","facilitate","","efficient","","learning","","of","","the","","optimal","","HA\nparameters,","we","also","need","to","produce","the","most","informative\ntrials.","To","evaluate","trial","informativeness,","we","use","the","normal-\nized","weighted","information","divergence,","by","looking","at","it","as","a\nfunction","of","trials.\nSince","","trials","","cause","","user","","responses,","","we","","gain","","the","","most\ninformation","from","getting","a","user","response","on","the","trial,","about\nwhich","our","predictor","is","most","uncertain.","Thus,","to","generate","the\nnext","","trial","","at","","timen,the","","agent","","should","","search","","for","","the","","worst\ncase","behavior","of","the","optimal","predictor","from","the","trial","(data)\nperspective,","i.e.,\n\n7\n{x\nref\nn\n,x\nalt\nn\n}=","","","","arg","max\n{x\nref\nn\n,x\nalt\nn\n}:\nP\na\nn\nD\nn\n(Q\nw\n,{x\nref\n,x\nalt\n})\n=","","","","arg","max\n{x\nref\nn\n,x\nalt\nn\n}:\nP\na\nn\nn\n∑\nl=1\nI(R\nl\n;φ|R\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\nl\n,x\nalt\nl\n})\n=","","","","arg","max\n{x\nref\nn\n,x\nalt\nn\n}:\nP\na\nn\nI(R\nn\n;φ|R\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n,{x\nref\nn\n,x\nalt\nn\n}),\n(29)\nhere","","due","","to","","sequential","","nature","","of","","interactions","","between","","the\nagent","and","the","user,","the","next","trial","to","be","generated","by","the","agent\ncorresponds","to","the","argument","of","the","maximum","of","the","mutual\ninformation","","between","","the","","predicted","","response","","for","","a","","given\nnext","trial","and","optimal","HA","parameters,","given","the","history","of\ninteractions.","We","call","this","last","term","underarg","maxweighted\nindividual","divergence.","This","concludes","the","agent","strategy","for\nthe","trial","design.\n4","","","","BAYESIANINFERENCE","FOR","THEUSERMODEL\nIn","the","previous","section,","we","defined","the","HA","system","and","the\nexperimental","design","strategy","to","obtain","the","data","required","for\ninference","of","the","user","model","or,","equivalently,","parameters","of\nthe","user","preference","function.","The","latter","is,","in","fact,","our","main\ngoal.","Indeed,","user","model","inference","and","experimental","design\nare","","intimately","","related.","","In","","the","","experimental","","design,","","we","","are\nalso","","concerned","","with","","user","","model","","inference,","","but","","there","","it","","is\nused","as","a","weighting","distribution.","In","general,","user","and","agent\ninteractions","are","sequential,","and,","in","the","experimental","design,\nthe","","agent","","also","","assigns","","predictive","","probability","","sequentially.\nTherefore,","we","concentrate","and","present","a","sequential","Bayesian\nprocedure","for","user","model","inference.\nRecall","that","in","the","predictive","probability","assignment","pro-\ncedure,","","we","","have","","specified","","the","","weighting","","(posterior)","","dis-\ntribution","","of","","the","","user","","model","","parameters","","up","","to","","the","","prior\np(φ).","","Therefore,","","we","","start","","here","","with","","this","","prior","","specification\nand","","assume","","the","","following","","prior","","distribution","","for","","the","","user\npreference","parameters:\np(φ)","=N\n(\nφ|μ\nφ\n,Σ\nφ\n)\n.(30)\nNext,","consider","data","points","from","the","user-agent","interactions\nin","the","HA","system,","denoted","byD\nn−1\n={r\nl\n,{x\nref\nl\n,x\nalt\nl\n}}\nn−1\nl=1\n.\nGiven","these","data","points,","we","work","out","the","posterior","(23)","as\np(φ|r\nn−1\n1\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)\n=\np(φ)p(r\nn−1\n1\n|φ,{x\nref\n,x\nalt\n}\nn−1\n1\n)\n∫\np(φ\n′\n)p(r\nn−1\n1\n|φ\n′\n,{x\nref\n,x\nalt\n}\nn−1\n1\n)dφ\n′\n=p(φ)·\nn−1\n∏\nl=1\np(r\nl\n|φ,r\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\nl\n,{x\nref\nl\n,x\nalt\nl\n})\nP(D\nl\n)\n=p(φ)·\nn−1\n∏\nl=1\np(r\nl\n|φ,{x\nref\nl\n,x\nalt\nl\n})\nP(D\nl\n)\n=N\n(\nφ|μ\nφ\n,Σ\nφ\n)\n·\nn−1\n∏\nl=1\n1\nC\nl\n·Φ\n(\nf(x\nref\nl\n;φ)−f(x\nalt\nl\n;φ)\n)\nr\nl\n·Φ\n(\nf(x\nalt\nl\n;φ)−f(x\nref\nl\n;φ)\n)\n1−r\nl\n,(31)\nwhereC\nl\nare","normalizing","constants,","and","where,","in","the","third\nequality,","","we","","used","","the","","Markov","","property,","","since","","the","","user","","re-\nsponse","only","depends","on","the","current","trial,","given","parameters\nof","","the","","preference","","function.","","While","","this","","expression","","provides\nus","with","an","analytical","expression","for","the","posterior,","its","exact\nestimation","","and","","use","","in","","the","","trial","","design","","is","","problematic,","","due\nto","","its","","non-linear","","form","","and","","complex","","integral","","evaluations.\nTherefore,","to","make","the","problem","tractable,","we","turn","to","approx-\nimate","","sequential","","estimation,","","based","","on","","Assumed","","Density\nFiltering","(ADF),","also","called","moment","matching,","see,","e.g.,","[11]\nand","","[12].","","The","","idea","","is","","to","","use","","a","","Gaussian","","distribution","","as","","an\napproximating","distribution","for","the","posterior.","This","allows","for\na","","simple","","update","","of","","the","","first","","and","","second","","moments","","of","","the\nposterior","after","each","trial.\nFollowing","the","ADF","approach,","we","define","̃p\n0\n(φ)\n∆\n=p(φ),\n","̃p\nl\n(φ)\n∆\n=p(r\nl\n|φ,{x\nref\nl\n,x\nalt\nl\n})and","re-write","the","posterior","distri-\nbution","in","the","following","way\np(φ|D\nn−1\n)","","","","=\nn−1\n∏\nl=1\n1\nC\nl\n·","̃p\nl\n(φ)≈q\nn−1\n(φ),(32)\nwhereq\nn−1\n(φ)is","","our","","approximating","","family,","","which","","we\nchoose","to","be","a","Gaussian","one,","i.e.,\nq\nn−1\n(φ)","=N\n(\nφ|μ\nφ,n−1\n,Σ\nφ,n−1\n)\n.(33)\nObserve","","that","","initially,","","at","","the","","beginning","","of","","interaction,","","we\nonly","","have","","the","","prior","","parameter","","distribution","","and","","do","","not\nneed","any","approximation.","Then,","after","each","trial,","we","need","to\nincorporate","","new","","evidence","","and","","perform","","an","","approximation.\nIn","","order","","to","","do","","this,","","after","","each","","triall,","","we","","take","","the","","“exact”\nposterior\nˆp(φ|D\nl\n)","","","","=\n","̃p\nl\n(φ)q\nl−1\n(φ)\n∫\n","̃p\nl\n(φ)q\nl−1\n(φ)dφ\n(34)\nand","find","the","approximating","distributionq\nl\n(·)that","minimizes\nthe","KL-divergence:\nq\nl\n(φ)",":","min\nq(·)\nD(","ˆp(φ|D\nl\n)||q(φ)),(35)\ngiven","","thatq\nl\n(·)belongs","","to","","the","","Gaussian","","approximation\nfamily.","","This","","problem","","is","","equivalent","","to","","the","","maximum","","likeli-\nhood","","estimation","","problem","","forˆp(φ|D\nl\n),and","","then","","the","","ADF\nprocedure","reduces","to","propagating","the","first","two","moments:\nμ\nφ,l\n=E\nq\nl\n(φ)\n[φ]","","","","=E\nˆp(φ|D\nl\n)\n[φ],(36)\nΣ\nφ,l\n=E\nq\nl\n(φ)\n[\n(φ−μ\nφ\n)\nT\n(φ−μ\nφ\n)\n]\n=E\nˆp(φ|D\nl\n)\n[\n(φ−μ\nφ\n)\nT\n(φ−μ\nφ\n)\n]\n.(37)\nThus,","","the","","problem","","of","","user","","model","","inference","","reduces","","to","","cal-\nculations","of","the","moments","of","the","“true”","posteriors.","Observe\nthat","the","first","moment,","given","by","(36-37),","provides","us","with","the\n(current)","estimate","of","the","parameters","of","the","user","preference\nfunction.\n5","","","","IMPLEMENTATION","","OF","","THESEQUENTIALPROCE-\nDURE","FORACTIVEUSERMODELINFERENCE\nAfter","","specification","","of","","the","","experimental","","design","","and","","user\nmodel","inference","approach,","we","describe","here","implementation\ndetails","for","sequential","active","user","model","inference.\n\n8\nWe","","start","","with","","initialization","","of","","the","","experimental","","design.\nTo","perform","an","initial","trial,","first","two","proposals","to","be","evalu-\nated","are","selected","uniformly","at","random,","i.e.,xandx\n′\naccord-\ning","toUniform\n(\n[0,1]\nD\n)\n.","Based","on","the","user","evaluation,","they\nform","the","first","trial{x\nref\n1\n,x\nalt\n1\n}.Furthermore,","the","model","prior\nis","given","by","(30)","as\np(φ)","=N\n(\nφ|μ\nφ,0\n,Σ\nφ,0\n)\n,\nwhereμ\nφ,0\n,Σ\nφ,0\nare","hyperparameters.\nAfter","","each","","interactionl,","l=","","1,2,...,n,","","we","","obtain","","the\nuser","","feedback","","on","","the","","trial,","","and","","thus","","the","","next","","data","","point\n{r\nl\n,{x\nref\nl\n,x\nalt\nl\n}}.","At","each","step,","we","need","to","calculate","the","mo-\nments","of","the","posterior","distributionμ\nφ,l\n,Σ\nφ,l\n.To","avoid","calcu-\nlations","of","integrals","for","non-linear","distribution","functions,","we\nuse","Monte-Carlo","simulations","to","infer","the","user","model","distri-\nbution.","We","apply","the","Metropolis–Hastings","(MH)","sampling\nalgorithm,","forD\nl\n,","according","to","the","following","model:\nφ∼","N\n(\nμ\nφ,l−1\n,Σ\nφ,l−1\n)\n(38)\nr\nl\n∼","Bernoulli\n(\nΦ(f(x\nalt\nl\n;φ)−f(x\nref\nl\n;φ)\n)\n.(39)\nThe","MH","simulations","result","in","a","sequence","of","samples","or","pos-\nterior","sample,","denoted","by","̃q\nl\n(φ).","This","sample","is","further","used\nto","","calculate","","the","","corresponding","","moments,","","using","","maximum\nlikelihood","estimation:\nμ\nφ,l\n=\n1\nM\n∑\nφ\nj\n∼","̃q\nl\n(φ)\nφ\nj\n,(40)\nΣ\nφ,l\n=\n1\nM−1\n∑\nφ\nj\n∼","̃q\nl\n(φ)\n(φ\nj\n−μ\nφ,l\n)\nT\n(φ\nj\n−μ\nφ,l\n).(41)\nHence,","we","obtain","approximate","posterior,","given","byq\nl\n(φ)","=\nN\n(\nφ|μ\nφ,l\n,Σ\nφ,\n)\n,","forl=","1,2,...,n.\nTo","perform","the","trial","design","at","stepl,we","use","the","approxi-\nmate","posterior","as","a","weighting","distribution.","Then,","we","need","to\ncalculate","the","agent","uncertainty","about","the","user","in","stepl,","given\nby","the","mutual","information","in","(29).","This","mutual","information\nexpression","can","be","further","worked","out","as\nI(R;φ|R\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\n,x\nalt\n})≈\nH(R|D\nl−1\n,{x\nref\n,x\nalt\n})−E\nq\nl\n(φ)\n[\nH\n(\nR|φ,{x\nref\n,x\nalt\n}\n)]\n.\n(42)\nRecall","that","our","main","goal","is,","in","fact,","inference","of","the","location\nparameter","in","the","user","model.","Therefore,","we","decided","to","treat\nthe","","sensitivity","","parameter","","as","","a","","nuisance","","parameter.","","In","","this\ncase,","","we","","have","","to","","modify","","the","","objective,","","given","","above,","","by\nintegrating","out","the","sensitivity","parameter","and,","hence,","arrive\nat","the","following","expression:\nI(R;α|R\nl−1\n1\n,{x\nref\n,x\nalt\n}\nl−1\n1\n,{x\nref\n,x\nalt\n})\n≈H(R|D\nl−1\n,{x\nref\n,x\nalt\n})\n−E\nq\nl\n(α)\n[\nH\n(\nE\nq\nl\n(γ|α)\n[\nR|α,γ,{x\nref\n,x\nalt\n}\n])]\n.(43)\nThen,","","since","","our","","joint","","approximate","","posterior","","is","","Gaussian,\nwhich","first","and","second","moments","can","be","written","as\nμ\nφ,l\n=\n[\nμ\nα,l\nμ\nγ,l\n]\n,Σ\nφ,l\n=\n[\nΣ\nα,l\nΣ\nαγ,l\nΣ\nγα,l\nΣ\nγ,l\n]\n,(44)\nthe","approximate","marginalq\nl\n(α)is","also","Gaussian\nq\nl\n(α)","","","","=N(α|μ\nα,l\n,Σ\nα,l\n),(45)\nand","so","the","conditional","distributionsq\nl\n(γ|α),which","expec-\ntation","and","covariance","are","given,","according","to","the","Markov-\nGauss","theorem,","by\nμ\nγ|α,l\n=μ\nγ,l\n+","Σ\nγα,l\nΣ\n−1\nα,l\n(\nα−μ\nα,l\n)\n(46)\nΣ\nγ|α,l\n=","","","","Σ\nγ,l\n−Σ\nγα,l\nΣ\n−1\nα,l\nΣ\nαγ,l\n.(47)\nObserve","","that","","decomposition","","of","","(43)","","allows","","for","","easier\ncomputation","","of","","the","","mutual","","information,","","since","","the","","entropy\nterms","","are","","binary","","entropy","","functions,","","defined","","byh(p)\n∆\n=\n−plog\n2\np−(1−p)","log\n2\n(1−p).","Furthermore,","we","approximate\nthe","integrals","by","the","sums","and","calculate","the","entropy","terms","in\n(43)","as","follows\nH(R|D\nl−1\n,{x\nref\n,x\nalt\n})\n=h\n(\np(r|D\nl\n,{x\nref\n,x\nalt\n}\n)\n=h\n(\n∫\np(r|φ,{x\nref\n,x\nalt\n})·p(φ|D\nl−1\n)dφ\n)\n≈h\n\n\n∑\n{φ\nm\n}\nM\nm=1\n∼q\nl\n(φ)\nΦ","(ν(φ\nm\n))·N\n(\nφ\nm\n|μ\nφ,l\n,Σ\nφ,l\n)\n∑\nM\nm=1\nN\n(\nφ\nm\n|μ\nφ,l\n,Σ\nφ,l\n)\n\n\n,\n(48)\nwhereν(φ\nm\n)\n∆\n=f(x\nref\n;φ\nm\n)−f(x\nalt\n;φ\nm\n)and\nE\nq\nl\n(α)\n[\nH\n(\nE\nq\nl\n(γ|α)\n[\nR|α,γ,{x\nref\n,x\nalt\n}\n])]\n≈\n∑\n{α\nm\n}\nM\nm=1\n∼q\nl\n(α)\nN\n(\nα\nm\n|μ\nα,l\n,Σ\nα,l\n)\n∑\nM\nm=1\nN\n(\nα\nm\n|μ\nα,l\n,Σ\nα,l\n)\n·h\n\n\n\n∑\n{γ\nm\n′\n}\nM\n′\nm\n′\n=1\n∼q\nl\n(γ|α\nm\n)\nΦ","(ν(α\nm\n,γ\nm\n′\n))\n·\nN\n(\nγ\nm\n′\n|μ\nγ|α,n\n,Σ\nγ|α,l\n)\n∑\nM\n′\nm\n′\n=1\nN\n(\nγ\nm\n′\n|μ\nγ|α,l\n,Σ\nγ|α,l\n)\n\n\n,(49)\nwhereν(α\nm\n,γ\nm\n′\n)is","defined","in","a","similar","way","as","above,","but\nwith","expanded","parameters,","see","also","(14).\nNext,","","the","","generative","","agent","","distribution","","for","","the","","trials","","is\ngiven","by\np\na\nl\n=δ(x\nref\nl\n−x\nalt\nl−1\n)\nr\nl−1\n·δ(x\nref\nl\n−x\nref\nl−1\n)\n1−r\nl−1\n·N(x\nalt\nl\n|μ\nα,l\n,Σ\nα,l\n).(50)\nTherefore,","generating","trials","from","this","distribution","is","equiva-\nlent","to","setting\nx\nref\nl\n=","","","","(x\nalt\nl−1\n)\nr\nl−1\n·(x\nref\nl−1\n)\n1−r\nl−1\n(51)\nand","generating","an","alternative","proposal","according","to\nx\nalt\nl\n∼","N(x\nalt\nl\n|μ\nα,l\n,Σ\nα,l\n).(52)\nFinally,","","given","","the","","expressions","","above,","","the","","trial","","design\nconstitutes","generating","a","pool","of","alternative","proposals,","using\n(52),","calculating","mutual","information","terms","for","the","resulting\ntrials,","using","(48)","and","(49),","and","selecting","the","alternative","that\ncorresponds","","to","","the","","highest","","mutual","","information","","term.","","This\nprocedure","is","also","given","in","Alg.","1,","whereMI(·)is","computed,\nusing","(48)","and","(49).\nOur","","learning","","procedure","","can","","be","","summarized","","as","","a","","se-\nquential","","process","","of","","trials","","and","","user","","model","","inferences,","","with\n\n9\nAlgorithm","1:Trial","design\nData:\n•q\nl−1\n(φ)–","approximate","posterior","afterl−1\ninteractions\n•{x\nref\nl−1\n,x\nalt\nl−1\n}–","trial","atl−1-th","interaction\n•r\nl−1\n–","reply","tol−1-th","trial\n•M,M\n′\n–","number","of","Monte-Carlo","samples\n•N–","number","of","samples","for","alternative","proposal\ngeneration\nResult:\n•{x\nref\nl\n,x\nalt\nl\n}–","new","trial\n•D\nl\n–","system","uncertainty","or","weighted","individual\nKL-divergence","ofl-th","step\n1x\nref\nl\n←(x\nalt\nl−1\n)\nr\nl−1\n·(x\nref\nl−1\n)\n1−r\nl−1\n;\n2x\nalt\nl\n←Sample(q\nl−1\n(φ));\n3D\nl\n←MI(M,M\n′\n,q\nl−1\n(φ),x\nalt\nl\n,x\nref\nl\n);\n4fori←1toN−1do\n5x\nalt\n←Sample(q\nl−1\n(φ));\n6D←MI(M,M\n′\n,q\nl−1\n(φ),x\nalt\n,x\nref\nl\n);\n7ifD\nl\n<","Dthen\n8x\nalt\nl\n←x\nalt\n;\n9D\nl\n←D\n10end\n11end\nthe","","stopping","","criterion,","","determined","","by","","convergence","","of","","the\nnormalized","","weighted","","KL-divergence,","","in","","a","","sense","","that","","con-\nvergence","is","achieved,","when","uncertainty","reduction","becomes\nsmaller","","than","","some","","small","","predefinedδ.The","","learning","","pro-\ncedure","","is","","also","","provided","","as","","a","","pseudo-code","","in","","Alg.","","2.","","There\nMH(·)is","","computed","","using","","the","","MH-sampling","","according","","to\nthe","","model,","","given","","by","","(38)-(39),","","followed","","by","","calculations","","in\n(40)","and","(41).\n6","","","","SIMULATIONRESULTS\nIn","this","section,","we","present","simulation","results","for","user","pref-\nerence","learning.","The","user","model","is","given","by","Def.","2.1,","where\ntwo","","HA","","parameters","","have","","to","","be","","learned.","","We","","also","","simulate\nuser","","responses","","by","","sampling","","them","","according","","to","","the","","user\nmodel,","in","order","to","create","the","whole","interaction","cycle","of","the\nHA","system,","see","Fig.","1.","In","our","simulations,","we","know","the","true\nvalues","","of","","the","","user","","preference","","function,","","and","","our","","goal","","is","","to\ninvestigate","a","number","of","aspects","of","the","proposed","approach.\nFirst,","","we","","are","","interested","","to","","show","","feasibility","","of","","learning","","the\ntrue","preferences","by","showing","that","estimated","user","preferences\nfor","","HA","","parameters","","converge","","to","","the","","true","","user","","preferences\nfor","","a","","simulated","","user.","","Moreover,","","since,","","in","","practice,","","user\npreferences","are","unknown,","our","goal","is","to","validate","that","agent\nuser","","uncertainty","","provides","","a","","good","","metric","","for","","performance\nmonitoring","","of","","user","","preference","","learning.","","As","","a","","benchmark,\nwe","use","root-mean-squared","error","(RMSE),","that","can","be","used\nwhen","the","true","preference","is","known.\nThe","","numerical","","experiments","","were","","implemented","","in","","Julia\n1.3","[13],","where","probabilistic","modeling","was","realized","in","prob-\nabilistic","","programming","","language","","(PPL),","","using","","the","","Turing.jl\n0.14.10","","package","","[14].","","In","","particular,","","Turing.jl","","was","","used","","to\nAlgorithm","2:Learning","procedure\nData:\n•q\n0\n(φ)–","model","prior\n•{x\nref\n1\n,x\nalt\n1\n}–","initial","trial\n•r\n1\n–","reply","to","the","initial","trial\n•M,M\n′\n–","number","of","Monte-Carlo","samples\nResult:\n•q(φ)–","user","model","parameter","distribution\n•E\nq\n(α)–","optimal","HA","parameter","estimate\n•D–","remaining","system","uncertainty\n1l←0;\n2D\nl\n←∞;\n3D←0;\n4whileD\nl\n>","lδdo\n5l←l+","1;\n6{x\nref\nl\n,x\nalt\nl\n},D\nl\n←\nTrialDesign(q\nl−1\n(φ),{x\nref\nl−1\n,x\nalt\nl−1\n},r\nl−1\n);\n7D←D+D\nl\n;\n8r\nl\n←Trial({x\nref\nl\n,x\nalt\nl\n});\n9q\nl\n(φ)←MH(M,μ\nφ,l−1\n,Σ\nφ,l−1\n,{x\nref\nl\n,x\nalt\nl\n},r\nl\n)\n10end\n11q(φ)←q\nl\n(φ);\n12E\nq\n(α)←μ\nα,l\n;\n13D←D/l;\nimplement","the","Monte-Carlo","sampling","method","in","Alg.","2.","We\nused","a","desktop","computer","with","Intel","i7","CPU","Core","and","32","GB\nof","RAM.","Under","these","conditions,","one","interaction","step","took\nabout","1.05","sec.\nFig.","2","shows","the","true","optimal","parameters,","their","estimates\nand","","the","","proposals,","","generated","","by","","our","","agent","","together","","with\nthe","","estimated","","parameter","","distribution.","","Note","","that","","as","","more\nand","more","data","becomes","available,","the","posterior","distribution\nconverges","","and","","become","","very","","dense","","around","","the","","optimum,\nand","","thus","","the","","proposals","","would","","eventually","","coincide","","with\nor","","become","","very","","close","","to","","the","","true","","optimum.","","At","","the","","early\nstage","","of","","learning,","","though,","","the","","proposals","","need","","not","","be","","close\nto","","the","","optimum.","","At","","this","","stage,","","the","","exploration","","process","","is\ndominating,","where","the","agent","generates","proposals","that","aim\nat","largest","reduction","of","the","uncertainty","about","a","user.","Indeed,\nlooking","at","Fig.","2,","we","see","that","the","alternative","proposals","at","the\nbeginning","of","the","learning","process","are","spread","further","away\nfrom","the","estimated","distribution","mean","than","at","the","later","stages\nof","learning.","In","general,","we","see","that","the","learning","procedure\nof","","the","","optimum","","user","","preferences","","converges","","quickly","","to","","the\ntrue","","optimum.","","Moreover,","","if","","we","","look","","at","","RMSE","","and","","the\nagent","uncertainty","about","the","user,","which","we","shortly","call","here\nremaining","system","uncertainty","(RSU),","we","see","that","both","RMSE\nand","","RSU","","decrease","","with","","time,","","show-casting","","quick","","learning\nperformance","","of","","our","","approach.","","We","","run","","the","","simulations","","for\n30","","interactions,","","but","","we","","see","","that","","a","","good","","estimate","","can","","be\nachieved","with","less","than","20","interactions.","While","RSU","follows\nthe","trend","of","RMSE,","we","see","that","RMSE","is","more","sensitive","to\ninconsistencies","in","the","point","estimator.","RSU","is","smoother,","since\nit","is","a","functional","of","the","user","response","distribution.","Moreover,\nas","","a","","functional,","","it","","provides","","more","","information","","about","","the\n\n10\n(a)\n(b)\n(c)\n(d)\n(e)(f)\nFig.","2:","The","inferred","HA","parameter","distribution","after","1,","7,","20","and","30","interactions","in","(a)-(d)","and","the","corresponding","RMSE,","in\n(e),","and","RSU,","in","(f).","The","red","star","denotes","the","true","preference,","green","dots","and","connecting","lines","denote","the","trajectory","of","the\npreference","estimates","before","each","interaction,","the","red","dot","corresponds","to","the","current","user","preference","from","the","last","trial","and\nthe","magenta","dot","to","the","alternative","proposal.\n\n11\n(a)(b)\n(c)\n(d)\n(e)(f)\nFig.","3:","The","inferred","HA","parameter","distribution","after","one,","10,","15","and","30","interactions,","in","(a)-(d),","and","the","corresponding","RMSE,\nin","(e),","and","RSU,","in","(f).","Notations","in","(a)-(d)","are","the","same","as","in","Fig.","2\n\n12\n(a)","Root-mean-squared","error","(RMSE)(b)","Remaining","system","uncertainty","(RSU)\nFig.","4:","RMSE","and","RSU","with1σconfidence","intervals\nlearning","","behavior","","than","","a","","point","","estimator.","","Observe","","that,","","in\nFig.","","3,","","RSU","","goes","","up","","in","","situations","","when","","the","","user","","becomes\nless","","consistent","","in","","his","","responses,","","but","","in","","the","","end","","stabilizes\nas","","the","","responses","","become","","more","","reliable","","and,","","consequently,\nthe","distribution","estimate","becomes","better.","This","demonstrates\nthat","RSU","can","efficiently","be","used","to","monitor","the","preference\nlearning","performance","in","the","field.\nStatistical","","behavior","","of","","the","","performance","","metrics,","","RMSE\nand","RSU,","is","shown","in","Fig.","4a","and","Fig.","4b,","respectively.","These\nresults","were","obtained","by","simulating","the","learning","procedure\nT=","10times,","where","each","time","a","new","true","user","preference\nwas","selected","at","random,","and","simulatingn=","30interactions\nin","each","learning","cycle.\n7","","","","DISCUSSIONS","ANDCONCLUSIONS\nIn","this","paper,","we","have","studied","the","problem","of","active","pref-\nerence","","learning","","using","","pairwise","","comparison","","in","","the","","context\nof","","HA","","applications.","","The","","presented","","results,","","however,","","are\ngeneric","and","not","only","limited","to","HA","applications.","We","have\nmodeled","the","HA","system","as","two","interacting","sub-systems,","one\nrepresenting","a","user","with","his","preferences","for","HA","parameters\nand","","another","","one","","representing","","the","","agent","","that","","guides","","the\nlearning","","process","","by","","offering","","informative","","trials.","","In","","order","","to\nmonitor","the","learning","behavior","and","realize","the","agent","strategy\nfor","","obtaining","","efficient","","data","","from","","interactions","","with","","a","","user,\nwe","","have","","proposed","","to","","use","","the","","weighted","","normalized","","infor-\nmation","divergence.","This","divergence","characterizes","the","agent\nuncertainty","about","the","user.","Simulation","results","show","that","this\nweighted","normalized","information","divergence","can","be","used","to\nmonitor","the","learning","behavior","of","the","agent","in","practice,","when\nthe","true","user","preference","is","unknown.","Moreover,","we","also","see\nthat","the","agent","trial","generation,","based","on","this","metric,","results\nin","quick","reduction","of","the","search","space","for","the","optimal","user\nparameter","preferences","and","their","accurate","estimation.\nOur","work","has","a","close","connection","to","universal","prediction,\nas","","well","","as","","universal","","source","","coding.","","Here,","","however,","","our\ngoal,","when","assigning","a","predictive","distribution,","is","user","model\nquality","evaluation.","Moreover,","the","problem","we","study","relates\nto","the","active","inference","problem,","see","e.g.","[15].","However,","we\ntake","","somewhat","","different","","approach","","at","","learning.","","Instead","","of\nputting","","a","","focus","","on","","designing","","trials","","that","","minimize","","uncer-\ntainty","","about","","(future)","","user","","responses","","and","","thus","","aiming","","at\nsupporting","the","current","estimates,","we","look","at","the","trials","that\nresult","","in","","the","","largest","","uncertainty","","in","","the","","user","","response","","and\nsolicit","","responses","","to","","correct","","the","","estimate","","and","","resolve","","the\nuncertainty.","","Approximate","","inference,","","i.e.,","","ADF,","","plays","","a","","role\nin","","our","","work,","","when","","we","","infer","","the","","parameters","","of","","the","","user\npreference","function,","given","actively","generated","and","observed\ndata.\nREFERENCES\n[1]G.","Keidser,","H.","Dillon,","M.","Flax,","T.","Ching,","and","S.","Brewer,","“The","nal-\nnl2","prescription","procedure,”Audiology","Research,","vol.","1,","2011.\n[2]M.","","Cox","","and","","B.","","de","","Vries,","","“A","","parametric","","approach","","to","","bayesian\noptimization","","with","","pairwise","","comparisons,”","","inNIPS","","Workshop","","on\nBayesian","Optimization","(BayesOpt","2017),","December","9,","2017,","Long","Beach,\nUSA,","2017.\n[3]N.","","S.","","Jensen,","","O.","","Hau,","","J.","","B.","","B.","","Nielsen,","","T.","","B.","","Nielsen,","","and","","S.","","V.\nLegarth,","","","“Perceptual","","effects","","","of","","","adjusting","","","hearing-aid","","","gain","","by\nmeans","of","a","machine-learning","approach","based","on","individual","user\npreference,”Trends","in","Hearing,","vol.","23,","2019.\n[4]E.","Brochu,","V.","M.","Cora,","and","N.","de","Freitas,","“A","tutorial","on","Bayesian\noptimization","of","expensive","cost","functions,","with","application","to","ac-\ntive","user","modeling","and","hierarchical","reinforcement","learning,”","2010.\n[5]N.","Merhav","and","M.","Feder,","“Universal","prediction,”IEEE","Transactions\non","Information","Theory,","vol.","44,","no.","6,","1998.\n[6]W.","","R.","","Ashby,","","“The","","measurement","","of","","values.","","By","","L.","","L.","","Thurstone.\nUniversity","","of","","Chicago","","Press,","","Chicago,","","1959.","","Pp.","","322.”Journal","","of\nMental","","Science,","","vol.","","105,","","no.","","441,","","pp.","","1127–1127,","","Oct.","","1959,","","pub-\nlisher:","Cambridge","University","Press.\n[7]T.","","M.","","Cover","","and","","E.","","Ordentlich,","","“Universal","","portfolios","","with","","side\ninformation,”IEEE","Transactions","on","Information","Theory,","vol.","42,","no.","2,\npp.","348–363,","1996.\n[8]T.","Matsushima,","H.","Inazumi,","and","S.","Hirasawa,","“A","class","of","distor-\ntionless","codes","designed","by","bayes","decision","theory,”IEEE","Transac-\ntions","on","Information","Theory,","vol.","37,","no.","5,","pp.","1288–1293,","1991.\n[9]N.","Merhav","and","M.","Feder,","“A","strong","version","of","the","redundancy-\ncapacity","theorem","of","universal","coding,”IEEE","Transactions","on","Infor-\nmation","Theory,","vol.","41,","no.","3,","pp.","714–722,","1995.\n[10]","","M.","","Feder","","and","","N.","","Merhav,","","“Hierarchical","","universal","","coding,”IEEE\nTransactions","","on","","Information","","Theory,","","vol.","","42,","","no.","","5,","","pp.","","1354–1364,\n1996.\n[11]","","M.","Opper,A","Bayesian","approach","to","on-line","learning.","","","USA:","Cambridge\nUniversity","Press,","1999,","p.","363–378.\n[12]","","S.","","","Solla","","","and","","","O.","","","Winther,Optimal","","","erceptron","","","learning:","","","as","","","online\nBayesian","","approach.USA:","","Cambridge","","University","","Press,","","1999,","","p.\n379–398.\n[13]","","J.","","","Bezanson,","","","A.","","","Edelman,","","","S.","","","Karpinski,","","","and","","","V.","","","B.","","","Shah,\n“Julia:","","","A","","","fresh","","","approach","","","to","","","numerical","","","computing,”SIAM\nreview,","","","vol.","","","59,","","","no.","","","1,","","","pp.","","","65–98,","","","2017.","","","[Online].","","","Available:\nhttps://doi.org/10.1137/141000671\n\n13\n[14]","","H.","","Ge,","","K.","","Xu,","","and","","Z.","","Ghahramani,","","“Turing:","","a","","language","","for\nflexible","","","probabilistic","","","inference,”","","","inInternational","","","Conference","","","on\nArtificial","","","Intelligence","","","and","","","Statistics,","","","AISTATS","","","2018,","","","9-11","","","April\n2018,","","","Playa","","","Blanca,","","","Lanzarote,","","","Canary","","","Islands,","","","Spain,","","","2018,","","","pp.\n1682–1690.","","","[Online].","","","Available:","","","http://proceedings.mlr.press/\nv84/ge18b.html\n[15]","","K.","","Friston,","","“The","","free-energy","","principle:","","A","","rough","","guide","","to","","the\nbrain?”Trends","","in","","Cognitive","","Sciences,","","vol.","","13,","","no.","","7,","","pp.","","293–301,\n2009.\nTanya","","","Ignatenko","","","(S’06-M’08)was","","","born","","","in\nMinsk,","Belarus,","in","1978.","She","received","the","M.Sc.\ndegree","","in","","applied","","mathematics","","from","","Belarus-\nsian","","State","","University,","","Minsk,","","in","","2001.","","She","","re-\nceived","","the","","P.D.Eng.","","and","","Ph.D.","","degrees","","from\nEindhoven","University","of","Technology,","Eindhoven,\nThe","","Netherlands,","","in","","2004","","and","","2009,","","respec-\ntively.\nFrom","2008","till","2010,","she","was","a","a","postdoctoral\nresearcher","at","Eindhoven","University","of","Technol-\nogy;","","from","","2011","","till","","2013,","","she","","was","","a","","research\nscientist","at","Philips","Research","Laboratories,","and","from","2013","till","2018","she\nwas","","an","","assistant","","professor","","at","","the","","Electrical","","Engineering","","Department,\nEindhoven","University","of","Technology.","Currently","she","is","a","senior","research\nscientist","in","the","R&D","Global","Research,","GN","Group.","Her","research","contri-\nbutions","and","interests","are","in","the","areas","of","Bayesian","learning,","information\ntheory,","and","biometric","and","physical-layer","system","privacy","and","security.\nDr.","","Ignatenko","","is","","a","","recipient","","of","","the","","2011","","IEEE","","Signal","","Processing\nSociety","","Best","","Paper","","Award","","for","","the","","paper","","“Biometric","","Systems:","","Privacy\nand","","Security","","Aspects,”","","she","","also","","received","","two","","conference","","Best","","Paper\nAwards","in","2009","and","2014.","Dr.Ignatenko","served","as","Associate","Editor","for\nIEEE","Transactions","on","Information","Forensic","and","Security","(2015-2018),\nShe","has","published","more","than","50","journal,","conference","papers","and","book\nchapters.","She","holds","a","number","of","patents.\nKirill","Kondrashovreceived","his","MSc","(2012)","and\nPh.D.","","(2017)","","degrees","","from","","Bauman","","Moscow\nState","Technical","University","(BMSTU).","From","2012\nto","","2016,","","aside","","from","","being","","a","","postdoctoral","","re-\nsearcher","","in","","BMSTU,","","he","","worked","","as","","an","","algo-\nrithm","","designer","","and","","embedded","","software","","devel-\noper","","with","","machine","","learning","","and","","target","","track-\ning","","focus.","","Later,","","he","","grew","","to","","a","","senior","","embed-\nded","software","developer","in","the","field","of","measure-\nment","","devices","","within","","Prodim","","International","","B.V.\n(the","Netherlands,","2016-2018).\nCurrently,","","he","","is","","a","","research","","scientist","","in","","the","","R&D","","Global","","Research,\nGN","Group.","His","research","interests","center","around","the","development","and\napplication","of","machine","learning,","target","tracking,","and","embedded","software\ndesign.\nMarco","Coxreceived","his","MSc","degree","(2014)","in\nElectical","Engineering","from","Eindhoven","University\nof","Technology","(TU/e).","He","currently","is","a","PhD","stu-\ndent","at","the","department","of","Electrical","Engineering\nat","TU/e","working","in","the","field","of","Bayesian","machine\nlearning","","for","","signal","","processing","","systems.","","Since\n2018","he","is","also","a","consultant","for","the","R&D","Global\nResearch,","GN","Group.\nBert","de","Vries","(M’85)received","MSc","(1986)","and\nPhD","","(1991)","","degrees","","in","","Electrical","","Engineering\nfrom","Eindhoven","University","of","Technology","(TU/e)\nand","the","University","of","Florida,","respectively.","From\n1992","until","1999","he","worked","at","Sarnoff","Research\nCenter","in","Princeton","(NJ),","where","he","contributed\nto","research","projects","over","a","wide","range","of","signal\nand","image","processing","topics","such","as","word","spot-\nting,","financial","market","prediction","and","breast","can-\ncer","","detection","","from","","mammograms.","","Since","","April\n1999","he","has","been","employed","in","the","hearing","aids\nindustry","","(currently","","at","","GN","","Hearing),","","both","","as","","a","","Principal","","Scientist","","and\nas","a","Research","Manager.","Since","January","2012","he","is","also","a","(part-time)\nProfessor","at","the","Signal","Processing","Systems","Group","at","TU/e,","where","he","di-\nrects","the","BIASlab","team","that","conducts","research","on","developing","Bayesian\nmachine","learning","techniques","for","efficient","tuning","of","hearing","aids."],"doc24":["\n\nSolving","and","Learning","Nonlinear","PDEs","with","Gaussian","Processes\nYifan","","Chen","",",","","Bamdad","","Hosseini","",",","","Houman","","Owhadi","",",andAndrew","","M","","Stuart\n∗\nAbstract.We","","introduce","","a","","simple,","","rigorous,","","and","","unified","","framework","","for","","solving","","nonlinear","","partial","","differential\nequations","(PDEs),","and","for","solving","inverse","problems","(IPs)","involving","the","identification","of","parameters\nin","PDEs,","using","the","framework","of","Gaussian","processes.","","The","proposed","approach","(1)","provides","a","natural\ngeneralization","of","collocation","kernel","methods","to","nonlinear","PDEs","and","IPs,","(2)","has","guaranteed","conver-\ngence","with","a","path","to","compute","error","bounds","in","the","PDE","setting,","and","(3)","inherits","the","state-of-the-art\ncomputational","complexity","of","linear","solvers","for","dense","kernel","matrices.","","The","main","idea","of","our","method\nis","to","approximate","the","solution","of","a","given","PDE","with","a","MAP","estimator","of","a","Gaussian","process","given","the\nobservation","of","the","PDE","at","a","finite","number","of","collocation","points.","","Although","this","optimization","prob-\nlem","is","infinite-dimensional,","it","can","be","reduced","to","a","finite-dimensional","one","by","introducing","additional\nvariables","","corresponding","","to","","the","","values","","of","","the","","derivatives","","of","","the","","solution","","at","","collocation","","points;","","this\ngeneralizes","the","representer","theorem","arising","in","Gaussian","process","regression.","","The","reduced","optimiza-\ntion","problem","has","a","quadratic","loss","and","nonlinear","constraints,","and","it","is","in","turn","solved","with","a","variant\nof","the","Gauss-Newton","method.","","The","resulting","algorithm","(a)","can","be","interpreted","as","solving","successive\nlinearizations","of","the","nonlinear","PDE,","and","(b)","is","found","in","practice","to","converge","in","a","small","number","(two\nto","ten)","of","iterations","in","experiments","conducted","on","a","range","of","PDEs.","","For","IPs,","while","the","traditional\napproach","has","been","to","iterate","between","the","identifications","of","parameters","in","the","PDE","and","the","numerical\napproximation","of","its","solution,","our","algorithm","tackles","both","simultaneously.","","Experiments","on","nonlin-\near","","elliptic","","PDEs,","","Burgers’","","equation,","","a","","regularized","","Eikonal","","equation,","","and","","an","","IP","","for","","permeability\nidentification","in","Darcy","flow","illustrate","the","efficacy","and","scope","of","our","framework.\nKey","words.Kernel","Methods,","Gaussian","Processes,","Nonlinear","Partial","Differential","Equations,","Inverse","Problems,\nOptimal","Recovery.\nAMS","subject","classifications.60G15,","65M75,","65N75,","65N35,","47B34,","41A15,","35R30,","34B15.\n1.","","Introduction.Two","hundred","years","ago,","modeling","a","physical","problem","and","solving","the\nunderlying","differential","equations","would","have","required","the","expertise","of","Cauchy","or","Laplace,","and\nit","would","have","been","done","by","hand","through","a","laborious","process","of","discovery.","","Sixty","years","ago,\nthe","resolution","of","the","underlying","differential","equation","would","have","been","solved","using","computers,\nbut","modeling","and","design","of","the","solver","would","have","still","been","done","by","hand.","","Nowadays,","there","is\nincreasing","interest","in","automating","these","steps","by","casting","them","as","machine","learning","problems.\nThe","resulting","methods","can","be","divided","into","two","main","categories:","(1)","methods","based","on","variants\nof","","artificial","","neural","","networks","","(ANNs)","","[19];","","and","","(2)","","methods","","based","","on","","kernels","","and","","Gaussian\nProcesses","(GPs)","[78,","57].","","In","the","context","of","(1)","there","has","been","recent","activity","toward","solving\nnonlinear","PDEs,","whilst","the","systematic","development","of","methods","of","type","(2)","for","nonlinear","PDEs\nhas","","remained","","largely","","open.","","","However,","","methods","","of","","type","","(2)","","hold","","potential","","for","","considerable\nadvantages","","over","","methods","","of","","type","","(1),","","both","","in","","terms","","of","","theoretical","","analysis","","and","","numerical\nimplementation.","In","this","paper,","our","goal","is","to","develop","a","simple","kernel/GP","regression","framework\nfor","solving","nonlinear","PDEs","and","related","inverse","problems","(IPs)","with","the","following","properties:\n•it","is","a","direct","generalization","of","optimal","recovery","kernel","methods","for","linear","PDEs","[35,","36,\n∗\nComputing","and","Mathematical","Sciences,","Caltech,","Pasadena,","CA","(yifanc@caltech.edu,","bamdadh@caltech.edu,\nowhadi@caltech.edu,","astuart@caltech.edu).\n1\narXiv:2103.12959v1","","[math.NA]","","24","Mar","2021\n\n2Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\n39],","and","a","natural","generalization","of","radial","basis","function","collocation","methods","[80,","77],\nand","of","meshless","kernel","methods","[53];\n•theoretically,","the","proposed","method","is","provably","convergent","and","amenable","to","rigorous\nnumerical","analysis;\n•computationally,","it","inherits","the","complexity","of","state-of-the-art","solvers","for","dense","kernel\nmatrices","[54].\nSince","ANN","methods","can","also","be","interpreted","as","kernel","methods","with","kernels","learned","from","data\n[23,","37,","79],","our","framework","could","also","be","used","for","theoretical","analysis","of","such","methods.\nIn","Subsection","1.1","we","summarize","the","theoretical","foundations","and","numerical","implementation\nof","our","method","in","the","context","of","a","simple","nonlinear","elliptic","PDE.","In","Subsection","1.2","we","give","a\nliterature","review,","placing","the","proposed","methodology","in","the","context","of","other","research","at","the\nintersection","of","machine","learning","and","PDEs.","The","outline","of","the","article","is","given","in","Subsection","1.3.\n1.1.","","Summary","","of","","the","","Proposed","","Method.For","","demonstration","","purposes,","","we","","summarize\nthe","key","ideas","of","our","method","for","solving","a","nonlinear","second-order","elliptic","PDE.","This","PDE","will\nalso","","serve","","as","","a","","running","","example","","in","","Section","","3","","where","","we","","present","","an","","abstract","","framework","","for\ngeneral","nonlinear","PDEs.\nLetd≥1","and","Ω","be","a","bounded","open","domain","inR\nd\nwith","a","Lipschitz","boundary.","","Consider\nthe","following","nonlinear","elliptic","equation","foru\n?\n:\n(1.1)\n{\n−∆u\n?\n(x)","+τ\n(\nu\n?\n(x)\n)\n=f(x),∀x∈Ω,\nu\n?\n(x)","=g(x),∀x∈∂Ω,\nwheref,g:","Ω→Randτ:R→Rare","given","continuous","functions.","","We","assume","thatf,g,τ\nare","chosen","appropriately","so","that","the","PDE","has","a","unique","classical","solution","(for","abstract","theory\nof","","nonlinear","","elliptic","","PDEs","","see","","for","","example","","[47,","","61]).","","","In","","Subsection","","1.1.4","","we","","will","","present","","a\nconcrete","numerical","experiment","whereτ(u)","=u\n3\nandg(x)","=","0.\n1.1.1.","","Optimal","Recovery.Our","proposed","method","starts","with","an","optimal","recovery","problem\nthat","can","also","be","interpreted","as","maximum","a","posterior","(MAP)","estimation","for","GPs","constrained\nby","PDEs.","","More","precisely,","consider","a","nondegenerate,","symmetric,","and","positive","definite","kernel\nfunctionK:\nΩ×Ω→R.","","","LetUbe","","the","","RKHS","","associated","","withKand","","denote","","the","","RKHS\nnorm","by‖·‖.","","Let","1≤M\nΩ\n<","M","<∞and","sampleMpoints","in\nΩ","such","thatx\n1\n,...,x\nM\nΩ\n∈Ω\nandx\nM\nΩ\n+1\n,...,x\nM\n∈∂Ω.","","Then,","our","method","approximates","the","solutionu\n?\nof","","(1.1)","with","a\nminimizeru\n†\nof","the","following","optimal","recovery","problem:\n(1.2)\n\n\n\n\n\n\n\nminimize\nu∈U\n‖u‖\ns.t.−∆u(x\nm\n)","+τ\n(\nu(x\nm\n)\n)\n=f(x\nm\n),form=","1,...,M\nΩ\n,\nu(x\nm\n)","=g(x\nm\n),form=M\nΩ\n+","1,...,M",".\nHere,","","we","assumeKis","chosen","appropriately","","so","thatU","⊂C\n2\n(Ω)∩C(Ω),","","which","ensures","the\npointwise","PDE","constraints","in","(1.2)","are","well-defined.\nA","minimizeru\n†\ncan","be","interpreted","as","a","MAP","estimator","of","a","GPξ∼","N(0,K)\n1\n(whereK\nis","the","integral","operator","with","kernelK)","conditioned","on","satisfying","the","PDE","at","the","collocation\npointsx\nm\n,1≤m≤M.","","Such","view","has","been","introduced","for","solving","linear","PDEs","in","[35,","36],","and\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS3\n(1.2)","serves","as","a","natural","generalization","to","nonlinear","PDEs.","","Here","it","is","important","to","note","that,\nunlike","the","linear","case,","in","the","nonlinear","setting,","the","conditioned","GP","is","no","longer","Gaussian,","so\nit","is","a","MAP","estimator","only","and","is","not","the","conditional","expectation.\nIn","the","next","subsections,","we","show","equivalence","of","(1.2)","and","a","finite","dimensional","constrained\noptimization","","problem","","(1.5).","","","This","","provides","","existence\n2\nof","","a","","minimizer","","to","","(1.2),","","as","","well","","as\nthe","","basis","","for","","a","","numerical","","method","","to","","approximate","","the","","minimizer,","","based","","on","","solution","","of","","an\nunconstrained","finite-dimensional","optimization","problem","(1.6).\n1.1.2.","","Finite-Dimensional","Representation.The","key","to","our","numerical","algorithm","for","solv-\ning","(1.2)","is","a","representer","theorem","that","characterizesu\n†\nvia","a","finite-dimensional","representation\nformula.","","To","achieve","this","we","first","reformulate","(1.2)","as","a","two","level","optimization","problem:\n(1.3)\n\n\n\n\n\n\n\n\n\n\n\n\n\nminimize\nz\n(1)\n∈R\nM\n,z\n(2)\n∈R\nM\nΩ\n\n\n\nminimize\nu∈U\n‖u‖\ns.t.","","u(x\nm\n)","=z\n(1)\nm\nand−∆u(x\nm\n)","=z\n(2)\nm\n,form=","1,...,M,\ns.t.","","z\n(2)\nm\n+τ(z\n(1)\nm\n)","=f(x\nm\n),form=","1,...,M\nΩ\n,\nz\n(1)\nm\n=g(x\nm\n),form=M\nΩ\n+","1,...,M",".\nDenoteφ\n(1)\nm\n=δ\nx\nm\nandφ\n(2)\nm\n=δ\nx\nm\n◦(−∆),","whereδ\nx\nis","the","Dirac","delta","function","centered","atx.\nWe","further","use","the","shorthand","notationφ\n(1)\nandφ\n(2)\nfor","theMandM\nΩ\n-dimensional","vectors\nwith","entriesφ\n(1)\nm\nandφ\n(2)\nm\nrespectively,","andφfor","the","(M+M\nΩ\n)-dimensional","vector","obtained\nby","concatenatingφ\n(1)\nandφ\n(2)\n.","","Similarly,","we","writezfor","the","(M+M\nΩ\n)-dimensional","vector\nconcatenatingz\n(1)\nandz\n(2)\n.\nFor","","a","","fixedz,","","we","","can","","solve","","the","","first","","level","","optimization","","problem","","explicitly","","due","","to","","the\nrepresenter","theorem\n3\n(see","[39,","Sec.","17.8]),","which","leads","to","the","conclusion","that\n(1.4)u(x)","=K(x,φ)K(φ,φ)\n−1\nz;\nhereK(x,φ)","","denotes","","the","","(M+M\nΩ\n)-dimensional","","vector","","with","","entries\n∫\nK(x,x\n′\n)φ\nm\n(x\n′\n)","dx\n′\nandK(φ,φ)","is","the","(M+M\nΩ\n)×(M+M\nΩ\n)-matrix","with","entries\n∫\nK(x,x\n′\n)φ\nm\n(x)φ\nj\n(x\n′\n)","dxdx\n′\nwith","theφ\nm\ndenoting","the","entries","ofφ.","","For","this","solution,‖u‖\n2\n=z\nT\nK(φ,φ)\n−1\nz,","so","we","can\nequivalently","formulate","(1.3)","as","a","finite-dimensional","optimization","problem:\n(1.5)\n\n\n\n\n\n\n\n\n\nminimize\nz∈R\nM+M\nΩ\nz\nT\nK(φ,φ)\n−1\nz\ns.t.","","z\n(2)\nm\n+τ(z\n(1)\nm\n)","=f(x\nm\n),form=","1,...,M\nΩ\n,\nz\n(1)\nm\n=g(x\nm\n),form=M\nΩ\n+","1,...,M",".\n1\nThis","Gaussian","prior","notation","is","equivalent","to","the","GP","notationGP(0,K),","whereKis","the","covariance","function.\nSee","further","discussions","in","Subsection","3.4.1.\n2\nUniqueness","of","a","minimizer","is","not","necessarily","a","consequence","of","the","assumed","uniqueness","of","the","solution","to\nthe","PDE","(1.1).","","We","provide","additional","discussions","of","uniqueness","results","in","Subsection","5.1.\n3\nThis","","is","","not","","the","","standard","","RKHS/GP","","representer","","theorem","","[78,","","Sec.","","2.2]","","in","","the","","sense","","that","","measurements\ninclude","the","pointwise","observation","of","higher","order","derivatives","of","the","underlying","GP.","See","[25]","and","[73,","p.","xiii]","for\nrelated","spline","representation","formulas","with","derivative","information.\n\n4Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nMoreover,","using","the","equationz\n(2)\nm\n=f(x\nm\n)−τ(z\n(1)\nm\n)","and","the","boundary","data,","we","can","further\neliminatez\n(2)\nand","rewrite","it","as","an","unconstrained","problem:\n(1.6)minimize\nz\n(1)\nΩ\n∈R\nM\nΩ\n(\nz\n(1)\nΩ\n,g(x\n∂Ω\n),f(x\nΩ\n)−τ(z\n(1)\nΩ\n)\n)\nK(φ,φ)\n−1\n\n\n\nz\n(1)\nΩ\ng(x\n∂Ω\n)\nf(x\nΩ\n)−τ(z\n(1)\nΩ\n)\n\n\n\n,\nwhere","we","usedx\nΩ\nandx\n∂Ω\nto","denote","the","interior","and","boundary","points","respectively,z\n(1)\nΩ\ndenotes\ntheM\nΩ\n-dimensional","vector","of","thez\ni\nfori=","1,...,M\nΩ\nassociated","to","the","interior","pointsx\nΩ\nwhilef(x\nΩ\n),g(x\n∂Ω\n)","andτ(z\n(1)\nΩ\n)","are","vectors","obtained","by","applying","the","corresponding","functions\nto","entries","of","their","input","vectors.","","For","brevity","we","have","suppressed","the","transpose","signs","on","the\nrow","vector","multiplying","the","matrix","from","the","left","in","(1.6).\nThe","foregoing","considerations","lead","to","the","following","existence","result","which","underpins\n4\nour\nnumerical","method","for","(1.1);","furthermore","(1.6)","provides","the","basis","for","our","numerical","implemen-\ntations.","","We","summarize","these","facts:\nTheorem","1.1.The","variational","problem(1.2)has","a","minimizer","of","the","form\nu\n†\n(x)","=K(x,φ)K(φ,φ)\n−1\nz\n†\n,","","wherez\n†\nis","","a","","minimizer","","of(1.5).","","Furthermoreu\n†\n(x)may","","be\nfound","by","solving","the","unconstrained","minimization","problem(1.6)forz\n(1)\nΩ\n.\nProof.Problems","","(1.2),","","(1.3)","","and","","(1.5)","","are","","equivalent.","","","It","","is","","therefore","","sufficient","","to","","show\nthat","(1.5)","has","a","minimizer.","","Writez\n?\nfor","the","vector","with","entriesz\n?(1)\nm\n=u\n?\n(x\nm\n)","andz\n?(2)\nm\n=\n−∆u\n?\n(x\nm\n).","","Sinceu\n?\nsolves","the","PDE","(1.1),z\n?\nsatisfies","the","constraints","onzin","(1.5).","","It","follows\nthat","the","minimization","in","(1.5)","can","be","restricted","to","the","set","ofzthat","satisfiesz\nT\nK(φ,φ)\n−1\nz≤\n(z\n?\n)\nT\nK(φ,φ)\n−1\nz\n?\nand","the","nonlinear","constraints.","Since","this","set","is","compact","(by","the","continuity","of\nτ)","and","nonempty","(it","containsz\n∗\n),","the","objective","functionz\nT\nK(φ,φ)\n−1\nzachieves","its","minimum\nin","the","set.","","Oncez\n(1)\nΩ\nis","found","we","can","extend","to","the","boundary","points","to","obtainz\n(1)\n,","and","use\nthe","nonlinear","relation","betweenz\n(1)\nandz\n(2)\nto","reconstructz\n(2)\n.","","This","givesz\n†\n.\n1.1.3.","","Convergence","Theory.The","consistency","of","our","method","is","guaranteed","by","the","conver-\ngence","ofu\n†\ntowardsu\n?\nasM,","the","total","number","of","collocation","points,","goes","to","infinity.","","We","first\npresent","this","result","in","the","case","of","the","nonlinear","PDE","(1.1)","and","defer","a","more","general","version\nto","","Subsection","","3.2.","","","We","","also","","give","","a","","simple","","proof","","of","","convergence","","here","","as","","it","","is","","instructive","","in\nunderstanding","why","the","method","works","and","how","the","more","general","result","can","be","established.\nTheorem","1.2.Suppose","","thatKis","","chosen","","so","","thatU","⊆H\ns\n(Ω)for","","somes",">(d+","5)/2and\nthat(1.1)has","a","unique","classical","solutionu\n?\n∈U.","","Writeu\n†\nM\nfor","a","minimizer","of(1.2)withM\ndistinct","collocation","pointsx\n1\n,...,x\nM\n.","","Assume","that,","asM→∞,\nsup\nx∈Ω\nmin\n1≤m≤M\nΩ\n|x−x\nm\n|→0andsup\nx∈∂Ω\nmin\nM\nΩ+1\n≤m≤M\n|x−x\nm\n|→0.\nThen,","","asM→","∞,u\n†\nM\nconverges","","towardsu\n?\npointwise","","inΩand","","inH\nt\n(Ω)for","","anyt∈\n((d+","5)/2,s).\n4\nAlthough","this","existence","result","is","desirable,","it","is","not","necessary","in","the","sense","that","our","variational","analysis","of\nminimizers","of","","(1.2),","remains","true","for","near-minimizers.","","Furthermore,","the","error","estimates","of","Section","5.2","can","be\nmodified","to","include","the","error","incurred","by","approximatingu\n?\nwith","a","near-minimizer","rather","than","a","minimizeru\n†\n.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS5\nProof.The","","proof","","relies","","on","","a","","simple","","compactness","","argument","","together","","with","","the","","Sobolev\nembedding","","theorem","","[1,","","8].","","","Since","","the","","minimizers","","of","","(1.2)","","satisfy","","more","","relaxed","","constraints\nthanu\n?\n,","","it","","holds","","true","","that‖u\n†\nM\n‖","≤","‖u\n?\n‖for","","allM≥1.","","","Furthermore,","","we","","deduce","","that\n‖u\n†\nM\n‖\nH\ns\n(Ω)\n≤C‖u\n?\n‖by","the","hypothesis","of","the","theorem.\nLet","(d+5)/2<","t","<","sso","thatH\nt\n(Ω)","is","embedded","inC\n2\n(Ω)∩C(Ω).","SinceH\ns\n(Ω)","is","compactly\nembedded","intoH\nt\n(Ω)","we","deduce","that","there","exists","a","subsequenceM\np\nand","a","limitu\n†\n∞\n∈H\nt\n(Ω)\nsuch","thatu\n†\nM\np\nconverges","towardsu\n†\n∞\nasp→","∞.","","Since","the","convergence","holds","inH\nt\n(Ω)","with\nt",">(d+","5)/2,","we","obtain","that,","for","allm∈{1,...,M\np,Ω\n},−∆u\n†\nM\np\n(x\nm\n)","+τ\n(\nu\n†\nM\np\n(x\nm\n)\n)\nconverges\ntowards−∆u\n†\n∞\n(x\nm\n)+τ\n(\nu\n†\n∞\n(x\nm\n)\n)\nandu\n†\nM\np\n(x\nm\n)","converges","tou\n†\n∞\n(x\nm\n)","for","allm∈{1,...,M\np\n}.\nHere,","we","used","the","notationM\np,Ω\nto","denote","the","number","of","interior","points","associated","with","the\ntotalM\np\ncollocation","points.\nBy","","the","","assumption,{x\nm\n,1≤m≤M\np\n}forms","","a","","dense","","subset","","of\nΩ","","asM\np\n→","∞,","","so","","it\nfollows","thatu\n†\n∞\nis","a","classical","solution","of","","(1.1)","and","since","the","solution","is","unique","we","must","have\nu\n†\n∞\n=u\n?\n.","","As","the","limitu\n†\n∞\nis","independent","of","the","particular","subsequence","we","deduce","thatu\n†\nM\nconverge","tou\n?\npointwise","and","inH\nt\n(Ω).\nWe","note","that","this","convergence","theorem","requiresKto","be","adapted","to","the","solution","space","of\nthe","PDE","so","thatu\n?\nbelongs","toU.","","In","our","numerical","experiments,","we","will","use","a","Gaussian","kernel.\nHowever,","iffor","the","boundary∂Ω","are","not","sufficiently","regular,","then","the","embedding","conditions\nu\n?\n∈","U","⊆H\ns\n(Ω)","may","be","satisfied","by","using","kernel","as","the","Green’s","function","of","some","power","of\nthe","Laplacian,","instead","of","a","Gaussian","kernel;","the","latter","induces","smoothness","onUwhich","may\nbe","","incompatible","","with","","the","","regularity","","ofu\n?\nfor","","irregularfand∂Ω.","","","We","","will","","provide","","further\ninsights","into","the","convergence","properties","of","our","method,","including","an","error","bound","between","the\nsolutionu\n?\nand","a","minimizeru\n†\nin","Section","5.2.\n10\n2\n10\n3\nM\n10\n−4\n10\n−3\n10\n−2\n10\n−1\n10\n0\nError\nτ(u)","=","0\nL\n2\n,σ=","0.2\nL\n∞\n,σ=","0.2\nL\n2\n,σ=M\n−1/4\nL\n∞\n,σ=M\n−1/4\nL\n2\n(FD)\nL\n∞\n(FD)\n10\n2\n10\n3\nM\n10\n−4\n10\n−3\n10\n−2\n10\n−1\n10\n0\nError\nτ(u)","=u\n3\nL\n2\n,σ=","0.2\nL\n∞\n,σ=","0.2\nL\n2\n,σ=M\n−1/4\nL\n∞\n,σ=M\n−1/4\nFigure","1.L\n2\nandL\n∞\nerror","plots","for","numerical","approximations","ofu\n?\n,","the","solution","to(1.1),","as","a","function","of\nthe","number","of","collocation","pointsM.","","Left:τ(u)","=","0;","","both","the","kernel","collocation","method","using","Gaussian","kernel\nwithσ=","0.2andM\n−1/4\nand","the","finite","difference","(FD)","method","were","implemented.","","Right:τ(u)","=u\n3\n;","the","kernel\ncollocation","method","using","Gaussian","kernel","withσ=","0.2andM\n−1/4\nwere","used.","","In","both","cases,","an","adaptive","nugget\ntermηRwithη=","10\n−5\nwas","used","to","regularize","the","kernel","matrixΘ;","see","details","in","Subection","3.4.3.\n\n6Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\n1.1.4.","","Numerical","","Framework.The","","representation","","ofu\n†\nvia","","the","","optimization","","problem\n(1.6)","","is","","the","","cornerstone","","of","","our","","numerical","","framework","","for","","solving","","nonlinear","","PDEs.","","","Indeed,\nefficient","solution","of","(1.6),","and","in","turn","construction","and","inversion","of","the","matrixK(φ,φ),","are","the\nmost","costly","steps","of","our","numerical","implementation.","","We","summarize","several","main","ingredients\nof","our","algorithm","below:\n•We","propose","an","efficient","variant","of","the","Gauss-Newton","algorithm","in","Section","3.4.2.","","Al-\nthough","in","general,","(1.6)","is","a","nonconvex","problem,","our","algorithm","typically","converges","in\n2-10","steps","in","the","experiments.\n•For","numerical","stability,","we","perturbK(φ,φ)","to","improve","its","condition","number","by","adding\nan","adaptive","nugget","as","outlined","in","Subection","3.4.3.\n•To","evaluate","the","cost","function","in","(1.6),","we","pre-compute","the","Cholesky","factorization","of\nthe","perturbed","matrix","and","store","it","for","multiple","uses.","","State-of-the-art","linear","solvers","for\ndense","kernel","matrix","can","be","used","for","this","step.\nAs","","a","","demonstration,","","we","","present","","here","","a","","simple","","experiment","","to","","show","","the","","convergence","","of\nour","","method.","","","We","","taked=","","2,","","Ω","","=","","(0,1)\n2\nandτ(u)","","=","","0","","oru\n3\ntogether","","with","","homogeneous\nDirichlet","","boundary","","conditionsg(x)","","=","","0.","","","The","","true","","solution","","is","","prescribed","","to","","beu\n?\n(x)","","=\nsin(πx\n1\n)","sin(πx\n2\n)","+","4","sin(4πx\n1\n)","sin(4πx\n2\n)","and","the","corresponding","right","hand","sidef(x)","is","com-\nputed","using","the","equation.\nWe","choose","the","Gaussian","kernel\nK(x,y;σ)","=","exp\n(\n−\n|x−y|\n2\n2σ\n2\n)\n,\nwith","lengthscale","parameterσ;","we","will","fix","this","parameter,","but","note","that","the","framework","is","natu-\nrally","adapted","to","learning","of","such","hyperparameters.","","We","setM=","64,256,1024,4096,","sampling\nthe","collocation","points","on","a","uniform","grid","of","points","within","Ω.","","We","apply","our","algorithm","to","solve\nthe","PDEs","and","compute","theL\n2\nandL\n∞\nerrors","tou\n?\n.","","In","the","caseτ(u)","=","0,","which","corresponds\nto","a","linear","PDE,","we","also","compare","our","algorithm","with","a","second-order","finite","difference","(FD)\nmethod.","","","For","","the","","nonlinear","","caseτ(u)","","=u\n3\n,","","we","","observe","","that","","the","","Gauss-Newton","","algorithm\nonly","needs","2","steps","to","converge.","","The","errors","versusMare","depicted","in","Figure","1.","","The","following\nobservations","can","be","made","from","this","figure:\n•In","","the","","linear","","caseτ(u)","","=","","0,","","where","","the","","corresponding","","optimization","","problem","","(1.6)","","is\nconvex,","our","algorithm","outperforms","the","FD","method","in","terms","of","accuracy","and","rate","of\nconvergence.","","This","can","be","attributed","to","the","fact","that","the","true","solution","is","very","smooth,\nand","the","Gaussian","kernel","allows","for","efficient","approximation.\n•Moreover,","the","choice","of","the","kernel","parameterσhas","a","profound","impact","on","the","accuracy\nand","rate","of","convergence","of","the","algorithm","implying","the","importance","of","choosing","a","“good\nkernel”","that","is","adapted","to","the","solution","space","of","the","PDE,","and","pointing","to","the","use","of\nhyperparameter","learning.\n•In","the","nonlinear","setting,","our","algorithm","demonstrates","similar","convergence","behavior","to\nthe","linear","setting.","","Once","again,","an","appropriate","choice","ofσleads","to","significant","gains","in\nrates","of","convergence.\n•In","","both","","linear","","and","","nonlinear","","settings,","","there","","appears","","to","","be","","a","","saturation","","effect","","asM\nincreases","","and","","the","errors","","plateau.","","","We","","attribute","","this","","phenomenon","","to","","the","presence","","of\nthe","nugget","term","used","for","regularization","of","the","kernel","matrix","Θ","(see","Remark","3.6","for\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS7\ndiscussion","of","how","this","can","be","alleviated).\n1.2.","","Relevant","","Literature.Machine","learning","and","statistical","inference","approaches","to","nu-\nmerical","","approximation","","have","","attracted","","a","","lot","","of","","attention","","in","","recent","","years","","thanks","","to","","their","","re-\nmarkable","success","in","engineering","applications.","","Such","approaches","can","be","broadly","divided","into\ntwo","categories:","","(1)","GP/Kernel-based","methods,","and","(2)","ANN-based","methods.\nGPs","and","kernel-based","methods","have","long","been","used","in","function","approximation,","regression,\nand","machine","learning","[78].","","As","surveyed","in","[40]:\n“[kernel","approaches","can","be","traced","back","to]","Poincar","́e’s","course","in","Probability","The-\nory","[46]","and","to","the","pioneering","investigations","of","Sul’din","[64],","Palasti","and","Renyi\n[44],","","Sard","","[52],","","Kimeldorf","","and","","Wahba","","[26]","","(on","","the","","correspondence","","between\nBayesian","estimation","and","spline","smoothing/interpolation)","and","Larkin","[28]","(on\nthe","correspondence","between","Gaussian","process","regression","and","numerical","approx-\nimation).","","Although","their","study","initially","attracted","little","attention","among","numer-\nical","analysts","[28],","it","was","revived","in","Information","Based","Complexity","(IBC)","[67],\nBayesian","numerical","analysis","[16],","and","more","recently","in","Probabilistic","Numerics\n[22]","and","Bayesian","numerical","homogenization","[35].”\nFor","recent","reviews","of","the","extensive","applications","of","GP/kernel","methods","see","[11,","40,","65]","and","[39,\nChap.","20].","","In","particular,","","they","have","been","introduced","to","motivate","novel","methods","for","solving\nordinary","","differential","","equations","","(ODEs)","","[60,","","9,","","56].","","","For","","PDEs,","","the","","use","","of","","kernel","","methods\ncan","be","traced","back","to","meshless","collocation","methods","with","radial","basis","functions","[80,","77,","53].\nFurthermore,","","a","","recent","","systematic","","development","","towards","","solving","","PDEs","","was","","initiated","","in","","[35,\n36,","","43,","","39]","","and","","has","","lead","","to","","the","","identification","","of","","fast","","solvers","","for","","elliptic","","PDEs","","and","","dense\nkernel","","matrices","","[55,","","54]","","with","","state-of-the-art","","complexity","","versus","","accuracy","","guarantees.","","","The\neffectiveness","of","these","methods","has","been","supported","by","well-developed","theory","[39]","residing","at\nthe","interfaces","between","numerical","approximation","[73,","77],","optimal","recovery","[32],","information-\nbased","complexity","[67],","and","GP","regression","[6],","building","on","the","perspective","introduced","in","[16,","28,\n32,","68,","73].","","In","particular","there","is","a","one","to","one","correspondence","[39,","55]","between","(1)","the","locality\nof","basis","functions","(gamblets)","obtained","with","kernel","methods","and","thescreening","effectobserved\nin","","kriging","","[62],","","(2)","","Schur","","complementation","","and","","conditioning","","Gaussian","","vectors,","","and","","(3)","","the\napproximate","","low-rank","","structure","","of","","inverse","","stiffness","","matrices","","obtained","","with","","kernel","","methods\nand","variational","properties","of","Gaussian","conditioning.","","Furthermore,","although","the","approach","of\nmodeling","a","deterministic","function","(the","solutionu\n?\nof","a","PDE)","as","a","sample","from","a","Gaussian\ndistribution","may","seem","counterintuitive,","","it","can","be","understood","(in","the","linear","setting","[39])","as\nan","optimal","minimax","strategy","for","recoveringu\n?\nfrom","partial","measurements.","","Indeed,","as","in","Von\nNeumann’s","theory","of","games,","optimal","strategies","are","mixed","(randomized)","strategies","and","(using\nquadratic","","norms","","to","","define","","losses)","","GP","","regression","","(kriging)","","emerges","","as","","an","","optimal","","minimax\napproach","to","numerical","approximation","[32,","39].\nOn","the","other","hand,","ANN","methods","can","be","traced","back","to","[17,","27,","50,","69]","and","their","system-\natic","development","for","solving","PDEs","has","been","initiated","more","recently.","","In","particular","we","highlight\nthe","Deep","Ritz","Method","[76],","Physics","Informed","Neural","Networks","[48]","(PINNs),","DGN","[59],","and\n[20]","which","employs","a","probabilistic","formulation","of","the","nonlinear","PDE","via","the","Feynman-Kac\nformula.","","Although","the","basic","idea","is","to","replace","unknown","functions","with","ANNs","and","minimize\nsome","loss","with","respect","to","the","parameters","of","the","ANN","to","identify","the","solution,","there","are","by","now\n\n8Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nmany","variants","of","ANN","approaches,","and","we","refer","to","[24]","for","a","recent","review","of","this","increasingly\npopular","topic","at","the","interface","between","scientific","computing","and","deep","learning.","","While","ANN\napproaches","have","been","shown","to","be","empirically","successful","on","complex","problems","(e.g.,","machine\nlearning","physics","[49]),","they","may","fail","on","simple","ones","[75,","70]","if","the","architecture","of","the","ANN","is\nnot","adapted","to","the","underlying","PDE","[74].","","Moreover,","the","theory","of","ANNs","is","still","in","its","infancy;\nmost","ANN-based","PDE","solvers","lack","theoretical","guarantees","and","convergence","analyses","are","often\nlimited","to","restricted","linear","instances","[58,","75].","","Broadly","speaking,","","in","comparison","with","kernel\nmethods,","ANN","methods","have","both","limited","theoretical","foundations","and","unfavorable","complex-\nity","vs","accuracy","estimates.","","We","also","remark","that","ANN","methods","are","suitable","for","the","learning\nof","the","parametric","dependence","of","solutions","of","differential","equations","[81,","5,","29,","30,","7];","however,\nGP","and","kernel","methods","may","also","be","used","in","this","context,","","and","the","random","feature","method\nprovides","a","natural","approach","to","implementing","such","methods","in","high","dimensions","[33].\nRegardless,","","the","","theory","","and","","computational","","framework","","of","","kernel","","methods","","may","","naturally\nbe","","extended","","to","","ANN","","methods","","to","","investigate\n5\nsuch","","methods","","and","","possibly","","accelerate","","them\nby","viewing","them","as","ridge","regression","with","data-dependent","kernels","and","following","[55,","54].","","To\nthis","end,","","ANN","methods","can","be","interpreted","as","kernel","methods","with","data-dependent","kernels\nin","two","equivalent","ways:","","(1)","as","solving","PDEs","in","an","RKHS","space","spanned","by","a","feature","map\nparameterized","by","the","initial","layers","of","the","ANN","that","is","learned","from","data;","","or,","(2)","as","kernel-\nbased","methods","with","kernels","that","are","parameterized","by","the","inner","layers","of","the","network.","","For\ninstance,","[37]","shows","that","Residual","Neural","Networks","[21]","(ResNets)","are","ridge","regressors","with\nwarped","kernels","[51,","45].","","Since","our","approach","employs","an","explicit","kernel,","it","allows","us","to","learn\nthat","kernel","directly,","as","discussed","in","Subsection","5.3.","Given","the","notorious","difficulty","of","developing\nnumerical","methods","for","nonlinear","PDEs","[66],","it","is","to","some","degree","surprising","that","(as","suggested\nby","","our","","framework)","","(A)","","this","","difficulty","","can","","universally","","be","","decomposed","","into","","three","","parts:","","(1)\nthe","compression/inversion","of","dense","kernel","matrices,","","(2)","the","selection","of","the","kernel,","","and","(3)\nthe","","minimization","","of","","the","","reduced","","finite-dimensional","","optimization","","problem","","(3.9),","","and","","(B)","","a\nsignificant","portion","of","the","resulting","analysis","can","be","reduced","to","that","of","linear","regression","[39].\nBeyond","solving","PDEs,","ANN","methods","have","also","been","used","in","data-driven","discretizations,\nand","discovery","of","PDEs","that","allow","for","the","identification","of","the","governing","model","[48,","31,","4];","this\nleads","to","applications","in","IPs.","","Our","method,","viewed","as","a","GP","conditioned","on","PDE","constraints\nat","","collocation","","points,","","can","","be","","interpreted","","as","","solving","","an","","IP","","with","","Bayesian","","inference","","and","","a\nGaussian","prior","[63].","","Indeed,","","if","we","relax","the","PDE","constraints","as","in","Subsection","3.3.2","then","a\nminimizeru\n†\ncoincides","","with","","a","","MAP","","estimator","","of","","a","","posterior","","measure","","obtained","","by","","viewing\nthe","PDE","constraints","as","nonlinear","pointwise","measurements","of","a","fielduwith","a","Gaussian","prior\nN(0,K).","","Bayesian","IPs","with","Gaussian","priors","have","been","studied","extensively","(see","[15,","12,","63]\nand","references","therein).","","The","standard","approach","for","their","solution","is","to","discretize","the","problem\nusing","spectral","projection","or","finite","element","methods,","and","compute","posterior","MAP","estimators\n[14]","or","employ","Markov","chain","Monte","Carlo","algorithms","[13]","to","simulate","posterior","samples.","","Our\nabstract","","representation","","theorem","","outlined","","in","","Section","","2.1","","completely","","characterizes","","the","","MAP\nestimator","of","posterior","measures","with","Gaussian","priors","in","settings","where","the","forward","map","is\nwritten","as","the","composition","of","a","nonlinear","map","with","bounded","linear","functionals","acting","on","the\nparameter.","","Indeed,","this","is","precisely","the","approach","that","we","employ","in","Section","4","to","solve","IPs\n5\nBeyond","the","infinite","width","neural","tangent","kernel","regime","[23,","75].\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS9\nwith","PDE","constraints.","","However,","the","main","difference","between","our","methodology","and","existing\nmethods","in","the","literature","is","that","we","pose","the","IP","as","that","of","recovering","the","solution","of","the","PDE\nu\n†\nsimultaneously","","with","","learning","","the","","unknown","","PDE","","parameter","","with","","independent","","Gaussian\npriors","on","both","unknowns.\n1.3.","","Outline","","of","","Article.The","remainder","of","this","article","is","organized","as","follows.","","We","give\nan","overview","of","the","abstract","theory","of","GPs","on","Banach","spaces","in","Section","2","where","we","collect\npreliminary","results","and","ideas","that","are","used","throughout","the","remainder","of","the","article.","","Section","3\nis","dedicated","to","the","development","of","our","numerical","framework","for","solving","nonlinear","PDEs","with\nkernel","methods.","","Here","we","outline","our","assumptions","on","the","PDE,","present","a","general","convergence\ntheory,","discuss","implementation","details,","and","present","numerical","experiments.","","In","Section","4","we\nextend","our","nonlinear","PDE","framework","to","IPs","and","discuss","the","implementation","differences","be-\ntween","the","PDE","and","IP","settings,","followed","by","numerical","experiments","involving","a","benchmark","IP\nin","subsurface","flow.","","Finally,","we","present","additional","discussions,","results,","and","possible","extensions\nof","our","method","in","Section","5.\n2.","","Conditioning","GPs","on","Nonlinear","Observations.In","this","section,","we","outline","the","abstract\ntheory","of","RKHSs/GPs","on","Banach","spaces","endowed","with","quadratic","norms","as","a","foundation","for\nour","","framework","","for","","solving","","PDEs","","and","","IPs.","","","We","","start","","by","","recalling","","some","","basic","","facts","","about\nBanach","","space","","valued","","GPs","","in","","Subsection","","2.1.","","","This","","is","","followed","","in","","Subsection","","2.2","","by","","general\nresults","pertaining","to","conditioning","of","GPs","on","linear","and","nonlinear","observations;","this","leads","to","a\nrepresenter","theorem","that","is","the","cornerstone","of","our","numerical","algorithms.","","Some","of","these","results\nmay","be","known","to","experts,","","but","to","the","best","of","our","knowledge,","","they","are","not","presented","in","the\nexisting","literature","with","the","coherent","goal","of","solving","nonlinear","problems","via","the","conditioning\nof","GPs;","hence","this","material","may","be","of","independent","interest","to","the","reader.\n2.1.","","GPs","","on","","Banach","","Spaces","","Endowed","","with","","a","","Quadratic","","Norm.Consider","a","separable\nBanach","spaceUand","its","dualU\n∗\nwith","their","duality","pairing","denoted","by","[·,·].","","We","further","assume\nthatUis","endowed","with","a","quadratic","norm‖·‖,","i.e.,","there","exists","a","linear","bijectionK:U\n∗\n→U\nthat","is","symmetric","([Kφ,φ]","=","[Kφ,φ]),","positive","([Kφ,φ]>0","forφ6=","0),","and","such","that\n‖u‖\n2\n=","[K\n−1\nu,u],∀u∈U.\nThe","operatorKendowsUandU\n∗\nwith","the","following","inner","products:\n〈u,v〉:=","[K\n−1\nu,v],","u,v∈U,\n〈φ,φ〉\n∗\n:=","[φ,Kφ],","","","φ,φ∈U\n∗\n.\nNote","that","the〈·,·〉\n∗\ninner","product","defines","a","norm","onU\n∗\nthat","coincides","with","the","standard","dual\nnorm","ofU\n∗\n,","i.e.,\n‖φ‖\n∗\n=sup\nu∈U,u6=0\n[φ,u]\n‖u‖\n=\n√\n[φ,Kφ].\nAs","in","[39,","Chap.","11],","althoughU,U\n∗\nare","also","Hilbert","spaces","under","the","quadratic","norms‖·‖\nand‖·‖\n∗\n,","we","will","keep","using","the","Banach","space","terminology","to","emphasize","the","fact","that","our","dual\npairings","will","not","be","based","on","the","inner","product","through","the","Riesz","representation","theorem,\n\n10Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nbut","on","a","different","realization","of","the","dual","space.","","A","particular","case","of","the","setting","considered\nhere","isU=H\ns\n0\n(Ω)","(writingH\ns\n0\n(Ω)","for","the","closure","of","the","set","of","smooth","functions","with","compact\nsupport","in","Ω","with","respect","to","the","Sobolev","norm‖·‖\nH\ns\n(Ω)\n),","with","its","dualU\n∗\n=H\n−s\n(Ω)","defined\nby","the","pairing","[φ,v]",":=\n∫\nΩ\nφuobtained","from","the","Gelfand","tripleH\ns\n(Ω)⊂L\n2\n(Ω)⊂H\n−s\n(Ω).\nHereKcan","be","defined","as","solution","map","of","an","elliptic","operator\n6\nmappingH\ns\n0\n(Ω)","toH\n−s\n(Ω).\nWe","say","thatξis","thecanonical","","GP[39,","Chap.","17.6]","onUand","writeξ∼","N(0,K),","if","and\nonly","ifξis","a","linear","isometry","fromU\n∗\nto","a","centered","Gaussian","space","(a","closed","linear","space","of\nscalar","valued","centered","Gaussian","random","variables).","","Write","[φ,ξ]","for","the","image","ofφ∈U\n∗\nunder\nξand","note","that","the","following","properties","hold:\nE[φ,ξ]","=","0","","","","andE[φ,ξ][φ,ξ]","=","[φ,Kφ],∀φ,φ∈U\n∗\n.\nTo","this","end","the","spaceUcoincides","with","the","Cameron-Martin","space","of","the","GPN(0,K).","","In\nthe","setting","whereKis","defined","through","a","covariance","kernelK(such","as","in","Subsection","1.1","and\nlater","in","Subsection","3.4.2)","thenUcoincides","with","the","RKHS","space","of","the","kernelK[71,","Sec.","2.3].\n2.2.","","Conditioning","","GPs","","with","","Linear","","and","","Nonlinear","","Observations.Letφ\n1\n,...,φ\nN\nbeN\nnon-trivial","elements","ofU\n∗\nand","define\n(2.1)φ:=","(φ\n1\n,...,φ\nN\n)∈(U\n∗\n)\n⊗N\n.\nNow","consider","the","canonical","GPξ∼N(0,K),","then","[φ,ξ]","is","anR\nN\n-valued","Gaussian","vector","and\n[φ,ξ]∼N(0,Θ)","where\n(2.2)Θ∈R\nN×N\n,Θ\ni,n\n=","[φ\ni\n,Kφ\nn\n],1≤i,n≤N",".\nThe","following","proposition","characterizes","the","conditional","distribution","of","GPs","under","these\nlinear","observations;","to","simplify","the","statement","it","is","useful","to","writeK(φ,φ)","for","the","vector","with\nentries","[φ\ni\n,Kφ].","","This","type","of","vectorized","notation","is","used","in","[39].\nProposition","2.1.Consider","","a","","vectory∈R\nN\nand","","the","","canonical","","GPξ∼","N(0,K).","","Thenξ\nconditioned","","on[φ,ξ]","=yis","","also","","Gaussian.","","Moreover","","ifΘis","","invertible","","thenLaw[ξ|[φ,ξ]","=\ny]","=N(u\n†\n,K\nφ\n)with","conditional","mean","defined","byu\n†\n=y\nT\nΘ\n−1\nKφand","conditional","covariance\noperator","defined","by[φ,K\nφ\nφ]","=","[φ,Kφ]−K(φ,φ)Θ\n−1\nK(φ,φ),∀φ∈U\n∗\n.\nProposition","2.1","gives","a","finite","representation","of","the","conditional","mean","of","the","GP","constituting\na","representer","theorem","[39,","Cor.","17.12].","","Let","us","define","the","elements\n(2.3)χ\ni\n:=\nN\n∑\nn=1\nΘ\n−1\ni,n\nKφ\nn\n,\nreferred","to","asgambletsin","the","parlance","of","[36]","which","can","equivalently","be","characterized","as","the\nminimizers","of","the","variational","problem\n(2.4)\n\n\n\nminimize\nχ∈U\n‖χ‖\ns.t.[φ\nn\n,χ]","=δ\ni,n\n,","","","n=","1,...,N",".\n6\nGivens",">0,","we","call","an","invertible","operatorL:H\ns\n0\n(Ω)→H\n−s\n(Ω)","elliptic,","if","it","is","positive","and","symmetric\nin","the","sense","that\n∫\nΩ\nuLu≥0","and\n∫\nΩ\nuLv=\n∫\nΩ\nvLu≥0.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS11\nThis","fact","further","enables","the","variational","characterization","of","the","conditional","meanu\n†\ndirectly\nin","terms","of","the","gambletsχ\nn\n.\nProposition","2.2.Letu\n†\n=E[ξ|[φ,ξ]","=y]as","in","Proposition","2.1.","","Thenu\n†\n=\n∑\nN\nn=1\ny\nn\nχ\nn\nis\nthe","unique","minimizer","of\n{\nminimize\nu∈U\n‖u‖\ns.t.[φ\nn\n,u]","=y\nn\n,","","","n=","1,...,N",".\nProposition","2.2","is","the","cornerstone","of","our","methodology","for","solution","of","nonlinear","PDEs.","","It","is\nalso","useful","for","the","solution","of","IPs.","","For","this","purpose","consider","nonlinear","functionsG:R\nN\n→R\nI\nandF:R\nN\n→R\nM\nand","vectorso∈R\nI\nandy∈R\nM\nand","consider","the","optimization","problem:\n(2.5)\n\n\n\nminimize\nu∈U\n‖u‖\n2\n+\n1\nγ\n2\n|G([φ,u])−o|\n2\ns.t.F([φ,u])","=y,\nwhereγ∈Ris","a","parameter.","We","will","use","this","formulation","of","IPs","in","PDEs,","withuconcatenating\nthe","solution","of","the","forward","PDE","problem","and","the","unknown","parameter;","the","nonlinear","constraint\nonFenforces","the","forward","PDE","andGthe","observed","noisy","data.","","Then","a","representer","theorem\nstill","holds","for","a","minimizer","of","this","problem","stating","that","the","solution","has","a","finite","expansion","in\nterms","of","the","gambletsχ\nn\n:\nProposition","2.3.Suppose(o,y)∈R\nI\n×R\nM\nare","fixed","andΘis","invertible\n7\n.","","Thenu\n†\n∈Uis\na","minimizer","of(2.5)if","and","only","ifu\n†\n=\n∑\nN\nn=1\nz\n†\nn\nχ\nn\nand","the","vectorz\n†\nis","a","minimizer","of\n(2.6)\n\n\n\nminimize\nz∈R\nN\nz\nT\nΘ\n−1\nz+\n1\nγ\n2\n|G(z)−o|\n2\ns.t.F(z)","=y.\nProof.The","proof","is","nearly","identical","to","the","derivation","of","","(1.5)","presented","in","Section","1.1.2.\nSimply","observe","that","minimizing","(2.5)","is","equivalent","to","minimizing\n(2.7)minimize\nz∈R\nN\n:F(z)=y\n\n\n\nminimize\nu∈U\n‖u‖\n2\n+\n1\nγ\n2\n|G(z)−o|\n2\ns.t.[φ,u]","=z.\nThen","solve","the","inner","optimization","problem","for","a","fixedzand","apply","Proposition","2.1.\nWe","note","that","this","model","assumes","independent","and","identically","distributed","(i.i.d.)","","obser-\nvation","noise","for","the","vectoroand","can","easily","be","extended","to","correlated","observation","noise","by\nreplacing","the","misfit","term\n1\nγ\n2\n|G(z)−o|\n2\nin","(2.5)","with","an","appropriately","weighted","misfit","term","of\nthe","form|Σ\n−1/2\n(G(z)−o)|\n2\nwhere","Σ","denotes","the","covariance","matrix","of","the","observation","noise.\n7\nRelaxing","the","interpolation","constraints","renders","the","invertibility","assumption","on","Θ","unnecessary.","","Nevertheless\nwe","keep","it","for","ease","of","presentation.\n\n12Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nRemark2.4.","","It","is","intuitive","that","a","minimizer","of","the","optimization","problem","we","introduce","and\nsolve","in","this","paper","corresponds","to","a","MAP","point","for","the","GPξ∼N(0,K)","conditioned","on","PDE\nconstraints","","at","","the","","collocation","","points.","","","To","","prove","","this","","will","","require","","extension","","of","","the","","approach\nintroduced","in","[14],","for","example,","and","is","left","for","future","work.","","Furthermore,","there","is","a","related\nfinite-dimensional","MAP","estimation","problem","restricted","to","the","collocation","points,","which","could\nalso","be","studied","and","may","be","amenable","to","a","simpler","analysis.♦\n3.","","Solving","","Nonlinear","","PDEs.In","","this","","section,","","we","","present","","our","","framework","","for","","solution","","of\nnonlinear","PDEs","by","conditioning","GPs","on","nonlinear","constraints.","","In","Subsection","3.1","we","outline\nour","abstract","setting","as","well","as","our","assumptions","on","PDEs","of","interest","leading","to","Corollary","3.2\nwhich","states","an","analogue","of","Proposition","2.3","in","the","PDE","setting.","","We","analyze","the","convergence\nof","","our","","method","","in","","Subsection","","3.2","","and","","discuss","","two","","strategies","","for","","dealing","","with","","the","","nonlinear\nPDE","constraints","in","Subsection","3.3.","","Next,","we","present","the","details","pertaining","to","numerical","im-\nplementations","of","our","method,","including","the","choice","of","kernels,","a","Gauss-Newton","algorithm,","and\nchoice","of","nugget","terms","in","Subsection","3.4.","","Finally,","we","present","a","set","of","numerical","experiments\nin","Subsection","3.5","that","demonstrate","the","effectiveness","of","our","proposed","method","in","the","context\nof","prototypical","nonlinear","PDEs.\n3.1.","","Problem","","Setup.Let","us","consider","a","domain","Ω⊆R\nd\nford≥1","and","a","nonlinear","PDE\nof","the","form\n(3.1)\n{\nP(u\n?\n)(x)","=f(x),∀x∈Ω,\nB(u\n?\n)(x)","=g(x),∀x∈∂Ω.\nHerePis","a","nonlinear","differential","operator","andBis","an","appropriate","boundary","operator","with\ndataf,g.","","Throughout","this","section","and","for","brevity,","we","assume","that","the","PDE","at","hand","is","well-\ndefined","pointwise","","and","","has","a","unique","strong","solution;","","extension","of","our","methodology","to","weak\nsolutions","","is","","left","","as","","a","","future","","research","","direction.","","","We","","then","","considerUto","","be","","an","","appropriate\nquadratic","Banach","space","for","the","solutionu\n?\nsuch","as","a","Sobolev","spaceH\ns\n(Ω)","with","sufficiently\nlarge","regularity","indexs",">0.\nWe","propose","to","solve","the","PDE","(3.1)","by","approximatingu\n?\nby","a","GP","conditioned","on","satisfying\nthe","PDE","at","a","finite","set","of","collocation","points","in\nΩ","and","proceed","to","approximate","the","solution\nby","","computing","","the","","MAP","","point","","of","","such","","a","","conditioned","","GP.","","More","","precisely,","","let{x\ni\n}\nM\ni=1\nbe","","a\ncollection","of","points","in\nΩ","ordered","in","such","a","way","thatx\n1\n,...x\nM\nΩ\n∈Ω","are","in","the","interior","of","Ω\nwhilex\nM\nΩ\n+1\n,...,x\nM\n∈∂Ω","are","on","the","boundary.","","Now","letUbe","a","quadratic","Banach","space","with\nassociated","covariance","operatorK:U\n∗\n→Uand","consider","the","optimization","problem:\n(3.2)\n\n\n\n\n\n\n\nminimize\nu∈U\n‖u‖\ns.t.P(u)(x\nm\n)","=f(x\nm\n),form=","1,...,M",",\nB(u)(x\nm\n)","=g(x\nm\n),form=M\nΩ\n+","1,...,M",".\nIn","","other","","words,","","we","","wish","","to","","approximateu\n?\nwith","","an","","element","","of","","the","","Cameron-Martin","","space\nofN(0,K)","that","satisfies","the","PDE","and","boundary","data","at","the","collocation","points{x\ni\n}\nM\ni=1\n.","","We\nfurther","make","the","following","assumption","regarding","the","operatorsP,B:\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS13\nAssumption3.1.","","There","exist","bounded","and","linear","operatorsL\n1\n,...,L\nQ\n∈","L(U;C(Ω))","in\nwhichL\n1\n,...,L\nQ\nb\n∈","L(U;C(∂Ω))","","for","","some","","1≤Q\nb\n≤Q,","","and","","there","","are","","nonlinear","","maps\nP:R\nQ\n→RandB:R\nQ\nb\n→Rso","thatP(u)(x)","andB(u)(x)","can","be","written","as\n(3.3)\nP(u)(x)","=P\n(\nL\n1\n(u)(x),...,L\nQ\n(u)(x)\n)\n,∀x∈Ω,\nB(u)(x)","=B\n(\nL\n1\n(u)(x),...,L\nQ\nb\n(u)(x)\n)\n,∀x∈∂Ω.\n♦\nFor","prototypical","nonlinear","PDEs","theL\nq\nfor","1≤q≤Qare","linear","differential","operators\nsuch","as","first","or","second","order","derivatives","while","the","mapsPandBare","often","simple","algebraic\nnonlinearities.","","Furthermore,","observe","that","for","ease","of","presentation","we","are","assuming","fewer","linear\noperators","are","used","to","define","the","boundary","conditions","than","the","operators","that","define","the","PDE\nin","the","interior.\nExampleNE(Nonlinear","Elliptic","PDE).Recall","the","nonlinear","elliptic","PDE","(1.1)","and","consider\nthe","linear","operators","and","nonlinear","maps\nL\n1\n:u7→u,","","L\n2\n:u7→∆u,","","P(v\n1\n,v\n2\n)","=−v\n2\n+τ(v\n1\n),","","B(v\n1\n)","=v\n1\n,\nwhere","","we","","tookQ=","","2","","andQ\nb\n=","","1.","","","Then","","this","","equation","","readily","","satisfies","","Assumption","","3.1\nwhenever","the","solution","is","sufficiently","regular","so","thatL\n2\n(u)","is","well-defined","pointwise","within","Ω.\n♦\nUnder","Assumption","3.1","we","can","then","define","the","functionalsφ\n(q)\nm\n∈U\n∗\nby","setting\n(3.4)φ\n(q)\nm\n:=δ\nx\nm\n◦L\nq\n,where\n{\n1≤m≤M,if","","","","1≤q≤Q\nb\n,\n1≤m≤M\nΩ\n,ifQ\nb+1\n≤q≤Q.\nWe","further","use","the","shorthand","notationφ\n(q)\nto","denote","the","vector","of","dual","elementsφ\n(q)\nm\nfor","a\nfixed","indexq.","","Observe","thatφ\n(q)\n∈(U\n∗\n)\n⊗M\nifq≤Q\nb\nwhileφ\n(q)\n∈(U\n∗\n)\n⊗M\nΩ\nifq",">","Q\nb\n.","","We\nfurther","writeN=MQ\nb\n+M\nΩ\n(Q−Q\nb\n)","and","define\n(3.5)φ:=","(φ\n(1)\n,...,φ\n(Q)\n)∈(U\n∗\n)\n⊗N\n.\nTo","this","end,","we","define","the","measurement","vectory∈R\nM\nby","setting\n(3.6)y\nm\n=\n{\nf(x\nm\n),ifm∈{1,...,M\nΩ\n},\ng(x\nm\n),ifm∈{M\nΩ\n+","1,...,M},\nas","well","as","the","nonlinear","map\n(3.7)\n(\nF([φ,u])\n)\nm\n:=\n{\nP([φ\n(1)\nm\n,u],...,[φ\n(Q)\nm\n,u])ifm∈{1,...,M\nΩ\n},\nB([φ\n(1)\nm\n,u],...,[φ\n(Q\nb\n)\nm\n,u])","","","ifm∈{M\nΩ\n+","1,...,M}.\nWe","can","now","rewrite","the","optimization","problem","(3.2)","in","the","same","form","as","(2.5):\n(3.8)\n{\nminimize\nu∈U\n‖u‖\ns.t.F([φ,u])","=y.\nThen","a","direct","appliction","of","Proposition","2.3","yields","the","following","corollary.\n\n14Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nCorollary","3.2.Suppose","","Assumption","","3.1","","holds,KandΘare","","invertible,","","and","","defineφ,F,y\nas","","above.","","Thenu\n†\nis","","a","","minimizer","","of(3.2)if","","and","","only","","ifu\n†\n=\n∑\nN\nn=1\nz\n†\nn\nχ\nn\nwhere","","theχ\nn\nare\nthe","gamblets","defined","according","to(2.4)andz\n†\nis","a","minimizer","of\n(3.9)\n\n\n\nminimize\nz∈R\nN\nz\nT\nΘ\n−1\nz\ns.t.F(z)","=y.\nThe","above","corollary","is","the","foundation","of","our","numerical","algorithms","for","approximation","of","the\nsolutionu\n†\nas","Θ\n−1\nand","the","gambletsχ\nn\ncan","be","approximated","offline","while","the","coefficientsz\n†\nn\ncan","be","computed","by","solving","the","optimization","problem","(3.9).\nTo","solve","(3.9)","numerically,","we","will","present","two","different","approaches","that","transform","it","to\nan","unconstrained","optimization","problem.","","Before","moving","to","that","in","Subsection","3.3,","we","discuss\nthe","convergence","theory","first","in","the","next","section.\n3.2.","","Convergence","Theory.We","state","and","prove","a","more","general","version","of","Theorem","1.2","for\nour","abstract","setting","of","PDEs","on","Banach","spaces","with","quadratic","norms","stating","that","a","minimizer\nu\n†\nof","","(3.2)","converges","to","the","true","solutionu\n?\nunder","sufficient","regularity","assumptions","and","for\nappropriate","choices","of","the","operatorK.\nTheorem","3.3.Consider","the","PDE(3.1)and","suppose","thatU","⊂H⊂C\nt\n(Ω)∩C\nt\n′\n(∂Ω)whereH\nis","a","Banach","space","such","that","the","first","inclusion","from","the","left","is","given","by","a","compact","embedding\nandt≥t\n′\n≥0are","","sufficiently","","large","","so","","that","","the","","PDE","","is","","defined","","pointwise","","for","","elements","","of\nC\nt\n(Ω)∩C\nt\n′\n(∂Ω).","","Furthermore","","assume","","that","","the","","PDE","","has","","a","","unique","","classical","","solutionu\n?\n∈","U\nand","that,","asM→∞,\nsup\nx∈Ω\nmin\n1≤m≤M\nΩ\n|x−x\nm\n|→0andsup\nx∈∂Ω\nmin\nM\nΩ\n+1≤m≤M\n|x−x\nm\n|→0.\nWriteu\n†\nM\nfor","a","minimizer","of(3.2)withMdistinct","collocation","points.","","Then,","asM→∞,","the\nsequence","of","minimizersu\n†\nM\nconverges","towardsu\n?\npointwise","inΩand","inH.\nProof.The","method","of","proof","is","similar","to","that","of","Theorem","1.2.","","Since","the","minimizersu\n†\nM\nof\n(3.2)","satisfy","fewer","constraints","than","the","solutionu\n?\n,","it","holds","that‖u\n†\nM\n‖≤‖u\n?\n‖for","allM≥1\nby","the","hypothesis","of","the","theorem.","","SinceUis","compactly","embedded","inHthen","there","exists","a\nsubsequenceM\np\nand","a","limitu\n†\n∞\n∈","Hsuch","thatu\n†\nM\np\n→u\n†\n∞\nasp→","∞.","","Since","convergence\nholds","","inHandH","⊂C\nt\n(Ω)∩C\nt\n′\n(∂Ω)","","we","","deduce","","thatP(u\n†\nM\np\n)(x\nm\n)→","P(u\n†\n∞\n)(x\nm\n)","","for","","all\nm∈","{1,...,M\np,Ω\n}andB(u\n†\nM\np\n)(x\nm\n)→","B(u\n†\n∞\n)(x\nm\n)","form∈","{M\np,Ω\n+","1,...,M\np\n}.","","Since","the\nx\nm\nform","a","dense","subset","of","Ω","and∂Ω","asM\np\n→∞it","follows","thatu\n†\n∞\nis","a","solution","of","(3.1)","and\nsince","the","solution","is","unique","we","deduce","thatu\n†\n∞\n=u\n?\n.","","As","the","limitu\n†\n∞\nis","independent","of","the\nchoice","of","the","subsequence","we","deduce","thatu\n†\nM\nconverge","tou\n?\npointwise","and","inH.\nWe","note","that","while","this","theorem","does","not","provide","a","rate","for","convergence","ofu\n†\ntowards\nu\n?\nit","","relies","","on","","straightforward","","conditions","","that","","are","","readily","","verifiable","","for","","prototypical","","PDEs.\nTypically","","we","","chooset,t\n′\n>0","","large","","enough","","so","","that","","the","","PDE","","operatorsP,Bare","","pointwise\ndefined","for","the","elements","ofC\nt\n(Ω)∩C\nt\n′\n(∂Ω)","and","take","the","spaceHto","be","a","Sobolev-type","space\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS15\nof","appropriate","regularity","for","the","inclusionH⊂C\nt\n(Ω)∩C\nt\n′\n(∂Ω)","to","hold;","also","see","the","conditions\nof","Theorem","1.2","and","the","subsequent","discussion.","","The","compact","embeddingU","⊂","Hcan","then","be\nensured","by","an","appropriate","choice","of","the","covariance","operatorK(or","the","associated","kernelK).\nHowever,","","this","choice","should","result","in","a","sufficiently","large","spaceUthat","includes","the","solution\nu\n?\nof","the","PDE.","Our","conditions","on","the","collocation","points{x\nm\n}\nM\nm=1\nsimply","ensure","that","these\npoints","form","a","dense","subset","ofΩ","asM→∞.\n3.3.","","Dealing","with","the","Constraints.Now,","we","turn","our","attention","to","the","equality","constraints\nin","","(3.9)","","and","","present","","two","","strategies","","for","","elimination","","or","","relaxation","","of","","these","","constraints;","","these\ntransform","the","optimization","problem","to","an","unconstrained","one.","","They","are","crucial","preliminary\nsteps","before","introducing","our","numerical","framework.\n3.3.1.","","Eliminating","","the","","Equality","","Constraints.The","","equality","","constraints","","in","","(3.9)","","can","","be\neliminated","under","slightly","stronger","assumptions","on","the","mapsP,B.","","In","particular,","suppose","that\nthe","equations\nP(v\n1\n,...,v\nQ\n)","=y,","","","B(v\n1\n,...,v\nQ\nb\n)","=y",",\ncan","be","solved","analytically,","i.e.,","there","exist\nP:R\nQ−1\n→RandB:R\nQ\nb\n−1\n→Rso","that\n(3.10)v\n1\n=P(v\n2\n,...,v\nQ\n,y),","","","v\n1\n=B(v\n2\n,...,v\nQ\nb\n,y).\nNote","that","our","choice","of","solving","forv\n1\nin","terms","of","the","other","variables","is","innocuous","since","the\nordering","of","theL\nq\nand","in","turn","the","inputs","toP,Bare","arbitrary.","","With","the","solution","mapsP,B\nat","hand","we","can","then","define","a","new","solution","mapF:R\nN−M\n×R\nM\n→R\nN\nso","that\nF(z)","=yif","and","only","ifz=F(w,y),for","a","uniquew∈R\nN−M\n.\nWith","this","new","solution","map","we","can","rewrite","(3.9)","as","an","unconstrained","optimization","problem.\nCorollary","3.4.Suppose","","the","","conditions","","of","","Corollary","","3.2","","hold.","","","Thenu\n†\nis","","a","","minimizer","","of\n(3.2)if","and","only","ifu\n†\n=\n∑\nN\nn=1\nz\n†\nn\nχ\nn\nwithz\n†\n=F\n′\n(w\n†\n,y)andw\n†\n∈R\nN−M\nis","a","minimizer","of\n(3.11)minimize\nw∈R\nN−M\nF(w,y)\nT\nΘ\n−1\nF(w,y).\nExampleNE.","","Let","","us","","recall","","that","","we","","already","","eliminated","","the","","equality","","constraints","","in","","the\ncontext","of","the","PDE","(1.1)","through","the","calculations","leading","to","the","unconstrained","minimization\nproblem","(1.6).","","In","that","example,","we","used","the","calculation\nP(v\n1\n,v\n2\n)","=−v\n2\n+τ(v\n1\n)","=y⇔v\n2\n=τ(v\n1\n)−y=P\n′\n(v\n1\n,y),\nthat","is,","we","solved","∆uin","terms","ofτ(u)","and","the","source","term","in","the","interior","of","the","domain","in\norder","to","eliminate","the","PDE","constraint.","","We","further","imposed","the","boundary","conditions","exactly\nsince","the","boundary","mapBis","simply","the","pointwise","evaluation","function","in","that","example.♦\n\n16Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\n3.3.2.","","Relaxing","the","Equality","Constraints.The","choice","of","the","solution","mapsP,Bin","(3.10),\ni.e.,","","the","","choice","","of","","the","","variable","","which","","the","","equations","","are","","solved","","for,","","has","","an","","impact","","on","","the\nconditioning","of","","(3.11);","it","is","not","a","priori","clear","that","poor","conditioning","can","always","be","avoided\nby","choice","of","variables","to","solve","for.","","Moreover,","for","certain","nonlinear","PDEs","these","maps","may","not\neven","exist","globally.","","In","such","cases","it","may","be","useful","to","relax","the","equality","constraints","in","(3.8)\nand","instead","consider","a","loss","of","the","following","form:\n(3.12)\nminimize\nu∈U\n‖u‖\n2\n+\n1\nβ\n2\n|F([φ,u])−y|\n2\n,\nwhereβ\n2\n>0","is","a","small","positive","parameter.","","Likewise","(3.9)","can","be","relaxed","to","obtain\n(3.13)\nminimize\nz∈R\nN\nz\nT\nΘ\n−1\nz+\n1\nβ\n2\n|F(z)−y|\n2\n.\nThen","a","similar","argument","to","the","proof","of","Theorem","3.3","can","be","used","to","show","that","a","minimizer","of\nthe","relaxed","optimization","problem","foruconverges","to","the","solutionu\n?\nof","the","PDE","as","the","number\nof","collocation","pointsMincreases","and","the","parameterβvanishes.\nProposition","3.5.Fixβ",">0.Then","","the","","optimization","","problem(3.12)has","","minimizeru\n†\nβ,M\nwhich","(assumingΘto","be","invertible)","may","be","expressed","in","the","form\nu\n†\nβ,M\n:=\nN\n∑\nn=1\nz\n†\nβ,n\nχ\nn\n∈U,\nwherez\n†\nβ\ndenotes","","a","","minimizer","","of(3.13).","","","Under","","the","","assumptions","","of","","Theorem","","3.3","","it","","follows\nthat,","as(β,M\n−1\n)→0,","the","relaxed","estimatoru\n†\nβ,M\nconverges","tou\n?\npointwise","and","inH.\nProof.By","the","arguments","used","in","Proposition","2.3","the","minimizer","of","","(3.13)","delivers","a","min-\nimizer","","of","","(3.12)","","in","","the","","desired","","form.","","","Sinceu\n?\nsatisfiesF([φ,u\n?\n])−y=","","0","","we","","must","","have\n‖u\n†\nβ,M\n‖≤‖u\n?\n‖.","","Then","a","compactness","argument","similar","to","that","used","in","the","proof","of","Theorem\n3.3,","noting","that","takingβ→0","asM→∞delivers","exact","satisfaction","of","the","constraints","in","the\nlimit,","yields","the","desired","result.\nExampleNE.","","When","","only","","part","","of","","the","","constraintsF(z)","","=ycan","","be","","explicitly","","solved,","","as\nis","","often","","the","","case","","for","","boundary","","values,","","we","","can","","also","","combine","","the","","elimination","","and","","relaxation\napproach.","","Employing","the","relaxation","approach","for","the","interior","constraint","and","the","elimination\napproach","for","the","boundary","constraints","in","(1.1)","amounts","to","replacing","the","optimization","problem\n(1.5),","which","is","the","analogue","of","(3.9)","for","our","running","example,","with","the","following","problem","for\na","small","parameterβ\n2\n>0:\n(3.14)\n\n\n\n\n\n\n\nminimize\nz∈R\nM+M\nΩ\nz\nT\nK(φ,φ)\n−1\nz+\n1\nβ\n2\n[\nM\nΩ\n∑\nm=1\n∣\n∣\n∣\nz\n(2)\nm\n+τ(z\n(1)\nm\n)−f(x\nm\n)\n∣\n∣\n∣\n2\n]\ns.t.z\n(1)\nm\n=g(x\nm\n),form=M\nΩ\n+","1,...,M",".\nWe","will","numerically","compare","the","above","approach","with","the","full","elimination","approach","(1.6)","in\nSubsection","3.5.1.♦\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS17\n3.4.","","Implementation.We","now","outline","the","details","of","a","numerical","algorithm","for","solution\nof","","nonlinear","","PDEs","","based","","on","","the","","discussions","","of","","the","","previous","","subsection","","and","","in","","particular\nCorollary","3.2.","","We","discuss","the","construction","of","the","matrix","Θ","in","Subsection","3.4.1","followed","by\na","variant","of","the","","Gauss-Newton","algorithm","in","Subsection","3.4.2","","for","solving","the","unconstrained\nor","relaxed","problems","outlined","in","Subsections","3.3.","","We","address","the","conditioning","of","the","matrix\nΘ","","and","","an","","adaptive","","strategy","","for","","adding","","a","","nugget","","term","","to","","improve","","its","","condition","","number","","in\nSubsection","3.4.3.\n3.4.1.","","ConstructingΘ.We","established","through","Corollary","3.2","that","a","solution","to","(3.2)","can\nbe","completely","identified","byz\n†\na","minimizer","of","(3.9)","as","well","as","the","gambletsχ\nn\n.","","Since","here","we\nare","concerned","with","the","strong","form","of","the","PDE","(3.1)","it","is","reasonable","to","assume","that","at","the","very\nleastU","⊂C(\nΩ);","although","we","often","require","higher","regularity","so","that","the","PDE","constraints","can\nbe","imposed","pointwise.","","This","assumption","suggests","that","our","GP","model","foru\n?\ncan","equivalently\nbe","identified","via","a","covariance","kernel","function","as","opposed","to","the","covariance","operatorK.","","To\nthis","end,","given","a","covariance","operatorKdefine","the","covariance","kernelK(equivalently","Green’s\nfunction","ofK\n−1\n)","as\n(3.15)K:\nΩ×Ω7→R,","","","K(x,x\n′\n)",":=","[δ\nx\n,Kδ\nx\n′\n].\nIt","is","known","that","the","kernelKcompletely","characterizes","the","GPN(0,K)","under","mild","conditions\n[71];","that","isN(0,K)≡GP(0,K).Let","us","now","consider","the","matrix","Θ","in","block","form\nΘ","=\n\n\n\n\n\nΘ\n(1,1)\nΘ\n(1,2)\n···Θ\n(1,Q)\nΘ\n(2,1)\nΘ\n(2,2)\n···Θ\n(2,Q)\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\nΘ\n(Q,1)\nΘ\n(Q,2)\n···Θ\n(Q,Q)\n\n\n\n\n\n.\nUsing","theL\n2\n(Ω)","duality","pairing","betweenUandU\n∗\nwe","can","identify","the","blocks\nΘ\n(q,j)\n=K(φ\n(q)\n,φ\n(j)\n),\nwhere","we","used","the","shorthand","notation","of","Subsection","1.1","for","the","kernel","matrix,","with","theφ\n(q)\ndefined","as","in","(3.4)","and","the","subsequent","discussion.","","To","this","end","the","entries","of","the","Θ\n(q,j)\ntake\nthe","form\nΘ\n(q,j)\nm,i\n=L\nx\nq\nL\nx\n′\nj\nK(x,x\n′\n)\n∣\n∣\n(x,x\n′\n)=(x\nm\n,x\ni\n)\n,\nwhere","we","used","the","superscriptsx,x\n′\nto","denote","the","variables","with","respect","to","which","the","differ-\nential","operatorsL\nq\n,L\nj\nact.","","Note","that","Θ∈R\nN×N\nwithN=MQ\nb\n+M\nΩ\n(Q−Q\nb\n)","following\nthe","definition","ofφ\n(q)\nin","Subsection","3.1.\n3.4.2.","","A","Gauss-Newton","Algorithm.Here","we","outline","a","variant","of","the","Gauss-Newton","algo-\nrithm","for","solution","of","the","unconstrained","optimization","problem","(3.11).","","Recall","our","definition","of\nthe","maps\nP,Bin","(3.10)","and","in","turn","the","mapF.","","We","then","propose","to","approximate","a","minimizer\nw\n†\nof","(3.11)","with","a","sequence","of","elementsw\n`\ndefined","iteratively","viaw\n`+1\n=w\n`\n+α\n`\nδw\n`\n,where\n\n18Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nα\n`\n>0","is","an","appropriate","step","size","whileδw\n`\nis","the","minimizer","of","the","optimization","problem\nminimize\nδw∈R\nN−M\n(\nF(w\n`\n,y)","+δw\nT\n∇F(w\n`\n,y)\n)\nT\nΘ\n−1\n(\nF(w\n`\n,y)","+δw\nT\n∇F(w\n`\n,y)\n)\n,\nand","the","gradient","ofFis","computed","with","respect","to","thewvariable","only.\nThis","approach","can","be","applied","also","to","solve","the","relaxed","problem","(3.5)","where","this","time","we\nconsider","the","sequence","of","approximationsz\n`+1\n=z\n`\n+α\n`\nδz\n`\n,whereδz\n`\nis","the","minimizer","of\nminimize\nδz∈R\nN\n(\nz\n`\n+δz\n)\nT\nΘ\n−1\n(\nz\n`\n+δz\n)\n+\n1\nβ\n2\n∣\n∣\n∣\nF(z\n`\n)","+δz\nT\n∇F(z\n`\n)−y\n∣\n∣\n∣\n2\n.\nSince","","(3.4.2)","","and","","(3.4.2)","","are","","both","","quadratic","","inδwandδzrespectively,","","they","","can","","be","","solved\nexactly","and","efficiently","at","each","step","and","the","step-size","parmaetersα\n`\ncan","be","fixed","or","computed\nadaptively","using","standard","step-size","selection","techniques","[34].","","However,","in","our","experiments","in\nSection","3.5,","we","find","that","both","algorithms","converge","quickly","simply","by","settingα\n`\n=","1.\nExampleNE.","","Let","us","return","once","more","to","the","nonlinear","elliptic","PDE","considered","in","Sub-\nsection","1.1.","","Observe","that","(1.6)","is","precisely","in","the","form","of","(3.11)","and","so","in","order","to","formulate\nour","Gauss-Newton","iterations","we","need","to","linearize","the","vector","valued","function\nw7→\n(\nw,g(x\n∂Ω\n),f(x\nΩ\n)−τ(w)\n)\n,\nwhich","can","easily","be","achieved","by","linearizingτ.","","To","this","end,","we","solve","(3.11)","via","the","iteration\nw\n`+1\n=w\n`\n+α\n`\nδw\n`\nwhereδw\n`\nis","the","minimizer","of","the","functional\n(\nw\n`\n+δw,g(x\n∂Ω\n),f(x\nΩ\n)−τ(w\n`\n)−δw\nT\n∇τ(w\n`\n)\n)\nK(φ,φ)\n−1\n\n\nw\n`\n+δw\ng(x\n∂Ω\n)\nf(x\nΩ\n)−τ(w\n`\n)−δw\nT\n∇τ(w\n`\n)\n\n\n.\nWe","also","note","that","the","sequence","of","approximations","obtained","by","the","above","implementation","of\nGauss-Newton","coincides","with","successive","kernel","collocation","approximations","of","the","solution","of\nthe","following","particular","linearization","of","the","PDE,\n(3.16)−∆u+uτ\n′\n(u\nn\n)","=f−τ(u\nn\n)","+u\nn\nτ\n′\n(u\nn\n),\nsubject","to","the","Dirichlet","boundary","conditions.♦\n3.4.3.","","Choosing","","Nuggets.The","","primary","","computational","","cost","","of","","our","","method","","lies","","in","","the\napproximation","of","the","matrix","Θ\n−1\n.","","The","most","efficient","way","to","achieve","this","may","be","to","employ\nthe","","algorithm","","introduced","","in","","[54]","","to","","directly","","approximate","","the","","Cholesky","","factors","","of","","Θ\n−1\nby\nquerying","a","subset","of","the","entries","of","Θ","as","discussed","in","Remark","3.6.","","In","this","paper,","we","do","not\nemploy","this","algorithm","and","choose","instead","to","use","standard","algorithms","to","construct","and","invert\nthe","matrix","Θ,","which","is","dense","and","ill-conditioned.","","As","a","consequence,","we","need","to","regularize","this\nmatrix","to","improve","the","stability","of","these","algorithms.\nThis","regularization","introduces","an","accuracy","floor","in","the","method,","so","it","is","important","to","choose\nthe","regularization","term","so","that","it","has","a","small","effect","on","accuracy","–","there","is","thus","an","accuracy-\nstability","tradeoff.","","A","traditional","strategy","for","achieving","this","goal","is","to","add","a","nugget","termηIto\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS19\nΘ,","whereη",">0","is","a","small","number,","andIis","the","identity","matrix.","","By","choosing","a","suitableη,","the\ncondition","number","of","Θ","+ηIcan","be","improved","significantly.","","However,","there","is","an","additional\nlevel","of","difficulty","in","our","method","since","the","matrix","Θ","contains","multiple","blocks","whose","spectral\nproperties","can","differ","remarkably,","since","they","can","involve","different","orders","of","derivatives","of","the\nkernel","functionK.","","This","observation","implies","that","addingηI,","which","is","uniform","across","all","blocks,\nmay","be","suboptimal","in","terms","of","the","accuracy-stability","tradeoff.\nTo","address","this","issue,","we","consider","adding","an","adaptive","block","diagonal","nugget","term.","","More\nprecisely,","without","loss","of","generality","we","can","assume","Θ\n(1,1)\ncorresponds","to","the","pointwise","mea-\nsurements,","i.e.,L\nx\n1\n=δ\nx\n,","then,","we","construct","a","block","diagonal","matrix\nR=\n\n\n\n\n\n\n\nI\ntr(Θ\n(2,2)\n)\ntr(Θ\n(1,1)\n)\nI\n.\n.\n.\ntr(Θ\n(Q,Q)\n)\ntr(Θ\n(1,1)\n)\nI\n\n\n\n\n\n\n\n,\nwhere","we","reweight","the","identity","matrix","in","each","diagonal","block","by","a","factor","of","the","trace","ratio\nbetween","Θ\n(q,q)\nand","Θ\n(1,1)\n.","","With","this","matrix,","the","adaptive","nugget","term","is","defined","asηRwith","a\nglobal","nugget","parameterη",">0.","","We","find","that","once","the","parameterηis","chosen","suitably,","then","our\nGauss-Newton","algorithm","converges","quickly","and","in","a","stable","manner.","","During","computations,","we\ncan","compute","the","Cholesky","factors","of","Θ","+ηRoffline","and","use","back-substitution","to","invert","them\nin","each","iteration","of","Gauss-Newton.\nExampleNE.","","For","the","numerical","experiments","in","Subsection","1.1.4","pertaining","to","the","non-\nlinear","","elliptic","","PDE","","(1.1),","","we","","observed","","that","","Θ","","has","","two","","distinct","","diagonal","","blocks,","","i.e.,","","one\nblock","","corresponding","","to","","the","","pointwise","","evaluation","","functions","","and","","with","","entriesK(x\nm\n,x\ni\n)","","and\nanother","block","corresponding","to","pointwise","evaluations","of","the","Laplacian","operator","and","with","en-\ntries","∆\nx\n∆\nx\n′\nK(x,x\n′\n)|\n(x\nm\n,x\ni\n)\n.","","We","observed","that","withM=","1024","collocation","points,","the","trace\nratio","between","these","blocks","is","of","order","4000.","","Thus,","the","difference","betweenIandRis","signif-\nicant.","","","Our","","experiments","","also","","showed","","that","","if","","we","","only","","addηIto","","regularize","","the","","matrix,","","then\nη=O(10\n−1\n)","","is","","needed","","to","","get","","meaningful","","results,","","while","","using","","the","","nugget","","termηR,","","we","","can\nchooseη=","","10\n−5\nwhich","","leads","","to","","significantly","","improved","","results.","","","We","","further","","explore","","these\ndetails","in","Subsection","3.5.1.♦\n3.5.","","Numerical","Experiments","for","Nonlinear","PDEs.In","this","subsection,","we","implement","our\nalgorithm","to","solve","several","nonlinear","PDEs,","including","the","nonlinear","elliptic","equation","in","Sub-\nsection","3.5.1,","Burgers’","equation","in","Subsection","3.5.2","and","the","regularized","Eikonal","equation","in\nSubsection","3.5.3.","","For","all","of","these","equations,","we","will","start","with","a","fixedMand","demonstrate","the\nperformance","of","our","algorithm","by","showing","the","pattern","of","collocation","points,","the","loss","function\nhistory","of","the","Gauss-Newton","iteration,","and","contours","of","the","solution","errors.","","Then,","we","vary","the\nvalue","ofMand","study","how","the","errors","change","with","respect","toM.","","In","addition,","we","investigate\nthe","impact","of","the","nugget","term","in","the","nonlinear","elliptic","PDE","example.","","We","also","compare","the\nelimination","and","relaxation","approaches","for","dealing","with","the","nonlinear","constraints.\nAll","","the","","experiments","","are","","conducted","","using","","Python","","with","","the","","JAX","","package","","for","","automatic\ndifferentiation.","","","We","","particularly","","use","","automatic","","differentiation","","to","","form","","the","","kernel","","matrix","","Θ\n\n20Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nthat","","involves","","derivatives","","of","","the","","kernel","","function,","","and","","to","","optimize","","the","","loss","","function","","via","","the\nGauss-Newton","method.\n3.5.1.","","A","","Nonlinear","","Elliptic","","PDE.We","","revisit","","again","","the","","nonlinear","","elliptic","","equation","","in\n(1.1).","","","As","","in","","Subsection","","1.1.4,","","we","","taked=","","2,","","Ω","","=","","(0,1)\n2\nandτ(u)","","=u\n3\ntogether","","with\nhomogeneous","Dirichlet","boundary","conditionsg(x)","=","0.","","The","true","solution","is","prescribed","to","be\nu\n?\n(x)","=","sin(πx\n1\n)","sin(πx\n2\n)","+","4","sin(4πx\n1\n)","sin(4πx\n2\n)","and","the","corresponding","right","hand","sidef(x)\nis","computed","using","the","equation.","","We","choose","the","Gaussian","kernelK(x,y;σ)","=","exp(−\n|x−y|\n2\n2σ\n2\n)\nwith","a","lengthscale","parameterσ.\n0.00.20.40.60.81.0\nx\n1\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nx\n2\nCollocation","points\nInterior","nodes\nBoundary","nodes\n−1.5\n−1.0\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n012345\nGauss-Newton","step\n10\n3\n10\n4\n10\n5\n10\n6\n10\n7\n10\n8\nLoss","function","history\n0.10.30.50.70.9\nx\n1\n0.1\n0.3\n0.5\n0.7\n0.9\nx\n2\nContour","of","errors\n0.00\n0.75\n1.50\n2.25\n3.00\n3.75\n4.50\n5.25\n6.00\n6.75\n×10\n−3\n(a)(b)(c)\nFigure","","2.Numerical","","results","","for","","the","","nonlinear","","elliptic","","PDE(1.1):","","(a)","","a","","sample","","of","","collocation","","points","","and\ncontours","","of","","the","","true","","solution;","","(b)","","convergence","","history","","of","","the","","Gauss-Newton","","algorithm;","","(c)","","contours","","of","","the\nsolution","error.\nFirst,","","forM=","","1024","","andM\nΩ\n=","","900,","","we","","randomly","","sample","","collocation","","points","","in","","Ω","","as\nshown","in","Figure","2(a).","","We","further","show","an","instance","of","the","convergence","history","of","the","Gauss-\nNewton","","algorithm","","in","Figure","","2(b)","","where","","we","","solved","","the","","unconstrained","","optimization","problem\n(1.6)","after","eliminating","the","equality","constraints.","","We","use","kernel","parameterσ=M\n−1/4\n,","global\nnugget","parameterη=","10\n−5\nand","initiate","the","algorithm","with","a","Gaussian","random","initial","guess.\nWe","observe","that","only","2","steps","suffice","for","convergence.","","In","Figure","2(c),","we","show","the","contours\nof","","the","","solution","","error.","","","The","","error","","in","","the","","approximate","","solution","","is","","seen","","to","","be","","fairly","","uniform\nspatially,","with","larger","errors","observed","near","the","boundary,","whenM=","1024.We","note","that","the\nmain","difference","between","these","experiments","and","those","in","Subsection","1.1.4","is","that","here","we","used\nrandomly","distributed","collocation","points","while","a","uniform","grid","was","used","in","those","experiments.\nNext,","","we","","explore","","the","","effect","","of","","the","","adaptive","","nugget","","term.","","","We","","compare","","the","","traditional\nnugget","terms","of","the","formηIwith","our","adaptive","nugget","termηRas","outlined","in","Subsection","3.4.3.\nCholesky","factorization","is","applied","to","the","regularized","matrix","and","the","subsequent","Gauss-Newton\niterations","","are","","employed","","to","","obtain","","the","","solutions.","","","TheL\n2\nandL\n∞\nerrors","","of","","the","","converged\nsolutions","are","shown","in","Table","1.","","The","results","are","averaged","over","10","instances","of","a","random","sam-\npling","of","the","collocation","points.","","Here,","“nan”","means","the","algorithm","was","unstable","and","diverged.\nOur","results","clearly","demonstrate","the","superior","accuracy","and","stability","that","is","provided","by","our\nadaptive","nugget","term","versus","the","standard","nugget","choice.\nRemark3.6.","","The","numerical","instability","observed","in","Table","1","can","be","avoided","(and","the","need\nfor","nuggets","can","be","alleviated)","by","directly","computing","the","Cholesky","factors","of","(Θ","+ηI)\n−1\n(or\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS21\nη10\n−1\n10\n−2\n10\n−3\n10\n−4\n10\n−5\n10\n−6\nΘ","+ηI:L\n2\nerror6.5131e-02","","","","nannannannannan\nΘ","+ηI:L\n∞\nerror3.4031e-01","","","","nannannannannan\nΘ","+ηR:L\n2\nerror9.4466e-02","","","","1.2974e-02","","","","8.8447e-03","","","","3.1930e-03","","","","1.1620e-03","","","","nan\nΘ","+ηR:L\n∞\nerror","","","","7.6006e-01","","","","1.4055e-01","","","","5.1071e-02","","","","2.0035e-02","","","","1.4555e-02","","","","nan\nTable","1\nComparison","of","solution","errors","between","standard","nugget","terms","and","our","adaptive","nugget","terms","for","the","non-\nlinear","","elliptic","","PDE(1.1).","","","Collocation","","points","","are","","uniformly","","sampled","","withM=","","1024andM\nΩ\n=","","900with","","a\nGaussian","","kernel","","with","","lengthscale","","parameterσ=","0.2.","","Results","","are","","averaged","","over","","10","","realizations","","of","","the","","random\ncollocation","points.\nΘ\n−1\n)","from","the","entries","of","Θ","+ηI(or","Θ).","","This","can","be","done","by","employing","the","algorithm","in-\ntroduced","","and","","analyzed","","in","","[54].","","","This","","algorithm","","is","","based","","on","","the","","identification","","of","","an","","explicit\nformula","for","computing","approximate","Cholesky","factorsLminimizing","the","Kullback-Leibler","di-\nvergence","betweenN(0,Θ\n−1\n)","andN(0,LL\nT\n)","given","a","sparsity","constraint","on","the","entries","ofL.\nThe","proposed","formula","is","equivalent","to","the","Vecchia","approximation","[72]","(popular","in","geostatis-\ntics).","","The","resulting","algorithm","outlined","in","[54]","computes\u000fapproximate","Cholesky","factors","of\n(Θ","+ηI)\n−1\ninO(Nlog\n2d\n(N/\u000f))","complexity","by","accessingO(Nlog\nd\n(N/\u000f))","entries","of","Θ.","","Simi-\nlarly,","[39,","55]","show","that","the","gamblets","can","be","approximated","with","compactly","supported","functions\nin","complexityO(Nlog\n2d+1\n(N/\u000f)).","","We","also","note","that","the","complexity-vs-accuracy","guarantees\nof","","[39,","","54,","","55]","","have","","only","","been","","established","","for","","functionalsφ\nn\nthat","","are","","Dirac","","delta","","functions\nand","kernelsKthat","are","the","Green’s","functions","of","arbitrary","elliptic","differential","operators","(map-\npingH\ns\n(Ω)","toH\n−s\n(Ω)).","","Extension","of","those","results","to","functionalsφ\nn\nconsidered","here","is","an\ninteresting","future","direction.♦\nFinally,","we","compare","two","approaches","for","dealing","with","the","PDE","constraints","as","outlined","in\nSubsection","3.3.","","We","applied","both","the","elimination","and","relaxation","approaches,","defined","by","the\noptimization","problems","(3.11)","and","(3.13)","respectively,","for","different","choices","ofM.","","In","the","relax-\nation","approach,","we","setβ\n2\n=η,","the","global","nugget","term.","Here","we","setM=","1200,1800,2400,3000\nandM\nΩ\n=","0.9M.","","TheL\n2\nandL\n∞\nerrors","of","the","converged","Gauss-Newton","solutions","are","shown\nin","Table","2.","","Results","are","averaged","over","10","realizations","of","the","random","collocation","points.","","From\nthe","","table","","we","","observe","","that","","the","","difference","","in","","solution","","errors","","is","","very","","mild","","and","","both","","methods\nlead","to","accurate","solutions","asMincreases.","","We","note","that","this","phenomenon","is","closely","tied","to\nour","choice","ofβ,","","and","choosing","an","inadequate","value,","","i.e.","","too","small","or","too","large,","","can","lead","to\ninaccurate","solutions.","","In","terms","of","computational","costs,","the","elimination","approaches","take","2","steps\nof","Gauss-Newton","iterations","on","average,","","while","the","relaxation","approach","needs","3","steps.","","Thus\nwhile","the","elimination","strategy","appears","to","be","more","efficient,","","we","do","not","observe","a","significant\ndifference","in","the","order","of","complexity","of","the","methods","for","dealing","with","the","constraints.\n3.5.2.","","Burgers’","","Equation.We","consider","numerical","solution","of","the","viscous","Burgers","equa-\ntion:\n(3.17)\n∂\nt\nu+u∂\ns\nu−ν∂\n2\ns\nu=","0,∀(s,t)∈(−1,1)×(0,1],\nu(s,0)","=−sin(πx),\nu(−1,t)","=u(1,t)","=","0.\n\n22Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nM1200180024003000\nElimination:L\n2\nerror4.5869e-04","","","","1.5743e-04","","","","1.0537e-04","","","","7.0605e-05\nElimination:L\n∞\nerror","","","","7.4757e-03","","","","2.8467e-03","","","","2.2986e-03","","","","1.6913e-03\nRelaxation:L\n2\nerror4.4895e-04","","","","1.5171e-04","","","","1.0705e-04","","","","7.0094e-05\nRelaxation:L\n∞\nerror7.4766e-03","","","","2.8536e-03","","","","2.2913e-03","","","","1.6868e-03\nTable","2\nComparison","","between","","the","","elimination","","and","","relaxation","","approaches","","to","","deal","","with","","the","","equality","","constraints","","for\nthe","","nonlinear","","elliptic","","PDE(1.1).","","","Uniformly","","random","","collocation","","points","","were","","sampled","","with","","differentMand\nM\nΩ\n=","0.9M.","","Adaptive","nugget","terms","were","employed","with","the","global","nugget","parameterη=","10\n−5\n.","","The","lengthscale\nparameterσ=","0.2.","","Results","are","averaged","over","10","realizations","of","the","random","collocation","points.\nWe","","adopt","","an","","approach","","in","","which","","we","","solve","","the","","problem","","by","","conditioning","","a","","Gaussian","","process\nin","space-time\n8\n.","","In","our","experiments","we","takeν=","0.2","and","considerx=","(s,t).","","We","write","this\nPDE","in","the","form","of","","(3.3)","withQ=","4","andQ\nb\n=","1","with","linear","operatorsL\n1\n(u)","=u,L\n2\n(u)","=\n∂\nt\nu,L\n3\n(u)","","=∂\ns\nu,L\n4\n(u)","","=∂\n2\ns\nuand","","the","","nonlinear","","mapP(v\n1\n,v\n2\n,v\n3\n,v\n4\n)","","=v\n2\n+v\n1\nv\n3\n−νv\n2\n4\n.\nThe","","boundary","","part","","is","","simplyB(v\n1\n)","","=v\n1\n.","","","We","","then","","eliminate","","the","","equality","","constraints","","in\nour","","optimization","","framework","","following","","the","","approach","","of","","Subsection","","3.3.1","","using","","the","","equation\nv\n2\n=νv\n2\n4\n−v\n1\nv\n3\n.\nWe","","randomly","","sampleM=","","1500","","withM\nΩ\n=","","1200","","points","","in","","the","","computational","","domain\nΩ","=","[−1,1]×[0,1]","see","Figure","3(a),","where","we","also","plot","contours","of","the","true","solutionu.","","The\nGauss-Newton","","algorithm","","is","","then","","applied","","to","","solve","","the","","unconstrained","","optimization","","problem.\nWe","computed","the","true","solution","by","the","Cole-Hopf","transformation","together","with","the","numerical\nquadrature.","","","Since","","the","","time","","and","","space","","variability","","of","","the","","solution","","to","","Burgers’","","equation","","are\nsignificantly","different,","we","choose","an","anisotropic","kernel\nK\n(\n(s,t),(s\n′\n,t\n′\n);σ\n)\n=","exp\n(\n−σ\n2\n1\n(s−s\n′\n)\n2\n−σ\n2\n2\n(t−t\n′\n)\n2\n)\nwithσ=","(20,3)","and","choose","the","adaptive","global","nugget","parameterη=","10\n−5\n.\nWe","","plot","","the","","Gauss-Newton","","iteration","","history","","in","","Figure","","3(b)","","and","","observe","","that","","10","","steps\nsuffice","for","convergence.","","We","compare","the","converged","solution","to","the","true","solution","and","present\nthe","contours","of","the","error","in","Figure","3(c).","","The","maximum","errors","occur","close","to","the","(viscous)\nshock","","at","","time","","1","","as","","expected.","","","In","","Figure","","3(d–f),","","we","","also","","compare","","various","","time","","slices","","of","","the\nnumerical","and","true","solutions","at","timest=","0.2,0.5,0.8","to","further","highlight","the","ability","of","our\nmethod","in","capturing","the","location","and","shape","of","the","shock",".\nNext,","we","studied","the","convergence","properties","of","our","method","as","a","function","ofMas","shown\nin","Table","3.","","Here,","we","variedMwith","a","fixed","ratio","of","interior","points,M\nΩ\n/M=","4/5.","","For","each\nexperiment","we","ran","10","steps","of","Gauss-Newton","starting","from","a","Gaussian","random","initial","guess.\nResults","are","averaged","over","10","realizations","of","the","random","collocation","points.","","From","the","table,\nwe","observed","that","the","error","decreases","very","fast","asMincreases,","implying","the","convergence","of\nour","proposed","algorithm.\n8\nIt","would","also","be","possible","to","look","at","an","incremental","in","time","approach,","for","example","using","backward","Euler\ndiscretization,","in","which","one","iteratively","in","time","solves","a","nonlinear","elliptic","two","point","boundary","value","problem","by\nconditioning","a","spatial","Gaussian","process;","we","do","not","pursue","this","here","and","leave","it","as","a","future","direction.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS23\n−1.0−0.50.00.51.0\nx\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nt\nCollocation","points\nInterior","nodes\nBoundary","nodes\n−9.6\n−7.2\n−4.8\n−2.4\n0.0\n2.4\n4.8\n7.2\n9.6\n×10\n−1\n036912\nGauss-Newton","step\n10\n2\n10\n3\n10\n4\n10\n5\n10\n6\n10\n7\n10\n8\nLoss","function","history\n−1.0−0.50.00.51.0\nx\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nt\nContour","of","errors\n0.00\n0.24\n0.48\n0.72\n0.96\n1.20\n1.44\n1.68\n1.92\n×10\n−2\n(a)(b)(c)\n−1.0−0.50.00.51.0\nx\n−1.00\n−0.75\n−0.50\n−0.25\n0.00\n0.25\n0.50\n0.75\n1.00\nAt","timet=","0.2\ntrue","sol\nnumeric","sol\n−1.0−0.50.00.51.0\nx\n−0.75\n−0.50\n−0.25\n0.00\n0.25\n0.50\n0.75\nAt","timet=","0.5\ntrue","sol\nnumeric","sol\n−1.0−0.50.00.51.0\nx\n−0.6\n−0.4\n−0.2\n0.0\n0.2\n0.4\n0.6\nAt","timet=","0.8\ntrue","sol\nnumeric","sol\n(d)(e)(f)\nFigure","3.Numerical","results","for","Burgers","equation(3.17):","","(a)","an","instance","of","uniformly","sampled","collocation\npoints","in","space-time","over","contours","of","the","true","solution;","(b)","Gauss-Newton","iteration","history;","(c)","contours","of","the\npointwise","error","of","the","numerical","solution;","(d–f",")","time","slices","of","the","numerical","and","true","solutions","att=","0.2,0.5,0.8.\nFinally,","we","note","that","the","accuracy","of","our","method","is","closely","tied","to","the","choice","of","the","viscosity\nparameterνand","choosing","a","smaller","value","ofν,","which","in","turn","results","in","a","sharper","shock,","can\nsignificantly","reduce","our","accuracy.","","This","phenomenon","is","not","surprising","since","a","sharper","shock\ncorresponds","to","the","presence","of","shorter","length","and","timescales","in","the","solution;","","these","in","turn,\nrequire","a","more","careful","choice","of","the","kernel,","as","well","as","suggesting","the","need","to","carefully","choose\nthe","collocation","points.\nM1200180024003000\nL\n2\nerror8.6244e-03","","","","1.9975e-03","","","","1.4336e-03","","","","8.0156e-04\nL\n∞\nerror","","","","7.1759e-02","","","","1.5903e-02","","","","9.7531e-03","","","","5.2874e-03\nTable","3\nSpace-timeL\n2\nandL\n∞\nsolution","","errors","","for","","the","","Burgers’","","equation(3.17)for","","different","","choices","","ofMwith\nkernel","parametersσ=","(20,3)and","global","nugget","parameterη=","10\n−5\n.","","Results","are","averaged","over","10","realizations\nof","the","random","collocation","points.\n\n24Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\n3.5.3.","","Eikonal","PDE.We","now","consider","the","regularized","Eikonal","equation","in","Ω","=","[0,1]\n2\n:\n(3.18)\n{\n|∇u(x)|\n2\n=f(x)\n2\n+\u000f∆u(x),∀x∈Ω,\nu(x)","=","0,∀x∈∂Ω,\nwithf=","1","and\u000f=","0.1.","","We","write","this","PDE","in","the","form","of","","(3.3)","withQ=","4","andQ\nb\n=","1\nand","","linear","","operatorsL\n1\n(u)","","=u,L\n2\n(u)","","=∂\nx\n1\nu,L\n3\n(u)","","=∂\nx\n2\nu,L\n4\n(u)","","=","","∆uand","","nonlinear\nmapP(v\n1\n,v\n2\n,v\n3\n,v\n4\n)","=v\n2\n2\n+v\n2\n3\n−\u000fv\n4\nin","the","interior","of","Ω","and","define","the","boundary","operator\nidentically","to","Subsection","3.5.2.","","We","further","eliminate","the","nonlinear","constraints,","as","outlined","in\nSubsection","3.3.1,","by","solvingv\n4\nin","terms","ofv\n2\n,v\n3\n.","","To","obtain","a","“true”","solution,","for","the","purpose\nof","","estimating","","errors,","","we","","employ","","the","","transformationu=−\u000flogv,","","which","","leads","","to","","the","","linear\nPDEfv−\u000f\n2\n∆v=","0;","we","solve","this","by","a","highly-resolved","FD","method.\nAs","before,","","we","began","withM=","1024","collocation","points","withM\nΩ\n=","900","interior","points.\nAn","","instance","","of","","these","","collocation","","points","","along","","with","","contours","","of","","the","","true","","solution","","are","","shown\nin","","Figure","","4(a).","","","We","","employed","","our","","adaptive","","nugget","","term","","with","","the","","global","","nugget","","parameter\nη=","10\n−4\nand","used","the","Gaussian","kernel,","as","in","Subsection","3.5.1","withσ=M\n−1/4\n.","","Finally","we\nused","the","Gauss-Newton","algorithm","to","find","the","minimizer.","","We","show","the","convergence","history\nof","Gauss-Newton","in","Figure","4(b),","observing","that","six","iterations","were","sufficient","for","convergence.\nIn","Figure","4(c)","we","show","the","error","contours","of","the","obtained","numerical","approximation,","","which\nappeared","to","be","qualitatively","similar","to","Figure","2(c)","in","that","the","errors","are","uniformly","small","in\nthe","interior","but","grow","larger","close","to","the","boundary.\n0.000.250.500.751.00\nx\n1\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nx\n2\nCollocation","points\nInterior","nodes\nBoundary","nodes\n0.0\n0.4\n0.8\n1.2\n1.6\n2.0\n2.4\n2.8\n3.2\n3.6\n×10\n−1\n02468\nGauss-Newton","step\n10\n1\n10\n2\n10\n3\n10\n4\n10\n5\n10\n6\n10\n7\nLoss","function","history\n0.10.30.50.70.9\nx\n1\n0.1\n0.3\n0.5\n0.7\n0.9\nx\n2\nContour","of","errors\n0.0\n0.3\n0.6\n0.9\n1.2\n1.5\n1.8\n2.1\n2.4\n2.7\n×10\n−3\n(a)(b)(c)\nFigure","","4.Numerical","","results","","for","","the","","regularized","","Eikonal","","equation(3.18):","","","(a)","","an","","instance","","of","","uniformly\nsampled","collocation","points","over","contours","of","the","true","solution;","","(b)","Gauss-Newton","iteration","history;","","(c)","contour\nof","the","solution","error.\nNext","we","performed","a","convergence","study","by","varyingMand","computingL\n2\nandL\n∞\nerrors","as\nreported","in","Table","4","by","choosing","the","lengthscale","parameter","of","the","kernelσ=M\n−1/4\n.","","Results\nare","averaged","over","10","realizations","of","the","random","collocation","points.","","The","improvement","from\nM=","1800","to","3000","was","small","and","we","suspect","this","is","the","potential","saturation","effect","due","to","our\nchoice","of","the","nugget","term.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS25\nM1200180024003000\nL\n2\nerror3.7942e-04","","","","1.3721e-04","","","","1.2606e-04","","","","1.1025e-04\nL\n∞\nerror","","","","5.5768e-03","","","","1.4820e-03","","","","1.3982e-03","","","","9.5978e-04\nTable","4\nNumerical","","results","","for","","the","","regularized","","Eikonal","","equation(3.18).","","Uniformly","","random","","collocation","","points","","were\nsampled","","with","","differentMand","","with","","fixed","","ratioM\nΩ\n=","","0.9M.","","","An","","adaptive","","nugget","","term","","was","","used","","with","","global\nparameterη=","","10\n−5\ntogether","","with","","a","","Gaussian","","kernel","","with","","lengthscale","","parameterσ=M\n−1/4\n.","","","Results","","are\naveraged","over","10","realizations","of","the","random","collocation","points.\n4.","","Solving","","Inverse","","Problems.We","","now","","turn","","our","","attention","","to","","solution","","of","","IPs","","and","","show\nthat","the","methodology","of","Subsections","3.1–3.4.3","can","readily","be","extended","to","solve","such","problems\nwith","small","modifications.","","We","descibe","the","abstract","setting","of","our","IPs","in","Subsection","4.1","leading\nto","Corollary","4.2","which","is","analogous","to","Proposition","2.3","and","Corollary","3.2","in","the","setting","of","IPs.\nSubsection","4.2","outlines","our","approach","for","dealing","with","PDE","constraints","in","IPs","and","highlights\nthe","differences","in","this","setting","in","comparison","to","the","PDE","setting","described","in","Subsection","3.3.\nSubsection","","4.3","","further","","highlights","","the","","implementation","","differences","","between","","the","","PDE","","and","","IP\nsettings","while","Subsection","4.4","presents","a","numerical","experiment","concerning","an","inverse","problem\nin","subsurface","flow","governed","by","the","Darcy","flow","PDE.\n4.1.","","Problem","Setup.Consider","our","usual","setting","of","a","nonlinear","parameteric","PDE","in","strong\nform\n(4.1)\n{\nP(u\n?\n;a\n?\n)(x)","=f(x),∀x∈Ω,\nB(u\n?\n;a\n?\n)(x)","=g(x),∀x∈∂Ω.\nAs","","before","","we","","assume","","the","","solutionu\n?\nbelongs","","to","","a","","quadratic","","Banach","","spaceUwhilea\n?\nis","","a\nparameter","","belonging","","to","","another","","quadratic","","Banach","","spaceA.","","","Our","","goal","","in","","this","","subsection","","is\nto","identify","the","parametera\n?\nfrom","limited","observations","of","the","solutionu\n?\n.","","To","","this","end,","","fix\nψ\n1\n,...,ψ\nI\n∈U\n∗\nand","define\n(4.2)ψ:=","(ψ\n1\n,...,ψ\nI\n)∈(U\n∗\n)\n⊗I\n,\nthen","our","goal","is","to","recovera\n?\ngiven","the","noisy","observations\n(4.3)o=","[ψ,u]","+\u000f,\u000f∼N(0,γ\n2\nI).\nWe","propose","to","solve","this","inverse","problem","by","modelling","bothu\n?\nanda\n?\nwith","canonical","GPs\non","the","spacesU,Awith","invertible","covariance","operatorsK:U\n∗\n→Uand\n","̃\nK:A\n∗\n→Arespec-\ntively.","","We","then","condition","these","GPs","to","satisfy","the","PDE","on","collocation","pointsx\n1\n,...,x\nM\n∈\nΩ\nas","before","and","propose","to","approximateu\n?\n,a\n?\nsimultaneously","via","the","optimization","problem:\n(4.4)\n\n\n\n\n\n\n\n\n\nminimize\n(u,a)∈U×A\n‖u‖\n2\nU\n+‖a‖\n2\nA\n+\n1\nγ\n2\n∣\n∣\n[ψ,u]−o\n∣\n∣\n2\ns.t.P(u;a)(x\nm\n)","=f(x\nm\n),form=","1,...,M\nΩ\n,\nB(u;a)(x\nm\n)","=g(x\nm\n),form=M\nΩ\n+","1,...,M",",\n\n26Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nwhere","we","used","subscripts","to","distinguish","the","quadratic","norms","on","the","spacesUandA.","","We","make\nanalogous","assumptions","on","the","form","of","the","operatorsP,Bas","in","Assumption","3.1","but","this","time\nalso","involving","the","parametersa:\nAssumption4.1.","","There","exist","bounded","and","linear","operatorsL\n1\n,...,L\nQ\n∈","L(U;C(Ω))","in\nwhichL\n1\n,...,L\nQ\nb\n∈","L(U;C(∂Ω))","","for","","some","","1≤Q\nb\n≤Q,","","and\n","̃\nL\n1\n,...,\n","̃\nL\nJ\n∈","L(A;C(\nΩ))\ntogether","with","nonlinear","mapsP:R\nQ+J\n→RandB:R\nQ\nb\n+J\n→Rso","thatP(u;a)(x)","and\nB(u;a)(x)","can","be","written","as\n(4.5)\nP(u;a)(x)","=P\n(\nL\n1\n(u)(x),...,L\nQ\n(u)(x);\n","̃\nL\n1\n(a)(x),...\n","̃\nL\nJ\n(a)(x)\n)\n,∀x∈Ω,\nB(u;a)(x)","=B\n(\nL\n1\n(u)(x),...,L\nQ\nb\n(u)(x);\n","̃\nL\n1\n(a)(x),...\n","̃\nL\nJ\n(a)(x)\n)\n,∀x∈∂Ω.\n♦\nSimilarly","to","theL\nq\n,","the\n","̃\nL\nj\noperators","are","also","linear","differential","operators","in","case","of","pro-\ntotypical","PDEs","while","the","mapsP,Bremain","as","simple","algebraic","nonlinearities.","","Let","us","briefly\nconsider","an","IP","in","subsurface","flow","and","verify","the","above","assumption.\nExampleDF(Darcy","","flow","","IP).Let","","Ω","","=","","(0,1)\n2\nand","","consider","","the","","Darcy","","flow","","PDE","","with\nDirichlet","boundary","conditions\n{\n−div","(exp(a)∇u)","(x)","=f(x),x∈Ω,\nu(x)","=","0,x∈∂Ω.\nWe","wish","to","approximatea∈C(\nΩ)","given","noisy","pointwise","observations","ofuat","a","set","of","points\n","̃\nx\n1\n,...,\n","̃\nx\nI\n.","","Thus,","we","takeψ\ni\n=δ\n","̃\nx\ni\n.","","By","expanding","the","PDE","we","obtain\n−div","(exp(a)∇u)","=−exp(a)","(∇a·∇u+","∆u),\nand","so","we","simply","chooseQ=","3,Q\nb\n=","1","andJ=","2","with","the","linear","operators\nL\n1\n(u)","=u,","","L\n2\n(u)","=∇u,","","L\n3\n(u)","=","∆u,\n","̃\nL\n1\n(a)","=a,\n","̃\nL\n2\n(a)","=∇a.\nWe","can","then","satisfy","Assumption","4.5","by","taking\n(4.6)P(v\n1\n,v\n2\n,v\n3\n;v\n4\n,v\n5\n)","=−exp(v\n4\n)","(v\n5\n·v\n2\n+v\n3\n),","","","B(v\n1\n;v\n4\n,v\n5\n)","=v\n1\n,\nwhere","we","have","slightly","abused","notation","by","lettingL\n2\n,\n","̃\nL\n2\nbe","vector","valued","and","definingP,B\nto","take","vectors","as","some","of","their","inputs.♦\nAs","","in","","Subsection","","3.1","","we","","now","","define","","the","","functionalsφ\n(q)\nm\n∈","U\n∗\nform=","","1,...,Mand\nq=","1,...,Qaccording","to","(3.4)","and","(3.5)","withN=MQ\nb\n+M\nΩ\n(Q−Q\nb\n).","","Similarly","we","define\nthe","functionals\n","̃\nφ\n(j)\nm\n∈A\n∗\nas\n(4.7)\n","̃\nφ\n(j)\nm\n:=δ\nx\nm\n◦\n","̃\nL\nj\n,form=","1,...,M,andj=","1,...,J",",\ntogether","with","the","vectors\n(4.8)\n","̃\nφ\n(j)\n=","(\n","̃\nφ\n(j)\n1\n,...\n","̃\nφ\n(j)\nM\n)∈(A\n∗\n)\n⊗M\nand\n","̃\nφ=","(\n","̃\nφ\n(1)\n,...,\n","̃\nφ\n(J)\n)∈(A\n∗\n)\n⊗\n","̃\nN\n,\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS27\nwhere\n","̃\nN:=MJ.","","Similarly","to","(3.7)","define","the","map\n(\nF([φ,u]\nU\n;","[\n","̃\nφ,a]\nA\n)\n)\nm\n:=\n{\nP([φ\n(1)\nm\n,u]\nU\n,...,[φ\n(Q)\nm\n,u]\nU\n;","[\n","̃\nφ\n(1)\nm\n,a]\nA\n,...,[\n","̃\nφ\n(J)\nm\n,a]\nA\n)ifm∈{1,...,M\nΩ\n},\nB([φ\n(1)\nm\n,u]\nU\n,...,[φ\n(Q\nb\n)\nm\n,u]\nU\n;","[\n","̃\nφ\n(1)\nm\n,a]\nA\n,...,[\n","̃\nφ\n(J)\nm\n,a]\nA\n)","","","ifm∈{M\nΩ\n+","1,...,M},\nwhere","we","used","subscripts","to","distinguish","the","duality","pairings","betweenU,U\n∗\nand","the","pairing\nbetweenA,A\n∗\n.","","With","this","new","notation","we","can","finally","rewrite","(4.4)","in","the","familiar","form\n(4.9)\n\n\n\n\n\nminimize\n(u,a)∈U×A\n‖u‖\n2\nU\n+‖a‖\n2\nA\n+\n1\nγ\n2\n|ψ(u)−o|\n2\ns.t.F\n(\n[φ,u]\nU\n;","[\n","̃\nφ,a]\nA\n)\n=y,\nwith","the","PDE","data","vectory∈R\nM\ndefined","in","(3.6).\nWe","can","now","apply","Proposition","2.3","with","the","canonical","GP","defined","on","the","product","space\nU","×Aand","with","a","block","diagonal","covariance","operatorK⊗\n","̃\nKto","obtain","a","representer","theorem\nfor","minimizer","of","(4.9).","","We","state","this","result","as","a","corollary","below","after","introducing","some","further\nnotation.","","Define","the","vectorφ=","(φ\n1\n,...,φ\nN+I\n)∈(U\n∗\n)\n⊗(I+N)\n,with","entries\n9\nφ\nn\n:=\n{\nψ\nn\n,ifn=","1,...,I,\nφ\nn−I\n,ifn=I+","1,...,I+N,\nas","well","as","the","matrices","Θ∈R\n(I+N)×(I+N)\nand\n","̃\nΘ∈R\n","̃\nN×\n","̃\nN\nwith","entries\nΘ\ni,n\n=","[φ\ni\n,Kφ\nn\n]\nU\nand\n","̃\nΘ\ni,n\n=","[\n","̃\nφ\ni\n,\n","̃\nK\n","̃\nφ\nn\n]\nA\n.\nAs","in","(2.3)","we","define","the","gamblets\nχ\ni\n=\nN+I\n∑\nn=1\nΘ\n−1\ni,n\nKφ\nn\n,and","̃χ\ni\n=\n","̃\nN\n∑\nn=1\n","̃\nΘ\n−1\ni,n\n","̃\nK\n","̃\nφ\nn\n.\nThen","Proposition","2.3","yields","the","following","corollary.\nCorollary","4.2.Suppose","","Assumption","","4.1","","holds","","and","","that","","the","","covariance","","operatorsKand\n","̃\nK\nas","well","as","the","matricesΘand\n","̃\nΘare","invertible.","","Then(u\n†\n,a\n†\n)∈U×Ais","a","minimizer","of(3.2)\nif","and","only","if\nu\n†\n=\nI+N\n∑\nn=1\nz\n†\nn\nχ\nn\n,anda\n†\n=\n","̃\nN\n∑\nn=1\n","̃z\n†\nn\n","̃χ\nn\n,\n9\nNote","that","we","are","concatenating","theImeasurement","functionals","defining","the","data","for","the","IP","with","theN\nfunctionals","used","to","define","the","PDE","at","the","collocation","points.\n\n28Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nwhere","the","vectorsz\n†\n,\n","̃\nz\n†\nare","minimizers","of\n(4.10)\n\n\n\n\n\nminimize\n(z,\n","̃\nz)∈(R\nI+N\n×R\n","̃\nN\n)\nz\nT\nΘ\n−1\nz+\n","̃\nz\nT\n","̃\nΘ\n−1\n","̃\nz+\n1\nγ\n2\n|Π\nI\nz−o|\n2\ns.t.F(Π\nN\nz;\n","̃\nz)","=y,\nwhereΠ\nI\n:R\nI+N\n→R\nI\nis","","the","","projection","","that","","extracts","","the","","firstIentries","","of","","a","","vector","","while\nΠ\nN\n:R\nI+N\n→R\nN\nis","the","projection","that","extracts","the","lastNentries.\n4.2.","","Dealing","with","the","Constraints.The","equality","constraints","in","(4.10)","can","be","dealt","with\nusing","the","same","strategies","as","in","Subsection","3.3.","","Indeed,","as","in","Subsection","3.3.2,","we","can","readily\nrelax","these","constraints","to","obtain","the","optimization","problem\n(4.11)\nminimize\n(z,\n","̃\nz)∈(R\nI+N\n×R\n","̃\nN\n)\nz\nT\nΘ\n−1\nz+\n","̃\nz\nT\n","̃\nΘ\n−1\n","̃\nz+\n1\nγ\n2\n|Π\nI\nz−o|\n2\n+\n1\nβ\n2\n|F(Π\nN\nz;\n","̃\nz)−y|\n2\n,\nfor","a","small","parameterβ\n2\n>0.","","Elimination","of","the","constraints","as","in","Subsection","3.3.1","is","slightly\nmore","delicate,","but","is","sometimes","possible.","","Suppose","there","exists","a","solution","map\nF:R\nN+\n","̃\nN−M\n×\nR\nM\n→R\nN+\n","̃\nN\nso","that\nF(Π\nN\nz;\n","̃\nz)","=yif","and","only","if","","","","(Π\nN\nz,\n","̃\nz)","=\nF(w,y)for","a","uniquew∈R\nN+\n","̃\nN−M\n.\nThen","solving","(4.10)","is","equivalent","to","solving","the","unconstrained","problem\n(4.12)\nminimize\n(v,w)∈R\nI\n×R\nN+\n","̃\nN−M\n(v,F(w,y))\n[\nΘ\n−1\n0\n0\n","̃\nΘ\n−1\n](\nv\nF(w,y)\n)\n+\n1\nγ\n2\n|v−o|\n2\n,\nand","setting","Π\nI\nz\n†\n=v\n†\nand","(Π\nN\nz\n†\n,\n","̃\nz)","=\nF(w\n†\n,y).\n4.3.","","Implementation.Both","","of","","the","","problems","","(4.11)","","and","","(4.12)","","can","","be","","solved","","using","","the\nsame","","techniques","","outlined","","in","","Subsection","","3.4","","except","","that","","we","","now","","have","","a","","higher","","dimensional\nsolution","space.","","Below","we","briefly","describe","the","main","differences","between","the","implementation","of\nthe","PDE","and","IP","solvers.\n4.3.1.","","ConstructingΘand\n","̃\nΘ.We","propose","to","construct","the","matrices","Θ,\n","̃\nΘ","using","appro-\npriate","kernelsK,","","for","the","solutionuof","the","PDE,","and\n","̃\nK,","","for","the","parameteraidentically","to\nSubsection","3.4.1.","","Our","minimum","requirements","onK,\n","̃\nKis","sufficient","regularity","for","the","pointwise\nconstraints","in","(4.4)","to","be","well-defined.","","Since","we","have","limited","and","noisy","data","in","the","inverse\nproblem","setting,","it","is","not","possible","for","us","to","recover","the","exact","solution","(u\n?\n,a\n?\n)","in","general","and","so\nthe","kernelsK,\n","̃\nKshould","be","chosen","to","reflect","our","prior","assumptions","on","the","unknown","parameter\nand","the","solution","of","the","PDE","at","that","parameter","value.\n4.3.2.","","Choosing","Nuggets.Both","of","the","matrices","Θ,\n","̃\nΘ","are","dense","and","ill-conditioned","in","the\nIP","setting","and","so","an","appropriate","nugget","term","should","be","chosen","to","regularize","them.","","In","the\nIP","setting","we","propose","to","add","adaptive","nuggets","for","both","Θ,\n","̃\nΘ","using","the","same","strategy","as","in\nSubsection","3.4.3,","except","that","the","nuggets","are","constructed","independently","for","each","matrix.","","To\nthis","","end","","we","","set","","Θ←Θ","+ηRand\n","̃\nΘ←\n","̃\nΘ","+","","̃η\n","̃\nR,","","where","","the","","","̃η,\n","̃\nRdenote","","the","","global","","nugget\nparameter","and","the","reweighted","identity","matrix","corresponding","to\n","̃\nΘ.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS29\n0.000.250.500.751.00\nx\n1\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nx\n2\nCollocation","points\nInterior","nodes\nBoundary","nodes\nData","nodes\n0.10.30.50.70.9\nx\n1\n0.1\n0.3\n0.5\n0.7\n0.9\nx\n2\nTrutha(x)\n1.95\n2.55\n3.15\n3.75\n4.35\n4.95\n5.55\n6.15\n6.75\n7.35\n0.10.30.50.70.9\nx\n1\n0.1\n0.3\n0.5\n0.7\n0.9\nx\n2\nTruthu(x)\n0.00\n0.25\n0.50\n0.75\n1.00\n1.25\n1.50\n1.75\n2.00\n2.25\n×10\n−2\n(a)(b)(c)\n02468\nGauss-Newton","step\n10\n1\n10\n2\n10\n3\n10\n4\n10\n5\n10\n6\n10\n7\n10\n8\nLoss","function","history\n0.10.30.50.70.9\nx\n1\n0.1\n0.3\n0.5\n0.7\n0.9\nx\n2\nRecovereda(x)\n1.2\n1.7\n2.2\n2.7\n3.2\n3.7\n4.2\n4.7\n5.2\n0.10.30.50.70.9\nx\n1\n0.1\n0.3\n0.5\n0.7\n0.9\nx\n2\nRecoveredu(x)\n0.0\n0.3\n0.6\n0.9\n1.2\n1.5\n1.8\n2.1\n2.4\n×10\n−2\n(d)(e)(f)\nFigure","","5.Numerical","","results","","for","","the","","inverse","","Darcy","","flow:","","(a)","","an","","instance","","of","","uniformly","","sampled","","collocation\npoints","and","data","points;","(d)","Gauss-Newton","iteration","history;","(b)","truea;","(e)","recovereda;","(c)","trueu;","(f",")","recovered\nu.\n4.4.","","Numerical","","Experiments","","for","","Darcy","","Flow.In","this","subsection,","we","apply","our","method\nto","an","IP","involving","the","Darcy","flow","PDE.","We","consider","the","IP","outlined","in","Example","DF","with","the\ntrue","coefficienta\n?\n(x)","satisfying\nexp\n(\na\n?\n(x)\n)\n=","exp\n(\nsin(2πx\n1\n)","+","sin(2πx\n2\n)\n)\n+","exp\n(\n−sin(2πx\n1\n)−sin(2πx\n2\n)\n)\n,\nand","the","right","hand","side","source","term","isf=","1.","","We","randomly","sampleM=","500","collocation","points\nwithM\nΩ\n=","400","in","the","interior.","","From","these","400","interior","points,","we","randomly","chooseI=","40\npoints","and","observe","the","values","ofu(x)","at","those","points","as","the","data","for","the","IP.","The","values","ofu(x)\nfor","this","purpose","were","generated","by","first","solving","the","equation","with","the","true","coefficient","on","a\nuniform","grid","and","then","using","linear","interpolation","to","get","the","solution","at","the","observation","points.\nWe","further","added","independent","Gaussian","noiseN(0,γ\n2\nI)","with","noise","standard","deviationγ=\n10\n−3\nto","these","observations.","","In","dealing","with","the","nonlinear","constraint","shown","in","Example","DF,\nwe","eliminate","the","variablev\n3\nusing","the","relation","in","(4.6).\n\n30Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nWe","chose","Gaussian","kernels","for","bothuandawith","the","same","lengthscale","parameterσ=","0.2\nand","the","same","adaptive","nugget","parameterη=","10\n−5\nwas","used","for","both","variables.","","In","Figure","5\nwe","show","the","experimental","results","for","recovering","bothaandu.","","From","the","figure,","we","observe\nthat","the","Gauss-Newton","iterations","converge","in","around","6","steps.","","Moreover,","the","recoveredaand\nuare","reasonably","accurate,","i.e.","","they","capture","the","shape","of","the","truth,","given","the","limited","amount\nof","observation","information","available.\n5.","","Concluding","","Remarks.We","","introduced","","a","","kernel/GP","","framework","","for","","solving","","nonlinear\nPDEs","and","IPs","centered","around","the","idea","of","approximating","the","solution","of","a","given","PDE","with","a\nMAP","estimator","of","a","GP","conditioned","on","satisfying","the","PDE","at","a","set","of","collocation","points.","","The-\noretically,","we","exhibited","a","nonlinear","representer","theorem","which","finite-dimensionalizes","the","MAP\nestimation","problem","and","proved","the","convergence","of","the","resulting","solution","towards","the","truth","as\nthe","number","of","collocation","points","goes","to","infinity,","under","some","regularity","assumptions.","","Compu-\ntationally,","we","demonstrated","that","the","solution","can","be","found","by","solving","a","finite-dimensional","op-\ntimization","problem","with","quadratic","loss","and","nonlinear","constraints.","","We","presented","two","methods\nfor","dealing","with","the","nonlinear","constraints,","namely","the","elimination","and","relaxation","approaches.\nAn","efficient","variant","of","the","Gauss-Newton","algorithm","was","also","proposed","for","solving","the","result-\ning","","unconstrained","","optimization","","problem,","","where","","an","","adaptive","","nugget","","term","","was","","employed","","for\nregularization","together","with","offline","Cholesky","factorizations","of","the","underlying","kernel","matrices.\nWe","demonstrated","that","the","proposed","algorithm","performs","well","in","a","wide","range","of","prototypical\nnonlinear","problems","such","as","a","nonlinear","elliptic","PDE,","Burgers’","equation,","a","regularized","Eikonal\nequation,","and","the","identification","of","the","permeability","field","in","Darcy","flow.\nWhile","our","theoretical","results","established","the","existence","of","a","solution","for","the","finite","dimen-\nsional","","optimization","","problem","","and","","the","","convergence","","ofu\n†\nto","","the","","truth,","","the","","uniqueness","","of","","the\nsolution","","is","","not","","guaranteed","","and","","the","","convergence","","theorem","","does","","not","","imply","","convergence","","rates.\nIn","what","follows,","we","provide","several","additional","discussions","that","hold","the","potential","to","address\nthese","two","issues","and","point","towards","interesting","future","directions:","","in","Subsection","5.1","we","discuss\nhow","to","get","the","uniqueness","result","if","an","appropriate","condition","is","assumed.","","In","Subsection","5.2,\nwe","lay","a","path","to","obtain","rigorous","error","estimates","followed","by","a","discussion","about","learning","of\nhierarchical","kernel","parameters","in","Subsection","5.3.","","Finally,","in","Subsection","5.4,","we","connect","the\nframework","of","this","article","to","MAP","estimation","for","Bayesian","IPs","with","non-Gaussian","priors.\n5.1.","","Uniqueness","","and","","Optimality","","of","","Minimizers.While","","our","","theoretical","","results","","in","","Sub-\nsection","2.2","characterize","the","minimizers","of","nonlinearly","constrained","optimization","problems","in\nRKHSs","they","do","not","imply","the","uniqueness","of","such","minimizers.","","The","lack","of","convexity","due","to","the\nnonlinearity","ofFmakes","it","impossible","to","obtain","such","uniqueness","results,","however,","a","positive\nresult","can","be","obtained","under","appropriate","assumptions","on","the","functionF.","","Recall","(3.9),","and\nassume","that","the","following","condition","holds\n(5.1)(z−z\n†\n)\nT\nΘ\n−1\nz\n†\n≥0","forF(z)","=y.\nGenerally,","this","condition","is","equivalent","to","the","requirement","that","the","nonlinear","manifoldV:=\n{\nv∈","U","|F\n(\n[φ,v]\n)\n=F\n(\n[φ,u\n?\n]\n)}\nlies","on","only","one","side","of","the","tangent","hyperplane","supported\nbyz\n†\nwith","Θ\n−1\n-normal","directionz\n†\n.","","Note","that","(5.1)","is","always","satisfied","with","an","equality","if","the\nPDE","is","linear,","i.e.,Fis","affine.","","Then","the","following","proposition","states","that","the","minimizeru\n†\nof\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS31\n(3.2)","is","not","only","unique,","it","is","also","the","minimax","optimal","approximation","ofu\n?\ninVin","the","sense\nof","optimal","recovery","[32].\nProposition","5.1.Under","condition(5.1)it","holds","true","that:\n1.u\n†\nis","unique.\n2.‖v−u\n†\n‖\n2\n≤‖v‖\n2\n−‖u\n†\n‖\n2\nfor","anyv∈V.\n3.u\n†\nis","one","of","the","minimzers","of","the","minimax","lossinf\nu∈V\nsup\nv∈V,v6=0\n‖v−u‖\n‖v‖\n.\nProof.For","","anyv∈","V,","","we","","denote","","byv=\n∑\nN\nn=1\n[φ\nn\n,v]χ\nn\n,","","the","","GP","","MAP","","solution","","after\nobserving","the","values","[φ\nn\n,v]","for","1≤n≤N.","","By","definition,\nv∈","Vand","[φ,v−v]","=","0.","","Thus,\nv−vis","orthogonal","to","the","linear","span","ofχ\nn\nin","the‖·‖norm.","","It","follows","that‖v−u\n†\n‖\n2\n=\n‖v−v‖\n2\n+‖v−u\n†\n‖\n2\n.","","Furthermore","writingz=","[φ,v],","we","have\n‖v−u\n†\n‖\n2\n=‖v‖\n2\n+‖u\n†\n‖\n2\n−2z\nT\nΘ\n−1\nz\n†\n=‖v‖\n2\n−‖u\n†\n‖\n2\n−2(z−z\n†\n)\nT\nΘ\n−1\nz\n†\n≤‖v‖\n2\n−‖u\n†\n‖\n2\n,\nwhere","we","used","the","relation‖u\n†\n‖\n2\n=","(z\n†\n)\nT\nΘ\n−1\nz\n†\nand","the","assumed","condition","(5.1).","","Thus,","we\ndeduce","that‖v−u\n†\n‖\n2\n≤‖v−\nv‖\n2\n+‖v‖\n2\n−‖u\n†\n‖\n2\n=‖v‖\n2\n−‖u\n†\n‖\n2\naccording","to","the","orthogonality.\nThis","leads","to","the","second","point","of","the","proposition,","and","the","first","point","follows","directly.\nThe","proof","of","the","third","point","is","similar","to","that","of","[39,","Thm.","18.2].","","Here","we","shall","prove","that\nfor","the","given","minimax","loss,","the","optimal","value","is","1","and","the","minimizer","is\n∑\nN\nn=1\nz\nn\nχ\nn\nfor","anyz\nsatisfyingF(z)","=y.","","To","achieve","this,","first","observe","that","the","loss","is","always","less","or","equal","to","1\nbecause","forv∈V,‖v−\nv‖\n2\n/‖v‖\n2\n≤1","andv∈V.","","Thus,","the","optimal","value","is","not","larger","than","1.\nMoreover,","letv\n⊥\nbe","a","nonzero","element","inUsuch","that","[φ,v\n⊥\n]","=","0.","","Considerv\nc\n=cv\n⊥\n+\n∑\nN\nn=1\nz\nn\nχ\nn\nfor","anyzsatisfyingF(z)","=y.","","Takingu=\n∑\nN\nn=1\nz\nn\nχ\nn\n,","we","have","that\n‖v\nc\n−u‖\n2\n‖v\nc\n‖\n2\n=\nc\n2\n‖v\n⊥\n‖\n2\nc\n2\n‖v\n⊥\n‖\n2\n+‖u‖\n2\n;\nthis","term","converges","towards","1","asc→","∞.","","Thus,","we","get","that","the","optimal","value","is","exactly","1\nandu=\n∑\nN\nn=1\nz\nn\nχ\nn\nare","minimizers.\nNote","that","the","above","proposition","implies","the","uniqueness","of","the","minimizeru\n†\nbut","does","not\nimply","the","uniqueness","of","the","solutionu\n?\n.","","It","is","also","interesting","to","observe","that","condition","(5.1)\nonly","involves","the","nonlinear","mapFand","not","the","differential","operators","defining","the","PDE.\n5.2.","","Error","","Estimates.Here","","we","","present","","rigorous","","error","","estimates","","in","","the","","PDE","","setting","","of\nSubsection","3","by","bounding","the","error","between","the","minimizeru\n†\nof","","(3.2)","and","the","true","solution\nu\n?\n.","","The","main","idea","behind","our","error","bounds","is","to","connect","the","conditional","covariance","of","the\nunderlying","GP","to","the","pointwise","error","of","the","conditional","MAP","estimator.\nIn","the","setting","of","Section","2.2,","consider","ker(φ)",":={u∈U|[φ,u]","=","0}.","","Then","the","conditional\ncovariance","operatorK\nφ\nof","Proposition","2.1","coincides","with","the","short","of","the","operatorKto","ker(φ)\n[2,","38]:","","this","is","a","symmetric","and","positive","operator","fromU\n∗\ntoUidentified","via\n(5.2)[φ,K\nφ\nφ]","=inf\nφ∈spanφ\n〈φ−φ,φ−φ〉\n∗\n=inf\nφ∈spanφ\n[φ−φ,K(φ−φ)],∀φ∈U\n∗\n,\nwhere","we","used","the","shorthand","notation","spanφ=","span{φ\n1\n,...,φ\nN\n}.","","This","identification","holds\ntrue","even","when","theφ\nn\nare","not","linearly","independent.","","With","the","notion","of","the","shorted","operator\n\n32Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nat","hand","we","can","now","present","an","abstract","error","bound","on","the","action","of","dual","elements","onu\n†\nand\nu\n?\n.\nProposition","5.2.LetHbe","","a","","Banach","","space","","endowed","","with","","a","","quadratic","","norm","","such","","that","","the\nembeddingU","⊂","His","","compact","","and","","such","","thatH\n∗\n⊂","U\n∗\nwhereH\n∗\nis","","defined","","using","","the","","same\nduality","","pairing","","as","","forU\n∗\n.","","","Letu\n†\n=\n∑\nN\nn=1\nz\n†\nn\nχ\nn\nbe","","a","","minimizer","","of(3.2)approximating","","the\nunique","solutionu\n?\nof(3.1).","","Fixφ∈H\n∗\nand","defineφas","in(3.5).","","Then","it","holds","true","that\n(5.3)\n∣\n∣\n[φ,u\n†\n]−[φ,u\n?\n]\n∣\n∣\n≤σ(φ)‖u\n?\n‖+\u000f‖φ‖\nH\n∗\n,\nwhereσ\n2\n(φ)",":=K(φ,φ)−K(φ,φ)K(φ,φ)\n−1\nK(φ,φ)and\n\u000f\n2\n:=\n\n\n\n\n\n\n\nmax\nz∈R\nN\n(z−z\n†\n)\nT\nA(z−z\n†\n)\ns.t.","","","F(z)","=y,\nz\nT\nΘ\n−1\nz≤‖u\n?\n‖\n2\n.\nwhereAis","theN×Npositive","symmetric","matrix","with","entriesA\ni,j\n=〈χ\ni\n,χ\nj\n〉\nH\n.","","Furthermore,\nit","also","holds","true","that\n(5.4)‖u\n†\n−u\n?\n‖≤inf\nφ∈spanφ\n‖u\n?\n−Kφ‖+\u000f.\nProof.Definev:=","[φ,u\n?\n]","and\nu:=v\nT\nΘ\n−1\nKφ∈U.","","By","triangle","inequality","we","have\n∣\n∣\n[φ,u\n?\n]−[φ,u\n†\n]\n∣\n∣\n≤\n∣\n∣\n[φ,u\n?\n]−[φ,\nu]\n∣\n∣\n+\n∣\n∣\n[φ,u]−[φ,u\n†\n]\n∣\n∣\n.\nSince","[φ,u\n?\n]","=","[φ,u]","then","by","[35,","Thm.","5.1],\n∣\n∣\n[φ,u\n?\n]−[φ,u]\n∣\n∣\n=inf\nφ∈spanφ\n∣\n∣\n[φ−φ,u\n?\n−u]\n∣\n∣\n≤inf\nφ∈spanφ\n‖φ−φ‖\n∗\n‖u\n?\n−u‖.\nThen","(5.2)","implies","that","inf\nφ∈spanφ\n‖φ−\nφ‖\n∗\n=σ(φ).","","Sinceuminimizes‖u‖subject","to","[φ,u]","=\n[φ,u\n?\n],","","we","","have‖u\n?\n−\nu‖\n2\n=‖u\n?\n‖\n2\n−","‖u‖\n2\n,","","which","","leads","","to|[φ,u\n?\n]−[φ,u]|","≤σ(φ)‖u\n?\n‖.\nFurthermore,|[φ,\nu]−[φ,u\n†\n]|≤‖φ‖\nH\n∗\n‖u−u\n†\n‖\nH\nand","observe","that‖u−u\n†\n‖\n2\nH\n=","(z−z\n†\n)A(z−z\n†\n).\nSince‖u‖≤‖u\n?\n‖and‖u\n†\n‖≤‖u‖\n?\n,","andF([φ,u])","=ywe","deduce","that‖u−u\n†\n‖\nH\nis","bounded","by\nthe","supremum","of‖v\n′\n−u\n†\n‖\nH\nover","allv\n′\n∈Uthat","belong","to","the","ball","of","radius‖u\n?\n‖and","satisfy","the\nPDE","constraints","at","the","collocation","points.","Inequality","(5.4)","follows","from‖u\n†\n−u\n?\n‖≤‖u\n?\n−\nu‖+\u000f\nand","the","the","fact","thatuis","the","projection","ofu\n†\nonto","spanφ[39,","Thm.","12.3].\nIn","the","case","whereH⊂C\nt\n(Ω)∩C\nt\n′\n(Ω)","we","can","takeφto","be","of","the","formδ\nx\n◦LwhereLis\na","differential","operator","of","order","at","mosttforx∈Ω,","andt\n′\nforx∈∂Ω.","","Then","Proposition","5.2\nallows","","us","","to","","bound","","the","","poitwise","","error","","ofu\n†\nand","","its","","derivatives.","","","As","","in","","Theorem","","3.3,","","the\ncompact","embedding","ofUintoHguarantees","the","convergence","ofσ(φ)","and\u000ftowards","zero","as","the\ncollocation","points","become","dense","in","Ω","and∂Ω.","","Note","that,","by","(5.4),","the","strong","approximation\nerror","betweenu\n†\nandu\n?\nis","controlled","by","the","sum","between\u000fand","the","best","approximation","error\nin","spanKφ.","","Controlling","this","best","approximation","error","is","typically","done","in","the","dual","space","in\nthe","linear","setting","[39,","Sec.","14.8].","","In","the","nonlinear","setting,","it","requires","controlling","the","regularity\nof","the","solution","(analyzing","the","underlying","PDE).","Moreover","if","the","fill","distance","of","the","collocation\npoints","ish,","and","if","the","norm‖·‖satisfies","the","embedding","inequality‖·‖","≤C‖·‖\nH\ns\n(Ω)\n,","then\n[39,","Lem.","14.39]","implies‖u\n?\n−\nu‖≤Ch\ns\n‖u\n?\n‖\nH\n2s\n(Ω)\n.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS33\n5.3.","","Learning","","the","","Kernel.An","important","factor","in","the","accuracy","and","performance","of","our\nmethod","is","the","choice","of","the","kernelK(and","in","turn,","the","operatorK).","","The","importance","of","the\nkernel","choice","is","readily","visible","in","Theorem","3.3","through","the","assumption","thatu\n?\n,","the","solution","of\nthe","PDE,","should","belong","to","theUthe","RKHS","corresponding","toK.","","As","discussed","in","[35],","even\nfor","linear","PDEs,","if","the","underlying","kernel","is","not","adapted","to","the","solution","space","of","the","PDE,","then\nthe","resulting","method","can","perform","arbitrarily","badly","[3].","","This","point","stresses","the","importance","of\nlearning","(or","possibly","programming","[41,","37])","an","informed","kernel","beyond","enforcing","the","PDE","at\ncollocation","points.","","While","the","problem","of","selecting","the","kernel","is","well-understood","if","the","solution\nis","smooth,","or","the","PDE","is","linear","with","possibly","rough","coefficients","[35],","it","can","be","challenging","when\nthe","underlying","PDE","is","nonlinear,","and","the","solution","is","irregular.","","Since","our","approach","employs","an\nexplicit","kernel","it","allows","us","to","learn","the","kernel","directly","using","kernel","(hyperparameter)","learning\ntechniques","such","as","maximum","likelihood","estimation","(MLE)","[10],","MAP","estimation","[37],","or","cross-\nvalidation","(CV)","[18,","42,","10].","","Adaptation","of","these","techniques","for","solution","of","nonlinear","PDEs\nis","an","attractive","direction","for","future","research.\n5.4.","","Non-Gaussian","priors.Although","we","have","employed","a","Gaussian","prior","in","the","design","of\nour","nonlinear","solver","and","in","our","Bayesian","IPs,","our","methodology","can","naturally","be","generalized","to\npriors","that","can","be","obtained","as","nonlinear","transformations","of","Gaussian","measures","(e.g.,","instead","of\nreplacing","the","solutionu\n?\nof","a","nonlinear","PDE","by","a","GPξ,","one","could","replace","it","byG(ξ)","whereGis\na","nonlinear","function","with","the","appropriate","degree","of","regularity","so","that","the","pointwise","derivatives\nofG(ξ)","","remain","","well-defined).","","","This","","approach","","can","","potentially","","lead","","to","","efficient","","methods","","for\ncomputing","MAP","estimators","of","Bayesian","IPs","with","certain","non-Gaussian","priors,","a","contemporary\nproblem","in","the","uncertainty","quantification","and","IP","literatures.\nAcknowledgments.The","authors","gratefully","acknowledge","support","by","the","Air","Force","Office\nof","Scientific","Research","under","MURI","award","number","FA9550-20-1-0358","(Machine","Learning","and\nPhysics-Based","Modeling","and","Simulation).","","HO","also","acknowledges","support","by","the","Air","Force\nOffice","of","Scientific","Research","under","award","number","FA9550-18-1-0271","(Games","for","Computation\nand","Learning).","","YC","is","also","grateful","for","support","from","the","Caltech","Kortchak","Scholar","Program.\nREFERENCES\n[1]R.","A.","Adams","and","J.","J.","Fournier,Sobolev","Spaces,","Elsevier,","2003.\n[2]W.","Anderson,","Jr","and","G.","Trapp,Shorted","","operators.","","II,","SIAM","Journal","on","Applied","Mathematics,","","28\n(1975),","pp.","60–71.\n[3]I.","Babu\nˇ\nska","and","J.","Osborn,Can","","a","","finite","","element","","method","","perform","","arbitrarily","","badly?,","","Mathematics","of\ncomputation,","69","(2000),","pp.","443–462.\n[4]Y.","Bar-Sinai,","","S.","Hoyer,","","J.","Hickey,","","and","M.","P.","Brenner,Learning","","data-driven","","discretizations","","for\npartial","differential","equations,","Proceedings","of","the","National","Academy","of","Sciences,","116","(2019),","pp.","15344–\n15349.\n[5]K.","Bhattacharya,","B.","Hosseini,","N.","B.","Kovachki,","and","A.","M.","Stuart,Model","","reduction","","and","","neural\nnetworks","for","parametric","PDEs.","","arXiv","preprint","arXiv:2005.03180,","2020.\n[6]V.","I.","Bogachev,Gaussian","measures,","American","Mathematical","Society,","1998.\n[7]G.","Boncoraglio","and","C.","Farhat,Active","","manifold","","and","","model","","reduction","","for","","multidisciplinary","","analysis\nand","optimization,","in","AIAA","Scitech","2021","Forum,","2021,","p.","1694.\n[8]H.","Brezis,Functional","","Analysis,","","Sobolev","","Spaces","","and","","Partial","","Differential","","Equations,","Springer","Science","&\nBusiness","Media,","2010.\n\n34Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\n[9]B.","Calderhead,","M.","Girolami,","and","N.","D.","Lawrence,Accelerating","Bayesian","inference","over","nonlinear\ndifferential","equations","with","Gaussian","processes,","in","Advances","in","neural","information","processing","systems,\nCiteseer,","2009,","pp.","217–224.\n[10]Y.","Chen,","H.","Owhadi,","and","A.","M.","Stuart,Consistency","of","empirical","Bayes","and","kernel","flow","for","hierar-\nchical","parameter","estimation.","","arXiv","preprint","arXiv:2005.11375,","2020.\n[11]J.","","Cockayne,","","C.","","J.","","Oates,","","T.","","J.","","Sullivan,","","and","","M.","","Girolami,Bayesian","","probabilistic","","numerical\nmethods,","SIAM","Review,","61","(2019),","pp.","756–789.\n[12]S.","L.","Cotter,","M.","Dashti,","and","A.","M.","Stuart,Approximation","of","Bayesian","inverse","problems","for","PDEs,\nSIAM","Journal","on","Numerical","Analysis,","48","(2010),","pp.","322–345.\n[13]S.","L.","Cotter,","G.","O.","Roberts,","A.","M.","Stuart,","and","D.","White,MCMC","methods","for","functions:","","modifying\nold","algorithms","to","make","them","faster,","Statistical","Science,","(2013),","pp.","424–446.\n[14]M.","Dashti,","K.","J.","Law,","A.","M.","Stuart,","and","J.","Voss,MAP","estimators","and","their","consistency","in","Bayesian\nnonparametric","inverse","problems,","Inverse","Problems,","29","(2013),","p.","095017.\n[15]M.","Dashti","and","A.","M.","Stuart,The","Bayesian","approach","to","inverse","problems,","in","Handbook","of","Uncertainty\nQuantification,","R.","Ghanem,","D.","Higdon,","and","H.","Owhadi,","eds.,","Springer","International","Publishing,","2016,\npp.","1–118.\n[16]P.","Diaconis,Bayesian","","numerical","","analysis,","in","Statistical","Decision","Theory","and","Related","Topics","IV,","S.","S.\nGupta","and","J.","Berger,","eds.,","Springer,","1988.\n[17]B.","Djeridane","and","J.","Lygeros,Neural","approximation","of","PDE","solutions:","","An","application","to","reachability\ncomputations,","","in","","Proceedings","","of","","the","","45th","","IEEE","","Conference","","on","","Decision","","and","","Control,","","IEEE,","","2006,\npp.","3034–3039.\n[18]J.","Friedman,","T.","Hastie,","and","R.","Tibshirani,The","elements","of","statistical","learning,","Springer,","2001.\n[19]I.","Goodfellow,","Y.","Bengio,","A.","Courville,","and","Y.","Bengio,Deep","learning,","vol.","1,","MIT","press,","2016.\n[20]J.","Han,","A.","Jentzen,","and","E.","Weinan,Solving","high-dimensional","partial","differential","equations","using","deep\nlearning,","Proceedings","of","the","National","Academy","of","Sciences,","115","(2018),","pp.","8505–8510.\n[21]K.","He,","X.","Zhang,","S.","Ren,","and","J.","Sun,Deep","residual","learning","for","image","recognition,","in","Proceedings","of\nthe","IEEE","conference","on","computer","vision","and","pattern","recognition,","2016,","pp.","770–778.\n[22]P.","Hennig,","M.","A.","Osborne,","and","M.","Girolami,Probabilistic","numerics","and","uncertainty","in","computations,\nProceedings","of","the","Royal","Society","A,","471","(2015),","p.","20150142.\n[23]A.","Jacot,","F.","Gabriel,","and","C.","Hongler,Neural","tangent","kernel:","","convergence","and","generalization","in","neu-\nral","networks,","in","Proceedings","of","the","32nd","International","Conference","on","Neural","Information","Processing\nSystems,","2018,","pp.","8580–8589.\n[24]G.","Karniadakis,","I.","Kevrekidis,","L.","Lu,","P.","Perdikaris,","S.","Wang,","and","L.","Yang,Physics-informed\nmachine","learning,","Nature","Reviews","Physics,","(2021).\n[25]G.","Kimeldorf","and","G.","Wahba,Some","results","on","Tchebycheffian","spline","functions,","Journal","of","mathematical\nanalysis","and","applications,","33","(1971),","pp.","82–95.\n[26]G.","S.","Kimeldorf","and","G.","Wahba,A","correspondence","between","Bayesian","estimation","on","stochastic","processes\nand","smoothing","by","splines,","Annals","of","Mathematical","Statistics,","41","(1970),","pp.","495–502.\n[27]I.","E.","Lagaris,","A.","C.","Likas,","and","D.","G.","Papageorgiou,Neural-network","","methods","","for","","boundary","","value\nproblems","with","irregular","boundaries,","IEEE","Transactions","on","Neural","Networks,","11","(2000),","pp.","1041–1049.\n[28]F.","","M.","","Larkin,Gaussian","","measure","","in","","Hilbert","","space","","and","","applications","","in","","numerical","","analysis,","","Journal","","of\nMathematics,","2","(1972).\n[29]Z.","Li,","N.","Kovachki,","K.","Azizzadenesheli,","B.","Liu,","K.","Bhattacharya,","A.","Stuart,","and","A.","Anand-\nkumar,Fourier","","","neural","","","operator","","","for","","","parametric","","","partial","","","differential","","","equations.arXiv","","preprint\narXiv:2010.08895,","2020.\n[30]Z.","Li,","N.","Kovachki,","K.","Azizzadenesheli,","B.","Liu,","K.","Bhattacharya,","A.","Stuart,","and","A.","Anand-\nkumar,Multipole","graph","neural","operator","for","parametric","partial","differential","equations.","","arXiv","preprint\narXiv:2006.09535,","2020.\n[31]Z.","Long,","Y.","Lu,","X.","Ma,","and","B.","Dong,PDE-net:","","Learning","PDEs","from","data,","in","International","Conference\non","Machine","Learning,","PMLR,","2018,","pp.","3208–3216.\n[32]C.","A.","Micchelli","and","T.","J.","Rivlin,A","survey","of","optimal","recovery,","in","Optimal","estimation","in","approximation\ntheory,","C.","Micchelli","and","T.","J.","Rivlin,","eds.,","Springer,","1977,","pp.","1–54.\n[33]N.","H.","Nelsen","and","A.","M.","Stuart,The","","random","","feature","","model","","for","","input-output","","maps","","between","","Banach\nspaces.","","arXiv","preprint","arXiv:2005.10224,","2020.\n\nSOLVING","AND","LEARNING","NONLINEAR","PDES","WITH","GPS35\n[34]J.","Nocedal","and","S.","Wright,Numerical","Optimization,","Springer","Science","&","Business","Media,","2006.\n[35]H.","Owhadi,Bayesian","numerical","homogenization,","Multiscale","Modeling","&","Simulation,","13","(2015),","pp.","812–\n828.\n[36]H.","Owhadi,Multigrid","with","rough","coefficients","and","multiresolution","operator","decomposition","from","hierarchical\ninformation","games,","SIAM","Review,","59","(2017),","pp.","99–149.\n[37]H.","","Owhadi,Do","","ideas","","have","","shape?","","","plato’s","","theory","","of","","forms","","as","","the","","continuous","","limit","","of","","artificial","","neural\nnetworks.","","arXiv","preprint","arXiv:2008.03920,","2020.\n[38]H.","Owhadi","and","C.","Scovel,Conditioning","Gaussian","measure","on","Hilbert","space.","arXiv","preprint:1506.04208,\n2018.\n[39]H.","Owhadi","and","C.","Scovel,Operator-Adapted","Wavelets,","Fast","Solvers,","and","Numerical","Homogenization:\nFrom","","a","","Game","","Theoretic","","Approach","","to","","Numerical","","Approximation","","and","","Algorithm","","Design,","","Cambridge\nUniversity","Press,","2019.\n[40]H.","Owhadi,","","C.","Scovel,","","and","F.","Sch\n","̈\nafer,Statistical","","numerical","","approximation,","","Notices","of","the","AMS,\n(2019).\n[41]H.","Owhadi,","C.","Scovel,","and","G.","R.","Yoo,Kernel","mode","decomposition","and","programmable/interpretable\nregression","networks.","","arXiv","preprint","arXiv:1907.08592,","2019.\n[42]H.","Owhadi","and","G.","R.","Yoo,Kernel","","flows:","","From","","learning","","kernels","","from","","data","","into","","the","","abyss,","Journal","of\nComputational","Physics,","389","(2019),","pp.","22–47.\n[43]H.","Owhadi","and","L.","Zhang,Gamblets","","for","","opening","","the","","complexity-bottleneck","","of","","implicit","","schemes","","for","","hy-\nperbolic","","and","","parabolic","","ODEs/PDEs","","with","","rough","","coefficients,","","Journal","of","Computational","Physics,","","347\n(2017),","pp.","99–128.\n[44]I.","Palasti","and","A.","Renyi,On","interpolation","theory","and","the","theory","of","games,","MTA","Mat.","Kat.","Int.","Kozl,\n1","(1956),","pp.","529–540.\n[45]O.","","Perrin","","and","","P.","","Monestiez,Modelling","","of","","non-stationary","","spatial","","structure","","using","","parametric","","radial\nbasis","","deformations,","","in","","GeoENV","","II—Geostatistics","","for","","Environmental","","Applications,","","Springer,","","1999,\npp.","175–186.\n[46]H.","Poincar\n","́\ne,Calcul","des","probabilit","́es,","Georges","Carr","́es,","1896.\n[47]V.","D.","R\n","̆\nadulescu,Qualitative","analysis","of","nonlinear","elliptic","partial","differential","equations:","","monotonicity,\nanalytic,","and","variational","methods,","Hindawi","Publishing","Corporation,","2008.\n[48]M.","Raissi,","P.","Perdikaris,","and","G.","E.","Karniadakis,Physics-informed","neural","networks:","","A","deep","learning\nframework","for","solving","forward","and","inverse","problems","involving","nonlinear","partial","differential","equations,\nJournal","of","Computational","Physics,","378","(2019),","pp.","686–707.\n[49]M.","Raissi,","A.","Yazdani,","and","G.","E.","Karniadakis,Hidden","fluid","mechanics:","","learning","velocity","and","pressure\nfields","from","flow","visualizations,","Science,","367","(2020),","pp.","1026–1030.\n[50]R.","Rico-Martinez","and","I.","G.","Kevrekidis,Continuous","","time","","modeling","","of","","nonlinear","","systems:","","A","","neural\nnetwork-based","approach,","in","IEEE","International","Conference","on","Neural","Networks,","IEEE,","1993,","pp.","1522–\n1525.\n[51]P.","D.","Sampson","and","P.","Guttorp,Nonparametric","estimation","of","nonstationary","spatial","covariance","struc-\nture,","Journal","of","the","American","Statistical","Association,","87","(1992),","pp.","108–119.\n[52]A.","Sard,Linear","approximation,","American","Mathematical","Society,","1963.\n[53]R.","Schaback","and","H.","Wendland,Kernel","techniques:","","from","machine","learning","to","meshless","methods,","Acta\nnumerica,","15","(2006),","p.","543.\n[54]F.","Sch\n","̈\nafer,","M.","Katzfuss,","and","H.","Owhadi,Sparse","","Cholesky","","factorization","","by","","Kullback-Leibler","","mini-\nmization,","SIAM","Journal","on","Scientific","Computing,","(2020).","","arXiv","preprint:2004.14455.\n[55]F.","Sch\n","̈\nafer,","T.","Sullivan,","and","H.","Owhadi,Compression,","","inversion,","","and","","approximate","","PCA","","of","","dense\nkernel","matrices","at","near-linear","computational","complexity,","SIAM","Multiscale","Modeling","and","Simulation,\n(2017).","","arXiv:1706.02205.\n[56]M.","Schober,","D.","Duvenaud,","and","P.","Hennig,Probabilistic","","ODE","","solvers","","with","","Runge-Kutta","","means,","in\n28th","Annual","Conference","on","Neural","Information","Processing","Systems,","2014,","pp.","739–747.\n[57]B.","Scholkopf","and","A.","J.","Smola,Learning","with","kernels:","","support","vector","machines,","regularization,","opti-\nmization,","and","beyond,","MIT","Press,","2018.\n[58]Y.","Shin,","J.","Darbon,","and","G.","E.","Karniadakis,On","","the","","convergence","","and","","generalization","","of","","physics","","in-\nformed","neural","networks.","","arXiv","preprint","arXiv:2004.01806,","2020.\n[59]J.","","Sirignano","","and","","K.","","Spiliopoulos,DGM:","","A","","deep","","learning","","algorithm","","for","","solving","","partial","","differential\n\n36Y.","CHEN,","B.","HOSSEINI,","H.","OWHADI,","AM.","STUART\nequations,","Journal","of","Computational","Physics,","375","(2018),","pp.","1339–1364.\n[60]J.","","Skilling,Bayesian","","solution","","of","","ordinary","","differential","","equations,","","in","","Maximum","","entropy","","and","","Bayesian\nmethods,","C.","R.","Smith,","G.","J.","Erickson,","and","P.","O.","Neudorfer,","eds.,","Springer,","1992,","pp.","23–37.\n[61]J.","Smoller,Shock","Waves","and","Reaction—Diffusion","Equations,","Springer","Science","&","Business","Media,","2012.\n[62]M.","L.","Stein,The","screening","effect","in","kriging,","Annals","of","statistics,","30","(2002),","pp.","298–323.\n[63]A.","M.","Stuart,Inverse","problems:","","a","Bayesian","perspective,","Acta","numerica,","19","(2010),","pp.","451–559.\n[64]A.","","V.","","Sul’din,Wiener","","measure","","and","","its","","applications","","to","","approximation","","methods.","","I,","","Izvestiya","","Vysshikh\nUchebnykh","Zavedenii","Matematika,","(1959),","pp.","145–158.\n[65]L.","P.","Swiler,","M.","Gulian,","A.","L.","Frankel,","C.","Safta,","and","J.","D.","Jakeman,A","","survey","","of","","constrained\nGaussian","process","regression:","","Approaches","and","implementation","challenges,","Journal","of","Machine","Learning\nfor","Modeling","and","Computing,","1","(2020).\n[66]E.","Tadmor,A","","review","","of","","numerical","","methods","","for","","nonlinear","","partial","","differential","","equations,","Bulletin","of","the\nAmerican","Mathematical","Society,","49","(2012),","pp.","507–554.\n[67]J.","","F.","","Traub,","","G.","","Wasilkowski,","","H.","","Wozniakowski,","","and","","E.","","Novak,Information-based","","complexity,\nSIAM","Review,","36","(1994),","pp.","514–514.\n[68]J.","F.","Traub,","G.","W.","Wasilkowski,","and","H.","Wo\n","́\nzniakowski,Average","case","optimality","for","linear","problems,\nTheoretical","Computer","Science,","29","(1984),","pp.","1–25.\n[69]T.","Uchiyama","and","N.","Sonehara,Solving","inverse","problems","in","nonlinear","PDEs","by","recurrent","neural","net-\nworks,","in","IEEE","International","Conference","on","Neural","Networks,","1993,","pp.","99–102.\n[70]R.","van","der","Meer,","C.","Oosterlee,","and","A.","Borovykh,Optimally","","weighted","","loss","","functions","","for","","solving\nPDEs","with","neural","networks.","","arXiv","preprint","arXiv:2002.06269,","2020.\n[71]A.","W.","van","der","Vaart","and","J.","H.","van","Zanten,Reproducing","kernel","Hilbert","spaces","of","Gaussian","priors,","in\nPushing","the","limits","of","contemporary","statistics:","","contributions","in","honor","of","Jayanta","K.","Ghosh,","Institute\nof","Mathematical","Statistics,","2008,","pp.","200–222.\n[72]A.","V.","Vecchia,Estimation","and","model","identification","for","continuous","spatial","processes,","Journal","of","the","Royal\nStatistical","Society:","","Series","B","(Methodological),","50","(1988),","pp.","297–312.\n[73]G.","Wahba,Spline","models","for","observational","data,","SIAM,","1990.\n[74]S.","Wang,","","H.","Wang,","","and","P.","Perdikaris,On","","the","","eigenvector","","bias","","of","","fourier","","feature","","networks:","","From\nregression","","to","","solving","","multi-scale","","PDEs","","with","","physics-informed","","neural","","networks.arXiv","","preprint\narXiv:2012.10047,","2020.\n[75]S.","","Wang,","","X.","","Yu,","","and","","P.","","Perdikaris,When","","and","","why","","PINNs","","fail","","to","","train:","","","a","","neural","","tangent","","kernel\nperspective.","","arXiv","preprint","arXiv:2007.14527,","2020.\n[76]E.","Weinan","and","B.","Yu,The","","deep","","ritz","","method:","","a","","deep","","learning-based","","numerical","","algorithm","","for","","solving\nvariational","problems,","Communications","in","Mathematics","and","Statistics,","6","(2018),","pp.","1–12.\n[77]H.","Wendland,Scattered","Data","Approximation,","Cambridge","University","Press,","2004.\n[78]C.","K.","I.","Williams","and","C.","E.","Rasmussen,Gaussian","Processes","for","Machine","Learning,","The","MIT","Press,\n2006.\n[79]A.","G.","Wilson,","Z.","Hu,","R.","Salakhutdinov,","and","E.","P.","Xing,Deep","kernel","learning,","in","Artificial","Intelli-\ngence","and","Statistics,","PMLR,","2016,","pp.","370–378.\n[80]X.","Zhang,","K.","Z.","Song,","M.","W.","Lu,","and","X.","Liu,Meshless","methods","based","on","collocation","with","radial","basis\nfunctions,","Computational","Mechanics,","26","(2000),","pp.","333–343.\n[81]Y.","Zhu","and","N.","Zabaras,Bayesian","deep","convolutional","encoder–decoder","networks","for","surrogate","modeling\nand","uncertainty","quantification,","Journal","of","Computational","Physics,","366","(2018),","pp.","415–447."],"doc12":["\n\nApproximating","Instance-Dependent","Noise\nvia","Instance-Confidence","Embedding\nYivan","Zhang\n1,2\nMasashi","Sugiyama\n2,1\n1\nThe","University","of","Tokyo\n2\nRIKEN","AIP\nAbstract\nLabel","noise","in","multiclass","classification","is","a","major","obstacle","to","the","deployment","of\nlearning","systems.","","However,","unlike","the","widely","usedclass-conditional","noise(CCN)\nassumption","that","the","noisy","label","is","independent","of","the","input","feature","given","the","true","label,\nlabel","noise","in","real-world","datasets","can","be","aleatory","and","heavily","dependent","on","individual\ninstances.","In","this","work,","we","investigate","theinstance-dependent","noise(IDN)","model\nand","propose","an","efficient","approximation","of","IDN","to","capture","the","instance-specific","label\ncorruption.","Concretely,","noting","the","fact","that","most","columns","of","the","IDN","transition","matrix\nhave","only","limited","influence","on","the","class-posterior","estimation,","we","propose","a","variational\napproximation","that","uses","a","single-scalarconfidenceparameter.","To","cope","with","the","situation\nwhere","the","mapping","from","the","instance","to","its","confidence","value","could","vary","significantly","for\ntwo","adjacent","instances,","we","suggest","usinginstance","embeddingthat","assigns","a","trainable\nparameter","to","each","instance.","The","resultinginstance-confidence","embedding(ICE)","method\nnot","only","performs","well","under","label","noise","but","also","can","effectively","detect","ambiguous","or\nmislabeled","instances.","We","validate","its","utility","on","various","image","and","text","classification\ntasks.\n1","","Introduction\nIn","modern","machine","learning,","large-scale","data","has","become","indispensable","[Russakovsky","et","al.,\n2015,","Wang","et","al.,","2019a].","A","prevalent","approach","to","collecting","large-scale","labeled","datasets","is\nto","use","imperfect","sources","such","as","crowdsourcing","and","web","crawling","[Fergus","et","al.,","2005,","Schroff\net","al.,","2010,","Wang","et","al.,","2019a],","which","is","usually","less","expensive","and","time-consuming","than\nmanual","annotation","by","domain","experts.","However,","such","methods","inevitably","introduce","label\nnoise","that","may","lead","to","overfitting","and","hurt","the","generalization","of","deep","models","[Arpit","et","al.,\n2017,","Zhang","et","al.,","2017].\nIn","such","situations,","it","is","often","beneficial","to","(i)","remove","mislabeled","data","or","abstain","from","using\nconfusing","instances","[Hara","et","al.,","2019,","Thulasidasan","et","al.,","2019];","(ii)","increase","robustness","and\nreduce","harmful","influences","of","noisy","labels","[Malach","and","Shalev-Shwartz,","2017,","Mirzasoleiman\net","al.,","2020,","Liu","et","al.,","2020];","or","(iii)","explicitly","model","the","transition","from","the","unobservable\ntrue","label","to","the","noisy","observation","[Goldberger","and","Ben-Reuven,","2017,","Patrini","et","al.,","2017,\nXia","et","al.,","2020].","In","this","work,","we","focus","on","explicit","modeling","of","the","label","corruption","process,\nwhich","is","model-agnostic","and","data-efficient.\nMost","existing","studies","in","this","direction","employ","theclass-conditional","noise(CCN)","assump-\ntion,","i.e.,","the","noisy","label","is","independent","of","the","input","feature","given","the","true","label","[Angluin\nand","Laird,","1988,","Natarajan","et","al.,","2013,","Patrini","et","al.,","2017].","However,","this","assumption\ncould","be","too","strong","to","fit","some","real-world","data","well","[Xiao","et","al.,","2015,","Chen","et","al.,","2021].\nMore","importantly,","CCN","only","captures","the","general","label","flipping","patterns","between","classes\nfor","all","instances.","In","applications","such","as","data","cleansing","and","human-in-the-loop","interaction,\ninstance-specific","noise","information","itself","could","be","of","central","interest.","This","urges","us","to","consider\nnot","only","the","class-conditional","noise","pattern","but","also","the","instance-specific","noise","modeling.\n1\narXiv:2103.13569v1","","[cs.LG]","","25","Mar","2021\n\nX\nY\n","̃\nY\n(a)","IND\nX\nY\n","̃\nY\n(b)","CCN\nX\nY\n","̃\nY\n(c)","IDN\nX\nY\n","̃\nY\nC\n(d)","ICE\nFigure","1:Graphical","representationsof","noise","models,","including","the","the","conditionally\nindependent","labels","(IND)","model,","class-conditional","noise","(CCN)","model,","instance-dependent\nnoise","(IDN)","model,","and","the","proposedinstance-confidence","embedding(ICE)","approximation","of\nIDN.","Here,Xis","theinput","feature,Yis","thetrue","label,\n","̃\nYis","thenoisy","label,","andC∈[0,1]is","a\nscalarconfidenceparameter.\nTo","handle","this","problem,","in","this","work,","we","study","theinstance-dependent","noise(IDN)","model,\nwhere","the","noisy","label","also","depends","on","the","input.","Several","methods","have","been","reported","in\nthe","literature,","but","they","either","only","focus","on","binary","classification","under","strong","assumptions\n[Menon","et","al.,","2018,","Cheng","et","al.,","2020]","or","are","based","on","domain-specific","knowledge","[Xia\net","al.,","2020].","In","contrast,","we","propose","a","simple","domain-agnostic","approximation","method","for\nthe","multiclass","IDN","model,","referred","to","asinstance-confidence","embedding(ICE).","Concretely,\nto","avoid","estimating","a","noise","transition","matrix","for","each","instance,","we","propose","a","variational\napproximation","that","uses","a","scalarconfidenceparameter","(Section","3.2).","Then,","we","suggest","to\nuseinstance","embeddingthat","assigns","a","trainable","parameter","to","each","instance","because","the\nmapping","from","the","instance","to","its","confidence","value","could","be","non-smooth","and","is","usually","not\nrequired","to","generalize","to","unseen","examples","(Section","3.3).","Lastly,","we","show","the","effectiveness","of\nthe","proposed","method","and","its","ability","to","detect","ambiguous","or","mislabeled","instances","through\nexperiments","on","various","image","and","text","classification","tasks","(Section","5).\n2","","Problem:","Instance-Dependent","Noise\nIn","this","section,","we","give","a","brief","overview","of","learning","withinstance-dependent","noise(IDN).\n2.1","","Notation\nConsider","aK-class","classification","problem,","whereX∈","Xis","theinput","featureandY∈\n{1,...,K}is","the","unobservabletrue","label.","We","assume","that","theclean","class-posteriorp(Y|X)\ncomes","from","a","parametric","family","of","distributions:\np\nφ\n(Y|X)\n:\n=","Categorical(Y|p=f(X;φ)),(1)\nwherep∈∆\nK−1\nis","the","probability","parameter","forYin","the(K−1)-dimensional","probability\nsimplex∆\nK−1\n,","andf:X","→∆\nK−1\nis","a","differentiable","function","parameterized","byφthat","maps\nthe","featureXto","its","corresponding","probability","parameterp.","Then,","let\n","̃\nY∈{1,...,K}be","the\nnoisy","label.","The","goal","is","to","predictYfromXbased","on","a","finite","i.i.d.","sample","of(X,\n","̃\nY)-pairs.\n2.2","","Dependence\nNext,","we","introduce","the","dependence","structure","betweenX,Y,","and\n","̃\nY\n,","which","characterize\ndifferent","noise","models.","The","graphical","representations","of","noise","models","are","illustrated","in","Fig.","1.\nIn","IDN,","we","assume","that","the","joint","distribution","ofX,Y,","and\n","̃\nYcan","be","factorized","as","follows:\np(X,Y,\n","̃\nY)","=p(\n","̃\nY|Y,X)p\nφ\n(Y|X)p(X).(2)\n2\n\nThat","is,","the","noisy","label\n","̃\nYdepends","on","both","the","instanceXand","the","true","labelY.","Then,","the\nnoisy","class-posteriorp(\n","̃\nY|X)can","be","obtained","by","marginalizingp(Y,\n","̃\nY|X)overY:\np\nφ\n(\n","̃\nY|X)\n:\n=","Categorical(\n","̃\nY|q=\n∑\nK\nY=1\np(\n","̃\nY|Y,X)p\nφ\n(Y|X)),(3)\nwhereq∈∆\nK−1\ndenotes","the","probability","parameter","for\n","̃\nY.\nNote","thatp(\n","̃\nY|Y,X)plays","a","central","role","in","IDN.","Since","bothYand\n","̃\nYare","categorical\nrandom","variables,","for","a","certain","instancex,p(\n","̃\nY|Y,X\n=x)can","be","seen","as","aK×Kstochastic\nmatrixT(x),","whose","elements","areT\nij\n(x)\n:\n=p(\n","̃\nY=j|Y=i,X=x)fori,j∈","{1,...,K}.\nConventionally,T(x)is","called","anoise","transition","matrix[Patrini","et","al.,","2017].","Then,p(\n","̃\nY|Y,X)\ncan","be","regarded","as","a","matrix-valued","functionT:X","→[0,1]\nK×K\nthat","maps","each","instancex\nto","its","corresponding","IDN","transition","matrixT(x).","Without","any","restriction,","we","needK×K\nparameters","for","each","instancex.\n2.3","","Approach\nOwing","to","its","complexity,","IDN","has","only","been","studied","to","a","limited","extent","but","is","of","great\ninterest","recently.","A","straightforward","method","is","to","jointly","estimate","the","matrix-valued","function\nT(x)as","well","as","the","clean","class-posteriorp\nφ\n(Y|X)using","neural","networks","[Goldberger","and\nBen-Reuven,","2017].","However,","the","estimation","error","ofT(x)could","be","high,","which","deteriorates\nthe","classification","performance.","Another","direction","is","to","restrict","the","problem","under","certain\nconditions,","so","that","we","can","provide","theoretical","guarantees","[Menon","et","al.,","2018,","Cheng","et","al.,\n2020].","However,","existing","work","mainly","focused","on","binary","classification.\nA","promising","approach","is","to","approximate","IDN","using","a","simpler","dependence","structure,","such\nas","a","mixture","of","noises","with","different","semantic","meanings","[Xiao","et","al.,","2015]","or","a","weighted\ncombination","of","noises","that","depend","on","parts","of","the","instance","[Xia","et","al.,","2020].","In","this","work,\nwe","also","suggest","that","it","might","be","unnecessary","to","obtain","aK×Kmatrix","for","each","instance\nx:","Note","thatp\nφ\n(\n","̃\nY|x\n)can","be","seen","as","a","linear","combination","of","columns","ofT(x)weighted","by\np\nφ\n(Y|x);","If","the","maximum","value","ofp\nφ\n(Y|x)is","close","to1,","i.e.,","the","label","of","the","instancexis\nalmost","deterministic,","the","estimation","ofK−1columns","ofT(x)has","only","limited","influence","on\nthe","estimated","noisy","class-posterior̂p(\n","̃\nY|x).","This","suggests","the","possibility","of","using","a","relatively\nsimple","model","to","approximatep(\n","̃\nY|X)in","real-world","applications.","In","this","work,","we","consider","a\nsingle-parameterapproximation","for","each","instance,","which","is","introduced","in","Section","3.2","and\nillustrated","in","Fig.","2.\nAnother","issue","is","that","existing","methods","still","introduce","some","level","of","smoothness","w.r.t.x\nintoT(x)[Goldberger","and","Ben-Reuven,","2017,","Xiao","et","al.,","2015,","Xia","et","al.,","2020].","In","real-\nworld","problems,","however,","we","can","only","access","a","finite","sample","of(X,\n","̃\nY)-pairs","that","are","possibly\nannotated","by","non-experts","or","web","crawlers","[Fergus","et","al.,","2005].","Thus,","the","label","noise","could\nbe","aleatory","andT(x)could","vary","significantly","for","two","adjacent","instances.","Also,","the","classifier\np\nφ\n(Y|X)is","desired","but","the","generalization","ofT(x)to","unseen","examples","is","usually","dispensable.\nThis","inspires","us","to","useinstance","embeddinginstead","of","neural","network","approximation,","which\nis","discussed","in","Section","3.3","and","demonstrated","in","Fig.","3.\n3","","Proposed","Method\nIn","this","section,","we","present","our","proposed","method,instance-confidence","embedding(ICE).\n3.1","","Variational","lower","bound\nNote","thatT(x)serves","as","alinear","mappingfromptoq(Eq.","(3)).","Due","to","the","difficulty","of\nestimating","the","matrix-valued","functionT(x),","we","use","a","simpler","functionq\nθ,φ\n(\n","̃\nY|X)parame-\nterized","byθas","avariational","approximationtop\nφ\n(\n","̃\nY|X).","The","choice","of","the","approximation\nfamily","is","discussed","in","Section","3.2.\n3\n\nCleanLinear","interpolationPower","transformationNoisy\nFigure","2:","An","illustration","of","the","transformation","(N7→H)","from","the","clean","class-posterior\np\nφ\n(Y|x)(the","leftmost)","to","the","noisy","class-posteriorp\nφ\n(\n","̃\nY|x)(the","rightmost).","We","can","see\nthat","when","the","label","is","almost","deterministic","(Nis","close","to","a","vertex),","the","estimation","ofK−1\ncolumns","of","the","transition","matrixT(x)(the","two","deviated","vertices","of","the","dotted","triangle)","has\nonly","limited","influence","on","the","estimated","noisy","class-posterior̂p(\n","̃\nY|x)(Mis","still","close","toH).\nThis","inspires","us","to","go","a","step","further","and","usesingle-parameter","approximations(N7→O)\nq\nθ,φ\n(\n","̃\nY|x)(Eqs.","(8)","and","(9)).\nThen,","let","us","consider","theexpected","log-likelihoodas","the","learning","objective,","which","can","be\nrewritten","as\nE\n","̃\nY∼p(\n","̃\nY|X)\n[logp(\n","̃\nY|X)]","=D\nKL\n(p\nφ\n(\n","̃\nY|X)‖q\nθ,φ\n(\n","̃\nY|X))","+L(θ,φ;X),(4)\nwhereD\nKL\ndenotes","the","Kullback-Leibler","(KL)","divergence,","and","the","second","term","is\nL(θ,φ;X)\n:\n=E\n","̃\nY∼p(\n","̃\nY|X)\n[logq\nθ,φ\n(\n","̃\nY|X)].(5)\nSince","the","KL-divergence","is","always","non-negative,","this","term","gives","avariational","lower","boundof\nthe","expected","log-likelihood.","Then,","we","have","the","following","learning","objective","to","maximize:\nL(θ,φ)\n:\n=E\nX∼p(X)\n[L(θ,φ;X)]","=E\nX,\n","̃\nY∼p(X,\n","̃\nY)\n[logq\nθ,φ\n(\n","̃\nY|X)].(6)\nIn","practice,","the","expectation","can","be","approximated","using","the","empirical","distribution","based","on\na","finite","i.i.d.","sample","of(X,\n","̃\nY)-pairs.\n3.2","","Variational","approximation\nNext,","we","discuss","the","choice","of","the","variational","approximation","family","ofq\nθ,φ\n(\n","̃\nY|X).\nTo","approximate","the","effect","of","multiplying","an","IDN","transition","matrixT(x)that","requires\nK×Kparameters","for","each","instancex,","in","this","work,","we","use","a","simpler","transformation","from\nptoq,","which","is","not","necessarily","linear.","Compared","with","estimating","a","full","matrix","for","each\ninstance","without","any","restriction","[Goldberger","and","Ben-Reuven,","2017],","obtaining","only","an\napproximation","may","cause","higher","approximation","error,","but","on","the","other","hand,","it","may","reduce\nestimation","error","and","thus","improve","the","classification","performance.","The","high","estimation","error\nof","complex","models","might","be","more","harmful,","which","is","empirically","validated","in","Section","5.","It","is\nalso","the","case","when","using","CCN","as","an","approximation","of","IDN","to","balance","this","trade-off.","The\ndifference","is","that","CCN","obtains","acompletetransition","matrix","forallinstances,","but","ICE","aims\nto","obtain","anapproximatedtrend","foreachinstance,","which","gives","useful","instance-specific","noise\ninformation.\nThen,","we","suggest","to","use","a","single-scalar","parameterC∈[0,1]for","each","instance","to","control\nthis","approximation,","which","is","useful","for","sorting","and","comparing","training","examples.","This\nparameter","is","referred","to","as","theconfidenceand","is","obtained","via","a","functiong:X","→[0,1]\nparameterized","byθ,","i.e.,C=g(X;θ).","The","confidenceCplays","a","central","role","in","our","method,\nwhereC=","0means","that","the","instance","is","ambiguous","or","mislabeled","and","thus","the","classifier\nshould","not","give","a","confident","prediction.\n4\n\n−10.0−7.5−5.0−2.50.02.55.07.510.0\n0.00\n0.02\n0.04\n0.06\n0.08\n0.10\n0.12\n0.14\nData\np(X,Y=","1)\np(X,Y=","2)\np(X,Y=","3)\np(X)\nData\n−10.0−7.5−5.0−2.50.02.55.07.510.0\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nCross","entropy\np(Y|X)\n̂\np(Y|X)\n−10.0−7.5−5.0−2.50.02.55.07.510.0\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nWeight","decay\np(Y|X)\n̂\np(Y|X)\n−10.0−7.5−5.0−2.50.02.55.07.510.0\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nModified","confidence\np(Y|X)\n̂\np(Y|X)\nConfidence\n−10.0−7.5−5.0−2.50.02.55.07.510.0\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nInstance","embedding\np(Y|X)\n̂\np(Y|X)\nConfidence\nFigure","3:","An","example","of","the","learnedclass-posteriorsusing","(a)","the","usual","cross","entropy\nwithout","any","modification;","(b)","the","one","with","weight","decay","as","a","regularization;","(c)","modified\nconfidence","of","the","prediction","(Eq.","(8))","with","neural","network","approximation","forg:X","→[0,1];\nand","(d)","the","one","with","instance","embedding,","i.e.,","the","proposedinstance-confidence","embedding\n(ICE)","method.","The","points","with","black","edges","are","mislabeled","instances.","We","can","observe","that\nnoisy","labels","affect","the","decision","boundary","and","the","model","complexity.","With","weight","decay,","the\nmodel","complexity","can","be","controlled","but","the","confidence","is","deviated.","Comparing","the","last","two\npanels,","modifying","the","confidence","of","the","prediction","via","Eq.","(8)","works","better","with","instance\nembedding","than","neural","network","approximation.","ICE","can","reduce","the","influence","of","ambiguous\nor","mislabeled","instances","to","improve","the","class-posterior","estimation.\nFinally,","we","need","to","design","a","transformation","fromptoqparameterized","by","the","confidence\nC.","We","denote","this","function","byh:","","∆\nK−1\n→∆\nK−1\n.","In","summary,q\nφ,θ\n(\n","̃\nY|X)takes","the\nfollowing","form:\nq\nφ,θ\n(\n","̃\nY|X)\n:\n=","Categorical(q=h(f(X;φ);g(X;θ))).(7)\nNext,","we","analyze","what","characteristicshneeds","to","have.","First,","we","suggest","thathneeds","not\nnecessarily","to","be","a","linear","transformation","because","the","transformation","is","instance-dependent\nand","any","function","that","mapsptoqas","close","as","possible","for","a","certain","instancexwould\nsuffice.","Second,","we","require","thatarg","max(p)","=arg","max(q),","i.e.,q=h(p;C)should","be","an\nargmax-preservingfunction","so","that","the","top-1","index","of","the","probability","vector","does","not","change.\nThis","is","becausehshould","only","affect","the","confidence","of","the","prediction,","not","the","final","decision.\nOtherwise,","ifhis","too","flexible","and","is","able","to","map","a","confident","prediction","to","a","different","confident\nprediction,","then","the","output","offcould","be","arbitrary,","and","consequently,","no","information","of","the\ntrue","label","can","be","learned","from","the","noisy","label","supervision.\nBased","on","this","motivation","and","the","aforementioned","semantics","ofC,","we","require","that\nh(p;","1)","=pandh(p;","0)","=u,","whereu∈∆\nK−1\nis","the","uniform","probability","vector","(u\ni\n=\n1\nK\n).\nThen,","when","the","confidenceCis","high,","the","classifier","gives","a","prediction","closer","to","the","original\nconfident","predictionp;","and","when","the","confidenceCis","low,","the","classifier","tends","to","give","arandom\nguessu.\nHere,","we","propose","two","functions","forhthat","satisfy","the","above","conditions:\nq\ni\n=Cp\ni\n+","(1−C)u\ni\n,(linear","interpolation)","","","","(8)\nq\ni\n=\np\nC\ni\n∑\nK\nj=1\np\nC\nj\n,(power","transformation)","","","","(9)\nfori=","1,...,K.","The","visualization","of","these","two","transformations","forK=","3is","given","in","Fig.","2.\n3.3","","Instance","embedding\nThe","last","piece","of","our","method","is","the","choice","ofg:X","→[0,1],","the","function","that","maps","the\ninstancexto","its","confidence","valueC.","It","is","also","possible","to","use","a","neural","network","to","approximate\nthis","function.","However,","because","we","usually","only","have","a","limited","number","of","training","examples\nandgcould","be","non-smooth","w.r.t.","its","inputx,gmay","not","be","well","approximated","by","a","neural\nnetwork","with","similar","complexity","to","the","classifierf,","which","is","illustrated","in","an","example","in\nFig.","3.","Further,gmay","be","rarely","needed","after","training","so","its","generalization","ability","is","not\nrequired","in","many","cases.\n5\n\nBased","on","these","facts,","we","propose","to","useinstance","embedding,","i.e.,","to","assign","a","trainable\nparameter","to","each","instancex.","In","other","words,","the","only","feature","for","an","instance","we","use","is","its\nindexin","the","training","dataset.","In","this","way,gis","expressive","and","flexible","but","cannot","be","used","for\npredicting","the","confidence","of","unseen","instances.","Accordingly,","for","a","training","dataset","of","sizeN,\nwe","needNparameters","for","a","one-dimensional","instance","embedding.\nThis","seems","to","be","a","high","additional","computational","cost","when","the","dataset","size","is","large,\nbut","it","is","often","acceptable,","because","(i)","in","modern","deep","learning,","it","is","common","to","use","over-\nparameterized","models","[Nakkiran","et","al.,","2019],","and","the","number","of","instances","is","usually","not\ncomparable","to","the","number","of","parameters","of","the","classifierf(e.g.,","CIFAR-10","[Krizhevsky,\n2009]:5×10\n4\n,","ResNet-18","[He","et","al.,","2016]:∼1×10\n7\n);","and","(ii)","the","gradient","of","the","instance\nembedding","is","sparse","and","only","a","small","subset","of","parameters","needs","to","be","updated","at","each\niteration.\nThe","idea","of","associating","an","entity","with","a","scalar","or","vector","embedding","using","a","simple\nlookup","table","with","a","fixed","dictionary","size","has","been","widely","used","in","natural","language","processing\n[Mikolov","et","al.,","2013,","Pennington","et","al.,","2014,","Peters","et","al.,","2018,","Devlin","et","al.,","2019]","due","to\nthe","discrete","nature","of","tokens,","and","can","be","seen","recently","in","contrastive","learning","[Wu","et","al.,\n2018,","He","et","al.,","2020]","for","vision","tasks.","Instance","embedding","enables","the","function","to","take","any\npossible","value","on","all","observed","instances","but","cannot","generalize","to","any","unseen","token","or","image.\n4","","Related","Work\nIn","this","section,","we","review","related","problem","settings","and","methods.\nClass-conditional","noise","(CCN).\nCompared","with","the","IDN","model,","the","instance-independent\nandclass-conditional","noise(CCN)","model","has","an","additional","assumption:p(\n","̃\nY|Y,X\n)","=p(\n","̃\nY|Y\n),\ni.e.,","the","noisy","label\n","̃\nY\nonly","depends","on","the","true","labelY.","CCN","has","been","well","studied","in\nboth","binary","[Angluin","and","Laird,","1988,","Long","and","Servedio,","2010,","Natarajan","et","al.,","2013,\nVan","Rooyen","et","al.,","2015,","Liu","and","Tao,","2015]","and","multiclass","[Patrini","et","al.,","2017,","Xia","et","al.,\n2019,","Yao","et","al.,","2020]","classification.","Also,robust","loss","functions[Ghosh","et","al.,","2017,","Zhang\nand","Sabuncu,","2018,","Wang","et","al.,","2019b,","Charoenphakdee","et","al.,","2019,","Ma","et","al.,","2020,","Feng\net","al.,","2020,","Lyu","and","Tsang,","2020,","Liu","and","Guo,","2020]","have","been","mainly","developed","under\nthe","CCN","setting.","In","practice,","CCN","methods","can","serve","as","practical","approximations","of","IDN\nbut","the","assumption","could","be","too","strong","to","fit","some","real-world","data","well","[Xiao","et","al.,","2015].\nConditionally","independent","labels","(IND).The","other","direction","is","to","assumep(\n","̃\nY|Y,X\n)","=\np(\n","̃\nY|X\n),","i.e.,Yand\n","̃\nY\nare","two","sets","of","independent","labels","conditioned","on","the","featureX.\nThis","dependence","structure","is","used","in","theinformation","bottleneckframework","[Tishby","et","al.,\n1999,","Tishby","and","Zaslavsky,","2015,","Alemi","et","al.,","2017,","Saxe","et","al.,","2018],","where","the","learning\nobjective","is","to","find","a","representationYthat","is","maximally","informative","about","the","observation\n","̃\nY\nbased","on","the","mutual","information.","This","framework","can","be","adapted","for","learning","from","noisy\nlabels","if","we","choose","a","categorical","representationY.","The","graphical","representations","of","IND","and\nCCN","are","given","in","Fig.","1.\nLabel","smoothing.Note","that","Eq.","(8)","is","similar","to","thelabel","smoothing(LS)","technique\n[Szegedy","et","al.,","2016,","Pereyra","et","al.,","2017,","Lukasik","et","al.,","2020],","where","the","empirical","distribution\nis","linearly","interpolated","with","a","uniform","distribution","with","a","fixed","mixing","parameter.","It","is","also\nrelated","to","the","soft/hardbootstrapping","loss[Reed","et","al.,","2015],","where","the","observed","label","is\nmixed","with","the","predicted","probability/predicted","label.","In","contrast,","in","our","method,","it","is","the\npredictionpthat","is","“smoothed”,","not","the","label.","We","elucidate","their","relations","and","differences","in\nAppendix","B.\n6\n\nTemperature","scaling.If","we","use","softmax","as","the","final","layer","of","the","neural","network","for\np\nφ\n(Y|X),","the","proposed","method","is","closely","related","to","thetemperature","scaling(TS)","technique\n[Guo","et","al.,","2017].","Concretely,","ifp\ni\n∝exp{f\ni\n(X;φ)}fori=","1,...,K,","then","Eq.","(9)","becomes\nq\ni\n∝exp{Cf\ni\n(X;φ)},(10)\nwhich","shows","thatCis","thereciprocal","of","the","temperature.","The","difference","is","that","the","parameter\nCis","instance-dependent","in","our","formulation,","rather","than","being","fixed","for","all","instances.","Also,\nTS","[Guo","et","al.,","2017]","and","its","extensions","[Kull","et","al.,","2019,","Rahimi","et","al.,","2020]","have","been\nmainly","used","as","post-hoc","confidence","calibration","methods,","while","our","method","is","used","during\ntraining.\nSample","selection.In","a","broader","sense,","the","proposed","method","belongs","to","a","category","of\nmethods","that","treat","training","examples","differently","in","order","to","reduce","the","harmful","effects","of\nmislabeled","instances.","Besides","the","class-posteriors","that","our","method","uses,","these","methods\nexploit","the","training","dynamics,","loss","characteristics,","gradient","information,","or","information","of\ndata","itself","from","various","perspectives.","Examples","includedata","cleansing[Liu","et","al.,","2008,\nNorthcutt","et","al.,","2019,","Hara","et","al.,","2019]","that","first","removes","harmful","instances","and","then\n(re-)trains","the","model","on","the","remaining","subset;dynamic","training","sample","selection[Malach","and\nShalev-Shwartz,","2017,","Jiang","et","al.,","2018,","Han","et","al.,","2018,","Wang","et","al.,","2018,","Yu","et","al.,","2019,\nMirzasoleiman","et","al.,","2020,","Wu","et","al.,","2020,","Chen","et","al.,","2021]","that","selects","training","examples\ndynamically","during","training;training","techniques[Menon","et","al.,","2020,","Liu","et","al.,","2020]","that","are\ndesigned","to","increase","robustness","and","avoid","memorization","of","noisy","labels;learning","with","rejection\norselective","classification[El-Yaniv","et","al.,","2010,","Thulasidasan","et","al.,","2019,","Mozannar","and\nSontag,","2020]","that","abstains","from","using","confusing","instances","while","improving","the","classification\nperformance","on","accepted","instances;","andsemi-supervised","learning[Nguyen","et","al.,","2020,","Li\net","al.,","2020]","that","exploits","unlabeled","data.\nIn","the","same","spirit,","our","proposed","method","also","attempts","to","detect","harmful","instances","and\nreduce","their","influences","automatically","so","as","to","improve","the","robustness","of","the","class-posterior\nestimation.","However,","unlike","explicit","sample","selection","methods,","the","resulting","algorithm","is\nlightweight","and","has","a","low","computational","cost.","Also,","because","the","proposed","method","only\naffects","the","class-posterior,","it","is","usually","compatible","with","other","training","methods.","Thus,","the\nproposed","method","can","be","used","alone","or","integrated","into","an","existing","training","pipeline","to","further\nimprove","the","performance.\n5","","Experiments\nIn","this","section,","we","experimentally","verify","if","the","proposedinstance-confidence","embedding(ICE)\nmethod","is","able","to","differentiate","mislabeled","instances","from","correct","ones","and","consequently\nimprove","the","classification","performance.","","We","also","demonstrate","that","there","already","exist\nambiguous","or","mislabeled","training","examples","in","the","original","datasets","which","can","be","detected\nby","the","proposed","method.","We","evaluated","on","both","image","classification","(Section","5.1)","and","text\nclassification","(Section","5.2).\n5.1","","Image","classification\nDatasets.\nWe","evaluated","our","method","on","six","image","classification","datasets,","namelyMNIST\n[LeCun","et","al.,","1998],","Fashion-MNIST","(FMNIST)","[Xiao","et","al.,","2017],","and","Kuzushiji-MNIST\n(KMNIST)","[Clanuwat","et","al.,","2018]","datasets,","which","contain28×28grayscale","images","in10\nclasses;","andSVHN[Netzer","et","al.,","2011],CIFAR-10,","andCIFAR-100[Krizhevsky,","2009]\ndatasets,","which","contain32×32colour","images","in10,10and100classes,","respectively.\nMethods.We","compared","the","following","eight","methods:","(1)","(CCE)","categorical","cross-entropy\nloss;","(2)","(Bootstrapping)","(hard)","bootstrapping","loss","[Reed","et","al.,","2015]","that","regularizes\n7\n\nTable","1:Accuracy(%)","on","the","MNIST,","FMNIST,","KMNIST,","SVHN,","CIFAR-10,","and","CIFAR-\n100","datasets","where50%of","labels","are","randomly","flipped.","“Mean","(standard","deviation)”","for\n10","trials","are","reported.","Outperforming","methods","are","highlighted","in","boldface","using","one-tailed\nt-tests","with","a","significance","level","of0.05.\nMNISTFMNISTKMNISTSVHNCIFAR-10","","","","CIFAR-100\nCCE94.91(0.43)85.05(0.52)80.40(1.25)71.50(1.68)68.34(0.82)47.09(0.65)\nBootstrapping97.30(0.28)87.24(0.36)84.21(1.01)76.62(0.97)75.97(0.45)49.56(0.42)\nAdaptation96.27(0.41)86.20(0.87)81.38(2.07)68.58(6.45)63.95(5.94)31.70(1.28)\nForward95.09(0.56)85.51(0.45)80.76(1.29)74.43(6.42)68.28(0.62)47.92(0.31)\nDAC96.60(0.47)86.87(0.48)82.77(0.74)80.97(4.83)71.55(0.34)47.01(0.44)\nGCE98.31(0.13)88.76(0.26)88.39(0.60)75.03(0.98)80.38(0.67)55.64(0.40)\nICE-LIN98.64(0.15)89.41(0.18)89.61(0.41)77.51(0.75)82.08(0.39)55.30(0.47)\nICE-POW98.60(0.09)89.29(0.20)89.21(0.53)79.91(0.96)82.14(0.44)54.31(0.48)\n0.00.20.40.60.81.0\nICE-LIN\nMNIST\n0.00.20.40.60.81.0\nFMNIST\n0.00.20.40.60.81.0\nKMNIST\n0.00.20.40.60.81.0\nSVHN\n0.00.20.40.60.81.0\nCIFAR-10\n0.00.20.40.60.81.0\nCIFAR-100\nFigure","4:Ridgeline","plotsof","the","confidenceCduring","training","(ICE-LIN).","The","density","is\nestimated","via","Gaussian","kernel","density","estimation","(KDE).","The","red/blue","curves","represent","the\nconfidence","of","instances","with","flipped/original","labels,","respectively.\nthe","output","with","the","predicted","label;","(3)","(Adaptation)","noise","adaptation","layer","[Goldberger\nand","Ben-Reuven,","2017]","that","estimates","a","fullK×Ktransition","matrix","for","each","instance;\n(4)","(Forward)","forward","correction","[Patrini","et","al.,","2017]","that","estimates","a","transition","matrix\nfor","all","instances;","(5)","(DAC)","deep","abstaining","classifier","[Thulasidasan","et","al.,","2019]","that\nuses","abstention","for","robust","learning;","(6)","(GCE)","generalized","cross-entropy","loss","[Zhang","and\nSabuncu,","2018]","as","a","robust","loss;","(7)","(ICE-LIN)","instance-confidence","embedding","with","the\nlinear","interpolation","(Eq.","(8));","and","(8)","(ICE-POW)","the","one","with","the","power","transformation\n(Eq.","(9)).","For","a","fair","comparison,","we","implemented","aforementioned","methods","using","the","same\nnetwork","architecture","and","hyperparameters.\nModels.For","MNIST,","FMNIST,","and","KMNIST,","we","used","a","sequential","convolutional","neural\nnetwork","(CNN)","and","an","Adam","optimizer","[Kingma","and","Ba,","2015].","For","SVHN,","CIFAR-10","and\nCIFAR-100,","we","used","a","residual","network","model","ResNet-18","[He","et","al.,","2016]","and","a","stochastic\ngradient","descent","(SGD)","optimizer","with","momentum","[Sutskever","et","al.,","2013].","Hyperparameters\nare","provided","in","Appendix","C.\nImproving","classification","performance.To","verify","if","the","proposed","method","is","able","to\nimprove","the","classification","performance","under","label","noise,","we","constructed","semi-synthetic","noisy\ndatasets","so","that","the","true","labels","are","known.","We","regarded","the","original","labels","as","clean","labels,\nalthough","as","will","be","shown","in","the","next","experiment,","label","errors","already","exist","in","the","original\ndatasets","to","some","extent.","Following","a","common","setup","[e.g.,","Reed","et","al.,","2015,","Patrini","et","al.,\n2017,","Thulasidasan","et","al.,","2019],","we","simply","flipped","a","fraction","of","labels","randomly","where","the\noverall","noise","rate","is50%,","i.e.,","half","of","instances","are","mislabeled.","We","ran10trials","and","reported\nthe","means","and","standard","deviations","of","the","test","accuracy","in","Table","1.\nWe","can","observe","that","the","proposed","method","generally","outperforms","the","baseline","methods.","It\nis","worth","noting","that","estimating","a","full","transition","matrix","for","each","instance","(Adaptation)","may\nimprove","the","accuracy","over","CCE","when","the","number","of","classes","is","relatively","small,","but","when\nthere","are","more","classes","(e.g.,","CIFAR-100),","the","performance","may","drop","drastically","because\nit","requires","an","additionalK×Koutput","and","the","estimation","error","could","be","high.","On","the\n8\n\nindex:","1374\nlabel:","5\nguess:","3\nindex:","39929\nlabel:","4\nguess:","9\nindex:","39957\nlabel:","4\nguess:","7\nindex:","28997\nlabel:","1\nguess:","2\nindex:","34829\nlabel:","9\nguess:","1\nindex:","9145\nlabel:","9\nguess:","4\nindex:","31290\nlabel:","2\nguess:","1\nindex:","45157\nlabel:","7\nguess:","2\nindex:","29145\nlabel:","5\nguess:","8\nindex:","22056\nlabel:","9\nguess:","0\nindex:","5636\nlabel:","1\nguess:","2\nindex:","45689\nlabel:","9\nguess:","7\nindex:","20624\nlabel:","6\nguess:","0\nindex:","36851\nlabel:","9\nguess:","4\nindex:","6123\nlabel:","3\nguess:","5\nindex:","5263\nlabel:","9\nguess:","0\nindex:","10503\nlabel:","4\nguess:","6\nindex:","23624\nlabel:","4\nguess:","0\nindex:","12460\nlabel:","3\nguess:","7\nindex:","39265\nlabel:","4\nguess:","9\nindex:","4626\nlabel:","9\nguess:","7\nindex:","6919\nlabel:","5\nguess:","2\nindex:","20973\nlabel:","3\nguess:","7\nindex:","18370\nlabel:","2\nguess:","7\nindex:","25507\nlabel:","7\nguess:","1\nindex:","39323\nlabel:","6\nguess:","0\nindex:","20727\nlabel:","9\nguess:","7\nindex:","34086\nlabel:","5\nguess:","6\nindex:","16101\nlabel:","8\nguess:","5\nindex:","47767\nlabel:","2\nguess:","7\nindex:","18348\nlabel:","1\nguess:","3\nindex:","30225\nlabel:","7\nguess:","2\n(a)","MNIST\nindex:","43934\nlabel:","shirt\nguess:","coat\nindex:","39396\nlabel:","shirt\nguess:","t-shirt\nindex:","46227\nlabel:","pullover\nguess:","shirt\nindex:","17688\nlabel:","shirt\nguess:","t-shirt\nindex:","7903\nlabel:","shirt\nguess:","pullover\nindex:","3137\nlabel:","pullover\nguess:","coat\nindex:","878\nlabel:","bag\nguess:","shirt\nindex:","23044\nlabel:","shirt\nguess:","pullover\nindex:","24233\nlabel:","shirt\nguess:","t-shirt\nindex:","28565\nlabel:","pullover\nguess:","t-shirt\nindex:","29519\nlabel:","shirt\nguess:","dress\nindex:","41117\nlabel:","t-shirt\nguess:","dress\nindex:","38933\nlabel:","shirt\nguess:","coat\nindex:","19378\nlabel:","pullover\nguess:","t-shirt\nindex:","36832\nlabel:","shirt\nguess:","pullover\nindex:","20316\nlabel:","t-shirt\nguess:","dress\nindex:","13825\nlabel:","shirt\nguess:","pullover\nindex:","40759\nlabel:","t-shirt\nguess:","pullover\nindex:","370\nlabel:","shirt\nguess:","dress\nindex:","26196\nlabel:","t-shirt\nguess:","dress\nindex:","28845\nlabel:","shirt\nguess:","dress\nindex:","11192\nlabel:","boot\nguess:","sneaker\nindex:","11606\nlabel:","coat\nguess:","dress\nindex:","2902\nlabel:","trouser\nguess:","dress\nindex:","43304\nlabel:","shirt\nguess:","pullover\nindex:","8504\nlabel:","shirt\nguess:","dress\nindex:","26596\nlabel:","pullover\nguess:","t-shirt\nindex:","7116\nlabel:","pullover\nguess:","t-shirt\nindex:","2791\nlabel:","pullover\nguess:","shirt\nindex:","27073\nlabel:","t-shirt\nguess:","dress\nindex:","44330\nlabel:","pullover\nguess:","shirt\nindex:","23402\nlabel:","shirt\nguess:","t-shirt\n(b)","FMNIST\nindex:","6273\nlabel:","5\nguess:","9\nindex:","29094\nlabel:","1\nguess:","9\nindex:","58171\nlabel:","4\nguess:","9\nindex:","24202\nlabel:","2\nguess:","9\nindex:","57472\nlabel:","9\nguess:","0\nindex:","12343\nlabel:","1\nguess:","0\nindex:","52238\nlabel:","4\nguess:","9\nindex:","11115\nlabel:","3\nguess:","8\nindex:","27459\nlabel:","7\nguess:","9\nindex:","15541\nlabel:","2\nguess:","8\nindex:","20055\nlabel:","4\nguess:","8\nindex:","20980\nlabel:","1\nguess:","0\nindex:","11966\nlabel:","1\nguess:","8\nindex:","40808\nlabel:","2\nguess:","0\nindex:","6951\nlabel:","1\nguess:","8\nindex:","18484\nlabel:","1\nguess:","5\nindex:","28696\nlabel:","9\nguess:","8\nindex:","56469\nlabel:","4\nguess:","8\nindex:","18068\nlabel:","1\nguess:","6\nindex:","41469\nlabel:","1\nguess:","0\nindex:","58099\nlabel:","1\nguess:","9\nindex:","23758\nlabel:","9\nguess:","0\nindex:","11728\nlabel:","4\nguess:","8\nindex:","57990\nlabel:","1\nguess:","7\nindex:","39784\nlabel:","3\nguess:","9\nindex:","25288\nlabel:","1\nguess:","8\nindex:","14526\nlabel:","1\nguess:","7\nindex:","16617\nlabel:","1\nguess:","5\nindex:","6818\nlabel:","3\nguess:","7\nindex:","42348\nlabel:","1\nguess:","0\nindex:","25576\nlabel:","9\nguess:","5\nindex:","38553\nlabel:","2\nguess:","0\n(c)","SVHN\nindex:","36477\nlabel:","truck\nguess:","ship\nindex:","23105\nlabel:","cat\nguess:","cat\nindex:","26412\nlabel:","bird\nguess:","dog\nindex:","23605\nlabel:","deer\nguess:","bird\nindex:","7338\nlabel:","dog\nguess:","deer\nindex:","12778\nlabel:","dog\nguess:","horse\nindex:","20297\nlabel:","cat\nguess:","frog\nindex:","28845\nlabel:","truck\nguess:","airplane\nindex:","25005\nlabel:","dog\nguess:","truck\nindex:","28965\nlabel:","cat\nguess:","deer\nindex:","31445\nlabel:","dog\nguess:","cat\nindex:","8534\nlabel:","bird\nguess:","cat\nindex:","33945\nlabel:","airplane\nguess:","automobile\nindex:","24139\nlabel:","dog\nguess:","deer\nindex:","23734\nlabel:","cat\nguess:","dog\nindex:","29703\nlabel:","deer\nguess:","dog\nindex:","33580\nlabel:","cat\nguess:","cat\nindex:","29864\nlabel:","cat\nguess:","dog\nindex:","19294\nlabel:","frog\nguess:","ship\nindex:","11827\nlabel:","dog\nguess:","deer\nindex:","29811\nlabel:","dog\nguess:","horse\nindex:","23738\nlabel:","dog\nguess:","ship\nindex:","36683\nlabel:","deer\nguess:","horse\nindex:","5617\nlabel:","bird\nguess:","dog\nindex:","20200\nlabel:","bird\nguess:","cat\nindex:","5573\nlabel:","truck\nguess:","dog\nindex:","26304\nlabel:","horse\nguess:","cat\nindex:","16873\nlabel:","cat\nguess:","deer\nindex:","36761\nlabel:","horse\nguess:","cat\nindex:","10363\nlabel:","truck\nguess:","bird\nindex:","2798\nlabel:","bird\nguess:","dog\nindex:","39440\nlabel:","bird\nguess:","frog\n(d)","CIFAR-10\nFigure","5:","The32mostlow-confidence","training","examplesin","the","MNIST,","FMNIST,\nSVHN","and","CIFAR-10","datasets,","ordered","left-right,","top-down","by","increasing","confidence.","The\nindex","in","the","dataset,","original","label,","and","predicted","label","are","annotated","above","each","image.\ncontrary,","the","complexity","of","our","single-parameter","approximation","does","not","increase","as","the\nnumber","of","classes","increases.","Additionally,","in","the","ridgeline","plots","in","Fig.","4,","we","can","observe","the\nseparation","of","instances","with","flipped/original","labels","using","the","learned","confidenceC,","which\nmay","explain","the","performance","improvement.\nDetecting","ambiguous/mislabeled","instances.Next,","we","demonstrate","that","the","proposed\nmethod","can","be","used","for","detecting","ambiguous","or","possibly","mislabeled","instances.","We","trained\nthe","model","on","the","original","datasets","with","the","proposed","method.","A","benefit","of","using","a","single-\nparameter","approximation","is","that","it","naturally","derives","an","order","of","the","training","examples.","We\nsorted","the","training","examples","via","the","confidence","and","showed","the32most","low-confidence","ones\nin","in","Fig.","5.","Results","of","other","datasets","are","provided","in","Appendix","C.\nWe","can","observe","that,","surprisingly,","in","these","supposedly","clean","datasets,","a","number","of","instance\nmight","be","mislabeled.","In","MNIST","and","SVHN,","we","found","clearly","mislabeled","images.","There\nare","ambiguous","images","such","as","2-7","and","4-9","pairs","in","MNIST","and","shirt/T-shirt/pullover/coat\nphotos","in","Fashion-MNIST.","In","CIFAR-10,","it","is","interesting","that","images","in","the","animal","category\nare","more","likely","to","have","a","low","confidence.","We","conjecture","that","thespurious","correlationbetween\nthe","object","and","the","background","color","plays","an","important","role.","We","also","found","multi-modality\nissues,","e.g.,","kiwi,","owl,","and","chicken","are","all","labeled","as","bird","but","are","notvisually","prototypical\nbirds.","This","phenomenon","suggests","the","possibility","of","using","the","proposed","method","for","diagnosing\nlabel","issues","in","large-scale","datasets.\n9\n\nTable","2:Performance(%)","on","the","GLUE","benchmark","for","natural","language","understanding.\nWe","reported","Matthews","correlation","coefficient","on","CoLA,","F1","score/accuracy","on","MRPC","and\nQQP,","and","accuracy","otherwise.","MNLI-(m/mm)","denotes","MultiNLI","matched/mismatched,\nrespectively.\nCoLA","","SST2MRPCQQPMNLI-(m/mm)","","QNLI","","","RTE","","","WNLI\nCCE54.7692.5588.04/82.3587.80/90.9683.83/84.3190.7766.4350.70\nICE57.8392.2089.54/85.0587.85/90.9283.81/84.3691.1463.9056.34\nTable","3:","Selectedlow-confidence","training","examplesin","the","CoLA","dataset.\nIndexLabelGuessText\n390acceptable","","","","unacceptableHe","I","often","sees","Mary.\n7756","","","","acceptable","","","","unacceptableThat","monkey","is","ate","the","banana.\n8332","","","","acceptable","","","","unacceptableI","wanted","Jimmy","for","to","come","with","me.\n2801","","","unacceptable","","","","acceptablePaula","hit","the","sticks.\n2479","","","unacceptable","","","","acceptableKelly","buttered","the","bread","with","butter.\n6795","","","unacceptable","","","","acceptableHenry","wanted","to","possibly","marry","Fanny.\n5.2","","Text","classification\nWe","discovered","that","noisy","label","issues","also","exist","in","text","datasets.","We","conducted","similar\nexperiments","on","the","GLUE","benchmark","[Wang","et","al.,","2019a],","which","is","a","collection","of","datasets\nfor","natural","language","understanding.","We","trained","a","BERT-base","model","pretrained","using","a\nmasked","language","modeling","(MLM)","objective","[Devlin","et","al.,","2019]","with","a","default","AdamW\noptimizer","[Loshchilov","and","Hutter,","2017].","The","performance","in","terms","of","the","suggested","evaluation\nmetric","was","reported","in","Table","2.\nWe","can","observe","that,","except","on","the","RTE","dataset,","the","performance","was","improved","or\napproximately","the","same","compared","with","the","default","CCE","method,","which","shows","the","benefits\nof","using","instance-specifically","adjusted","confidences.","Although,","if","the","dataset","is","relatively","clean,\nthe","improvement","might","be","marginal.\nWe","also","found","mislabeled","or","ambiguous","instances","in","these","datasets.","A","typical","example","is\nthe","Corpus","of","Linguistic","Acceptability","(CoLA)","[Warstadt","et","al.,","2019]","dataset,","which","consists\nof","English","grammatical","acceptability","judgments.","Six","selected","low-confidence","training","examples\nare","given","in","Table","3.","We","found","that","several","ungrammatical","sentences","were","mislabeled","as\nacceptable,","and","somesyntactically","acceptablesentences","were","labeled","as","unacceptable","by\nannotators","possibly","because","they","havesemantic","errors.","In","this","way,","we","may","use","the","proposed\nmethod","to","probe","if","the","model","prediction","is","consistent","with","our","intent.","More","results","are\nprovided","in","Appendix","C.\n6","","Conclusion\nWe","have","introduced","a","novel","variational","approximation","of","the","instance-dependent","noise\n(IDN)","model,","referred","to","asinstance-confidence","embedding(ICE).","Compared","with","existing\nmethods","based","on","the","class-conditional","noise","(CCN)","assumption,","the","proposed","method","is","able\nto","capture","instance-specific","noise","information","and","consequently","improve","the","classification\nperformance.","The","use","of","the","one-dimensional","instance","embedding","naturally","derives","an","order\nof","training","examples","which","can","be","used","for","detecting","ambiguous","or","mislabeled","instances.","For\nfuture","directions,","it","is","interesting","to","explore","its","combination","with","other","training","techniques\nand","its","extensions","in","data","cleansing,","learning","with","rejection,","or","active","learning.\n10\n\nAcknowledgement\nWe","thank","Gang","Niu,","Xi","Huang,","Nontawat","Charoenphakdee,","Han","Bao,","Masato","Ishii,","Yoshihiro\nNagano,","and","Shota","Nakajima","for","helpful","discussion.","","We","also","would","like","to","thank","the\nSupercomputing","Division,","Information","Technology","Center,","the","University","of","Tokyo,","for\nproviding","the","Reedbush","supercomputer","system.","YZ","was","supported","by","Microsoft","Research\nAsia","D-CORE","program","and","Junior","Research","Associate","(JRA)","program","at","RIKEN.","MS","was\nsupported","by","JST","AIP","Acceleration","Research","Grant","Number","JPMJCR20U3","and","the","Institute\nfor","AI","and","Beyond,","UTokyo,","Japan.\nReferences\nAlexander","A","Alemi,","Ian","Fischer,","Joshua","V","Dillon,","and","Kevin","Murphy.","Deep","variational\ninformation","bottleneck.","InInternational","Conference","on","Learning","Representations,","2017.","4\nDana","Angluin","and","Philip","Laird.","Learning","from","noisy","examples.Machine","Learning,","2(4):\n343–370,","1988.","1,","4\nDevansh","Arpit,","Stanisław","Jastrzębski,","Nicolas","Ballas,","David","Krueger,","Emmanuel","Bengio,\nMaxinder","S","Kanwal,","Tegan","Maharaj,","Asja","Fischer,","Aaron","Courville,","Yoshua","Bengio,","et","al.\nA","closer","look","at","memorization","in","deep","networks.","InProceedings","of","the","34th","International\nConference","on","Machine","Learning,","2017.","1\nNontawat","Charoenphakdee,","Jongyeong","Lee,","and","Masashi","Sugiyama.","On","symmetric","losses","for\nlearning","from","corrupted","labels.","InProceedings","of","the","36th","International","Conference","on\nMachine","Learning,","pages","961–970,","2019.","4\nPengfei","Chen,","Junjie","Ye,","Guangyong","Chen,","Jingwei","Zhao,","and","Pheng-Ann","Heng.","Beyond\nclass-conditional","assumption:","A","primary","attempt","to","combat","instance-dependent","label\nnoise.","InProceedings","of","the","Thirty-Fifth","AAAI","Conference","on","Artificial","Intelligence,","2021.\n1,","4\nJiacheng","Cheng,","Tongliang","Liu,","Kotagiri","Ramamohanarao,","and","Dacheng","Tao.","Learning","with\nbounded","instance-","and","label-dependent","label","noise.","InProceedings","of","the","37th","International\nConference","on","Machine","Learning,","pages","1789–1799,","2020.","1,","2.3\nTarin","Clanuwat,","Mikel","Bober-Irizar,","Asanobu","Kitamoto,","Alex","Lamb,","Kazuaki","Yamamoto,","and\nDavid","Ha.","Deep","learning","for","classical","japanese","literature.arXiv","preprint","arXiv:1812.01718,\n2018.","5.1,","3\nJacob","Devlin,","Ming-Wei","Chang,","Kenton","Lee,","and","Kristina","Toutanova.","BERT:","Pre-training\nof","deep","bidirectional","transformers","for","language","understanding.","","InProceedings","of","the\n2019","Conference","of","the","North","American","Chapter","of","the","Association","for","Computational\nLinguistics:","Human","Language","Technologies,","NAACL-HLT,","pages","4171–4186,","2019.","3.3,\n5.2,","C.2\nRan","El-Yaniv","et","al.","On","the","foundations","of","noise-free","selective","classification.Journal","of\nMachine","Learning","Research,","11(5),","2010.","4\nLei","Feng,","Senlin","Shu,","Zhuoyi","Lin,","Fengmao","Lv,","Li","Li,","and","Bo","An.","Can","cross","entropy","loss","be\nrobust","to","label","noise?","InProceedings","of","the","Twenty-Ninth","International","Joint","Conference\non","Artificial","Intelligence,","pages","2206–2212,","2020.","4\nRobert","Fergus,","Li","Fei-Fei,","Pietro","Perona,","and","Andrew","Zisserman.","Learning","object","categories\nfrom","Google’s","image","search.","InTenth","IEEE","International","Conference","on","Computer","Vision,\nvolume","2,","pages","1816–1823,","2005.","1,","2.3\n11\n\nAritra","Ghosh,","Himanshu","Kumar,","and","PS","Sastry.","Robust","loss","functions","under","label","noise","for\ndeep","neural","networks.","InProceedings","of","the","Thirty-First","AAAI","Conference","on","Artificial\nIntelligence,","pages","1919–1925,","2017.","4\nJacob","Goldberger","and","Ehud","Ben-Reuven.","Training","deep","neural-networks","using","a","noise\nadaptation","layer.","InInternational","Conference","on","Learning","Representations,","2017.","1,","2.3,\n3.2,","(3)\nChuan","Guo,","Geoff","Pleiss,","Yu","Sun,","and","Kilian","Q","Weinberger.","On","calibration","of","modern","neural\nnetworks.","InProceedings","of","the","34th","International","Conference","on","Machine","Learning,","pages\n1321–1330,","2017.","4,","4\nBo","Han,","Quanming","Yao,","Xingrui","Yu,","Gang","Niu,","Miao","Xu,","Weihua","Hu,","Ivor","Tsang,","and\nMasashi","Sugiyama.","Co-teaching:","Robust","training","of","deep","neural","networks","with","extremely\nnoisy","labels.","InAdvances","in","Neural","Information","Processing","Systems,","pages","8527–8537,\n2018.","4\nSatoshi","Hara,","Atsushi","Nitanda,","and","Takanori","Maehara.","Data","cleansing","for","models","trained\nwith","SGD.","InAdvances","in","Neural","Information","Processing","Systems,","pages","4215–4224,","2019.\n1,","4\nKaiming","He,","Xiangyu","Zhang,","Shaoqing","Ren,","and","Jian","Sun.","Deep","residual","learning","for\nimage","recognition.","InProceedings","of","the","IEEE","conference","on","computer","vision","and","pattern\nrecognition,","pages","770–778,","2016.","3.3,","5.1,","5\nKaiming","He,","Haoqi","Fan,","Yuxin","Wu,","Saining","Xie,","and","Ross","Girshick.","Momentum","contrast","for\nunsupervised","visual","representation","learning.","InProceedings","of","the","IEEE/CVF","Conference\non","Computer","Vision","and","Pattern","Recognition,","pages","9729–9738,","2020.","3.3\nLu","Jiang,","Zhengyuan","Zhou,","Thomas","Leung,","Li-Jia","Li,","and","Li","Fei-Fei.","MentorNet:","Learning\ndata-driven","curriculum","for","very","deep","neural","networks","on","corrupted","labels.","InProceedings\nof","the","35th","International","Conference","on","Machine","Learning,","pages","2304–2313,","2018.","4\nDiederik","P.","Kingma","and","Jimmy","Ba.","Adam:","A","method","for","stochastic","optimization.","In3rd\nInternational","Conference","on","Learning","Representations,","2015.","5.1,","5\nAlex","Krizhevsky.","Learning","multiple","layers","of","features","from","tiny","images,","2009.","3.3,","5.1,","5\nMeelis","Kull,","Miquel","Perello","Nieto,","Markus","Kängsepp,","Telmo","Silva","Filho,","Hao","Song,","and","Peter\nFlach.","Beyond","temperature","scaling:","Obtaining","well-calibrated","multi-class","probabilities","with\ndirichlet","calibration.Advances","in","neural","information","processing","systems,","32:12316–12326,\n2019.","4\nYann","LeCun,","Léon","Bottou,","Yoshua","Bengio,","and","Patrick","Haffner.","Gradient-based","learning\napplied","to","document","recognition,","1998.","5.1,","1\nJunnan","Li,","Richard","Socher,","and","Steven","C.H.","Hoi.","DivideMix:","Learning","with","noisy","labels","as\nsemi-supervised","learning.","InInternational","Conference","on","Learning","Representations,","2020.\n4\nFei","Tony","Liu,","Kai","Ming","Ting,","and","Zhi-Hua","Zhou.","Isolation","forest.","In2008","eighth","IEEE\ninternational","conference","on","data","mining,","pages","413–422.","IEEE,","2008.","4\nSheng","Liu,","Jonathan","Niles-Weed,","Narges","Razavian,","and","Carlos","Fernandez-Granda.","Early-\nlearning","regularization","prevents","memorization","of","noisy","labels.","InAdvances","in","Neural\nInformation","Processing","Systems,","pages","20331–20342,","2020.","1,","4\nTongliang","Liu","and","Dacheng","Tao.","Classification","with","noisy","labels","by","importance","reweighting.\nIEEE","Transactions","on","pattern","analysis","and","machine","intelligence,","38(3):447–461,","2015.","4\n12\n\nYang","Liu","and","Hongyi","Guo.","Peer","loss","functions:","Learning","from","noisy","labels","without","knowing\nnoise","rates.","InProceedings","of","the","37th","International","Conference","on","Machine","Learning,\npages","6226–6236,","2020.","4\nPhilip","M","Long","and","Rocco","A","Servedio.","Random","classification","noise","defeats","all","convex","potential\nboosters.Machine","learning,","78(3):287–304,","2010.","4\nIlya","Loshchilov","and","Frank","Hutter.","Decoupled","weight","decay","regularization.","InInternational\nConference","on","Learning","Representations,","2017.","5.2,","6\nMichal","Lukasik,","Srinadh","Bhojanapalli,","Aditya","Menon,","and","Sanjiv","Kumar.","","Does","label\nsmoothing","mitigate","label","noise?","InInternational","Conference","on","Machine","Learning,","pages\n6448–6458,","2020.","4,","B\nYueming","Lyu","and","Ivor","W.","Tsang.","Curriculum","loss:","Robust","learning","and","generalization\nagainst","label","corruption.","InInternational","Conference","on","Learning","Representations,","2020.\n4\nXingjun","Ma,","Hanxun","Huang,","Yisen","Wang,","Simone","Romano,","Sarah","Erfani,","and","James","Bailey.\nNormalized","loss","functions","for","deep","learning","with","noisy","labels.","InProceedings","of","the","37th\nInternational","Conference","on","Machine","Learning,","pages","6543–6553,","2020.","4\nEran","Malach","and","Shai","Shalev-Shwartz.","Decoupling","“when","to","update”","from","“how","to","update”.\nInAdvances","in","Neural","Information","Processing","Systems,","pages","960–970,","2017.","1,","4\nAditya","Krishna","Menon,","Brendan","Van","Rooyen,","and","Nagarajan","Natarajan.","Learning","from\nbinary","labels","with","instance-dependent","noise.Machine","Learning,","107(8-10):1561–1595,\n2018.","1,","2.3\nAditya","Krishna","Menon,","Ankit","Singh","Rawat,","Sashank","J","Reddi,","and","Sanjiv","Kumar.","Can","gradi-\nent","clipping","mitigate","label","noise?","InInternational","Conference","on","Learning","Representations,\n2020.","4\nTomas","Mikolov,","Kai","Chen,","Greg","Corrado,","and","Jeffrey","Dean.","Efficient","estimation","of","word\nrepresentations","in","vector","space.","InInternational","Conference","on","Learning","Representations,\nWorkshop","Track","Proceedings,","2013.","3.3\nBaharan","Mirzasoleiman,","Kaidi","Cao,","and","Jure","Leskovec.","Coresets","for","robust","training","of\ndeep","neural","networks","against","noisy","labels.","InAdvances","in","Neural","Information","Processing\nSystems,","2020.","1,","4\nHussein","Mozannar","and","David","Sontag.","Consistent","estimators","for","learning","to","defer","to","an\nexpert.","InInternational","Conference","on","Machine","Learning,","pages","7076–7087,","2020.","4\nPreetum","Nakkiran,","Gal","Kaplun,","Yamini","Bansal,","Tristan","Yang,","Boaz","Barak,","and","Ilya","Sutskever.\nDeep","double","descent:","Where","bigger","models","and","more","data","hurt.","InInternational","Conference\non","Learning","Representations,","2019.","3.3\nNagarajan","Natarajan,","Inderjit","S","Dhillon,","Pradeep","K","Ravikumar,","and","Ambuj","Tewari.","Learning\nwith","noisy","labels.","InAdvances","in","neural","information","processing","systems,","pages","1196–1204,\n2013.","1,","4\nYuval","Netzer,","Tao","Wang,","Adam","Coates,","Alessandro","Bissacco,","Bo","Wu,","and","Andrew","Y","Ng.\nReading","digits","in","natural","images","with","unsupervised","feature","learning,","2011.","5.1,","4\nDuc","Tam","Nguyen,","Chaithanya","Kumar","Mummadi,","Thi","Phuong","Nhung","Ngo,","Thi","Hoai","Phuong\nNguyen,","Laura","Beggel,","and","Thomas","Brox.","SELF:","Learning","to","filter","noisy","labels","with\nself-ensembling.","InInternational","Conference","on","Learning","Representations,","2020.","4\n13\n\nCurtis","G","Northcutt,","Lu","Jiang,","and","Isaac","L","Chuang.","","Confident","learning:","","Estimating\nuncertainty","in","dataset","labels.arXiv","preprint","arXiv:1911.00068,","2019.","4\nAdam","Paszke,","Sam","Gross,","Francisco","Massa,","Adam","Lerer,","James","Bradbury,","Gregory","Chanan,\nTrevor","Killeen,","Zeming","Lin,","Natalia","Gimelshein,","Luca","Antiga,","et","al.","","PyTorch:","An\nimperative","style,","high-performance","deep","learning","library.","InAdvances","in","neural","information\nprocessing","systems,","pages","8026–8037,","2019.","C.2\nGiorgio","Patrini,","Alessandro","Rozza,","Aditya","Krishna","Menon,","Richard","Nock,","and","Lizhen\nQu.","Making","deep","neural","networks","robust","to","label","noise:","A","loss","correction","approach.","In\nProceedings","of","the","IEEE","Conference","on","Computer","Vision","and","Pattern","Recognition,","pages\n1944–1952,","2017.","1,","2.2,","4,","(4),","5.1\nJeffrey","Pennington,","Richard","Socher,","and","Christopher","D","Manning.","GloVe:","Global","vectors\nfor","word","representation.","InProceedings","of","the","2014","conference","on","empirical","methods","in\nnatural","language","processing","(EMNLP),","pages","1532–1543,","2014.","3.3\nGabriel","Pereyra,","George","Tucker,","Jan","Chorowski,","Łukasz","Kaiser,","and","Geoffrey","Hinton.","Regu-\nlarizing","neural","networks","by","penalizing","confident","output","distributions.","In5th","International\nConference","on","Learning","Representations,","Workshop","Track","Proceedings,","2017.","4,","B\nMatthew","E","Peters,","Mark","Neumann,","Mohit","Iyyer,","Matt","Gardner,","Christopher","Clark,","Kenton\nLee,","and","Luke","Zettlemoyer.","Deep","contextualized","word","representations.","InProceedings","of\nthe","2018","Conference","of","the","North","American","Chapter","of","the","Association","for","Computational\nLinguistics:","Human","Language","Technologies,","NAACL-HLT,","2018.","3.3\nAmir","Rahimi,","Amirreza","Shaban,","Ching-An","Cheng,","Richard","Hartley,","and","Byron","Boots.","Intra\norder-preserving","functions","for","calibration","of","multi-class","neural","networks.","InAdvances","in\nNeural","Information","Processing","Systems,","2020.","4\nScott","E","Reed,","Honglak","Lee,","Dragomir","Anguelov,","Christian","Szegedy,","Dumitru","Erhan,","and\nAndrew","Rabinovich.","Training","deep","neural","networks","on","noisy","labels","with","bootstrapping.\nInInternational","Conference","on","Learning","Representations,","Workshop","Track","Proceedings,\n2015.","4,","(2),","5.1,","B\nOlga","Russakovsky,","Jia","Deng,","Hao","Su,","Jonathan","Krause,","Sanjeev","Satheesh,","Sean","Ma,","Zhiheng\nHuang,","Andrej","Karpathy,","Aditya","Khosla,","Michael","Bernstein,","et","al.","Imagenet","large","scale\nvisual","recognition","challenge.International","journal","of","computer","vision,","115(3):211–252,\n2015.","1\nAndrew","M","Saxe,","Yamini","Bansal,","Joel","Dapello,","Madhu","Advani,","Artemy","Kolchinsky,","Brendan","D\nTracey,","and","David","D","Cox.","On","the","information","bottleneck","theory","of","deep","learning.","In\nInternational","Conference","on","Learning","Representations,","2018.","4\nFlorian","Schroff,","Antonio","Criminisi,","and","Andrew","Zisserman.","Harvesting","image","databases","from\nthe","web.IEEE","transactions","on","pattern","analysis","and","machine","intelligence,","33(4):754–766,\n2010.","1\nIlya","Sutskever,","James","Martens,","George","Dahl,","and","Geoffrey","Hinton.","On","the","importance","of\ninitialization","and","momentum","in","deep","learning.","InInternational","conference","on","machine\nlearning,","pages","1139–1147,","2013.","5.1\nChristian","Szegedy,","Vincent","Vanhoucke,","Sergey","Ioffe,","Jon","Shlens,","and","Zbigniew","Wojna.\nRethinking","the","inception","architecture","for","computer","vision.","InProceedings","of","the","IEEE\nconference","on","computer","vision","and","pattern","recognition,","pages","2818–2826,","2016.","4,","B\nSunil","Thulasidasan,","Tanmoy","Bhattacharya,","Jeff","Bilmes,","Gopinath","Chennupati,","and","Jamal\nMohd-Yusof.","Combating","label","noise","in","deep","learning","using","abstention.","InInternational\nConference","on","Machine","Learning,","pages","6234–6243,","2019.","1,","4,","(5),","5.1\n14\n\nNaftali","Tishby","and","Noga","Zaslavsky.","Deep","learning","and","the","information","bottleneck","principle.\nIn2015","IEEE","Information","Theory","Workshop","(ITW),","pages","1–5.","IEEE,","2015.","4\nNaftali","Tishby,","Fernando","C","Pereira,","and","William","Bialek.","The","information","bottleneck","method.\nInProc.","37th","Annual","Allerton","Conference","on","Communications,","Control","and","Computing,\n1999,","pages","368–377,","1999.","4\nBrendan","Van","Rooyen,","Aditya","Menon,","and","Robert","C","Williamson.","Learning","with","symmetric\nlabel","noise:","The","importance","of","being","unhinged.","","InAdvances","in","Neural","Information\nProcessing","Systems,","pages","10–18,","2015.","4\nAlex","Wang,","Amanpreet","Singh,","Julian","Michael,","Felix","Hill,","Omer","Levy,","and","Samuel","R","Bowman.\nGLUE:","A","multi-task","benchmark","and","analysis","platform","for","natural","language","understanding.\nInInternational","Conference","on","Learning","Representations,","2019a.","1,","5.2\nYisen","Wang,","Weiyang","Liu,","Xingjun","Ma,","James","Bailey,","Hongyuan","Zha,","Le","Song,","and","Shu-Tao\nXia.","Iterative","learning","with","open-set","noisy","labels.","InProceedings","of","the","IEEE","Conference\non","Computer","Vision","and","Pattern","Recognition,","pages","8688–8696,","2018.","4\nYisen","Wang,","Xingjun","Ma,","Zaiyi","Chen,","Yuan","Luo,","Jinfeng","Yi,","and","James","Bailey.","Symmetric\ncross","entropy","for","robust","learning","with","noisy","labels.","InProceedings","of","the","IEEE","International\nConference","on","Computer","Vision,","pages","322–330,","2019b.","4\nAlex","Warstadt,","Amanpreet","Singh,","and","Samuel","R","Bowman.","Neural","network","acceptability\njudgments.Transactions","of","the","Association","for","Computational","Linguistics,","7:625–641,\n2019.","5.2\nThomas","Wolf,","Lysandre","Debut,","Victor","Sanh,","Julien","Chaumond,","Clement","Delangue,","Anthony\nMoi,","Pierric","Cistac,","Tim","Rault,","Rémi","Louf,","Morgan","Funtowicz,","Joe","Davison,","Sam","Shleifer,\nPatrick","von","Platen,","Clara","Ma,","Yacine","Jernite,","Julien","Plu,","Canwen","Xu,","Teven","Le","Scao,\nSylvain","Gugger,","Mariama","Drame,","Quentin","Lhoest,","and","Alexander","M.","Rush.","Transformers:\nState-of-the-art","natural","language","processing.","InProceedings","of","the","2020","Conference","on\nEmpirical","Methods","in","Natural","Language","Processing:","System","Demonstrations,","2020.","C.2\nPengxiang","Wu,","Songzhu","Zheng,","Mayank","Goswami,","Dimitris","Metaxas,","and","Chao","Chen.\nA","topological","filter","for","learning","with","label","noise.","InAdvances","in","Neural","Information\nProcessing","Systems,","2020.","4\nZhirong","Wu,","Yuanjun","Xiong,","Stella","X","Yu,","and","Dahua","Lin.","Unsupervised","feature","learning\nvia","non-parametric","instance","discrimination.","InProceedings","of","the","IEEE","Conference","on\nComputer","Vision","and","Pattern","Recognition,","pages","3733–3742,","2018.","3.3\nXiaobo","Xia,","Tongliang","Liu,","Nannan","Wang,","Bo","Han,","Chen","Gong,","Gang","Niu,","and","Masashi\nSugiyama.","Are","anchor","points","really","indispensable","in","label-noise","learning?","InAdvances","in\nNeural","Information","Processing","Systems,","pages","6838–6849,","2019.","4\nXiaobo","Xia,","Tongliang","Liu,","Bo","Han,","Nannan","Wang,","Mingming","Gong,","Haifeng","Liu,","Gang\nNiu,","Dacheng","Tao,","and","Masashi","Sugiyama.","Part-dependent","label","noise:","Towards","instance-\ndependent","label","noise.","InAdvances","in","Neural","Information","Processing","Systems,","2020.","1,\n2.3\nHan","Xiao,","Kashif","Rasul,","and","Roland","Vollgraf.","Fashion-MNIST:","A","novel","image","dataset","for\nbenchmarking","machine","learning","algorithms.arXiv","preprint","arXiv:1708.07747,","2017.","5.1,","2\nTong","Xiao,","Tian","Xia,","Yi","Yang,","Chang","Huang,","and","Xiaogang","Wang.","Learning","from","massive\nnoisy","labeled","data","for","image","classification.","InProceedings","of","the","IEEE","conference","on\ncomputer","vision","and","pattern","recognition,","pages","2691–2699,","2015.","1,","2.3,","4\n15\n\nYu","Yao,","Tongliang","Liu,","Bo","Han,","Mingming","Gong,","Jiankang","Deng,","Gang","Niu,","and","Masashi\nSugiyama.","Dual","T:","Reducing","estimation","error","for","transition","matrix","in","label-noise","learning.\nInAdvances","in","Neural","Information","Processing","Systems,","pages","7260–7271,","2020.","4\nXingrui","Yu,","Bo","Han,","Jiangchao","Yao,","Gang","Niu,","Ivor","Tsang,","and","Masashi","Sugiyama.","How\ndoes","disagreement","help","generalization","against","label","corruption?","InProceedings","of","the","36th\nInternational","Conference","on","Machine","Learning,","pages","7164–7173,","2019.","4\nChiyuan","Zhang,","Samy","Bengio,","Moritz","Hardt,","Benjamin","Recht,","and","Oriol","Vinyals.","Under-\nstanding","deep","learning","requires","rethinking","generalization.","InInternational","Conference","on\nLearning","Representations,","2017.","1\nHongyi","Zhang,","Moustapha","Cissé,","Yann","N.","Dauphin,","and","David","Lopez-Paz.","mixup:","Beyond\nempirical","risk","minimization.","InInternational","Conference","on","Learning","Representations,\n2018.","B\nZhilu","Zhang","and","Mert","Sabuncu.","Generalized","cross","entropy","loss","for","training","deep","neural\nnetworks","with","noisy","labels.","InAdvances","in","neural","information","processing","systems,","pages\n8778–8788,","2018.","4,","(6)\n16\n\n0.00.20.40.60.81.0\nC\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\np\nK=","2\n0.00.20.40.60.81.0\nC\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\np\nK=","3\n0.00.20.40.60.81.0\nC\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\np\nK=","5\n0.00.20.40.60.81.0\nC\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\np\nK=","7\n0.00.20.40.60.81.0\nC\n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\np\nK=","10\nFigure","6:","Contours","of","the","log-likelihood","w.r.t.p\ni\nandCusing","the","linear","interpolation","(Eq.","(8))","forKin{2,3,5,7,10}.\nICE-LIN\nC=","0.1C=","0.3C=","0.5C=","0.7C=","0.9\nICE-POW\nFigure","7:","Contours","of","the","log-likelihood","on","the","simplex","whenK=","3using","the","linear","interpolation","(Eq.","(8),","top)","and","the\npower","transformation","(Eq.","(9),","bottom)","forCin{0.1,0.3,0.5,0.7,0.9}.\nA","","Gradient","analysis\nIn","this","section,","we","provide","a","basic","gradient","analysis","and","visualization","for","our","proposed","method.\nThe","gradients","of","the","log-likelihood","using","Eqs.","(8)","and","(9)","are\n∂\n∂C\nlog(q\ni\n)","=\np\ni\n−\n1\nK\nCp\ni\n+","(1−C)\n1\nK\n,(linear","interpolation)(11)\n∂\n∂C\nlog(q\ni\n)","=\nK\n∑\nj=1\np\nC\nj\nlog\np\ni\np\nj\n,(power","transformation)(12)\nrespectively.","Their","sign","boundaries","arep\ni\n=\n1\nK\nandp\ni\n=e\n−H(q,p)\n,","respectively,","whereH(·,·)denotes","the","cross-entropy.\nWe","can","find","that","for","the","linear","interpolation","(Eq.","(8)),","whenp\n","̃y\n<\n1\nK\n,\n∂L\n∂C\n<0and","whenp\n","̃y\n>\n1\nK\n,\n∂L\n∂C\n>0.","Similarly,","for\nthe","power","transformation","(Eq.","(9)),","whenp\n","̃y\n<","e\n−H(q,p)\n,\n∂L\n∂C\n<0and","whenp\n","̃y\n>","e\n−H(q,p)\n,\n∂L\n∂C\n>0.\nThe","contours","of","the","likelihood","for","different","parameters","are","plotted","in","Figs.","6","and","7.","Note","that","the","class-posterior\npis","obtained","from","a","neural","network,","so","it","can","be","influenced","by","other","instances,","especially","adjacent","instances.","On","the\nother","hand,","the","confidenceCis","obtained","via","instance","embedding,","so","it","can","take","any","value","independently.","If","the","predicted\nclass-posteriorp\n","̃y\nfor","an","instancexis","low","(e.g.,","because","this","instance","is","mislabeled","and","the","majority","of","adjacent","instances\nare","predicted","to","belong","to","other","classes),","then","the","classifier","tends","to","decrease","its","confidence","value","so","as","not","to","overfit\nthis","possibly","mislabeled","instance.","The","gradient","magnitude","is","the","largest","whenCis","high","andp\n","̃y\nis","low","(confident","wrong\nprediction),","the","smallest","when","bothCandp\n","̃y\nare","high","(confident","correct","prediction),","and","in","the","middle","whenCis","low\n(uncertain","prediction","like","a","random","guess).","In","this","way,","we","can","equip","the","neural","network","model","with","an","option","of","changing\nthe","confidence","of","prediction","for","individual","training","examples","to","mitigate","overfitting","possibly","mislabeled","instances.\n17\n\ny\np\nu\n̂y\nLS\nSB\nHB\nICE\nCCE:D\nKL\n(y‖p)\nLS:D\nKL\n(Cy+","(1−C)u‖p)\nSB:D\nKL\n(Cy+","(1−C)p‖p)\nHB:D\nKL\n(Cy+","(1−C)\n̂\ny‖p)\nICE:D\nKL\n(y‖Cp+","(1−C)u)\nFigure","8:","Illustration","of","related","methods,","including","the","categorical","cross-entropy","(CCE),","label","smoothing","(LS),","soft/hard\nbootstrapping","loss","(SB/HB),","and","the","proposed","instance-confidence","embedding","(ICE)","with","the","linear","transformation\n(Eq.","(8)).\nB","","Linear","interpolation\nLinear","interpolation","between","some","properties","of","an","instance","and","other","value","is","a","widely","used","technique","for","regularization\nin","machine","learning,","such","as","the","bootstrapping","loss","Reed","et","al.","[2015]","and","the","label","smoothing","technique","[Szegedy","et","al.,\n2016,","Pereyra","et","al.,","2017,","Lukasik","et","al.,","2020].","In","this","section,","we","briefly","summarize","related","techniques","and","compare","their\ndifferences.\nConcretely,","letpbe","the","predicted","probability","vector","forY(Eq.","(1)),ybe","the","one-hot","vector","for","the","observed","label,\n̂\ny=arg","maxpis","the","one-hot","vector","for","the","predicted","label,ube","the","uniform","probability","vector","(u\ni\n=\n1\nK\nfori∈{1,...,K}).\nHere,p,y,\n̂\ny,u∈∆\nK−1\nare","all","in","the","probability","simplex.","LetC∈[0,1]be","a","scalar","linear","interpolation","parameter.\nThen,","as","also","shown","in","Fig.","8,","the","learning","objectives","are","equivalent","to","the","following","KL-divergences:\nD\nKL\n(y‖p),(categorical","cross-entropy)(13)\nD\nKL\n(Cy+","(1−C)u‖p),(label","smoothing)(14)\nD\nKL\n(Cy+","(1−C)p‖p),(soft","bootstrapping","loss)(15)\nD\nKL\n(Cy+","(1−C)\n̂\ny‖p),(hard","bootstrapping","loss)(16)\nD\nKL\n(y‖Cp+","(1−C)u).(instance-confidence","embedding)(17)\nWe","can","see","that","the","label","smoothing","and","the","bootstrapping","loss","methods","smooth","the","target,","but","the","proposed","ICE","method\nsmooths","the","prediction.","Note","that","it","is","impossible","to","letCbe","an","instance-dependent","parameter","in","other","methods,","because\nwhenC=","0,","the","supervision","signalYcan","be","completely","lost.\nAnother","technique","using","linear","interpolation","ismixup[Zhang","et","al.,","2018],","which","also","interpolates","the","input","featuresX\nbetween","two","instances.","Therefore","its","characteristics","could","be","more","different","than","the","methods","mentioned","above.\n18\n\n0.00.20.40.60.81.0\nICE-LIN\nMNIST\n0.00.20.40.60.81.0\nFMNIST\n0.00.20.40.60.81.0\nKMNIST\n0.00.20.40.60.81.0\nSVHN\n0.00.20.40.60.81.0\nCIFAR-10\n0.00.20.40.60.81.0\nCIFAR-100\n0.00.20.40.60.81.0\nICE-POW\n","\n0.00.20.40.60.81.0\n","\n0.00.20.40.60.81.0\n","\n0.00.20.40.60.81.0\n","\n0.00.20.40.60.81.0\n","\n0.00.20.40.60.81.0\n","\nFigure","9:Ridgeline","plotsof","the","confidenceCduring","training.","The","density","is","estimated","via","Gaussian","kernel","density\nestimation","(KDE).","The","red/blue","curves","represent","the","confidence","of","instances","with","flipped/original","labels,","respectively.\nC","","Experiments\nC.1","","Image","classification\nData.\nWe","used","the","MNIST,\n1\nFashion-MNIST,\n2\nKuzushiji-MNIST,\n3\nSVHN,\n4\nCIFAR-10,","and","CIFAR-100\n5\ndatasets.","The\nMNIST,","Fashion-MNIST,","Kuzushiji-MNIST","datasets","contain28×28grayscale","images","in10classes.","The","size","of","the","training\nset","is60000and","the","size","of","the","test","set","is10000.","The","SVHN","dataset","contains32×32colour","images","in10classes.","The","size\nof","the","training","set","is73257and","the","size","of","the","test","set","is26032.","The","CIFAR-10","and","CIFAR-100","datasets","contain32×32\ncolour","images","in10classes","and","in100classes,","respectively.","The","size","of","the","training","set","is50000and","the","size","of","the","test","set\nis10000.","We","used20%of","the","training","sets","for","validation.","We","added","synthetic","label","noise","into","the","training","and","validation\nsets.","The","test","sets","were","not","modified.\nModels.\nFor","MNIST,","Fashion-MNIST,","and","Kuzushiji-MNIST,","we","used","a","sequential","convolutional","neural","network\nwith","the","following","structure:Conv2d(channel=32)×2,Conv2d(channel=64)×2,MaxPool2d(size=2),Linear(dim=128),\nDropout(p=0.5),Linear(dim=10).","The","kernel","size","of","convolutional","layers","is3,","and","rectified","linear","unit","(ReLU)","is","applied\nafter","the","convolutional","layers","and","linear","layers","except","the","last","one.","For","SVHN,","CIFAR-10","and","CIFAR-100,","we","used","a\nResNet-18","model","[He","et","al.,","2016].","To","ensure","thatC∈[0,1],","we","simply","apply","the","sigmoid","function","that","mapsRto[0,1]to\nthe","embedding.\nOptimization.For","MNIST,","Fashion-MNIST,","and","Kuzushiji-MNIST,","we","used","an","Adam","optimizer","[Kingma","and","Ba,","2015]\nwith","batch","size","of512and","learning","rate","of1×10\n−3\n.","The","model","was","trained","for2000iterations","(17.07epochs)","and","the\nlearning","rate","decayed","exponentially","to1×10\n−4\n.","For","CIFAR-10","and","CIFAR-100,","we","used","a","stochastic","gradient","descent\n(SGD)","optimizer","with","batch","size","of512,","momentum","of0.9,","and","weight","decay","of1×10\n−4\n.","The","learning","rate","increased","from\n0to0.1linearly","for400iterations","and","decreased","to0linearly","for3600iterations","(4000iterations/40.96epochs","in","total).\nFor","SVHN,","the","setting","was","the","same","as","CIFAR-10","except","the","model","was","trained","for1000iterations.\nResults.The","ridgeline","plots","of","the","confidenceCduring","training","are","given","in","Fig.","9.","Low-confidence","training","examples\nare","given","in","Figs.","10","and","11,","which","are","partially","presented","in","Fig.","5.\n1\nMNIST","[LeCun","et","al.,","1998]http://yann.lecun.com/exdb/mnist/\n2\nFashion-MNIST","[Xiao","et","al.,","2017]https://github.com/zalandoresearch/fashion-mnist\n3\nKuzushiji-MNIST","[Clanuwat","et","al.,","2018]http://codh.rois.ac.jp/kmnist/\n4\nSVHN","[Netzer","et","al.,","2011]http://ufldl.stanford.edu/housenumbers\n5\nCIFAR-10,","CIFAR-100","[Krizhevsky,","2009]https://www.cs.toronto.edu/~kriz/cifar.html\n19\n\nC.2","","Text","classification\nWe","implemented","the","BERT-base","model","[Devlin","et","al.,","2019]","using","PyTorch","[Paszke","et","al.,","2019]","and","HuggingFace’s\ntransformers[Wolf","et","al.,","2020]","libraries.","We","used","a","pretrained","model\n6\nand","an","AdamW","optimizer","[Loshchilov","and","Hutter,\n2017].","The","batch","size","was32and","the","weight","decay","was0.01,","otherwise","we","used","the","default","hyperparameters.","The","model\nwas","trained","on4NVIDIA","Tesla","P100","GPUs","in","parallel","with","the","mixed","precision","training","option","(fp16)","enabled.","For","the\nCoLA,","MRPC,","RTE,","and","WNLI","datasets,","the","model","was","trained","for5epochs","and","otherwise3epochs.","Low-confidence\ntraining","examples","are","given","in","Tables","4","to","11.\n6\nbert-base-cased:https://huggingface.co/bert-base-cased\n20\n\nindex:","12730\nlabel:","1\nguess:","2\nindex:","14108\nlabel:","4\nguess:","7\nindex:","41172\nlabel:","2\nguess:","7\nindex:","30267\nlabel:","3\nguess:","5\nindex:","29703\nlabel:","5\nguess:","3\nindex:","23615\nlabel:","5\nguess:","8\nindex:","39485\nlabel:","8\nguess:","9\nindex:","29613\nlabel:","7\nguess:","1\nindex:","34727\nlabel:","4\nguess:","9\nindex:","47930\nlabel:","9\nguess:","1\nindex:","17258\nlabel:","3\nguess:","7\nindex:","37078\nlabel:","9\nguess:","7\nindex:","47468\nlabel:","9\nguess:","0\nindex:","15631\nlabel:","5\nguess:","0\nindex:","15758\nlabel:","9\nguess:","4\nindex:","9603\nlabel:","6\nguess:","4\nindex:","22374\nlabel:","7\nguess:","2\nindex:","32953\nlabel:","6\nguess:","0\nindex:","26211\nlabel:","3\nguess:","7\nindex:","25576\nlabel:","4\nguess:","0\nindex:","29762\nlabel:","3\nguess:","9\nindex:","16757\nlabel:","1\nguess:","2\nindex:","25611\nlabel:","6\nguess:","0\nindex:","22950\nlabel:","1\nguess:","2\nindex:","46939\nlabel:","9\nguess:","4\nindex:","25444\nlabel:","9\nguess:","5\nindex:","9536\nlabel:","3\nguess:","8\nindex:","8738\nlabel:","7\nguess:","2\nindex:","45710\nlabel:","9\nguess:","5\nindex:","30516\nlabel:","2\nguess:","1\nindex:","9814\nlabel:","8\nguess:","9\nindex:","42674\nlabel:","4\nguess:","1\n(a)","MNIST","(ICE-LIN)\nindex:","1374\nlabel:","5\nguess:","3\nindex:","39929\nlabel:","4\nguess:","9\nindex:","39957\nlabel:","4\nguess:","7\nindex:","28997\nlabel:","1\nguess:","2\nindex:","34829\nlabel:","9\nguess:","1\nindex:","9145\nlabel:","9\nguess:","4\nindex:","31290\nlabel:","2\nguess:","1\nindex:","45157\nlabel:","7\nguess:","2\nindex:","29145\nlabel:","5\nguess:","8\nindex:","22056\nlabel:","9\nguess:","0\nindex:","5636\nlabel:","1\nguess:","2\nindex:","45689\nlabel:","9\nguess:","7\nindex:","20624\nlabel:","6\nguess:","0\nindex:","36851\nlabel:","9\nguess:","4\nindex:","6123\nlabel:","3\nguess:","5\nindex:","5263\nlabel:","9\nguess:","0\nindex:","10503\nlabel:","4\nguess:","6\nindex:","23624\nlabel:","4\nguess:","0\nindex:","12460\nlabel:","3\nguess:","7\nindex:","39265\nlabel:","4\nguess:","9\nindex:","4626\nlabel:","9\nguess:","7\nindex:","6919\nlabel:","5\nguess:","2\nindex:","20973\nlabel:","3\nguess:","7\nindex:","18370\nlabel:","2\nguess:","7\nindex:","25507\nlabel:","7\nguess:","1\nindex:","39323\nlabel:","6\nguess:","0\nindex:","20727\nlabel:","9\nguess:","7\nindex:","34086\nlabel:","5\nguess:","6\nindex:","16101\nlabel:","8\nguess:","5\nindex:","47767\nlabel:","2\nguess:","7\nindex:","18348\nlabel:","1\nguess:","3\nindex:","30225\nlabel:","7\nguess:","2\n(b)","MNIST","(ICE-POW)\nindex:","34258\nlabel:","shirt\nguess:","t-shirt\nindex:","19645\nlabel:","coat\nguess:","shirt\nindex:","34282\nlabel:","shirt\nguess:","dress\nindex:","42118\nlabel:","shirt\nguess:","t-shirt\nindex:","18802\nlabel:","shirt\nguess:","coat\nindex:","30291\nlabel:","pullover\nguess:","coat\nindex:","27318\nlabel:","shirt\nguess:","dress\nindex:","46388\nlabel:","t-shirt\nguess:","dress\nindex:","8992\nlabel:","pullover\nguess:","coat\nindex:","47305\nlabel:","t-shirt\nguess:","dress\nindex:","38470\nlabel:","shirt\nguess:","pullover\nindex:","39350\nlabel:","pullover\nguess:","coat\nindex:","41352\nlabel:","pullover\nguess:","dress\nindex:","10911\nlabel:","shirt\nguess:","dress\nindex:","2568\nlabel:","boot\nguess:","sneaker\nindex:","13056\nlabel:","sneaker\nguess:","boot\nindex:","15266\nlabel:","shirt\nguess:","pullover\nindex:","14862\nlabel:","pullover\nguess:","t-shirt\nindex:","18601\nlabel:","t-shirt\nguess:","dress\nindex:","33630\nlabel:","pullover\nguess:","t-shirt\nindex:","43110\nlabel:","sneaker\nguess:","boot\nindex:","5736\nlabel:","pullover\nguess:","t-shirt\nindex:","468\nlabel:","t-shirt\nguess:","dress\nindex:","44392\nlabel:","dress\nguess:","shirt\nindex:","28176\nlabel:","trouser\nguess:","dress\nindex:","12853\nlabel:","shirt\nguess:","dress\nindex:","23198\nlabel:","coat\nguess:","trouser\nindex:","21098\nlabel:","trouser\nguess:","dress\nindex:","27493\nlabel:","pullover\nguess:","dress\nindex:","9759\nlabel:","t-shirt\nguess:","pullover\nindex:","19792\nlabel:","pullover\nguess:","shirt\nindex:","29294\nlabel:","t-shirt\nguess:","dress\n(c)","FMNIST","(ICE-LIN)\nindex:","43934\nlabel:","shirt\nguess:","coat\nindex:","39396\nlabel:","shirt\nguess:","t-shirt\nindex:","46227\nlabel:","pullover\nguess:","shirt\nindex:","17688\nlabel:","shirt\nguess:","t-shirt\nindex:","7903\nlabel:","shirt\nguess:","pullover\nindex:","3137\nlabel:","pullover\nguess:","coat\nindex:","878\nlabel:","bag\nguess:","shirt\nindex:","23044\nlabel:","shirt\nguess:","pullover\nindex:","24233\nlabel:","shirt\nguess:","t-shirt\nindex:","28565\nlabel:","pullover\nguess:","t-shirt\nindex:","29519\nlabel:","shirt\nguess:","dress\nindex:","41117\nlabel:","t-shirt\nguess:","dress\nindex:","38933\nlabel:","shirt\nguess:","coat\nindex:","19378\nlabel:","pullover\nguess:","t-shirt\nindex:","36832\nlabel:","shirt\nguess:","pullover\nindex:","20316\nlabel:","t-shirt\nguess:","dress\nindex:","13825\nlabel:","shirt\nguess:","pullover\nindex:","40759\nlabel:","t-shirt\nguess:","pullover\nindex:","370\nlabel:","shirt\nguess:","dress\nindex:","26196\nlabel:","t-shirt\nguess:","dress\nindex:","28845\nlabel:","shirt\nguess:","dress\nindex:","11192\nlabel:","boot\nguess:","sneaker\nindex:","11606\nlabel:","coat\nguess:","dress\nindex:","2902\nlabel:","trouser\nguess:","dress\nindex:","43304\nlabel:","shirt\nguess:","pullover\nindex:","8504\nlabel:","shirt\nguess:","dress\nindex:","26596\nlabel:","pullover\nguess:","t-shirt\nindex:","7116\nlabel:","pullover\nguess:","t-shirt\nindex:","2791\nlabel:","pullover\nguess:","shirt\nindex:","27073\nlabel:","t-shirt\nguess:","dress\nindex:","44330\nlabel:","pullover\nguess:","shirt\nindex:","23402\nlabel:","shirt\nguess:","t-shirt\n(d)","FMNIST","(ICE-POW)\nindex:","26823\nlabel:","re\nguess:","tsu\nindex:","35081\nlabel:","wo\nguess:","o\nindex:","7902\nlabel:","tsu\nguess:","na\nindex:","44568\nlabel:","su\nguess:","ma\nindex:","37971\nlabel:","na\nguess:","o\nindex:","17674\nlabel:","ma\nguess:","re\nindex:","30234\nlabel:","ha\nguess:","tsu\nindex:","3743\nlabel:","na\nguess:","tsu\nindex:","9721\nlabel:","na\nguess:","re\nindex:","46331\nlabel:","ha\nguess:","tsu\nindex:","14666\nlabel:","na\nguess:","ma\nindex:","15259\nlabel:","na\nguess:","re\nindex:","33395\nlabel:","ha\nguess:","wo\nindex:","33425\nlabel:","wo\nguess:","su\nindex:","24161\nlabel:","ha\nguess:","tsu\nindex:","16579\nlabel:","ha\nguess:","na\nindex:","43411\nlabel:","su\nguess:","na\nindex:","44361\nlabel:","ma\nguess:","ki\nindex:","12744\nlabel:","na\nguess:","re\nindex:","6314\nlabel:","su\nguess:","ma\nindex:","10342\nlabel:","ki\nguess:","ma\nindex:","6381\nlabel:","ma\nguess:","su\nindex:","42435\nlabel:","na\nguess:","ma\nindex:","12191\nlabel:","ha\nguess:","ki\nindex:","25321\nlabel:","na\nguess:","ma\nindex:","19059\nlabel:","ma\nguess:","tsu\nindex:","25039\nlabel:","ki\nguess:","ma\nindex:","40711\nlabel:","ha\nguess:","tsu\nindex:","15415\nlabel:","ki\nguess:","o\nindex:","21124\nlabel:","ha\nguess:","ki\nindex:","33197\nlabel:","wo\nguess:","ki\nindex:","44675\nlabel:","su\nguess:","ma\n(e)","KMNIST","(ICE-LIN)\nindex:","21834\nlabel:","na\nguess:","ma\nindex:","10770\nlabel:","re\nguess:","tsu\nindex:","38820\nlabel:","na\nguess:","ma\nindex:","571\nlabel:","ki\nguess:","o\nindex:","44760\nlabel:","ya\nguess:","na\nindex:","23047\nlabel:","ma\nguess:","re\nindex:","11176\nlabel:","ha\nguess:","wo\nindex:","26146\nlabel:","ha\nguess:","tsu\nindex:","45588\nlabel:","wo\nguess:","tsu\nindex:","11110\nlabel:","na\nguess:","ma\nindex:","14458\nlabel:","tsu\nguess:","na\nindex:","15300\nlabel:","tsu\nguess:","re\nindex:","6657\nlabel:","ha\nguess:","ki\nindex:","28465\nlabel:","ma\nguess:","re\nindex:","40240\nlabel:","ha\nguess:","tsu\nindex:","18244\nlabel:","na\nguess:","re\nindex:","43640\nlabel:","wo\nguess:","su\nindex:","3768\nlabel:","na\nguess:","o\nindex:","6597\nlabel:","ya\nguess:","tsu\nindex:","9393\nlabel:","wo\nguess:","su\nindex:","41595\nlabel:","ma\nguess:","ki\nindex:","18369\nlabel:","ha\nguess:","tsu\nindex:","36225\nlabel:","na\nguess:","ki\nindex:","8891\nlabel:","su\nguess:","ma\nindex:","27536\nlabel:","wo\nguess:","su\nindex:","22556\nlabel:","ha\nguess:","su\nindex:","6111\nlabel:","ma\nguess:","na\nindex:","16493\nlabel:","ha\nguess:","ki\nindex:","15402\nlabel:","o\nguess:","ya\nindex:","46999\nlabel:","re\nguess:","o\nindex:","41561\nlabel:","ma\nguess:","su\nindex:","44796\nlabel:","ha\nguess:","su\n(f)","KMNIST","(ICE-POW)\nFigure","10:","The32mostlow-confidence","training","examplesin","the","MNIST,","FMNIST,","and","KMNIST","datasets,","ordered\nleft-right,","top-down","by","increasing","confidence.\n21\n\nindex:","48313\nlabel:","2\nguess:","6\nindex:","47401\nlabel:","1\nguess:","8\nindex:","54777\nlabel:","2\nguess:","9\nindex:","30916\nlabel:","1\nguess:","9\nindex:","25720\nlabel:","4\nguess:","9\nindex:","48038\nlabel:","1\nguess:","6\nindex:","50559\nlabel:","2\nguess:","0\nindex:","23125\nlabel:","1\nguess:","0\nindex:","34949\nlabel:","1\nguess:","0\nindex:","13227\nlabel:","1\nguess:","0\nindex:","58312\nlabel:","1\nguess:","0\nindex:","55153\nlabel:","4\nguess:","9\nindex:","23956\nlabel:","1\nguess:","8\nindex:","26396\nlabel:","3\nguess:","7\nindex:","3244\nlabel:","6\nguess:","0\nindex:","53586\nlabel:","2\nguess:","8\nindex:","3125\nlabel:","9\nguess:","0\nindex:","10259\nlabel:","0\nguess:","7\nindex:","30965\nlabel:","3\nguess:","7\nindex:","16168\nlabel:","1\nguess:","6\nindex:","45190\nlabel:","1\nguess:","0\nindex:","11768\nlabel:","2\nguess:","4\nindex:","38937\nlabel:","1\nguess:","6\nindex:","8313\nlabel:","5\nguess:","4\nindex:","26210\nlabel:","8\nguess:","0\nindex:","47880\nlabel:","4\nguess:","8\nindex:","38916\nlabel:","1\nguess:","5\nindex:","45832\nlabel:","9\nguess:","7\nindex:","52953\nlabel:","1\nguess:","8\nindex:","11491\nlabel:","3\nguess:","9\nindex:","33936\nlabel:","2\nguess:","0\nindex:","27262\nlabel:","1\nguess:","9\n(a)","SVHN","(ICE-LIN)\nindex:","6273\nlabel:","5\nguess:","9\nindex:","29094\nlabel:","1\nguess:","9\nindex:","58171\nlabel:","4\nguess:","9\nindex:","24202\nlabel:","2\nguess:","9\nindex:","57472\nlabel:","9\nguess:","0\nindex:","12343\nlabel:","1\nguess:","0\nindex:","52238\nlabel:","4\nguess:","9\nindex:","11115\nlabel:","3\nguess:","8\nindex:","27459\nlabel:","7\nguess:","9\nindex:","15541\nlabel:","2\nguess:","8\nindex:","20055\nlabel:","4\nguess:","8\nindex:","20980\nlabel:","1\nguess:","0\nindex:","11966\nlabel:","1\nguess:","8\nindex:","40808\nlabel:","2\nguess:","0\nindex:","6951\nlabel:","1\nguess:","8\nindex:","18484\nlabel:","1\nguess:","5\nindex:","28696\nlabel:","9\nguess:","8\nindex:","56469\nlabel:","4\nguess:","8\nindex:","18068\nlabel:","1\nguess:","6\nindex:","41469\nlabel:","1\nguess:","0\nindex:","58099\nlabel:","1\nguess:","9\nindex:","23758\nlabel:","9\nguess:","0\nindex:","11728\nlabel:","4\nguess:","8\nindex:","57990\nlabel:","1\nguess:","7\nindex:","39784\nlabel:","3\nguess:","9\nindex:","25288\nlabel:","1\nguess:","8\nindex:","14526\nlabel:","1\nguess:","7\nindex:","16617\nlabel:","1\nguess:","5\nindex:","6818\nlabel:","3\nguess:","7\nindex:","42348\nlabel:","1\nguess:","0\nindex:","25576\nlabel:","9\nguess:","5\nindex:","38553\nlabel:","2\nguess:","0\n(b)","SVHN","(ICE-POW)\nindex:","24264\nlabel:","bird\nguess:","cat\nindex:","15343\nlabel:","dog\nguess:","cat\nindex:","39510\nlabel:","dog\nguess:","dog\nindex:","6678\nlabel:","deer\nguess:","deer\nindex:","25882\nlabel:","dog\nguess:","horse\nindex:","36619\nlabel:","dog\nguess:","cat\nindex:","19647\nlabel:","airplane\nguess:","ship\nindex:","8710\nlabel:","dog\nguess:","horse\nindex:","26483\nlabel:","cat\nguess:","deer\nindex:","34056\nlabel:","dog\nguess:","cat\nindex:","38984\nlabel:","dog\nguess:","deer\nindex:","18746\nlabel:","ship\nguess:","airplane\nindex:","24972\nlabel:","bird\nguess:","dog\nindex:","11711\nlabel:","cat\nguess:","frog\nindex:","34398\nlabel:","horse\nguess:","cat\nindex:","35299\nlabel:","bird\nguess:","airplane\nindex:","39512\nlabel:","bird\nguess:","airplane\nindex:","32306\nlabel:","dog\nguess:","horse\nindex:","13756\nlabel:","bird\nguess:","airplane\nindex:","13833\nlabel:","cat\nguess:","deer\nindex:","34148\nlabel:","dog\nguess:","cat\nindex:","30440\nlabel:","cat\nguess:","deer\nindex:","33272\nlabel:","truck\nguess:","automobile\nindex:","39276\nlabel:","bird\nguess:","airplane\nindex:","1748\nlabel:","dog\nguess:","horse\nindex:","10578\nlabel:","bird\nguess:","airplane\nindex:","8823\nlabel:","cat\nguess:","dog\nindex:","30787\nlabel:","dog\nguess:","horse\nindex:","5004\nlabel:","bird\nguess:","cat\nindex:","7876\nlabel:","deer\nguess:","horse\nindex:","1587\nlabel:","cat\nguess:","deer\nindex:","30662\nlabel:","horse\nguess:","dog\n(c)","CIFAR-10","(ICE-LIN)\nindex:","36477\nlabel:","truck\nguess:","ship\nindex:","23105\nlabel:","cat\nguess:","cat\nindex:","26412\nlabel:","bird\nguess:","dog\nindex:","23605\nlabel:","deer\nguess:","bird\nindex:","7338\nlabel:","dog\nguess:","deer\nindex:","12778\nlabel:","dog\nguess:","horse\nindex:","20297\nlabel:","cat\nguess:","frog\nindex:","28845\nlabel:","truck\nguess:","airplane\nindex:","25005\nlabel:","dog\nguess:","truck\nindex:","28965\nlabel:","cat\nguess:","deer\nindex:","31445\nlabel:","dog\nguess:","cat\nindex:","8534\nlabel:","bird\nguess:","cat\nindex:","33945\nlabel:","airplane\nguess:","automobile\nindex:","24139\nlabel:","dog\nguess:","deer\nindex:","23734\nlabel:","cat\nguess:","dog\nindex:","29703\nlabel:","deer\nguess:","dog\nindex:","33580\nlabel:","cat\nguess:","cat\nindex:","29864\nlabel:","cat\nguess:","dog\nindex:","19294\nlabel:","frog\nguess:","ship\nindex:","11827\nlabel:","dog\nguess:","deer\nindex:","29811\nlabel:","dog\nguess:","horse\nindex:","23738\nlabel:","dog\nguess:","ship\nindex:","36683\nlabel:","deer\nguess:","horse\nindex:","5617\nlabel:","bird\nguess:","dog\nindex:","20200\nlabel:","bird\nguess:","cat\nindex:","5573\nlabel:","truck\nguess:","dog\nindex:","26304\nlabel:","horse\nguess:","cat\nindex:","16873\nlabel:","cat\nguess:","deer\nindex:","36761\nlabel:","horse\nguess:","cat\nindex:","10363\nlabel:","truck\nguess:","bird\nindex:","2798\nlabel:","bird\nguess:","dog\nindex:","39440\nlabel:","bird\nguess:","frog\n(d)","CIFAR-10","(ICE-POW)\nindex:","18512\nlabel:","porcupine\nguess:","leopard\nindex:","28177\nlabel:","table\nguess:","road\nindex:","7073\nlabel:","ray\nguess:","fish\nindex:","18867\nlabel:","dinosaur\nguess:","lizard\nindex:","30224\nlabel:","beaver\nguess:","fox\nindex:","4257\nlabel:","table\nguess:","television\nindex:","28091\nlabel:","turtle\nguess:","skunk\nindex:","7578\nlabel:","bus\nguess:","road\nindex:","39797\nlabel:","ray\nguess:","dolphin\nindex:","30954\nlabel:","table\nguess:","television\nindex:","5254\nlabel:","crab\nguess:","mower\nindex:","4975\nlabel:","snake\nguess:","fish\nindex:","23544\nlabel:","forest\nguess:","plain\nindex:","33839\nlabel:","mushroom\nguess:","kangaroo\nindex:","34093\nlabel:","fish\nguess:","crocodile\nindex:","13297\nlabel:","possum\nguess:","chimpanzee\nindex:","18782\nlabel:","shrew\nguess:","mushroom\nindex:","12207\nlabel:","bridge\nguess:","couch\nindex:","23949\nlabel:","shark\nguess:","skyscraper\nindex:","13462\nlabel:","leopard\nguess:","chimpanzee\nindex:","3457\nlabel:","cloud\nguess:","can\nindex:","11340\nlabel:","crab\nguess:","plate\nindex:","7279\nlabel:","leopard\nguess:","bear\nindex:","14821\nlabel:","possum\nguess:","squirrel\nindex:","24228\nlabel:","shark\nguess:","raccoon\nindex:","24092\nlabel:","boy\nguess:","skunk\nindex:","8441\nlabel:","bear\nguess:","rabbit\nindex:","175\nlabel:","pear\nguess:","pepper\nindex:","26775\nlabel:","crocodile\nguess:","ray\nindex:","34886\nlabel:","butterfly\nguess:","television\nindex:","25422\nlabel:","flatfish\nguess:","possum\nindex:","136\nlabel:","forest\nguess:","sea\n(e)","CIFAR-100","(ICE-LIN)\nindex:","8126\nlabel:","worm\nguess:","squirrel\nindex:","7784\nlabel:","couch\nguess:","tiger\nindex:","38245\nlabel:","cattle\nguess:","orchid\nindex:","35617\nlabel:","worm\nguess:","truck\nindex:","1467\nlabel:","streetcar\nguess:","can\nindex:","10450\nlabel:","caterpillar\nguess:","orchid\nindex:","10112\nlabel:","caterpillar\nguess:","mushroom\nindex:","8659\nlabel:","bowl\nguess:","pear\nindex:","30259\nlabel:","train\nguess:","streetcar\nindex:","30805\nlabel:","otter\nguess:","trout\nindex:","39150\nlabel:","pear\nguess:","plate\nindex:","5424\nlabel:","ray\nguess:","dolphin\nindex:","33481\nlabel:","caterpillar\nguess:","caterpillar\nindex:","25939\nlabel:","snake\nguess:","woman\nindex:","15118\nlabel:","otter\nguess:","lion\nindex:","1275\nlabel:","leopard\nguess:","tiger\nindex:","39622\nlabel:","seal\nguess:","bear\nindex:","504\nlabel:","squirrel\nguess:","fox\nindex:","23537\nlabel:","dinosaur\nguess:","woman\nindex:","7609\nlabel:","lobster\nguess:","turtle\nindex:","17662\nlabel:","boy\nguess:","possum\nindex:","7968\nlabel:","baby\nguess:","man\nindex:","21840\nlabel:","butterfly\nguess:","worm\nindex:","229\nlabel:","porcupine\nguess:","bear\nindex:","453\nlabel:","possum\nguess:","squirrel\nindex:","18630\nlabel:","crab\nguess:","cloud\nindex:","1257\nlabel:","worm\nguess:","seal\nindex:","12624\nlabel:","shrew\nguess:","shark\nindex:","39074\nlabel:","spider\nguess:","rabbit\nindex:","6692\nlabel:","trout\nguess:","turtle\nindex:","29441\nlabel:","crab\nguess:","shark\nindex:","15043\nlabel:","bed\nguess:","forest\n(f)","CIFAR-100","(ICE-POW)\nFigure","11:","The32mostlow-confidence","training","examplesin","the","SVHN,","CIFAR-10","and","CIFAR-100","datasets,","ordered\nleft-right,","top-down","by","increasing","confidence.\n22\n\nTable","4:","The","Corpus","of","Linguistic","Acceptability","(CoLA)\nIndex","","Text\n390\nlabel:acceptable","guess:unacceptable\nsentence:He","I","often","sees","Mary.\n5766\nlabel:acceptable","guess:unacceptable\nsentence:Heidi","believes","any","description","of","herself.\n2801\nlabel:unacceptable","guess:acceptable\nsentence:Paula","hit","the","sticks.\n1522\nlabel:unacceptable","guess:acceptable\nsentence:That","the","sun","is","out","was","obvious.\n8332\nlabel:acceptable","guess:unacceptable\nsentence:I","wanted","Jimmy","for","to","come","with","me.\n300\nlabel:acceptable","guess:unacceptable\nsentence:They","failed","to","tell","me","which","problem","the","sooner","I","solve,","the","quicker","the","folks","up\nat","corporate","headquarters.\n7813\nlabel:acceptable","guess:unacceptable\nsentence:I","went","to","the","shop","for","to","get","bread.\n5904\nlabel:acceptable","guess:unacceptable\nsentence:It","hailed.\n4159\nlabel:unacceptable","guess:acceptable\nsentence:Fifteen","years","represent","a","long","period","of","his","life.\n2479\nlabel:unacceptable","guess:acceptable\nsentence:Kelly","buttered","the","bread","with","butter.\n3846\nlabel:acceptable","guess:acceptable\nsentence:They","parted","the","best","of","friends.\n7371\nlabel:unacceptable","guess:acceptable\nsentence:The","hiker","will","reach","the","top","of","the","mountain","for","an","hour.\n430\nlabel:unacceptable","guess:acceptable\nsentence:It’s","probable","in","general","that","he","understands","what’s","going","on.\n6795\nlabel:unacceptable","guess:acceptable\nsentence:Henry","wanted","to","possibly","marry","Fanny.\n1115\nlabel:acceptable","guess:acceptable\nsentence:He","attributed","to","a","short","circuit","the","fire","which.\n4155\nlabel:unacceptable","guess:unacceptable\nsentence:Two","drops","sanitize","anything","in","your","house.\n1367\nlabel:acceptable","guess:acceptable\nsentence:We","elected","president","the","boy’s","guardian’s","employer.\n7756\nlabel:acceptable","guess:unacceptable\nsentence:That","monkey","is","ate","the","banana\n4445\nlabel:unacceptable","guess:acceptable\nsentence:George","has","went","to","America.\n4015\nlabel:acceptable","guess:unacceptable\nsentence:He","seems","intelligent","to","study","medicine.\n23\n\nTable","5:","The","Stanford","Sentiment","Treebank","(SST2)\nIndex","","Text\n50155\nlabel:positive","guess:positive\nsentence:a","thirteen-year-old","’s","book","report\n58416\nlabel:negative","guess:negative\nsentence:blues\n59724\nlabel:negative","guess:positive\nsentence:‘","synthetic","’","is","the","best","description","of","this","well-meaning",",","beautifully","produced\nfilm","that","sacrifices","its","promise","for","a","high-powered","star","pedigree",".\n24696\nlabel:positive","guess:negative\nsentence:lamer","instincts\n34494\nlabel:positive","guess:positive\nsentence:had","released","the","outtakes","theatrically","and","used","the","film","as","a","bonus","feature","on\nthe","dvd\n54555\nlabel:negative","guess:negative\nsentence:pretentious",",","fascinating",",","ludicrous",",","provocative","and","vainglorious\n29155\nlabel:positive","guess:negative\nsentence:he","can","be","forgiven","for","frequently","pandering","to","fans","of","the","gross-out","comedy\n44610\nlabel:negative","guess:positive\nsentence:below\n66148\nlabel:negative","guess:positive\nsentence:’s","cliche","to","call","the","film","‘","refreshing\n11869\nlabel:positive","guess:negative\nsentence:go","unnoticed","and","underappreciated\n55848\nlabel:negative","guess:positive\nsentence:the","film","is","an","earnest","try","at","beachcombing","verismo",",","but","it","would","be","even","more\nindistinct","than","it","is","were","it","not","for","the","striking",",","quietly","vulnerable","personality","of","ms.\nambrose",".\n57359\nlabel:negative","guess:negative\nsentence:(","ferrera",")\n42232\nlabel:positive","guess:negative\nsentence:forgive","any","shoddy","product","as","long","as","there","’s","a","little","girl-on-girl","action\n15783\nlabel:positive","guess:negative\nsentence:have","finally","aged","past","his","prime","...\n57186\nlabel:negative","guess:positive\nsentence:hollywood","war-movie","stuff\n52071\nlabel:positive","guess:negative\nsentence:the","gags\n1896\nlabel:positive","guess:negative\nsentence:missing","from","the","girls","’","big-screen","blowout\n64779\nlabel:positive","guess:negative\nsentence:growing","strain\n3940\nlabel:positive","guess:negative\nsentence:you","to","bite","your","tongue","to","keep","from","laughing","at","the","ridiculous","dialog","or","the","oh-\nso","convenient","plot","twists\n24\n\nTable","6:","Microsoft","Research","Paraphrase","Corpus","(MRPC)\nIndex","","Text\n799\nlabel:equivalent","guess:not","equivalent\nsentence1:We","need","a","certifiable","pay","as","you","go","budget","by","mid-July","or","schools","wont","open","in\nSeptember",",","Strayhorn","said",".\nsentence2:Texas","lawmakers","must","close","a","$","185.9","million","budget","gap","by","the","middle","of","July","or\nthe","schools","wont","open","in","September",",","Comptroller","Carole","Keeton","Strayhorn","said","Thursday",".\n469\nlabel:not","equivalent","guess:equivalent\nsentence1:It","’s","also","a","strategic","win","for","Overture",",","given","that","Knight","Ridder","had","the\noption","of","signing","on","Google","’s","services",".\nsentence2:It","’s","also","a","strategic","win","for","Overture",",","given","that","Knight","Ridder","had","been\nusing","Google","’s","advertising","services",".\n1037\nlabel:equivalent","guess:not","equivalent\nsentence1:The","broader","Standard","&","Poor","’s","500","Index","<",".SPX",">","edged","down","9","points",",","or","0.98\npercent",",","to","921",".\nsentence2:The","Standard","&","Poor","’s","500","Index","shed","5.20",",","or","0.6","percent",",","to","924.42","as","of","9",":\n33","a.m.","in","New","York",".\n1178\nlabel:equivalent","guess:not","equivalent\nsentence1:Sens.","John","Kerry","and","Bob","Graham","declined","invitations","to","speak",".\nsentence2:The","no-shows","were","Sens.","John","Kerry","of","Massachusetts","and","Bob","Graham","of","Florida",".\n1753\nlabel:equivalent","guess:not","equivalent\nsentence1:The","Dow","Jones","industrial","average","closed","down","18.06",",","or","0.2","per","cent",",","at\n9266.51",".\nsentence2:The","blue-chip","Dow","Jones","industrial","average","<",".DJI",">","slipped","44.32","points",",","or\n0.48","percent",",","to","9,240.25",".\nTable","7:","Quora","Question","Pairs","(QQP)\nIndex","","","Text\n216515\nlabel:duplicate","guess:duplicate\nquestion1:Why","does","Quora","censor","opinions","and","answers?\nquestion2:Does","Quora","censor","questions","and","answers,","and","should","they?\n343656\nlabel:not","duplicate","guess:duplicate\nquestion1:Could","India’s","surgical","strike","in","POK","be","an","elaborate","hoax","or","play?\nquestion2:Did","India","really","conduct","a","surgical","strike","on","Pakistan?\n266594\nlabel:not","duplicate","guess:not","duplicate\nquestion1:Why","is","financial","literacy","generally","not","taught","in","American","high","schools?\nquestion2:Why","isn’t","financial","literacy","taught","in","today’s","public","schools?\n251996\nlabel:not","duplicate","guess:not","duplicate\nquestion1:What","is","life","like","in","communist","countries?\nquestion2:What","would","life","in","a","legitimate","Communist","country","be","like?\n7963\nlabel:not","duplicate","guess:duplicate\nquestion1:What","is","the","best","option","for","Indian","politics","and","politicians?\nquestion2:What","are","the","options","of","Indian","politics","and","politicians?\n25\n\nTable","8:","MultiNLI","(MNLI)\nIndex","","","Text\n218290\nlabel:entailment","guess:neutral\npremise:The","ruins","of","the","huge","abbey","of","Jumiyges","are","perhaps","the","most","the","white-granite\nshells","of","two","churches,","the","Romanesque","Notre-Dame","and","the","smaller","Gothic","Saint-Pierre.\nhypothesis:Notre-Dame","is","a","larger","church","than","Gothic","Saint-Pierre.\n39431\nlabel:neutral","guess:entailment\npremise:Unless","you","feel","really","safe","in","French","metropolitan","traffic,","keep","your","cycling","’\nyou","can","rent","a","bike","at","many","railway","stations","’","for","the","villages","and","country","roads.\nhypothesis:You","should","not","cycle","in","the","French","metropolitan","area.\n27574\nlabel:contradiction","guess:neutral\npremise:I","don’t","think","so.\nhypothesis:I","have","no","real","idea.\n258544\nlabel:neutral","guess:neutral\npremise:A","set","of","stone","doors","in","the","wall","slid","to","the","side","to","reveal","a","screen","on","which\nvarious","torture","scenes","began","to","appear.\nhypothesis:The","doors","hid","a","television","screen.\n320518\nlabel:contradiction","guess:neutral\npremise:None","seems","comfortable","with","the","notion","of","removing","Clinton","for","sex-related\nmisdeeds.\nhypothesis:People","don’t","want","Clinton","touching","sex","related","ordeals\nTable","9:","Question","NLI","(QNLI)\nIndex","","Text\n1659\nlabel:not","entailment","guess:not","entailment\nquestion:What","caused","Latin","America’s","right-wing","authorities","to","support","coup","o’etats?\nsentence:This","was","further","fueled","by","Cuban","and","United","States","intervention","which","led","to","a\npolitical","polarization.\n5876\nlabel:not","entailment","guess:not","entailment\nquestion:What","antenna","type","is","a","portion","of","the","half","wave","dipole?\nsentence:The","monopole","antenna","is","essentially","one","half","of","the","half-wave","dipole,","a","single\n1/4-wavelength","element","with","the","other","side","connected","to","ground","or","an","equivalent","ground\nplane","(or","counterpoise).\n5829\nlabel:entailment","guess:entailment\nquestion:How","are","Toxicara","canis","infections","spread?\nsentence:Toxocara","canis","(dog","roundworm)eggs","in","dog","feces","can","cause","toxocariasis.\n77419\nlabel:entailment","guess:entailment\nquestion:Why","did","Madrid","cede","the","territory","to","the","US\nsentence:Florida","had","become","a","burden","to","Spain,","which","could","not","afford","to","send","settlers","or\ngarrisons.\n9576\nlabel:not","entailment","guess:not","entailment\nquestion:What","has","no","distinction","between","the","categories","of","voiced,","voiceless,","aspirated\nand","unaspirated?\nsentence:Some","of","the","Dravidian","languages,","such","as","Telugu,","Tamil,","Malayalam,","and","Kannada,\nhave","a","distinction","between","voiced","and","voiceless,","aspirated","and","unaspirated","only","in\nloanwords","from","Indo-Aryan","languages.\n26\n\nTable","10:","Recognizing","Textual","Entailment","(RTE)\nIndex","","Text\n2429\nlabel:not","entailment","guess:entailment\nsentence1:Bogota,","4","May","88","-","The","dissemination","of","a","document","questioning","Colombia’s","oil\npolicy,","is","reportedly","the","aim","of","the","publicity","stunt","carried","out","by","the","pro-Castro","Army","Of\nNational","Liberation,","which","kidnapped","several","honorary","consuls,","newsmen,","and","political\nleaders.\nsentence2:Several","honorary","consuls","were","kidnapped","on","4","May","88.\n2463\nlabel:not","entailment","guess:entailment\nsentence1:The","official","religion","is","Theravada","Buddhism,","which","is","also","practiced","in\nneighboring","Laos,","Thailand,","Burma","and","Sri","Lanka.\nsentence2:The","official","religion","of","Thailand","is","Theravada","Buddhism.\n1361\nlabel:entailment","guess:not","entailment\nsentence1:The","Catering","JLC","formulates","pay","and","conditions","proposals","of","workers","in","the\nindustry","which,","if","approved","by","the","Labour","Court,","legally","binds","employers","to","pay","certain\nwage","rates","and","provide","conditions","of","employment.","However,the","QSFA","now","contends","that","the\nJLC","has","no","right","to","make","such","a","legally","binding","provision,","as","Section","15","of","the\nConstitution","states","that","the","sole","and","exclusive","power","to","make","laws","is","vested","in","the\nOireachtas,","and","no","other","authority","has","power","to","make","laws","for","the","State.","It","also","argued\nthat","the","existence","of","the","minimum","wage","and","25","other","pieces","of","legislation","protecting\nemployees’","rights","means","that","there","is","no","need","for","JLCs.","The","chairman","of","the","QSFA,","John\nGrace,","warned","that","the","situation","would","lead","to","job","losses","and","closures.\nsentence2:John","Grace","works","for","QSFA.\nTable","11:","Winograd","NLI","(WNLI)\nIndex","","Text\n266\nlabel:entailment","guess:not","entailment\nsentence1:Susan","knew","that","Ann’s","son","had","been","in","a","car","accident,","so","she","told","her","about","it.\nsentence2:Susan","told","her","about","it.\n478\nlabel:entailment","guess:not","entailment\nsentence1:Joe","paid","the","detective","after","he","delivered","the","final","report","on","the","case.\nsentence2:The","detective","delivered","the","final","report","on","the","case.\n294\nlabel:entailment","guess:not","entailment\nsentence1:Dan","had","to","stop","Bill","from","toying","with","the","injured","bird.","He","is","very","compassionate.\nsentence2:Dan","is","very","compassionate.\n586\nlabel:entailment","guess:not","entailment\nsentence1:Dan","took","the","rear","seat","while","Bill","claimed","the","front","because","his","\"Dibs!\"","was","slow.\nsentence2:Dan","took","the","rear","seat","while","Bill","claimed","the","front","because","Dan’s","\"Dibs!\"","was\nslow.\n243\nlabel:entailment","guess:not","entailment\nsentence1:Mark","was","close","to","Mr.","Singer’s","heels.","He","heard","him","calling","for","the","captain,\npromising","him,","in","the","jargon","everyone","talked","that","night,","that","not","one","thing","should","be\ndamaged","on","the","ship","except","only","the","ammunition,","but","the","captain","and","all","his","crew","had","best\nstay","in","the","cabin","until","the","work","was","over.\nsentence2:He","heard","Mr.","Singer","calling","for","the","captain.\n27"],"doc4":["\n\nPrediction","in","the","presence","of","response-dependent\nmissing","labels\nHyebin","Song\n∗\n,","Garvesh","Raskutti\n†\n,","Rebecca","Willett\n‡\nAbstract\nIn","a","variety","of","settings,","limitations","of","sensing","technologies","or","other","sampling","mecha-\nnisms","result","in","missing","labels,","where","the","likelihood","of","a","missing","label","in","the","training","set\nis","an","unknown","function","of","the","data.","","For","example,","satellites","used","to","detect","forest","fires\ncannot","sense","fires","below","a","certain","size","threshold.","In","such","cases,","training","datasets","consist\nof","positive","and","pseudo-negative","observations","where","pseudo-negative","observations","can\nbe","either","true","negatives","or","undetected","positives","with","small","magnitudes.","","We","develop\na","new","methodology","and","non-convex","algorithm","P(ositive)","U(nlabeled)","-","O(ccurrence)\nM(agnitude)","M(ixture)","which","jointly","estimates","the","occurrence","and","detection","likelihood\nof","","positive","","samples,","","utilizing","","prior","","knowledge","","of","","the","","detection","","mechanism.","","","Our","","ap-\nproach","uses","ideas","from","positive-unlabeled","(PU)-learning","and","zero-inflated","models","that\njointly","estimate","the","magnitude","and","occurrence","of","events.","","We","provide","conditions","under\nwhich","our","model","is","identifiable","and","prove","that","even","though","our","approach","leads","to","a","non-\nconvex","objective,","any","local","minimizer","has","optimal","statistical","error","(up","to","a","log","term)\nand","projected","gradient","descent","has","geometric","convergence","rates.","","We","demonstrate","on\nboth","","synthetic","","data","","and","","a","","California","","wildfire","","dataset","","that","","our","","method","","out-performs\nexisting","state-of-the-art","approaches.\n1","","","","Introduction\nA","common","challenge","in","many","statistical","machine","learning","problems","isnoisy","or","missing","labels.\nIn","such","settings,","it","is","often","common","to","assume","the","labels","are","missing","at","random","and","place\n∗\nDepartment","of","Statistics,","The","Pennsylvania","State","University\n†\nDepartment","of","Statistics,","University","of","Wisconsin-Madison\n‡\nDepartment","of","Statistics,","University","of","Chicago\n1\narXiv:2103.13555v1","","[stat.ML]","","25","Mar","2021\n\na","","distribution","","on","","the","","missing","","labels","","(see","","e.g.","","Little","","and","","Rubin,","","2019;","","Molenberghs","","et","","al.,\n2014).","","However,","in","many","applications,","labels","are","missing","systematically","due","to","aspects","of\nthe","technology","in","the","data","collection","process.","","Consider,","","for","example,","","a","dataset","consisting\nof","wildfire","events","in","California","where","fire","size","is","measured","using","satellite","imagery.","","Due","to\nthe","limited","resolution","of","the","satellite","optics,","fires","smaller","than","a","certain","threshold","will","not\nbe","observed,","complicating","the","effort","of","building","a","predictor","of","fire","size.","","Similarly,","consider\nforecasting","the","spread","or","impact","of","a","virus,","where","a","person’s","likelihood","of","being","tested","and\nincluded","in","a","dataset","depends","on","the","severity","of","their","symptoms.","","These","are","both","examples\nofresponse-dependent","missing","labelswhere","labels","or","measurements","are","missing","based","on","the\nmagnitude","","or","","sizeof","the","measured","event.","","This","response-dependent","sampling","bias","poses","a\nsignificant","","challenge","","in","","terms","","of","","(i)","","predicting","","event","","(such","","as","","fire)","","occurrence,","","since","","small\nmagnitude","events","are","not","recorded","and","(ii)","predicting","the","magnitude","of","each","event","(due","to\npositive","bias","of","the","measurements).\nIn","this","paper,","we","develop","a","statistical","framework","that","addressesresponse-dependent","miss-\ning","","labelswith","a","two-level","model","that","(i)","models","thetrue","","event","","magnitudeYas","a","mixture\nof","","0,","","indicating","","no","","event,","","and","","a","","positive","","distribution","","if","","the","","event","","occurs;","","and","","(ii)","","models\ntheobserved","event","magnitudeZ,","which","is","either","the","same","asYor","0,","depending","on","the","true\nresponseY.","","More","specifically,\nP(Z=","0|Y=y",">0,X=x)","=","1−Γ(y),\nwhereX=xdenotes","the","features","or","covariates","and","Γ(y)","represents","a","probability","depending\nonywhich","accounts","for","the","outcome-dependence.","","HenceZ=","0","could","either","denote","a","“true”\nnegative","whereY=","0","or","a","“false","negative”","whereY",">0","butZ=","0.\nThis","flexible","framework","allows","us","to","model","response-dependent","missing","labels","through","an\noccurrence-magnitude","mixture","distribution","forYand","the","probability","function","Γ(y)","for","the\nobserved","responseZ.","","This","model","presents","both","identifiability","and","computational","challenges\nthat","we","address","in","this","paper.","","SinceZ=","0","could","either","denote","a","true","0","or","a","false","0,","we","first\nprovide","identifiablity","conditions","on","our","mixed","model.","Secondly,","two","computational","challenges\narise:","(i)","the","likelihood","of","the","observed","dataZinvolves","integration","over","the","function","Γ(y)","and\n(ii)","even","if","this","integration","is","possible,","the","objective","is","non-convex.","","To","address","(i),","we","choose\nΓ(y)","–","the","CDF","of","a","Gamma","distribution","which","allows","a","closed-form","computation","of","the\nintegral;","to","address","(ii),","we","demonstrate","that","even","though","the","objective","is","non-convex,","using\nprojected","gradient","descent","leads","to","a","local","minimizer","with","desirable","statistical","properties.\n2\n\n1.1","","","","Related","Work\nCensored","labels:Our","proposed","model","is","in","contrast","with","the","Type","I","Tobit","model","(Tobin,\n1958),","where","excess","zeros","arise","due","to","the","censoring","of","an","underlying","continuous","variable.\nIn","the","case","of","the","Tobit","model,","zeros","are","only","proxies","for","values","below","a","certain","thereshold,\nand","","therefore","","the","","goal","","of","","Tobit","","analysis","","is","","to","","estimate","","magnitude","","only.","","","On","","the","","contrary,\nour","framework","models","the","two-part","mixture","models","that","separately","model","the","probability\nof","event","occurrences","and","magnitude","of","the","events","(Smith","et","al.,","2014;","Neelon","et","al.,","2016).\nPositive-Unlabeled","(PU)","and","multi-label","learning:Our","approach","is","also","related","to\nPositive-Unlabeled","(PU)","and","multi-label","learning.","","PU-learning","is","a","kind","of","semi-supervised\nlearning","where","learning","is","performed","based","on","positive","and","unlabeled","examples","(Liu","et","al.,\n2003;","Elkan","and","Noto,","2008;","Du","Plessis","et","al.,","2015).","","In","particular,","response","labels","are","only\npartially","known,","as","unlabeled","examples","can","belong","to","either","the","positive","or","negative","class.\nSimilarly,","in","multi-label","learning","problems,","each","example","is","associated","with","only","a","subset","of\nthe","true","relevant","labels","(Jain","et","al.,","2016;","Schultheis","et","al.,","2020).","","In","both","cases,","the","goal","is","to\nlearn","a","model","that","can","predict","the","occurrence","of","true","labels.","","However,","both","learning","focuses\nexclusively","","on","","the","","occurrence","","of","","events","","(labels),","","while","","our","","framework","","involves","","a","","mixture\ndistribution","ofYthat","simultaneously","estimates","occurrence","and","magnitude.\nNon-random","","missing","","labels:There","","has","","been","","extensive","","work","","in","","learning","","with","","missing\ndata.","","Our","work","is","closely","related","to","non-ignorable","missing","where","the","missing","data","mech-\nanism","depends","on","the","unobserved","values","of","a","variable","which","is","subject","to","missing","(Rubin,\n1974).","","In","this","missing","not","at","random","(MNAR)","setting,","it","is","often","required","to","specify","a","joint\nmodel","for","observations","and","missing","mechanism","in","order","to","perform","valid","statistical","inference.\nA","number","of","works","focus","on","model","development,","identifiability,","estimation","and","predictions\nunder","various","structural","assumptions","about","missing","mechanisms","in","the","presence","of","MNAR\noutcomes","(Zhao","and","Shao,","2015;","Mohan","and","Pearl,","2018;","Franks","et","al.,","2020;","Ma","and","Chen,\n2019).","","Our","work","also","concerns","response-dependent","missing","labels,","which","are","MNAR.","How-\never,","true","and","false","negatives","are","unknown","in","our","setting,","whereas","which","observations","are\nmissing","is","known","a","priori","in","the","MNAR","literature.\nNon-convex","","optimization","","and","","statistics:Lastly,","","an","","active","","line","","of","","work","","exist","","in","","non-\nconvex","","estimation","","problems","","in","","which","","various","","statistical","","and","","algorithmic","","guarantees","","of","","a\nnon-convex","","M-estimator","","are","","studied","","(Loh","","and","","Wainwright,","","2012;","","Yang","","et","","al.,","","2015;","","Mei\net","al.,","2018;","Elsener","and","van","de","Geer,","2019).","","Our","objective","turns","out","to","be","a","non-convex\n3\n\nfunction","of","parameters,","and","our","work","utilizes","a","number","of","tools","in","non-convex","literature","to\nobtain","statistical","and","algorithmic","guarantees","of","the","proposed","estimator","which","is","a","stationary\npoint","of","the","non-convex","objective","function.\n1.2","","","","Contributions\nOur","paper","makes","the","following","contributions:\n1.","","A","","general","","statistical","","framework","","for","","dealing","","with","","response-dependent","","missing","","labels,\nleading","to","a","closed-form","log-likelihood;\n2.","","Identifiability","conditions","(Theorem","1)","for","our","model;\n3.","","We","prove","that","any","local","minimizer","achieves","optimal","(up","to","a","constant)","statistical","error\nof\np\nn\n(Theorem","2),","wherepis","the","number","of","features","andnis","the","number","of","samples)\nunder","standard","assumptions","and","proof","that","our","projected","gradient","descent","algorithm\nhas","geometric","convergence","to","a","local","minimizer","(Theorem","3);\n4.","","A","simulation","study","which","displays","the","advantages","of","our","method","compared","to","state-of-\nthe-art","methods","under","correct","model","specification","and","two","misspecified","model","settings;\nand\n5.","","Illustration","","of","","the","","advantages","","of","","our","","approach","","compared","","to","","existing","","stat-of-the-art\napproaches","in","a","setting","involving","wildfire","prediction","in","California.\n1.3","","","","Notation\nWe","use","normal","font","for","scalars","(e.g.a,b,c,...)","and","boldface","for","vectors","(x,u,v,...).","","We\nreserve","capital","letters","for","random","variables.","","For","a","vectoru,v∈R\nd\n,","we","write‖v‖\np\nto","denote\nan`\np\nnorm","","of","","a","","vector.","","","We","","also","","writeB\nq\n(r;v)","","to","","denote","","an`\nq\nball","","centered","","atv,","","i.e.\nB\nq\n(r;v)",":={v;‖v‖\nq\n≤r}.","","If","the`\nq\nball","is","centered","at","zero","(v=","0),","we","omitvand","simply\nwriteB\nq\n(r).\n2","","","","Model","and","Algorithm\n2.1","","","","Problem","Set-up\nWe","consider","the","following","problem","set-up","for","estimation","and","prediction","using","contaminated\ndata.","","","We","","assume","","thatYhas","","a","","mixture","","distribution","","of","","a","","point","","mass","","at","","0","","(denoting","","no\nevent)","and","continuous","distribution","overR\n+\n(denoting","the","magnitude","of","the","event),","and","each\n4\n\ncomponent","distribution","depends","on","the","value","of","a","set","of","featuresx∈R\np\n.","","In","other","words,\nthe","p.d.f","ofYgivenX=xis","as","follows\n1\n:\np\nY\n(t|x;β,θ)","=","(1−p\n1\n(x))δ\n0\n(t)","+p\n1\n(x)g(t|x)(1)\nfor","somep\n1\n(x)","andg(·|x)","wherep\n1\ntakes","a","value","between","0","and","1","depending","onxandg(t|x)\nis","a","p.d.f","of","the","continuous","distribution.","","Here,","eachp\n1\nandgis","related","to","occurrence","and\nmagnitude","of","the","mixture","distribution","forY.\nFirst,","","we","","modelP(Y",">0|x)","","=p\n1\n(x;θ)","","andP(Y=","","0|x)","","=","","1−p\n1\n(x;θ)","","where","","we","","let\np\n1\n(x;θ)","",":=σ(x\n>\nθ)","",":=","","(1","+","exp(−x\n>\nθ))\n−1\n.","","","WhenY",">0,","","we","","use","","an","","exponential","","GLM;\nspecifically,\np\nY|Y",">0,X\n(y|x)","=g(t|x;β)",":=λ\nX\nexp(−λ\nX\nt)\nwhereλ\nX\n=","exp(−x\n>\nβ).","","The","exponential","GLM","is","chosen","to","reflect","that","a","size","of","an","event","is\nalways","non-negative.","","That","is,","given","that","an","event","has","occurred,","i.e.Y",">0,","the","probability\nthatYis","larger","thantisP(Y",">","t|Y",">0,x)","=\n∫\n∞\nt\ng(s|x;β)ds.\nIf","an","i.i.d","sample","of","(x\ni\n,y\ni\n)\nn\ni=1\nis","available,","the","mixture","modeling","approach","(e.g.","","Cragg,\n1971;","Olsen","and","Schafer,","2001)","can","be","utilized","to","estimate","the","parametersθandβ.","","However\nin","our","setting,","not","ally\ni\nare","observed","since","events","with","small","magnitude","that","tend","to","have\nmissing","labels.","","We","introduce","a","random","variableZto","denote","theobservedsize","of","an","event.","","If\nan","event","has","occurred","but","is","unobserved,","theny\ni\n>0","butz\ni\n=","0.","","On","the","other","hand,","if","the\nevent","is","observed,","the","recorded","size","is","the","same","as","the","true","size,","i.e.z\ni\n=y\ni\n.","","Sincez\ni\n=","0","no\nlonger","implies","that","no","event","has","occurred,","we","cannot","simply","estimate","the","parameters","using\nthe","observed","sizes","(z\ni\ns)","instead","of","the","true","sizes","(y\ni\ns).\n2.2","","","","Likelihood","model","and","identifiability\nWe","model","the","likelihood","of","correctly","observing","events","as\nP(Z",">0|Y=y",">0,X=x)","=","Γ(y),(2)\nIn","other","words,","the","probability","that","the","magnitudeYis","observed","depends","only","on","the","value","of\nYitself.","","In","many","practical","applications,","this","“self-masking","phenomenon”","occurs","where","true\nvalue","itself","determines","whether","the","observation","would","be","hidden","or","revealed.","","For","example,\n1\nprecisely","by","p.d.f,","we","mean","a","Radon-Nikodym","derivative","ofP\nY|X\nwith","respect","to","the","Lebesgue","measure\nplus","a","point","mass","at","zero.\n5\n\nif","we","consider","fire","prediction,","the","size","of","fire","affects","whether","the","fire","event","would","be","detected\nor","not;","hence","Γ(·)","is","an","monotonically","increasing","function.","","From","here,","we","combine","(1)","and\n(2)","and","integrate","out","the","unobservedYto","derivep\nZ|X\n;","","the","log","of","this","quantity","forms","our\nloss","function","for","a","collection","of","samples","(x\ni\n,z\ni\n)","fori=","1,...,n:\nL\nn\n(θ,β)","=−\n1\nn\n∑\ni;z\ni\n=0\nlog","(1−φ(x\ni\n;β,Γ)p\n1\n(x\ni\n;θ))\n−\n1\nn\n∑\ni;z\ni\n>0\nlog{g(z\ni\n|x;β)Γ(z\ni\n)p\n1\n(x\ni\n;θ)}\n(3)\nwhere\nφ(x;β,Γ)","=\n∫\n∞\n0\nΓ(y)g(y|x;β)dy.(4)\nIdentifiabiliy.We","first","discuss","the","identifiability","of","the","model.","","Clearly,","the","model","is","not\nidentifiable","if","no","assumptions","about","the","structure","ofgin","(1)","and","Γ","are","made","because","the\nlikelihood","(3)","is","defined","via","Γ(y)g(y|x).","","On","the","other","hand,","both","parameters","are","identifiable\nunder","parametric","assumptions","onp\n1\nandgfor","any","given","positive","Γ,","if","two","parameter","vectors\nare","distinct,","i.e.,β6=cθfor","anyc6=","0,","and","the","feature","vectorxspans","all","directions","inR\np\n.\nMore","concretely,","we","state","the","following","AssumptionA1:\nA1.Two","parameter","vectorsβandθin(1)are","linearly","independent.","","The","density","ofP\nX\nwith\nrespect","to","the","Lebesgue","measure","is","positive","everywhere.\nWe","have","the","following","result","about","the","identifiability","of","the","model","(3).\nTheorem","1.For","any","given","positiveΓand","under","AssumptionA1,","the","parameters(β,θ)in\nthe","model(3)are","identifiable.\nThe","","proof","","is","","based","","on","","constructing","","a","","set","","of","","observations","","(x\ni\n,z\ni\n)","","which","","distinguish","","the\nlikelihoods","","evaluated","","at","","different","","parameter","","values,","","and","","is","","deferred","","to","","the","","Supplementary\nMaterial.\nChoice","ofΓ(·).The","next","question","is","how","to","choose","the","label","observation","probability","Γ(y).\nOne","of","the","determining","factors","is","that","the","integral","in","(4)","needs","to","be","computable","and","Γ(y)","also\nneeds","to","be","monotonically","increasing.","Ifφdoes","not","have","an","analytical","form,","approximation","of\nthe","function","via","a","numerical","integration","is","needed,","which","can","be","computationally","challenging.\n6\n\nHence","we","choose","Γ","to","be","the","cumulative","distribution","function","of","an","exponential","function","with\nparameterλ\n\u000f\n.","","In","other","words,","we","let\nΓ(y)",":=","1−exp(−λ\n\u000f\ny).(5)\nWe","first","note","that","Γ","is","a","monotonically","increasing","function","iny.","","Therefore,","events","of","larger\nmagnitudes","","are","","more","","likely","","to","","be","","observed","","without","","noise.","","","This","","choice","","of","","Γ","","also","","allows","","a\nclosed-form","expression","forφ(·).","","More","concretely,","we","have","the","following","representation","ofφ:\nφ(x;β,Γ)","=\n∫\n∞\n0\n(1−e\n−λ\n\u000f\ny\n)e\n−x\n>\nβ\ne\n−ye\n−x\n>\nβ\ndy\n=\nλ\n\u000f\nλ\n\u000f\n+e\n−x\n>\nβ\n.\n(6)\nNote","","thatφ(x;β,Γ)","","is","","a","","function","","ofβandλ\n\u000f\nwhere","","the","","hyperparameterλ\n\u000f\ncontrols","","the\nextent","to","which","the","labelsYare","missing.\nOur","estimation","method","is","defined","as","the","maximizer","of","the","log-likelihood","(3)","with","Γ","and\nφin","","(5)","","and","","(6).","","","We","","use","","the","","name","","PU-OMM","","to","","refer","","to","","our","","method,","","which","","stands","","for\nPositive-Unlabeled","Occurrence","Magnitude","Mixture.\n2.3","","","","Algorithm\nGiven","data","(x\ni\n,z\ni\n)","fori=","1,...,n,","the","objective","function","is\n̂ω∈argmin\nω∈B\n2\n(r)\nL\nn\n(ω)",":=−\n1\nn\nn\n∑\ni=1\n`(ω;","(x\ni\n,z\ni\n)),(7)\nwhereω:=","(β,θ),","and`(ω;","(x\ni\n,z\ni\n))","is","theith","component","of","the","likelihood","in","(3)","using","theφ\nspecified","in","(6):\n`(ω;","(x\ni\n,z\ni\n))",":=\n1{z\ni\n=","0}{log","(1−φ(x\ni\n;β)p\n1\n(x\ni\n;θ))}+1{z\ni\n>0}{logg(z\ni\n|x\ni\n;β)","+","logp\n1\n(x\ni\n;θ)}.\nWe","also","define","the","population","risk","functionR(ω)",":=E[L\nn\n(ω)]","and","defineω\n0\n:=","(β\n0\n,θ\n0\n)","as\nthe","minimizer","ofR(ω).","","We","let","the","search","spaceB\n2\n(r)","be","an`\n2\nball","with","a","radiusr,","for","a\nsufficiently","larger",">0","so","thatω\n0\nis","feasible.\nTo","optimize","(7),","we","propose","to","use","the","standard","projected","gradient","descent","(projected","to\n7\n\nB\n2\n(r)).","","We","will","show","in","Theorem","2","and","3","that","it","is","feasible","to","obtain̂ωin","(7)","despiteL\nn\n(ω)\nbeing","non-convex,","and","the","convergence","of","iterates{ω\nt\n}\nt≥1\nin","Algorithm","1","is","linear","given","a\nsufficiently","large","sample","size.\nAlgorithm","1:Projected","Gradient","Descent\nInput:Data","(x\ni\n,z\ni\n)\nn\ni=1\n,","step","sizeη,","initial","pointω\n0\n,","hyperparameterλ\n\u000f\n,","search\nspace","radiusr\nfort=","1,2,3,...do\nω\nt+1\n=P\nB\n2\n(r)\n(ω\nt\n−ηOL\nn\n(ω\nt\n));\nifconvergedthen\nSTOP\nend\nend\nIn","practice,","we","fit","the","model","using","Algorithm","1","over","a","grid","ofλ\n\u000f\nvalues.","","We","chose","the\nvalue","","ofλ\n\u000f\nwhich","","results","","in","","the","","best","","fit","","for","","the","","observed","","occurrence","","(See","","Implementation\nDetails","in","Section","4","for","more","details).","","We","empirically","observed","very","good","estimation","and\nprediction","performances","of","our","model","by","choosing","the","hyperparameter","in","this","way,","","where\nin","many","cases","the","performances","of","the","models","with","the","chosenλ\n\u000f\ns","were","comparable","to","the\nmodels","with","the","trueλ\n\u000f\nvalues.\n3","","","","Theoretical","Guarantees\nThroughout","this","section,","we","assume","that","Γ(t)","=","1−exp(−λ\n\u000f\nt)","is","given.","","We","first","introduce\na","set","of","conditions","for","the","response","variable,","feature","vector,","and","the","degree","of","missingness,\nunder","which","we","prove","algorithmic","and","statistical","convergence.\nA2.(Random","","design)","","A","","random","","feature","","vectorx∈R\np\nwith","","distributionP\nX\nis","","mean-zero\nsub-Gaussian","with","parameterK\nX\nfor","a","positive","constantK\nX\n<∞.","","In","other","words,","for","any\nfixed","unit","vectorv∈R\np\n,","we","have\nE[exp(x\n>\nv)\n2\n/K\n2\nX\n]≤2.\nMoreover,","there","existsC\nλ\n>0such","thatλ\nmin\n(E[xx\n>\n])≥C\nλ\n.\nA3.(Boundedness)","","There","","exist","","constantsC\nX\n,C\nY\n<∞such","","that","","for","","the","","random","","feature\nx∈R\np\nand","","response","","variabley∼p\nY\n(·|x;","(β\n0\n,ω\n0\n)),‖x‖\n2\n≤C\nX\nand|y/e\nx\n>\nβ\n0\n|","≤C\nY\nalmost\nsurely.\n8\n\nAssumption","","2","","is","","a","","mild","","assumption","","on","","the","","feature","","vectorxwhich","","states","","thatxhas\na","light","probability","tail","and","the","smallest","eigenvalue","of","the","population","covariance","matrix","is\nlower-bounded","","by","","a","","positive","","constant.","","","The","","boundedness","","condition","","is","","assumed","","mainly","","for\nthe","technical","convenience","and","states","that","bothxand","the","deviation","ofyfrom","its","mean","are\nabsolutely","bounded,","where","we","recall","thatE[Y|Y",">0,x]","=e\nx\n>\nβ\n0\n.\nA4.We","assume","the","following","condition","holds:\nmax\n1≤i≤n\n1−σ(x\n>\ni\nβ+","logλ\n\u000f\n)\n1−σ(x\n>\ni\nθ)\n≤r\n0\n(ω\n0\n,C\nX\n,r)(8)\nwherer\n0\nis","a","constant","depending","on","model","parametersω\n0\n=","(β\n0\n,θ\n0\n),C\nX\n,","andr.\nWe","give","the","full","expression","forr\n0\n(ω\n0\n,C\nX\n,r)","in","the","Supplementary","Material","for","ease","of\nexposition.","","","We","","recall","","thatλ\n\u000f\n=∞corresponds","","to","","“no","","missingness”","","where","","ally\ni\nare","","the\nsame","asz\ni\nsince","Γ(y)","=","1,∀y.","","The","equation","(8)","trivially","holds","in","this","case.","","AssumptionA4\nessentially","states","that","albeitλ\n\u000f\n<∞,λ\n\u000f\nis","sufficiently","large","so","that","(8)","holds.","","Assumption\nA4ensures","there","exists","sufficient","signal","in","the","data","to","estimate","both","parametersβandθ.\nUnder","the","stated","assumptions,","we","first","show","that","the","population","risk","functionR(ω)","has\nno","other","stationary","point","thanω\n0\ninB\n2\n(r)","for","a","sufficiently","large","radiusrto","includeω\n0\n.\nProposition","","1.Suppose","","AssumptionsA1-A4hold.","","","Then","","for","","anyω∈B\n2\n(r)withr≥\n2‖ω\n0\n‖\n2\n,","we","have,\n〈OR(ω),ω−ω\n0\n〉≥α‖ω−ω\n0\n‖\n2\n2\n,(9)\nwhere","the","expectation","is","evaluated","at","the","true","parameterω\n0\n=","(β\n0\n,θ\n0\n)andα",">0is","a","positive\nconstant","depending","only","on","the","model","parameters.\nWe","defer","the","proof","of","this","strong","convexity","result","to","the","Supplementary","Material.","","The\nessential","step","of","the","proof","for","Proposition","1","is","careful","control","of","the","size","of","a","cross-product\nterm","which","arises","due","to","contamination","in","responses,","to","ensure","a","positive","curvature","ofR(ω)\nalongω−ω\n0\ndirections.\nAlthough","","the","","population","","risk","","functionR(ω)","","is","","non-convex,","","the","","inequality","","(9)","","ensures\nthat","","we","","can","","recoverω\n0\nby","","finding","","a","","stationary","","point","","ofR(ω).","","","Therefore,","","the","","population\nversion","","of","","the","","algorithm","","(7)","","is","","tractable.","","","Together","","with","","the","","uniform","","convergence","","of","","the\ngradientOL\nn\n(ω),","the","equation","(9)","immediately","gives","the","bound","for̂ωfor","anŷωsuch","that\n9\n\nOL\nn\n(̂ω)","=","0","since\n〈OR(̂ω),̂ω−ω\n0\n〉≤〈OL\nn\n(̂ω)−OL\nn\n(ω\n0\n),̂ω−ω\n0\n〉\n+","2","","","sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n‖̂ω−ω\n0\n‖\n2\n(10)\nand","therefore,\nα‖̂ω−ω\n0\n‖\n2\n2\n≤{‖OL\nn\n(ω\n0\n)‖\n2\n+","2a\nn\n}‖̂ω−ω\n0\n‖\n2\n,\nwherea\nn\n:=","sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n.","","The","rate","of","the","statistical","error","bound‖̂ω−ω\n0\n‖\nis","related","to","the","order","of","(random)‖OL\nn\n(ω\n0\n)‖\n2\nanda\nn\n.","","In","particular,","we","can","show","that","under\nAssumptionsA2","-","A4,","both","terms","are","of","an","order","of\n√\nplog(n)/n,","therefore","the","bound","we\nobtain","is","optimal","up","to","a","log","term.\nThe","following","two","theorems","provide","algorithmic","and","statistical","error","bounds.\nTheorem","","2.Under","","AssumptionsA1,-A4,","","ifn≥Cplogp,","","the","","empirical","","risk","","function\nL\nn\n(ω)admits","a","unique","local","minimizer","inB\n2\n(r)which","coincides","with","the","global","optimizer̂ω.\nIn","addition,","for","anyδ",">0,","the","following","inequality","holds","with","probability1−δ,\n‖̂ω−ω\n0\n‖\n2\n≤\nC\nα\n√\nC\n2\nY\nplog(n)","log(C\nY\n/δ)\nn\n(11)\nwhereC",">0is","a","constant","only","depending","on","model","parameters","andαis","the","constant","in(9)\nfrom","Proposition","1.\nTheorem","3.AssumeA1-A4hold.","","Ifn≥Cplogp,","for","any","initializationω\n0\n∈B\n2\n(r/2),\n‖ω\nt\n−̂ω‖\n2\n≤C\n1\nκ\nt\n‖ω\n0\n−̂ω‖\n2\n(12)\nforκ","<1,","whereC,C\n1\n>0are","constants","depending","on","model","parameters","(but","not","onn,p).\nThe","convergence","rate","in","(11)","nearly","matches","the","parametric","rate","of\n√\np/n.","","Also,","running\nthe","algorithm","1","efficiently","finds","the","optimum","of","(7),","in","the","sense","thatO(log(1/\u000f))","iterations\nare","needed","to","find","a","point","within","distance\u000fof","the","global","optimum̂ωof","the","objective","(7).\nExtension","to","the","high-dimensional","setting:It","is","worth","noting","that","the","theory","we\ndevelop","here","has","a","direct","generalization","to","the","high-dimensional","setting","wherep\u001dnand\n10\n\nwe","","assumeω\n0\niss-sparse,","","fors\u001cp.","","","A","","similar","","approach","","as","","in","","(10)","","can","","be","","used","","to","","ob-\ntain","","a","","statistical","","error","","bound","","of","","an`\n1\n-penalized","","M-estimator̂ω(λ),","","defined","","aŝω(λ)","",":=\nargminL\nn\n(ω)","+λ‖ω‖\n1\n,","","where","","we","","control","","the","","difference","","betweenL\nn\n(ω)","","andR(ω)","","over","","a\nrestricted","cone","includingB\n2\n(r)","(see,","for","instance,","Mei","et","al.,","2018)","or","equivalently","we","replace\nthe","strong","convexity","Proposition","with","restricted","strong","convexity","(Negahban","et","al.,","2012).\n4","","","","Simulation","Study\nWe","now","study","the","performance","of","the","proposed","method","and","compare","with","other","state-of-the-\nart","approaches","in","terms","of","parameter","estimation","accuracy","and","prediction","using","simulated\ndatasets","representing","a","number","of","scenarios.","","In","particular,","we","consider","the","following","three\nsettings","for","generating","simulated","datasets","where","in","the","first","setting","our","model","is","correctly\nspecified","and","in","the","others","different","mis-specifications","are","introduced:\n1.Correct","specification:the","size","of","an","eventY|(Y",">0,x)","is","generated","from","the","expo-\nnential","distribution","with","parameterλ\nX\n=","exp(−x\n>\nβ\n0\n).","","Missing","iny\ni\ns","are","probabilistic,\nwhose","probabilities","depend","ony\ni\nvia","Γ(y)","=","1−exp(−λ\n\u000f\ny)","forλ\n\u000f\n=.24\n2.Misspecification","","1:gis","","log-Normal","","instead","","of","","exponential,","","i.e.Y|(Y",">0,x)∼\nLogNormal(x\n>\ni\nβ\n0\n,I\np\n).\n3.Misspecification","2:missing","iny\ni\nis","deterministic","andy\ni\nbelow","a","certain","threshold\nis","recorded","to","be","zero,","i.e.z\ni\n=1{y\ni\n≥τ}for","a","thresholdτ=","3.\nData","Generation.We","first","generate","a","design","matrixX=","[x\n>\n1\n,...,x\n>\nn\n]\n>\nby","drawing","each\nx\ni\nfrom","","a","","multivariate","","Gaussian","","distributionN(0,Σ)","","where","","Σ\nij\n=","","0.2\n|i−j|\n.","","","We","","sample\ntwo","parameters","from","a","normal","distribution","centered","at","zero,","i.e.β\n0\n,θ\n0\n∼","N(0,9p\n−1\nI\np\n).","","We\nsample","the","true","unobserved","responsey\ni\nfrom","a","mixture","of","zero","and","a","continuous","distribution.\nTo","do","so,","we","first","draw","a","binaryu\ni\n∈{0,1}from","a","Bernoulli","distribution","whose","probability\ndepends","","onx\n>\ni\nθ\n0\nto","","simulate","","the","","occurrence","","of","","an","","event,","","i.e.u\ni\n∼Ber(p\n1\n(x\ni\n;θ\n0\n))","","where\np\n1\n(x\ni\n;θ\n0\n)","","=","","(1","+","exp(−x\n>\ni\nθ\n0\n))\n−1\n.","","","Ifu\ni\n=","","1,","","we","","draw","","the","","samplev\ni\nfrom","","a","","continuous\ndistributiong(·|x\ni\n;β\n0\n)","","for","","the","","size","","of","","an","","event.","","","Depending","","on","","the","","setting,gis","","set","","to","","be\nExponential","(Settings","1","and","3)","or","Lognormal","(Setting","2).","","We","let","true","responsesy\ni\nto","be","0","if\nu\ni\n=","0","andy\ni\n=v\ni\notherwise.\nNext,","we","sampler\ni\n∈{0,1}to","determine","whether","eachy\ni\nis","missing","or","not.","","Depending","on\nthe","setting,","Γ(y)","=P(R=","1|y)","=","1−e\n−λ\n\u000f\ny\nforλ\n\u000f\n=.24","(Settings","1","and","2)","or","Γ(y)","=1{y\ni\n≥τ}\n11\n\nforτ=","3","(Setting","3).","","The","observed","responsez\ni\nis","set","to","bez\ni\n=y\ni\nr\ni\nso","that","ifr\ni\n=","1,","then\nz\ni\n=y\ni\nand","ifr\ni\n=","0,","thenz\ni\n=","0.\nFor","each","simulation","trialb=","1,...,B=","50,","the","final","datasets","include","(x\ni\n,z\ni\n)\nn\ni=1\nfor","the\ntraining","dataset","and","(x\ni\n,z\ni\n)\nn\ntest\ni=1\nfor","the","test","dataset.","","We","additionally","keepy\ni\nvalues","in","the\ntraining","and","test","datasets","for","the","purpose","of","fitting","an","oracle","model","(with","no","missing","iny\ni\n)\nfor","comparison,","and","validate","prediction","performances","for","thetrue","responses.","","We","letp=","10\nand","varynfrom","5000","to","30000","for","a","training","set,","and","letn\ntest\n=","50000","for","a","test","set","for","the\naccurate","evaluation","of","trained","models.\nMethods.\n1.","","Oracle:","","two","GLMs","(Logistic,","Exponential)","using","(x\ni\n,y\ni\n)\nn\ni=1\nwherey\ni\nwith","fully","labelled\nresponses.\n2.","","Proposed","method","(PU-OMM):","our","proposed","method.\n3.","","Logistic-Gamma","mixture","model","(Logistic-Gamma):","","we","fit","two","separate","GLMs","using\n(x\ni\n,z\ni\n)\nn\ni=1\n,","one","for","the","occurrence","and","the","other","for","the","size","of","the","event","using","logistic\nand","Gamma","distributions\n4.","","Logistic-LogNormal","mixture","model","(Logistic-LogNormal):","","Gamma","distribution","is","re-\nplaced","with","log-normal","distribution","in","3.\nEvaluation","Metrics.We","evaluate","both","parameter","estimation","accuracy","forβ\n0\n,θ\n0\nand","pre-\ndiction","accuracy","for","estimated","occurrence","and","size","of","true","events.","","For","parameter","estimation\naccuracy,","We","compute","Root","Mean","Squared","Errors","(RMSE)","for","each","estimated","(\n̂\nβ,\n̂\nθ):\n•RMSE(beta):=‖\n̂\nβ−β\n0\n‖\n2\n•RMSE(theta):=‖\n̂\nθ−θ\n0\n‖\n2\nWe","","also","","evaluate","","the","","prediction","","accuracy","","of","","each","","model","","in","","terms","","of","","predicting","","both\noccurrence","and","size","of","thetrueevents.","","For","predicting","occurrence","of","an","event,","","we","use","the\nfollowing","two","metrics:\n•BrierLoss(u,\n̂\np):=\n1\nn\ntest\n∑\nn\ntest\ni=1\n(̂p\ni\n−u\ni\n)\n2\n•Misclassification(u,\n̂\np):=\n1\nn\ntest\n∑\nn\ntest\ni=1\n1{1{̂p\ni\n>0.5}6=u\ni\n}\nwhereu∈R\nn\ntest\nis","a","vector","of","indicator","variables","where","eachu\ni\n:=1{y\ni\n>0}represents","the\noccurrence","of","an","event,","and̂p\ni\nis","a","predicted","probability","for","the","occurrence","ofith","observation\nfrom","each","model.\n12\n\nFor","predicting","the","magnitude","of","an","event,","we","use","Mean","Absolute","Deviation","(MAD),","root\nmean","","squared","","error","","(RMSE),","","and","","Symmetric","","Mean","","Absolute","","Percentage","","Error","","(SMAPE)\nfor","prediction","evaluation","metrics.","","SMAPE","is","considered","to","evaluate","prediction","performance\nalso","in","a","relative","scale,","as","results","of","MAD","and","RMSE","can","be","affected","by","a","few","observations\nwith","large","errors","(Chen","et","al.,","2017).","","MAD,","RMSE,","and","SMAPE","between","realized","values\ny∈R\nn\ntest\nand","predicted","values\n̂\ny∈R\nn\ntest\nare","computed","as","follows:\n•MAD(y,\n̂\ny):=\n1\nn\ntest\n∑\nn\ntest\ni=1\n|y\ni\n−̂y\ni\n|\n•RMSE(y,\n̂\ny):=\n√\n1\nn\ntest\n∑\nn\ntest\ni=1\n(y\ni\n−̂y\ni\n)\n2\n•SMAPE(y,\n̂\ny):=\n1\nn\ntest\n∑\nn\ntest\ni=1\n2|y\ni\n−̂y\ni\n|\n|y\ni\n|+|̂y\ni\n|\nwhere","ˆy\ni\nis","the","predicted","value","from","each","model","for","the","size","of","an","event","of","theith","observation\nin","a","test","dataset.\nImplementation","","Details.PU-OMM","","is","","fitted","","over","","a","","grid","","of","","20λ\n\u000f\nvalues","","from","","1/50","","to\n50","which","are","linearly","spaced","on","a","log","scale.","","For","each","value","ofλ\n\u000f\n,","the","objective","(7)","for","the\nproposed","method","is","minimized","via","the","projected","gradient","descent","method","in","Algorithm","1,\nwhere","we","letr=","5\n√\npfor","the","radius","of","the","search","region.","","A","backtracking-Armijo","linesearch\nis","performed","at","each","iteration","to","ensure","a","sufficient","decrease","(Beck,","2017).\nOnce","","we","","have","","20","","fitted","","models,","","we","","chose","","the","","bestλ\n\u000f\nbased","","on","","goodness","","of","","fit","","for","","the\nobserved","","occurrence.","","","More","","concretely,","","we","","choseλ\n\u000f\nat","","the","","value","","where","","the","","fitted","","model\nminimizes","the","Brier","Loss","for","the","observed","occurrences","in","the","training","dataset,","i.e.\n̂\nλ\n\u000f\n:=argmin\nλ∈{1/50,...,50}\nBrierLoss(v,\n̂\nq(λ))\nwherev∈","{0,1}\nn\nis","a","vector","of","the","observed","occurrences","in","the","training","dataset,","i.e.v\ni\n:=\n1{z\ni\n>0},","and̂q(λ)\ni\nis","the","predicted","probability","for","the","observed","occurrence1{z\ni\n>0}with\nλ\n\u000f\n=λ.\nResults.Figure","1","presents","estimation","and","prediction","accuracy","for","each","method","under","Set-\ntings","1-3.","","We","plot","results","using","SMAPE","and","BrierLoss","in","Figure","1","for","prediction","evaluation\nand","","defer","","the","","remaining","","plots","","to","","the","","Supplementary","","Material.","","","Unsurprisingly,","","the","","oracle\nestimator","performs","the","best.","","Among","non-oracle","methods,","the","proposed","method","appears","to\nperform","the","best","in","both","correctly","specified","and","misspecified","settings,","even","when","the","hyper-\nparameterλ\n\u000f\nis","chosen","based","on","the","data.","","In","fact,","the","difference","between","the","two","PU-OMM\n13\n\nFigure","1:","","Parametric","estimation","and","prediction","accuracy","for","each","method","under","Settings","1-3","(Cor-\nrectly","Specified,","Misspecification","1,","and","Misspecification","2).","","Each","rowicorresponds","to","the","Setting\ni,","","fori=","1,2,3.","","For","each","row,","","first","two","panels","(RMSE","(beta),","","RMSE","(theta))","show","parameter\nestimation","accuracy","results,","and","the","last","two","panels","(SMAPE","(size),","BrierLoss","(occurrence))","plot\nthe","accuracy","of","each","method","in","predicting","the","true","size","and","occurrence","of","each","observation","in","test\ndatasets.","","Average","values","fromB=","50","trials","are","plotted,","together","with","error","bars","corresponding\nto","","one","","standard","","error.","","","Note","","for","","the","","Logistic-Gamma","","and","","Logistic-LogNormal","","Mixture","","models,\nthe","logistic","model","is","used","to","predict","the","occurrence","of","events,","","and","Gamma/LogNormal","model","is\nused","to","predict","the","magnitudes","of","events.","","Therefore,","our","PU-OMM","model","is","compared","with","the\nGamma/LogNormal","models","in","RMSE","(beta)","and","SMAPE","(size)","panels,","and","PU-OMM","is","compared\nwith","the","Logistic","model","in","RMSE","(theta)","and","BrierLoss","(occurrence)","panels.\nmodels–one","based","on","the","trueλ\n\u000f\nvalue","and","the","other","based","on","the","choice","from","data–was\nquite","small.","","We","also","include","a","comparison","plot","between","the","two","PU-OMM","models","in","the\nSupplementary","Material.\n5","","","","California","Wildfire","Data\n5.1","","","","California","Wildfire","Dataset\nWe","use","a","global","wildfire","dataset","from","Art","́es","et","al.","(2019)","to","obtain","observed","fire","events","in\nCalifornia","from","2001","to","2018.","","The","database","Art","́es","et","al.","(2019)","includes","fire","events–sets","of\n14\n\nburnt","areas","that","are","connected","by","touching","or","intersecting–together","with","fire","perimeters","and\nthe","final","dates","of","the","fire","events.","","We","obtain","fire","sizes","by","computing","areas","of","fire","events","based\non","fire","perimeters.\n75%","of","the","observed","fires","have","sizes","ranging","from",".19km\n2\nto","1.33km\n2\n,","whereas","the","smallest\nwas.0003","km\n2\nand","the","largest","was","1083.82","km\n2\n.","","More","importantly,","most","of","the","fires","whose\nsizes","are","below","1km\n2\nare","not","present","in","the","dataset.","","Since","we","expect","there","would","be","more\nsmall","fires","than","large","fires,","it","is","likely","that","fires","smaller","than",".19km\n2\nare","not","recorded","due","to\nthe","limitations","in","data","collection","and","processing","accuracy.\nGiven","the","lack","of","small","fires","in","the","database,","we","additionally","sampled","points","from","places\nwith","no","observed","fires.","","To","be","more","specific,","for","each","year,","we","uniformly","sampled","the","same\nnumber","of","points","as","the","observed","fires","from","the","map","of","California","excluding",".1","degree","buffered\nfire","events.","","We","augmented","the","fire","events","dataset","from","Art","́es","et","al.","(2019)","by","adding","these\npoints","where","the","fire","sizes","corresponding","to","these","points","are","set","to","be","zero.\nWe","also","incorporated","information","on","meteorological,","topographical,","geographical","aspects\nof","each","sampled","location.","","Specifically,","we","included","elevation,","slope,","aspect,","dissection,","heat\nload","index,","topographic","position","index,","and","terrain","ruggedness","index","from","the","STRM","90m\nresolution","","data","","(Jarvis","","et","","al.,","","2008)","","for","","topography-related","","variables,","","daily","","temperature,\nprecipitation,","","relative","","humidity,","","and","","vapour-pressure","","deficit","","(VPD)","","from","","ERA-interim","","re-\nanalysis","data\n2\n,","and","population","density,","distance","to","the","closest","high","population","density","area,\nand","","distance","","to","","the","","closest","","low","","population","","density","","area","","from","","Gridded","","Population","","of","","the\nWorld","(GPW)","(CIESIN,","2017).","","The","final","dataset","has","dimensions","(n,p)","=","(15846,43).\n5.2","","","","Results\nPrediction","AccuracyAll","of","the","models","are","trained","based","on","a","training","dataset","and","tested\non","the","remaining","hold-out","set.","","For","eachb=","1,...,B=","100,","we","randomly","split","the","dataset\ninto","90/10","subsamples","and","assigned","90%","of","the","subsamples","to","a","training","dataset","and","the\nremaining","10%","of","the","subsamples","to","a","testing","dataset.\nUnlike","the","simulated","study,","truey\ni\nare","unavailable,","and","thus","validation","needs","to","be","based\non","the","observedz\ni\n.","","We","compute","predicted̂z\ni\nusing","fitted","models.","","In","particular,","MAD(z,\n̂\nz),\nRMSE(z,\n̂\nz),","","and","","SMAPE(z,\n̂\nz)","","are","","computed","","based","","on","","the","","observedz\ni\nand","","predicted̂z\ni\n.\nFigure","","2","","plots","","computed","","MAD,","","RMSE,","","and","","SMAPE","","from","","various","","models","","fromBtrials.\nIt","","appears","","that","","the","","proposed","","PU-OMM","","method","","performs","","the","","best,","","followed","","by","","Logistic-\n2\navailable","at","https://www.ecmwf.int/en/forecasts/datasets","/reanalysis-datasets/era-interim\n15\n\nFigure","","2:","","","Prediction","","performance","","comparison","","for","","PU-OMM,","","Logistic-Gamma,","","and","","Logistic-\nLogNormal","","models","","with","","the","","California","","Wildfire","","dataset.","","","Average","","MAD,","","RMSE,","","and","","SMAPE\nvalues","are","plotted","for","each","method.","","Error","bars","represent","1","standard","error.\nGamma,","and","then","followed","by","Logistic-LogNormal","model.\n6","","","","Discussion","and","Conclusion\nIn","this","paper,","we","developed","a","general","statistical","framework","PU-OMM","which","addresses","oc-\ncurrence","and","magnitude","prediction","when","we","have","response-dependent","missing","labels.","","We\nprove","that","our","approach","achieves","optimal","statistical","error","up","to","a","log","factor,","even","though\nthe","","likelihood","","loss","","is","","non-convex.","","","Moreover,","","we","","also","","showed","","that","","our","","projected","","gradient\ndescent","algorithm","achieves","linear","convergence","to","a","stationary","point","of","the","objective.","","Also","as\ndiscussed","in","Section","3,","our","framework","and","statistical","and","algorithmic","guarantees","have","direct\ngeneralization","to","the","high-dimensional","setting.\nOur","","flexible","","framework","","can","","be","","generalized","","to","","other","","response-dependent","","missing","","labels\nsettings","","where","","the","","missing","","mechanism","","is","","a","","stochastic","","function","","of","","the","","response","","values","","but\nwith","different","models","of","the","occurrence-magnitude","mixture","response.","","This","extra","flexibility\ncomes","with","statistical","and","algorithmic","challenges","such","as","computing","the","integral","required\nfor","the","log-likelihood","and","providing","guarantees","for","the","non-convex","objective.","","Adapting","this\nframework","to","other","missing","labels","settings","remains","an","open","challenge.\n16\n\nReferences\nTom`as","Art","́es,","Duarte","Oom,","Daniele","de","Rigo,","Tracy","Houston","Durrant,","Pieralberto","Maianti,\nGiorgio","Libert`a,","and","Jes","́us","San-Miguel-Ayanz.","","A","global","wildfire","dataset","for","the","analysis\nof","fire","regimes","and","fire","behaviour.Sci","Data,","6(1):296,","November","2019.\nAmir","Beck.First-Order","Methods","in","Optimization.","","SIAM,","October","2017.\nChao","Chen,","Jamie","Twycross,","and","Jonathan","M","Garibaldi.","","A","new","accuracy","measure","based\non","bounded","relative","error","for","time","series","forecasting.PLoS","","One,","12(3):e0174202,","March\n2017.\nCIESIN.","","Gridded","population","of","the","world,","version","4","(gpwv4):","","Population","density,","revision\n11,","2017.\nJohn","G","Cragg.","","Some","statistical","models","for","limited","dependent","variables","with","application","to\nthe","demand","for","durable","goods.Econometrica,","39(5):829–844,","1971.\nMarthinus","Du","Plessis,","Gang","Niu,","and","Masashi","Sugiyama.","","Convex","formulation","for","learning\nfrom","positive","and","unlabeled","data.","InInternational","Conference","on","Machine","Learning,","pages\n1386–1394,","June","2015.\nCharles","Elkan","and","Keith","Noto.","Learning","classifiers","from","only","positive","and","unlabeled","data.","In\nProceedings","of","the","14th","ACM","SIGKDD","International","Conference","on","Knowledge","Discovery\nand","Data","Mining,","KDD","’08,","pages","213–220,","New","York,","NY,","USA,","2008.","ACM.\nA","Elsener","and","S","van","de","Geer.","","Sharp","oracle","inequalities","for","stationary","points","of","nonconvex\npenalized","M-Estimators.IEEE","Trans.","Inf.","Theory,","65(3):1452–1472,","March","2019.\nAlexander","M","Franks,","Edoardo","M","Airoldi,","and","Donald","B","Rubin.","","Nonstandard","conditionally\nspecified","models","for","nonignorable","missing","data.Proc.","Natl.","Acad.","Sci.","U.","S.","A.,","117(32):\n19045–19053,","August","2020.\nHimanshu","Jain,","Yashoteja","Prabhu,","and","Manik","Varma.","","Extreme","multi-label","loss","functions\nfor","recommendation,","tagging,","ranking","&","other","missing","label","applications.","","InProceedings\nof","","the","","22nd","","ACM","","SIGKDD","","International","","Conference","","on","","Knowledge","","Discovery","","and","","Data\nMining,","","KDD","","’16,","","pages","","935–944,","","New","","York,","","NY,","","USA,","","August","","2016.","","Association","","for\nComputing","Machinery.\n17\n\nAndy","","Jarvis,","","Hannes","","I","","Reuter,","","Andy","","Nelson,","","Edward","","Guevara,","","and","","Others.","","","Hole-filled\nSRTM","for","the","globe","version","4,","available","from","the","CGIAR-CSI","SRTM","90m","database,","2008.\nRoderick","","J","","A","","Little","","and","","Donald","","B","","Rubin.Statistical","","Analysis","","with","","Missing","","Data.","","","John\nWiley","&","Sons,","April","2019.\nB","","Liu,","","Y","","Dai,","","X","","Li,","","W","","S","","Lee,","","and","","P","","S","","Yu.","","","Building","","text","","classifiers","","using","","positive","","and\nunlabeled","","examples.","","","InThird","","IEEE","","International","","Conference","","on","","Data","","Mining,","","pages\n179–186,","November","2003.\nPo-Ling","Loh","and","Martin","J","Wainwright.","High-dimensional","regression","with","noisy","and","missing\ndata:","","Provable","guarantees","with","nonconvexity.Ann.","Stat.,","40(3):1637–1664,","June","2012.\nWei","Ma","and","George","H","Chen.","Missing","not","at","random","in","matrix","completion:","","The","effectiveness\nof","estimating","missingness","probabilities","under","a","low","nuclear","norm","assumption.","InAdvances\nin","Neural","Information","Processing","Systems","32,","pages","14900–14909.","Curran","Associates,","Inc.,\n2019.\nSong","Mei,","Yu","Bai,","and","Andrea","Montanari.","","The","landscape","of","empirical","risk","for","nonconvex\nlosses.Ann.","Stat.,","46(6A):2747–2774,","December","2018.\nKarthika","Mohan","and","Judea","Pearl.","","Graphical","models","for","processing","missing","data.","","January\n2018.\nGeert","Molenberghs,","Garrett","Fitzmaurice,","Michael","G","Kenward,","Anastasios","Tsiatis,","and","Geert\nVerbeke.Handbook","of","missing","data","methodology.","","CRC","Press,","2014.\nBrian","Neelon,","A","James","O’Malley,","and","Valerie","A","Smith.","","Modeling","zero-modified","count","and\nsemicontinuous","data","in","health","services","research","part","1:","","background","and","overview.Stat.\nMed.,","35(27):5070–5093,","November","2016.\nSahand","","N","","Negahban,","","Pradeep","","Ravikumar,","","Martin","","J","","Wainwright,","","and","","Bin","","Yu.","","","A","","unified\nframework","for","High-Dimensional","analysis","ofM-Estimators","with","decomposable","regulariz-\ners.Stat.","Sci.,","27(4):538–557,","November","2012.\nMaren","K","Olsen","and","Joseph","L","Schafer.","A","Two-Part","Random-Effects","model","for","semicontinuous\nlongitudinal","data.J.","Am.","Stat.","Assoc.,","96(454):730–745,","June","2001.\nDonald","B","Rubin.","Characterizing","the","estimation","of","parameters","in","Incomplete-Data","problems.\nnull,","69(346):467–474,","June","1974.\n18\n\nErik","","Schultheis,","","Mohammadreza","","Qaraei,","","Priyanshu","","Gupta,","","and","","Rohit","","Babbar.","","","Unbiased\nloss","functions","for","extreme","classification","with","missing","labels.","","July","2020.\nValerie","A","Smith,","John","S","Preisser,","Brian","Neelon,","and","Matthew","L","Maciejewski.","A","marginalized\ntwo-part","model","for","semicontinuous","data.Stat.","Med.,","33(28):4891–4903,","December","2014.\nJames","Tobin.","Estimation","of","relationships","for","limited","dependent","variables.Econometrica,","26\n(1):24–36,","1958.\nRoman","Vershynin.High-Dimensional","Probability","by","Roman","Vershynin.","","Cambridge","Univer-\nsity","Press,","September","2018.\nZhuoran","Yang,","Zhaoran","Wang,","Han","Liu,","Yonina","C","Eldar,","and","Tong","Zhang.","Sparse","nonlinear\nregression:","","Parameter","estimation","and","asymptotic","inference.","","November","2015.\nJiwei","Zhao","and","Jun","Shao.","","Semiparametric","Pseudo-Likelihoods","in","generalized","linear","models\nwith","nonignorable","missing","data.J.","Am.","Stat.","Assoc.,","110(512):1577–1590,","October","2015.\n19\n\nSUPPLEMENTARY","MATERIAL\nA","","","","Proofs\nA.1","","","","Proof","of","Theorem","1\nFor","any","given","Γ>0,","we","show","thatg(t|x;β)Γ(t)p\n1\n(x;θ)","=g(t|x;\n","̃\nβ)Γ(t)p\n1\n(x;\n","̃\nθ)","for","allt∈R\nandx∈R\np\nimpliesβ=\n","̃\nβandθ=\n","̃\nθ.\ng(t|x;β)Γ(t)p\n1\n(x;θ)","=g(t|x;\n","̃\nβ)Γ(t)p\n1\n(x;\n","̃\nθ)\n⇔logg(t|x;β)","+","logp\n1\n(x;θ)","=","logg(t|x;\n","̃\nβ)","+","logp\n1\n(x;\n","̃\nθ),\nfor","allt",">0","andx∈R\np\n.\nNote","that","logg(t|x;β)","and","logp\n1\n(x;θ)","is","a","function","ofx\n>\nβandx\n>\nθ,","since","logg(t|x;β)","=\n−x\n>\nβ−exp(−x\n>\nβ)tand","logp\n1\n(x;θ)","=x\n>\nθ−log(1","+","exp(x\n>\nθ)).","","For","anyt",">0,","we","have,\n−x\n>\nβ−exp(−x\n>\nβ)t+x\n>\nθ−log(1","+","exp(x\n>\nθ))","=−x\n>\n","̃\nβ−exp(−x\n>\n","̃\nβ)t+x\n>\n","̃\nθ−log(1","+","exp(x\n>\n","̃\nθ))\n(13)\nFrom","(13),","we","want","to","conclude","thatβ=\n","̃\nβandθ=\n","̃\nθ.","","First,","we","lett=","0","to","obtain,\nx\n>\n(θ−β)−log(1","+","exp(x\n>\nθ))","=x\n>\n(\n","̃\nθ−\n","̃\nβ)−log(1","+","exp(x\n>\n","̃\nθ))\nLetα\n1\n=θ−β,α\n2\n=θ.","","","Obtain{α\nj\n}\n3≤j≤p\nsuch","","thatA:=","","[α\n1\n,α\n2\n,...,α\np\n]∈R\np×p\nbe\nan","","invertible","","matrix.","","","Defineδ\n1\n=A\n−1\n(\n","̃\nθ−\n","̃\nβ),δ\n2\n=A\n−1\n","̃\nθ.","","","For","","anyxandu:=A\n>\nx=\n[u\n1\n,...,u\np\n]\n>\n∈R\np\n,\nu\n1\n−log(1","+","exp(u\n2\n))","=u\n>\nA\n−1\n(\n","̃\nθ−\n","̃\nβ)−log(1","+","exp(u\n>\nA\n−1\n","̃\nθ))\n=u\n>\nδ\n1\n−log(1","+","exp(u\n>\nδ\n2\n)).\nWe","choose{x\n(j)\n}\n1≤j≤p\nso","that","for","eachx\n(j)\n,u\n(j)\nj\n=A\n>\nx\n(j)\nj\n6=","0,u\n(j)\nk\n=A\n>\nx\n(j)\nk\n=","0,∀k6=j.\nForj=","1","and","anys6=","0,","we","have,\nsu\n(1)\n1\n−log(2)","=su\n(1)\n1\nδ\n11\n−log(1","+","exp(su\n(1)\n1\nδ\n21\n))(14)\n20\n\nViewing","(14)","as","a","function","ofs,","we","conclude","thatδ\n11\n=","1,δ\n21\n=","0.","","Similarly,","forj=","2,\n−log(1","+","exp(su\n(2)\n2\n))","=su\n(2)\n2\nδ\n12\n−log(1","+","exp(su\n(2)\n2\nδ\n22\n))\nand","obtainδ\n12\n=","0,δ\n22\n=","1.","","Forj≥3,","we","have,\n−log(2)","=su\n(j)\n2\nδ\n1j\n−log(1","+","exp(su\n(j)\n2\nδ\n2j\n)),\nthusδ\n1j\n=δ\n2j\n=","0,∀j≥3.","","In","other","words,δ\n1\n=e\n1\n,δ\n2\n=e\n2\nwheree\nj\nis","thejth","canonical\nbasis","vector.","","From","the","definition","ofδ\n1\nandδ\n2\n,","we","have,\n","̃\nθ−\n","̃\nβ=Aδ\n1\n=Ae\n1\n=θ−βand\n","̃\nθ=Aδ\n2\n=Ae\n2\n=θ.","","Therefore","we","conclude","thatθ=\n","̃\nθ,β=\n","̃\nβ.\nA.2","","","","Derivation","of","the","Likelihood\nLerR∈{0,1}be","a","binary","random","variable","such","thatR|(X=x,Y=y)∼Ber(Γ(y))","for","a\ncontinuous","Γ","supported","on","[0,∞]","and","Γ(0)","=","0.","","OnR=","1,Z=Ya.s.,","and","onR=","0,","we\nletZ=","0.\nWe","first","compute","the","cdf","ofZ.","","First,","fort","<0,P(Z≤t|X=x)","=","0.","","For","anyt≥0,\nP(Z≤t|X=x)","=P(Z≤t,R=","0|X=x)","+P(Z≤t,R=","1|X=x)\n=P(Z≤t,R=","0|X=x)","+P(Y≤t,R=","1|X=x)\nWe","first","address","the","second","term.","","We","have,\nP(Y≤t,R=","1|X=x)","=\n∫\nt\n0\nP(R=","1|X=x,Y=y)p\nY\n(y|x)d(m+δ\n0\n)\n=P(R=","1|X=x,Y=","0)(1−p\n1\n(x;θ))\n+\n∫\nt\n0\nP(R=","1|X=x,Y=y)p\n1\n(x;θ)g(y|x;β)dy\nwherem+δ\n0\nis","the","Lebesgue","measureplusa","point","mass","at","zero.","","We","haveP(R=","1|X=\nx,Y=","0)","=","Γ(0)","=","0","andP(R=","1|X=x,Y=y)","=","Γ(y)","fory",">0.","","Therefore,\nP(Z≤t,R=","1|X=x)","=p\n1\n(x;θ)\n∫\nt\n0\nΓ(y)g(y|x;β)dy(15)\n21\n\nNow","we","address","the","first","term:\nP(Z≤t,R=","0|X=x)","=P(Z=","0,R=","0|X=x)","=P(R=","0|X=x).\nSince,\nP(R=","0|X=x)","=\n∫\n(0,∞]\nP(R=","0|X=x,Y=y)p\nY\n(y|x)d(m+δ\n0\n)\n=P(R=","0|Y=","0,X=x)(1−p\n1\n(x;θ))\n+\n∫\n(0,∞]\nP(R=","0|Y=y,X=x)p\n1\n(x;θ)g(y|x;β)dy\n=","1−p\n1\n(x;θ)","+\n∫\n(0,∞]\n{1−Γ(y)}p\n1\n(x;θ)g(y|x;β)dy\n={1−p\n1\n(x;θ)}+p\n1\n(x;θ)−p\n1\n(x;θ)\n∫\n(0,∞]\nΓ(y)g(y|x;β)dy,\nwe","have,\nP(Z≤t|X=x)","={1−p\n1\n(x;θ)}+p\n1\n(x;θ)−p\n1\n(x;θ)\n∫\n(0,∞]\nΓ(y)g(y|x;β)dy.(16)\nCombining","(15)","and","(16),","for","anyt≥0,\nP(Z≤t|X=x)","=","1−p\n1\n(x;θ)\n∫\n(0,∞]\nΓ(y)g(y|x;β)dy+p\n1\n(x;θ)\n∫\nt\n0\nΓ(y)g(y|x;β)dy\nand","therefore","the","conditional","pdf","ofZ(with","respect","tom+δ\n0\n)","is\nf\nZ\n(t|x)","=δ\n0\n(t){1−p\n1\n(x;θ)\n∫\n(0,∞]\nΓ(y)g(y|x;β)dy}+1{t",">0}g(t|x;β)Γ(t)p\n1\n(x;θ).\nA.3","","","","Proof","of","Proposition","1\nLetω=","(β,θ)∈B\n2p\n2\n(r)","be","given.","","We","letU\ni\n:=1[Z\ni\n>0]","andu\ni\nbe","a","realization","ofU\ni\n.","","From\nthe","equation","below","(7)","in","the","main","text,\n`(ω;","(x\ni\n,z\ni\n))","=","(1−u\ni\n)","log\n(\n1−σ(x\n>\ni\nβ+","logλ\n\u000f\n)σ(x\n>\ni\nθ)\n)\n+u\ni\n{\n−exp(−x\n>\ni\nβ)z\ni\n−x\n>\ni\nβ+","logσ(x\n>\ni\nθ))\n}\n=u\ni\nlogσ(x\n>\ni\nθ)","+","(1−u\ni\n)","log\n(\n1−σ(x\n>\ni\nβ+","logλ\n\u000f\n)σ(x\n>\ni\nθ)\n)\n−u\ni\n{e\n−x\n>\ni\nβ\nz\ni\n+x\n>\ni\nβ},\n22\n\nsince\nφ(x;β,Γ)","=\n∫\n∞\n0\n(1−e\n−λ\n\u000f\ny\n)λ\nX\ne\n−yλ\nX\ndy=","1−\nλ\nX\nλ\nX\n+λ\n\u000f\n=\nλ\n\u000f\ne\nx\n>\nβ\nλ\n\u000f\ne\nx\n>\nβ\n+","1\n=σ(x\n>\nβ+","logλ\n\u000f\n),\nwhereλ\nX\n=e\n−x\n>\nβ\n.\nWe","add","and","subtractu\ni\nlogσ(x\n>\ni\nβ+","logλ\n\u000f\n)","to","have,\n`(ω;","(x\ni\n,z\ni\n))","=u\ni\nlogσ(x\n>\ni\nθ)σ(x\n>\ni\nβ+","logλ\n\u000f\n)","+","(1−u\ni\n)","log\n(\n1−σ(x\n>\ni\nβ+","logλ\n\u000f\n)σ(x\n>\ni\nθ)\n)\n−u\ni\n(e\n−x\n>\ni\nβ\nz\ni\n+x\n>\ni\nβ+","logσ(x\n>\ni\nβ+","logλ\n\u000f\n)).\nLettingp\ni\n=σ(x\n>\ni\nθ)σ(x\n>\ni\nβ+","logλ\n\u000f\n),","we","note","that","the","first","two","terms","have","the","form\nu\ni\nlog(p\ni\n)","+","(1−u\ni\n)","log(1−p\ni\n)","=u\ni\nlog\np\ni\n1−p\ni\n+","log(1−p\ni\n).\nDefine\nh(x,y)",":=","log\n(\nσ(x)σ(y)\n1−σ(x)σ(y)\n)\n(17)\nso","that\nlog\np\ni\n1−p\ni\n=h(x\n>\ni\nβ+","logλ\n\u000f\n,x\n>\ni\nθ)","=","log\nσ(x\n>\ni\nθ)σ(x\n>\ni\nβ+","logλ\n\u000f\n)\n1−σ(x\n>\ni\nθ)σ(x\n>\ni\nβ+","logλ\n\u000f\n)\n.\nFor","","the","","ease","","of","","notation,","","we","","letf\ni\n(β,θ)","",":=f(x\n>\ni\nβ+","logλ\n\u000f\n,x\n>\ni\nθ)","","for","","any","","functionf:\nR×R→R.","","For","instance,","we","leth\ni\n(β,θ)","=h(x\n>\ni\nβ+","logλ\n\u000f\n,x\n>\ni\nθ).","","We","have,\n`(ω;","(x\ni\n,z\ni\n))","=u\ni\nh\ni\n(β,θ)−log(1","+e\nh\ni\n(β,θ)\n)−u\ni\n{e\n−x\n>\ni\nβ\nz\ni\n+x\n>\ni\nβ+","logσ(x\n>\ni\nβ+","logλ\n\u000f\n)}.\nNow","we","take","derivatives","with","respect","toβandθ.\n∂\n∂β\n`(ω;","(x\ni\n,z\ni\n))","=\n{\nu\ni\n−\ne\nh\ni\n(β,θ)\n1","+e\nh\ni\n(β,θ)\n}\nh\n1i\n(β,θ)x\ni\n−u\ni\n{\n−e\n−x\n>\ni\nβ\nz\ni\n+","1","+\n1\n1","+e\nx\n>\ni\nβ+logλ\n\u000f\n}\nx\ni\n∂\n∂θ\n`(ω;","(x\ni\n,z\ni\n))","=\n{\nu\ni\n−\ne\nh\ni\n(β,θ)\n1","+e\nh\ni\n(β,θ)\n}\nh\n2i\n(β,θ)x\ni\n.\nwhereh\n1\nandh\n2\nare","partial","derivatives","ofhwith","respect","to","the","first","and","second","arguments,\n23\n\ni.e.\nh\n1\n(x,y)","=\n1−σ(x)\n1−σ(x)σ(y)\n,","andh\n2\n(x,y)","=\n1−σ(y)\n1−σ(x)σ(y)\n.(18)\nThen,\n〈−OR(ω),ω−ω\n0\n〉=〈OE[`(ω;","(x\ni\n,z\ni\n))],ω−ω\n0\n〉\n=\n〈[\nE[\n∂\n∂β\n`(ω;","(x\ni\n,z\ni\n))]\nE[\n∂\n∂θ\n`(ω;","(x\ni\n,z\ni\n))]\n]\n,\n[\nβ−β\n0\nθ−θ\n0\n]〉\n=E[\n∂\n∂β\n`(ω;","(x\ni\n,z\ni\n))\n>\n(β−β\n0\n)]","+E[\n∂\n∂θ\n`(ω;","(x\ni\n,z\ni\n))\n>\n(θ−θ\n0\n)].\nwhere","we","exchange","the","derivative","and","expectation,","which","is","valid","by","dominated","convergence\ntheorem","and","AssumptionA3.","","First,","we","let","∆\nθ\n=θ−θ\n0\nand","∆\nβ\n=β−β\n0\n.","","By","the","law","of\niterated","expectations,\nE[\n∂\n∂θ\n`(ω;","(x\ni\n,z\ni\n))\n>\n(θ−θ\n0\n)]","=E\n[{\nu\ni\n−\ne\nh\ni\n(β,θ)\n1","+e\nh\ni\n(β,θ)\n}\nh\n2i\n(β,θ)x\n>\ni\n(θ−θ\n0\n)\n]\n=E\n[{\nE[u\ni\n|x\ni\n]−\ne\nh\ni\n(β,θ)\n1","+e\nh\ni\n(β,θ)\n}\nh\n2i\n(β,θ)x\n>\ni\n∆\nθ\n]\n,\nand\nE[\n∂\n∂β\n`(ω;","(x\ni\n,z\ni\n))\n>\n(β−β\n0\n)]","=E\n[{\nE[u\ni\n|x\ni\n]−\ne\nh\ni\n(β,θ)\n1","+e\nh\ni\n(β,θ)\n}\nh\n1i\n(β,θ)x\n>\ni\n∆\nβ\n+","(E[z\ni\nu\ni\n|x\ni\n]e\n−x\n>\ni\nβ\n−E[u\ni\n|x\ni\n](1","+\n1\n1","+e\nx\n>\ni\nβ+logλ\n\u000f\n))x\n>\ni\n∆\nβ\n]\n.\nFrom","the","definition","ofhin","(17),","we","have,\nE[u\ni\n|x\ni\n]","=\ne\nh(x\n>\ni\nβ\n0\n,x\n>\ni\nθ\n0\n)\n1","+e\nh(x\n>\ni\nβ\n0\n,x\n>\ni\nθ\n0\n)\n=σ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n),\n24\n\nand","thus,\nE[\n∂\n∂ω\n`(ω;","(x\ni\n,z\ni\n))\n>\n(ω−ω\n0\n)]","=E\n[{\nA\n′\n(h(x\n>\ni\nβ\n0\n,x\n>\ni\nθ\n0\n))−A\n′\n(h\ni\n(β,θ))\n}\nh\n1i\n(β,θ)x\n>\ni\n∆\nβ\n]\n+E\n[{\nA\n′\n(h(x\n>\ni\nβ\n0\n,x\n>\ni\nθ\n0\n))−A\n′\n(h\ni\n(β,θ))\n}\nh\n2i\n(β,θ)x\n>\ni\n∆\nθ\n]\n+E\n[\n(E[z\ni\nu\ni\n|x\ni\n]e\n−x\n>\ni\nβ\n−E[u\ni\n|x\ni\n](1","+\n1\n1","+e\nx\n>\ni\nβ+logλ\n\u000f\n))x\n>\ni\n∆\nβ\n]\n,\n(19)\nwhere","we","defineA(t)","=","log(1","+","exp(t)).\nFor","the","sum","of","the","first","two","terms","(:=","Term","I)","in","(19),\nTerm","I",":=E\n\n\n{\nA\n′\n(h(x\n>\ni\nβ\n0\n,x\n>\ni\nθ\n0\n))−A\n′\n(h(x\n>\ni\nβ,x\n>\ni\nθ))\n}\n[\nh\n1i\n(β,θ)\nh\n2i\n(β,θ)\n]\n>\n[\nx\n>\ni\n∆\nβ\nx\n>\ni\n∆\nθ\n]\n\n\n=−E\n\n\nA\n′′\n(h(x\n>\ni\nβ\ni\n,x\n>\ni\nθ\ni\n))\n\n\n[\nh\n1i\n(β\ni\n,θ\ni\n)\nh\n2i\n(β\ni\n,θ\ni\n)\n]\n>\n[\nx\n>\ni\n∆\nβ\nx\n>\ni\n∆\nθ\n]\n\n\n\n\n[\nh\n1i\n(β,θ)\nh\n2i\n(β,θ)\n]\n>\n[\nx\n>\ni\n∆\nβ\nx\n>\ni\n∆\nθ\n]\n\n\n\n\n,\nwherex\n>\ni\nβ\ni\n∈[x\n>\ni\nβ,x\n>\ni\nβ\n0\n]","andx\n>\ni\nθ\ni\n∈[x\n>\ni\nθ,x\n>\ni\nθ\n0\n]","from","MVT.","By","expanding","each","term,","we\nhave,\n−Term","I","=E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)(x\n>\ni\n∆\nβ\n)\n2\n})]\n+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)(x\n>\ni\n∆\nθ\n)\n2\n})]\n+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){[h\n1i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)","+h\n1i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)](x\n>\ni\n∆\nβ\n)(x\n>\ni\n∆\nθ\n)})].\n(20)\nFor","the","remaining","term","(:=","Term","II)","in","(19),\nTerm","II",":=E\n[\n(E[u\ni\nz\ni\n|x\ni\n]e\n−x\n>\ni\nβ\n−E[u\ni\n|x\ni\n]{2−σ(x\n>\ni\nβ+","logλ\n\u000f\n)})x\n>\ni\n∆\nβ\n]\n=E[{σ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\n(β\n0\n−β)\n[2−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)]\n−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)σ(x\n>\ni\nθ\n0\n)[2−σ(x\n>\ni\nβ+","logλ\n\u000f\n)]}x\n>\ni\n∆\nβ\n]\n=E\n[\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\n−x\n>\ni\nβ\n{e\nx\n>\ni\nβ\n0\n[2−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)]\n−e\nx\n>\ni\nβ\n[2−σ(x\n>\ni\nβ+","logλ\n\u000f\n)]}x\n>\ni\n∆\nβ\n]\n(21)\nwhere","the","first","equality","using","Lemma","1.\n25\n\nWe","definef(t)","=e\nt\n[2−σ(t+","logλ\n\u000f\n)].","","Since","the","term","inside","the","bracket","in","(21)","is\nf(x\n>\ni\nβ\n0\n)−f(x\n>\ni\nβ)","=f\n′\n(x\n>\ni\nβ\ni\n)(x\n>\ni\nβ\n0\n−x\n>\ni\nβ)","=−f\n′\n(x\n>\ni\nβ\n′\ni\n)(x\n>\ni\n∆\nβ\n)\nby","mean","value","theorem","wherex\n>\ni\nβ\n′\ni\n∈[x\n>\ni\nβ,x\n>\ni\nβ\n0\n],","we","have,\nTerm","II","=−E\n[\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\n−x\n>\ni\nβ\nf\n′\n(x\n>\ni\nβ\n′\ni\n)(x\n>\ni\n∆\nβ\n)\n2\n]\n=−E\n[\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\n(β\n′\ni\n−β)\n[1","+{1−σ(x\n>\ni\nβ\n′\ni\n+","logλ\n\u000f\n)}\n2\n](x\n>\ni\n∆\nβ\n)\n2\n]\n(22)\nusingf\n′\n(t)","=e\nt\n[1","+{1−σ(t+","logλ\n\u000f\n)}\n2\n].\nCombining","Term","I","and","II","in","(20)","and","(22),\n〈OR(ω),ω−ω\n0\n〉=−(Term","I","+","Term","II)\n=E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)(x\n>\ni\n∆\nβ\n)\n2\n})]\n+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)(x\n>\ni\n∆\nθ\n)\n2\n})]\n+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){[h\n1i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)","+h\n1i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)](x\n>\ni\n∆\nβ\n)(x\n>\ni\n∆\nθ\n)})]\n+E\n[\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\n(β\n′\ni\n−β)\n[1","+{1−σ(x\n>\ni\nβ\n′\ni\n+","logλ\n\u000f\n)}\n2\n](x\n>\ni\n∆\nβ\n)\n2\n]\n.\nNote","that","other","than","the","third","terms,","","all","other","terms","are","positive,","","sinceA\n′′\n≥0","and","0≤\nh\n1\n,h\n2\n,σ,σ\n′\n≤1.","","Define\ng\ni\n(ω)",":=\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\n(β\n′\ni\n−β)\n[1","+{1−σ(x\n>\ni\nβ\n′\ni\n+","logλ\n\u000f\n)}\n2\n]\nA\n′′\n(h\ni\n(β\ni\n,θ\ni\n))\n,\nand","let\nL:=inf\nt,s,u,v;max{|t|,|s|,|u|,|v|}≤2rC\nX\n4σ(t)σ(s+","logλ\n\u000f\n)e\nu\n[1","+","(1−σ(v+","logλ\n\u000f\n))\n2\n].(23)\nIn","particular,","we","haveg\ni\n(ω)≥L",">0","a.s.","","for","alli=","1,...,n,","whereL",">0","is","guaranteed","by\n26\n\nAssumptionA3.","","We","have,\n−(Term","I","+","Term","II)\n=E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω)}(x\n>\ni\n∆\nβ\n)\n2\n]","+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n))h\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)(x\n>\ni\n∆\nθ\n)\n2\n]\n+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){[h\n1i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)","+h\n1i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)](x\n>\ni\n∆\nβ\n)(x\n>\ni\n∆\nθ\n)})]\n≥E[(0.5)A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω)}(x\n>\ni\n∆\nβ\n)\n2\n]\n+E[A\n′′\n(h\ni\n(β\ni\n,θ\ni\n))\n{\nh\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)−\n[h\n1i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)","+h\n1i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)]\n2\n2(h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω))\n}\n(x\n>\ni\n∆\nθ\n)\n2\n]\n(24)\nwhere","we","use","the","arithmetic","inequalityab≤(a\n2\n+b\n2\n)/2","with\na:={h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω)}\n1/2\nx\n>\ni\n∆\nβ\nb:=\nh\n1i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)","+h\n1i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)\n{h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω)}\n1/2\nx\n>\ni\n∆\nθ\n.\nFrom","the","AssumptionA4,\nmax\n1≤i≤n\n1−σ(x\n>\ni\nβ+","logλ\n\u000f\n)\n1−σ(x\n>\ni\nθ)\n=","","max\n1≤i≤n\n(1−σ(x\n>\ni\nβ+","logλ\n\u000f\n))/(σ(x\n>\ni\nβ+","logλ\n\u000f\n)σ(x\n>\ni\nθ))\n(1−σ(x\n>\ni\nθ))/(σ(x\n>\ni\nβ+","logλ\n\u000f\n)σ(x\n>\ni\nθ))\n=","","max\n1≤i≤n\nh\n1i\n(β,θ)\nh\n2i\n(β,θ)\n≤r\n0\n(ω\n0\n,C\nX\n,r)\nwhere","","we","","use","","the","","definition","","ofh\n1\nandh\n2\nin","","(18)","","and","","forr\n0\n(ω\n0\n,C\nX\n,r)","",":=","","(0.5)L\n1/2\nforL\ndefined","in","(23).","","For","the","ease","of","notation,","we","letr\n0\n:=r\n0\n(ω\n0\n,C\nX\n,r).","","For","the","part","in","bracket\n27\n\nin","(24),","we","have,\nh\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)−\n[h\n1i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)","+h\n1i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)]\n2\n2(h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω))\n≤h\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)−\n2r\n2\n0\nh\n2i\n(β\ni\n,θ\ni\n)\n2\nh\n2i\n(β,θ)\n2\ng\ni\n(ω)\n=h\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)\n{\n1−\n2r\n2\n0\nh\n2i\n(β\ni\n,θ\ni\n)h\n2i\n(β,θ)\ng\ni\n(ω)\n}\n≤\n1\n2\nh\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)\nwhere","we","use","0≤h\n1\n,h\n2\n≤1,","","and","the","last","inequality","is","from","the","conditionr\n2\n0\n≤(0.25)L.\nTherefore,\n−(Term","I","+","Term","II)\n≥E[(0.5)A\n′′\n(h\ni\n(β\ni\n,θ\ni\n)){h\n1i\n(β,θ)h\n1i\n(β\ni\n,θ\ni\n)","+g\ni\n(ω)}(x\n>\ni\n∆\nβ\n)\n2\n]\n+E[(0.5)A\n′′\n(h\ni\n(β\ni\n,θ\ni\n))h\n2i\n(β,θ)h\n2i\n(β\ni\n,θ\ni\n)(x\n>\ni\n∆\nθ\n)\n2\n]\n≥C\nλ\n{(C\n0\n+L)‖∆\nβ\n‖\n2\n2\n+C\n0\n‖∆\nθ\n‖\n2\n2\n},\nwhereC\n0\n:=inf\nt,s,u,v;max{|t|,|s|,|u|,|v|}≤2rC\nX\n(0.5)A\n′′\n(h(u,v)){h\n1\n(t,s)h\n1\n(u,v)},","sinceh\n1\n(t,s)","=h\n2\n(s,t)\nandg\ni\n(ω)≥L,","and","we","use","AssumptionA2.\nWe","conclude,\nOR(ω)\n>\n(ω−ω\n0\n)≥C\nλ\nC\n0\n(‖∆\nβ\n‖\n2\n2\n+‖∆\nθ\n‖\n2\n2\n)","=C\nλ\nC\n0\n‖ω−ω\n0\n‖\n2\n2\n,\nas","desired.\nLemma","1.\nE[u\ni\nz\ni\n|x\ni\n]","=σ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\nβ\n0\n[2−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)]\nProof.We","","haveE[u\ni\nz\ni\n|x\ni\n]","","=E[1[z\ni\n>0]z\ni\n|x\ni\n]","","=σ(x\n>\ni\nθ\n0\n)\n∫\n∞\n0\ny(1−e\n−λ\n\u000f\nt\n)λ\nX\ne\n−λ\nX\ny\ndysince\n28\n\ny\ni\n=z\ni\nonz\ni\n>0.","","Then,\nE[u\ni\nz\ni\n|x\ni\n]","=σ(x\n>\ni\nθ\n0\n)\n{\n∫\n∞\n0\nyλ\nX\ne\n−λ\nX\ny\n−\n∫\n∞\n0\nyλ\nX\ne\n−(λ\nX\n+λ\n\u000f\n)y\ndy\n}\n=σ(x\n>\ni\nθ\n0\n){\n1\nλ\nX\n−\nλ\nX\n(λ\n\u000f\n+λ\nX\n)\n2\n}\n=σ(x\n>\ni\nθ\n0\n){e\nx\n>\ni\nβ\n0\n−\n1\nλ\n\u000f\nσ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)(1−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n))}\nNoting","that\ne\nx\n>\ni\nβ\n0\n=\n1\nλ\n\u000f\ne\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n1","+e\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n(1","+e\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n)\n=\n1\nλ\n\u000f\nσ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)(1","+e\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n),\nwe","have,\nE[u\ni\nz\ni\n|x\ni\n]","=\n1\nλ\n\u000f\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n){1","+e\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n−1","+σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)}\n=\n1\nλ\n\u000f\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n{1","+\n1\n1","+e\nx\n>\ni\nβ\n0\n+logλ\n\u000f\n}\n=σ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)e\nx\n>\ni\nβ\n0\n[2−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)]\nA.4","","","","Proof","for","Theorem","2\nFor","the","first","part","of","Theorem","2,","we","perform","a","landscape","analysis","ofL\nn\n(ω)","similarly","as","in","(Mei\net","al.,","2018).","","In","particular,","we","first","show","that","there","exists","an\u000f\n0\nneigherborhood","ofω\n0\nwhere\nthe","","population","","risk","","functionR(ω)","","is","","strongly","","convex","","and","","the","","gradient","","ofR(ω)","","does","","not\nvanish","outside","of","the\u000f\n0\nneighborhood.","","Then,","using","a","uniform","convergence","result,","we","show\nthat","the","empirical","risk","functionL\nn\n(ω)","has","the","same","landscape","asR(ω)","with","high","probability\nfor","","a","","sufficiently","","largenand","","thereforeL\nn\n(ω)","","admits","","a","","unique","","stationary","","point","","inside\u000f\n0\n,\nwhich","is","a","global","minimizer","ofL\nn\n(ω)","with","the","same","high","probability","for","a","sufficiently","large\nn.","","To","establish","this,","we","first","state","the","following","two","Lemmas,","whose","proofs","are","presented","at\nthe","end","of","section.\nLemma","2.1.","","Bounds","","on","","the","","Hessian","","ofR(ω).","","","There","","exist","","an\u000f\n0\n>0and","","constants\n29\n\n0<","h<h","<∞such","that\nh≤inf\nω∈B\n2\n(\u000f\n0\n;ω\n0\n)\nλ\nmin\n(O\n2\nR(ω))≤sup\nω∈B\n2\n(r)\nλ\nmax\n(O\n2\nR(ω))≤h\n2.","","Bounds","on","the","gradient","ofR(ω).","","There","exist","constants0<","g\n<g","<∞such","that\ng≤inf\nω∈B\n2\n(r)\\B\n2\n(\u000f\n0\n;ω\n0\n)\n‖OR(ω)‖\n2\n≤sup\nω∈B\n2\n(r)\n‖OR(ω)‖\n2\n≤g\nLemma","3(Theorem","1","in","Mei","et","al.,","2018).ForC=C\n0\n{\nlog\n(\nrC\nY\nK\nX\nδ\n)\n∨1\n}\nfor","","a","","constant\nC\n0\ndepending","on","the","model","parameters(C\nX\n,r),\nP\n(\nsup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n≤C\nY\nK\nX\n√\nCplogn\nn\n)\n≥1−δ\nP\n(\nsup\nω∈B\n2\n(r)\n‖O\n2\nL\nn\n(ω)−O\n2\nR(ω)‖\n2\n≤C\n2\nY\nK\n2\nX\n√\nCplogn\nn\n)\n≥1−δ\ngivenn≥Cplog(p).\nProvided","Lemma","2","and","3","are","true,","we","can","choosen≥Cplognto","be","sufficiently","large","so\nthat","the","following","inequalities","hold","with","probabilitiy","1−δ.\nh/2≤inf\nω∈B\n2\n(\u000f\n0\n;ω\n0\n)\nλ\nmin\n(O\n2\nL\nn\n(ω))≤sup\nω∈B\n2\n(r)\nλ\nmax\n(O\n2\nL\nn\n(ω))≤2\nh(25)\ng/2≤inf\nω∈B\n2\n(r)\\B\n2\n(\u000f\n0\n;ω\n0\n)\n‖OL\nn\n(ω)‖\n2\n≤sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)‖\n2\n≤2g(26)\nsup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n≤\nα\u000f\n0\n4\n(27)\nWe","letE\nn\nbe","the","event","where","inequalities","(25)","-","(27)","hold.\nFirst,","we","argue","that̂ωis","an","inner","point","ofB\n2\n(r),","i.e.̂ω∈B\n2\n(r)\\∂B\n2\n(r)","onE\nn\n.","","To","see\nthis,","supposêω∈∂B\n2\n(r).","","By","the","first-order","optimality","condition,","we","have,\n〈OL\nn\n(̂ω),̂ω−ω\n0\n〉≤0\n30\n\nOn","the","other","hand,\n〈OL\nn\n(̂ω),̂ω−ω\n0\n〉≥〈OR(̂ω),̂ω−ω\n0\n〉−sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n‖̂ω−ω\n0\n‖\n2\n≥α‖̂ω−ω\n0\n‖\n2\n2\n−\nrα\n4\n‖̂ω−ω\n0\n‖\n2\n(28)\n≥\nαr\n2\n8\n,\nsince‖ω\n0\n‖\n2\n≤r/2","and‖̂ω‖\n2\n=r,","we","have‖̂ω−ω\n0\n‖\n2\n≥r/2.","We","also","use","Proposition","1","and","(27)\nto","obtain:〈OR(̂ω),̂ω−ω\n0\n〉≥α‖̂ω−ω\n0\n‖\n2\n2\nand","sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n≤α\u000f\n0\n/4≤αr/4.\nTherefore,","we","have","a","contradiction,","and","conclude","that̂ωis","an","inner","point","ofB\n2\n(r).","","Then\nfrom","(25)","and","(26)","we","can","conclude","thatL\nn\n(ω)","has","the","unique","stationary","point","inB\n2\n(\u000f\n0\n;ω\n0\n)\nonE\nn\n.\nNow","we","address","the","second","part","of","the","Theorem","2.","","OnE\nn\n,","sincêωis","an","inner","point","of\nB\n2\n(r),","we","haveOL\nn\n(̂ω)","=","0.","","First,","we","note","that\n〈OR(̂ω),̂ω−ω\n0\n〉\n=〈OR(̂ω)−OL\nn\n(̂ω),̂ω−ω\n0\n〉+〈OL\nn\n(̂ω)−OL\nn\n(ω\n0\n),̂ω−ω\n0\n〉+〈OL\nn\n(ω\n0\n)−OR(ω\n0\n),̂ω−ω\n0\n〉\nwhere","we","useOL\nn\n(̂ω),OR(ω\n0\n)","=","0.\nUsing","the","Proposition","1,\nα‖̂ω−ω\n0\n‖\n2\n2\n≤‖OL\nn\n(ω\n0\n)‖\n2\n‖̂ω−ω\n0\n‖\n2\n+","2","","","sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n‖̂ω−ω\n0\n‖\n2\n,\nand","therefore\n‖̂ω−ω\n0\n‖\n2\n≤\n1\nα\n{‖OL\nn\n(ω\n0\n)‖\n2\n+","2","","","sup\nω∈B\n2\n(r)\n‖OL\nn\n(ω)−OR(ω)‖\n2\n}.\nFirst,","we","obtain","a","bound","on‖OL\nn\n(ω\n0\n)‖\n2\n.","","Using`\n2\n-`\n∞\ninequality,","we","have,\n‖OL\nn\n(ω\n0\n)‖\n2\n≤\n√\n2p‖OL\nn\n(ω\n0\n)‖\n∞\n.\nNow","we","show","thatOL\nn\n(ω\n0\n)","is","sub-Gaussian","with","a","parameter","scaling","with","1/n.","","We","recall,\n31\n\nforω=","(β,θ),\nOL\nn\n(β,θ)","=\n1\nn\nn\n∑\ni=1\n[\n{(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n1i\n(β,θ)−u\ni\nz\ni\ne\n−x\n>\ni\nβ\n+u\ni\n(2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))}x\ni\n(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n2i\n(β,θ)x\ni\n]\nLetc\n1i\n(β,θ)","",":=","","(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n1i\n(β,θ)−u\ni\nz\ni\ne\n−x\n>\ni\nβ\n+u\ni\n(2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))}and\nc\n2i\n(β,θ)","=","(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n2i\n(β,θ).","","We","haveE[c\n1i\n(β\n0\n,θ\n0\n)x\ni\n],E[c\n2i\n(β\n0\n,θ\n0\n)|x\ni\n]","=","0","by","the\niterative","law","of","expectation.\nAlsoc\n1i\n(β\n0\n,θ\n0\n)","andc\n2i\n(β\n0\n,θ\n0\n)","are","bounded","a.s.,","since|(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n1i\n(β,θ)|,|(A\n′\n(h\ni\n(β,θ))−\nu\ni\n)h\n2i\n(β,θ)|","≤1","almost","surely,|u\ni\nz\ni\ne\n−x\n>\ni\nβ\n0\n|=|u\ni\ny\ni\ne\n−x\n>\ni\nβ\n0\n|","≤C\nY\nby","AssumptionA3,","","and\n|u\ni\n(2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))|≤2.\nWe","show","thatOL\ni\n(β\n0\n,θ\n0\n)","is","a","mean-zero","sub-Gaussian","random","variable.","","First,","we","define\nfor","a","random","vectorX,‖X‖\nL\nk\n(P)\n=E[‖X‖\nk\n]\n1/k\n.","","For","any","unit","vectorv∈R\n2p\nandk≥1\n‖v\n>\nOL\ni\n(β\n0\n,θ\n0\n)‖\nL\nk\n(P)\n=‖c\n1i\n(β\n0\n,θ\n0\n)x\n>\ni\nv\nβ\n+c\n2i\n(β\n0\n,θ\n0\n)x\n>\ni\nv\nθ\n‖\nL\nk\n(P)\n≤C\n0\nC\nY\nK\nX\n√\nk\nwhereC\n0\nis","an","absolute","constant","and","we","letv=","[v\n>\nβ\n,v\n>\nθ\n]\n>\n.","","Therefore,OL\ni\n(β\n0\n,θ\n0\n)","is","sub-\nGaussian","","distribution","","with","","parameterC\n′\n0\nC\nY\nK\nX\nfor","","an","","absolute","","constantC\n′\n0\n(Vershynin,\n2018).","","Since{OL\ni\n(β\n0\n,θ\n0\n)}\nn\ni=1\nare","independent,","it","follows","thatOL\nn\n(ω)","=n\n−1\n∑\nn\ni=1\nOL\ni\n(ω)\nhas","","a","","sub-Gaussian","","distribution","","with","","parameterC\n0\nC\nY\nK\nX\n/n.","","","Using","","a","","sub-Gaussian","","tail\nbound","and","also","a","union","bound,","for","anyt",">0,","we","have,\nP(‖OL\nn\n(ω\n0\n)‖\n∞\n≥t)≤exp(−nt\n2\n/(2C\n0\nC\nY\nK\nX\n)","+","log(4p))\nsinceω∈R\n2p\n.","","Taket=\n√\n(2","+","(δlog(2p))\n−1\n)","log(2p)C\n0\nC\nY\nK\nX\n/nto","getP(‖OL\nn\n(ω\n0\n)‖\n∞\n≥\nt)≤δ.\nThe","bound","for","the","second","term","follows","from","Lemma","3.","","Combining","the","two","bounds,","with\nprobability","1−3δand","a","constantC\n1\n>0,\n‖̂ω−ω\n0\n‖\n2\n≤\n1\nα\n{C\n1\n√\nplogpC\nY\nK\nX\nn\n+C\nY\nK\nX\n√\nCplogn\nn\n}\n≤\nC\nα\n√\nC\n2\nY\nplog(n)","log(C\nY\n/δ)\nn\n.\n32\n\nA.5","","","","Proof","for","Theorem","3\nSupposeE\nn\nholds,","i.e.","","we","are","on","the","event","where","inequalities","(25)","-","(27)","hold.","","OnE\nn\n,L\nn\n(β)\nis","2\nh-smooth","andh/2-strongly","convex","onB\n2\n(\u000f\n0\n;ω\n0\n).\nFirst","","supposeω\nt\n∈B\n2\n(\u000f\n0\n;ω\n0\n).","","","We","","will","","show","","that","","iterates","","stay","","in","","the","","strongly","","convex\nregion","ofB\n2\n(\u000f\n0\n;ω\n0\n)","and{ω\nk\n}\nk≥t\nlinearly","converge","tôω.","","From","the","fundamental","prox-grad\ninequality","(Theorem","10.16","in","Beck,","2017),","for","anyηsuch","thatη≤1/(2h),\nL\nn\n(̂ω)−L\nn\n(ω\nt+1\n)≥\n1\n2η\n{‖̂ω−ω\nt+1\n‖\n2\n2\n−‖̂ω−ω\nt\n‖\n2\n2\n}+L\nn\n(̂ω)−L\nn\n(ω\nt\n)−〈OL\nn\n(ω\nt\n),̂ω−ω\nt\n〉\nSince","bothω\nt\n,̂ω∈B\n2\n(\u000f\n0\n;ω\n0\n),","we","have,\nL\nn\n(̂ω)−L\nn\n(ω\nt\n)−〈OL\nn\n(ω\nt\n),̂ω−ω\nt\n〉≥\nh\n4\n‖̂ω−ω\nt\n‖\n2\n2\n.\nTherefore,\nL\nn\n(̂ω)−L\nn\n(ω\nt+1\n)≥\n1\n2η\n‖̂ω−ω\nt+1\n‖\n2\n2\n−(\n1\n2η\n−\nh\n4\n)‖̂ω−ω\nt\n‖\n2\n2\nSincêωis","the","unique","minimizer","ofL\nn\n(ω)","onE\nn\n,","we","haveL\nn\n(̂ω)≤L\nn\n(ω\nt+1\n),","and","thus\n‖̂ω−ω\nt+1\n‖\n2\n2\n≤(1−\nh\nη\n2\n)‖̂ω−ω\nt\n‖\n2\n2\n(29)\nSinceη≤1/(2\nh),\nhη\n2\n≤\nh\n4h\n<1.","","Therefore,","","ifω\nt\n∈B\n2\n(\u000f\n0\n;ω\n0\n),","","thenω\nt+1\n∈B\n2\n(\u000f\n0\n;ω\n0\n)","and\n{ω\nk\n}\nk≥t\nlinearly","converge","tôω.\nNow","supposeω\nt\n/∈B\n2\n(\u000f\n0\n;ω\n0\n).","","Similar","arguments","as","in","Mei","et","al.","(2018)","for","the","analysis\nof","the","gradient","descent","algorithm","can","be","used","to","show","that","iterates","exponentially","converge\nto","the","strongly","convex","region.","","Since","the","iterates","do","not","leaveB\n2\n(\u000f\n0\n;ω\n0\n)","once","the","iterates\nenter","this","region,","we","can","assume","thatω\nk\n/∈B\n2\n(\u000f\n0\n;ω\n0\n)","fork=","0,...,t.","","We","have,\n‖ω\nt+1\n−ω\n0\n‖\n2\n2\n=‖P\nB\n2\n(r)\n(ω\nt\n−ηOL\nn\n(ω\nt\n))−P\nB\n2\n(r)\n(ω\n0\n)‖\n2\n2\n≤‖ω\nt\n−ηOL\nn\n(ω\nt\n)−ω\n0\n‖\n2\n2\n≤‖ω\nt\n−ω\n0\n‖\n2\n2\n−2η〈ω\nt\n−ω\n0\n,OL\nn\n(ω\nt\n)〉+η\n2\n‖OL\nn\n(ω\nt\n)‖\n2\n2\n33\n\nwhere","the","first","inequality","uses","the","contraction","property","of","a","projection","operator.","","We","have\n〈OL\nn\n(ω\nt\n),ω\nt\n−ω\n0\n〉≥α‖ω\nt\n−ω\n0\n‖\n2\n2\n−(α\u000f\n0\n/4)‖ω\nt\n−ω\n0\n‖\n2\n≥(3α/4)‖ω\nt\n−ω\n0\n‖\n2\n2\nwhere","the","first","inequality","can","be","derived","similarly","as","in","(28)","and","the","second","inequality","is","due\nto‖ω\nt\n−ω\n0\n‖\n2\n≥\u000f\n0\n.\nLetη≤\n3\n16g\n2\nα\u000f\n2\n0\n.","","Then,\n‖ω\nt+1\n−ω\n0\n‖\n2\n2\n=‖P\nB\n2\n(r)\n(ω\nt\n−ηOL\nn\n(ω\nt\n))−P\nB\n2\n(r)\n(ω\n0\n)‖\n2\n2\n≤(1−3ηα/2)‖ω\nt\n−ω\n0\n‖\n2\n2\n+","4η\n2\ng\n2\n≤(1−3ηα/4)‖ω\nt\n−ω\n0\n‖\n2\n2\nwhere","we","use","(26)","for","the","second","inequality","and","4η\n2\ng\n2\n≤3ηα\u000f\n2\n0\n/4","by","the","choice","ofη.Then,\nsince‖̂ω−ω\n0\n‖\n2\n≤\u000f\n0\n≤‖ω\nt\n−ω\n0\n‖\n2\n,\n‖ω\nt\n−̂ω‖\n2\n≤‖ω\nt\n−ω\n0\n‖\n2\n+‖̂ω−ω\n0\n‖\n2\n≤2‖ω\nt\n−ω\n0\n‖\n2\n≤2(1−3ηα/4)\nt/2\n‖ω\n0\n−ω\n0\n‖\n2\n≤2(1−3ηα/4)\nt/2\n{‖ω\n0\n−̂ω‖\n2\n+‖̂ω−ω\n0\n‖\n2\n}\n≤4(1−3ηα/4)\nt/2\n‖ω\n0\n−̂ω‖\n2\nwhere","the","last","inequality","is","due","to‖̂ω−ω\n0\n‖\n2\n≤\u000f\n0\n≤‖ω\n0\n−̂ω‖\n2\n.","","Therefore,\n‖ω\nt\n−̂ω‖\n2\n2\n≤16(1−3ηα/4)\nt\n‖ω\n0\n−̂ω‖\n2\n2\n.(30)\nCombining","(29)","and","(30),\n‖ω\nt\n−̂ω‖\n2\n2\n≤16(1−κ)\nt\n‖ω\n0\n−̂ω‖\n2\n2\n.\nforκ:=","min{h\n,\n3α\n4\n}ηwhereηis","chosen","so","thatη≤min{\n1\n2h\n,\n3α\u000f\n2\n0\n16g\n2\n,\n2\n3α\n}.\n34\n\nProof","of","Lemma","2.First,","we","compute","Hessian","ofR(ω):\nO\n2\nR(ω)","=\n[\nE[a\ni\n(ω)|x\ni\n]x\ni\nx\n>\ni\nE[b\ni\n(ω)|x\ni\n]x\ni\nx\n>\ni\nE[b\ni\n(ω)|x\ni\n]x\ni\nx\n>\ni\nE[c\ni\n(ω)|x\ni\n]x\ni\nx\n>\ni\n]\nwhere\na\ni\n(ω)",":=a(x\n>\ni\nβ,x\n>\ni\nθ)",":=A\n′′\n(h\ni\n(ω))h\n1i\n(ω)\n2\n+","(A\n′\n(h\ni\n(ω))−u\ni\n)h\n11,i\n(ω)\n+u\ni\nz\ni\ne\n−x\n>\ni\nβ\n−u\ni\nσ\n′\n(x\n>\ni\nβ+","logλ\n\u000f\n)\nb\ni\n(ω)",":=b(x\n>\ni\nβ,x\n>\ni\nθ)",":=A\n′′\n(h\ni\n(ω))h\n1i\n(ω)h\n2i\n(ω)","+","(A\n′\n(h\ni\n(ω))−u\ni\n)h\n12,i\n(ω)\nc\ni\n(ω)",":=c(x\n>\ni\nβ,x\n>\ni\nθ)",":=A\n′′\n(h\ni\n(ω))h\n2i\n(ω)\n2\n+","(A\n′\n(h\ni\n(ω))−u\ni\n)h\n22,i\n(ω).\n(31)\nFirst","we","show","that","inf\nω∈B\n2\n(\u000f\n0\n;ω\n0\n)\nλ\nmin\n(O\n2\nR(ω))>","CforC",">0.","","For","anyv∈R\n2p\nsuch","that\n‖v‖\n2\n=","1","andv=","[v\n>\nβ\n,v\n>\nθ\n]\n>\n,\nv\n>\nO\n2\nR(ω\n0\n)v=E[E[a\ni\n(ω\n0\n)|x\ni\n](x\n>\ni\nv\nβ\n)\n2\n+E[c\ni\n(ω\n0\n)|x\ni\n](x\n>\ni\nv\nθ\n)\n2\n+","2E[b\ni\n(ω\n0\n)|x\ni\n](x\n>\ni\nv\nβ\n)(x\n>\ni\nv\nθ\n)].\nWe","note\nE[a\ni\n(ω\n0\n)|x\ni\n]",":=A\n′′\n(h\ni\n(ω\n0\n))h\n1i\n(ω\n0\n)\n2\n+E[u\ni\nz\ni\n|x\ni\n]e\n−x\n>\ni\nβ\n0\n−E[u\ni\n|x\ni\n]σ\n′\n(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)\n=A\n′′\n(h\ni\n(ω\n0\n))h\n1i\n(ω\n0\n)\n2\n+σ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)[1","+{1−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)}\n2\n]\nE[b\ni\n(ω\n0\n)|x\ni\n]",":=A\n′′\n(h\ni\n(ω\n0\n))h\n1i\n(ω\n0\n)h\n2i\n(ω\n0\n)\nE[c\ni\n(ω\n0\n)|x\ni\n]",":=A\n′′\n(h\ni\n(ω\n0\n))h\n2i\n(ω\n0\n)\n2\n.\nwhere","the","first","equality","uses","Lemma","1.","","Letting\n","̃g\ni\n(ω\n0\n)",":=\n1\nA\n′′\n(h\ni\n(ω\n0\n))\nσ(x\n>\ni\nθ\n0\n)σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)[1","+{1−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)}\n2\n],\nsimilarly","as","in","the","proof","of","Proposition","1,\nv\n>\nO\n2\nR(ω\n0\n)v≥E[A\n′′\n(h\ni\n(ω\n0\n))\n[\n(0.5){h\n1i\n(ω\n0\n)\n2\n+","","̃g\ni\n(ω\n0\n)}(x\n>\ni\nv\nβ\n)\n2\n+\n{\nh\n2i\n(ω\n0\n)\n2\n−\n4h\n1i\n(ω\n0\n)\n2\nh\n2i\n(ω\n0\n)\n2\n2(h\n1i\n(ω\n0\n)","+","","̃g\ni\n(ω\n0\n))\n}\n(x\n>\ni\nv\nθ\n)\n2\n]]\n≥E[A\n′′\n(h\ni\n(ω\n0\n))\n[\n(0.5){h\n1i\n(ω\n0\n)\n2\n+","","̃g\ni\n(ω\n0\n)}(x\n>\ni\nv\nβ\n)\n2\n+h\n2i\n(ω\n0\n)\n2\n{\n1−\n2r\n2\n0\n","̃g\ni\n(ω\n0\n)\n}\n(x\n>\ni\nv\nθ\n)\n2\n]\n]\n≥E[A\n′′\n(h\ni\n(ω\n0\n))\n[\n(0.5){h\n1i\n(ω\n0\n)\n2\n+","","̃g\ni\n(ω\n0\n)}(x\n>\ni\nv\nβ\n)\n2\n+","(0.5)h\n2i\n(ω\n0\n)\n2\n(x\n>\ni\nv\nθ\n)\n2\n]\n]\n35\n\nwhere","we","useL≥","̃g\ni\n(ω\n0\n)","for","allia.s.,","and","AssumptionA4forr\n0\n:=","(0.5)L\n1/2\n.","","Therefore,\nv\n>\nO\n2\nR(ω\n0\n)v≥C\n0\nE[(x\n>\ni\nv\nβ\n)\n2\n+","(x\n>\ni\nv\nθ\n)\n2\n]≥2C\n0\nC\nλ\nforC\n0\n:=inf\nt,s;max{|t|,|s|}≤2rC\nX\n(0.5)A\n′′\n(h(s,t))h\n1\n(s,t)\n2\n,","sinceh\n1\n(t,s)","=h\n2\n(s,t),","where","we","also","use\nAssumptionA2.","","Thus","we","obtainλ\nmin\n(O\n2\nR(ω\n0\n))≥2C\n0\nC\nλ\n.","","To","boundλ\nmin\n(O\n2\nR(ω)),","we","use\nλ\nmin\n(O\n2\nR(ω))≥λ\nmin\n(O\n2\nR(ω\n0\n))−‖O\n2\nR(ω)−O\n2\nR(ω\n0\n)‖\nop\nFor","anyω\n1\nandω\n2\nwe","have,\n‖O\n2\nR(ω\n1\n)−O\n2\nR(ω\n2\n)‖\nop\n=‖\n[\nE[E[a\ni\n(ω\n1\n)−a\ni\n(ω\n2\n)|x\ni\n]x\ni\nx\n>\ni\n]E[E[b\ni\n(ω\n1\n)−b\ni\n(ω\n2\n)|x\ni\n]x\ni\nx\n>\ni\n]\nE[E[b\ni\n(ω\n1\n)−b\ni\n(ω\n2\n)|x\ni\n]x\ni\nx\n>\ni\n]E[E[c\ni\n(ω\n1\n)−c\ni\n(ω\n2\n)|x\ni\n]x\ni\nx\n>\ni\n]\n]\n‖\nop\n=","","","","sup\nv;‖v‖\n2\n=1\nE\n[\nE[a\ni\n(ω\n1\n)−a\ni\n(ω\n2\n)|x\ni\n](x\n>\ni\nv\nβ\n)\n2\n+","2E[b\ni\n(ω\n1\n)−b\ni\n(ω\n2\n)|x\ni\n](x\n>\ni\nv\nβ\n)(x\n>\ni\nv\nθ\n)\n+E[c\ni\n(ω\n1\n)−c\ni\n(ω\n2\n)|x\ni\n](x\n>\ni\nv\nθ\n)\n2\n]\n≤E{L\na\n‖x\ni\n‖\n2\n(x\n>\ni\nv\nβ\n)\n2\n+L\nc\n‖x\ni\n‖\n2\n(x\n>\ni\nv\nθ\n)\n2\n+","2L\nb\n‖x\ni\n‖\n2\n|x\n>\ni\nβx\n>\ni\nθ|}‖ω\n1\n−ω\n2\n‖\n2\n≤C\n3\nX\n(L\na\n+","2L\nb\n+L\nc\n)‖ω\n1\n−ω\n2\n‖\n2\nwhereL\na\n,L\nb\n,","","andL\nc\nare","","Lipschitz","","constants","","from","","Lemma","","4,","","and","","for","","the","","first","","inequality\nwe","use","Lipschitz","and","H","̈older","inequalities","in","a","way","that|a\ni\n(ω\n1\n)−a\ni\n(ω\n2\n)|=|a(x\n>\ni\nβ\n1\n,x\n>\ni\nθ\n1\n)−\na(x\n>\ni\nβ\n2\n,x\n>\ni\nθ\n2\n)|","≤L\na\n‖x\n>\ni\n[ω\n1\n−ω\n2\n]‖\n2\n≤L\na\n‖x\ni\n‖\n2\n‖ω\n1\n−ω\n2\n‖\n2\n.","","","Therefor","","for","","anyωsuch","","that\n‖ω−ω\n0\n‖\n2\n≤\u000f\n0\n,","for\n\u000f\n0\n:=\nC\n0\nC\nλ\n2C\n3\nX\n(L\na\n+","2L\nb\n+L\nc\n)\n,\nwe","have,\nλ\nmin\n(O\n2\nR(ω))≥C\n0\nC\nλ\n36\n\nand","we","leth:=C\n0\nC\nλ\n.","","For","the","upper","bound","ofO\n2\nR(ω),\n‖O\n2\nR(ω)‖\n2\n=","","","","sup\nv;‖v‖\n2\n=1\nv\n>\nO\n2\nR(ω)v\n=E[a\ni\n(ω)(v\n>\nβ\nx\ni\n)\n2\n+c\ni\n(ω)(v\n>\nθ\nx\ni\n)\n2\n+","2b\ni\n(ω)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)]\n≤E[a\ni\n(ω)(v\n>\nβ\nx\ni\n)\n2\n+c\ni\n(ω)(v\n>\nθ\nx\ni\n)\n2\n+","2|b\ni\n(ω)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)|].\nUsing","Lemma","4","and","H","̈older’s","inequality,\n‖O\n2\nR(ω)‖\n2\n≤C\na\nE[(v\n>\nβ\nx\ni\n)\n2\n]","+","2E[(v\n>\nθ\nx\ni\n)\n2\n]","+","4E[|v\n>\nβ\nx\ni\n||v\n>\nθ\nx\ni\n|]\n≤(C\na\n+","6)C\n2\nX\n,\nwhereC\na\n:=","3","+C\nY\ne\nC\nX\nr\n.","","Therefore","we","can","take\nh=","(C\na\n+","6)C\n2\nX\n.\nNow","we","address","bounds","on","gradients.","","For","the","lower","bound,","","we","can","use","Proposition","1\nand","Cauchy-Schuwarz","inequality","to","obtain\n‖OR(ω)‖\n2\n‖ω−ω\n0\n‖\n2\n≥α‖ω−ω\n0\n‖\n2\n2\n.\nTherefore","for‖ω−ω\n0\n‖\n2\n≥\u000f\n0\n,‖OR(ω)‖\n2\n≥\u000f\n0\nα.","","We","can","setg\n:=\u000f\n0\nα.","","Finally,","for","the","upper\nbound","of‖OR(ω)‖\n2\n,","we","have,\nOR(ω)","=\n[\nE[({A\n′\n(h\ni\n(ω))−u\ni\n}h\n1i\n(ω)","+u\ni\n{−e\n−x\n>\ni\nβ\nz\ni\n+","2−σ(x\n>\ni\nβ+","logλ\n\u000f\n)})x\ni\n]\nE[{A\n′\n(h\ni\n(ω))−u\ni\n}h\n2i\n(ω)x\ni\n]\n]\n.\nTherefore,\n‖OR(ω)‖\n2\n=","","","","sup\nv;‖v‖\n2\n=1\nOR(ω)\n>\nv\n=E[{A\n′\n(h\ni\n(ω))−u\ni\n}h\n1i\n(ω)x\n>\ni\nv\nβ\n+{A\n′\n(h\ni\n(ω))−u\ni\n}h\n2i\n(ω)x\n>\ni\nv\nθ\n+{E[u\ni\n|x\ni\n](2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))−E[u\ni\nz\ni\n|x\ni\n]e\n−x\n>\ni\nβ\n}x\n>\ni\nv\nβ\n]\n37\n\nNoting|A\n′\n(h\ni\n(ω))−u\ni\n|≤1,","for","alli,","0≤h\n1\n,h\n2\n≤1,","and","also","using","Lemma","1,\n‖OR(ω)‖\n2\n≤E[|x\n>\ni\nv\nβ\n|+|x\n>\ni\nv\nθ\n|\n+σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n)σ(x\n>\ni\nθ\n0\n){(2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))\n−e\n−x\n>\ni\n(β\n0\n−β)\n(2−σ(x\n>\ni\nβ\n0\n+","logλ\n\u000f\n))}x\n>\ni\nv\nβ\n]\n≤E[(3","+","2e\n2C\nX\nr\n))|x\n>\ni\nv\nβ\n|+|x\n>\ni\nv\nθ\n|]\n≤2(3","+","2e\n2C\nX\nr\n)C\nX\n,\nand","we","can","set\ng:=","2(3","+","2e\n2C\nX\nr\n)C\nX\n.\nProof","for","Lemma","3.We","verify","Assumptions","1-3","in","Mei","et","al.","(2018).","","The","first","assumption","is\nto","verify","whether","the","gradient","of","the","loss","has","a","sub-Gaussian","tail.","The","second","assumption","is","to\nshow","that","the","Hessian","evaluated","on","a","unit","vector","is","sub-Exponential.","","The","third","assumption\nis","","about","","the","","Lipschitz","","continuity","","of","","the","","Hessian.","","","We","","mainly","","check","","whether","","quantities","","in\ninterest","satisfy","a","sub-gaussian/exponential","moment","bounds.","","We","recall,","forω=","(β,θ),\nOL\nn\n(β,θ)","=\n1\nn\nn\n∑\ni=1\n[\n{(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n1i\n(β,θ)−u\ni\nz\ni\ne\n−x\n>\ni\nβ\n+u\ni\n(2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))}x\ni\n(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n2i\n(β,θ)x\ni\n]\nLetc\n1i\n(β,θ)","",":=","","(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n1i\n(β,θ)−u\ni\nz\ni\ne\n−x\n>\ni\nβ\n+u\ni\n(2−σ(x\n>\ni\nβ+","logλ\n\u000f\n))}and\nc\n2i\n(β,θ)","=","(A\n′\n(h\ni\n(β,θ))−u\ni\n)h\n2i\n(β,θ).","","Similarly","as","in","the","proof","of","Theorem","2,|c\n1i\n(β,θ)|","≤\n3","+C\nY\ne\nC\nX\nr\n,|c\n2i\n(β,θ)|≤1","a.s.∀ω.","","Therefore,","eachOL\ni\n(ω)","isC\n1\nC\nY\ne\nC\nX\nr\nK\nX\nsub-Gaussian.\nWe","now","check","Hessian:\nO\n2\nL\ni\n(ω)","=\n[\na\ni\n(ω)x\ni\nx\n>\ni\nb\ni\n(ω)x\ni\nx\n>\ni\nb\ni\n(ω)x\ni\nx\n>\ni\nc\ni\n(ω)x\ni\nx\n>\ni\n]\nfora\ni\n(ω),b\ni\n(ω),","andc\ni\n(ω)","defined","in","(31).","","We","show","for","anyk≥1,‖v\n>\nO\n2\nL\ni\n(ω)v‖\nL\nk\n(P)\n≤Ck\nfor","someC","<∞.\nv\n>\nO\n2\nL\ni\n(ω)v=a\ni\n(ω)(v\n>\nβ\nx\ni\n)\n2\n+c\ni\n(ω)(v\n>\nθ\nx\ni\n)\n2\n+","2b\ni\n(ω)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)\n≤a\ni\n(ω)(v\n>\nβ\nx\ni\n)\n2\n+c\ni\n(ω)(v\n>\nθ\nx\ni\n)\n2\n+","2|b\ni\n(ω)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)|\n38\n\nand\n‖v\n>\nO\n2\nL\ni\n(ω)v‖\nL\nk\n(P)\n=‖a\ni\n(ω)(v\n>\nβ\nx\ni\n)\n2\n+c\ni\n(ω)(v\n>\nθ\nx\ni\n)\n2\n+","2b\ni\n(ω)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)‖\nL\nk\n(P)\n≤‖a\ni\n(ω)(v\n>\nβ\nx\ni\n)\n2\n‖\nL\nk\n(P)\n+‖c\ni\n(ω)(v\n>\nθ\nx\ni\n)\n2\n‖\nL\nk\n(P)\n+","2‖b\ni\n(ω)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)‖\nL\nk\n(P)\n≤(3","+C\nY\ne\nC\nX\nr\n)E[(v\n>\nβ\nx\ni\n)\n2k\n]\n1/k\n+","2E[(v\n>\nθ\nx\ni\n)\n2k\n]\n1/k\n+","4E[(v\n>\nβ\nx\ni\n)\n2k\n]\n1/2k\nE[(v\n>\nθ\nx\ni\n)\n2k\n]\n1/2k\n≤C\n1\nC\nY\ne\nC\nX\nr\nK\n2\nX\nk\nfor","an","absolute","constantC\n1\n>0.","","For","the","ifrst","inequality,","we","use","the","Minkowski’s","inequality,\nand","we","use","Lemma","4","for","the","third","inequality","to","bounda\ni\n(ω),b\ni\n(ω),","andc\ni\n(ω).\nLastly,","we","address","the","Lipschitz","continuity","of","the","Hessian.","","First","we","bound‖O\n2\nR(ω\n0\n)‖\nop\n:\nO\n2\nR(ω\n0\n)","=\n[\nE[a\ni\n(ω\n0\n)x\ni\nx\n>\ni\n]E[b\ni\n(ω\n0\n)x\ni\nx\n>\ni\n]\nE[b\ni\n(ω\n0\n)x\ni\nx\n>\ni\n]E[c\ni\n(ω\n0\n)x\ni\nx\n>\ni\n]\n]\nwe","have\n‖O\n2\nR(ω\n0\n)‖\nop\n=","","","","sup\nv;‖v‖\n2\n=1\nE[a\ni\n(ω\n0\n)(v\n>\nβ\nx\ni\n)\n2\n+c\ni\n(ω\n0\n)(v\n>\nθ\nx\ni\n)\n2\n+","2b\ni\n(ω\n0\n)(v\n>\nβ\nx\ni\n)(v\n>\nθ\nx\ni\n)]\n≤C\n2\nC\nY\nK\n2\nX\n,\nfor","some","absolute","constantC\n2\n>0,","and\nJ(x\ni\n,y\ni\n)",":=\n‖O\n2\nL\ni\n(ω\n1\n)−O\n2\nL\ni\n(ω\n2\n)‖\nop\n‖ω\n1\n−ω\n2\n‖\n2\n=‖\n[\n{a\ni\n(ω\n1\n)−a\ni\n(ω\n2\n)}x\ni\nx\n>\ni\n{b\ni\n(ω\n1\n)−b\ni\n(ω\n2\n)}x\ni\nx\n>\ni\n{b\ni\n(ω\n1\n)−b\ni\n(ω\n2\n)}x\ni\nx\n>\ni\n{c\ni\n(ω\n1\n)−c\ni\n(ω\n2\n)}x\ni\nx\n>\ni\n]\n‖\nop\n1\n‖ω\n1\n−ω\n2\n‖\n2\n=\n1\n‖ω\n1\n−ω\n2\n‖\n2\n[\nsup\nv;‖v‖\n2\n=1\n{a\ni\n(ω\n1\n)−a\ni\n(ω\n2\n)}(x\n>\ni\nv\nβ\n)\n2\n+","2{b\ni\n(ω\n1\n)−b\ni\n(ω\n2\n)}(x\n>\ni\nv\nβ\n)(x\n>\ni\nv\nθ\n)\n+{c\ni\n(ω\n1\n)−c\ni\n(ω\n2\n)}(x\n>\ni\nv\nθ\n)\n2\n]\n≤L\na\n‖x\ni\n‖\n2\n(x\n>\ni\nv\nβ\n)\n2\n+L\nc\n‖x\ni\n‖\n2\n(x\n>\ni\nv\nθ\n)\n2\n+","2L\nb\n‖x\ni\n‖\n2\n|x\n>\ni\nβx\n>\ni\nθ|\n≤(L\na\n+","2L\nb\n+L\nc\n)‖x\ni\n‖\n3\n2\nwhere","we","use","Lemma","4","to","bound","e.g.|a\ni\n(ω\n1\n)−a\ni\n(ω\n2\n)|","≤","‖Oa(s,t)‖\n2\n‖\n[\nx\n>\ni\n(β\n1\n−β\n2\n)\nx\n>\ni\n(θ\n1\n−θ\n2\n))\n]\n‖\n2\n≤\nL\na\n‖x\ni\n‖‖ω\n1\n−ω\n2\n‖\n2\n.\n39\n\nTherefore,E[J(x\ni\n,y\ni\n)]≤C\n5\nC\nY\ne\nC\nX\nr\nK\n3\nX\np\n3/2\nfor","","some","","absolute","","constantC\n5\n>0,","","since\nE[‖x‖\n3\n2\n]","=E[(\n∑\np\ni=1\nx\n2\ni\n)\n3/2\n]≤p\n1/2\nE[(\n∑\np\ni=1\n|x\ni\n|\n3\n)]≤3\n3/2\nK\n3\nX\np\n3/2\n.\nLemma","4.For","anyω∈B\n2\n(r),","and","(random)","functionsa,b,c:R×R→Rdefined","as\na(t,s)",":=A\n′′\n(h(t,s))h\n1\n(t,s)\n2\n+","(A\n′\n(h(t,s))−u\ni\n)h\n11\n(t,s)","+u\ni\nz\ni\ne\n−t\n−u\ni\nσ\n′\n(t+","logλ\n\u000f\n)\nb(t,s)",":=A\n′′\n(h(t,s))h\n1\n(t,s)h\n2\n(t,s)","+","(A\n′\n(h\ni\n(ω))−u\ni\n)h\n12,i\n(ω)\nc(t,s)",":=A\n′′\n(h(t,s))h\n2\n(t,s)\n2\n+","(A\n′\n(h(t,s))−u\ni\n)h\n22\n(t,s)\nwe","have,\n|a(t,s)|≤3","+C\nY\ne\nC\nX\nr\n,|b(t,s)|,|c(t,s)|≤2,∀t,s","","a.s.,\nand\n‖Oa(t,s)‖\n2\n≤C\n1\n+C\nY\ne\nC\nX\nr\n,‖Ob(t,s)‖\n2\n,‖Oc(t,s)‖\n2\n≤C\n2\na.s,\nwhereC\n1\nandC\n2\nare","some","absolute","constants.\nProof.First,A\n′′\n(t)≤0.25,∀t.","","We","also","haveh\n2\n(t,s)","=h\n1\n(s,t).","","Therefore","we","only","need","to\ncomputeh\n11\nandh\n12\nfor","terms","involving","second","derivatves","ofhsinceh\n22\n(t,s)","=h\n11\n(s,t).\nFrom","direct","computation,\nh\n11\n(t,s)","=−\ne\nt\n(1","+e\ns\n)\n(1","+e\ns\n+e\nt\n)\n2\nh\n12\n(t,s)","=\ne\nt+s\n(1","+e\ns\n+e\nt\n)\n2\nIn","particular,","max{|h\n11\n|,|h\n22\n|,|h\n12\n|}≤1,∀t,s.","","Therefore,\n|a(t,s)|≤3","+C\nY\ne\nC\nX\nr\n,|b(t,s)|,|c(t,s)|≤2,∀t,s\nusing","AssumptionA3.","","We","can","also","bound‖Oa(t,s)‖\n2\n,‖Ob(t,s)‖\n2\n,","and‖Oc(t,s)‖\n2\nsimilarly.\nSince","each‖Oa(t,s)‖\n2\n,‖Ob(t,s)‖\n2\n,","and‖Oc(t,s)‖\n2\nhave","terms","involvingA\n′′′\nand","third","order\npartial","derivatives","ofh,","we","need","to","boundA\n′′′\nand","third","order","partial","derivatives","ofh.","","Since\nh\n1\n(t,s)","=h\n2\n(s,t),","we","compute","bounds","forh\n111\n,h\n112\nandh\n122\n.\n40\n\nFrom","direct","calculation,","we","can","obtain,\nh\n111\n(t,s)","=\ne\n2t\n(1","+e\ns\n)\n(1","+e\nt\n+e\ns\n)\n3\n−\ne\nt\n(1","+e\ns\n)\n2\n(1","+e\nt\n+e\ns\n)\n3\nh\n112\n(t,s)","=\ne\nt\ne\ns\n(1","+e\ns\n)\n(1","+e\nt\n+e\ns\n)\n3\n−\ne\n2t\ne\ns\n(1","+e\nt\n+e\ns\n)\n3\nh\n122\n(t,s)","=\ne\nt\ne\ns\n(1","+e\nt\n+e\ns\n)\n3\n−\ne\n2s+t\n(1","+e\nt\n+e\ns\n)\n3\n+\ne\ns+2t\n(1","+e\nt\n+e\ns\n)\n3\nIn","particular,","they","are","all","bounded","by","3.","","We","have‖Oa(t,s)‖\n2\n≤C\n1\n+C\nY\ne\nC\nX\nr\n,\n‖Ob(t,s)‖\n2\n,‖Oc(t,s)‖\n2\n≤C\n2\nwhereC\n1\nandC\n2\nare","some","absolute","constants.\n41\n\nB","","","","Supplementary","Figures\nIn","this","section,","we","present","supplementary","figures","for","Section","4.","","Figure","3","plots","parametric\nestimation","","and","","prediction","","accuracy","","of","","each","","method","","including","","a","","PU-OMM","","method","","fitted\nwith","trueλ\n\u000f\n.","","Figure","4","plots","prediction","accuracy","(for","sizes","and","occurrences","of","events)","of","each\nmethod","based","on","MAD,","RMSE,","and","misclassification","rate.\nB.1","","","","Parametric","estimation","and","prediction","accuracy","of","each","method\nincluding","a","PU-OMM","method","fitted","with","the","true","hyperpa-\nrameter\na\nFigure","","3:","","Parametric","","estimation","","and","","prediction","","accuracy","","of","","Oracle,","","PU-OMM","","(est),","","PM-OMM\n(true),","LogNormal-Logistic,","LogNormal-Gamma","under","Settings","1-3.","","PU-OMM","(true)","refers","to","a\nPU-OMM","","method","","where","","trueλ\n\u000f\n(the","","value","","that","","was","","used","","in","","data","","generating","","process)","","is","","used\nand","PU-OMM","(est)","refers","to","a","PU-OMM","method","whereλ\n\u000f\nis","chosen","based","on","goodness","of","fit","of\nthe","observed","occurrence","(also","see","Implementation","Details","in","the","main","paper).","","PU-OMM(true)","is\ndropped","in","Setting","3","(Misspecification","2)","because","the","true","data","generating","process","does","not","involve\nλ\n\u000f\n.","","The","hyperparameterλ\n\u000f\nchosen","based","on","the","goodness","of","fit","of","the","observed","occurrence","was\ntypically","close","to","the","trueλ\n\u000f\n,","and","therefore,","the","performances","of","the","two","PU-OMM","methods","were\nvery","similar.\n42\n\nB.2","","","","Prediction","accuracy","of","each","method","using","metrics","of","MAD,\nRMSE,","and","misclassification","rate\nFigure","4:","","Prediction","accuracy","of","Oracle,","PU-OMM","(est),","PM-OMM","(true),","LogNormal-Logistic,\nGamma-Logistic","","under","","Settings","","1-3.","","","For","","each","","row,","","the","","first","","two","","panels","","(MAD,","","RMSE)","","show\nprediction","accuracy","results","using","MAD","(mean","absolute","deviation)","and","RMSE","(root","mean","squared\nerror).","The","last","panel","shows","the","misclassification","rate","of","each","method","in","predicting","event","occurrence.\nPU-OMM","(true)","refers","to","the","PU-OMM","method","where","trueλ\n\u000f\n(the","value","that","was","used","in","data\ngenerating","process)","is","used","and","PU-OMM","(est)","refers","to","the","PU-OMM","method","whereλ\n\u000f\nis","chosen\nbased","","on","","the","","goodness","","of","","fit","","of","","the","","observed","","occurrence.","","","PU-OMM(true)","","is","","dropped","","in","","Setting\n3","(Misspecification","2)","because","the","true","data","generating","process","does","not","involveλ\n\u000f\n.","","We","see","that\nin","terms","of","predicting","occurrence","of","an","event,","PU-OMM","performs","better","than","the","logistic","model\nwithin","the","LogNormal-Logistic","and","Gamma-Logistic","models,","and","performs","similarly","to","the","oracle\nmethod.","","In","terms","of","predicting","the","size","of","each","event,","statistically","meaningful","comparison","between\nthe","considered","methods","is","challenging,","as","the","associated","error","bars","overlap.","","Since","MAD","and","RMSE\nevaluate","prediction","errors","on","an","absolute","scale,","the","performances","were","heavily","affected","by","a","small\nnumber","","of","","observations","","with","","large","","magnitudes","","(which","","arise","","since","","the","","model","","for","","an","","event","","size","","is\nmultiplicative).","","In","all","cases,","the","performances","of","the","PU-OMM","methods","were","very","similar","to","the\noracle","method.\n43"],"doc3":["\n\nData","Generation","in","Low","Sample","Size","Setting","Using","Manifold","Sampling","and","a\nGeometry-Aware","VAE\nCl\n","́\nement","Chadebec\n1\nSt\n","́\nephanie","Allassonni\n`\nere\n1\nAbstract\nWhile","much","efforts","have","been","focused","on","improv-\ning","Variational","Autoencoders","through","richer","pos-\nterior","and","prior","distributions,","little","interest","was\nshown","in","amending","the","way","we","generate","the","data.\nIn","this","paper,","we","develop","two","nonprior-dependent\ngeneration","procedures","based","on","the","geometry","of\nthe","latent","space","seen","as","a","Riemannian","manifold.\nThe","first","one","consists","in","sampling","along","geodesic\npaths","which","is","a","natural","way","to","explore","the","latent\nspace","while","the","second","one","consists","in","sampling\nfrom","the","inverse","of","the","metric","volume","element\nwhich","is","easier","to","use","in","practice.","Both","methods\nare","then","compared","toprior-basedmethods","on","var-\nious","data","sets","and","appear","well","suited","for","a","limited\ndata","regime.","Finally,","the","latter","method","is","used","to\nperform","data","augmentation","in","a","small","sample","size\nsetting","and","is","validated","across","various","standard\nandreal-lifedata","sets.","In","particular,","this","scheme\nallows","to","greatly","improve","classification","results\non","the","OASIS","database","where","balanced","accuracy\njumps","from","80.7%","for","a","classifier","trained","with","the\nraw","data","to","89.1%","when","trained","only","with","the","syn-\nthetic","data","generated","by","our","method.","Such","results\nwere","also","observed","on","4","standard","data","sets.\n1.","Introduction\nDespite","the","apparent","availability","of","always","bigger","data","sets,\nthe","lack","of","data","remains","a","key","issue","for","many","fields","of","appli-\ncation.","One","of","them","is","medicine","where","practitioners","have\nto","deal","with","potentially","very","high","dimensional","data","(e.g.\nfunctional","Magnetic","Resonance","Imaging","for","neuroimaging)\nalong","with","very","low","sample","sizes","(e.g.rare","diseases)","which\nmake","statistical","analysis","challenging","and","unreliable","(But-\nton","et","al.,","2013;","Turner","et","al.,","2018).","In","addition,","the","strong\ndevelopment","of","algorithms","heavily","relying","on","the","deep","learn-\n1\nUniversit\n","́\ne","de","Paris,","INRIA,","INSERM,","Centre","de","Recherche\ndes","Cordeliers,","UMRS","1138,","Sorbonne","Universit\n","́\ne.","","Correspon-\ndence","","to:","","","Cl\n","́\nement","","Chadebec<clement.chadebec@sorbonne-\nuniversite.fr>.\nPreliminary","work.\ning","framework","(Goodfellow","et","al.,","2016)","and","requiring","a\nlarge","amount","of","data","has","made","the","need","for","data","augmenta-\ntion","(DA)","crucial","to","avoid","poor","performance","or","over-fitting\n(Shorten","&","Khoshgoftaar,","2019).","As","an","example,","a","classic\nway","to","perform","DA","on","images","consists","in","applying","simple\ntransformations","such","as","random","noise","or","cropping.","However,\nit","may","be","easily","understood","that","such","augmentation","tech-\nniques","are","strongly","data","set","dependant\n1\nand","may","still","require\npriorknowledge","of","the","data","or","the","intervention","of","an","expert\nassessing","the","relevance","of","the","augmented","samples.","The","re-\ncent","development","of","generative","models","such","as","Generative\nAdversarial","Networks","(GAN)","(Goodfellow","et","al.,","2014)","or\nVariational","AutoEncoders","(VAE)","(Kingma","&","Welling,","2014;\nRezende","et","al.,","2014)","paves","the","way","for","consideration","of\nanother","way","to","augment","the","training","data.","","While","GANs\nhave","already","seen","some","success","(Calimeri","et","al.,","2017;","Zhu\net","al.,","2017;","Lim","et","al.,","2018;","Antoniou","et","al.,","2018)","and\neven","for","medical","data","(Liu","et","al.,","2019;","Sandfort","et","al.,","2019)\nVAEs","have","been","of","less","interest","or","involve","marginal","gains\n(Zhuang","et","al.,","2019).","","We","can","nonetheless","cite","the","works\nof","(Nishizaki,","2017;","Hsu","et","al.,","2017;","Wu","et","al.,","2019)","who\nused","VAE","for","acoustic","models.\nOne","limitation","of","the","use","of","such","generative","models","relies\nin","their","need","of","a","large","amount","of","data","to","be","able","to","gener-\nate","faithfully.","Moreover,","the","generative","capacity","of","vanilla\nVAE","has","been","widely","discussed","since","when","compared","to\nGANs,","VAEs","produce","most","of","the","time","fuzzier","samples.","In\nrecent","years","much","effort","have","been","focused","on","improving\nthe","model","by","enhancing","the","variational","approximate","dis-\ntribution","using","for","example","MCMC","steps","(Salimans","et","al.,\n2015)","ornormalizing","flows(Rezende","&","Mohamed,","2015)\naiming","at","improving","the","Evidence","Lower","BOund","(ELBO)\n(Alemi","et","al.,","2016;","Burda","et","al.,","2016;","Higgins","et","al.,","2017;\nZhang","et","al.,","2018).","While","these","steps","resulted","in","major","im-\nprovements","of","the","model,","it","was","also","noted","that","as","expected\nthe","prior","distribution","plays","a","central","role","as","well","(Hoffman\n&","Johnson,","2016).","","A","natural","improvement","of","the","classic\nstandard","Gaussian","prior","consists","in","considering","a","Mixture","of\nGaussian","(Nalisnick","et","al.,","2016;","Dilokthanakul","et","al.,","2017)\nwhich","was","further","improved","with","the","Variational","Mixture\nof","Posterior","(Tomczak","&","Welling,","2018).","","Noting","that","the\n1\nThink","of","digits","where","rotating","a6gives","a9for","example.\narXiv:2103.13751v1","","[stat.ML]","","25","Mar","2021\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nvanilla","VAE","fails","to","apprehend","data","with","a","specific","geometry,\nmodellings","of","the","latent","space","as","a","hypersphere","(Davidson\net","al.,","2018)","or","a","Riemannian","manifold","(Arvanitidis","et","al.,\n2018;","Chen","et","al.,","2018;","Mathieu","et","al.,","2019;","Kalatzis","et","al.,\n2020)","were","also","proposed.","These","geometric","considerations\nrecently","led","to","the","proposal","of","a","model","combining","Rieman-\nnian","Hamiltonian","dynamics","(Girolami","et","al.,","2009;","Girolami\n&","Calderhead,","2011)","and","metric","learning","allowing","to","learn","a\nRiemannian","structure","over","the","latent","space","(Chadebec","et","al.,\n2020).","Nevertheless,","the","authors","still","used","a","standard","normal\ndistribution","to","generate","data","which","we","believe","allows","for","a\npoor","latent","space","prospecting.","While","changing","the","prior","or\nthe","posterior","distribution","has","been","widely","explored,","amend-\ning","the","whole","generation","procedure","has","still","been","poorly\ndiscussed.","","One","example","may","be","nonetheless","be","found","in\n(Arulkumaran","et","al.,","2016)","where","the","authors","proposed","to\nuse","a","Gibbs","sampler","like","generation","procedure","but","which\nproduces","correlated","samples.\nIn","this","paper,","we","take","a","rather","different","approach","and","argue\nthat","using","the","prior","distribution","to","generate","new","samples\nis","often","sub-optimal.","Firstly,","it","does","not","take","into","account\nthe","whole","structure","of","the","latent","space.","Secondly,","since","the\nchoice","of","the","prior","is","data","dependent","and","is","conditioned","by\nthe","tractability","of","the","ELBO,","it","is","rather","hard","to","find","the","best\nsuited","prior.","","Finally,","theprior-basedgeneration","methods\nfailure","is","even","more","visible","when","small","data","sets","are","con-\nsidered","since","priors","may","allow","the","sampling","of","areas","of","the\nlatent","space","with","potentially","very","poor","information.","These\nobservations","led","us","to","propose","the","following","contributions:\n•We","propose","a","nonprior-dependentgeneration","method\nusing","the","learned","geometry","of","the","latent","space.","It","con-\nsists","in","exploring","the","latent","space","using","a","Riemannian\nrandom","walk","which","aims","at","sampling","along","geodesics.\n•While","this","is","a","natural","way","to","explore","the","manifold,","we\nalso","introduce","a","second","method","consisting","in","sampling\nfrom","the","inverse","of","the","metric","volume","element","which","is\neasier","to","use","in","practice.","We","briefly","discuss","how","these\ntwo","methods","are","related.\n•Finally,","we","use","the","last","method","to","perform","data","aug-\nmentation","in","a","small","sample","size","setting","and","validate","its\nrobustness","on","standard","data","sets","and","real","data","from","the\nOASIS","database","(Marcus","et","al.,","2007)","where","it","allows\nto","remarkably","improve","classification","results.\n2.","Variational","Autoencoder\n2.1.","Model","Setting\nGiven","a","set","of","datax∈","X,","the","objective","of","a","VAE","is","to\nmaximise","the","likelihood","of","the","associated","parametric","model\n{P\nθ\n,θ∈Θ}.","","Assuming","that","there","exist","continuous","latent\nvariablesz∈","Zliving","in","a","smaller","spaceZ,","the","marginal\ndistribution","writes\np\nθ\n(x)","=\n∫\nZ\np\nθ\n(x|z)q(z)dz",",(1)\nwhereqis","a","prior","distribution","over","the","latent","variables","acting\nas","a","regularisation","factor","andp\nθ\n(x|z)is","most","of","the","time","a\nsimple","distribution","and","is","referred","to","as","thedecoder.","Since\nthe","integral","of","Eq.(1)is","most","of","the","time","intractable","so","is\nthe","posterior","distribution.","To","address","such","an","issue,","the","idea\nis","to","use","Variational","Inference","and","introduce","a","variational\ndistributionq\nφ\n(often","taken","as","Gaussian)","aiming","at","approx-\nimating","the","true","posterior","distribution","and","is","referred","to","as\ntheencoder(Kingma","&","Welling,","2014).","Using","Importance\nSampling","allows","to","derive","an","unbiased","estimate","ofp\nθ\n(x)\nˆp\nθ\n(x)","=\np\nθ\n(x|z)q(z)\nq\nφ\n(z|x)\nandE\nz∼q\nφ\n[\nˆp\nθ\n]\n=p\nθ\n(x).\nTherefore,","a","lower","bound","on","the","logarithm","of","the","objective\nfunction","of","Eq.(1)can","be","derived","using","Jensen’s","inequality:\nlogp\nθ\n(x)≥E\nz∼q\nφ\n[\nlogp\nθ\n(x,z)−logq\nφ\n(z|x)\n]\n︸︷︷︸\nELBO\n.\n(2)\nUsing","the","reparametrization","trick","makes","the","ELBO","tractable\nand","so","can","be","optimised","with","respect","to","bothθandφ,","the\nencoderanddecoderparameters.\n2.2.","Enhancing","the","Model\nSince","the","ELBO","is","only","a","lower","bound","on","the","true","objective\nfunction,","several","methods","to","make","it","tighter","were","proposed.\nTrying","to","tweak","the","approximate","posterior","distribution","is","one\nof","them.","To","do","so,","parametrized","invertible","mappings","called\nnormalizing","flows(NF)","were","proposed","tosamplezand","led\nto","richer","distributions","(Rezende","&","Mohamed,","2015).","Ideally,\nwe","would","like","to","have","access","to","NFs","targeting","the","true","pos-\nterior.","In","that","respect,","a","model","inspired","by","the","Hamiltonian\nMonte","Carlo","sampler","(HMC)","(Neal","&","others,","2011)","was","pro-\nposed","in","(Salimans","et","al.,","2015)","and","(Caterini","et","al.,","2018).\nThe","strength","of","such","a","model","relies","in","the","choice","of","the","NFs\nwhich","are","guided","by","the","gradient","of","the","true","posterior.","The\nauthors","of","(Chadebec","et","al.,","2020)","went","further","and","tried","to\nenrich","this","approach","with","some","geometrical","considerations.\nIn","their","paper,","they","saw","the","latent","space","as","a","Riemannian\nmanifold","endowed","with","a","Riemannian","metric","and","combined\nNFs","and","metric","learning","using","the","Riemannian","Hamiltonian\nMonte","Carlo","sampler","(Girolami","et","al.,","2009;","Girolami","&\nCalderhead,","2011)","to","propose","the","Riemannian","Hamiltonian\nVAE","(RHVAE).","While","several","papers","have","been","trying","to\npropose","Riemannian","metrics","(Arvanitidis","et","al.,","2018;","Chen\net","al.,","2018),","the","authors","proposed","to","parametrized","it","and\nlearn","it","directly","from","the","data.","Their","parametrization","writes\nG\n−1\n(z)","=\nN\n∑\ni=1\nL\nψ\ni\nL\n>\nψ\ni\nexp\n(\n−\n‖z−c\ni\n‖\n2\n2\nT\n2\n)\n+λI\nd\n,(3)\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nwhereNis","the","number","of","observations,L\nψ\ni\nare","lower","trian-\ngular","matrices","parametrized","with","neural","networks,c\ni\nare","the\ncentroidsandT(resp.λ)","are","non-negative","hyper-parameters.\nWhile","their","method","seems","quite","suited","for","the","small","sample\nsize","setting,","they","still","used","the","classic","generation","procedure\nconsisting","in","drawing","a","random","variable","from","the","prior","and\nfeeding","it","to","the","decoder","to","generate","new","samples.","We","be-\nlieve","that","such","an","approach","remains","sub-optimal.","Building\nupon","their","work,","we","propose","two","new","ways","of","generating\nsamples","relying","on","the","learned","geometry","of","the","latent","space.\nFirst,","we","recall","some","elements","of","Riemannian","geometry.\n3.","Some","Elements","on","Riemannian","Geometry\nIn","","the","","framework","","of","","differential","","geometry,","","one","","may","","de-\nfine","","a","","Riemannian","","manifoldMas","","a","","smooth","","manifold\nendowed","","with","","a","","Riemannian","","metricg.","","","The","","metric","","is","","a\nsmooth","inner","productg:p→","〈·|·〉\np\non","the","tangent","space\nT\np\nMdefined","","at","","each","","pointpof","","the","","manifoldM.","","","We\ncall","a","chartxa","homeomorphism","mapping","an","open","setU\nof","the","manifold","to","an","open","setVof","an","Euclidean","space.\nGivenp∈U,","","a","","chartx:","","(x\n1\n,...,x\nd\n)induces","","a","","basis\n(\n∂\n∂x\n1\n,...,\n∂\n∂x\nd\n)\np\non","the","tangent","spaceT\np\nM.","","Hence,","a","lo-\ncal","representation","of","the","Riemannian","metric","in","the","chart\nxcan","","be","","written","","as","","a","","positive","","definite","","matrixG(p)","","=\n(g\ni,j\n)\np,0≤i,j≤d\n=","(〈\n∂\n∂x\ni\n|\n∂\n∂x\nj\n〉\np\n)\n0≤i,j≤d\nforp∈M.","That","is\nforv,w∈T\np\nM,","we","have〈u|w〉\np\n=u\n>\nG(p)w.","The","length\nof","a","curveγbetween","two","points","of","the","manifoldz\n1\n,z\n2\n∈M\nand","parametrized","byt∈[0,1]such","thatγ(0)","","=z\n1\nand\nγ(1)","=z\n2\nis","given","by\nL(γ)","=\n1\n∫\n0\n‖","̇γ(t)‖\nγ(t)\ndt=\n1\n∫\n0\n√\n〈","̇γ(t)|","̇γ(t)〉\nγ(t)\ndt.\nCurves","minimising","such","a","length","are","calledgeodesicsand","a\ndistance","on","the","manifold","can","be","introduced:\nd(z\n1\n,z\n2\n)","=","min\nγ\nL(γ)","","s.t.","γ(0)","=z\n1\n,γ(1)","=z\n2\n.(4)\nThe","","manifoldMis","","said","","to","","begeodesically","","completeif\nall","geodesic","curves","can","be","extended","toR.","","In","other","words\nat","any","pointp∈","M,","one","may","draw","astraightline","(with\nrespect","to","the","formerly","defined","distance)","indefinitely","and","in\nany","direction.","","For","anyp∈","M,","the","exponential","map","atp\nmaps","a","vectorvof","the","tangent","spaceT\np\nMto","a","point","of","the\nmanifold","̃p∈","Msuch","that","the","geodesic","starting","atpwith\ninitial","velocityvreaches","̃pat","time","1.\nExp\np\n:\n{\nT\np\nM","→M\nv→Exp\np\n(v)","=γ\n(p,v)\n(1)\n,\nwhereγ\n(p,v)\nis","such","thatγ(0)","=pand","̇γ(0)","=v.","In","partic-\nular,","if","the","manifold","isgeodesically","complete,","thenExp\np\nis\ndefined","on","the","entire","tangent","spaceT\np\nMfor","anyp∈","M.\nConversely,","the","inverse","ofExp\np\nisLog\np\nwhich","maps","a","point\nof","the","manifoldMto","the","tangent","spaceT\np\nM.","A","statistical\nframework","can","be","developed","on","such","manifolds","allowing","to\ndefine","a","measuredM(p)","=\n√\ndetg(p)dpand","so","probabil-\nity","densities","on","Riemannian","manifolds","(Pennec,","2006).\n4.","The","Proposed","Methods\nIn","this","paper,","we","propose","two","new","sampling","procedures\nexploiting","the","Riemannian","structure","of","the","latent","space","and\nindependent","from","the","choice","of","the","prior","distribution.\n4.1.","Setting\nThe","","view","","we","","adopt","","is","","to","","consider","","the","","VAE","","as","","a","","tool","","to\nperform","dimensionality","reduction","by","extracting","the","latent\nstructure","of","the","data","within","a","smaller","space.","Having","learned\nsuch","a","structure,","we","propose","to","exploit","it","to","enhance","the\ndata","","generation","","process.","","","This","","differs","","from","","the","","standard\nfully","probabilistic","view","which","uses","the","prior","distribution","to\ngenerate.","We","believe","that","this","is","far","from","being","optimal","since\nthe","prior","appears","quite","strongly","data","dependent","and","must\nremain","simple","so","that","the","ELBO","is","tractable.","We","will","adopt\nthe","same","setting","as","the","one","exposed","in","(Chadebec","et","al.,\n2020).","The","latent","space","is","the","Riemannian","manifold","(R\nd\n,g)\nwheregis","the","Riemannian","metric","whose","local","representation\nis","","given","","by","","Eq.(3).","","","Since","","we","","work","","in","","an","","ambient-like\nmanifoldR\nd\n,","there","exists","a","global","chart","given","byφ=id\nand","we","assume","that","we","work","in","this","coordinate","system.\nProposition","","","1.\nThe","","","Riemannian","","","manifold(R\nd\n,g)is\ngeodesically","complete.\nProof.See","Appendix.","A.\nLet’s","assume","that","we","have","learned","a","latent","spaceZand","the\nmetricGwith","a","RHVAE.","Thanks","to","Prop.","2,","we","are","now\nable","to","refer","to","probability","distributions","on","the","manifoldZ.\n4.2.","The","Wrapped","Normal","Distribution\nThe","notion","of","normal","distribution","may","be","extended","to","Rie-\nmannian","manifolds","in","several","ways.","First,","it","can","be","charac-\nterised","as","the","maximum","entropy","distribution","and","involves\nthe","geodesic","distance","(Pennec,","2006).","Another","way","to","de-\nfine","a","normal","distribution","on","a","manifold","is","to","consider","the\nso-calledwrapped","normaldistribution.","","The","main","idea","is\nto","define","a","classic","Euclidean","normal","distributionN(0,Σ)\non","the","tangent","spaceT\np\nMfor","anyp∈","Mand","pushing","it\nforward","to","the","manifold","using","the","exponential","map.","","This\ndefines","a","probability","distribution","on","the","manifoldN\nW\n(p,Σ)\ncalled","thewrapped","normaldistribution.","Sampling","from","this\ndistribution","is","straight","forward","and","consists","in","drawing","a\nvelocity","in","the","tangent","space","fromN(0,Σ)and","mapping\nit","onto","the","manifold","using","the","exponential","map","(Mallasto\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\n−10−50510\n−10\n−5\n0\n5\n10\ngeodesic\nvelocity\nstarting","point\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\n−10−50510\n−10\n−5\n0\n5\n10\ngeodesic\nvelocity\nstarting","point\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nFigure","1.Geodesicshootingusing","the","exponential","map","for","differ-\nent","starting","points","(red","dots),","initial","velocities","(orange","arrows)","and\nlearned","metrics","whose","log-volume","element(\n√\ndetG(z))is","pre-\nsented","in","gray","scale.","The","resulting","paths","are","displayed","in","orange.\n−10−50510\n−10.0\n−7.5\n−5.0\n−2.5\n0.0\n2.5\n5.0\n7.5\n10.0\nrings\ncircles\nsamples\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\n−10−50510\n−10.0\n−7.5\n−5.0\n−2.5\n0.0\n2.5\n5.0\n7.5\n10.0\nrings\ncircles\nsamples\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nFigure","2.500","samples","from","of","astandardwrapped","Gaussian","distri-\nbutionN\nW\n(z,","I\nd\n)for","different","means","(purple","dots).","The","mean","of\nthe","posterior","associated","to","the","training","points","is","highlighted","with\nthe","crosses.","The","model","is","trained","on","180","binary","circles","and","rings\n(see","Appendix.","D","for","parameters","settings).\n&","Feragen,","2018).","","In","this","paper,","we","decide","to","work","with\nsuch","a","distribution","since","the","Riemannian","distance","of","Eq.(4)\ninvolves","an","optimisation","problem","which","is","pretty","hard","to\nsolve","in","general.","Moreover,","thewrapped","normalallows","for\na","latent","space","prospecting","along","geodesic","paths.","To","be","able\nto","use","it","we","nonetheless","need","to","computeExp\np\nwhich","can\nbe","performed","with","a","numerical","scheme","(see.","Appendix.","C).\nIn","Fig.","1","are","displayed","some","geodesic","paths","with","different\nlearned","metrics,","initial","velocities","(orange","arrows)","and","start-\ning","points","(red","dots).","","Fig.","2","shows","500","samples","from","the\nstandardwrappeddistributionN\nW\n(z,I\nd\n)in","two","different\nlocations","of","the","latent","space.","The","RHVAE","model","is","trained\non","a","synthetic","data","set","composed","by","180","binary","images","of\ncircles","and","rings","with","different","diameters","and","thicknesses.\nThe","log","of","the","metric","volume","element\n√\ndetGis","presented\nin","gray","scale","while","the","means","of","the","posteriors","associated\nto","training","data","are","represented","by","the","crosses.","As","expected\nthis","distribution","takes","into","account","the","local","geometry","of","the\nmanifold","thanks","to","the","geodesic","shooting","steps.","","This","is","a\nvery","interesting","property","since","it","encourages","the","sampling","to\nremain","close","to","the","data","as","geodesics","tend","to","travel","through\nlocations","with","the","lowest","volume","elements.\n4.3.","Method","1:","Riemannian","Random","Walk\nA","natural","way","to","explore","the","latent","space","of","a","VAE","is","to","use","a\nrandom","walk","like","algorithm","which","moves","from","one","location\nto","another","with","a","certain","probability.","","The","idea","here","is","to\ncreate","ageometry-awareMarkov","Chain","(z\nt\n)\nt∈N\nwherez\nt+1\nis","sampled","using","thewrappednormalz\nt+1\n∼N\nW\n(z\nt\n,Σ).\nHowever,","a","drawback","of","such","a","method","is","that","every","sample\nof","the","chain","is","accepted","regardless","of","its","relevance.","This","is\nparticularly","annoying","in","a","low","sample","size","setting","where\nmost","of","the","latent","space","has","not","been","prospected","and","thus\ncontains","poor","information","(see","Sec.","5.1).\n4.3.1.","QUANTIFYING","THESAMPLESQUALITY\nIdeally,","we","would","like","to","have","access","to","a","metric","providing\ninformation","on","the","quality","ofz\nt\n.","","This","would","allow","us","to\nignore","elements","of","the","chain","potentially","producingirrele-\nvantsamples","when","decoded.","This","measure","may","be","provided\nby","the","Riemannian","metric.","","By","design,","the","learned","metric\nis","such","that","it","has","a","high","volume","element","far","from","the","data\n(Chadebec","et","al.,","2020).","This","implies","that","the","volume","ele-\nment","encodes","in","a","way","the","amount","of","information","contained\nat","a","specific","location","of","the","latent","space.","The","higher","the","vol-\nume","element,","the","less","information","we","have.","The","same","idea\nwas","used","in","(Lebanon,","2006)","where","the","author","proposed","to\nsee","the","inverse","metric","volume","element","as","a","maximum","like-\nlihood","objective","to","perform","metric","learning.","This","aimed","at\nfinding","the","best","metric","ensuring","that","geodesic","paths","remain\nclose","to","the","data.","In","our","case","the","likelihood","definition","writes\nL(z)","=\nρ\nS\n(z)\n√\ndetG\n−1\n(z)\n∫\nR\nd\nρ\nS\n(z)\n√\ndetG\n−1\n(z)dz\n,(5)\nwhereρ\nS\n(z)","","=","","1ifz∈S,0otherwise,","andSis","taken\nas","a","compact","set","so","that","the","integral","is","well","defined.","","We\npropose","to","use","this","measure","to","assess","the","samples","quality","as\nanacceptance-rejectionrateαin","the","chain\nα(","̃z,z)","=","min\n(\n1,\n√\ndetG\n−1\n(","̃z)\n√\ndetG\n−1\n(z)\n)\n,\nwherezis","the","current","state","of","the","chain","and","̃zis","the","pro-\nposal","obtained","by","sampling","from","thewrappedGaussian\nN\nW\n(z,Σ).","","The","idea","is","to","compare","the","relevance","of","the\nproposed","sample","to","the","current","one.","The","ratio","is","such","that\nany","new","sample","improving","the","likelihood","metricLis","auto-\nmatically","accepted","while","a","sample","degrading","the","measure\nis","more","likely","to","be","rejected.","Finally,","a","pseudo-code","of","the\nproposed","method","is","provided","in","Alg.","1.\n4.3.2.","DISCUSSION\nIt","may","be","easily","understood","that","the","choice","of","the","covariance\nmatrixΣin","Alg.","1","has","quite","an","influence","on","the","resulting\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nAlgorithm","1Riemannian","random","walk\nInput:z\n0\n,Σ\nfort=","1→Tdo\nDrawv\nt\n∼N(0,Σ)\n","̃z\nt\n←Exp\nz\nt−1\n(v\nt\n)\nα=","min\n(\n1,\n√\ndetG\n−1\n(","̃z\nt\n)\n√\ndetG\n−1\n(z\nt−1\n)\n)\nAccept","the","proposal","̃z\nt\nwith","probabilityα\nifAcceptedthen\nz\nt\n←","̃z\nt\nelse\nz\nt\n←z\nt−1\nend","if\nend","for\nReturn[z\n1\n,···,z\nT\n]\nsampling.","","On","the","one","hand,","aΣwith","strong","eigenvalues\nwill","imply","drawing","velocities","of","potentially","high","magnitude\nallowing","for","a","better","prospecting.","Nonetheless,","the","proposals\nare","more","likely","to","be","rejected","since","geodesics","may","go","farther\nand","end","in","areas","with","lower","likelihood.","On","the","other","hand,\nsmall","eigenvalues","involve","a","high","acceptance","rate","but","it","will\ntake","a","longer","time","to","prospect","the","manifold.","","An","adaptive\nmethod","whereΣdepends","onGmay","be","considered","and\nwill","be","part","of","future","work.","","","Moreover,","","even","though","the\ncomputation","of","the","exponential","is","pretty","straightforward,\nit","","involves","","the","","use","","of","","a","","numerical","","scheme","","adding","","some\ncomputational","cost","to","the","method.\n4.4.","Method","2:","Metric","Sampling\nFor","the","second","method","referred","to","asmetric","sampling,","we\ntake","a","rather","different","approach","since","we","propose","to","directly\nsample","from","the","inverse","of","the","metric","volume","element","which\nis","seen","as","a","probability","distribution","onR\nd\nas","in","Eq.(5).","As\ndiscussed","above","the","inverse","volume","element","may","be","seen","as\na","likelihood","measure","assessing","the","quantity","of","information\nwithin","a","specific","area","of","the","latent","space.","","","This","property\nimplies","that","locations","having","the","most","information","will","also\nbe","the","most","prospected","throughout","the","sampling.","","","Since\nG\n−1\nhas","a","closed","form","(see","Eq.(3)),","sampling","from","this\ndistribution","is","pretty","straight","forward","with","classic","MCMC\nsampling","methods.","For","instance,","this","may","be","achieved","with\nthe","HMC","sampler","(Neal,","2005)","since","the","gradient","of","the\ntarget","log-density","is","easy","to","compute.\nWhile","this","method","seems","quite","different","from","Method","1,\nthey","remain","related","through","the","choice","of","the","covariance\nmatrixΣin","Alg.","1.","In","particular,","we","have","the","following\nRemark","1.\nIfΣhas","small","enough","eigenvalues","then","Alg.","1\nsamples","from","the","distribution","of","Eq.(5)defined","onR\nd\n.\nInformally,","it","tells","that","if","the","covariance","has","small","enough\neigenvalues,","then","the","velocity","drawn","in","Alg.","1","will","have","a\nsmall","magnitude.","Hence,","geodesic","curves","may","be","approxi-\nmated","by","straight","lines","and","so","the","ratio","becomes","a","Hasting-\nMetropolis","ratio.","This","is","discussed","in","Appendix.","B.","A","code\nfor","both","methods","is","given","in","the","supplementary","materials.\n5.","Experiments\nIn","this","section,","we","compare","the","samples","quality","using","the\nproposed","methods","on","various","standard","andreal-lifedata","sets.\nThen,","we","show","that","such","a","change","in","the","generation","process\nis","well","suited","to","perform","data","augmentation","in","particular","in\nthe","low","sample","size","setting.","To","stick","to","this","setting","we","only\nconsider","data","sets","with","tens","or","hundreds","of","samples.\n5.1.","Sampling","Comparison\nWe","first","compare","the","sampling","quality","betweenprior-based\nmethods","and","ours.\n5.1.1.","STANDARDDATASETS\nThe","methods","are","first","validated","on","a","hand-made","synthetic\ndata","set","composed","by","180","binary","images","of","circles","and","rings\nof","different","diameters","and","thicknesses","(see","training","samples\nin","Appendix.","E).","We","then","train","a","VAE","with","a","normal","prior,\na","VAE","with","a","VAMP","prior","and","a","RHVAE","until","the","ELBO\ndoes","not","improve","for","50","epochs.","Any","relevant","parameters\nsetting","is","stated","in","Appendix.","D.\nFig.","3","highlights","the","obtained","samplings","with","each","model","us-\ning","either","theprior-basedgeneration","procedure","or","the","ones\nproposed","in","this","paper.","","The","first","row","presents","the","learned\nlatent","space","along","with","the","means","of","the","posteriors","asso-\nciated","to","the","training","data","(crosses)","and","100","latent","space\nsamples","for","each","generation","method","(blue","dots).","The","second\nrow","displays","the","corresponding","decoded","images.","The","first\noutcome","of","such","a","study","is","that","sampling","from","the","prior","dis-\ntributionN(0,I\nd\n)leads","to","a","poor","latent","space","prospecting.\nTherefore,","even","with","balanced","training","classes,","we","end","up\nwith","a","model","over-representing","certain","elements","of","a","given\nclass","(rings).","This","is","even","more","striking","with","the","RHVAE\nsince","it","tends","to","stretch","the","resulting","latent","space.","This","effect\nseems","nonetheless","mitigated","by","the","use","of","a","multimodal\nprior","such","as","the","VAMP.","However,","another","limitation","of\nprior-basedmethods","is","that","they","may","sample","in","locations","of\nthe","latent","space","potentially","containing","very","few","information\n(i.e.where","no","data","is","available).","Since","the","decoder","appears\nto","interpolate","quite","linearly,","the","classic","scheme","will","gener-\nate","images","which","mainly","correspond","to","a","superposition","of\nsamples","(see","an","example","with","the","red","dots","in","Fig.","3","and","the\ncorresponding","samples","framed","in","red).","Moreover,","there","is\nno","way","to","assess","a","sample","quality","before","decoding","it","and\nassessing","visually","its","relevance.","These","limitations","may","lead\nto","a","(very)","poor","representation","of","the","actual","data","set","diversity\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nLatent\nspace\nVAE","-N(0,","I\nd\n)\n−505\n−6\n−4\n−2\n0\n2\n4\n6\ncircles\nrings\nsamples\nVAMP","-","VAE\n−40−2002040\n−75\n−50\n−25\n0\n25\n50\n75\ncircles\nrings\nsamples\nRHVAE","-N(0,","I\nd\n)\n−10−50510\n−10.0\n−7.5\n−5.0\n−2.5\n0.0\n2.5\n5.0\n7.5\n10.0\ncircles\nrings\nsamples\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nOurs","1\n−10−50510\n−10.0\n−7.5\n−5.0\n−2.5\n0.0\n2.5\n5.0\n7.5\n10.0\ncircles\nrings\nsamples\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nOurs","2\n−10−50510\n−10.0\n−7.5\n−5.0\n−2.5\n0.0\n2.5\n5.0\n7.5\n10.0\ncircles\nrings\nsamples\n−0.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\n3.0\nDecoded\nsamples\nFigure","3.Comparison","between","prior-based","generation","methods","and","the","proposed","Riemannian","random","walk","(ours","1)","and","metric","sampling\n(ours","2).","Top:","the","learned","latent","space","with","the","means","of","the","encoded","training","data","(crosses)","and","100","samples","for","each","method","(blue","dots).\nBottom:","the","resulting","decoded","images.","The","models","are","trained","on","180","binary","circles","and","rings","with","the","same","neural","network","architectures.\nA","comparison","on","reduced","versions","of","MNIST","and","FashionMNIST","is","also","available","in","Appendix.","E.\nwhile","presenting","quite","a","fewirrelevantsamples.\nImpressively,","sampling","along","geodesic","paths","or","using","metric\nsampling","leads","to","far","more","diverse","and","sharper","samples.","The\nnew","sampling","schemes","avoid","regions","that","have","been","poorly\nprospected","so","that","almost","every","decoded","sample","is","visually\nsatisfying","and","accounts","for","the","data","set","diversity.","","Finally,\nneither","method","over-fits","the","training","samples","since","1)","the\nsamples","are","not","always","located","on","the","means","of","the","encoded\ntraining","data,","2)","it","is","shown","in","Sec.","5.2","that","classifiers","can\nachieve","significantly","better","classification","results","on","synthetic\ndata","than","onrawtraining","samples","proof","of","generalisation\npower.","","Similar","effects","are","observed","on","reduced","versions\nof","MNIST","(LeCun,","1998)","and","FashionMNIST","(Xiao","et","al.,\n2017)","where","samples","are","most","of","the","time","degraded","with","the\nclassic","methods","while","the","proposed","ones","allow","a","sampling\nof","more","diverse","and","sharper","samples","(see","Appendix.E).\n5.1.2.","OASIS","DATABASE\nThe","new","generation","schemes","are","then","assessed","on","the","pub-\nlicly","available","OASIS","database","composed","by","416","patients\naged","18","to","96,","100","of","whom","have","been","diagnosed","with","very\nmild","to","moderate","Alzheimer","disease","(AD).","The","MR","images\nwe","use","for","this","experiment","are","208x176","gray","scale","images\nwith","a","mask","notifying","brain","tissues","and","are","referred","to","as","the\nmasked","T88","imagesin","(Marcus","et","al.,","2007).","We","refer","the\nreader","to","their","paper","for","further","image","preprocessing","details.\nA","VAE","and","a","RHVAE","are","then","trained","to","generate","either\ncognitively","normal","(CN)","or","AD","patients","with","the","same","early\nstopping","criteria","as","before.","Fig.","4","shows","samples","extracted\nfrom","the","training","set","(top),","MRI","generated","by","a","vanilla","VAE\n(2\nnd\nrow),","images","from","the","Riemannian","random","walk","we\npropose","(3\nrd\nrow)","and","with","the","proposed","metric","sampling\nmethod","(bottom).","","For","each","method,","the","upper","row","shows\nimages","","of","","patients","","diagnosed","","CN","","while","","the","","bottom","","row\npresents","an","AD","diagnosis.","Again","the","proposed","samplings\nseem","able","to","generate","a","wider","range","of","sharp","samples","while\nthe","VAE","appears","to","produce","non-realistic","degraded","images\nwhich","are","very","similar","(see","red","frames).","For","example,","the\nproposed","schemes","allow","us","to","generate","realisticold\n2\npatients\nwith","no","AD","(blue","frames)","or","younger","patients","with","AD","(or-\nange","frames)","even","though","they","are","under-represented","in","the\ntraining","set.","","Generating","100","images","of","OASIS","database\ntakes","1","min.","","with","the","first","proposed","method","and","40","sec.\n3\nwith","metric","sampling","with","Intel","Core","i7","CPU","(6x1.1GHz)\nand","16","GB","RAM.\n5.2.","Data","Augmentation\nSince","the","proposed","methods","seem","to","be","able","to","produce\nsamples","keeping","the","intrinsic","topology","of","the","data","even","with\nsmall","size","data","sets,","we","propose","to","use","Method","2","(i.e.metric\nsampling)","which","is","easier","to","use","in","practice","and","produces\napparent","equivalent","results","to","Method","1","to","perform","data\naugmentation.","","The","idea","is","to","1)","create","asmall","sizedata\nset;","2)","train","a","VAE","to","generate","labelled","samples","for","each\nclass","of","the","train","set;","3)","train","a","classifier","on","the","train","set,","the\naugmented","train","set","or","the","synthetic","data","only.\n2\nAn","older","person","is","characterised","by","larger","ventricles.\n3\nDepends","on","the","chains’","length","(here","200","steps","per","image).\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nTrain","(CN)\nTrain","(AD)\nVAE","(CN)\nVAE","(AD)\nOurs","1","(CN)\nOurs","1","(AD)\nOurs","2","(CN)\nOurs","2","(AD)\nFigure","4.Generation","","of","","CN","","or","","AD","","patients","","from","","the","","OASIS\ndatabase.","","","Training","samples","(top),","","generation","with","a","VAE","and\nnormal","prior","(2\nnd\nrow),","with","the","Riemannian","random","walk","(3\nrd\nrow)","and","with","metric","sampling","(bottom).","","Generating","using","the\nprior","leads","to","either","unrealistic","images","or","similar","samples","(red\nframes)","while","the","proposed","methods","generate","sharper","and","more\ndiverse","samples.","For","instance,","they","are","able","to","generate","CNolder\npatients","(blue","frames)","or","younger","AD","(orange","frames)","even","though\nthey","are","under-represented","within","the","training","set.\n5.2.1.","STANDARDDATASETS\nFirst,","we","test","the","method","on","four","reduced","data","sets","extracted\nfromwell-knowndatabases.","","The","first","data","set","is","created\nby","selecting","500","samples","from","10","classes","of","MNIST","ensur-\ning","balanced","classes.","The","second","one","consists","in","selecting\nagain","500","samples","from","the","MNIST","database","but","applying\na","random","split","such","that","some","classes","areover-represented.\nThen,","we","select","500","samples","from","10","classes","of","the","EMNIST\ndatabase","(Cohen","et","al.,","2017).","","These","classes","are","selected\nsuch","that","they","are","composed","by","both","lowercase","and","upper-\ncase","characters","so","that","we","end","up","with","a","small","database\nwith","strong","variability","within","classes.","The","balance","we","use\nmatches","the","one","in","the","initial","data","set.","","Finally,","we","create\nanother","balanced","one","with","300","samples","from","3","classes","of\nFashionMNIST","(T-shirt,dressandshirt).","","These","data","sets\nare","then","split","such","that","80%","is","allocated","for","training","(re-\nferred","to","as","theraw","data)","and","20%","for","validation.","","For","a\nfair","comparison,","we","use","the","original","test","set","(e.g.∼1000\nsamples","per","class","for","MNIST)","to","test","the","classifiers.","","This\nensures","statistically","meaningful","results","while","assessing","the\ngeneralisation","power","on","unseen","data.\n5.2.2.","THEAUGMENTATIONMETHODS\nOn","the","one","hand,","theraw","dataare","augmented","by","a","factor","5,\n10","and","15","using","classic","data","augmentation","methods","(random\nnoise,","cropping","etc.).","On","the","other","hand,","VAE","and","RHVAE\nmodels","are","trained","individually","on","each","class","of","theraw\ndatauntil","the","ELBO","does","not","improve","for","20","epochs.","The\ngenerative","models","are","then","used","to","produce","200,","500,","1000\nor","2000","new","synthetic","samples","per","class","using","either","the\nclassic","generation","scheme","(i.e.the","prior)","or","metric","sampling.\n5.2.3.","RESULTS\nWe","then","train","a","DenseNet","model\n4\n(Huang","et","al.,","2017)","with\n5","independent","runs","on","1)","theraw","data;","2)","the","augmented\ndata","using","basic","transformations;","","3)","the","augmented","data\nusing","the","VAE","models","and","each","generation","method;","4)","only\nthe","synthetic","data","generated","by","the","VAEs.","The","DenseNet","is\ntrained","until","the","loss","does","not","improve","on","the","validation","set\nfor","50","epochs.","We","report","the","mean","accuracy","and","standard\ndeviation","on","the","test","set","for","each","method","in","Table.","1.\nThe","first","outcome","of","such","a","study","is","that","as","expected","gen-\nerating","new","samples","using","the","proposed","method","improves\ntheir","relevance.","","This","may","be","seen","first","by","comparing","the\nresults","in","the","second","section","of","the","table","corresponding","to\nthe","augmented","data","sets","(i.e.","raw","data+","synthetic)","where\nmetric","sampling","indeed","allows","for","a","quite","significant","gain","in\nthe","model","accuracy.","It","is","even","more","striking","when","looking","at\nthe","last","section","of","Table.","1","in","which","only","synthetic","samples\nare","used","to","train","the","classifier.","For","instance,","when","we","only\ngenerate","200","synthetic","samples","per","class","for","MNIST","with","a\nVAE","or","RHVAE","and","train","the","classifier","on","them,","the","classic\nmethod","fails","to","produce","meaningful","samples","since","a","loss","of\n20","to","30","pts","in","accuracy","combined","with","high","uncertainty\nis","observed","when","compared","to","theraw","data.","Interestingly,\nsampling","from","the","inverse","of","the","metric","volume","element\nseems","to","avoid","such","an","effect.","Even","more","impressive","is","the\nfact","that","we","are","able","to","produce","synthetic","data","sets","on","which\nthe","classifier","outperforms","greatly","the","results","observed","on\ntheraw","data(3","to","6","pts","gain","in","accuracy)","while","keeping","a\nrelatively","low","standard","deviation","(see","gray","cells).\nSecondly,","this","example","also","shows","why","geometric","data","aug-\nmentation","methods","are","still","questionable","and","data","set","de-\npendent.","For","instance,","augmenting","theraw","databy","a","factor\n10","(including","flips","and","rotations)","does","not","seem","to","have","a\nsignificant","effect","on","the","MNIST","data","sets","while","it","still","im-\nproves","results","on","EMNIST","and","FashionMNIST.","Finally,","the\nproposed","method","appears","quite","robust","to","data","set","changes\nand","produces","the","best","results","allowing","for","a","significant","gain\nwhen","compared","to","theraw","data.\n4\nWe","use","the","code","in","(Amos,","2020)","(See","Appendix.","D).\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nTable","1.Data","augmentation","with","a","DenseNet","model","as","Benchmark\nusing","either","geometric","transformations","(Aug.),","a","(RH)VAE","and\nthe","classic","generation","method","or","metric","sampling","(ours).","","Mean\naccuracy","and","standard","deviation","across","5","independent","runs","are\nreported.","","In","gray","are","the","cells","where","the","accuracy","is","higher","on\nsynthetic","data","than","on","theraw","data.","The","test","set","is","the","one","proposed\nin","the","original","data","set","(e.g.∼1000","samples","per","class","for","MNIST).\nDATA","SETSMNIST\nMNISTEMNIST\nFASHION\n(UNBAL.)(UNBAL.)\nRAW","DATA89.89","(0.6)81.55","(0.7)82.61","(1.4)76.00","(1.5)\nRAW+","SYNTHETIC\nAUG.","(X5)92.80","(0.4)86.46","(0.9)85.56","(1.3)77.47","(2.0)\nAUG.","(X10)88.25","(2.2)81.98","(2.4)85.75","(0.3)79.20","(0.7)\nAUG.","(X15)92.84","(0.7)85.85","(3.4)86.59","(0.8)80.03","(0.5)\nVAE-200*88.53","(0.9)84.05","(2.0)81.74","(3.0)78.59","(0.4)\nVAE-500*90.37","(1.4)87.33","(1.2)83.40","(1.6)78.68","(0.3)\nVAE-1K*91.17","(1.0)86.01","(2.5)84.35","(1.6)77.61","(2.1)\nVAE-2K*92.19","(1.6)87.97","(2.2)85.98","(0.2)79.29","(1.1)\nRHVAE-200*89.90","(0.5)82.26","(0.9)82.96","(1.3)77.58","(1.3)\nRHVAE-500*90.87","(1.1)83.96","(3.2)84.38","(1.2)78.03","(1.3)\nRHVAE-1K*91.71","(0.8)84.72","(1.8)84.70","(2.4)79.31","(1.6)\nRHVAE-2K*92.74","(1.4)86.78","(1.0)84.92","(2.1)79.03","(1.4)\nOURS-200*90.98","(1.1)84.07","(2.0)85.11","(1.1)76.96","(0.8)\nOURS-500*92.33","(1.1)87.69","(0.9)85.06","(1.1)78.51","(0.9)\nOURS-1K*93.25","(0.8)89.71","(0.8)87.02","(1.0)80.16","(0.8)\nOURS-2K*94.29","(0.8)89.11","(1.9)87.59","(0.8)78.13","(1.8)\nSYNTHETIC","ONLY\nVAE-200*69.89","(1.5)64.58","(1.8)65.67","(2.6)73.90","(3.0)\nVAE-500*72.34","(4.2)69.42","(4.1)67.32","(2.4)71.42","(8.5)\nVAE-1K*83.40","(2.4)74.69","(3.2)75.31","(1.4)71.42","(6.1)\nVAE-2K*86.55","(2.2)79.61","(3.8)78.85","(3.0)\n76.73","(1.6)\nRHVAE-200*76.03","(1.8)61.53","(2.9)59.84","(2.6)72.78","(3.6)\nRHVAE-500*79.99","(2.2)66.77","(3.3)66.94","(4.0)74.33","(2.6)\nRHVAE-1K*82.01","(2.9)69.28","(1.8)73.65","(4.1)75.96","(4.1)\nRHVAE-2K*85.21","(3.9)77.32","(3.2)68.56","(2.3)74.31","(3.1)\nOURS-200*87.19","(1.1)79.50","(1.6)77.05","(1.6)76.96","(0.8)\nOURS-500*89.06","(1.3)80.36","(2.1)80.16","(2.0)78.47","(0.8)\nOURS-1K*90.15","(1.4)86.24","(1.8)82.61","(1.3)79.31","(0.6)\nOURS-2K*\n92.60","(1.1)87.55","(1.3)86.03","(1.0)78.29","(0.9)\n*","NUMBER","","OF","GENERATED","SAMPLES\n5.2.4.","OASIS","DATASET\nWe","now","validate","the","proposed","data","augmentation","method\non","areal-lifedatabase.","We","choose","to","use","again","the","OASIS\ndata","set","which","according","to","us","represents","a","nice","example","of\nday-to-day","challenges","practitioners","have","to","face.","","We","con-\nsider","the","binary","classification","problem","consisting","in","trying\nto","detect","MRI","of","patients","having","been","diagnosed","AD.","Then,\nwe","split","the","416","images","into","a","training","set","(70%)","referred","to\nas","theraw","data,","a","validation","set","(10%)","and","a","test","set","(20%).\nThe","VAE","and","RHVAE","models","are","trained","on","theraw","datato\ngenerate","either","AD","or","CN","patients","until","the","ELBO","does","not\nimprove","for","50","epochs.","A","MLP","classifier","is","then","trained","with\n5","independent","runs","on","1)","theraw","data;","2)","the","augmented\ndata","using","geometric","transformations;","","3)","the","augmented\ndata","using","the","VAEs","and","the","classic","generation","or","metric\nsampling;","5)","only","the","synthetic","data.","We","adopt","an","early","stop-\nping","strategy","and","stop","training","if","the","validation","loss","does","not\nimprove","for","20","epochs.","The","global","and","balanced","accuracy\nTable","2.Data","augmentation","on","the","OASIS","database","with","a","MLP\nmodel","as","Benchmark","using","either","geometric","transformations,","a\nVAE","and","the","classic","generation","method","or","metric","sampling","(ours).\nGlobal","and","balanced","accuracy","across","5","runs","are","reported.\nDATA","","SETSGLOBALACCURACYBALANCEDACCURACY\nRAW","DATA84.29","(2.2)80.71","(4.0)\nRAW+","SYNTHETIC\nAUGMENTED(X5)84.76","(2.3)83.84","(3.8)\nAUGMENTED(X10)83.81","(1.8)76.77","(3.8)\nAUGMENTED(X15)82.38","(2.0)76.26","(3.0)\nVAE-200\n∗\n81.90","(2.3)79.59","(1.6)\nVAE-500\n∗\n87.14","(1.4)80.50","(0.5)\nVAE-1000\n∗\n83.33","(0.0)81.31","(0.0)\nVAE-2000\n∗\n82.38","(0.5)80.71","(0.3)\nOURS-200\n∗\n84.76","(6.0)85.86","(3.0)\nOURS-500\n∗\n86.43","(2.7)86.11","(1.0)\nOURS-1000\n∗\n86.19","(2.3)85.96","(2.6)\nOURS-2000\n∗\n88.33","(0.5)85.30","(1.9)\nSYNTHETIC","ONLY\nVAE-200\n∗\n74.52","(0.9)80.55","(1.6)\nVAE-500\n∗\n83.10","(4.8)78.33","(1.9)\nVAE-1000\n∗\n75.00","(0.0)80.05","(0.0)\nVAE-2000\n∗\n76.19","(0.0)80.41","(0.8)\nOURS-200\n∗\n89.05","(0.5)86.97","(0.3)\nOURS-500\n∗\n89.05","(0.5)88.58","(1.1)\nOURS-1000\n∗\n89.29","(0.0)89.14","(0.0)\nOURS-2000\n∗\n89.05","(0.5)88.58","(1.1)\n*","NUMBER","","OF","GENERATED","SAMPLES\nare","available","in","Table.","5","(the","remaining","main","metrics","are\navailable","in","Appendix.","F).","In","this","experiment,","using","the","new\ngeneration","scheme","again","improves","overall","the","metrics","when\ncompared","to","theraw","dataand","other","augmentation","methods.\nInterestingly","enough,","the","classifier","even","outperforms","any\nother","method","when","trained","on","synthetic","data","only","where\nmean","balanced","accuracy","reaches","89.14","vs.","80.71","on","theraw\ndata.","","This","may","be","due","to","the","fact","that","generated","samples\nwill","insist","on","the","most","dominant","features","of","the","data","while\nremoving","some","potentiallybias","inducinginformation.\n6.","Conclusion\nIn","this","paper,","we","explored","two","new","ways","of","generating","new\nsamples","from","","a","VAE","exclusively","","relying","on","","the","learned\ngeometry","","of","","the","","latent","","space.","","","In","","particular,","","these","","meth-\nods","do","not","depend","on","the","choice","of","the","prior","distribution\nwhich","is","usually","used","to","generate.","","The","first","one","consisted\nin","defining","a","Riemannian","random","walk","aiming","at","sampling\nalong","geodesic","paths","while","the","second","one","involved","sam-\npling","from","the","inverse","of","the","metric","volume","element.","It","was\nshown","that","those","methods","enhance","greatly","the","data","gener-\nation","process","in","the","low","sample","size","setting","thanks","to","their\nability","toquantifythe","amount","of","information","contained","at\na","specific","location","of","the","latent","space.","The","second","method,\nwhich","is","easy","to","use","in","practice","since","the","inverse","metric","has\na","closed","form","expression,","was","used","to","perform","data","aug-\nmentation","with","well-known","classifiers","on","severalstandard\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nandreal-life","smallsize","data","sets.","For","each","experiment,","the\nproposed","method","allowed","for","a","great","gain","in","classification\nresults","while","demonstrating","a","strong","generalisation","power\nsince","the","classifiers","achieved","better","results","on","synthetic","data\nthan","on","theraw","data.","","Finally,","we","quickly","discussed","how\nthe","two","proposed","methods","are","related.","Future","work","would\nconsist","in","trying","to","extend","these","generation","methods","to","VAE\nmodels","with","different","metrics","and","validate","the","augmentation\nmethod","on","even","more","challenging","data","such","as","volumes.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nReferences\nAlemi,","","A.","A.,","","Fischer,","","I.,","","Dillon,","","J.","V.,","","and","Murphy,","","K.\nDeep","variational","information","bottleneck.arXiv","preprint\narXiv:1612.00410,","2016.\nAmos,","","","B.bamos/densenet.pytorch,","","","December","","2020.\nURLhttps://github.com/bamos/densenet.\npytorch.","original-date:","2017-02-09T15:33:23Z.\nAntoniou,","A.,","Storkey,","A.,","and","Edwards,","H.","Data","augmenta-\ntion","generative","adversarial","networks.arXiv:1711.04340\n[cs,","stat],","March","2018.","","URLhttp://arxiv.org/\nabs/1711.04340.","arXiv:","1711.04340.\nArulkumaran,","K.,","Creswell,","A.,","and","Bharath,","A.","A.","Improv-\ning","sampling","from","generative","autoencoders","with","Markov\nchains.arXiv","preprint","arXiv:1610.09296,","3:13,","2016.\nArvanitidis,","","G.,","","Hansen,","","L.","K.,","","and","Hauberg,","","S.","","","Latent\nspace","oddity:","On","the","curvature","of","deep","generative","mod-\nels.arXiv:1710.11379","","[stat],","","January","","2018.URL\nhttp://arxiv.org/abs/1710.11379.arXiv:\n1710.11379.\nBurda,","Y.,","Grosse,","R.,","and","Salakhutdinov,","R.","","Importance\nweighted","","autoencoders.arXiv:1509.00519","","[cs,","","stat],\nNovember","2016.","","","URLhttp://arxiv.org/abs/\n1509.00519.","arXiv:","1509.00519.\nButton,","K.","S.,","Ioannidis,","J.","P.,","Mokrysz,","C.,","Nosek,","B.","A.,\nFlint,","J.,","Robinson,","E.","S.,","and","Munaf\n`\no,","M.","R.","","","Power\nfailure:","why","small","sample","size","undermines","the","reliability\nof","neuroscience.Nature","Reviews","Neuroscience,","14(5):\n365–376,","2013.","Number:","5","Publisher:","Nature","Publishing\nGroup.\nCalimeri,","F.,","Marzullo,","A.,","Stamile,","C.,","and","Terracina,","G.\nBiomedical","data","augmentation","using","generative","adver-\nsarial","neural","networks.","","In","Lintas,","A.,","Rovetta,","S.,","Ver-\nschure,","P.","F.,","and","Villa,","A.","E.","(eds.),Artificial","Neural\nNetworks","and","Machine","Learning","–","ICANN","2017,","","vol-\nume","","10614,","","pp.","","626–634.","","Springer","","International","","Pub-\nlishing,","","Cham,","","2017.","","","ISBN","","978-3-319-68611-0","","978-\n3-319-68612-7.","","","doi:","","10.1007/978-3-319-68612-771.\nURLhttp://link.springer.com/10.1007/\n978-3-319-68612-7_71\n.Series","","Title:","","","Lecture\nNotes","in","Computer","Science.\nCaterini,","A.","L.,","Doucet,","A.,","and","Sejdinovic,","D.","","Hamilto-\nnian","variational","auto-encoder.","","","InAdvances","in","Neural\nInformation","Processing","Systems,","pp.","8167–8177,","2018.\nChadebec,","","","C.,","","","Mantoux,","","","C.,","","","and","","","Allassonni\n`\nere,","","","S.\nGeometry-aware","","Hamiltonian","","variational","","autoencoder.\narXiv:2010.11518","[cs,","math,","stat],","October","2020.","URL\nhttp://arxiv.org/abs/2010.11518.arXiv:\n2010.11518.\nChen,","N.,","Klushyn,","A.,","Kurle,","R.,","Jiang,","X.,","Bayer,","J.,","and\nSmagt,","P.","Metrics","for","deep","generative","models.","pp.","1540–\n1550.","PMLR,","2018.","ISBN","2640-3498.\nCohen,","","G.,","","Afshar,","","S.,","","Tapson,","","J.,","","and","","van","","Schaik,","","A.\nEMNIST:","","an","","extension","","of","","MNIST","","to","","handwritten","","let-\nters.arXiv:1702.05373","","[cs],","","","March","","2017.URL\nhttp://arxiv.org/abs/1702.05373.arXiv:\n1702.05373.\nDavidson,","T.","R.,","Falorsi,","L.,","De","Cao,","N.,","Kipf,","T.,","and","Tom-\nczak,","","J.","M.","","","Hyperspherical","variational","auto-encoders.\narXiv:1804.00891","","[cs,","","stat],","","September","","2018.","","","","URL\nhttp://arxiv.org/abs/1804.00891.arXiv:\n1804.00891.\nDilokthanakul,","N.,","Mediano,","P.","A.","M.,","Garnelo,","M.,","Lee,","M.\nC.","H.,","Salimbeni,","H.,","Arulkumaran,","K.,","and","Shanahan,","M.\nDeep","unsupervised","clustering","with","Gaussian","mixture","vari-\national","autoencoders.arXiv:1611.02648","[cs,","stat],","Jan-\nuary","2017.","","URLhttp://arxiv.org/abs/1611.\n02648.","arXiv:","1611.02648.\nGirolami,","","M.","","and","","Calderhead,","","B.Riemann","","manifold\nLangevin","and","Hamiltonian","Monte","Carlo","methods.Jour-\nnal","of","the","Royal","Statistical","Society:","Series","B","(Statistical\nMethodology),","73(2):123–214,","2011.","","Number:","","2","Pub-\nlisher:","Wiley","Online","Library.\nGirolami,","M.,","Calderhead,","B.,","and","Chin,","S.","A.","","","Rieman-\nnian","manifold","Hamiltonian","Monte","Carlo.arXiv","preprint\narXiv:0907.1100,","2009.\nGoodfellow,","","I.,","","Pouget-Abadie,","","J.,","","Mirza,","","M.,","","Xu,","","B.,\nWarde-Farley,","D.,","Ozair,","S.,","Courville,","A.,","and","Bengio,\nY.","","Generative","adversarial","nets.","","InAdvances","in","Neural\nInformation","Processing","Systems,","pp.","2672–2680,","2014.\nGoodfellow,","I.,","Bengio,","Y.,","Courville,","A.,","and","Bengio,","Y.\nDeep","learning,","volume","1.","","MIT","press","Cambridge,","2016.\nIssue:","2.\nHiggins,","I.,","Matthey,","L.,","Pal,","A.,","Burgess,","C.,","Glorot,","X.,\nBotvinick,","","M.,","","Mohamed,","","S.,","","and","Lerchner,","","A.","","","beta-\nVAE:","Learning","basic","visual","concepts","with","a","constrained\nvariational","framework.ICLR,","2(5):6,","2017.","Number:","5.\nHoffman,","","M.","D.","and","Johnson,","","M.","J.","","","Elbo","surgery:","","yet\nanother","way","to","carve","up","the","variational","evidence","lower\nbound.InWorkshop","","in","","Advances","","in","","Approximate\nBayesian","Inference,","NIPS,","volume","1,","pp.","","2,","2016.\nHsu,","W.-N.,","Zhang,","Y.,","and","Glass,","J.","Unsupervised","domain\nadaptation","for","robust","speech","recognition","via","variational\nautoencoder-based","data","augmentation.arXiv:1707.06265\n[cs],","","September","2017.","","","URLhttp://arxiv.org/\nabs/1707.06265.","arXiv:","1707.06265.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nHuang,","","G.,","","Liu,","","Z.,","","Van","","Der","","Maaten,","","L.,","","and","","Wein-\nberger,","","K.","","Q.","","","","Densely","","connected","","convolutional","","net-\nworks.","","In2017","IEEE","Conference","on","Computer","Vision\nand","Pattern","Recognition","(CVPR),","pp.","2261–2269,","Hon-\nolulu,","","HI,","July","2017.","IEEE.","","","ISBN","978-1-5386-0457-\n1.","","","","doi:","","","10.1109/CVPR.2017.243.","","","","URLhttps://\nieeexplore.ieee.org/document/8099726/.\nKalatzis,","","D.,","","Eklund,","","D.,","","Arvanitidis,","","G.,","","and","","Hauberg,\nS.","","","","Variational","","autoencoders","","with","","Riemannian","","Brow-\nnian","motion","priors.arXiv:2002.05227","[cs,","","stat],","","Au-\ngust","2020.","","URLhttp://arxiv.org/abs/2002.\n05227.","arXiv:","2002.05227.\nKingma,","D.","P.","and","Ba,","J.","","Adam:","A","method","for","stochastic\noptimization.arXiv","preprint","arXiv:1412.6980,","2014.\nKingma,","D.","P.","and","Welling,","M.","Auto-encoding","variational\nBayes.arXiv:1312.6114","[cs,","","stat],","","May","2014.","","","URL\nhttp://arxiv.org/abs/1312.6114.arXiv:\n1312.6114.\nLebanon,","G.","","","Metric","learning","for","text","documents.IEEE\nTrans.","","Pattern","","Anal.","","Machine","","Intell.,","","28(4):497–508,\nApril","2006.","","","ISSN","0162-8828.","","","doi:","","10.1109/TPAMI.\n2006.77.","","URLhttp://ieeexplore.ieee.org/\ndocument/1597108/.\nLeCun,","Y.","The","MNIST","database","of","handwritten","digits.","1998.\nURLhttp://yann.lecun.com/exdb/mnist/.\nLim,","S.","K.,","Loo,","Y.,","Tran,","N.-T.,","Cheung,","N.-M.,","Roig,","G.,\nand","Elovici,","Y.","Doping:","Generative","data","augmentation","for\nunsupervised","anomaly","detection","with","gan.","pp.","1122–1127.\nIEEE,","2018.","ISBN","1-5386-9159-0.\nLiu,","Y.,","Zhou,","Y.,","Liu,","X.,","Dong,","F.,","Wang,","C.,","and","Wang,\nZ.","","Wasserstein","gan-based","small-sample","augmentation\nfor","new-generation","artificial","intelligence:","a","case","study","of\ncancer-staging","data","in","biology.Engineering,","5(1):156–\n163,","2019.","ISSN","2095-8099.","Publisher:","Elsevier.\nLouis,","M.Computational","and","statistical","methods","for","tra-\njectory","analysis","in","a","Riemannian","geometry","setting.","PhD\nThesis,","Sorbonnes","universit\n","́\nes,","2019.\nMallasto,","A.","and","Feragen,","A.","","Wrapped","Gaussian","process\nregression","on","Riemannian","manifolds.","In2018","IEEE/CVF\nConference","on","Computer","Vision","and","Pattern","Recognition,\npp.","5580–5588,","Salt","Lake","City,","UT,","June","2018.","IEEE.\nISBN","978-1-5386-6420-9.","","","doi:","","10.1109/CVPR.2018.\n00585.","","URLhttps://ieeexplore.ieee.org/\ndocument/8578683/.\nMarcus,","","D.","","S.,","","Wang,","","T.","","H.,","","Parker,","","J.,","","Csernansky,\nJ.","","G.,","","Morris,","","J.","","C.,","","and","","Buckner,","","R.","","L.Open","","ac-\ncess","series","of","imaging","studies","(OASIS):","Cross-sectional\nMRI","","data","","in","","young,","","middle","","aged,","","nondemented,","","and\ndemented","","older","","adults.Journal","","of","","Cognitive","","Neu-\nroscience,","","","19(9):1498–1507,","","","2007.doi:","","","","10.1162/\njocn.2007.19.9.1498.","","URLhttps://doi.org/10.\n1162/jocn.2007.19.9.1498.","Number:","9eprint:\nhttps://doi.org/10.1162/jocn.2007.19.9.1498.\nMathieu,","E.,","Le","Lan,","C.,","Maddison,","C.","J.,","Tomioka,","R.,","and\nTeh,","Y.","W.","Continuous","hierarchical","representations","with\npoincar\n","́\ne","variational","auto-encoders.","","pp.","12565–12576,\n2019.\nNalisnick,","E.,","Hertel,","L.,","and","Smyth,","P.","Approximate","infer-\nence","for","deep","latent","Gaussian","mixtures.","pp.","","4,","2016.\nNeal,","R.","M.","","","Hamiltonian","importance","sampling.","","","Intalk\npresented","","at","","the","","Banff","","International","","Research","","Station\n(BIRS)","workshop","on","Mathematical","Issues","in","Molecular\nDynamics,","2005.\nNeal,","R.","M.","and","others.","MCMC","using","Hamiltonian","dynam-\nics.Handbook","of","Markov","Chain","Monte","Carlo,","2(11):2,\n2011.","Number:","11.\nNishizaki,","H.","","","Data","augmentation","and","feature","extraction\nusing","variational","autoencoder","for","acoustic","modeling.","In\n2017","Asia-Pacific","Signal","and","Information","Processing","As-\nsociation","Annual","Summit","and","Conference","(APSIPA","ASC),\npp.","1222–1227,","Kuala","Lumpur,","December","2017.","IEEE.\nISBN","978-1-5386-1542-3.","doi:","10.1109/APSIPA.2017.\n8282225.","URLhttp://ieeexplore.ieee.org/\ndocument/8282225/.\nPaszke,","A.,","Gross,","S.,","Chintala,","S.,","Chanan,","G.,","Yang,","E.,\nDeVito,","Z.,","Lin,","Z.,","Desmaison,","A.,","Antiga,","L.,","and","Lerer,\nA.","Automatic","differentiation","in","pytorch.","2017.\nPennec,","","X.Intrinsic","","statistics","","on","","Riemannian","","mani-\nfolds:","Basic","tools","for","geometric","measurements.J","Math\nImaging","","Vis,","","25(1):127–154,","","July","","2006.","","","ISSN","","0924-\n9907,","","1573-7683.","","","","doi:","","","10.1007/s10851-006-6228-4.\nURLhttp://link.springer.com/10.1007/\ns10851-006-6228-4.\nRezende,","D.","J.","and","Mohamed,","S.","Variational","inference","with\nnormalizing","","flows.arXiv","","preprint","","arXiv:1505.05770,\n2015.\nRezende,","D.","J.,","Mohamed,","S.,","and","Wierstra,","D.","Stochastic\nbackpropagation","and","approximate","inference","in","deep","gen-\nerative","models.arXiv","preprint","arXiv:1401.4082,","2014.\nSalimans,","T.,","Kingma,","D.,","and","Welling,","M.","Markov","chain\nMonte","Carlo","and","variational","inference:","Bridging","the","gap.\nInInternational","Conference","on","Machine","Learning,","pp.\n1218–1226,","2015.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nSandfort,","","V.,","","Yan,","","K.,","","Pickhardt,","","P.","","J.,","","and","","Summers,\nR.","","M.Data","","augmentation","","using","","generative","","adver-\nsarial","networks","(CycleGAN)","to","improve","generalizabil-\nity","","in","","CT","","segmentation","","tasks.Sci","","Rep,","","9(1):16884,\nDecember","","2019.ISSN","","2045-2322.doi:","","","10.1038/\ns41598-019-52737-x.","","","URLhttp://www.nature.\ncom/articles/s41598-019-52737-x.\nShorten,","","","C.","","and","","Khoshgoftaar,","","","T.","","M.A","","survey","","on\nimage","","data","","augmentation","","for","","deep","","learning.J","","Big\nData,","","","6(1):60,","","","December","","2019.ISSN","","2196-1115.\ndoi:10.1186/s40537-019-0197-0.URLhttps:\n//journalofbigdata.springeropen.com/\narticles/10.1186/s40537-019-0197-0.\nTomczak,","J.","and","Welling,","M.","","VAE","with","a","vampprior.","","pp.\n1214–1223.","PMLR,","2018.","ISBN","2640-3498.\nTurner,","B.","O.,","Paul,","E.","J.,","Miller,","M.","B.,","and","Barbey,","A.","K.\nSmall","sample","sizes","reduce","the","replicability","of","task-based\nfMRI","studies.Communications","Biology,","1(1):1–10,","2018.\nNumber:","1","Publisher:","Nature","Publishing","Group.\nWu,","","","Z.,","","","Wang,","","","S.,","","","Qian,","","","Y.,","","","and","","","Yu,","","","K.Data\naugmentationusingvariationalautoencoderfor\nembedding","","","based","","","speaker","","","verification.InInter-\nspeech","","","2019,","","","","pp.","","","1163–1167.","","","ISCA,","","","September\n2019.doi:","","","10.21437/Interspeech.2019-2248.URL\nhttp://www.isca-speech.org/archive/\nInterspeech_2019/abstracts/2248.html.\nXiao,","H.,","Rasul,","K.,","and","Vollgraf,","R.","","Fashion-MNIST:","A\nnovel","image","dataset","for","benchmarking","machine","learning\nalgorithms.","August","2017.","arXiv:","cs.LG/1708.07747.\nZhang,","C.,","B\n","̈\nutepage,","J.,","Kjellstr\n","̈\nom,","H.,","and","Mandt,","S.","Ad-\nvances","in","variational","inference.IEEE","Transactions","on\nPattern","Analysis","and","Machine","Intelligence,","41(8):2008–\n2026,","2018.","Number:","8","Publisher:","IEEE.\nZhu,","X.,","Liu,","Y.,","Qin,","Z.,","and","Li,","J.","","Data","augmentation","in\nemotion","classification","using","generative","adversarial","net-\nworks.arXiv:1711.00648","[cs],","December","2017.","","URL\nhttp://arxiv.org/abs/1711.00648.arXiv:\n1711.00648.\nZhuang,","","P.,","","Schwing,","","A.","G.,","","and","Koyejo,","","O.","","","Fmri","data\naugmentation","via","synthesis.","pp.","1783–1787.","IEEE,","2019.\nISBN","1-5386-3641-7.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nA.","Proof","of","Proposition.","1\nProposition","","","2.\nThe","","","Riemannian","","","manifold","","","(R\nd\n,g)is\ngeodesically","complete.\nWe","will","show","that","given","the","manifoldM=R\nd\nand","the\nRiemannian","metric","whose","local","representation","is","given","by\nEq.","(3)","in","the","paper,","any","geodesic","curveγ:]a,b[→","Mis\nactually","extendible","toR.","We","derive","a","proof","inspired","from\n(Louis,","2019).\nProof.Let","suppose","that","we","have","a","geodesic","curveγsuch\nthatγcannot","be","extended","toR.","There","existsI=]a,b[such\nthatIis","the","maximum","definition","domain","ofγ.","We","will","show\nthat","with","such","an","assumption","we","end","up","with","a","contradiction.\nSinceL\nψ\ni\nare","lower","triangular","matrices","with","positive","diago-\nnal","coefficients","we","havex\n>\nL\nψ\ni\nL\n>\nψ\ni\nx",">0,∀x∈R\nd\n−{0}.\nLett\n0\n∈]a,b[,","we","recall","that\n‖","̇γ(t)‖\n2\nγ(t)\n=〈\n","̇\nγ(t)|","̇γ(t)〉\nγ(t)\n=","","","̇γ(t)\n>\nG(γ(t))","","̇γ(t).\nTherefore","we","have","for","anyt∈]a,b[,\n‖","̇γ(t)‖\n2\n2\n≤‖","̇γ(t)‖\n2\n2\n+\n1\nλ\nN\n∑\ni=1\n","̇γ(t)\n>\nL\nψ\ni\nL\n>\nψ\ni\n","̇γ(t)","exp\n(\n−\n‖γ(t)−c\ni\n‖\n2\n2\nT\n2\n)\n≤\n1\nλ\n·‖","̇γ(t)‖\n2\nγ(t)\n=\n1\nλ\n·‖","̇γ(t\n0\n)‖\n2\nγ(t\n0\n)\n,\nwhere","","the","","last","","equality","","comes","","for","","the","","constant","","speed","","of\ngeodesic","curves.","Hence","we","have:\n‖γ(t)−γ(t\n0\n)‖\n2\n≤\n‖","̇γ(t\n0\n)‖\nγ(t\n0\n)\n√\nλ\n·|t−t\n0\n|.\nThis","means","that","for","anyt∈]a,b[the","geodesic","curveγre-\nmains","within","a","compact","set.\nWe","now","show","that","the","curve","can","actually","be","extended.","Let\nus","define","the","sequencet\nn\n−−−−→\nn→∞\nb,","","Since","the","geodesic\ncurves","have","a","constant","speed","the","setI={(t\nn\n,","̇γ(t\nn\n)}\nn∈N\nis","compact.","Moreover,","using","Cauchy-Lipchitz","theorem,","we\ncan","findε",">0such","that","for","anyn∈N,","the","geodesicγcan\nbe","defined","on]t\nn\n−ε,t\nn\n+ε[.","Sincet\nn\ncan","be","as","close","tob\nas","desired,","there","existsN∈Nsuch","that∀n≥Nwe","have\nt\nn\n≥b−\nε\n2\n.","","This","means","that","the","curve","definition","domain\ncan","be","extended","to]a,b+\nε\n2\n[which","concludes","the","proof.\nB.","Discussion","of","Remark.","1\nRemark","2.IfΣhas","small","enough","eigenvalues","then","Alg.","1\nof","Sec.","4.3","samples","from","the","following","distribution","onR\nd\np(z)","=\nρ\nS\n(z)\n√\nG\n−1\n(z)\n∫\nR\nd\nρ\nS\n(z)\n√\nG\n−1\n(z)dz\n,(6)\nwhereρ\nS\n(z)","=","1ifz∈S,0otherwise,","andSis","the","support\nof","the","distribution","taken","as","a","compact","set","so","that","the","integral\nis","well","defined.\nIfΣhas","small","enough","eigenvalues,","it","means","that","the","ini-\ntial","velocityv∼N(0,Σ)will","have","a","low","magnitude","with\nhigh","probability.","","In","such","a","case,","we","can","show","with","some\napproximation","that","the","ratioαin","the","Riemannian","random\nwalk","presented","in","Sec.","4.3","is","a","Hasting-Metropolis","ratio","with\ntarget","density","given","by","Eq.(6).","","We","recall","that","the","classic\nHasting-Metropolis","ratio","writes\nα(x,y)","=\nπ(y)\nπ(x)\n·\nq(x,y)\nq(y,x)\n,\nwhereπis","the","target","distribution","andqa","proposal","distribu-\ntion.","","In","the","case","of","small","magnitude","velocities,","one","may\nshow","thatqis","symmetric","that","is\nq(x,y)","=q(y,x).\nIn","","our","","setting,","","a","","proposal","̃zis","","made","","by","","computing","","the\ngeodesicγstarting","","atγ(0)","","","=zwith","","initial","","velocity\n","̇γ(0)","","=vwherev∼","N(0,Σ)and","evaluating","it","at","time\n1.","First,","we","remark","thatγis","well","defined","since","the","Riemna-\nnian","manifoldM=","(R,g)isgeodesically","completeandγ\nis","unique.","Moreover,","we","have","that\n←−\nγis","the","unique","geodesic\nwith","initial","position\n←−\nγ(0)","=","̃z=γ(1)\nand","initial","velocity\n","̇\n←−\nγ(0)","=−","̇γ(1)and","we","have\n←−\nγ(t)","=γ(1−t),∀t∈[0,1].\nIn","the","case","of","small","enough","initial","velocity,","a","taylor","expan-\nsion","of","the","exponential","may","be","performed","next","to0∈T\nz\nM\nand","consists","in","approximating","geodesic","curves","with","straight\nlines.","That","it,","fort∈[0,1]\nExp\nz\n(vt)≈z+vt,\nwherev=","̃z−z.","In","such","a","case","we","have\n","̇γ(t)","=v=","","","̇γ(0)","=","","","̇γ(1)","=−\n","̇\n←−\nγ(0).\nMoreover,","we","have","on","the","one","hand\nq(","̃z,z)","=p(","̃z|z)","=p(Exp\nz\n(v)|z)'N(z,Σ).\nOn","the","other","hand\nq(z,","̃z)","=p(z|","̃z)","=p(Exp\n","̃z\n(−v)|","̃z)'N(","̃z,Σ)\nTherefore,\nq(","̃z,z)","=q(z,","̃z).\nFinally,","the","ratioαin","the","Riemannian","random","walk","may","be\nseen","as","a","Hasting-Metropolis","ratio","where","the","target","density\nis","given","by","Eq.(6)and","so","the","algorithm","samples","from","such\na","distribution.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nC.","Computing","the","Exponential","map\nTo","compute","the","exponential","map","at","any","given","pointp∈\nMand","for","any","tangent","vectorv∈T\np\nMwe","rely","on","the\nHamiltonian","definition","of","geodesic","curves.","","First,","for","any\ngivenv∈T\np\nM,","the","linear","form:\nq\nv\n:\n{\nT\np\nM","→R\nu→g\np\n(u,v)\n,\nis","called","a","moment","and","is","a","representation","ofvin","the","dual\nspace.","","In","short,","we","may","writeq\nv\n(u)","=u\n>\nGv.","","Then,","the\ndefinition","of","the","Hamiltonian","follows\nH(p,q)","=\n1\n2\ng\n∗\np\n(q,q),\nwhereg\n∗\np\nis","the","dual","metric","whose","local","representation","is\ngiven","byG\n−1\n(p),","the","inverse","of","the","metric","tensor.","Finally,\nall","along","geodesic","curves","the","following","equations","hold\n∂p\n∂t\n=\n∂H\n∂q\n,\n∂q\n∂t\n=−\n∂H\n∂p\n.(7)\nSuch","a","system","of","differential","equations","may","be","integrated\npretty","straight","forwardly","using","simple","numerical","schemes\nsuch","as","the","second","order","Runge","Kutta","integration","method\nand","","Alg.","","2","","as","","in","","(Louis,","","2019).","","","An","","implementation","","us-\ning","pytorch","(Paszke","et","al.,","2017)","is","made","available","in","the\nsupplementary","materials.","Noteworthy","is","the","fact","that","such\nan","algorithm","only","involves","one","metric","tensor","inversion","at\ninitialisation","to","recover","the","initial","moment","from","the","initial\nvelocity.","Moreover,","it","involves","closed","form","operations","since\nthe","inverse","metric","tensorG\n−1\nis","known","and","so","the","gradients\nin","Eq.","(7)","can","be","easily","computed.\nAlgorithm","2Computing","the","Exponential","map\nInput:z\n0\n∈M,v∈T\nz\n0\nMandT\nq←G·v\ndt←\n1\nT\nfort=","1→Tdo\np\nt+\n1\n2\n←p\nt\n+\n1\n2\n·dt·∇\nq\nH(p\nt\n,q\nt\n)\nq\nt+\n1\n2\n←p\nt\n−\n1\n2\n·dt·∇\np\nH(p\nt\n,q\nt\n)\np\nt+1\n←p\nt\n+dt·∇\nq\nH(p\nt+\n1\n2\n,q\nt+\n1\n2\n)\nq\nt+1\n←p\nt\n−dt·∇\np\nH(p\nt+\n1\n2\n,q\nt+\n1\n2\n)\nend","for\nReturnp\nT\nD.","Paper","Parameters","Setting\nTable.","3","summarises","the","main","hyper-parameters","we","use","to\nperform","the","experiments","presented","in","the","paper","while","Ta-\nble.","4","shows","the","neural","networks","architectures","employed.","As\nto","training","parameters,","we","use","a","Adam","optimiser","(Kingma","&\nBa,","2014)","and","the","learning","rate","is","set","to10\n−3\nfor","all","data","sets\nexcept","for","OASIS","where","it","is","decreased","to10\n−4\nand","is","the\nsame","for","each","model.","As","to","the","models","used","as","benchmark\nfor","data","augmentation,","the","DenseNet","implementation","we\nuse","is","the","one","in","(Amos,","2020)","with","agrowth","rateequals\nto","10,depthof","20","and","0.5reductionand","is","trained","with","a\nlearning","rate","of10\n−3\n.","For","OASIS,","the","MLP","has","400","hidden\nunits","and","relu","activation","function.\nTable","3.RHVAE","parameters","for","each","data","set.\nDATA","SETSPARAMETERS\nd\n∗\nn\nlf\nε\nlf\nTλ\n√\nβ\n0\nSYNTHETIC2310\n−2\n0.810\n−3\n0.3\nreducedMNIST2310\n−2\n0.810\n−3\n0.3\nreducedFASHION2310\n−2\n0.810\n−3\n0.3\nOASIS2310\n−3\n0.810\n−2\n0.3\n*","LATENT","SPACE","DIMENSION(SAME","FORVAEANDVAMP-VAE)\nTable","4.\nNeural","networks","architectures","of","the","VAE,","VAMP-VAE\nand","RHVAE","for","each","data","set.","Theencoderanddecoderare","the\nsame","for","all","models.\nSYNTHETIC,","MNIST","&","FASHION\nNETLAYER1LAYER2LAYER3\nμ\n∗\nφ\n(D,","400,RELU)\n(400,d,LIN.)-\nΣ\n∗\nφ\n(400,d,LIN.)-\nπ\n∗\nθ\n(d,","400,RELU)(400,D,SIG.)-\nL\nψ\n(DIAG.)\n(D,","400,RELU)\n(400,d,LIN.)-\nL\nψ\n(LOW.)(400,\nd(d−1)\n2\n,LIN.)-\nOASIS\nμ\n∗\nφ\n(D,","1K,RELU)(1K,","400,RELU)\n(400,d,LIN.)\nΣ\n∗\nφ\n(400,d,LIN.)\nπ\n∗\nθ\n(d,","400,RELU)(400,","1K,RELU)(1K,D,SIG.)\nL\nψ\n(DIAG.)\n(D,","400,RELU)\n(400,d,LIN.)-\nL\nψ\n(LOW.)(400,\nd(d−1)\n2\n,LIN.)-\n*","SAME","FORVAEMODELS\nE.","Comparison","with","Other","Generation\nMethods\nIn","this","section","we","compare","the","visual","quality","of","generated\nsamples","usingprior-basedmethods","(N-VAE,","VAMP-VAE\nand","RHAVE)","and","the","proposed","methods","(RHVAE","+","Rie-\nmannian","random","walk","or","RHVAE","+","metric","sampling).","We\ncompare","the","models","on","1)","the","synthetic","data","set","composed\nby","180","binary","images","presenting","circles","and","rings","with","dif-\nferent","diameters","and","thicknesses;","2)","thereducedMNIST\ndata","set","composed","by","120","samples","of","3","different","classes","and\n3)","thereducedFashionMNIST","data","set","composed","again","by\n120","samples","from","3","distinct","classes.","The","models","are","trained\nwith","the","same","neural","network","architectures,","batch","size","and\nlearning","rate.","","An","early","stopping","strategy","is","adopted","and\nconsists","in","stopping","training","if","the","ELBO","does","not","improve\nfor","50","epochs.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nAs","discussed","in","the","paper,","changing","the","prior","may","indeed\nimprove","the","model","generation","capacity.","For","instance","sam-\nples","from","the","VAE","with","the","VAMP","prior","(3\nrd\nrow","of","Fig.","5)\nare","closer","to","the","training","data","(1\nst\nrow","of","Fig.","5)","than","with\nthe","gaussian","prior","(2\nnd\nand4\nth\nrow).","","","The","model","is","for\ninstance","able","to","generate","circles","when","trained","with","the","syn-\nthetic","data","while","models","using","a","standard","normal","prior","are\nnot.","","Nonetheless,","a","non","negligible","part","of","the","generated\nsamples","are","degraded","(see","saturated","images","for","thereduced\nMNIST","data","for","instance).","This","aspect","is","mitigated","with","the\nproposed","generation","methods","which","generate","more","diverse\nand","sharper","samples.\nF.","Comprehensive","Metrics","Classification","of\nSec.","5.2\nIn","addition","to","the","global","and","balanced","accuracy","metrics\nprovided","in","the","paper,","we","record","the","precision,","recall","and","f1-\nscore","for","each","class","of","the","OASIS","database","(i.e.Alzheimer\ndisease","(AD)","and","Cognitively","Normal","(CN)","patients)","in\nTable.","5.","Again,","the","best","results","are","observed","with","thesyn-\nthetic","onlydata","sets","only","composed","by","samples","generated\nwith","our","method","(i.e.metric","sampling).","","For","instance,","f1-\nscore","jumps","from","66.89","with","theraw","datato","78.05","with\n1000","synthetic","samples","per","class","using","our","method","for","the\nAD","diagnosis.","","This","represents","a","noticeable","improvement\nconsidering","the","size","of","the","original","data","set","(416","patients)\nand","the","complexity","of","the","data","(208x176","RMI).","Notewor-\nthy","","is","","the","","fact","","that","","in","","the","","majority","","of","","cases","","we","","are","","also\nable","to","reduce","the","model","uncertainty","with","the","proposed","aug-\nmentation","method.","","We","recall","that","the","classifier","is","trained\non","5","independent","runs","and","that","a","hyper-parameter","search\nis","conducted","on","the","learning","rate","which","appears","to","have\na","significant","impact","on","the","results.","","We","keep","the","learning\nrate∈","{10\n−6\n,10\n−5\n,10\n−4\n,10,\n−3\n,10\n−2\n,10\n−1\n}achieving\nthe","best","balanced","accuracy.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nTraining\nsamples\nMNISTFashionMNISTSynthetic","data\nVAE","+\nN(0,","I\nd\n)\nVAE","+\nVAMP","prior\nRHVAE","+\nN(0,","I\nd\n)\nRHVAE","+\nRiemannian\nrandom","walk\n(Ours)\nRHVAE","+\nMetric\nsampling\n(Ours)\nFigure","5.Comparison","of","5","sampling","methods","on","thereducedMNIST,reducedFahsionMNIST","and","the","synthetic","data","sets.","From","top","to\nbottom:","1)","samples","extracted","from","the","training","set;","2)","samples","generated","with","a","Vanilla","VAE","and","using","the","prior;","3)","from","the","VAMP","prior\nVAE",";","4)","from","a","RHVAE","and","theprior-basedgeneration","scheme;","5)","from","a","RHVAE","and","using","the","proposed","Riemannian","random","walk","and\n6)","using","metric","sampling.","All","the","models","are","trained","with","the","same","encoder","and","decoder","networks","and","identical","latent","space","dimension.\nAn","early","stopping","strategy","is","adopted","and","consists","in","stopping","training","if","the","ELBO","does","not","improve","for","50","epochs.\n\nManifold","Sampling","with","a","Geometry-Aware","VAE\nTable","5.Data","augmentation","on","real","data","from","the","OASIS","database","with","a","MLP","model","as","Benchmark","using","either","geometric","transformations,\na","VAE","and","the","classic","generation","process","or","metric","sampling","(ours).","The","model","is","trained","on","5","independent","runs","and","we","report","the","main\nclassification","metrics","along","with","the","associated","standard","deviation.","We","adopt","an","early","stopping","strategy","and","stop","training","if","the","validation\nloss","does","not","improve","for","20","epochs.\nDATA","SETSLABELPRECISIONRECALLF1-SCOREGLOBALACCURACYBALANCEDACCURACY\nRAWDATA\nCN92.61","(2.1)86.97","(1.2)89.69","(1.4)\n84.29","(2.2)80.71","(4.0)\nAD60.82","(3.8)74.44","(7.5)66.89","(5.2)\nREAL+","SYNTHETIC\nAUGMENTEDX5\nCN94.71","(2.2)85.45","(3.0)89.79","(1.6)\n84.76","(2.3)83.84","(3.8)\nAD60.91","(4.5)82.22","(8.2)69.76","(4.7)\nAUGMENTEDX10\nCN90.22","(1.9)89.09","(0.6)89.64","(1.1)\n83.81","(1.8)76.77","(3.8)\nAD61.53","(3.1)64.44","(7.5)62.87","(5.1)\nAUGMENTEDX15\nCN90.37","(2.1)86.97","(4.1)88.54","(1.6)\n82.38","(2.0)76.26","(3.0)\nAD58.74","(5.9)65.56","(8.9)61.38","(3.3)\nVAE","-","200\n∗\nCN92.74","(1.7)83.64","(4.8)87.83","(2.0)\n81.90","(2.3)79.59","(1.6)\nAD56.64","(5.0)75.56","(7.5)64.20","(1.5)\nVAE","-","500\n∗\nCN91.58","(0.5)92.12","(2.4)91.83","(1.0)\n87.14","(1.4)80.50","(0.5)\nAD71.07","(5.2)68.89","(2.7)69.74","(1.5)\nVAE","-","1000\n∗\nCN93.33","(0.0)84.85","(0.0)88.89","(0.0)\n83.33","(0.0)81.31","(0.0)\nAD58.33","(0.0)77.78","(0.0)66.67","(0.0)\nVAE","-","2000\n∗\nCN93.24","(0.0)83.64","(0.6)88.18","(0.4)\n82.38","(0.5)80.71","(0.3)\nAD56.47","(0.9)77.78","(0.0)65.43","(0.6)\nOURS-","200\n∗\nCN96.28","(1.3)83.94","(8.7)89.40","(4.7)\n84.76","(6.0)85.86","(3.0)\nAD62.79","(12.0)87.78","(5.4)72.15","(7.1)\nOURS-","500\n∗\nCN95.71","(1.0)86.67","(4.4)90.88","(2.0)\n86.43","(2.7)86.11","(1.0)\nAD64.67","(6.9)85.56","(4.4)73.23","(3.0)\nOURS-","1000\n∗\nCN95.71","(1.7)86.36","(3.7)90.73","(1.8)\n86.19","(2.3)85.96","(2.6)\nAD63.74","(5.2)85.56","(6.7)72.71","(3.4)\nOURS-","2000\n∗\nCN94.34","(1.2)90.61","(0.6)92.43","(0.2)\n88.33","(0.5)85.30","(1.9)\nAD69.91","(0.2)80.00","(4.4)74.56","(1.7)\nSYNTHETIC","ONLY\nVAE","-","200\n∗\nCN96.66","(1.0)70.00","(0.6)81.20","(0.7)\n74.52","(0.9)80.55","(1.6)\nAD45.30","(1.1)91.11","(2.7)60.51","(1.6)\nVAE","-","500\n∗\nCN91.58","(1.9)86.67","(8.4)88.75","(3.8)\n83.10","(4.8)78.33","(1.9)\nAD62.78","(11.8)70.00","(9.7)64.51","(4.3)\nVAE","-","1000\n∗\nCN95.92","(0.0)71.21","(0.0)81.74","(0.0)\n75.00","(0.0)80.05","(0.0)\nAD45.71","(0.0)88.89","(0.0)60.38","(0.0)\nVAE","-","2000\n∗\nCN95.65","(0.7)73.03","(0.6)82.82","(0.1)\n76.19","(0.0)80.41","(0.8)\nAD47.02","(0.1)87.78","(2.2)61.23","(0.6)\nOURS-","200\n∗\nCN95.22","(0.0)90.61","(0.6)92.86","(0.3)\n89.05","(0.5)86.97","(0.3)\nAD70.78","(1.3)83.33","(0.0)76.54","(0.8)\nOURS-","500\n∗\nCN96.41","(0.6)89.39","(0.0)92.77","(0.3)\n89.05","(0.5)88.58","(1.1)\nAD69.29","(0.5)87.78","(2.2)77.44","(1.2)\nOURS-","1000\n∗\nCN96.72","(0.0)89.39","(0.0)92.91","(0.0)\n89.29","(0.0)89.14","(0.0)\nAD69.57","(0.0)88.89","(0.0)78.05","(0.0)\nOURS-","2000\n∗\nCN96.41","(0.6)89.39","(0.0)92.77","(0.3)\n89.05","(0.5)88.58","(1.1)\nAD69.29","(0.5)87.78","(2.2)77.44","(1.2)\n*","NUMBER","OF","GENERATED","SAMPLES"],"doc13":["\n\n1\nJointly","Modeling","Heterogeneous","Student","Behaviors","and\nInteractions","Among","Multiple","Prediction","Tasks\nHAOBING","LIU,","YANMIN","ZHU,","TIANZI","ZANG,","YANAN","XU,","JIADI","YU,","and","FEILONG\nTANG,Department","of","Computer","Science","and","Engineering,","Shanghai","Jiao","Tong","University\nPrediction","tasks","about","students","have","practical","significance","for","both","student","and","college.","Making","multiple\npredictions","about","students","is","an","important","part","of","a","smart","campus.","For","instance,","predicting","whether","a","student\nwill","fail","to","graduate","can","alert","the","student","affairs","office","to","take","predictive","measures","to","help","the","student","improve\nhis/her","academic","performance.","With","the","development","of","information","technology","in","colleges,","we","can","collect\ndigital","footprints","which","encode","heterogeneous","behaviors","continuously.","In","this","paper,","we","focus","on","modeling\nheterogeneous","behaviors","and","making","multiple","predictions","together,","since","some","prediction","tasks","are","related\nand","learning","the","model","for","a","specific","task","may","have","the","data","sparsity","problem.","To","this","end,","we","propose","a\nvariant","of","LSTM","and","a","soft-attention","mechanism.","The","proposed","LSTM","is","able","to","learn","the","student","profile-\naware","representation","from","heterogeneous","behavior","sequences.","The","proposed","soft-attention","mechanism","can\ndynamically","learn","different","importance","degrees","of","different","days","for","every","student.","In","this","way,","heterogeneous\nbehaviors","can","be","well","modeled.","In","order","to","model","interactions","among","multiple","prediction","tasks,","we","propose","a\nco-attention","mechanism","based","unit.","With","the","help","of","the","stacked","units,","we","can","explicitly","control","the","knowledge\ntransfer","among","multiple","tasks.","We","design","three","motivating","behavior","prediction","tasks","based","on","a","real-world\ndataset","collected","from","a","college.","Qualitative","and","quantitative","experiments","on","the","three","prediction","tasks","have\ndemonstrated","the","effectiveness","of","our","model.\nCCS","Concepts:•Information","systems→Data","mining;•Applied","computing→Education.\nAdditional","Key","Words","and","Phrases:","LSTM,","Attention","Mechanism,","Heterogeneous","Student","Behaviors,","Multi-Task\nLearning\nACM","Reference","Format:\nHaobing","Liu,","Yanmin","Zhu,","Tianzi","Zang,","Yanan","Xu,","Jiadi","Yu,","and","Feilong","Tang.","2021.","Jointly","Modeling","Hetero-\ngeneous","Student","Behaviors","and","Interactions","Among","Multiple","Prediction","Tasks.ACM","Trans.","Knowl.","Discov.\nData.1,","1,","Article","1","(January","2021),","24","pages.","https://doi.org/XXX/XXX\n1","","","","INTRODUCTION\nRecently,","more","and","more","people","are","concerned","about","the","educational","field.","By","utilizing","data","mining\ntechniques","in","this","field,","there","arise","various","significant","prediction","tasks","for","better","understanding\nstudents","and","the","settings","which","students","learn","in,","such","as","academic","performance","prediction","[42,43],\nlibrary","circulation","prediction","[38,40],","graduation","failure","prediction","[34].","With","the","help","of","these\ntasks,","educators","could","know","grades","of","students,","the","library","circulation,","or","whether","students","pass/fail\nfor","a","specific","given","course","ahead","of","time.","Then","educators","could","facilitate","personalized","education,\ndo","library","strategic","plan,","or","design","in-time","intervention.\nAuthors’","address:","Haobing","Liu,","liuhaobing@sjtu.edu.cn;","Yanmin","Zhu,","yzhu@sjtu.edu.cn;","Tianzi","Zang,","zangtianzi@sjtu.edu.\ncn;","Yanan","Xu,","xuyanan2015@sjtu.edu.cn;","Jiadi","Yu,","jiadiyu@sjtu.edu.cn;","Feilong","Tang,","tang-fl@cs.sjtu.edu.cn,","Department\nof","Computer","Science","and","Engineering,","Shanghai","Jiao","Tong","University,","Shanghai,","China.\nPermission","to","make","digital","or","hard","copies","of","all","or","part","of","this","work","for","personal","or","classroom","use","is","granted","without","fee\nprovided","that","copies","are","not","made","or","distributed","for","profit","or","commercial","advantage","and","that","copies","bear","this","notice","and","the\nfull","citation","on","the","first","page.","Copyrights","for","components","of","this","work","owned","by","others","than","the","author(s)","must","be","honored.\nAbstracting","with","credit","is","permitted.","To","copy","otherwise,","or","republish,","to","post","on","servers","or","to","redistribute","to","lists,","requires\nprior","specific","permission","and/or","a","fee.","Request","permissions","from","permissions@acm.org.\n©2021","Copyright","held","by","the","owner/author(s).","Publication","rights","licensed","to","ACM.\n1556-4681/2021/1-ART1","$15.00\nhttps://doi.org/XXX/XXX\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\narXiv:2103.13565v1","","[cs.LG]","","25","Mar","2021\n\n1:2Haobing","L.","et","al.\n-2\n0\n2\n4\n6\n8\n10\n12\n020406080100\n#","Borrowed","Books\nAcademic","Performance\n(a)\n-2\n0\n2\n4\n6\n8\n10\n12\n020406080100\n#","Failed","Courses\nAcademic","Performance\n(b)\nFig.","1.","","(a)","shows","the","correlation","between","academic","performance","and","#","borrowed","books.","(b)","shows","the\ncorrelation","between","academic","performance","and","#","failed","courses.\nPrevious","works","about","these","prediction","tasks","mostly","focus","on","the","factors","including","values","of\nhistorical","observations","(such","as","historical","grades","[42],","historical","library","circulation","[38,40])","and\nstudent","demographic","information","(i.e.,","student","profiles)","[27,32].","These","factors","are","relatively","stable\nin","the","long","run","and","are","difficult","to","change","via","educational","management.","Besides,","in","online","learning\nenvironments","(e.g.,","massive","open","online","courses),","students’","digital","records","collected","by","online\nlearning","platforms","such","as","logs","about","video-watching","behavior,","time","spent","on","specific","questions,\nand","test/quiz","grades","have","been","leveraged","[2,3,22,26,31].","The","digital","records","can","directly","reflect\nstudents’","efforts","so","they","are","important","to","prediction","tasks.","But","these","records","are","rarely","digitized","in\ntraditional","education.\nThanks","to","the","development","of","information","technology","in","colleges,","there","is","a","clear","trend","to","augment\nphysical","facilities","with","sensing,","computing,","and","communication","capabilities","[45].","These","facilities\nunobtrusively","record","students’","digital","footprints","every","day.","The","digital","footprints","of","students","encode\nheterogeneous","behaviors","that","are","helpful","for","prediction","tasks.","For","example,","academic","efforts","can","be\nlearned","from","entering","the","library","records","and","entering","the","dormitory","records.","Academic","efforts","are\nkey","factors","for","predicting","academic","performance,","the","number","of","borrowed","books,","or","the","number","of\nfailed","courses.","In","other","words,","students’","hard","study","(i.e.,","entering","the","library","frequently,","early;","going\nback","to","the","dormitory","late)","can","pay","off","and","may","result","in","borrowing","many","books","from","libraries.\nOnce","the","digital","footprints","are","available,","they","can","be","used","to","improve","prediction","performances.\nBesides,","some","prediction","tasks","are","closely","related.","Figure","1","(a)","shows","the","correlation","between","the\nacademic","performance","and","the","number","of","borrowed","books.","The","percentage","of","students","who","borrow\nmore","than11books","in","one","semester","is","low","(around13%)","so","we","regard","any","number","of","borrowed\nbooks","greater","than11as11.","We","can","see","that","the","academic","performance","and","the","number","of","borrowed\nbooks","have","a","positive","correlation.","In","Figure","1","(b),","the","academic","performance","and","the","number","of\nfailed","courses","have","a","negative","correlation.","Hence,","when","predicting","the","number","of","books","borrowed\nby","student푠,","the","value","is","more","likely","to","be","large","once","knowing","that","the","academic","performance\nof","student푠is","good","and","the","number","of","failed","courses","is","small.","In","this","paper,","we","collect","digital\nfootprints","of10푘students","spanning","one","academic","year","from","campus","smart","card","usage","for","entering\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:3\nthe","library","and","the","dormitory.","One","footprint","record","mainly","containsthe","student","identity","number\nandthe","timestamp","of","the","record.\nBased","on","the","above","thoughts,","we","focus","on","jointly","modeling","heterogeneous","student","behaviors\ngenerated","from","digital","footprints","and","interactions","among","multiple","prediction","tasks.","We","take","Pre-\ndicting","Academic","Performance","(PAP),","Predicting","the","Number","of","Borrowed","Books","(PNBB),","and\nPredicting","the","Number","of","Failed","Courses","(PNFC)","as","three","motivating","examples","of","prediction","tasks.\nHowever,","we","mainly","confront","the","following","challenges.","First,","the","students’","profile","information\nhas","a","large","impact","on","their","behaviors.","Similar","behaviors","of","different","kinds","of","students","may","mean\ndifferently.","For","instance,","there","are","two","students:","student푠and","student푠\n′\n.","Their","records","of","entering\nthe","library","are","similar.","Student푠is","a","freshman","while","student푠\n′\nis","a","senior.","Student푠\n′\nwould","have\nless","homework","to","do","than","student푠.","In","return,","it","means","student푠\n′\nworks","harder","than","student푠.","Thus\nthe","academic","performance","of","student푠\n′\nshould","be","better","than","student푠.","Profile","information","has","not\nbeen","well","considered","in","previous","studies.","So","the","challenge","ishow","to","consider","profile","information\nwhile","modeling","daily","behaviors.","Second,","behaviors","of","different","days","have","different","degrees","of","impact.\nFor","instance,","the","academic","efforts","of","students","on","different","days","will","change","due","to","many","reasons\nsuch","as","study","habits.","So","the","challenge","ishow","to","dynamically","find","out","informative","days","according","to\ndifferent","students.","Third,","a","simple","way","to","capture","correlations","among","multiple","tasks","is","leveraging","a\nsimple","multi-task","learning","framework.","In","this","way,","we","can","only","capture","latent","interactions","and\nwe","can","not","explicitly","control","the","knowledge","transfer,","resulting","in","a","lack","of","interpretability.","So","the\nchallenge","ishow","to","explicitly","model","interactions","among","multiple","tasks.\nTo","address","the","first","two","challenges,","we","propose","an","attentional","profile-aware","multi-task","model\n(APAMT)","for","modeling","heterogeneous","daily","behaviors","in","our","preliminary","work","[21].","More","specifi-\ncally,","for","heterogeneous","daily","behaviors,","each","kind","of","behavior","sequence","is","modeled","by","a","variant\nof","LSTM","named","Profile-aware","LSTM.","By","adding","profile","information","in","the","gates","of","LSTM,","LSTM\ncan","consider","profile","information","when","modeling","the","behavior","sequence,","so","as","to","improve","the\nperformances","of","prediction","tasks.","Besides,","a","novel","soft-attention","mechanism","is","designed","over\nProfile-aware","LSTM","to","dynamically","learn","the","different","importance","degrees","of","different","days","for\nevery","student","for","improving","the","prediction","performances.","In","APAMT","model,","we","leverage","a","simple\nmulti-task","learning","framework","to","implicitly","model","interactions","among","multiple","tasks.","Therefore,\nin","this","paper,","we","extend","APAMT","and","propose","aDualAttentionProfile-AwareMulti-Task","model\n(DAPAMT)","to","explicitly","model","interactions","among","multiple","tasks.","Specifically,","we","design","a","unit\ncalled","Multi-task","Interaction","Unit,","the","core","of","which","is","the","co-attention","mechanism.","With","the","unit,\nwe","can","explicitly","control","the","process","of","knowledge","transfer.","Besides,","we","can","stack","more","than","one\nunit","to","model","the","high-level","interactions.","Moreover,","we","find","that","leveraging","multi-task","learning","is\nnecessary","since","there","exists","a","data","sparsity","problem.","For","example,","in","our","dataset,","around44%of\nstudents","do","not","borrow","books","in","one","semester.","Thus,","the","input","data","of","PNBB","task","can","be","sparse.\nIn","summary,","the","main","contributions","of","this","paper","are","as","follows:\n•We","propose","a","Dual","Attention","Profile-Aware","Multi-Task","model","(i.e.,","DAPAMT)","to","deal","with\nmultiple","prediction","tasks","about","students","simultaneously.","DAPAMT","can","jointly","model","het-\nerogeneous","student","behaviors","generated","from","digital","footprints","effectively","and","interactions\namong","multiple","prediction","tasks","explicitly.\n•\nWe","design","a","variant","of","LSTM","called","Profile-aware","LSTM","to","capture","profile","information","when\nmodeling","the","daily","behavior","sequence.","We","design","a","soft-attention","mechanism","to","dynamically\nfind","out","informative","days.","We","design","a","co-attention","mechanism","based","unit","called","Multi-task\nInteraction","Unit","to","explicitly","control","the","knowledge","transfer","and","alleviate","the","data","sparsity\nproblem.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:4Haobing","L.","et","al.\n•We","evaluate","our","proposed","model","on","a","large-scale","real-world","dataset.","The","experimental","results\ndemonstrate","that","our","model","outperforms","competing","baselines","and","every","component","of","our\nmodel","is","well-designed,","benefiting","the","prediction.\nThe","rest","of","this","paper","is","organized","as","follows.","We","first","introduce","the","related","work","of","our","research\nin","Section","2.","Next,","we","introduce","the","problem","statement","in","Section","3.","Following","that,","we","propose\nour","model","in","Section","4.","Then,","Section","5","presents","qualitative","and","quantitative","results","of","different\nmethods.","Section","6","presents","the","ethical","and","social","implications","of","this","work.","Finally,","we","conclude\nthe","paper","in","Section","7.\n2","","","","RELATED","WORK\nIn","this","section,","we","discuss","existing","studies","that","are","related","to","the","three","prediction","tasks","or","the\nmethods","we","used","in","this","paper.\n2.1","","","","RNNs","for","User","Behavior","Modeling\nRecurrent","Neural","Networks","(RNNs)","have","been","widely","adopted","to","model","sequence","data","and","have\nachieved","good","performance","in","various","domains","such","as","NLP","[35].","There","are","many","well-known\nvariants","of","RNN","models,","such","as","LSTM","[16],","GRU","[7],","bidirectional","LSTM","[12].","Hidasi","et","al.","[15]\nfirstly","introduced","GRU","to","recommender","systems.","They","leveraged","GRU","to","model","click","behaviors\nof","users.","Zhu","et","al.","[47]","proposed","a","variant","of","LSTM","called","Time-LSTM.","They","proposed","that","it","is\nimportant","to","exploit","the","time","information","when","modeling","users’","behaviors.","To","achieve","this","goal,\nthey","equipped","LSTM","with","time","gates","to","model","time","intervals.\n2.2","","","","Academic","Performance","Predictions\nAcademic","performance","prediction","task","is","the","most","frequently","studied","among","prediction","tasks","about\nstudents.","In","this","paper,","we","choose","Weighted","Average","Grade","(WAG)","which","is","on","a","100-point","scale","to\nquantitatively","describe","the","academic","performance","of","a","student","in","one","semester.","WAG","can","be","seen\nas","term","GPA.\nThere","are","various","factors","that","impact","the","academic","performance","in","complex","ways","[18].","Stu-\ndent","demographic","information","and","historical","academic","performance","are","widely","explored","by","re-\nsearchers","[18,32].","Some","technologies","such","as","online","learning","platforms","are","used","in","some","courses\nnowadays.","Students’","digital","records","collected","by","online","learning","platforms","such","as","logs","about\nvideo-watching","behavior,","time","spent","on","specific","questions,","and","test/quiz","grades","have","been","lever-\naged","[2,3,18,22,26,31].","A","few","studies","find","that","effective","teaching","motivates","the","student","to","perform\nbetter","[17,18].","Besides,","some","studies","explore","other","factors","such","as","attitudes","towards","study","[28].","As\nfor","employing","students’","behaviors","on","campus","to","predict","academic","performance,","Wang","et","al.","[39]\nfound","correlations","between","students’","cumulative","GPAs","and","automatic","sensing","behavioral","data\nobtained","from","smartphones.","However,","the","passive","sensing","behavioral","data","they","used","is","only","col-\nlected","from","a","small","number","of","students","and","the","collecting","way","is","not","universal","enough.","Yao","et\nal.","[43]","studied","the","effect","of","social","influence","on","predicting","academic","performance","based","on","students’\nmultiple","behaviors.","The","effect","of","students’","behaviors","is","very","indirect.","Zhang","et","al.","[46]","extracted\nstatistics","features","and","relevance","features","from","students’","multiple","behaviors","and","used","these","features\nto","predict","academic","performance.\nMost","methods","used","for","academic","performance","prediction","are","based","on","traditional","data","mining\ntechniques.","Khan","and","Ghosh","[17]","regarded","the","student","evaluation","of","teaching","excellence","and\nthe","number","of","student","evaluations","as","input","and","used","association","rule","mining","to","establish","the\nrelationship","between","teaching","and","academic","performance.","Feng","et","al.","[11]","did","a","stepwise","linear\nregression","to","predict","academic","performance","using","the","online","measures","as","independent","variables.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:5\nSweeney","et","al.","[36]","explored","the","factorization","machine,","a","general-purpose","matrix","factorization\nalgorithm","based","on","(student,","course)","dyads.","Xu","et","al.","[42]","leveraged","an","ensemble","learning","method\nto","predict","academic","performance","continuously","in","the","program","based","on","the","evolving","academic\nperformances.","Besides","traditional","methods,","some","researchers","seek","novel","solutions","with","the","help\nof","deep","learning.","Wang","and","Liao","[41]","gathered","information","about","gender,","personality","type,","and\nanxiety","level","through","questionnaires.","Then","they","adopted","a","feed","forward","neural","network","to","predict\nacademic","performance.","LSTMs","are","also","explored.","Fei","and","Yeung","[10]","leveraged","an","LSTM","to","model\nstudent","weekly","activities","and","predict","academic","performance","in","Massive","Open","Online","Courses\n(MOOCs).\nThese","studies","will","ignore","the","influence","of","profile","information","when","modeling","student","daily\nbehaviors","and","treat","all","days","equally.\n2.3","","","","Book-Borrowing","Predictions\nBook-borrowing","predictions","are","meaningful","and","have","been","studied","by","many","researchers.","Cano\net","al.","[4]","analysed","student","book-borrowing","behavior","during","the","semester","through","clustering","and\nassociation","rule","algorithms.","They","proposed","that","librarians","could","take","better","decisions","(such","as\ndecide","the","quantity","to","offer","per","topic","and","human","resources","needed","to","satisfy","the","demand)","for","their\nusers","after","knowing","the","analysis","results.\nBesides,","most","existing","studies","on","book-borrowing","prediction","focus","on","predicting","library","cir-\nculation.","Tian","[38]","regarded","the","time","series","of","library","circulation","flow","as","the","chaotic","time","series\nand","leveraged","support","vector","regressions","to","predict","library","circulation","of","coming","months.","They\nmentioned","that","when","the","number","of","enrollments","in","a","college","increases","sharply,","the","importance","of\nbook-borrowing","predictions","comes","out","conspicuously.","Kumar","and","Raj","[20]","found","that","the","number\nof","borrowed","books","one","month","and","twelve","months","earlier","could","estimate","the","number","of","borrowed\nbooks","in","a","month","with","an","autoregressive","integrated","moving","average","model.","Wang","et","al.","[40]\nleveraged","a","feed","forward","neural","network","to","predict","library","circulation","of","next","five","days","based","on\ndata","of","previous","twenty","days.","These","works","proposed","that","they","were","of","positive","significance","for\nlibrary","capacity","planning,","management","of","library","books","and","staff,","and","library","acquisition","budget\nsupporting.","These","works","ignore","the","impact","of","individuals.\n2.4","","","","Course-Failing","Predictions\nExisting","studies","on","course-failing","prediction","mainly","focus","on","classifying","students","into","two","categories:\neither","pass","or","fail","for","a","given","course.","Existing","studies","do","not","distinguish","this","task","from","academic\nperformance","prediction","task","[44].","If","there","is","only","one","course,","these","two","tasks","are","the","same.","Once\nwe","knew","one","student’s","mark,","we","know","whether","the","student","failed","the","course","or","not","and","vice-versa.\nIf","there","is","more","than","one","course,","these","two","tasks","are","different.","For","example,","if","student푠gets80\npoints","in","course푐\n1\n(3credits)","and","gets50points","in","course푐\n2\n(3credits),","the","academic","performance\nof","student푠is65which","is","above60points.","But,","the","number","of","failed","courses","of","this","student","is1\n(he/she","fails","course푐\n2\n).\nActually,","both","the","two","tasks","could","be","equally","important.","According","to","college","rules","of","student\nmanagement,","either","a","low","Weighted","Average","Grade","or","a","certain","number","of","failed","courses","lead","to\nthe","academic","probation","even","the","academic","dismissal.","Thus,","to","effectively","predict","those","students\nwho","may","violate","college","academic","requirements,","both","the","academic","performance","prediction","and\nthe","course-failing","prediction","are","needed.","Besides,","some","students","may","be","more","concerned","with","their\nWeighted","Average","Grades,","because","they","may","apply","for","graduate","studies.","Knowing","their","Weighted\nAverage","Grades","previously","would","help","them","to","study","harder.","Nevertheless,","some","students","may","be\nmore","concerned","with","whether","they","fail","or","not,","because","if","they","failed","a","course,","they","would","not","be\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:6Haobing","L.","et","al.\nqualified","for","student","loans.","In","this","case,","knowing","whether","they","fail","or","not","would","help","them","to","act\naccordingly.\nMethods","used","in","course-failing","prediction","include","k-nearest","neighbour","methods","[37],","ensemble\nmethods","[44],","feed","forward","neural","networks","[34]","and","so","on.","In","detail,","Tanner","and","Toivonen","[37]\ntook","student","status","features,","student","performance","features,","lesson","requirement","features,","and","cus-\ntomer","demographic","features","as","possible","input","of","a","k-nearest","neighbor","method","to","do","course-failing\nprediction","in","an","online","course","setting.","Yu","et","al.","[44]","did","feature","engineering","and","used","a","random\nforest","algorithm","(i.e.,","an","ensemble","method)","to","predict","whether","the","student","will","be","correct","on","the","first\nattempt","for","a","step","based","on","interaction","logs","generated","in","intelligent","tutoring","systems.","Sukhbaatar\net","al.","[34]","employed","a","feed","forward","neural","network","on","the","set","of","prediction","factors","extracted","from\nthe","online","learning","activities","of","students","to","identify","students","at","risk","of","failing","in","a","course.\n2.5","","","","Multi-Task","Learning\nMulti-task","learning","(MTL)","was","first","analyzed","by","Caruana","[5]","in","detail.","Multi-task","learning","could\nimprove","learning","efficiency","and","prediction","accuracy","for","each","task","when","compared","to","training","a\nseparate","model","for","each","task.","One","important","reason","is","that","multi-task","learning","allows","sharing\nof","statistical","strength","and","transferring","of","knowledge","between","related","tasks.","Multi-task","learning\nhas","been","used","successfully","in","many","fields,","such","as","computer","vision","[9,30],","natural","language\nprocessing","[8],","urban","computing","[24].\n3","","","","PRELIMINARIES\nIn","this","section,","we","introduce","the","problem","statement.\nEntering","the","Library","Records.When","students","enter","the","library,","they","need","to","swipe","their","campus\ncards.","Thus","records","are","generated.","One","entering","the","library","record","can","be","represented","as푟\n퐿푖푏\n=\n(푠,푡\n퐿푖푏\n),","where푠denotes","student푠and푡\n퐿푖푏\ndenotes","the","timestamp","of","the","record.\nEntering","the","Dormitory","Records.\nSimilar","to","entering","the","library","records,","one","entering","the\ndormitory","record","is","represented","as푟\n퐷표푟푚\n=(푠,푡\n퐷표푟푚\n),","where푠denotes","student푠and푡\n퐷표푟푚\ndenotes\nthe","timestamp.\nStudent","Profile","Records.One","record","of","this","sub-dataset","can","be","represented","as(푠,푫),","where푫is\nan","attribute","set","about","demographic","information","of","student푠.","In","this","paper,","according","to","the","dataset,\nthe","attributes","include","the","place","of","birth,","nationality,","gender,","grade,","school,","and","department.","If","other\ndemographic","information","was","available,","it","could","also","be","added.\nStudent","Final","Course","Grade","Records.\nGiven","course푐\n휃\n,","one","record","can","be","represented","as푟\n퐺푟푎푑푒\n=\n(푠,T,푐\n휃\n,푐푟푒푑푖푡(푐\n휃\n),푔푟푎푑푒(푠,푐\n휃\n))\n,","whereTis","the","index","of","the","whole","semesters","that","student푠\ninvolves","in;푐푟푒푑푖푡(푐\n휃\n)is","the","credit","of","course푐\n휃\nand푔푟푎푑푒(푠,푐\n휃\n)is","the","final","grade","student푠achieves\nin","course푐\n휃\n.1≤","T","≤푇.\nProblem","Statement.In","this","paper,","we","have","three","motivating","tasks.\nPAP","task:Given","digital","footprints","(i.e.,{푟\n퐿푖푏\n}and{푟\n퐷표푟푚\n})","generated","in","the","first푋days","of\nthe","semester푇+1,","profile","information푫,","and","final","course","grade","records{푟\n퐺푟푎푑푒\n}generated","in","all\nprevious푇semesters","of","student푠,","our","goal","is","to","predict","the","future","academic","performance","(i.e.,\nWGA)","of","student푠in","semester푇+1.푋<#푑푎푦푠","푖푛","표푛푒","푠푒푚푒푠푡푒푟.\nPNBB","task:Given","digital","footprints","(i.e.,{푟\n퐿푖푏\n}and{푟\n퐷표푟푚\n})","generated","in","the","first푋days","of\nthe","semester푇+1,","profile","information푫,","and","the","number","of","borrowed","books","in","each","previous\nsemester","(the","number","of","all","previous","semesters","is푇)","of","student푠,","our","goal","is","to","predict","the","number\nof","borrowed","books","of","student푠in","semester푇+1.푋<#푑푎푦푠","푖푛","표푛푒","푠푒푚푒푠푡푒푟.\nPNFC","task:Given","digital","footprints","(i.e.,{푟\n퐿푖푏\n}and{푟\n퐷표푟푚\n})","generated","in","the","first푋days","of\nthe","semester푇+1,","profile","information푫,","and","final","course","grade","records{푟\n퐺푟푎푑푒\n}generated","in","all\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:7\n푩푩\n2,1\n푠푠\n푩푩\n2,2\n푠푠\n푩푩\n2,푋푋\n푠푠\n\n푩푩\n1,2\n푠푠\n푩푩\n1,푋푋\n푠푠\n\n푩푩\n1,1\n푠푠\nSoft-attentionMechanism\n�\n푫푫\n풔풔\n�\n푩푩\n풔풔\n푹푹\n푠푠\nMulti-task","Interaction","Unit","1\n:","Profile-aware","LSTM\n:","Concat\n훼훼\n1\n푠푠\n훼훼\n2\n푠푠\n훼훼\n푋푋\n푠푠\n�\n푫푫\n풔풔\nDenseEmbedding\n푫푫\n푠푠\nInput","1\n푩푩\n1,푥푥\n푠푠\nInput","2\n푩푩\n2,푥푥\n푠푠\nInput","3\n...\n�\n풉풉\n1\n푠푠\n�\n풉풉\n2\n푠푠\n�\n풉풉\n푋푋\n푠푠\n...\nCo-attentionMechanism\nFC","1FC","푁푁\n훽훽\n1푁푁\n푠푠\n훽훽\n1푁푁\n푠푠\n...\nMulti-task","Interaction","Unit","퐿퐿\nOutput","1Output","푁푁\nCancatCancat\nOther","Inputs:","Task-relatedfeatures\nDetailed","Structure","of","one","Multi-task","Interaction","Unit:","\n...\nTask","1Task","푁푁\n...\n...\n�\n푹푹\n1\n푠푠,1\n�\n푹푹\n푁푁\n푠푠,1\n�\n푹푹\n1\n푠푠,퐿퐿+1\n�\n푹푹\n푁푁\n푠푠,퐿퐿+1\n�\n푹푹\n1\n푠푠,퐿퐿\n�\n푹푹\n1\n푠푠,퐿퐿+1\n�\n푹푹\n푁푁\n푠푠,퐿퐿\n�\n푹푹\n푁푁\n푠푠,퐿퐿+1\n�\n푹푹\n1\n푠푠,퐿퐿\n′\n�\n푹푹\n푁푁\n푠푠,퐿퐿\n′\nFig.","2.","","The","main","structure","of","DAPAMT.\nprevious푇semesters","of","student푠,","our","goal","is","to","predict","the","number","of","failed","courses","of","student푠in\nsemester푇+1.푋<#푑푎푦푠","푖푛","표푛푒","푠푒푚푒푠푡푒푟.\n4","","","","PROPOSED","DAPAMT","MODEL\nThe","main","structure","of","our","proposed","Dual","Attention","Profile-Aware","Multi-Task","model","(DAPAMT)","is\nillustrated","in","Figure","2.","The","rest","of","this","section","is","organized","as","follows.","First,","we","introduce","how","to\nmodel","the","daily","behavior","sequence","with","Profile-aware","LSTM","and","attention-based","pooling.","Then","we\nintroduce","how","to","explicitly","model","the","interaction","among","multiple","prediction","tasks","with","stacked\nMulti-task","Interaction","Units.","Finally,","we","utilize","task-specific","output","layers","to","get","the","final","prediction\nresults.","Table","1","summarizes","main","notations","and","their","meanings","used","throughout","this","paper.\n4.1","","","","Inputs","and","Dense","Embedding","Layer\nStudent푠’","profile","information푫\n푠\nis","represented","in","the","form","of","one","high-dimensional","vector","including\nmany","one-hot","encoded","vectors.","To","reduce","the","dimension","and","get","a","better","representation,","we","use","a\ndense","embedding","layer.","The","transformation","is","formalized","as:\n","̄\n푫\n푠\n=푾\n퐷\n푫\n푠\n,(1)\nwhere푾\n퐷\nis","the","mapping","matrix.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:8Haobing","L.","et","al.\nTable","1.","","Main","notations.\nNotationDescription\n푫\n푠\nProfile","information","of","student푠.\n","̄\n푫\n푠\nDense","representation","of","the","profile","information.\n푩\n푚,푥\nFeature","vector","of","the푚-th","kind","of","behavior","at","the푥-th","day.\n풊,풇and풐Input,","forget","and","output","gates.\n풉\n푠\n푚,푥\nHidden","state","of","Profile-aware","LSTM","that","models","the푚-th","kind","of","behavior\nat","the푥-th","timestamp.\n^\n풉\n푠\n푥\nHidden","representation","of","all","heterogeneous","behaviors","of","the푥-th","day.\n훼terms\nSoft-attention","weights.\n","̄\n푩\n푠\nAdvanced","student","behavior","representation.\n푹\n푠\nStudent","representation.\n푦\n푠\n1,T\n,푦\n푠\n2,T\nand푦\n푠\n3,T\nWAG,","#","borrowed","books","and","#","failed","courses","in","semesterT.\n^\n푹\n푠,푙\n1\n,\n^\n푹\n푠,푙\n2\nand\n^\n푹\n푠,푙\n3\nInputs","(task-specific","feature","vectors)","of","the푙-th","Multi-task","Interaction","Unit.\n^\n푹\n푠,푙\n′\n1\n,\n^\n푹\n푠,푙\n′\n2\nand\n^\n푹\n푠,푙\n′\n3\nMore","task-specific","feature","vectors.\n훽termsCo-attention","weights.\nThinking","that","the","combination","of","entering","the","library","and","going","back","to","the","dormitory","behaviors\ncan","reveal","students’","academic","efforts,","we","extract","the","daily","behavior","sequence","of","entering","the\nlibrary","and","the","daily","behavior","sequence","of","going","back","to","the","dormitory","from{푟\n퐿푖푏\n}and{푟\n퐷표푟푚\n}\nrespectively.\nMore","specifically,","we","divide","one","day","into24time","slots","by","hour","(i.e.,[00",":","00,01",":","00),[01",":\n00,02",":","00),","...,[23",":","00,24",":","00)).","According","to{푟\n퐿푖푏\n},","almost","100%","of","entering","the","library","records\nare","generated","in","07:00-23:00.","So","we","use16elements","to","record","entering","the","library","frequency","in\n07:00-23:00","for","each","day.","In","this","way,","we","get","the","daily","behavior","sequence","of","entering","the","library:\n푩\n1,1\n,푩\n1,2\n,","...,푩\n1,푥\n,","...,푩\n1,푋\n(푥is","the","index.푋=63since","we","make","predictions","after","the","first","half","of\nthe","semester","(63","days).).\nOne","going","back","to","the","dormitory","record","is","defined","as","the","last","record","of","entering","the","dormitory\nof","the","day.","Based","on{푟\n퐷표푟푚\n},","around","84%","of","going","back","to","the","dormitory","records","are","generated\nin","18:00-24:00.","So","we","use","a","vector","with","a","length","of6to","record","the","situation","of","going","back","to","the\ndormitory","in","18:00-24:00","for","each","day.","In","this","way,","we","get","the","behavior","sequence","of","going","back","to\nthe","dormitory:푩\n2,1\n,푩\n2,2\n,","...,푩\n2,푥\n,","...,푩\n2,푋\n.\n4.2","","","","Profile-aware","LSTM\nSimilar","behaviors","of","different","kinds","of","students","may","mean","differently.","We","propose","a","variant","of\nLSTM","called","Profile-aware","LSTM.","We","treat","student","profile","information","as","a","strong","signal","in","the\ngates","of","Profile-aware","LSTM","(as","Equation(2),(3)and(5)show).","That","is","to","say,","what","to","extract,\nwhat","to","remember,","and","what","to","forward","are","affected","by","student","profile","information.","The","behavior\nsequence","is","the","input","of","Profile-aware","LSTM","(as","Equation","(4)","shows).\nProfile-aware","LSTM","model","is","formulated","as","follows","and","the","detailed","structure","is","shown","in\nFigure","3:\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:9\n풉풉\n푚푚,푥푥\n푠푠\n풉풉\n푚푚,푥푥−1\n푠푠\n푩푩\n푚푚,푥푥\n푠푠\n�\n푫푫\n풔풔\n풉풉\n푚푚,푥푥−1\n푠푠\n푩푩\n푚푚,푥푥\n푠푠\n�\n푫푫\n풔풔\n풉풉\n푚푚,푥푥−1\n푠푠\n푩푩\n푚푚,푥푥\n푠푠\n�\n푫푫\n풔풔\ntanh\n풊풊\n풇풇\n풐풐\n풉풉\n푚푚,푥푥−1\n푠푠\n푩푩\n푚푚,푥푥\n푠푠\n풄풄\ntanh\nFig.","3.","","Detailed","structure","of","Profile-aware","LSTM.\n풊\n푚,푥\n=휎(푾\n푖퐵\n푩\n푠\n푚,푥\n+푾\n푖ℎ\n풉\n푠\n푚,푥−1\n+푾\n푖퐷\n","̄\n푫\n푠\n+풃\n푖\n),(2)\n풇\n푚,푥\n=휎(푾\n푓","퐵\n푩\n푠\n푚,푥\n+푾\n푓ℎ\n풉\n푠\n푚,푥−1\n+푾\n푓","퐷\n","̄\n푫\n푠\n+풃\n푓\n),(3)\n풄\n푚,푥\n=풇\n푚,푥\n⊙풄\n푚,푥−1\n+풊\n푚,푥\n⊙tanh(푾\n푐퐵\n푩\n푠\n푚,푥\n+푾\n푐ℎ\n풉\n푠\n푚,푥−1\n+풃\n푐\n),(4)\n풐\n푚,푥\n=휎(푾\n표퐵\n푩\n푠\n푚,푥\n+푾\n표ℎ\n풉\n푠\n푚,푥−1\n+푾\n표퐷\n","̄\n푫\n푠\n+풃\n표\n),(5)\n풉\n푠\n푚,푥\n=풐\n푚,푥\n⊙tanh(풄\n푚,푥\n),(6)\nwhere푩\n푠\n푚,푥\nand풉\n푠\n푚,푥\nare","one","input","element","and","the","corresponding","output","of","Profile-aware","LSTM\nunit,","i.e.,","hidden","state","at","time푥,","respectively.\n","̄\n푫\n푠\nis","calculated","with","Equation(1).푚=1,2.1≤푥≤\n푋=63.푾terms","denote","weight","matrices","and풃terms","are","bias","vectors.휎is","the","element-wise","sigmoid\nfunction","and⊙is","the","element-wise","product.\nWe","use","two","Profile-aware","LSTMs","to","model","two","kinds","of","behaviors","respectively.\n4.3","","","","Attention-based","Pooling","Layer\nThe","hidden","representation","of","all","heterogeneous","behaviors","of","the푥-th","day","can","be","formalized","as:\n^\n풉\n푠\n푥\n=풉\n푠\n1,푥\n⊕풉\n푠\n2,푥\n,(7)\nwhere⊕is","the","concatenation","operation.\nBehaviors","of","different","days","to","the","task","will","have","different","degrees","of","impact.","Inspired","by","the\nsuccess","of","the","attention","mechanism","in","machine","translation","[1],","we","apply","a","novel","soft-attention\nmechanism","over","Profile-aware","LSTM","to","draw","information","from","the","sequence","by","different","weights.\nIn","detail,","we","consider","each","vector\n^\n풉\n푠\n푥\nas","heterogeneous","behaviors","representation","of","the푥-th","day,","and\nrepresent","the","sequence","by","a","weighted","sum","of","the","vector","representation","of","all","days.","The","attention\nweight","makes","it","possible","to","perform","proper","credit","assignments","to","days","according","to","their","importance\nto","the","student.","Mathematically,","we","compute","soft-attention","weight훼\n푠\n푥\nwith","the","following","equations:\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:10Haobing","L.","et","al.\n:","PNBB","task:","PNFC","task:","PAP","task\nConcat\n푹푹\n푠푠\n푦푦\n1,1\n푠푠\n푦푦\n1,2\n푠푠\n...","푦푦\n1,푇푇\n푠푠\n풗풗\n1\n푠푠\nLSTM\n푦푦\n2,1\n푠푠\n푦푦\n2,2\n푠푠\n...","푦푦\n2,푇푇\n푠푠\nLSTM\nConcat\n푹푹\n푠푠\n푦푦\n3,1\n푠푠\n푦푦\n3,2\n푠푠\n...","푦푦\n3,푇푇\n푠푠\nLSTM\n풗풗\n3\n푠푠\nConcat\n푹푹\n푠푠\nKnowledge","Transfer\nMulti-task","Interaction","\nUnit","1\nMulti-task","Interaction","\nUnit","퐿퐿\n�\n푹푹\n1\n푠푠,1\n�\n푹푹\n2\n푠푠,1\n�\n푹푹\n3\n푠푠,1\n�\n푹푹\n1\n푠푠,퐿퐿+1\n�\n푹푹\n2\n푠푠,퐿퐿+1\n�\n푹푹\n3\n푠푠,퐿퐿+1\nFig.","4.","","Detailed","structure","of","stacked","Multi-task","Interaction","Units","with","the","three","motivating","tasks.\n푎\n푠\n푥\n=푾\n푎0\ntanh(푾\n푎1\n^\n풉\n푠\n푥\n+푾\n푎2\n","̄\n푫\n푠\n+풃\n푎\n),(8)\n훼\n푠\n푥\n=\nexp(푎\n푠\n푥\n)\nÍ\n푋\n푥\n′\n=1\nexp(푎\n푠\n푥\n′\n)\n,(9)\nwhere\n","̄\n푫\n푠\nis","computed","with","Equation(1),\n^\n풉\n푠\n푥\nis","computed","with","Equation(7),푾terms","denote","weight\nmatrices,","and풃\n푎\nis","the","bias","vector.","Similar","to","Profile-aware","LSTM,","student","profile","information","also\ncontributes","to","the","attention","weights.\nThe","advanced","student","behavior","representation","is","generated","using","the","following","equation:\n","̄\n푩\n푠\n=\n푋\n∑︁\n푥=1\n훼\n푠\n푥\n^\n풉\n푠\n푥\n.(10)\nThe","student","representation푹\n푠\nis","the","concatenation","of\n","̄\n푫\n푠\nand\n","̄\n푩\n푠\n:\n푹\n푠\n=\n","̄\n푫\n푠\n⊕\n","̄\n푩\n푠\n.(11)\n4.4","","","","Stacked","Multi-task","Interaction","Units\nAfter","obtaining","the","student","representation,","we","concatenate","it","with","task-related","features.","In","detail,\nwe","have","three","tasks:","PAP","task,","PNBB","task,","and","PNFC","task.","For","PAP","task,","the","task-related","information\nincludes","the","historical","WAG","information","and","the","involved","course","information;","for","PNBB","task,","the\ntask-related","information","includes","the","historical","number","of","borrowed","books","information;","for","PNFC\ntask,","the","task-related","information","includes","the","historical","number","of","failed","courses","and","the","involved\ncourse","information","as","Figure","4","shows.","Then","we","feed","the","concatenated","features","to","stacked","Multi-task\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:11\nEI205MA080CS307CS214CS359MA119PH001MA115EE312CS362\nCourse","Code\n40\n50\n60\n70\n80\n90\n100\nFinal","Grade\nFig.","5.","","Grade","distributions","of","some","different","courses","set","in","Department","of","Computer","Science","and","Engineering.\nInteraction","Units.","In","what","follows,","we","introduce","how","to","handle","the","various","kinds","of","task-related\ninformation","and","introduce","the","detailed","structure","of","the","Multi-task","Interaction","Unit.\nPAP","Task.As","mentioned","in","Section","2,","we","use","WAG","to","quantitatively","describe","the","academic\nperformance.","Given{푟\n퐺푟푎푑푒\n},","WAG","is","calculated","with","the","following","equation:\n푦\n푠\n1,T\n=\nΘ\n∑︁\n휃=1\n푐푟푒푑푖푡(푐\n휃\n)푔푟푎푑푒(푠,푐\n휃\n)\nÍ\nΘ\n휃=1\n푐푟푒푑푖푡(푐\n휃\n)\n,(12)\nwhereΘis","the","number","of","courses","chosen","by","student푠in","semesterT.","In","this","way,","we","get","the","historical\nWAG","sequence","of","student푠:푦\n푠\n1,1\n,푦\n푠\n1,2\n,","...,푦\n푠\n1,T\n,","...,푦\n푠\n1,푇\n.","The","historical","WAG","sequence","reveals","students’\ntrends","of","academic","performance.","Note","that","the","length","of","the","historical","WAG","sequence","may","vary\nfrom","student","to","student,","so","we","adopt","a","dynamic","LSTM","to","model","the","sequence:\nℏ\n푠\n1,T\n=LSTM(푦\n푠\n1,T\n,ℏ\n푠\n1,T−1\n),1≤","T","≤푇,(13)\nwhere푦\n푠\n1,T\nandℏ\n푠\n1,T\nare","one","input","and","the","corresponding","hidden","state","at","timeT.","We","regard","the\nlast","hidden","stateℏ\n푠\n1,푇\nas","the","trend","representation.\nWe","find","that","students","get","higher","grades","easily","in","some","courses","such","as","CS362","as","Figure","5","shows.\nThis","means","different","courses","have","different","levels","of","difficulty.","So","for","each","course,","we","extract\ndescriptive","statistics","(i.e.,","minimum,","maximum,","median,","first","quartile,","third","quartile,","mean,","standard\ndeviation)","as","features.","These","features","can","describe","the","properties","of","distribution","from","multiple\naspects.","The","feature","vector","of","course푐\n휃\nis","represented","as풆\n1,휃\n.","Next,","we","aggregate","feature","vectors\nof","all","courses","by","leveraging","course","credit","information:\n풗\n푠\n1\n=\nΘ\n∑︁\n휃=1\n푐푟푒푑푖푡(푐\n휃\n)풆\n1,휃\nÍ\nΘ\n휃=1\n푐푟푒푑푖푡(푐\n휃\n)\n.(14)\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:12Haobing","L.","et","al.\nThen","we","concatenate푹\n푠\n,ℏ\n푠\n1,푇\nwith풗\n푠\n1\n:\n^\n푹\n푠\n1\n=푹\n푠\n⊕ℏ\n푠\n1,푇\n⊕풗\n푠\n1\n.(15)\nPNBB","Task.\nSimilarly,","the","historical","number","of","borrowed","books","sequence","reveals","students’","trends\nof","the","number","of","borrowed","books.","We","utilize","another","dynamic","LSTM","to","model","the","sequence:\nℏ\n푠\n2,T\n=LSTM(푦\n푠\n2,T\n,ℏ\n푠\n2,T−1\n),1≤","T","≤푇,(16)\nwhere푦\n푠\n2,T\nandℏ\n푠\n2,T\nare","one","input","and","the","corresponding","hidden","state","at","timeT.ℏ\n푠\n2,푇\nis","the","trend\nrepresentation.\nThen","we","concatenate푹\n푠\nwithℏ\n푠\n2,푇\n:\n^\n푹\n푠\n2\n=푹\n푠\n⊕ℏ\n푠\n2,푇\n.(17)\nPNFC","Task.A","LSTM","is","leveraged","to","model","the","historical","number","of","failed","courses","sequence:\nℏ\n푠\n3,T\n=LSTM(푦\n푠\n3,T\n,ℏ\n푠\n3,T−1\n),1≤","T","≤푇,(18)\nwhere푦\n푠\n3,T\nandℏ\n푠\n3,T\nare","one","input","and","the","corresponding","hidden","state","at","timeT.\nWe","also","extract","some","features","such","as","course","failure","rate","and","descriptive","statistics.","The","feature\nvector","of","course푐\n휃\nis","represented","as풆\n3,휃\n.","We","merger","information","of","every","course","by:\n풗\n푠\n3\n=\nΘ\n∑︁\n휃=1\n풆\n3,휃\nΘ\n.(19)\nThen","we","concatenate푹\n푠\n,ℏ\n푠\n3,푇\nwith풗\n푠\n3\n:\n^\n푹\n푠\n3\n=푹\n푠\n⊕ℏ\n푠\n3,푇\n⊕풗\n푠\n3\n.(20)\nMulti-task","Interaction","Unit.\nWe","stack퐿Multi-task","Interaction","Units.","Formally,","for","the푙-th","unit,\nthe","inputs","are\n^\n푹\n푠,푙\n1\n,\n^\n푹\n푠,푙\n2\n,","and\n^\n푹\n푠,푙\n3\n.","The","outputs","are\n^\n푹\n푠,푙+1\n1\n,\n^\n푹\n푠,푙+1\n2\n,","and\n^\n푹\n푠,푙+1\n3\n.1≤푙≤퐿.\nFirstly,","we","utilize","Fully","Connected","(FC)","layers","to","make","the","inputs","more","task-specific","and","to","let\nthe","inputs","have","the","same","dimensions,","which","can","be","written","as:\n^\n푹\n푠,푙\n′\n1\n=PReLU(푾\n푙\n1\n^\n푹\n푠,푙\n1\n+풃\n푙\n1\n),(21)\n^\n푹\n푠,푙\n′\n2\n=PReLU(푾\n푙\n2\n^\n푹\n푠,푙\n2\n+풃\n푙\n2\n),(22)\n^\n푹\n푠,푙\n′\n3\n=PReLU(푾\n푙\n3\n^\n푹\n푠,푙\n3\n+풃\n푙\n3\n),(23)\nwhere푾terms","and풃terms","are","learnable","parameters,","andPReLU[14]","is","the","nonlinear","activation\nfunction.\n^\n푹\n푠,1\n1\n,\n^\n푹\n푠,1\n2\n,","and\n^\n푹\n푠,1\n3\nare","calculated","with","Equation","(15),","(17),","and","(20),","respectively.\nThen","we","utilize","the","co-attention","mechanism","to","explicitly","control","the","knowledge","transfer.","The\nco-attention","mechanism","was","first","proposed","to","jointly","reasons","about","visual","attention","and","question","at-\ntention","[23].","The","co-attention","mechanism","demonstrates","the","ability","of","capturing","the","complementary\nimportant","information.","With","the","co-attention","mechanism,","we","can","get","the","updated","representation\nexplicitly","incorporating","other","tasks’","knowledge.","Mathematically,","we","compute","co-attention","weights\nwith","the","following","equations:\n훽\n푠\n12\n=휎((\n^\n푹\n푠,푙\n′\n1\n)\n⊤\n^\n푹\n푠,푙\n′\n2\n),(24)\n훽\n푠\n13\n=휎((\n^\n푹\n푠,푙\n′\n1\n)\n⊤\n^\n푹\n푠,푙\n′\n3\n),(25)\n훽\n푠\n23\n=휎((\n^\n푹\n푠,푙\n′\n2\n)\n⊤\n^\n푹\n푠,푙\n′\n3\n),(26)\nwhere휎is","the","sigmoid","function.","That","is","to","say,","we","leverage","dot","product","and","sigmoid","function","to\ncalculate","the","co-attention","weights.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:13\nThe","updated","representations","are","generated","using","the","following","equations:\n^\n푹\n푠,푙+1\n1\n=\n^\n푹\n푠,푙\n′\n1\n+훽\n푠\n12\n^\n푹\n푠,푙\n′\n2\n+훽\n푠\n13\n^\n푹\n푠,푙\n′\n3\n,(27)\n^\n푹\n푠,푙+1\n2\n=\n^\n푹\n푠,푙\n′\n2\n+훽\n푠\n12\n^\n푹\n푠,푙\n′\n1\n+훽\n푠\n23\n^\n푹\n푠,푙\n′\n3\n,(28)\n^\n푹\n푠,푙+1\n3\n=\n^\n푹\n푠,푙\n′\n3\n+훽\n푠\n13\n^\n푹\n푠,푙\n′\n1\n+훽\n푠\n23\n^\n푹\n푠,푙\n′\n2\n.(29)\n4.5","","","","Output","Layers\nAfter퐿Multi-task","Interaction","Units,","we","can","get","the","outputs","of","the","last","unit:\n^\n푹\n푠,퐿+1\n1\n,\n^\n푹\n푠,퐿+1\n2\n,","and\n^\n푹\n푠,퐿+1\n3\n.","Then","we","adopt","separate","output","layers","to","get","the","prediction","results,","which","can","be","denoted","as\nfollows:\n","̃\n푦\n푠\n1,푇+1\n=tanh(푾\n푂1\n^\n푹\n푠,퐿+1\n1\n+푏\n푂1\n),(30)\n","̃\n푦\n푠\n2,푇+1\n=tanh(푾\n푂2\n^\n푹\n푠,퐿+1\n2\n+푏\n푂2\n),(31)\n","̃\n푦\n푠\n3,푇+1\n=tanh(푾\n푂3\n^\n푹\n푠,퐿+1\n3\n+푏\n푂3\n),(32)\nwhere푾terms","and푏terms","are","parameters.\n4.6","","","","Optimization\nWe","use","the","mean","squared","error","(MSE)","as","the","loss","function","for","training","the","three","tasks:\nL\n1\n(Φ\n1\n)=\n1\n푈\n푈\n∑︁\n푖=1\n(푦\n푖\n1,푇+1\n−\n","̃\n푦\n푖\n1,푇+1\n)\n2\n,(33)\nL\n2\n(Φ\n2\n)=\n1\n푈\n푈\n∑︁\n푖=1\n(푦\n푖\n2,푇+1\n−\n","̃\n푦\n푖\n2,푇+1\n)\n2\n,(34)\nL\n3\n(Φ\n3\n)=\n1\n푈\n푈\n∑︁\n푖=1\n(푦\n푖\n3,푇+1\n−\n","̃\n푦\n푖\n3,푇+1\n)\n2\n,(35)\n(36)\nwhere푖denotes","one","training","sample,푈is","the","number","of","training","samples,","andΦterms","are","all\ntrainable","parameters.푦\n푖\n1,푇+1\n,푦\n푖\n2,푇+1\n,","and푦\n푖\n3,푇+1\ndenote","the","labels","of","the푖-th","sample.\nThe","total","loss","is","computed","as","the","sum","of","the","three","individual","losses:\nL\n푇표푡푎푙\n=휆\n1\nL\n1\n+휆\n2\nL\n2\n+휆\n3\nL\n3\n,(37)\nwhere휆terms","are","balance","weights.","Here,","balance","weights","of","1","are","implicitly","used","among","the","three\ntasks.\nThe","training","process","is","outlined","in","Algorithm","1.","We","adopt","the","adaptive","moment","estimation\n(Adam)","[19]","as","the","optimizer.\nIn","order","to","improve","the","generalization","capability","of","our","models,","we","adopt","dropout","[33]","to","prevent\nthe","potential","overfitting","problem.\n5","","","","EXPERIMENTS\nIn","this","section,","we","describe","the","detailed","experimental","settings","and","discuss","the","results.\n5.1","","","","Dataset\nThe","data","were","collected","in","a","college","with","an","enrollment","of10푘undergraduate","students.","Dataset\nstatistics","are","shown","in","Table","2.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:14Haobing","L.","et","al.\nAlgorithm","1DAPAMT","Training","Algorithm\nInput:\nFor","","","each","","","student:","","","given푀daily","","","behavior\nsequences","","of","","length푋generated","","in","","semes-\nter푇+1{푩\n1,1\n,","...,푩\n1,푋\n;...;푩\n푀,1\n,","...,푩\n푀,푋\n};\nstudent","","","","profile","","","","information푫;푁histor-\nical","","","","observation","","","","sequences","","","","of","","","","length푇\n{푦\n1,1\n,","...,푦\n1,푇\n;...;푦\n푁,1\n,","...,푦\n푁,푇\n}\n;","","additional","","task-\nrelated","feature","vectors{풗\n1\n,","...,풗\n푁\n}(some","tasks\nmay","","not","","have","","corresponding","","additional","","task-\nrelated","feature","vectors).","The","number","of","Multi-\ntask","","Interaction","","Units퐿.푁balance","","weights\n{휆\n1\n,","...,휆\n푁\n}\nOutput:\nLearned","DAPAMT","model\n1://Forward","propagation\n2:Initialization;\n3://Dense","Embedding","Layer\n4:\n","̄\n푫=푾\n퐷\n푫;\n5://Profile-aware","LSTMs\n6:foreach푚∈","[1,푀]do\n7:풉\n푚,푥\n=\nProfile-aware_LSTM(푩\n푚,푥\n,\n","̄\n푫),1≤\n푥≤푋;\n8:end","for\n9://Attention-based","Pooling","Layer\n10:foreach푥∈","[1,푋]do\n11:\n^\n풉\n푥\n=풉\n1,푥\n⊕···풉\n푚,푥\n···⊕풉\n푀,푥\n;\n12:end","for\n13:foreach푥∈","[1,푋]do\n14:훼\n푥\n=Soft-attention_Mechanism(\n^\n풉\n푥\n,\n","̄\n푫);\n15:end","for\n16:\n","̄\n푩←0\n17:foreach푥∈","[1,푋]do\n18:\n","̄\n푩←\n","̄\n푩+훼\n푥\n^\n풉\n푥\n;\n19:end","for\n20:푹=\n","̄\n푫⊕\n","̄\n푩\n21://Stacked","Multi-task","Interaction","Units\n22:foreach푛∈","[1,푁]do\n23:ℏ\n푛,T\n=LSTM(푦\n푛,T\n),1≤","T","≤푇;\n24:end","for\n25:foreach푛∈","[1,푁]do\n26:\n^\n푹\n1\n푛\n←\n^\n푹\n푛\n=푹⊕ℏ\n푛,푇\n⊕풗\n푛\n(if풗\n푛\nexists);\n27:end","for\n28:foreach푙∈","[1,퐿]do\n29:foreach푛∈","[1,푁]do\n30:\n^\n푹\n푙\n′\n푛\n=PReLU(푾\n푙\n푛\n^\n푹\n푙\n푛\n+풃\n푙\n푛\n);\n31:end","for\n32:foreach푖∈","[1,푁−1]do\n33:foreach푗∈","[푖+1,푁]do\n34:훽\n푖푗\n=Co-attention_Mechanism(\n^\n푹\n푙\n′\n푖\n,\n^\n푹\n푙\n′\n푗\n);\n35:end","for\n36:end","for\n37:foreach푛∈","[1,푁]do\n38:\n^\n푹\n푙+1\n푛\n=\n^\n푹\n푙′\n푛\n+\nÍ\n(1≤푖≤푁)∧(푖≠푛)\n훽\n푖푛\n^\n푹\n푙′\n푖\n;\n39:end","for\n40:end","for\n41://Output","Layer\n42:foreach푛∈","[1,푁]do\n43:\n","̃\n푦\n푛,푇+1\n=tanh(푾\n푂푛\n^\n푹\n퐿+1\n푛\n+푏\n푂푛\n);\n44:end","for\n45://Back","propagation\n46:L=\nÍ\n푁\n푛=1\n휆\n푛\nMSE(푦\n푛,푇+1\n,\n","̃\n푦\n푛,푇+1\n);\n5.2","","","","Comparison","Baselines\nTo","demonstrate","the","effectiveness","of","our","proposed","model,","we","compared","our","proposed","model,","i.e.,\nDAPAMT,","with","various","baselines.\n•HA:","We","give","the","prediction","result","by","the","average","value","of","historical","observations.\n•LSTM[10]:","LSTM","is","widely","used","to","model","sequence","data.","We","leverage","LSTMs","to","model\nhistorical","observation","sequences.\n•\nBRR[39]:","Bayesian","Ridge","Regression","(BRR)","is","a","generalized","linear","model","which","has퐿\n2\nregularization.\n•\nSVR[38]:","Support","Vector","Regression","(SVR)","is","a","variant","of","support","vector","machine","(SVM)","for\nsupporting","regression","tasks.","SVR","is","a","minimum-margin","regression","which","could","model","the\nnon-linear","relation","between","features.\n•RF[6]:","Random","Forest","(RF)","is","an","ensemble","method","with","decision","trees","as","base","learners.","It","is\nbased","on","the","“bagging”","idea.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:15\n•GBDT:","Gradient","Boosting","Decision","Tree","(GBDT)","is","another","kind","of","ensemble","method","using\ndecision","trees","as","base","learners.","GBDT","is","a","generalization","of","boosting","to","arbitrary","differentiable\nloss","functions.\n•MLP[34,","41]:","Multi-layer","Perceptron","(MLP)","consists","of","multiple","layers","of","nodes.","Each","layer\nis","fully","connected","to","the","next","layer","in","the","network.\n•APAMT[21]:","Attentional","Profile-Aware","Multi-Task","model","(APAMT)","is","proposed","in","our\npreliminary","work.","It","leverages","the","Profile-aware","LSTM","and","the","soft-attention","mechanism","to\nmodel","the","daily","behavior","sequence.","Besides,","it","adopts","a","simpler","multi-task","learning","framework\ncompared","with","DAPAMT.","Specifically,","it","implicitly","models","the","interactions","among","tasks","by\nsetting","shared","layers","and","task-specific","layers.\n5.3","","","","Evaluation","Metric\nWe","adopt","Mean","Square","Error","(MSE)","to","quantify","the","distance","between","the","predicted","scores","and","the\nactual","ones.","MSE","penalizes","large","errors","more","heavily","than","the","non-quadratic","metrics,","and","thus\ntakes","higher","numerical","values.","Given","our","tasks,","if","a","method","performs","very","well","for","half","the","students\nand","poorly","for","the","other","half,","we","still","think","it","is","not","a","good","method.","Hence","we","select","MSE","as","the\nmetric","to","compare","methods.","The","smaller","the","values","are,","the","better","results","the","method","has.","The\nmetric","is","defined","as:\n푀푆퐸=\n1\n|푈|\n푈\n∑︁\n푖=1\n(푧\n푖\n−\n","̃\n푧\n푖\n)\n2\n,(38)\nwhere푖denotes","one","testing","instance,푈is","the","number","of","testing","samples,푧\n푖\nis","the","actual","value,\nand\n","̃\n푧\n푖\nis","the","predicted","value.","For","better","understanding","the","metric","and","actual","data,","we","analyze","our\ndataset.","The","minimum","WAG","is26.83and","the","maximum","WAG","is97.82in","our","dataset.","Thus","the","MSE\nrange","could","be","between0and5039.58on","PAP","task.","The","minimum","number","of","borrowed","books","is\n0and","the","maximum","number","is137in","our","dataset.","Thus","the","MSE","range","could","be","between0and\n18769on","PNBB","task.","The","minimum","number","of","failed","courses","is0and","the","maximum","number","is10\nin","our","dataset.","Thus","the","MSE","range","could","be","between0and100on","PNFC","task.","We","can","know","one\nmethod","is","more","likely","to","get","a","small","MSE","on","PNFC","task","and","get","a","big","MSE","on","PNBB","task.\n5.4","","","","Implementation","Details\nFor","baselines","exceptAPAMT,","we","extract","features","from","heterogeneous","student","behaviors","as","Guan","et\nal.","[13]","suggested.","In","addition,","due","to","the","uncertainty","of","the","historical","observation","sequence,","we\nextract","some","descriptive","statistics","(minimum,","maximum","and","mean)","as","features.","As","for","the","data\nTable","2.","","Dataset","statistics.\nItemValue\n#","Students10,000\nStudent","Behaviors","Time","Span\n09/12/2016","-","01/15/2017\n(i.e.,","Fall","2016","semester);\n02/20/2017","-","06/25/2017\n(i.e.,","Spring","2017","semester)\n#","Library","Entrance","Records867,571\n#","Dormitory","Entrance","Records1,783,595\n#","Demographic","Records10,000\n#","Courses2,482\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:16Haobing","L.","et","al.\npreprocessing,","we","represent","the","categorical","features","with","one-hot","encoding.","We","process","numerical\ninputs","with","the","Min-Max","normalization","to","ensure","they","are","within","a","suitable","range.","For","WAG,","the\nnumber","of","borrowed","books","and","the","number","of","failed","courses,","because","we","usetanhas","the","activation\nfunction","in","the","output","layer,","we","scale","them","into[−1,1].","In","the","evaluation,","we","re-scale","the","predicted\nvalues","back","to","the","normal","values,","compared","with","the","actual","values.","For","the","other","numerical","inputs,\nwe","scale","them","into[0,1].","Around","half","of","the","data","(Fall","2016)","are","used","as","the","training","set","and","the\nother","half","(Spring","2017)","are","used","for","testing.\nThe","hyper-parameters","of","all","models","are","tuned","with","a","ten-fold","cross-validation","method","on","the\ntraining","dataset.","We","only","present","the","optimal","settings","of","our","model","are","as","follows.","The","dense\nembedding","layer","has30neurons.","The","dimensions","of","the","hidden","states","in","the","Profile-aware","LSTMs\nwhich","handle","entering","the","library","and","going","back","to","the","dormitory","behaviors","are","set","as12and4\nrespectively.","The","dimension","of","the","hidden","state","in","the","dynamic","LSTM","which","handles","the","historical\nWAG/number","of","borrowed","books/number","of","failed","courses","sequence","is","set","as5.","The","FC","layer","of\nthe","Multi-task","Interaction","Unit","has100neurons.","The","activation","function","used","in","the","FC","layer","is\nPReLU.","We","adopt4Multi-task","Interaction","Units","in","total.","We","apply","dropout","before","the","output","layer\nwith","a","dropout","rate","equal","to0.4.\n5.5","","","","Significance","Test\nThe","two-tailed","unpaired푡-test","is","performed","to","detect","significant","differences","betweenDAPAMTand\nthe","best","baseline.","There","are","two","conditions","that","should","be","met:","the","two","groups","of","samples","should\nbe","normally","distributed;","the","variances","of","the","two","groups","are","the","same","(this","can","be","checked","using\nLevene’s","test).\n5.6","","","","Results","and","Discussion\nTo","comprehensively","evaluate","our","model,","we","conduct","five","experiments.","First,","we","compare","our\nproposed","model","with","state-of-the-art","methods","to","show","the","effectiveness","of","our","model.","Second,\nwe","do","ablation","studies","to","prove","the","effectiveness","of","the","key","components","inDAPAMTsuch","as\nthe","Profile-aware","LSTM.","Third,","we","provide","the","visualization","of","learned","representations","to","show\nwhether","our","model","can","learn","general","representations","which","could","be","transferred","to","some","new","tasks.\nFourth,","we","randomly","select","some","students","to","visualize","soft-attention","weights","and","co-attention\nweights.","We","do","this","experiment","to","see","whether","our","model","can","provide","interpretability","and","whether\nattention","mechanisms","are","effective.","Finally,","we","study","how","hyper-parameters","inDAPAMTimpact\nthe","performance.\n5.6.1","","","","Exp-1:","Comparison","with","Baselines.\nWe","compare","our","model","with","baselines.","Quantitative","comparison","between","different","models","on","the\nthree","prediction","tasks","is","shown","in","Table","3.","All","baselines","exceptAPAMTare","trained","with","single","task.\nFrom","the","table,","we","can","see","thatDAPAMTachieves","the","best","performances","with","the","lowest","MSE\n12.16on","PAP","task,","the","lowest","MSE21.62on","PNBB","task","and","the","lowest","MSE0.155on","PNFC","task.\nWe","can","see","thatHAperforms","worst","since","the","trend","of","the","WAG/number","of","borrowed","books/number\nof","failed","courses","change","is","not","so","stable.","This","indicates","that","it","is","necessary","to","develop","a","method","to\npredict","the","future","trend.","We","can","see","thatLSTMperforms","not","well,","as","it","only","utilizes","the","historical\nWAG/number","of","borrowed","books/number","of","failed","courses","values.","Other","baselines","further","consider\nmore","information,","such","as","student","profile","information","and","heterogeneous","student","behaviors,","and\ntherefore","achieve","better","performances.","AlthoughBRRperforms","better","thanLSTM,","it","still","shows\npoor","performance","which","indicates","that","capturing","linear","correlations","is","not","sufficient.","ForSVR,","we\nleverage","RBF","kernel","thus","it","can","model","the","non-linear","relation","between","features.","As","a","result,SVR\nperforms","better","thanBRR.","Ensemble","models","(i.e.,RFandGBDT)","perform","well.","Ensemble","methods\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:17\nTable","3.","","Comparison","of","different","methods.","The","results","with","the","best","performance","are","marked","in","bold","and","the\nsecond-best","results","are","shown","as","underlined.","The","column","RI","denotes","the","average","relative","improvement","for\nMSE","on","DAPAMT","over","Baselines.\n★\nrepresents","significance","level푝-value<0.05of","comparing","DAPAMT","with\nthe","best","baseline.\nCompared","Methods\nPAPPNBBPNFC\nMSERIMSERIMSERI\nHA31.8561.82%63.5065.95%0.34454.94%\nLSTM28.4657.27%57.2162.21%0.31951.41%\nBRR\n27.6856.07%50.0656.81%0.30649.35%\nSVR\n26.8154.64%49.8356.61%0.27543.64%\nRF18.2433.33%30.1728.34%0.19721.32%\nGBDT18.8735.56%29.7327.28%0.22029.55%\nMLP17.7231.38%28.6424.51%0.18315.30%\nAPAMT\n14.5216.25%24.7712.72%0.1677.19%\nDAPAMT12.16\n★\n-21.62\n★\n-0.155\n★\n-\nTable","4.","","Comparison","with","Variants","of","DAPAMT.\nMethods\nPAPPNBBPNFC\nMSEMSEMSE\nAPAMT","Trained","w.","Single","Task15.1026.430.177\nDAPAMT","w.","Standard","LSTM13.1324.420.161\nDAPAMT","w/o","Soft-attention","Mechanism13.1524.890.167\nAPAMT\n14.5224.770.167\nDAPAMT12.1621.620.155\nusually","outperform","single","models","so","they","are","popular.MLPperforms","best","among","baselines","except\nforAPAMT.","Since","it","can","model","complex","relations","among","features","with","the","help","of","deep","learning.\nAPAMTperforms","best","among","baselines","because","it","can","not","only","extract","features","automatically","from\nheterogeneous","behaviors","but","also","model","the","interactions","among","multiple","tasks","in","an","implicit","way.\nIt","is","worth","mentioning","thatDAPAMTachieves16.2%,12.7%,7.2%relative","improvements","on\nPAP,","PNBB,","PNFC","tasks,","compared","with","the","best","baseline,","ie.,APAMT.","One","important","reason","is\nthatDAPAMTcan","explicitly","model","the","interactions","among","multiple","tasks.","With","the","help","of","the\nco-attention","mechanism,DAPAMTcan","control","the","knowledge","transfer","among","multiple","tasks.\n5.6.2","","","","Exp-2:","Ablation","Studies.\nTable","4","provides","the","comparison","results","of","variants","of","our","proposed","method.\nFirst,","we","study","the","effectiveness","of","our","proposed","multi-task","learning","framework.","We","train\nDAPAMTwith","single","task.","In","this","way,DAPAMTbecomesAPAMT","Trained","w.","Single","Task.","From\nthe","table","we","can","see","thatDAPAMTachieves19.5%,18.2%,12.4%relative","improvements","on","PAP,\nPNBB,","PNFC","tasks.","It","demonstrates","the","benefits","of","the","multi-task","learning","framework.","Multi-task\nlearning","allows","transferring","of","useful","knowledge","among","related","tasks.","Second,","we","prove","the","benefit\nof","the","Profile-aware","LSTM.","We","replace","the","Profile-aware","LSTM","with","the","standard","LSTM.","The","result\nis","thatDAPAMTachieves","lower","MSE","values","(a","reduction","of7.4%,11.5%,","and3.7%,","respectively)\nwith","the","help","of","the","Profile-aware","LSTM.","Profile-aware","LSTM","can","capture","profile","information","when\nmodeling","the","daily","behavior","sequence.","Third,","we","remove","the","soft-attention","mechanism","and","the\nperformances","become","much","poorer.","The","improvements","ofDAPAMTare","about7.5%,13.1%,7.2%\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:18Haobing","L.","et","al.\n(a)\n−10−50510\n−10\n−5\n0\n5\n10\n15\nthe","top","10%","students\nthe","last","10%","students\nothers\n(b)\n−7.5−5.0−2.50.02.55.07.510.0\n−10.0\n−7.5\n−5.0\n−2.5\n0.0\n2.5\n5.0\nEI","&","EE","students\nJI","students\nothers\n(c)(d)\nFig.","6.","","(a)","and","(b)","show","visualizations","of","learned","student","representations푹.","(c)","and","(d)","show","visualizations","of\nlearned","PAP","task-specific","representations","after","the","first","two","Multi-task","Interaction","Units.\non","PAP,","PNBB,","PNFC","tasks.","This","demonstrates","the","effectiveness","of","our","soft-attention","mechanism.\nOur","soft-attention","mechanism","can","dynamically","learn","the","different","importance","degrees","of","different\ndays","for","every","student.","Finally,","compared","withAPAMT,","we","can","conclude","that","our","co-attention\nmechanism","is","effective.","Our","co-attention","mechanism","can","explicitly","control","the","knowledge","transfer.\n5.6.3","","","","Exp-3:","Learned","Representations","Visualization.\nWe","remove","course","information","(i.e.,\n","̄\n풆and\n","̄\n풗)","fromDAPAMTand","retrainDAPAMTwith","the","three\ntasks.","Figure","6","(a)","and","(b)","show","visualizations","of","learned","student","representations푹based","on","the\ntesting","set.","Figure","6","(c)","and","(d)","show","visualizations","of","learned","PAP","task-specific","representations\nafter","the","first","two","Multi-task","Interaction","Units","based","on","the","testing","set.","The","technique","we","use","is\nt-SNE","algorithm","[25].","Specifically,","with","learned","representations","as","input,","t-SNE","algorithm","maps\nstudents","to","the","2-D","space.","One","dot","in","the","figure","represents","one","student.\nWe","randomly","choose","two","groups","of","students","(EI","&","EE","(i.e.,","Electronic","Information","and","Electrical\nEngineering)","students","and","JI","(i.e.,","Joint","Institute)","students)","and","mark","these","students.","From","Figure","6\n(a),","we","can","clearly","find","two","clusters","of","EI","&","EE","students","and","JI","students.","But","we","can","not","clearly","find\ntwo","clusters","in","Figure","6","(c).","We","can","only","distinguish","these","two","groups.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:19\n1815222936435057\nDay\n9\n8\n7\n6\n5\n4\n3\n2\n1\n0\nStudent\n0.02\n0.04\n0.06\n0.08\nFig.","7.","","Visualization","of","soft-attention","weights.\nβ\n12\nβ\n13\nβ\n23\nUnit","1\n9\n8\n7\n6\n5\n4\n3\n2\n1\n0\nStudent\nβ\n12\nβ\n13\nβ\n23\nUnit","2\nβ\n12\nβ\n13\nβ\n23\nUnit","3\nβ\n12\nβ\n13\nβ\n23\nUnit","4\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nFig.","8.","","Visualization","of","co-attention","weights.\nNext,","we","mark","the","top10%students","and","the","last10%students","according","to","the","mean","of","all\nWAGs.","From","Figure","6","(b),","we","can","not","distinguish","these","two","groups","of","students.","But","there","are","clearly\ntwo","clusters","in","Figure","6","(d).\nThis","experiment","indicates","student","representation푹is","general","and","could","be","transferred","to","other\ntasks.","Besides,","after","seeing","the","visualization","of","learned","task-specific","representations,","we","can","know\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:20Haobing","L.","et","al.\nPReLUReLUtanh\nPAP\n0\n2\n4\n6\n8\n10\n12\n14\nMSE\nPReLUReLUtanh\nPNBB\n0\n5\n10\n15\n20\n25\nPReLUReLUtanh\nPNFC\n0.000\n0.025\n0.050\n0.075\n0.100\n0.125\n0.150\n0.175\n(a)\n12.5\n15.0\n17.5\n20.0\nMSE","of","PAP\n30\n40\nMSE","of","PNBB\n012345\n#","Units\n0.15\n0.20\n0.25\nMSE","of","PNFC\n(b)\nFig.","9.","","MSE","with","activation","functions","(a)","and","#","units","(b).\nour","model","performs","well","and","generates","a","meaningful","layout","of","students","(students","with","similar\nWAGs","are","distributed","closer).\n5.6.4","","","","Exp-4:","Attention","mechanisms","Visualization.\nExp-4.1:","Soft-attention","Visualization.\nWe","randomly","select10students","in","the","testing","set","and","visualize\nthe","soft-attention","weights","of","days","in","Figure","7","to","show","whetherDAPAMTcan","find","out","informative\ndays","for","different","students.","The","figure","shows","that","soft-attention","weights","vary","for","days","and","students.\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:21\nNext,","we","choose","student2to","do","the","case","study.","For","simplicity,","we","only","show","student2’s","li-\nbrary","entrance","records.","The","fragment","of","the","records","is","{(stu2,2017-02-22","15:21:54),(stu2,2017-02-25\n15:58:29),(stu2,2017-04-15","12:07:32),(stu2,2017-04-16","08:52:53)}.","In","other","words,","during","the","first63\ndays,","student2enters","the","library","on","day3,6,55,","and56.","From","the","figure,","we","can","see","that","the\nweights","of","these","days","are","large.\nThis","experiment","visually","indicates","our","designed","soft-attention","mechanism","is","effective","(this\nconclusion","can","also","be","got","in","Section","5.6.2)","and","gives","the","informative","day","a","large","weight.\nExp-4.2:","Co-attention","Visualization.We","","still","","use","","the10students","","and","","visualize","","the","","co-attention\nweights.","In","particular,","we","visualize","the","co-attention","weights","between","PAP","task","and","PNBB","task\n(i.e.,훽\n12\n),","the","weights","between","PAP","task","and","PNFC","task","(i.e.,훽\n13\n),","and","the","weights","between","PNBB\ntask","and","PNFC","task","(i.e.,훽\n23\n)","with","the","number","of","stacked","units","varying","from1to4.","We","choose\nstudent3and","student8to","do","the","case","studies.","The","WAG","of","student3is87,","but","the","number","of\nbooks","borrowed","by","student3is0.","So","the","weights훽\n12\nof","student3are","pretty","small.","The","number","of\ncourses","in","which","student3failed","is0.","Thus","the","weights훽\n23\nof","student3are","large.","Next,","we","focus\non","student8.","The","WAG","of","student8is82.33,","and","the","number","of","books","borrowed","by","student8is\n33.","So","the","weights훽\n12\nof","student8are","large.","The","number","of","courses","in","which","student8failed","is0.\nThus","the","weights훽\n23\nof","student8become","very","small","in","unit","4.\nThis","experiment","visually","indicates","our","designed","co-attention","mechanism","is","effective","(this","conclu-\nsion","can","also","be","got","in","Section","5.6.2)","and","explicitly","controls","the","knowledge","transfer","among","tasks","by\nweights.\n5.6.5","","","","Exp-5:","Effect","of","Hyper-parameters.\nExp-5.1:","Effect","of","Activation","Functions.We","investigate","the","influence","of","the","activation","function","which\nexists","in","FC","layers.","We","choose","PReLU,","ReLU,","and","tanh","to","do","the","experiment.","Figure","9","(a)","shows","the\nresults.","We","observe","that","PReLU","is","more","suitable.\nExp-5.2:","Effect","of","the","Number","of","Multi-task","Interaction","Units.A","problem","worth","studying","is","that","how\nmany","units","are","appropriate.","Experimental","results","are","shown","in","Figure","9","(b).","As","the","number","of","units\ngrows,","the","performances","grow.","When","the","number","of","units","is4,","the","performances","except","on","PNFC\ndrop.","We","think","the","reason","might","lie","in","the","gradient","vanishing","or","the","overfitting","problem","as","the\nwhole","network","goes","deeper.","So","we","adopt4stacked","units.\n6","","","","ETHICAL","CONSIDERATIONS\nThe","ethical","implication","is","our","major","concern.","Nicholson","and","Glenn","[29]","proposed","that","the","ethical\nanalysis","mainly","depends","on","three","aspects:","the","types","of","the","data;","the","people","who","will","be","accessing\nthe","data;","and","the","purpose","of","the","work.","So","in","what","follows,","we","do","the","ethical","analysis","in","three\naspects.\nFor","the","types","of","data,","the","dataset","used","in","our","work","has","been","processed","and","fully","anonymized.\nStudent","names","are","removed.","Sensitive","information","(i.e.,","student","ID,","place","of","birth,","nationality,\ngender)","is","encrypted","by","being","hashed","to","a","vector","space.\nFor","the","people","who","will","be","accessing","the","data,","the","data","used","in","our","work","are","not","released","for\npublic","access.","In","applications","of","our","model,","we","stress","that","only","college","official","management","offices\ncollect","required","data","and","prediction","results","should","be","constrained","in","a","small","group","of","official","college\nstaff.\nFor","the","purpose","of","this","work,","we","would","like","to","stress","that","the","use","of","student","data","and","prediction\nresults","should","be","constrained","for","the","purpose","of","college","student","management","only,","not","for","general\npublic","access.","Besides,","the","prediction","results","should","not","bias","an","instructor’s","treatment","of","individual\nstudents.","In","the","real","world,","machine","learning","algorithms","will","never","achieve","100%","accurate","prediction\nresults","[18].\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:22Haobing","L.","et","al.\nIn","addition,","this","work","has","been","approved","by","the","Institutional","Review","Board","(IRB).\n7","","","","CONCLUSION\nIn","this","paper,","we","propose","a","Dual","Attention","Profile-Aware","Multi-Task","model","(i.e.,","DAPAMT)","to\njointly","modeling","heterogeneous","student","behaviors","generated","from","digital","footprints","and","interactions\namong","multiple","prediction","tasks.","With","DAPAMT,","we","can","learn","personalized","and","general","student\nrepresentations","from","student","profiles","and","student","heterogeneous","behaviors.","At","the","same","time,","we\ncan","explicitly","control","the","knowledge","transfer","among","prediction","tasks.","Qualitative","and","quantitative\nexperiments","on","a","real-world","dataset","have","demonstrated","the","effectiveness","of","DAPAMT.","We","believe\nDAPAMT","is","an","extensible","framework.","DAPAMT","can","be","utilized","to","model","heterogeneous","behaviors\nof","one","person","rather","than","one","student","and","can","be","utilized","to","handle","more","tasks","in","actual","scenarios.\nACKNOWLEDGEMENTS\nWe","","thank","","the","","anonymous","","reviewers","","for","","carefully","","reviewing","","and","","useful","","suggestions.","","This","","re-\nsearch","is","supported","in","part","by","the","2030","National","Key","AI","Program","of","China","2018AAA0100503\n(2018AAA0100500),","National","Science","Foundation","of","China","(No.","62072304,","No.","61772341,","No.","61472254,\nNo.","61770238),","Shanghai","Municipal","Science","and","Technology","Commission","(No.","18511103002,","No.\n19510760500,","and","No.","19511101500),","the","Program","for","Changjiang","Young","Scholars","in","University","of\nChina,","the","Program","for","China","Top","Young","Talents,","the","Program","for","Shanghai","Top","Young","Talents,\nSJTU","Global","Strategic","Partnership","Fund","(2019","SJTU-HKUST),","the","Oceanic","Interdisciplinary","Pro-\ngram","of","Shanghai","Jiao","Tong","University","(No.","SL2020MS032)","and","Scientific","Research","Fund","of","Second\nInstitute","of","Oceanography","(No.","SL2020MS032).\nREFERENCES\n[1]Dzmitry","Bahdanau,","Kyunghyun","Cho,","and","Yoshua","Bengio.","2015.","Neural","machine","translation","by","jointly","learning","to","align\nand","translate.","In3rd","International","Conference","on","Learning","Representations,","ICLR","2015,","San","Diego,","CA,","USA,","May","7-9,\n2015,","Conference","Track","Proceedings.","","http://arxiv.org/abs/1409.0473\n[2]\nChristopher","G","Brinton","and","Mung","Chiang.","2015.","MOOC","performance","prediction","via","clickstream","data","and","social","learning\nnetworks.","In2015","IEEE","Conference","on","Computer","Communications,","INFOCOM","2015,","Kowloon,","Hong","Kong,","April","26","-","May\n1,","2015.","IEEE,","2299–2307.","","https://doi.org/10.1109/INFOCOM.2015.7218617\n[3]M","Delgado","Calvo-Flores,","E","Gibaja","Galindo,","MC","Pegalajar","Jiménez,","and","O","Pérez","Pineiro.","2006.","","Predicting","students’\nmarks","from","Moodle","logs","using","neural","network","models.Current","Developments","in","Technology-Assisted","Education1,","2\n(2006),","586–590.\n[4]Luis","Cano,","Erick","Hein,","Mauricio","Rada-Orellana,","and","Claudio","Ortega.","2018.","A","case","study","of","library","data","management:","A\nnew","method","to","analyze","borrowing","behavior.","InInformation","Management","and","Big","Data,","5th","International","Conference,\nSIMBig","2018,","Lima,","Peru,","September","3-5,","2018,","Proceedings","(Communications","in","Computer","and","Information","Science),\nVol.","898.","Springer,","112–120.","","https://doi.org/10.1007/978-3-030-11680-4_12\n[5]Rich","Caruana.","1997.","Multitask","learning.Machine","learning28,","1","(1997),","41–75.","","https://doi.org/10.1023/A:1007379606734\n[6]Weiyu","Chen,","Christopher","G","Brinton,","Da","Cao,","Amanda","Mason-Singh,","Charlton","Lu,","and","Mung","Chiang.","2019.","","Early\ndetection","prediction","of","learning","outcomes","in","online","short-courses","via","learning","behaviors.IEEE","Transactions","on","Learning\nTechnologies12,","1","(2019),","44–58.","","https://doi.org/10.1109/TLT.2018.2793193\n[7]Junyoung","Chung,","Caglar","Gulcehre,","KyungHyun","Cho,","and","Yoshua","Bengio.","2014.","Empirical","evaluation","of","gated","recurrent\nneural","networks","on","sequence","modeling.arXiv","preprint","arXiv:1412.3555(2014).","","https://arxiv.org/abs/1412.3555\n[8]\nRonan","Collobert","and","Jason","Weston.","2008.","A","unified","architecture","for","natural","language","processing:","Deep","neural","networks\nwith","multitask","learning.","InMachine","Learning,","Proceedings","of","the","Twenty-Fifth","International","Conference","(ICML","2008),\nHelsinki,","Finland,","June","5-9,","2008,","Vol.","307.","ACM,","160–167.","","https://doi.org/10.1145/1390156.1390177\n[9]Jifeng","Dai,","Kaiming","He,","and","Jian","Sun.","2016.","Instance-aware","semantic","segmentation","via","multi-task","network","cascades.\nIn2016","IEEE","Conference","on","Computer","Vision","and","Pattern","Recognition,","CVPR","2016,","Las","Vegas,","NV,","USA,","June","27-30,","2016.\nIEEE,","3150–3158.","","https://doi.org/10.1109/CVPR.2016.343\n[10]\nMi","Fei","and","Dit-Yan","Yeung.","2015.","Temporal","models","for","predicting","student","dropout","in","massive","open","online","courses.","In\nbooktitle","=","IEEE","International","Conference","on","Data","Mining","Workshop,","ICDMW","2015,","Atlantic","City,","NJ,","USA,","November\n14-17,","2015,.","IEEE,","256–263.","","https://doi.org/10.1109/ICDMW.2015.174\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\nDAPAMT1:23\n[11]Mingyu","Feng,","Neil","Heffernan,","and","Kenneth","Koedinger.","2009.","","Addressing","the","assessment","challenge","with","an","online\nsystem","that","tutors","as","it","assesses.User","Modeling","and","User-Adapted","Interaction19,","3","(2009),","243–266.","","https://doi.org/10.\n1007/s11257-009-9063-7\n[12]Alex","Graves","and","Jürgen","Schmidhuber.","2005.","Framewise","phoneme","classification","with","bidirectional","LSTM","networks.","In\n2005","IEEE","International","Joint","Conference","on","Neural","Networks.","2047–2052.","","https://doi.org/10.1109/IJCNN.2005.1556215\n[13]Chu","Guan,","Xinjiang","Lu,","Xiaolin","Li,","Enhong","Chen,","Wenjun","Zhou,","and","Hui","Xiong.","2015.","Discovery","of","college","students","in\nfinancial","hardship.","In2015","IEEE","International","Conference","on","Data","Mining,","ICDM","2015,","Atlantic","City,","NJ,","USA,","November\n14-17,","2015.","IEEE,","141–150.","","https://doi.org/10.1109/ICDM.2015.49\n[14]Kaiming","He,","Xiangyu","Zhang,","Shaoqing","Ren,","and","Jian","Sun.","2015.","Delving","deep","into","rectifiers:","Surpassing","human-level\nperformance","on","imagenet","classification.","In2015","IEEE","International","Conference","on","Computer","Vision,","ICCV","2015,","Santiago,\nChile,","December","7-13,","2015.","IEEE,","1026–1034.","","https://doi.org/10.1109/ICCV.2015.123\n[15]\nBalázs","Hidasi,","Alexandros","Karatzoglou,","Linas","Baltrunas,","and","Domonkos","Tikk.","2016.","Session-based","recommendations\nwith","recurrent","neural","networks.","In4th","International","Conference","on","Learning","Representations,","ICLR","2016,","San","Juan,","Puerto\nRico,","May","2-4,","2016,","Conference","Track","Proceedings.","","http://arxiv.org/abs/1511.06939\n[16]Sepp","Hochreiter","and","Jürgen","Schmidhuber.","1997.","Long","short-term","memory.Neural","Computation9,","8","(1997),","1735–1780.\nhttps://doi.org/10.1162/neco.1997.9.8.1735\n[17]\nAnupam","Khan","and","Soumya","K","Ghosh.","2018.","Data","mining","based","analysis","to","explore","the","effect","of","teaching","on","student\nperformance.Education","and","Information","Technologies23,","4","(2018),","1677–1697.","","https://doi.org/10.1007/s10639-017-9685-z\n[18]Anupam","Khan","and","Soumya","K","Ghosh.","2021.","Student","performance","analysis","and","prediction","in","classroom","learning:","A\nreview","of","educational","data","mining","studies.Education","and","Information","Technologies26,","1","(2021),","205–240.","","","","https:\n//doi.org/10.1007/s10639-020-10230-3\n[19]\nDiederik","P","Kingma","and","Jimmy","Ba.","2015.","Adam:","A","method","for","stochastic","optimization.","In3rd","International","Conference\non","Learning","Representations,","ICLR","2015,","San","Diego,","CA,","USA,","May","7-9,","2015,","Conference","Track","Proceedings.http:\n//arxiv.org/abs/1412.6980\n[20]K","Kumar","and","MAM","Raj.","2016.","Improving","efficacy","of","library","services:","ARIMA","modelling","for","predicting","book","borrowing\nfor","optimizing","resource","utilization.Library","Philosophy","and","Practice","(e-journal),","Paper1395","(2016).\n[21]\nHaobing","Liu,","Yanmin","Zhu,","and","Yanan","Xu.","2020.","Learning","from","heterogeneous","student","behaviors","for","multiple","prediction\ntasks.","InDatabase","Systems","for","Advanced","Applications","-","25th","International","Conference,","DASFAA","2020,","Jeju,","South","Korea,\nSeptember","24-27,","2020,","Proceedings,","Part","II","(Lecture","Notes","in","Computer","Science),","Vol.","12113.","Springer,","297–313.","","https:\n//doi.org/10.1007/978-3-030-59416-9_18\n[22]Manuel","Ignacio","Lopez,","JM","Luna,","C","Romero,","and","S","Ventura.","2012.","Classification","via","clustering","for","predicting","final","marks\nbased","on","student","participation","in","forums.","In5th","International","Conference","on","Educational","Data","Mining.","EDM.\n[23]\nJiasen","Lu,","Jianwei","Yang,","Dhruv","Batra,","and","Devi","Parikh.","2016.","","Hierarchical","question-image","co-attention","for","visual\nquestion","answering.","InAdvances","in","Neural","Information","Processing","Systems","29:","Annual","Conference","on","Neural","Information\nProcessing","Systems","2016,","December","5-10,","2016,","Barcelona,","Spain.","289–297.","","https://proceedings.neurips.cc/paper/2016/\nhash/9dcb88e0137649590b755372b040afad-Abstract.html\n[24]Xinjiang","Lu,","Zhiwen","Yu,","Chuanren","Liu,","Yanchi","Liu,","Hui","Xiong,","and","Bin","Guo.","2020.","Inferring","lifetime","status","of","point-of-\ninterest:","A","multitask","multiclass","approach.ACM","Transactions","on","Knowledge","Discovery","from","Data14,","1","(2020),","1–27.\nhttps://doi.org/10.1145/3369799\n[25]Laurens","van","der","Maaten","and","Geoffrey","Hinton.","2008.","Visualizing","data","using","t-SNE.Journal","of","Machine","Learning","Research\n9,","Nov","(2008),","2579–2605.\n[26]Behrouz","Minaei-Bidgoli,","Deborah","A","Kashy,","Gerd","Kortemeyer,","and","William","F","Punch.","2003.","Predicting","student","perfor-\nmance:","an","application","of","data","mining","methods","with","an","educational","web-based","system.","In33rd","Annual","Frontiers","in\nEducation,","2003.","FIE","2003.,","Vol.","1.","IEEE,","T1A–13–T1A–18.","","https://doi.org/10.1109/FIE.2003.1263284\n[27]\nNguyen","Thai","Nghe,","Paul","Janecek,","and","Peter","Haddawy.","2007.","","A","comparative","analysis","of","techniques","for","predicting\nacademic","performance.","In2007","37th","Annual","Frontiers","in","Education","Conference-Global","Engineering:","Knowledge","Without\nBorders,","Opportunities","Without","Passports.","IEEE,","T2G–7–T2G–12.","","https://doi.org/10.1109/FIE.2007.4417993\n[28]\nEdin","Osmanbegovic","and","Mirza","Suljic.","2012.","","Data","mining","approach","for","predicting","student","performance.Economic\nReview:","Journal","of","Economics","and","Business10,","1","(2012),","3–12.","","https://EconPapers.repec.org/RePEc:tuz:journl:v:10:y:\n2012:i:1:p:3-12\n[29]\nW","Nicholson","Price","and","I","Glenn","Cohen.","2019.","","Privacy","in","the","age","of","medical","big","data.Nature","Medicine25,","1","(2019),\n37–43.","","https://doi.org/10.1038/s41591-018-0272-7\n[30]Rajeev","Ranjan,","Vishal","M","Patel,","and","Rama","Chellappa.","2017.","Hyperface:","A","deep","multi-task","learning","framework","for","face\ndetection,","landmark","localization,","pose","estimation,","and","gender","recognition.IEEE","Transactions","on","Pattern","Analysis","and\nMachine","Intelligence41,","1","(2017),","121–135.","","https://doi.org/10.1109/TPAMI.2017.2781233\n[31]Cristóbal","Romero,","Manuel-Ignacio","López,","Jose-María","Luna,","and","Sebastián","Ventura.","2013.","Predicting","students’","final\nperformance","from","participation","in","on-line","discussion","forums.Computers","&","Education68","(2013),","458–472.","","","https:\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021.\n\n1:24Haobing","L.","et","al.\n//doi.org/10.1016/j.compedu.2013.06.009\n[32]Amirah","Mohamed","Shahiri,","Wahidah","Husain,","and","Nur’aini","Abdul","Rashid.","2015.","","A","review","on","predicting","student’s\nperformance","using","data","mining","techniques.Procedia","Computer","Science72","(2015),","414–422.","","https://doi.org/10.1016/j.\nprocs.2015.12.157\n[33]Nitish","Srivastava,","Geoffrey","Hinton,","Alex","Krizhevsky,","Ilya","Sutskever,","and","Ruslan","Salakhutdinov.","2014.","","Dropout:","A\nsimple","way","to","prevent","neural","networks","from","overfitting.Journal","of","Machine","Learning","Research15,","1","(2014),","1929–1958.\nhttp://dl.acm.org/citation.cfm?id=2670313\n[34]Otgontsetseg","Sukhbaatar,","Tsuyoshi","Usagawa,","and","Lodoiravsal","Choimaa.","2019.","","An","artificial","neural","network","based\nearly","prediction","of","failure-prone","students","in","blended","learning","course.iJET14,","19","(2019),","77–92.","","https://www.online-\njournals.org/index.php/i-jet/article/view/10366\n[35]Ilya","Sutskever,","Oriol","Vinyals,","and","Quoc","V","Le.","2014.","","Sequence","to","sequence","learning","with","neural","networks.","InAd-\nvances","in","Neural","Information","Processing","Systems","27:","Annual","Conference","on","Neural","Information","Processing","Systems\n2014,","December","8-13","2014,","Montreal,","Quebec,","Canada.","3104–3112.","","","https://proceedings.neurips.cc/paper/2014/hash/\na14ac55a4f27472c5d894ec1c3c743d2-Abstract.html\n[36]Mack","Sweeney,","Jaime","Lester,","and","Huzefa","Rangwala.","2015.","Next-term","student","grade","prediction.","In2015","IEEE","International\nConference","on","Big","Data,","Big","Data","2015,","Santa","Clara,","CA,","USA,","October","29","-","November","1,","2015.","IEEE,","970–975.","","","https:\n//doi.org/10.1109/BigData.2015.7363847\n[37]\nTuomas","Tanner","and","Hannu","Toivonen.","2010.","Predicting","and","preventing","student","failure-using","the","k-nearest","neighbour\nmethod","to","predict","student","performance","in","an","online","course","environment.International","Journal","of","Learning","Technology\n5,","4","(2010),","356–377.","","https://doi.org/10.1504/IJLT.2010.038772\n[38]Mei","Tian.","2011.","","","Application","of","chaotic","time","series","prediction","in","forecasting","of","library","borrowing","flow.","In2011\nInternational","Conference","on","Internet","Computing","and","Information","Services.","IEEE,","557–559.","","https://doi.org/10.1109/ICICIS.\n2011.147\n[39]Rui","Wang,","Gabriella","Harari,","Peilin","Hao,","Xia","Zhou,","and","Andrew","T","Campbell.","2015.","","SmartGPA:","How","smartphones\ncan","assess","and","predict","academic","performance","of","college","students.","InProceedings","of","the","2015","ACM","International","Joint\nConference","on","Pervasive","and","Ubiquitous","Computing,","UbiComp","2015,","Osaka,","Japan,","September","7-11,","2015.","ACM,","295–306.\nhttps://doi.org/10.1145/2750858.2804251\n[40]\nRunhua","Wang,","Yi","Tang,","and","Lei","Li.","2012.","Application","of","BP","neural","network","to","prediction","of","library","circulation.","In11th\nIEEE","International","Conference","on","Cognitive","Informatics","and","Cognitive","Computing,","ICCI*CC","2012,","Kyoto,","Japan,","August\n22-24,","2012.","IEEE,","420–423.","","https://doi.org/10.1109/ICCI-CC.2012.6311183\n[41]Ya-huei","Wang","and","Hung-Chang","Liao.","2011.","","Data","mining","for","adaptive","learning","in","a","TESL-based","e-learning","system.\nExpert","Systems","with","Applications38,","6","(2011),","6480–6485.","","https://doi.org/10.1016/j.eswa.2010.11.098\n[42]\nJie","Xu,","Yuli","Han,","Daniel","Marcu,","and","Mihaela","Van","Der","Schaar.","2017.","Progressive","prediction","of","student","performance","in\ncollege","programs.","InProceedings","of","the","Thirty-First","AAAI","Conference","on","Artificial","Intelligence,","February","4-9,","2017,","San\nFrancisco,","California,","USA.","AAAI,","1604–1610.","","http://aaai.org/ocs/index.php/AAAI/AAAI17/paper/view/14234\n[43]Huaxiu","Yao,","Min","Nie,","Han","Su,","Hu","Xia,","and","Defu","Lian.","2017.","Predicting","academic","performance","via","semi-supervised\nlearning","with","constructed","campus","social","network.","InDatabase","Systems","for","Advanced","Applications","-","22nd","International\nConference,","DASFAA","2017,","Suzhou,","China,","March","27-30,","2017,","Proceedings,","Part","II","(Lecture","Notes","in","Computer","Science),\nVol.","10178.","Springer,","597–609.","","https://doi.org/10.1007/978-3-319-55699-4_37\n[44]Hsiang-Fu","Yu,","Hung-Yi","Lo,","Hsun-Ping","Hsieh,","Jing-Kai","Lou,","Todd","G","McKenzie,","Jung-Wei","Chou,","Po-Han","Chung,","Chia-\nHua","Ho,","Chun-Fu","Chang,","Yin-Hsuan","Wei,","Jui-Yu","Weng,","En-Syu","Yan,","Che-Wei","Chang,","Tsung-Ting","Kuo,","Yi-Chen","Lo,\nPo","Tzu","Chang,","Chieh","Po,","Chien-Yuan","Wang,","Yi-Hung","Huang,","Chen-Wei","Hung,","Yu-Xun","Ruan,","Yu-Shi","Lin,","Shou-De\nLin,","Hsuan-Tien","Lin,","and","Chih-Jen","Lin.","2011.","Feature","engineering","and","classifier","ensemble","for","KDD","cup","2010.","InJMLR\nWorkshop","and","Conference","Proceedings.\n[45]\nDaqing","Zhang,","Bin","Guo,","Bin","Li,","and","Zhiwen","Yu.","2010.","","Extracting","social","and","community","intelligence","from","digital\nfootprints:","An","emerging","research","area.","InUbiquitous","Intelligence","and","Computing","-","7th","International","Conference,","UIC\n2010,","Xi’an,","China,","October","26-29,","2010.","Proceedings","(Lecture","Notes","in","Computer","Science),","Vol.","6406.","Springer,","4–18.\nhttps://doi.org/10.1007/978-3-642-16355-5_4\n[46]Xi","Zhang,","Guangzhong","Sun,","Yigong","Pan,","Hao","Sun,","Yu","He,","and","Jiali","Tan.","2018.","","","Students","performance","modeling\nbased","on","behavior","pattern.Journal","of","Ambient","Intelligence","and","Humanized","Computing9,","5","(2018),","1659–1670.","","https:\n//doi.org/10.1007/s12652-018-0864-6\n[47]Yu","Zhu,","Hao","Li,","Yikang","Liao,","Beidou","Wang,","Ziyu","Guan,","Haifeng","Liu,","and","Deng","Cai.","2017.","What","to","do","next:","Modeling\nuser","behaviors","by","Time-LSTM.","InProceedings","of","the","Twenty-Sixth","International","Joint","Conference","on","Artificial","Intelligence,\nIJCAI","2017,","Melbourne,","Australia,","August","19-25,","2017.","IJCAI,","3602–3608.","","https://doi.org/10.24963/ijcai.2017/504\nACM","Trans.","Knowl.","Discov.","Data.,","Vol.","1,","No.","1,","Article","1.","Publication","date:","January","2021."]}